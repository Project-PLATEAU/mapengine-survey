var q3=(a,u)=>()=>(u||a((u={exports:{}}).exports,u),u.exports);var Xk=q3((QM,NM)=>{(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const M of document.querySelectorAll('link[rel="modulepreload"]'))R(M);new MutationObserver(M=>{for(const v of M)if(v.type==="childList")for(const y of v.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&R(y)}).observe(document,{childList:!0,subtree:!0});function h(M){const v={};return M.integrity&&(v.integrity=M.integrity),M.referrerpolicy&&(v.referrerPolicy=M.referrerpolicy),M.crossorigin==="use-credentials"?v.credentials="include":M.crossorigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function R(M){if(M.ep)return;M.ep=!0;const v=h(M);fetch(M.href,v)}})();var ua=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ky(a){var u=a.default;if(typeof u=="function"){var h=function(){return u.apply(this,arguments)};h.prototype=u.prototype}else h={};return Object.defineProperty(h,"__esModule",{value:!0}),Object.keys(a).forEach(function(R){var M=Object.getOwnPropertyDescriptor(a,R);Object.defineProperty(h,R,M.get?M:{enumerable:!0,get:function(){return a[R]}})}),h}var Qm={},hr={exports:{}};(function(a){function u(h){return h&&h.__esModule?h:{default:h}}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports})(hr);var Lr={exports:{}};(function(a){function u(h){return a.exports=u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},a.exports.__esModule=!0,a.exports.default=a.exports,u(h)}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports})(Lr);var Mx={},bx={exports:{}},Fb;function Ir(){return Fb||(Fb=1,function(a){function u(h,R){if(!(h instanceof R))throw new TypeError("Cannot call a class as a function")}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(bx)),bx.exports}var Ex={exports:{}},Ib;function kr(){return Ib||(Ib=1,function(a){function u(R,M){for(var v=0;v<M.length;v++){var y=M[v];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(R,y.key,y)}}function h(R,M,v){return M&&u(R.prototype,M),v&&u(R,v),Object.defineProperty(R,"prototype",{writable:!1}),R}a.exports=h,a.exports.__esModule=!0,a.exports.default=a.exports}(Ex)),Ex.exports}var Ve={};/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */var kb;function Dr(){if(kb)return Ve;kb=1,Object.defineProperty(Ve,"__esModule",{value:!0});const a="137",u={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},h={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},R=0,M=1,v=2,y=3,p=0,g=1,C=2,D=3,B=0,V=1,P=2,L=1,E=2,b=0,_=1,x=2,T=3,N=4,U=5,H=100,q=101,te=102,Q=103,Z=104,ae=200,F=201,W=202,O=203,X=204,G=205,j=206,K=207,ce=208,se=209,ue=210,Y=0,pe=1,Ee=2,Fe=3,$e=4,pt=5,Ue=6,Je=7,et=0,ze=1,Xe=2,tt=0,ye=1,Ze=2,Ge=3,Ae=4,Se=5,Te=300,me=301,be=302,we=303,je=304,lt=306,ot=307,bt=1e3,Ie=1001,re=1002,oe=1003,_e=1004,Re=1004,ke=1005,Be=1005,at=1006,wt=1007,ht=1007,_t=1008,St=1008,Ct=1009,vt=1010,ct=1011,Dt=1012,fr=1013,er=1014,dr=1015,zr=1016,Ut=1017,on=1018,tn=1020,Ln=1021,_i=1022,xn=1023,ri=1024,_n=1025,ta=1026,ji=1027,ss=1028,Ii=1029,Ha=1030,to=1031,Ou=1033,ms=33776,Us=33777,Ka=33778,Fu=33779,vs=35840,gs=35841,la=35842,ou=35843,ml=36196,qa=37492,wr=37496,bn=37808,Rn=37809,Xa=37810,Hi=37811,Tn=37812,Ec=37813,Iu=37814,ku=37815,ro=37816,es=37817,Pi=37818,zf=37819,zs=37820,vl=37821,uu=36492,Gf=2200,Fa=2201,ca=2202,lu=2300,cu=2301,ts=2302,fa=2400,bo=2401,Eo=2402,ki=2500,fu=2501,Tc=0,ys=1,B0=2,fi=3e3,xi=3001,Sc=3200,_s=3201,Gs=0,Du=1,sd=0,Nu=7680,Bu=7681,U0=7682,z0=7683,Rc=34055,Za=34056,od=5386,hu=512,Cc=513,To=514,gl=515,G0=516,du=517,Pc=518,ud=519,Uu=35044,zu=35048,Vf=35040,V0=35045,W0=35049,ld=35041,H0=35046,q0=35050,cd=35042,X0="100",yl="300 es",_l=1035;class Vs{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[e]===void 0&&(o[e]=[]),o[e].indexOf(i)===-1&&o[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const o=this._listeners;return o[e]!==void 0&&o[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const l=this._listeners[e];if(l!==void 0){const d=l.indexOf(i);d!==-1&&l.splice(d,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const o=this._listeners[e.type];if(o!==void 0){e.target=this;const l=o.slice(0);for(let d=0,w=l.length;d<w;d++)l[d].call(this,e);e.target=null}}}const Ea=[];for(let f=0;f<256;f++)Ea[f]=(f<16?"0":"")+f.toString(16);let xl=1234567;const ja=Math.PI/180,Al=180/Math.PI;function os(){const f=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(Ea[f&255]+Ea[f>>8&255]+Ea[f>>16&255]+Ea[f>>24&255]+"-"+Ea[e&255]+Ea[e>>8&255]+"-"+Ea[e>>16&15|64]+Ea[e>>24&255]+"-"+Ea[i&63|128]+Ea[i>>8&255]+"-"+Ea[i>>16&255]+Ea[i>>24&255]+Ea[o&255]+Ea[o>>8&255]+Ea[o>>16&255]+Ea[o>>24&255]).toUpperCase()}function un(f,e,i){return Math.max(e,Math.min(i,f))}function no(f,e){return(f%e+e)%e}function wl(f,e,i,o,l){return o+(f-e)*(l-o)/(i-e)}function Ps(f,e,i){return f!==e?(i-f)/(e-f):0}function Ws(f,e,i){return(1-i)*f+i*e}function Wf(f,e,i,o){return Ws(f,e,1-Math.exp(-i*o))}function fd(f,e=1){return e-Math.abs(no(f,e*2)-e)}function Ml(f,e,i){return f<=e?0:f>=i?1:(f=(f-e)/(i-e),f*f*(3-2*f))}function Hf(f,e,i){return f<=e?0:f>=i?1:(f=(f-e)/(i-e),f*f*f*(f*(f*6-15)+10))}function Lc(f,e){return f+Math.floor(Math.random()*(e-f+1))}function bl(f,e){return f+Math.random()*(e-f)}function Gu(f){return f*(.5-Math.random())}function hd(f){return f!==void 0&&(xl=f%2147483647),xl=xl*16807%2147483647,(xl-1)/2147483646}function qf(f){return f*ja}function Ye(f){return f*Al}function qe(f){return(f&f-1)===0&&f!==0}function yt(f){return Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))}function ie(f){return Math.pow(2,Math.floor(Math.log(f)/Math.LN2))}function zt(f,e,i,o,l){const d=Math.cos,w=Math.sin,I=d(i/2),J=w(i/2),ee=d((e+o)/2),he=w((e+o)/2),fe=d((e-o)/2),de=w((e-o)/2),ve=d((o-e)/2),Ce=w((o-e)/2);switch(l){case"XYX":f.set(I*he,J*fe,J*de,I*ee);break;case"YZY":f.set(J*de,I*he,J*fe,I*ee);break;case"ZXZ":f.set(J*fe,J*de,I*he,I*ee);break;case"XZX":f.set(I*he,J*Ce,J*ve,I*ee);break;case"YXY":f.set(J*ve,I*he,J*Ce,I*ee);break;case"ZYZ":f.set(J*Ce,J*ve,I*he,I*ee);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+l)}}var r=Object.freeze({__proto__:null,DEG2RAD:ja,RAD2DEG:Al,generateUUID:os,clamp:un,euclideanModulo:no,mapLinear:wl,inverseLerp:Ps,lerp:Ws,damp:Wf,pingpong:fd,smoothstep:Ml,smootherstep:Hf,randInt:Lc,randFloat:bl,randFloatSpread:Gu,seededRandom:hd,degToRad:qf,radToDeg:Ye,isPowerOfTwo:qe,ceilPowerOfTwo:yt,floorPowerOfTwo:ie,setQuaternionFromProperEuler:zt});class We{constructor(e=0,i=0){this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,i){return i!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,i)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e,i){return i!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,i)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,o=this.y,l=e.elements;return this.x=l[0]*i+l[3]*o+l[6],this.y=l[1]*i+l[4]*o+l[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,o=this.y-e.y;return i*i+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,o){return this.x=e.x+(i.x-e.x)*o,this.y=e.y+(i.y-e.y)*o,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i,o){return o!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const o=Math.cos(i),l=Math.sin(i),d=this.x-e.x,w=this.y-e.y;return this.x=d*o-w*l+e.x,this.y=d*l+w*o+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}We.prototype.isVector2=!0;class Yt{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,i,o,l,d,w,I,J,ee){const he=this.elements;return he[0]=e,he[1]=l,he[2]=I,he[3]=i,he[4]=d,he[5]=J,he[6]=o,he[7]=w,he[8]=ee,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,o=e.elements;return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],this}extractBasis(e,i,o){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const o=e.elements,l=i.elements,d=this.elements,w=o[0],I=o[3],J=o[6],ee=o[1],he=o[4],fe=o[7],de=o[2],ve=o[5],Ce=o[8],Ne=l[0],Ke=l[3],Oe=l[6],xe=l[1],ut=l[4],rt=l[7],ft=l[2],Mt=l[5],Rt=l[8];return d[0]=w*Ne+I*xe+J*ft,d[3]=w*Ke+I*ut+J*Mt,d[6]=w*Oe+I*rt+J*Rt,d[1]=ee*Ne+he*xe+fe*ft,d[4]=ee*Ke+he*ut+fe*Mt,d[7]=ee*Oe+he*rt+fe*Rt,d[2]=de*Ne+ve*xe+Ce*ft,d[5]=de*Ke+ve*ut+Ce*Mt,d[8]=de*Oe+ve*rt+Ce*Rt,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],o=e[1],l=e[2],d=e[3],w=e[4],I=e[5],J=e[6],ee=e[7],he=e[8];return i*w*he-i*I*ee-o*d*he+o*I*J+l*d*ee-l*w*J}invert(){const e=this.elements,i=e[0],o=e[1],l=e[2],d=e[3],w=e[4],I=e[5],J=e[6],ee=e[7],he=e[8],fe=he*w-I*ee,de=I*J-he*d,ve=ee*d-w*J,Ce=i*fe+o*de+l*ve;if(Ce===0)return this.set(0,0,0,0,0,0,0,0,0);const Ne=1/Ce;return e[0]=fe*Ne,e[1]=(l*ee-he*o)*Ne,e[2]=(I*o-l*w)*Ne,e[3]=de*Ne,e[4]=(he*i-l*J)*Ne,e[5]=(l*d-I*i)*Ne,e[6]=ve*Ne,e[7]=(o*J-ee*i)*Ne,e[8]=(w*i-o*d)*Ne,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,o,l,d,w,I){const J=Math.cos(d),ee=Math.sin(d);return this.set(o*J,o*ee,-o*(J*w+ee*I)+w+e,-l*ee,l*J,-l*(-ee*w+J*I)+I+i,0,0,1),this}scale(e,i){const o=this.elements;return o[0]*=e,o[3]*=e,o[6]*=e,o[1]*=i,o[4]*=i,o[7]*=i,this}rotate(e){const i=Math.cos(e),o=Math.sin(e),l=this.elements,d=l[0],w=l[3],I=l[6],J=l[1],ee=l[4],he=l[7];return l[0]=i*d+o*J,l[3]=i*w+o*ee,l[6]=i*I+o*he,l[1]=-o*d+i*J,l[4]=-o*w+i*ee,l[7]=-o*I+i*he,this}translate(e,i){const o=this.elements;return o[0]+=e*o[2],o[3]+=e*o[5],o[6]+=e*o[8],o[1]+=i*o[2],o[4]+=i*o[5],o[7]+=i*o[8],this}equals(e){const i=this.elements,o=e.elements;for(let l=0;l<9;l++)if(i[l]!==o[l])return!1;return!0}fromArray(e,i=0){for(let o=0;o<9;o++)this.elements[o]=e[o+i];return this}toArray(e=[],i=0){const o=this.elements;return e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2],e[i+3]=o[3],e[i+4]=o[4],e[i+5]=o[5],e[i+6]=o[6],e[i+7]=o[7],e[i+8]=o[8],e}clone(){return new this.constructor().fromArray(this.elements)}}Yt.prototype.isMatrix3=!0;function Er(f){for(let e=f.length-1;e>=0;--e)if(f[e]>65535)return!0;return!1}const xr={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Nt(f,e){return new xr[f](e)}function $n(f){return document.createElementNS("http://www.w3.org/1999/xhtml",f)}const Ai={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ni={h:0,s:0,l:0},qi={h:0,s:0,l:0};function _a(f,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?f+(e-f)*6*i:i<1/2?e:i<2/3?f+(e-f)*6*(2/3-i):f}function xa(f){return f<.04045?f*.0773993808:Math.pow(f*.9478672986+.0521327014,2.4)}function Ls(f){return f<.0031308?f*12.92:1.055*Math.pow(f,.41666)-.055}class Or{constructor(e,i,o){return i===void 0&&o===void 0?this.set(e):this.setRGB(e,i,o)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this}setRGB(e,i,o){return this.r=e,this.g=i,this.b=o,this}setHSL(e,i,o){if(e=no(e,1),i=un(i,0,1),o=un(o,0,1),i===0)this.r=this.g=this.b=o;else{const l=o<=.5?o*(1+i):o+i-o*i,d=2*o-l;this.r=_a(d,l,e+1/3),this.g=_a(d,l,e),this.b=_a(d,l,e-1/3)}return this}setStyle(e){function i(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let l;const d=o[1],w=o[2];switch(d){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(w))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,i(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(w))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,i(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(w)){const I=parseFloat(l[1])/360,J=parseInt(l[2],10)/100,ee=parseInt(l[3],10)/100;return i(l[4]),this.setHSL(I,J,ee)}break}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=o[1],d=l.length;if(d===3)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(d===6)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const i=Ai[e.toLowerCase()];return i!==void 0?this.setHex(i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xa(e.r),this.g=xa(e.g),this.b=xa(e.b),this}copyLinearToSRGB(e){return this.r=Ls(e.r),this.g=Ls(e.g),this.b=Ls(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const i=this.r,o=this.g,l=this.b,d=Math.max(i,o,l),w=Math.min(i,o,l);let I,J;const ee=(w+d)/2;if(w===d)I=0,J=0;else{const he=d-w;switch(J=ee<=.5?he/(d+w):he/(2-d-w),d){case i:I=(o-l)/he+(o<l?6:0);break;case o:I=(l-i)/he+2;break;case l:I=(i-o)/he+4;break}I/=6}return e.h=I,e.s=J,e.l=ee,e}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(e,i,o){return this.getHSL(ni),ni.h+=e,ni.s+=i,ni.l+=o,this.setHSL(ni.h,ni.s,ni.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,o){return this.r=e.r+(i.r-e.r)*o,this.g=e.g+(i.g-e.g)*o,this.b=e.b+(i.b-e.b)*o,this}lerpHSL(e,i){this.getHSL(ni),e.getHSL(qi);const o=Ws(ni.h,qi.h,i),l=Ws(ni.s,qi.s,i),d=Ws(ni.l,qi.l,i);return this.setHSL(o,l,d),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Or.NAMES=Ai,Or.prototype.isColor=!0,Or.prototype.r=1,Or.prototype.g=1,Or.prototype.b=1;let Nn;class Ia{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Nn===void 0&&(Nn=$n("canvas")),Nn.width=e.width,Nn.height=e.height;const o=Nn.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),i=Nn}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=$n("canvas");i.width=e.width,i.height=e.height;const o=i.getContext("2d");o.drawImage(e,0,0,e.width,e.height);const l=o.getImageData(0,0,e.width,e.height),d=l.data;for(let w=0;w<d.length;w++)d[w]=xa(d[w]/255)*255;return o.putImageData(l,0,0),i}else if(e.data){const i=e.data.slice(0);for(let o=0;o<i.length;o++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[o]=Math.floor(xa(i[o]/255)*255):i[o]=xa(i[o]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ya=0;class Cn extends Vs{constructor(e=Cn.DEFAULT_IMAGE,i=Cn.DEFAULT_MAPPING,o=Ie,l=Ie,d=at,w=_t,I=xn,J=Ct,ee=1,he=fi){super(),Object.defineProperty(this,"id",{value:Ya++}),this.uuid=os(),this.name="",this.image=e,this.mipmaps=[],this.mapping=i,this.wrapS=o,this.wrapT=l,this.magFilter=d,this.minFilter=w,this.anisotropy=ee,this.format=I,this.internalFormat=null,this.type=J,this.offset=new We(0,0),this.repeat=new We(1,1),this.center=new We(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Yt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=he,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const o={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const l=this.image;if(l.uuid===void 0&&(l.uuid=os()),!i&&e.images[l.uuid]===void 0){let d;if(Array.isArray(l)){d=[];for(let w=0,I=l.length;w<I;w++)l[w].isDataTexture?d.push(ei(l[w].image)):d.push(ei(l[w]))}else d=ei(l);e.images[l.uuid]={uuid:l.uuid,url:d}}o.image=l.uuid}return JSON.stringify(this.userData)!=="{}"&&(o.userData=this.userData),i||(e.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Te)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case bt:e.x=e.x-Math.floor(e.x);break;case Ie:e.x=e.x<0?0:1;break;case re:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case bt:e.y=e.y-Math.floor(e.y);break;case Ie:e.y=e.y<0?0:1;break;case re:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&this.version++}}Cn.DEFAULT_IMAGE=void 0,Cn.DEFAULT_MAPPING=Te,Cn.prototype.isTexture=!0;function ei(f){return typeof HTMLImageElement<"u"&&f instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&f instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&f instanceof ImageBitmap?Ia.getDataURL(f):f.data?{data:Array.prototype.slice.call(f.data),width:f.width,height:f.height,type:f.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class cn{constructor(e=0,i=0,o=0,l=1){this.x=e,this.y=i,this.z=o,this.w=l}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,o,l){return this.x=e,this.y=i,this.z=o,this.w=l,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,i){return i!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,i)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e,i){return i!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,i)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,o=this.y,l=this.z,d=this.w,w=e.elements;return this.x=w[0]*i+w[4]*o+w[8]*l+w[12]*d,this.y=w[1]*i+w[5]*o+w[9]*l+w[13]*d,this.z=w[2]*i+w[6]*o+w[10]*l+w[14]*d,this.w=w[3]*i+w[7]*o+w[11]*l+w[15]*d,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,o,l,d;const J=e.elements,ee=J[0],he=J[4],fe=J[8],de=J[1],ve=J[5],Ce=J[9],Ne=J[2],Ke=J[6],Oe=J[10];if(Math.abs(he-de)<.01&&Math.abs(fe-Ne)<.01&&Math.abs(Ce-Ke)<.01){if(Math.abs(he+de)<.1&&Math.abs(fe+Ne)<.1&&Math.abs(Ce+Ke)<.1&&Math.abs(ee+ve+Oe-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const ut=(ee+1)/2,rt=(ve+1)/2,ft=(Oe+1)/2,Mt=(he+de)/4,Rt=(fe+Ne)/4,kt=(Ce+Ke)/4;return ut>rt&&ut>ft?ut<.01?(o=0,l=.707106781,d=.707106781):(o=Math.sqrt(ut),l=Mt/o,d=Rt/o):rt>ft?rt<.01?(o=.707106781,l=0,d=.707106781):(l=Math.sqrt(rt),o=Mt/l,d=kt/l):ft<.01?(o=.707106781,l=.707106781,d=0):(d=Math.sqrt(ft),o=Rt/d,l=kt/d),this.set(o,l,d,i),this}let xe=Math.sqrt((Ke-Ce)*(Ke-Ce)+(fe-Ne)*(fe-Ne)+(de-he)*(de-he));return Math.abs(xe)<.001&&(xe=1),this.x=(Ke-Ce)/xe,this.y=(fe-Ne)/xe,this.z=(de-he)/xe,this.w=Math.acos((ee+ve+Oe-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,o){return this.x=e.x+(i.x-e.x)*o,this.y=e.y+(i.y-e.y)*o,this.z=e.z+(i.z-e.z)*o,this.w=e.w+(i.w-e.w)*o,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i,o){return o!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}cn.prototype.isVector4=!0;class Ta extends Vs{constructor(e,i,o={}){super(),this.width=e,this.height=i,this.depth=1,this.scissor=new cn(0,0,e,i),this.scissorTest=!1,this.viewport=new cn(0,0,e,i),this.texture=new Cn(void 0,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:i,depth:1},this.texture.generateMipmaps=o.generateMipmaps!==void 0?o.generateMipmaps:!1,this.texture.internalFormat=o.internalFormat!==void 0?o.internalFormat:null,this.texture.minFilter=o.minFilter!==void 0?o.minFilter:at,this.depthBuffer=o.depthBuffer!==void 0?o.depthBuffer:!0,this.stencilBuffer=o.stencilBuffer!==void 0?o.stencilBuffer:!1,this.depthTexture=o.depthTexture!==void 0?o.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,i,o=1){(this.width!==e||this.height!==i||this.depth!==o)&&(this.width=e,this.height=i,this.depth=o,this.texture.image.width=e,this.texture.image.height=i,this.texture.image.depth=o,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Ta.prototype.isWebGLRenderTarget=!0;class oi extends Ta{constructor(e,i,o){super(e,i);const l=this.texture;this.texture=[];for(let d=0;d<o;d++)this.texture[d]=l.clone()}setSize(e,i,o=1){if(this.width!==e||this.height!==i||this.depth!==o){this.width=e,this.height=i,this.depth=o;for(let l=0,d=this.texture.length;l<d;l++)this.texture[l].image.width=e,this.texture[l].image.height=i,this.texture[l].image.depth=o;this.dispose()}return this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let i=0,o=e.texture.length;i<o;i++)this.texture[i]=e.texture[i].clone();return this}}oi.prototype.isWebGLMultipleRenderTargets=!0;class El extends Ta{constructor(e,i,o={}){super(e,i,o),this.samples=4,this.ignoreDepthForMultisampleCopy=o.ignoreDepth!==void 0?o.ignoreDepth:!0,this.useRenderToTexture=o.useRenderToTexture!==void 0?o.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(e){return super.copy.call(this,e),this.samples=e.samples,this.useRenderToTexture=e.useRenderToTexture,this.useRenderbuffer=e.useRenderbuffer,this}}El.prototype.isWebGLMultisampleRenderTarget=!0;class ha{constructor(e=0,i=0,o=0,l=1){this._x=e,this._y=i,this._z=o,this._w=l}static slerp(e,i,o,l){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),o.slerpQuaternions(e,i,l)}static slerpFlat(e,i,o,l,d,w,I){let J=o[l+0],ee=o[l+1],he=o[l+2],fe=o[l+3];const de=d[w+0],ve=d[w+1],Ce=d[w+2],Ne=d[w+3];if(I===0){e[i+0]=J,e[i+1]=ee,e[i+2]=he,e[i+3]=fe;return}if(I===1){e[i+0]=de,e[i+1]=ve,e[i+2]=Ce,e[i+3]=Ne;return}if(fe!==Ne||J!==de||ee!==ve||he!==Ce){let Ke=1-I;const Oe=J*de+ee*ve+he*Ce+fe*Ne,xe=Oe>=0?1:-1,ut=1-Oe*Oe;if(ut>Number.EPSILON){const ft=Math.sqrt(ut),Mt=Math.atan2(ft,Oe*xe);Ke=Math.sin(Ke*Mt)/ft,I=Math.sin(I*Mt)/ft}const rt=I*xe;if(J=J*Ke+de*rt,ee=ee*Ke+ve*rt,he=he*Ke+Ce*rt,fe=fe*Ke+Ne*rt,Ke===1-I){const ft=1/Math.sqrt(J*J+ee*ee+he*he+fe*fe);J*=ft,ee*=ft,he*=ft,fe*=ft}}e[i]=J,e[i+1]=ee,e[i+2]=he,e[i+3]=fe}static multiplyQuaternionsFlat(e,i,o,l,d,w){const I=o[l],J=o[l+1],ee=o[l+2],he=o[l+3],fe=d[w],de=d[w+1],ve=d[w+2],Ce=d[w+3];return e[i]=I*Ce+he*fe+J*ve-ee*de,e[i+1]=J*Ce+he*de+ee*fe-I*ve,e[i+2]=ee*Ce+he*ve+I*de-J*fe,e[i+3]=he*Ce-I*fe-J*de-ee*ve,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,o,l){return this._x=e,this._y=i,this._z=o,this._w=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const o=e._x,l=e._y,d=e._z,w=e._order,I=Math.cos,J=Math.sin,ee=I(o/2),he=I(l/2),fe=I(d/2),de=J(o/2),ve=J(l/2),Ce=J(d/2);switch(w){case"XYZ":this._x=de*he*fe+ee*ve*Ce,this._y=ee*ve*fe-de*he*Ce,this._z=ee*he*Ce+de*ve*fe,this._w=ee*he*fe-de*ve*Ce;break;case"YXZ":this._x=de*he*fe+ee*ve*Ce,this._y=ee*ve*fe-de*he*Ce,this._z=ee*he*Ce-de*ve*fe,this._w=ee*he*fe+de*ve*Ce;break;case"ZXY":this._x=de*he*fe-ee*ve*Ce,this._y=ee*ve*fe+de*he*Ce,this._z=ee*he*Ce+de*ve*fe,this._w=ee*he*fe-de*ve*Ce;break;case"ZYX":this._x=de*he*fe-ee*ve*Ce,this._y=ee*ve*fe+de*he*Ce,this._z=ee*he*Ce-de*ve*fe,this._w=ee*he*fe+de*ve*Ce;break;case"YZX":this._x=de*he*fe+ee*ve*Ce,this._y=ee*ve*fe+de*he*Ce,this._z=ee*he*Ce-de*ve*fe,this._w=ee*he*fe-de*ve*Ce;break;case"XZY":this._x=de*he*fe-ee*ve*Ce,this._y=ee*ve*fe-de*he*Ce,this._z=ee*he*Ce+de*ve*fe,this._w=ee*he*fe+de*ve*Ce;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+w)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const o=i/2,l=Math.sin(o);return this._x=e.x*l,this._y=e.y*l,this._z=e.z*l,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,o=i[0],l=i[4],d=i[8],w=i[1],I=i[5],J=i[9],ee=i[2],he=i[6],fe=i[10],de=o+I+fe;if(de>0){const ve=.5/Math.sqrt(de+1);this._w=.25/ve,this._x=(he-J)*ve,this._y=(d-ee)*ve,this._z=(w-l)*ve}else if(o>I&&o>fe){const ve=2*Math.sqrt(1+o-I-fe);this._w=(he-J)/ve,this._x=.25*ve,this._y=(l+w)/ve,this._z=(d+ee)/ve}else if(I>fe){const ve=2*Math.sqrt(1+I-o-fe);this._w=(d-ee)/ve,this._x=(l+w)/ve,this._y=.25*ve,this._z=(J+he)/ve}else{const ve=2*Math.sqrt(1+fe-o-I);this._w=(w-l)/ve,this._x=(d+ee)/ve,this._y=(J+he)/ve,this._z=.25*ve}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let o=e.dot(i)+1;return o<Number.EPSILON?(o=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=o):(this._x=0,this._y=-e.z,this._z=e.y,this._w=o)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=o),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(un(this.dot(e),-1,1)))}rotateTowards(e,i){const o=this.angleTo(e);if(o===0)return this;const l=Math.min(1,i/o);return this.slerp(e,l),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,i){return i!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,i)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const o=e._x,l=e._y,d=e._z,w=e._w,I=i._x,J=i._y,ee=i._z,he=i._w;return this._x=o*he+w*I+l*ee-d*J,this._y=l*he+w*J+d*I-o*ee,this._z=d*he+w*ee+o*J-l*I,this._w=w*he-o*I-l*J-d*ee,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const o=this._x,l=this._y,d=this._z,w=this._w;let I=w*e._w+o*e._x+l*e._y+d*e._z;if(I<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,I=-I):this.copy(e),I>=1)return this._w=w,this._x=o,this._y=l,this._z=d,this;const J=1-I*I;if(J<=Number.EPSILON){const ve=1-i;return this._w=ve*w+i*this._w,this._x=ve*o+i*this._x,this._y=ve*l+i*this._y,this._z=ve*d+i*this._z,this.normalize(),this._onChangeCallback(),this}const ee=Math.sqrt(J),he=Math.atan2(ee,I),fe=Math.sin((1-i)*he)/ee,de=Math.sin(i*he)/ee;return this._w=w*fe+this._w*de,this._x=o*fe+this._x*de,this._y=l*fe+this._y*de,this._z=d*fe+this._z*de,this._onChangeCallback(),this}slerpQuaternions(e,i,o){return this.copy(e).slerp(i,o)}random(){const e=Math.random(),i=Math.sqrt(1-e),o=Math.sqrt(e),l=2*Math.PI*Math.random(),d=2*Math.PI*Math.random();return this.set(i*Math.cos(l),o*Math.sin(d),o*Math.cos(d),i*Math.sin(l))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}ha.prototype.isQuaternion=!0;class dt{constructor(e=0,i=0,o=0){this.x=e,this.y=i,this.z=o}set(e,i,o){return o===void 0&&(o=this.z),this.x=e,this.y=i,this.z=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,i){return i!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,i)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e,i){return i!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,i)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e,i){return i!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,i)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Tl.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(Tl.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,o=this.y,l=this.z,d=e.elements;return this.x=d[0]*i+d[3]*o+d[6]*l,this.y=d[1]*i+d[4]*o+d[7]*l,this.z=d[2]*i+d[5]*o+d[8]*l,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,o=this.y,l=this.z,d=e.elements,w=1/(d[3]*i+d[7]*o+d[11]*l+d[15]);return this.x=(d[0]*i+d[4]*o+d[8]*l+d[12])*w,this.y=(d[1]*i+d[5]*o+d[9]*l+d[13])*w,this.z=(d[2]*i+d[6]*o+d[10]*l+d[14])*w,this}applyQuaternion(e){const i=this.x,o=this.y,l=this.z,d=e.x,w=e.y,I=e.z,J=e.w,ee=J*i+w*l-I*o,he=J*o+I*i-d*l,fe=J*l+d*o-w*i,de=-d*i-w*o-I*l;return this.x=ee*J+de*-d+he*-I-fe*-w,this.y=he*J+de*-w+fe*-d-ee*-I,this.z=fe*J+de*-I+ee*-w-he*-d,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,o=this.y,l=this.z,d=e.elements;return this.x=d[0]*i+d[4]*o+d[8]*l,this.y=d[1]*i+d[5]*o+d[9]*l,this.z=d[2]*i+d[6]*o+d[10]*l,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,o){return this.x=e.x+(i.x-e.x)*o,this.y=e.y+(i.y-e.y)*o,this.z=e.z+(i.z-e.z)*o,this}cross(e,i){return i!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,i)):this.crossVectors(this,e)}crossVectors(e,i){const o=e.x,l=e.y,d=e.z,w=i.x,I=i.y,J=i.z;return this.x=l*J-d*I,this.y=d*w-o*J,this.z=o*I-l*w,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const o=e.dot(this)/i;return this.copy(e).multiplyScalar(o)}projectOnPlane(e){return Hs.copy(this).projectOnVector(e),this.sub(Hs)}reflect(e){return this.sub(Hs.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const o=this.dot(e)/i;return Math.acos(un(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,o=this.y-e.y,l=this.z-e.z;return i*i+o*o+l*l}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,o){const l=Math.sin(i)*e;return this.x=l*Math.sin(o),this.y=Math.cos(i)*e,this.z=l*Math.cos(o),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,o){return this.x=e*Math.sin(i),this.y=o,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),o=this.setFromMatrixColumn(e,1).length(),l=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=o,this.z=l,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i,o){return o!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,o=Math.sqrt(1-e**2);return this.x=o*Math.cos(i),this.y=o*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}dt.prototype.isVector3=!0;const Hs=new dt,Tl=new ha;class Ja{constructor(e=new dt(1/0,1/0,1/0),i=new dt(-1/0,-1/0,-1/0)){this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){let i=1/0,o=1/0,l=1/0,d=-1/0,w=-1/0,I=-1/0;for(let J=0,ee=e.length;J<ee;J+=3){const he=e[J],fe=e[J+1],de=e[J+2];he<i&&(i=he),fe<o&&(o=fe),de<l&&(l=de),he>d&&(d=he),fe>w&&(w=fe),de>I&&(I=de)}return this.min.set(i,o,l),this.max.set(d,w,I),this}setFromBufferAttribute(e){let i=1/0,o=1/0,l=1/0,d=-1/0,w=-1/0,I=-1/0;for(let J=0,ee=e.count;J<ee;J++){const he=e.getX(J),fe=e.getY(J),de=e.getZ(J);he<i&&(i=he),fe<o&&(o=fe),de<l&&(l=de),he>d&&(d=he),fe>w&&(w=fe),de>I&&(I=de)}return this.min.set(i,o,l),this.max.set(d,w,I),this}setFromPoints(e){this.makeEmpty();for(let i=0,o=e.length;i<o;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const o=us.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const o=e.geometry;if(o!==void 0)if(i&&o.attributes!=null&&o.attributes.position!==void 0){const d=o.attributes.position;for(let w=0,I=d.count;w<I;w++)us.fromBufferAttribute(d,w).applyMatrix4(e.matrixWorld),this.expandByPoint(us)}else o.boundingBox===null&&o.computeBoundingBox(),Sl.copy(o.boundingBox),Sl.applyMatrix4(e.matrixWorld),this.union(Sl);const l=e.children;for(let d=0,w=l.length;d<w;d++)this.expandByObject(l[d],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,us),us.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,o;return e.normal.x>0?(i=e.normal.x*this.min.x,o=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,o=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,o+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,o+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,o+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,o+=e.normal.z*this.min.z),i<=-e.constant&&o>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Oc),Rl.subVectors(this.max,Oc),pu.subVectors(e.a,Oc),ka.subVectors(e.b,Oc),Sa.subVectors(e.c,Oc),As.subVectors(ka,pu),qs.subVectors(Sa,ka),io.subVectors(pu,Sa);let i=[0,-As.z,As.y,0,-qs.z,qs.y,0,-io.z,io.y,As.z,0,-As.x,qs.z,0,-qs.x,io.z,0,-io.x,-As.y,As.x,0,-qs.y,qs.x,0,-io.y,io.x,0];return!Xf(i,pu,ka,Sa,Rl)||(i=[1,0,0,0,1,0,0,0,1],!Xf(i,pu,ka,Sa,Rl))?!1:(Fc.crossVectors(As,qs),i=[Fc.x,Fc.y,Fc.z],Xf(i,pu,ka,Sa,Rl))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return us.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(us).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(xs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),xs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),xs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),xs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),xs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),xs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),xs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),xs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(xs),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Ja.prototype.isBox3=!0;const xs=[new dt,new dt,new dt,new dt,new dt,new dt,new dt,new dt],us=new dt,Sl=new Ja,pu=new dt,ka=new dt,Sa=new dt,As=new dt,qs=new dt,io=new dt,Oc=new dt,Rl=new dt,Fc=new dt,ao=new dt;function Xf(f,e,i,o,l){for(let d=0,w=f.length-3;d<=w;d+=3){ao.fromArray(f,d);const I=l.x*Math.abs(ao.x)+l.y*Math.abs(ao.y)+l.z*Math.abs(ao.z),J=e.dot(ao),ee=i.dot(ao),he=o.dot(ao);if(Math.max(-Math.max(J,ee,he),Math.min(J,ee,he))>I)return!1}return!0}const dd=new Ja,pd=new dt,Cl=new dt,Me=new dt;class mu{constructor(e=new dt,i=-1){this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const o=this.center;i!==void 0?o.copy(i):dd.setFromPoints(e).getCenter(o);let l=0;for(let d=0,w=e.length;d<w;d++)l=Math.max(l,o.distanceToSquared(e[d]));return this.radius=Math.sqrt(l),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const o=this.center.distanceToSquared(e);return i.copy(e),o>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Me.subVectors(e,this.center);const i=Me.lengthSq();if(i>this.radius*this.radius){const o=Math.sqrt(i),l=(o-this.radius)*.5;this.center.add(Me.multiplyScalar(l/o)),this.radius+=l}return this}union(e){return this.center.equals(e.center)===!0?Cl.set(0,0,1).multiplyScalar(e.radius):Cl.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(pd.copy(e.center).add(Cl)),this.expandByPoint(pd.copy(e.center).sub(Cl)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const So=new dt,Zf=new dt,Pl=new dt,Ro=new dt,jf=new dt,Ic=new dt,Yf=new dt;class Co{constructor(e=new dt,i=new dt(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,So)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const o=i.dot(this.direction);return o<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(o).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=So.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(So.copy(this.direction).multiplyScalar(i).add(this.origin),So.distanceToSquared(e))}distanceSqToSegment(e,i,o,l){Zf.copy(e).add(i).multiplyScalar(.5),Pl.copy(i).sub(e).normalize(),Ro.copy(this.origin).sub(Zf);const d=e.distanceTo(i)*.5,w=-this.direction.dot(Pl),I=Ro.dot(this.direction),J=-Ro.dot(Pl),ee=Ro.lengthSq(),he=Math.abs(1-w*w);let fe,de,ve,Ce;if(he>0)if(fe=w*J-I,de=w*I-J,Ce=d*he,fe>=0)if(de>=-Ce)if(de<=Ce){const Ne=1/he;fe*=Ne,de*=Ne,ve=fe*(fe+w*de+2*I)+de*(w*fe+de+2*J)+ee}else de=d,fe=Math.max(0,-(w*de+I)),ve=-fe*fe+de*(de+2*J)+ee;else de=-d,fe=Math.max(0,-(w*de+I)),ve=-fe*fe+de*(de+2*J)+ee;else de<=-Ce?(fe=Math.max(0,-(-w*d+I)),de=fe>0?-d:Math.min(Math.max(-d,-J),d),ve=-fe*fe+de*(de+2*J)+ee):de<=Ce?(fe=0,de=Math.min(Math.max(-d,-J),d),ve=de*(de+2*J)+ee):(fe=Math.max(0,-(w*d+I)),de=fe>0?d:Math.min(Math.max(-d,-J),d),ve=-fe*fe+de*(de+2*J)+ee);else de=w>0?-d:d,fe=Math.max(0,-(w*de+I)),ve=-fe*fe+de*(de+2*J)+ee;return o&&o.copy(this.direction).multiplyScalar(fe).add(this.origin),l&&l.copy(Pl).multiplyScalar(de).add(Zf),ve}intersectSphere(e,i){So.subVectors(e.center,this.origin);const o=So.dot(this.direction),l=So.dot(So)-o*o,d=e.radius*e.radius;if(l>d)return null;const w=Math.sqrt(d-l),I=o-w,J=o+w;return I<0&&J<0?null:I<0?this.at(J,i):this.at(I,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(e.normal)+e.constant)/i;return o>=0?o:null}intersectPlane(e,i){const o=this.distanceToPlane(e);return o===null?null:this.at(o,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let o,l,d,w,I,J;const ee=1/this.direction.x,he=1/this.direction.y,fe=1/this.direction.z,de=this.origin;return ee>=0?(o=(e.min.x-de.x)*ee,l=(e.max.x-de.x)*ee):(o=(e.max.x-de.x)*ee,l=(e.min.x-de.x)*ee),he>=0?(d=(e.min.y-de.y)*he,w=(e.max.y-de.y)*he):(d=(e.max.y-de.y)*he,w=(e.min.y-de.y)*he),o>w||d>l||((d>o||o!==o)&&(o=d),(w<l||l!==l)&&(l=w),fe>=0?(I=(e.min.z-de.z)*fe,J=(e.max.z-de.z)*fe):(I=(e.max.z-de.z)*fe,J=(e.min.z-de.z)*fe),o>J||I>l)||((I>o||o!==o)&&(o=I),(J<l||l!==l)&&(l=J),l<0)?null:this.at(o>=0?o:l,i)}intersectsBox(e){return this.intersectBox(e,So)!==null}intersectTriangle(e,i,o,l,d){jf.subVectors(i,e),Ic.subVectors(o,e),Yf.crossVectors(jf,Ic);let w=this.direction.dot(Yf),I;if(w>0){if(l)return null;I=1}else if(w<0)I=-1,w=-w;else return null;Ro.subVectors(this.origin,e);const J=I*this.direction.dot(Ic.crossVectors(Ro,Ic));if(J<0)return null;const ee=I*this.direction.dot(jf.cross(Ro));if(ee<0||J+ee>w)return null;const he=-I*Ro.dot(Yf);return he<0?null:this.at(he/w,d)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class jr{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,i,o,l,d,w,I,J,ee,he,fe,de,ve,Ce,Ne,Ke){const Oe=this.elements;return Oe[0]=e,Oe[4]=i,Oe[8]=o,Oe[12]=l,Oe[1]=d,Oe[5]=w,Oe[9]=I,Oe[13]=J,Oe[2]=ee,Oe[6]=he,Oe[10]=fe,Oe[14]=de,Oe[3]=ve,Oe[7]=Ce,Oe[11]=Ne,Oe[15]=Ke,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new jr().fromArray(this.elements)}copy(e){const i=this.elements,o=e.elements;return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i[9]=o[9],i[10]=o[10],i[11]=o[11],i[12]=o[12],i[13]=o[13],i[14]=o[14],i[15]=o[15],this}copyPosition(e){const i=this.elements,o=e.elements;return i[12]=o[12],i[13]=o[13],i[14]=o[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,o){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(e,i,o){return this.set(e.x,i.x,o.x,0,e.y,i.y,o.y,0,e.z,i.z,o.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,o=e.elements,l=1/Vu.setFromMatrixColumn(e,0).length(),d=1/Vu.setFromMatrixColumn(e,1).length(),w=1/Vu.setFromMatrixColumn(e,2).length();return i[0]=o[0]*l,i[1]=o[1]*l,i[2]=o[2]*l,i[3]=0,i[4]=o[4]*d,i[5]=o[5]*d,i[6]=o[6]*d,i[7]=0,i[8]=o[8]*w,i[9]=o[9]*w,i[10]=o[10]*w,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const i=this.elements,o=e.x,l=e.y,d=e.z,w=Math.cos(o),I=Math.sin(o),J=Math.cos(l),ee=Math.sin(l),he=Math.cos(d),fe=Math.sin(d);if(e.order==="XYZ"){const de=w*he,ve=w*fe,Ce=I*he,Ne=I*fe;i[0]=J*he,i[4]=-J*fe,i[8]=ee,i[1]=ve+Ce*ee,i[5]=de-Ne*ee,i[9]=-I*J,i[2]=Ne-de*ee,i[6]=Ce+ve*ee,i[10]=w*J}else if(e.order==="YXZ"){const de=J*he,ve=J*fe,Ce=ee*he,Ne=ee*fe;i[0]=de+Ne*I,i[4]=Ce*I-ve,i[8]=w*ee,i[1]=w*fe,i[5]=w*he,i[9]=-I,i[2]=ve*I-Ce,i[6]=Ne+de*I,i[10]=w*J}else if(e.order==="ZXY"){const de=J*he,ve=J*fe,Ce=ee*he,Ne=ee*fe;i[0]=de-Ne*I,i[4]=-w*fe,i[8]=Ce+ve*I,i[1]=ve+Ce*I,i[5]=w*he,i[9]=Ne-de*I,i[2]=-w*ee,i[6]=I,i[10]=w*J}else if(e.order==="ZYX"){const de=w*he,ve=w*fe,Ce=I*he,Ne=I*fe;i[0]=J*he,i[4]=Ce*ee-ve,i[8]=de*ee+Ne,i[1]=J*fe,i[5]=Ne*ee+de,i[9]=ve*ee-Ce,i[2]=-ee,i[6]=I*J,i[10]=w*J}else if(e.order==="YZX"){const de=w*J,ve=w*ee,Ce=I*J,Ne=I*ee;i[0]=J*he,i[4]=Ne-de*fe,i[8]=Ce*fe+ve,i[1]=fe,i[5]=w*he,i[9]=-I*he,i[2]=-ee*he,i[6]=ve*fe+Ce,i[10]=de-Ne*fe}else if(e.order==="XZY"){const de=w*J,ve=w*ee,Ce=I*J,Ne=I*ee;i[0]=J*he,i[4]=-fe,i[8]=ee*he,i[1]=de*fe+Ne,i[5]=w*he,i[9]=ve*fe-Ce,i[2]=Ce*fe-ve,i[6]=I*he,i[10]=Ne*fe+de}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Z0,e,j0)}lookAt(e,i,o){const l=this.elements;return Ra.subVectors(e,i),Ra.lengthSq()===0&&(Ra.z=1),Ra.normalize(),Po.crossVectors(o,Ra),Po.lengthSq()===0&&(Math.abs(o.z)===1?Ra.x+=1e-4:Ra.z+=1e-4,Ra.normalize(),Po.crossVectors(o,Ra)),Po.normalize(),kc.crossVectors(Ra,Po),l[0]=Po.x,l[4]=kc.x,l[8]=Ra.x,l[1]=Po.y,l[5]=kc.y,l[9]=Ra.y,l[2]=Po.z,l[6]=kc.z,l[10]=Ra.z,this}multiply(e,i){return i!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,i)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const o=e.elements,l=i.elements,d=this.elements,w=o[0],I=o[4],J=o[8],ee=o[12],he=o[1],fe=o[5],de=o[9],ve=o[13],Ce=o[2],Ne=o[6],Ke=o[10],Oe=o[14],xe=o[3],ut=o[7],rt=o[11],ft=o[15],Mt=l[0],Rt=l[4],kt=l[8],nr=l[12],Xt=l[1],it=l[5],Pt=l[9],Vt=l[13],Zt=l[2],Jt=l[6],jt=l[10],ir=l[14],Sr=l[3],Hr=l[7],or=l[11],tr=l[15];return d[0]=w*Mt+I*Xt+J*Zt+ee*Sr,d[4]=w*Rt+I*it+J*Jt+ee*Hr,d[8]=w*kt+I*Pt+J*jt+ee*or,d[12]=w*nr+I*Vt+J*ir+ee*tr,d[1]=he*Mt+fe*Xt+de*Zt+ve*Sr,d[5]=he*Rt+fe*it+de*Jt+ve*Hr,d[9]=he*kt+fe*Pt+de*jt+ve*or,d[13]=he*nr+fe*Vt+de*ir+ve*tr,d[2]=Ce*Mt+Ne*Xt+Ke*Zt+Oe*Sr,d[6]=Ce*Rt+Ne*it+Ke*Jt+Oe*Hr,d[10]=Ce*kt+Ne*Pt+Ke*jt+Oe*or,d[14]=Ce*nr+Ne*Vt+Ke*ir+Oe*tr,d[3]=xe*Mt+ut*Xt+rt*Zt+ft*Sr,d[7]=xe*Rt+ut*it+rt*Jt+ft*Hr,d[11]=xe*kt+ut*Pt+rt*jt+ft*or,d[15]=xe*nr+ut*Vt+rt*ir+ft*tr,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],o=e[4],l=e[8],d=e[12],w=e[1],I=e[5],J=e[9],ee=e[13],he=e[2],fe=e[6],de=e[10],ve=e[14],Ce=e[3],Ne=e[7],Ke=e[11],Oe=e[15];return Ce*(+d*J*fe-l*ee*fe-d*I*de+o*ee*de+l*I*ve-o*J*ve)+Ne*(+i*J*ve-i*ee*de+d*w*de-l*w*ve+l*ee*he-d*J*he)+Ke*(+i*ee*fe-i*I*ve-d*w*fe+o*w*ve+d*I*he-o*ee*he)+Oe*(-l*I*he-i*J*fe+i*I*de+l*w*fe-o*w*de+o*J*he)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,o){const l=this.elements;return e.isVector3?(l[12]=e.x,l[13]=e.y,l[14]=e.z):(l[12]=e,l[13]=i,l[14]=o),this}invert(){const e=this.elements,i=e[0],o=e[1],l=e[2],d=e[3],w=e[4],I=e[5],J=e[6],ee=e[7],he=e[8],fe=e[9],de=e[10],ve=e[11],Ce=e[12],Ne=e[13],Ke=e[14],Oe=e[15],xe=fe*Ke*ee-Ne*de*ee+Ne*J*ve-I*Ke*ve-fe*J*Oe+I*de*Oe,ut=Ce*de*ee-he*Ke*ee-Ce*J*ve+w*Ke*ve+he*J*Oe-w*de*Oe,rt=he*Ne*ee-Ce*fe*ee+Ce*I*ve-w*Ne*ve-he*I*Oe+w*fe*Oe,ft=Ce*fe*J-he*Ne*J-Ce*I*de+w*Ne*de+he*I*Ke-w*fe*Ke,Mt=i*xe+o*ut+l*rt+d*ft;if(Mt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Rt=1/Mt;return e[0]=xe*Rt,e[1]=(Ne*de*d-fe*Ke*d-Ne*l*ve+o*Ke*ve+fe*l*Oe-o*de*Oe)*Rt,e[2]=(I*Ke*d-Ne*J*d+Ne*l*ee-o*Ke*ee-I*l*Oe+o*J*Oe)*Rt,e[3]=(fe*J*d-I*de*d-fe*l*ee+o*de*ee+I*l*ve-o*J*ve)*Rt,e[4]=ut*Rt,e[5]=(he*Ke*d-Ce*de*d+Ce*l*ve-i*Ke*ve-he*l*Oe+i*de*Oe)*Rt,e[6]=(Ce*J*d-w*Ke*d-Ce*l*ee+i*Ke*ee+w*l*Oe-i*J*Oe)*Rt,e[7]=(w*de*d-he*J*d+he*l*ee-i*de*ee-w*l*ve+i*J*ve)*Rt,e[8]=rt*Rt,e[9]=(Ce*fe*d-he*Ne*d-Ce*o*ve+i*Ne*ve+he*o*Oe-i*fe*Oe)*Rt,e[10]=(w*Ne*d-Ce*I*d+Ce*o*ee-i*Ne*ee-w*o*Oe+i*I*Oe)*Rt,e[11]=(he*I*d-w*fe*d-he*o*ee+i*fe*ee+w*o*ve-i*I*ve)*Rt,e[12]=ft*Rt,e[13]=(he*Ne*l-Ce*fe*l+Ce*o*de-i*Ne*de-he*o*Ke+i*fe*Ke)*Rt,e[14]=(Ce*I*l-w*Ne*l-Ce*o*J+i*Ne*J+w*o*Ke-i*I*Ke)*Rt,e[15]=(w*fe*l-he*I*l+he*o*J-i*fe*J-w*o*de+i*I*de)*Rt,this}scale(e){const i=this.elements,o=e.x,l=e.y,d=e.z;return i[0]*=o,i[4]*=l,i[8]*=d,i[1]*=o,i[5]*=l,i[9]*=d,i[2]*=o,i[6]*=l,i[10]*=d,i[3]*=o,i[7]*=l,i[11]*=d,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],l=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,o,l))}makeTranslation(e,i,o){return this.set(1,0,0,e,0,1,0,i,0,0,1,o,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,i,-o,0,0,o,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),o=Math.sin(e);return this.set(i,0,o,0,0,1,0,0,-o,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),o=Math.sin(e);return this.set(i,-o,0,0,o,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const o=Math.cos(i),l=Math.sin(i),d=1-o,w=e.x,I=e.y,J=e.z,ee=d*w,he=d*I;return this.set(ee*w+o,ee*I-l*J,ee*J+l*I,0,ee*I+l*J,he*I+o,he*J-l*w,0,ee*J-l*I,he*J+l*w,d*J*J+o,0,0,0,0,1),this}makeScale(e,i,o){return this.set(e,0,0,0,0,i,0,0,0,0,o,0,0,0,0,1),this}makeShear(e,i,o,l,d,w){return this.set(1,o,d,0,e,1,w,0,i,l,1,0,0,0,0,1),this}compose(e,i,o){const l=this.elements,d=i._x,w=i._y,I=i._z,J=i._w,ee=d+d,he=w+w,fe=I+I,de=d*ee,ve=d*he,Ce=d*fe,Ne=w*he,Ke=w*fe,Oe=I*fe,xe=J*ee,ut=J*he,rt=J*fe,ft=o.x,Mt=o.y,Rt=o.z;return l[0]=(1-(Ne+Oe))*ft,l[1]=(ve+rt)*ft,l[2]=(Ce-ut)*ft,l[3]=0,l[4]=(ve-rt)*Mt,l[5]=(1-(de+Oe))*Mt,l[6]=(Ke+xe)*Mt,l[7]=0,l[8]=(Ce+ut)*Rt,l[9]=(Ke-xe)*Rt,l[10]=(1-(de+Ne))*Rt,l[11]=0,l[12]=e.x,l[13]=e.y,l[14]=e.z,l[15]=1,this}decompose(e,i,o){const l=this.elements;let d=Vu.set(l[0],l[1],l[2]).length();const w=Vu.set(l[4],l[5],l[6]).length(),I=Vu.set(l[8],l[9],l[10]).length();this.determinant()<0&&(d=-d),e.x=l[12],e.y=l[13],e.z=l[14],Os.copy(this);const ee=1/d,he=1/w,fe=1/I;return Os.elements[0]*=ee,Os.elements[1]*=ee,Os.elements[2]*=ee,Os.elements[4]*=he,Os.elements[5]*=he,Os.elements[6]*=he,Os.elements[8]*=fe,Os.elements[9]*=fe,Os.elements[10]*=fe,i.setFromRotationMatrix(Os),o.x=d,o.y=w,o.z=I,this}makePerspective(e,i,o,l,d,w){w===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const I=this.elements,J=2*d/(i-e),ee=2*d/(o-l),he=(i+e)/(i-e),fe=(o+l)/(o-l),de=-(w+d)/(w-d),ve=-2*w*d/(w-d);return I[0]=J,I[4]=0,I[8]=he,I[12]=0,I[1]=0,I[5]=ee,I[9]=fe,I[13]=0,I[2]=0,I[6]=0,I[10]=de,I[14]=ve,I[3]=0,I[7]=0,I[11]=-1,I[15]=0,this}makeOrthographic(e,i,o,l,d,w){const I=this.elements,J=1/(i-e),ee=1/(o-l),he=1/(w-d),fe=(i+e)*J,de=(o+l)*ee,ve=(w+d)*he;return I[0]=2*J,I[4]=0,I[8]=0,I[12]=-fe,I[1]=0,I[5]=2*ee,I[9]=0,I[13]=-de,I[2]=0,I[6]=0,I[10]=-2*he,I[14]=-ve,I[3]=0,I[7]=0,I[11]=0,I[15]=1,this}equals(e){const i=this.elements,o=e.elements;for(let l=0;l<16;l++)if(i[l]!==o[l])return!1;return!0}fromArray(e,i=0){for(let o=0;o<16;o++)this.elements[o]=e[o+i];return this}toArray(e=[],i=0){const o=this.elements;return e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2],e[i+3]=o[3],e[i+4]=o[4],e[i+5]=o[5],e[i+6]=o[6],e[i+7]=o[7],e[i+8]=o[8],e[i+9]=o[9],e[i+10]=o[10],e[i+11]=o[11],e[i+12]=o[12],e[i+13]=o[13],e[i+14]=o[14],e[i+15]=o[15],e}}jr.prototype.isMatrix4=!0;const Vu=new dt,Os=new jr,Z0=new dt(0,0,0),j0=new dt(1,1,1),Po=new dt,kc=new dt,Ra=new dt,Dc=new jr,Y0=new ha;class Lo{constructor(e=0,i=0,o=0,l=Lo.DefaultOrder){this._x=e,this._y=i,this._z=o,this._order=l}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,o,l=this._order){return this._x=e,this._y=i,this._z=o,this._order=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,o=!0){const l=e.elements,d=l[0],w=l[4],I=l[8],J=l[1],ee=l[5],he=l[9],fe=l[2],de=l[6],ve=l[10];switch(i){case"XYZ":this._y=Math.asin(un(I,-1,1)),Math.abs(I)<.9999999?(this._x=Math.atan2(-he,ve),this._z=Math.atan2(-w,d)):(this._x=Math.atan2(de,ee),this._z=0);break;case"YXZ":this._x=Math.asin(-un(he,-1,1)),Math.abs(he)<.9999999?(this._y=Math.atan2(I,ve),this._z=Math.atan2(J,ee)):(this._y=Math.atan2(-fe,d),this._z=0);break;case"ZXY":this._x=Math.asin(un(de,-1,1)),Math.abs(de)<.9999999?(this._y=Math.atan2(-fe,ve),this._z=Math.atan2(-w,ee)):(this._y=0,this._z=Math.atan2(J,d));break;case"ZYX":this._y=Math.asin(-un(fe,-1,1)),Math.abs(fe)<.9999999?(this._x=Math.atan2(de,ve),this._z=Math.atan2(J,d)):(this._x=0,this._z=Math.atan2(-w,ee));break;case"YZX":this._z=Math.asin(un(J,-1,1)),Math.abs(J)<.9999999?(this._x=Math.atan2(-he,ee),this._y=Math.atan2(-fe,d)):(this._x=0,this._y=Math.atan2(I,ve));break;case"XZY":this._z=Math.asin(-un(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(de,ee),this._y=Math.atan2(I,d)):(this._x=Math.atan2(-he,ve),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,o===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,o){return Dc.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Dc,i,o)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return Y0.setFromEuler(this),this.setFromQuaternion(Y0,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new dt(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Lo.prototype.isEuler=!0,Lo.DefaultOrder="XYZ",Lo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ll{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let md=0;const Nc=new dt,In=new ha,$a=new jr,Ol=new dt,so=new dt,Wu=new dt,Bc=new ha,Jf=new dt(1,0,0),Uc=new dt(0,1,0),Yn=new dt(0,0,1),Fl={type:"added"},Il={type:"removed"};class Gn extends Vs{constructor(){super(),Object.defineProperty(this,"id",{value:md++}),this.uuid=os(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gn.DefaultUp.clone();const e=new dt,i=new Lo,o=new ha,l=new dt(1,1,1);function d(){o.setFromEuler(i,!1)}function w(){i.setFromQuaternion(o,void 0,!1)}i._onChange(d),o._onChange(w),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new jr},normalMatrix:{value:new Yt}}),this.matrix=new jr,this.matrixWorld=new jr,this.matrixAutoUpdate=Gn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ll,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return In.setFromAxisAngle(e,i),this.quaternion.multiply(In),this}rotateOnWorldAxis(e,i){return In.setFromAxisAngle(e,i),this.quaternion.premultiply(In),this}rotateX(e){return this.rotateOnAxis(Jf,e)}rotateY(e){return this.rotateOnAxis(Uc,e)}rotateZ(e){return this.rotateOnAxis(Yn,e)}translateOnAxis(e,i){return Nc.copy(e).applyQuaternion(this.quaternion),this.position.add(Nc.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(Jf,e)}translateY(e){return this.translateOnAxis(Uc,e)}translateZ(e){return this.translateOnAxis(Yn,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4($a.copy(this.matrixWorld).invert())}lookAt(e,i,o){e.isVector3?Ol.copy(e):Ol.set(e,i,o);const l=this.parent;this.updateWorldMatrix(!0,!1),so.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$a.lookAt(so,Ol,this.up):$a.lookAt(Ol,so,this.up),this.quaternion.setFromRotationMatrix($a),l&&($a.extractRotation(l.matrixWorld),In.setFromRotationMatrix($a),this.quaternion.premultiply(In.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Fl)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(Il)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const i=this.children[e];i.parent=null,i.dispatchEvent(Il)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),$a.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),$a.multiply(e.parent.matrixWorld)),e.applyMatrix4($a),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let o=0,l=this.children.length;o<l;o++){const w=this.children[o].getObjectByProperty(e,i);if(w!==void 0)return w}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(so,e,Wu),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(so,Bc,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let o=0,l=i.length;o<l;o++)i[o].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let o=0,l=i.length;o<l;o++)i[o].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let o=0,l=i.length;o<l;o++)i[o].updateMatrixWorld(e)}updateWorldMatrix(e,i){const o=this.parent;if(e===!0&&o!==null&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const l=this.children;for(let d=0,w=l.length;d<w;d++)l[d].updateWorldMatrix(!1,!0)}}toJSON(e){const i=e===void 0||typeof e=="string",o={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},o.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const l={};l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),this.castShadow===!0&&(l.castShadow=!0),this.receiveShadow===!0&&(l.receiveShadow=!0),this.visible===!1&&(l.visible=!1),this.frustumCulled===!1&&(l.frustumCulled=!1),this.renderOrder!==0&&(l.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(l.instanceColor=this.instanceColor.toJSON()));function d(I,J){return I[J.uuid]===void 0&&(I[J.uuid]=J.toJSON(e)),J.uuid}if(this.isScene)this.background&&(this.background.isColor?l.background=this.background.toJSON():this.background.isTexture&&(l.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(l.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){l.geometry=d(e.geometries,this.geometry);const I=this.geometry.parameters;if(I!==void 0&&I.shapes!==void 0){const J=I.shapes;if(Array.isArray(J))for(let ee=0,he=J.length;ee<he;ee++){const fe=J[ee];d(e.shapes,fe)}else d(e.shapes,J)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(d(e.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const I=[];for(let J=0,ee=this.material.length;J<ee;J++)I.push(d(e.materials,this.material[J]));l.material=I}else l.material=d(e.materials,this.material);if(this.children.length>0){l.children=[];for(let I=0;I<this.children.length;I++)l.children.push(this.children[I].toJSON(e).object)}if(this.animations.length>0){l.animations=[];for(let I=0;I<this.animations.length;I++){const J=this.animations[I];l.animations.push(d(e.animations,J))}}if(i){const I=w(e.geometries),J=w(e.materials),ee=w(e.textures),he=w(e.images),fe=w(e.shapes),de=w(e.skeletons),ve=w(e.animations);I.length>0&&(o.geometries=I),J.length>0&&(o.materials=J),ee.length>0&&(o.textures=ee),he.length>0&&(o.images=he),fe.length>0&&(o.shapes=fe),de.length>0&&(o.skeletons=de),ve.length>0&&(o.animations=ve)}return o.object=l,o;function w(I){const J=[];for(const ee in I){const he=I[ee];delete he.metadata,J.push(he)}return J}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let o=0;o<e.children.length;o++){const l=e.children[o];this.add(l.clone())}return this}}Gn.DefaultUp=new dt(0,1,0),Gn.DefaultMatrixAutoUpdate=!0,Gn.prototype.isObject3D=!0;const Da=new dt,oo=new dt,zc=new dt,Xs=new dt,Hu=new dt,uo=new dt,Gc=new dt,vu=new dt,Oo=new dt,kl=new dt;class zi{constructor(e=new dt,i=new dt,o=new dt){this.a=e,this.b=i,this.c=o}static getNormal(e,i,o,l){l.subVectors(o,i),Da.subVectors(e,i),l.cross(Da);const d=l.lengthSq();return d>0?l.multiplyScalar(1/Math.sqrt(d)):l.set(0,0,0)}static getBarycoord(e,i,o,l,d){Da.subVectors(l,i),oo.subVectors(o,i),zc.subVectors(e,i);const w=Da.dot(Da),I=Da.dot(oo),J=Da.dot(zc),ee=oo.dot(oo),he=oo.dot(zc),fe=w*ee-I*I;if(fe===0)return d.set(-2,-1,-1);const de=1/fe,ve=(ee*J-I*he)*de,Ce=(w*he-I*J)*de;return d.set(1-ve-Ce,Ce,ve)}static containsPoint(e,i,o,l){return this.getBarycoord(e,i,o,l,Xs),Xs.x>=0&&Xs.y>=0&&Xs.x+Xs.y<=1}static getUV(e,i,o,l,d,w,I,J){return this.getBarycoord(e,i,o,l,Xs),J.set(0,0),J.addScaledVector(d,Xs.x),J.addScaledVector(w,Xs.y),J.addScaledVector(I,Xs.z),J}static isFrontFacing(e,i,o,l){return Da.subVectors(o,i),oo.subVectors(e,i),Da.cross(oo).dot(l)<0}set(e,i,o){return this.a.copy(e),this.b.copy(i),this.c.copy(o),this}setFromPointsAndIndices(e,i,o,l){return this.a.copy(e[i]),this.b.copy(e[o]),this.c.copy(e[l]),this}setFromAttributeAndIndices(e,i,o,l){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,o),this.c.fromBufferAttribute(e,l),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Da.subVectors(this.c,this.b),oo.subVectors(this.a,this.b),Da.cross(oo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return zi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return zi.getBarycoord(e,this.a,this.b,this.c,i)}getUV(e,i,o,l,d){return zi.getUV(e,this.a,this.b,this.c,i,o,l,d)}containsPoint(e){return zi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return zi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const o=this.a,l=this.b,d=this.c;let w,I;Hu.subVectors(l,o),uo.subVectors(d,o),vu.subVectors(e,o);const J=Hu.dot(vu),ee=uo.dot(vu);if(J<=0&&ee<=0)return i.copy(o);Oo.subVectors(e,l);const he=Hu.dot(Oo),fe=uo.dot(Oo);if(he>=0&&fe<=he)return i.copy(l);const de=J*fe-he*ee;if(de<=0&&J>=0&&he<=0)return w=J/(J-he),i.copy(o).addScaledVector(Hu,w);kl.subVectors(e,d);const ve=Hu.dot(kl),Ce=uo.dot(kl);if(Ce>=0&&ve<=Ce)return i.copy(d);const Ne=ve*ee-J*Ce;if(Ne<=0&&ee>=0&&Ce<=0)return I=ee/(ee-Ce),i.copy(o).addScaledVector(uo,I);const Ke=he*Ce-ve*fe;if(Ke<=0&&fe-he>=0&&ve-Ce>=0)return Gc.subVectors(d,l),I=(fe-he)/(fe-he+(ve-Ce)),i.copy(l).addScaledVector(Gc,I);const Oe=1/(Ke+Ne+de);return w=Ne*Oe,I=de*Oe,i.copy(o).addScaledVector(Hu,w).addScaledVector(uo,I)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let lo=0;class Ti extends Vs{constructor(){super(),Object.defineProperty(this,"id",{value:lo++}),this.uuid=os(),this.name="",this.type="Material",this.fog=!0,this.blending=_,this.side=B,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=X,this.blendDst=G,this.blendEquation=H,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Fe,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ud,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Nu,this.stencilZFail=Nu,this.stencilZPass=Nu,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const o=e[i];if(o===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=o===L;continue}const l=this[i];if(l===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}l&&l.isColor?l.set(o):l&&l.isVector3&&o&&o.isVector3?l.copy(o):this[i]=o}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const o={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),this.roughness!==void 0&&(o.roughness=this.roughness),this.metalness!==void 0&&(o.metalness=this.metalness),this.sheen!==void 0&&(o.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(o.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(o.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(o.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(o.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(o.shininess=this.shininess),this.clearcoat!==void 0&&(o.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(o.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(o.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(o.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,o.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(e).uuid,o.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(e).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(e).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(e).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(e).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(o.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(o.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(o.combine=this.combine)),this.envMapIntensity!==void 0&&(o.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(o.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(o.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(o.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(o.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(o.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(o.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(o.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(o.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(o.size=this.size),this.shadowSide!==null&&(o.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(o.blending=this.blending),this.side!==B&&(o.side=this.side),this.vertexColors&&(o.vertexColors=!0),this.opacity<1&&(o.opacity=this.opacity),this.transparent===!0&&(o.transparent=this.transparent),o.depthFunc=this.depthFunc,o.depthTest=this.depthTest,o.depthWrite=this.depthWrite,o.colorWrite=this.colorWrite,o.stencilWrite=this.stencilWrite,o.stencilWriteMask=this.stencilWriteMask,o.stencilFunc=this.stencilFunc,o.stencilRef=this.stencilRef,o.stencilFuncMask=this.stencilFuncMask,o.stencilFail=this.stencilFail,o.stencilZFail=this.stencilZFail,o.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(o.rotation=this.rotation),this.polygonOffset===!0&&(o.polygonOffset=!0),this.polygonOffsetFactor!==0&&(o.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(o.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(o.linewidth=this.linewidth),this.dashSize!==void 0&&(o.dashSize=this.dashSize),this.gapSize!==void 0&&(o.gapSize=this.gapSize),this.scale!==void 0&&(o.scale=this.scale),this.dithering===!0&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(o.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(o.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(o.wireframe=this.wireframe),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(o.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(o.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(o.flatShading=this.flatShading),this.visible===!1&&(o.visible=!1),this.toneMapped===!1&&(o.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(o.userData=this.userData);function l(d){const w=[];for(const I in d){const J=d[I];delete J.metadata,w.push(J)}return w}if(i){const d=l(e.textures),w=l(e.images);d.length>0&&(o.textures=d),w.length>0&&(o.images=w)}return o}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let o=null;if(i!==null){const l=i.length;o=new Array(l);for(let d=0;d!==l;++d)o[d]=i[d].clone()}return this.clippingPlanes=o,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}Ti.prototype.isMaterial=!0;class co extends Ti{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=et,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}co.prototype.isMeshBasicMaterial=!0;const ii=new dt,Vc=new We;class ti{constructor(e,i,o){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=o===!0,this.usage=Uu,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,i,o){e*=this.itemSize,o*=i.itemSize;for(let l=0,d=this.itemSize;l<d;l++)this.array[e+l]=i.array[o+l];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const i=this.array;let o=0;for(let l=0,d=e.length;l<d;l++){let w=e[l];w===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",l),w=new Or),i[o++]=w.r,i[o++]=w.g,i[o++]=w.b}return this}copyVector2sArray(e){const i=this.array;let o=0;for(let l=0,d=e.length;l<d;l++){let w=e[l];w===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",l),w=new We),i[o++]=w.x,i[o++]=w.y}return this}copyVector3sArray(e){const i=this.array;let o=0;for(let l=0,d=e.length;l<d;l++){let w=e[l];w===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",l),w=new dt),i[o++]=w.x,i[o++]=w.y,i[o++]=w.z}return this}copyVector4sArray(e){const i=this.array;let o=0;for(let l=0,d=e.length;l<d;l++){let w=e[l];w===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",l),w=new cn),i[o++]=w.x,i[o++]=w.y,i[o++]=w.z,i[o++]=w.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,o=this.count;i<o;i++)Vc.fromBufferAttribute(this,i),Vc.applyMatrix3(e),this.setXY(i,Vc.x,Vc.y);else if(this.itemSize===3)for(let i=0,o=this.count;i<o;i++)ii.fromBufferAttribute(this,i),ii.applyMatrix3(e),this.setXYZ(i,ii.x,ii.y,ii.z);return this}applyMatrix4(e){for(let i=0,o=this.count;i<o;i++)ii.x=this.getX(i),ii.y=this.getY(i),ii.z=this.getZ(i),ii.applyMatrix4(e),this.setXYZ(i,ii.x,ii.y,ii.z);return this}applyNormalMatrix(e){for(let i=0,o=this.count;i<o;i++)ii.x=this.getX(i),ii.y=this.getY(i),ii.z=this.getZ(i),ii.applyNormalMatrix(e),this.setXYZ(i,ii.x,ii.y,ii.z);return this}transformDirection(e){for(let i=0,o=this.count;i<o;i++)ii.x=this.getX(i),ii.y=this.getY(i),ii.z=this.getZ(i),ii.transformDirection(e),this.setXYZ(i,ii.x,ii.y,ii.z);return this}set(e,i=0){return this.array.set(e,i),this}getX(e){return this.array[e*this.itemSize]}setX(e,i){return this.array[e*this.itemSize]=i,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,i){return this.array[e*this.itemSize+1]=i,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,i){return this.array[e*this.itemSize+2]=i,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,i){return this.array[e*this.itemSize+3]=i,this}setXY(e,i,o){return e*=this.itemSize,this.array[e+0]=i,this.array[e+1]=o,this}setXYZ(e,i,o,l){return e*=this.itemSize,this.array[e+0]=i,this.array[e+1]=o,this.array[e+2]=l,this}setXYZW(e,i,o,l,d){return e*=this.itemSize,this.array[e+0]=i,this.array[e+1]=o,this.array[e+2]=l,this.array[e+3]=d,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Uu&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}ti.prototype.isBufferAttribute=!0;class qu extends ti{constructor(e,i,o){super(new Int8Array(e),i,o)}}class $f extends ti{constructor(e,i,o){super(new Uint8Array(e),i,o)}}class Wc extends ti{constructor(e,i,o){super(new Uint8ClampedArray(e),i,o)}}class Hc extends ti{constructor(e,i,o){super(new Int16Array(e),i,o)}}class qc extends ti{constructor(e,i,o){super(new Uint16Array(e),i,o)}}class vd extends ti{constructor(e,i,o){super(new Int32Array(e),i,o)}}class Dl extends ti{constructor(e,i,o){super(new Uint32Array(e),i,o)}}class fo extends ti{constructor(e,i,o){super(new Uint16Array(e),i,o)}}fo.prototype.isFloat16BufferAttribute=!0;class Qr extends ti{constructor(e,i,o){super(new Float32Array(e),i,o)}}class Fo extends ti{constructor(e,i,o){super(new Float64Array(e),i,o)}}let Xu=0;const rs=new jr,Xc=new Gn,Di=new dt,Xi=new Ja,Zs=new Ja,Aa=new dt;class An extends Vs{constructor(){super(),Object.defineProperty(this,"id",{value:Xu++}),this.uuid=os(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Er(e)?Dl:qc)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,o=0){this.groups.push({start:e,count:i,materialIndex:o})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const o=this.attributes.normal;if(o!==void 0){const d=new Yt().getNormalMatrix(e);o.applyNormalMatrix(d),o.needsUpdate=!0}const l=this.attributes.tangent;return l!==void 0&&(l.transformDirection(e),l.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return rs.makeRotationFromQuaternion(e),this.applyMatrix4(rs),this}rotateX(e){return rs.makeRotationX(e),this.applyMatrix4(rs),this}rotateY(e){return rs.makeRotationY(e),this.applyMatrix4(rs),this}rotateZ(e){return rs.makeRotationZ(e),this.applyMatrix4(rs),this}translate(e,i,o){return rs.makeTranslation(e,i,o),this.applyMatrix4(rs),this}scale(e,i,o){return rs.makeScale(e,i,o),this.applyMatrix4(rs),this}lookAt(e){return Xc.lookAt(e),Xc.updateMatrix(),this.applyMatrix4(Xc.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Di).negate(),this.translate(Di.x,Di.y,Di.z),this}setFromPoints(e){const i=[];for(let o=0,l=e.length;o<l;o++){const d=e[o];i.push(d.x,d.y,d.z||0)}return this.setAttribute("position",new Qr(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ja);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new dt(-1/0,-1/0,-1/0),new dt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let o=0,l=i.length;o<l;o++){const d=i[o];Xi.setFromBufferAttribute(d),this.morphTargetsRelative?(Aa.addVectors(this.boundingBox.min,Xi.min),this.boundingBox.expandByPoint(Aa),Aa.addVectors(this.boundingBox.max,Xi.max),this.boundingBox.expandByPoint(Aa)):(this.boundingBox.expandByPoint(Xi.min),this.boundingBox.expandByPoint(Xi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new mu);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new dt,1/0);return}if(e){const o=this.boundingSphere.center;if(Xi.setFromBufferAttribute(e),i)for(let d=0,w=i.length;d<w;d++){const I=i[d];Zs.setFromBufferAttribute(I),this.morphTargetsRelative?(Aa.addVectors(Xi.min,Zs.min),Xi.expandByPoint(Aa),Aa.addVectors(Xi.max,Zs.max),Xi.expandByPoint(Aa)):(Xi.expandByPoint(Zs.min),Xi.expandByPoint(Zs.max))}Xi.getCenter(o);let l=0;for(let d=0,w=e.count;d<w;d++)Aa.fromBufferAttribute(e,d),l=Math.max(l,o.distanceToSquared(Aa));if(i)for(let d=0,w=i.length;d<w;d++){const I=i[d],J=this.morphTargetsRelative;for(let ee=0,he=I.count;ee<he;ee++)Aa.fromBufferAttribute(I,ee),J&&(Di.fromBufferAttribute(e,ee),Aa.add(Di)),l=Math.max(l,o.distanceToSquared(Aa))}this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const o=e.array,l=i.position.array,d=i.normal.array,w=i.uv.array,I=l.length/3;i.tangent===void 0&&this.setAttribute("tangent",new ti(new Float32Array(4*I),4));const J=i.tangent.array,ee=[],he=[];for(let Xt=0;Xt<I;Xt++)ee[Xt]=new dt,he[Xt]=new dt;const fe=new dt,de=new dt,ve=new dt,Ce=new We,Ne=new We,Ke=new We,Oe=new dt,xe=new dt;function ut(Xt,it,Pt){fe.fromArray(l,Xt*3),de.fromArray(l,it*3),ve.fromArray(l,Pt*3),Ce.fromArray(w,Xt*2),Ne.fromArray(w,it*2),Ke.fromArray(w,Pt*2),de.sub(fe),ve.sub(fe),Ne.sub(Ce),Ke.sub(Ce);const Vt=1/(Ne.x*Ke.y-Ke.x*Ne.y);!isFinite(Vt)||(Oe.copy(de).multiplyScalar(Ke.y).addScaledVector(ve,-Ne.y).multiplyScalar(Vt),xe.copy(ve).multiplyScalar(Ne.x).addScaledVector(de,-Ke.x).multiplyScalar(Vt),ee[Xt].add(Oe),ee[it].add(Oe),ee[Pt].add(Oe),he[Xt].add(xe),he[it].add(xe),he[Pt].add(xe))}let rt=this.groups;rt.length===0&&(rt=[{start:0,count:o.length}]);for(let Xt=0,it=rt.length;Xt<it;++Xt){const Pt=rt[Xt],Vt=Pt.start,Zt=Pt.count;for(let Jt=Vt,jt=Vt+Zt;Jt<jt;Jt+=3)ut(o[Jt+0],o[Jt+1],o[Jt+2])}const ft=new dt,Mt=new dt,Rt=new dt,kt=new dt;function nr(Xt){Rt.fromArray(d,Xt*3),kt.copy(Rt);const it=ee[Xt];ft.copy(it),ft.sub(Rt.multiplyScalar(Rt.dot(it))).normalize(),Mt.crossVectors(kt,it);const Vt=Mt.dot(he[Xt])<0?-1:1;J[Xt*4]=ft.x,J[Xt*4+1]=ft.y,J[Xt*4+2]=ft.z,J[Xt*4+3]=Vt}for(let Xt=0,it=rt.length;Xt<it;++Xt){const Pt=rt[Xt],Vt=Pt.start,Zt=Pt.count;for(let Jt=Vt,jt=Vt+Zt;Jt<jt;Jt+=3)nr(o[Jt+0]),nr(o[Jt+1]),nr(o[Jt+2])}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new ti(new Float32Array(i.count*3),3),this.setAttribute("normal",o);else for(let de=0,ve=o.count;de<ve;de++)o.setXYZ(de,0,0,0);const l=new dt,d=new dt,w=new dt,I=new dt,J=new dt,ee=new dt,he=new dt,fe=new dt;if(e)for(let de=0,ve=e.count;de<ve;de+=3){const Ce=e.getX(de+0),Ne=e.getX(de+1),Ke=e.getX(de+2);l.fromBufferAttribute(i,Ce),d.fromBufferAttribute(i,Ne),w.fromBufferAttribute(i,Ke),he.subVectors(w,d),fe.subVectors(l,d),he.cross(fe),I.fromBufferAttribute(o,Ce),J.fromBufferAttribute(o,Ne),ee.fromBufferAttribute(o,Ke),I.add(he),J.add(he),ee.add(he),o.setXYZ(Ce,I.x,I.y,I.z),o.setXYZ(Ne,J.x,J.y,J.z),o.setXYZ(Ke,ee.x,ee.y,ee.z)}else for(let de=0,ve=i.count;de<ve;de+=3)l.fromBufferAttribute(i,de+0),d.fromBufferAttribute(i,de+1),w.fromBufferAttribute(i,de+2),he.subVectors(w,d),fe.subVectors(l,d),he.cross(fe),o.setXYZ(de+0,he.x,he.y,he.z),o.setXYZ(de+1,he.x,he.y,he.z),o.setXYZ(de+2,he.x,he.y,he.z);this.normalizeNormals(),o.needsUpdate=!0}}merge(e,i){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const o=this.attributes;for(const l in o){if(e.attributes[l]===void 0)continue;const w=o[l].array,I=e.attributes[l],J=I.array,ee=I.itemSize*i,he=Math.min(J.length,w.length-ee);for(let fe=0,de=ee;fe<he;fe++,de++)w[de]=J[fe]}return this}normalizeNormals(){const e=this.attributes.normal;for(let i=0,o=e.count;i<o;i++)Aa.fromBufferAttribute(e,i),Aa.normalize(),e.setXYZ(i,Aa.x,Aa.y,Aa.z)}toNonIndexed(){function e(I,J){const ee=I.array,he=I.itemSize,fe=I.normalized,de=new ee.constructor(J.length*he);let ve=0,Ce=0;for(let Ne=0,Ke=J.length;Ne<Ke;Ne++){I.isInterleavedBufferAttribute?ve=J[Ne]*I.data.stride+I.offset:ve=J[Ne]*he;for(let Oe=0;Oe<he;Oe++)de[Ce++]=ee[ve++]}return new ti(de,he,fe)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new An,o=this.index.array,l=this.attributes;for(const I in l){const J=l[I],ee=e(J,o);i.setAttribute(I,ee)}const d=this.morphAttributes;for(const I in d){const J=[],ee=d[I];for(let he=0,fe=ee.length;he<fe;he++){const de=ee[he],ve=e(de,o);J.push(ve)}i.morphAttributes[I]=J}i.morphTargetsRelative=this.morphTargetsRelative;const w=this.groups;for(let I=0,J=w.length;I<J;I++){const ee=w[I];i.addGroup(ee.start,ee.count,ee.materialIndex)}return i}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const J=this.parameters;for(const ee in J)J[ee]!==void 0&&(e[ee]=J[ee]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const o=this.attributes;for(const J in o){const ee=o[J];e.data.attributes[J]=ee.toJSON(e.data)}const l={};let d=!1;for(const J in this.morphAttributes){const ee=this.morphAttributes[J],he=[];for(let fe=0,de=ee.length;fe<de;fe++){const ve=ee[fe];he.push(ve.toJSON(e.data))}he.length>0&&(l[J]=he,d=!0)}d&&(e.data.morphAttributes=l,e.data.morphTargetsRelative=this.morphTargetsRelative);const w=this.groups;w.length>0&&(e.data.groups=JSON.parse(JSON.stringify(w)));const I=this.boundingSphere;return I!==null&&(e.data.boundingSphere={center:I.center.toArray(),radius:I.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const o=e.index;o!==null&&this.setIndex(o.clone(i));const l=e.attributes;for(const ee in l){const he=l[ee];this.setAttribute(ee,he.clone(i))}const d=e.morphAttributes;for(const ee in d){const he=[],fe=d[ee];for(let de=0,ve=fe.length;de<ve;de++)he.push(fe[de].clone(i));this.morphAttributes[ee]=he}this.morphTargetsRelative=e.morphTargetsRelative;const w=e.groups;for(let ee=0,he=w.length;ee<he;ee++){const fe=w[ee];this.addGroup(fe.start,fe.count,fe.materialIndex)}const I=e.boundingBox;I!==null&&(this.boundingBox=I.clone());const J=e.boundingSphere;return J!==null&&(this.boundingSphere=J.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}An.prototype.isBufferGeometry=!0;const Qf=new jr,gu=new Co,Io=new mu,ko=new dt,Do=new dt,No=new dt,Kf=new dt,Zc=new dt,Zu=new dt,ju=new dt,jc=new dt,Nl=new dt,Bl=new We,yu=new We,Ul=new We,Yu=new dt,Yc=new dt;class ra extends Gn{constructor(e=new An,i=new co){super(),this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e){return super.copy(e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const i=e.morphAttributes,o=Object.keys(i);if(o.length>0){const l=i[o[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,w=l.length;d<w;d++){const I=l[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[I]=d}}}}else{const i=e.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,i){const o=this.geometry,l=this.material,d=this.matrixWorld;if(l===void 0||(o.boundingSphere===null&&o.computeBoundingSphere(),Io.copy(o.boundingSphere),Io.applyMatrix4(d),e.ray.intersectsSphere(Io)===!1)||(Qf.copy(d).invert(),gu.copy(e.ray).applyMatrix4(Qf),o.boundingBox!==null&&gu.intersectsBox(o.boundingBox)===!1))return;let w;if(o.isBufferGeometry){const I=o.index,J=o.attributes.position,ee=o.morphAttributes.position,he=o.morphTargetsRelative,fe=o.attributes.uv,de=o.attributes.uv2,ve=o.groups,Ce=o.drawRange;if(I!==null)if(Array.isArray(l))for(let Ne=0,Ke=ve.length;Ne<Ke;Ne++){const Oe=ve[Ne],xe=l[Oe.materialIndex],ut=Math.max(Oe.start,Ce.start),rt=Math.min(I.count,Math.min(Oe.start+Oe.count,Ce.start+Ce.count));for(let ft=ut,Mt=rt;ft<Mt;ft+=3){const Rt=I.getX(ft),kt=I.getX(ft+1),nr=I.getX(ft+2);w=Gl(this,xe,e,gu,J,ee,he,fe,de,Rt,kt,nr),w&&(w.faceIndex=Math.floor(ft/3),w.face.materialIndex=Oe.materialIndex,i.push(w))}}else{const Ne=Math.max(0,Ce.start),Ke=Math.min(I.count,Ce.start+Ce.count);for(let Oe=Ne,xe=Ke;Oe<xe;Oe+=3){const ut=I.getX(Oe),rt=I.getX(Oe+1),ft=I.getX(Oe+2);w=Gl(this,l,e,gu,J,ee,he,fe,de,ut,rt,ft),w&&(w.faceIndex=Math.floor(Oe/3),i.push(w))}}else if(J!==void 0)if(Array.isArray(l))for(let Ne=0,Ke=ve.length;Ne<Ke;Ne++){const Oe=ve[Ne],xe=l[Oe.materialIndex],ut=Math.max(Oe.start,Ce.start),rt=Math.min(J.count,Math.min(Oe.start+Oe.count,Ce.start+Ce.count));for(let ft=ut,Mt=rt;ft<Mt;ft+=3){const Rt=ft,kt=ft+1,nr=ft+2;w=Gl(this,xe,e,gu,J,ee,he,fe,de,Rt,kt,nr),w&&(w.faceIndex=Math.floor(ft/3),w.face.materialIndex=Oe.materialIndex,i.push(w))}}else{const Ne=Math.max(0,Ce.start),Ke=Math.min(J.count,Ce.start+Ce.count);for(let Oe=Ne,xe=Ke;Oe<xe;Oe+=3){const ut=Oe,rt=Oe+1,ft=Oe+2;w=Gl(this,l,e,gu,J,ee,he,fe,de,ut,rt,ft),w&&(w.faceIndex=Math.floor(Oe/3),i.push(w))}}}else o.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}ra.prototype.isMesh=!0;function zl(f,e,i,o,l,d,w,I){let J;if(e.side===V?J=o.intersectTriangle(w,d,l,!0,I):J=o.intersectTriangle(l,d,w,e.side!==P,I),J===null)return null;Yc.copy(I),Yc.applyMatrix4(f.matrixWorld);const ee=i.ray.origin.distanceTo(Yc);return ee<i.near||ee>i.far?null:{distance:ee,point:Yc.clone(),object:f}}function Gl(f,e,i,o,l,d,w,I,J,ee,he,fe){ko.fromBufferAttribute(l,ee),Do.fromBufferAttribute(l,he),No.fromBufferAttribute(l,fe);const de=f.morphTargetInfluences;if(d&&de){ju.set(0,0,0),jc.set(0,0,0),Nl.set(0,0,0);for(let Ce=0,Ne=d.length;Ce<Ne;Ce++){const Ke=de[Ce],Oe=d[Ce];Ke!==0&&(Kf.fromBufferAttribute(Oe,ee),Zc.fromBufferAttribute(Oe,he),Zu.fromBufferAttribute(Oe,fe),w?(ju.addScaledVector(Kf,Ke),jc.addScaledVector(Zc,Ke),Nl.addScaledVector(Zu,Ke)):(ju.addScaledVector(Kf.sub(ko),Ke),jc.addScaledVector(Zc.sub(Do),Ke),Nl.addScaledVector(Zu.sub(No),Ke)))}ko.add(ju),Do.add(jc),No.add(Nl)}f.isSkinnedMesh&&(f.boneTransform(ee,ko),f.boneTransform(he,Do),f.boneTransform(fe,No));const ve=zl(f,e,i,o,ko,Do,No,Yu);if(ve){I&&(Bl.fromBufferAttribute(I,ee),yu.fromBufferAttribute(I,he),Ul.fromBufferAttribute(I,fe),ve.uv=zi.getUV(Yu,ko,Do,No,Bl,yu,Ul,new We)),J&&(Bl.fromBufferAttribute(J,ee),yu.fromBufferAttribute(J,he),Ul.fromBufferAttribute(J,fe),ve.uv2=zi.getUV(Yu,ko,Do,No,Bl,yu,Ul,new We));const Ce={a:ee,b:he,c:fe,normal:new dt,materialIndex:0};zi.getNormal(ko,Do,No,Ce.normal),ve.face=Ce}return ve}class ho extends An{constructor(e=1,i=1,o=1,l=1,d=1,w=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:o,widthSegments:l,heightSegments:d,depthSegments:w};const I=this;l=Math.floor(l),d=Math.floor(d),w=Math.floor(w);const J=[],ee=[],he=[],fe=[];let de=0,ve=0;Ce("z","y","x",-1,-1,o,i,e,w,d,0),Ce("z","y","x",1,-1,o,i,-e,w,d,1),Ce("x","z","y",1,1,e,o,i,l,w,2),Ce("x","z","y",1,-1,e,o,-i,l,w,3),Ce("x","y","z",1,-1,e,i,o,l,d,4),Ce("x","y","z",-1,-1,e,i,-o,l,d,5),this.setIndex(J),this.setAttribute("position",new Qr(ee,3)),this.setAttribute("normal",new Qr(he,3)),this.setAttribute("uv",new Qr(fe,2));function Ce(Ne,Ke,Oe,xe,ut,rt,ft,Mt,Rt,kt,nr){const Xt=rt/Rt,it=ft/kt,Pt=rt/2,Vt=ft/2,Zt=Mt/2,Jt=Rt+1,jt=kt+1;let ir=0,Sr=0;const Hr=new dt;for(let or=0;or<jt;or++){const tr=or*it-Vt;for(let Br=0;Br<Jt;Br++){const nn=Br*Xt-Pt;Hr[Ne]=nn*xe,Hr[Ke]=tr*ut,Hr[Oe]=Zt,ee.push(Hr.x,Hr.y,Hr.z),Hr[Ne]=0,Hr[Ke]=0,Hr[Oe]=Mt>0?1:-1,he.push(Hr.x,Hr.y,Hr.z),fe.push(Br/Rt),fe.push(1-or/kt),ir+=1}}for(let or=0;or<kt;or++)for(let tr=0;tr<Rt;tr++){const Br=de+tr+Jt*or,nn=de+tr+Jt*(or+1),vn=de+(tr+1)+Jt*(or+1),Ft=de+(tr+1)+Jt*or;J.push(Br,nn,Ft),J.push(nn,vn,Ft),Sr+=6}I.addGroup(ve,Sr,nr),ve+=Sr,de+=ir}}static fromJSON(e){return new ho(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ju(f){const e={};for(const i in f){e[i]={};for(const o in f[i]){const l=f[i][o];l&&(l.isColor||l.isMatrix3||l.isMatrix4||l.isVector2||l.isVector3||l.isVector4||l.isTexture||l.isQuaternion)?e[i][o]=l.clone():Array.isArray(l)?e[i][o]=l.slice():e[i][o]=l}}return e}function Na(f){const e={};for(let i=0;i<f.length;i++){const o=Ju(f[i]);for(const l in o)e[l]=o[l]}return e}const gd={clone:Ju,merge:Na};var J0=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$0=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Jn extends Ti{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=J0,this.fragmentShader=$0,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ju(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const l in this.uniforms){const w=this.uniforms[l].value;w&&w.isTexture?i.uniforms[l]={type:"t",value:w.toJSON(e).uuid}:w&&w.isColor?i.uniforms[l]={type:"c",value:w.getHex()}:w&&w.isVector2?i.uniforms[l]={type:"v2",value:w.toArray()}:w&&w.isVector3?i.uniforms[l]={type:"v3",value:w.toArray()}:w&&w.isVector4?i.uniforms[l]={type:"v4",value:w.toArray()}:w&&w.isMatrix3?i.uniforms[l]={type:"m3",value:w.toArray()}:w&&w.isMatrix4?i.uniforms[l]={type:"m4",value:w.toArray()}:i.uniforms[l]={value:w}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const o={};for(const l in this.extensions)this.extensions[l]===!0&&(o[l]=!0);return Object.keys(o).length>0&&(i.extensions=o),i}}Jn.prototype.isShaderMaterial=!0;class Qn extends Gn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new jr,this.projectionMatrix=new jr,this.projectionMatrixInverse=new jr}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}Qn.prototype.isCamera=!0;class da extends Qn{constructor(e=50,i=1,o=.1,l=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=o,this.far=l,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=Al*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ja*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Al*2*Math.atan(Math.tan(ja*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,i,o,l,d,w){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=o,this.view.offsetY=l,this.view.width=d,this.view.height=w,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(ja*.5*this.fov)/this.zoom,o=2*i,l=this.aspect*o,d=-.5*l;const w=this.view;if(this.view!==null&&this.view.enabled){const J=w.fullWidth,ee=w.fullHeight;d+=w.offsetX*l/J,i-=w.offsetY*o/ee,l*=w.width/J,o*=w.height/ee}const I=this.filmOffset;I!==0&&(d+=e*I/this.getFilmWidth()),this.projectionMatrix.makePerspective(d,d+l,i,i-o,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}da.prototype.isPerspectiveCamera=!0;const Bo=90,js=1;class Jc extends Gn{constructor(e,i,o){if(super(),this.type="CubeCamera",o.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=o;const l=new da(Bo,js,e,i);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new dt(1,0,0)),this.add(l);const d=new da(Bo,js,e,i);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new dt(-1,0,0)),this.add(d);const w=new da(Bo,js,e,i);w.layers=this.layers,w.up.set(0,0,1),w.lookAt(new dt(0,1,0)),this.add(w);const I=new da(Bo,js,e,i);I.layers=this.layers,I.up.set(0,0,-1),I.lookAt(new dt(0,-1,0)),this.add(I);const J=new da(Bo,js,e,i);J.layers=this.layers,J.up.set(0,-1,0),J.lookAt(new dt(0,0,1)),this.add(J);const ee=new da(Bo,js,e,i);ee.layers=this.layers,ee.up.set(0,-1,0),ee.lookAt(new dt(0,0,-1)),this.add(ee)}update(e,i){this.parent===null&&this.updateMatrixWorld();const o=this.renderTarget,[l,d,w,I,J,ee]=this.children,he=e.xr.enabled,fe=e.getRenderTarget();e.xr.enabled=!1;const de=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,e.setRenderTarget(o,0),e.render(i,l),e.setRenderTarget(o,1),e.render(i,d),e.setRenderTarget(o,2),e.render(i,w),e.setRenderTarget(o,3),e.render(i,I),e.setRenderTarget(o,4),e.render(i,J),o.texture.generateMipmaps=de,e.setRenderTarget(o,5),e.render(i,ee),e.setRenderTarget(fe),e.xr.enabled=he,o.texture.needsPMREMUpdate=!0}}class $u extends Cn{constructor(e,i,o,l,d,w,I,J,ee,he){e=e!==void 0?e:[],i=i!==void 0?i:me,super(e,i,o,l,d,w,I,J,ee,he),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}$u.prototype.isCubeTexture=!0;class _u extends Ta{constructor(e,i,o){Number.isInteger(i)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),i=o),super(e,e,i),i=i||{},this.texture=new $u(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:at}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.format=xn,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const o={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},l=new ho(5,5,5),d=new Jn({name:"CubemapFromEquirect",uniforms:Ju(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,side:V,blending:b});d.uniforms.tEquirect.value=i;const w=new ra(l,d),I=i.minFilter;return i.minFilter===_t&&(i.minFilter=at),new Jc(1,10,this).update(e,w),i.minFilter=I,w.geometry.dispose(),w.material.dispose(),this}clear(e,i,o,l){const d=e.getRenderTarget();for(let w=0;w<6;w++)e.setRenderTarget(this,w),e.clear(i,o,l);e.setRenderTarget(d)}}_u.prototype.isWebGLCubeRenderTarget=!0;const $c=new dt,yd=new dt,Q0=new Yt;class Ys{constructor(e=new dt(1,0,0),i=0){this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,o,l){return this.normal.set(e,i,o),this.constant=l,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,o){const l=$c.subVectors(o,i).cross(yd.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(l,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,i){const o=e.delta($c),l=this.normal.dot(o);if(l===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const d=-(e.start.dot(this.normal)+this.constant)/l;return d<0||d>1?null:i.copy(o).multiplyScalar(d).add(e.start)}intersectsLine(e){const i=this.distanceToPoint(e.start),o=this.distanceToPoint(e.end);return i<0&&o>0||o<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const o=i||Q0.getNormalMatrix(e),l=this.coplanarPoint($c).applyMatrix4(e),d=this.normal.applyMatrix3(o).normalize();return this.constant=-l.dot(d),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}Ys.prototype.isPlane=!0;const _r=new mu,xu=new dt;class Ba{constructor(e=new Ys,i=new Ys,o=new Ys,l=new Ys,d=new Ys,w=new Ys){this.planes=[e,i,o,l,d,w]}set(e,i,o,l,d,w){const I=this.planes;return I[0].copy(e),I[1].copy(i),I[2].copy(o),I[3].copy(l),I[4].copy(d),I[5].copy(w),this}copy(e){const i=this.planes;for(let o=0;o<6;o++)i[o].copy(e.planes[o]);return this}setFromProjectionMatrix(e){const i=this.planes,o=e.elements,l=o[0],d=o[1],w=o[2],I=o[3],J=o[4],ee=o[5],he=o[6],fe=o[7],de=o[8],ve=o[9],Ce=o[10],Ne=o[11],Ke=o[12],Oe=o[13],xe=o[14],ut=o[15];return i[0].setComponents(I-l,fe-J,Ne-de,ut-Ke).normalize(),i[1].setComponents(I+l,fe+J,Ne+de,ut+Ke).normalize(),i[2].setComponents(I+d,fe+ee,Ne+ve,ut+Oe).normalize(),i[3].setComponents(I-d,fe-ee,Ne-ve,ut-Oe).normalize(),i[4].setComponents(I-w,fe-he,Ne-Ce,ut-xe).normalize(),i[5].setComponents(I+w,fe+he,Ne+Ce,ut+xe).normalize(),this}intersectsObject(e){const i=e.geometry;return i.boundingSphere===null&&i.computeBoundingSphere(),_r.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(_r)}intersectsSprite(e){return _r.center.set(0,0,0),_r.radius=.7071067811865476,_r.applyMatrix4(e.matrixWorld),this.intersectsSphere(_r)}intersectsSphere(e){const i=this.planes,o=e.center,l=-e.radius;for(let d=0;d<6;d++)if(i[d].distanceToPoint(o)<l)return!1;return!0}intersectsBox(e){const i=this.planes;for(let o=0;o<6;o++){const l=i[o];if(xu.x=l.normal.x>0?e.max.x:e.min.x,xu.y=l.normal.y>0?e.max.y:e.min.y,xu.z=l.normal.z>0?e.max.z:e.min.z,l.distanceToPoint(xu)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let o=0;o<6;o++)if(i[o].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function eh(){let f=null,e=!1,i=null,o=null;function l(d,w){i(d,w),o=f.requestAnimationFrame(l)}return{start:function(){e!==!0&&i!==null&&(o=f.requestAnimationFrame(l),e=!0)},stop:function(){f.cancelAnimationFrame(o),e=!1},setAnimationLoop:function(d){i=d},setContext:function(d){f=d}}}function _d(f,e){const i=e.isWebGL2,o=new WeakMap;function l(ee,he){const fe=ee.array,de=ee.usage,ve=f.createBuffer();f.bindBuffer(he,ve),f.bufferData(he,fe,de),ee.onUploadCallback();let Ce=f.FLOAT;return fe instanceof Float32Array?Ce=f.FLOAT:fe instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):fe instanceof Uint16Array?ee.isFloat16BufferAttribute?i?Ce=f.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):Ce=f.UNSIGNED_SHORT:fe instanceof Int16Array?Ce=f.SHORT:fe instanceof Uint32Array?Ce=f.UNSIGNED_INT:fe instanceof Int32Array?Ce=f.INT:fe instanceof Int8Array?Ce=f.BYTE:(fe instanceof Uint8Array||fe instanceof Uint8ClampedArray)&&(Ce=f.UNSIGNED_BYTE),{buffer:ve,type:Ce,bytesPerElement:fe.BYTES_PER_ELEMENT,version:ee.version}}function d(ee,he,fe){const de=he.array,ve=he.updateRange;f.bindBuffer(fe,ee),ve.count===-1?f.bufferSubData(fe,0,de):(i?f.bufferSubData(fe,ve.offset*de.BYTES_PER_ELEMENT,de,ve.offset,ve.count):f.bufferSubData(fe,ve.offset*de.BYTES_PER_ELEMENT,de.subarray(ve.offset,ve.offset+ve.count)),ve.count=-1)}function w(ee){return ee.isInterleavedBufferAttribute&&(ee=ee.data),o.get(ee)}function I(ee){ee.isInterleavedBufferAttribute&&(ee=ee.data);const he=o.get(ee);he&&(f.deleteBuffer(he.buffer),o.delete(ee))}function J(ee,he){if(ee.isGLBufferAttribute){const de=o.get(ee);(!de||de.version<ee.version)&&o.set(ee,{buffer:ee.buffer,type:ee.type,bytesPerElement:ee.elementSize,version:ee.version});return}ee.isInterleavedBufferAttribute&&(ee=ee.data);const fe=o.get(ee);fe===void 0?o.set(ee,l(ee,he)):fe.version<ee.version&&(d(fe.buffer,ee,he),fe.version=ee.version)}return{get:w,remove:I,update:J}}class po extends An{constructor(e=1,i=1,o=1,l=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:o,heightSegments:l};const d=e/2,w=i/2,I=Math.floor(o),J=Math.floor(l),ee=I+1,he=J+1,fe=e/I,de=i/J,ve=[],Ce=[],Ne=[],Ke=[];for(let Oe=0;Oe<he;Oe++){const xe=Oe*de-w;for(let ut=0;ut<ee;ut++){const rt=ut*fe-d;Ce.push(rt,-xe,0),Ne.push(0,0,1),Ke.push(ut/I),Ke.push(1-Oe/J)}}for(let Oe=0;Oe<J;Oe++)for(let xe=0;xe<I;xe++){const ut=xe+ee*Oe,rt=xe+ee*(Oe+1),ft=xe+1+ee*(Oe+1),Mt=xe+1+ee*Oe;ve.push(ut,rt,Mt),ve.push(rt,ft,Mt)}this.setIndex(ve),this.setAttribute("position",new Qr(Ce,3)),this.setAttribute("normal",new Qr(Ne,3)),this.setAttribute("uv",new Qr(Ke,2))}static fromJSON(e){return new po(e.width,e.height,e.widthSegments,e.heightSegments)}}var wa=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Qc=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ls=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Ua=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,za=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,th=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xd="vec3 transformed = vec3( position );",Ad=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,K0=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,ep=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,tp=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Qu=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,wd=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,rp=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,np=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,ip=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,ap=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,sp=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,op=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,up=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		return texture2D( envMap, uv ).rgb;
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Md=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Vl=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Xn=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Wl=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,rh=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,lp="gl_FragColor = linearToOutputTexel( gl_FragColor );",cp=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,fp=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,pa=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,bd=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Kc=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Hl=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,ql=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Ed=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,nh=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,ih=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ah=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,sh=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,hp=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Ma=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,Td=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,dp=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,ef=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,S=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,A=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,k=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,le=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,Pe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,De=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,He=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,nt=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Tt=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,At=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Ht=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Wt=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,yr=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,br=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Wr=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,vr=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rn=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Yr=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,$t=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Mr=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Nr=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,an=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,fn=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Hn=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,na=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ai=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ws=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Uo=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Au=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,mo=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Ni=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,ba=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Ms=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,vo=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,oh=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,uh=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Gr=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,mn=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,kn=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,wi=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Mi=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Li=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Si=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,pi=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,Ca=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,ns=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Ga=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Va=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,bs=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Fs=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,zo=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,wu=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,Es=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,Go=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,Vo=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,Wo=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,Ho=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,qo=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,Xo=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Kn={alphamap_fragment:wa,alphamap_pars_fragment:Qc,alphatest_fragment:ls,alphatest_pars_fragment:Ua,aomap_fragment:za,aomap_pars_fragment:th,begin_vertex:xd,beginnormal_vertex:Ad,bsdfs:K0,bumpmap_pars_fragment:ep,clipping_planes_fragment:tp,clipping_planes_pars_fragment:Qu,clipping_planes_pars_vertex:wd,clipping_planes_vertex:rp,color_fragment:np,color_pars_fragment:ip,color_pars_vertex:ap,color_vertex:sp,common:op,cube_uv_reflection_fragment:up,defaultnormal_vertex:Md,displacementmap_pars_vertex:Vl,displacementmap_vertex:Xn,emissivemap_fragment:Wl,emissivemap_pars_fragment:rh,encodings_fragment:lp,encodings_pars_fragment:cp,envmap_fragment:fp,envmap_common_pars_fragment:pa,envmap_pars_fragment:bd,envmap_pars_vertex:Kc,envmap_physical_pars_fragment:dp,envmap_vertex:Hl,fog_vertex:ql,fog_pars_vertex:Ed,fog_fragment:nh,fog_pars_fragment:ih,gradientmap_pars_fragment:ah,lightmap_fragment:sh,lightmap_pars_fragment:hp,lights_lambert_vertex:Ma,lights_pars_begin:Td,lights_toon_fragment:ef,lights_toon_pars_fragment:S,lights_phong_fragment:A,lights_phong_pars_fragment:k,lights_physical_fragment:le,lights_physical_pars_fragment:Pe,lights_fragment_begin:De,lights_fragment_maps:He,lights_fragment_end:nt,logdepthbuf_fragment:Tt,logdepthbuf_pars_fragment:At,logdepthbuf_pars_vertex:Ht,logdepthbuf_vertex:Wt,map_fragment:yr,map_pars_fragment:br,map_particle_fragment:Wr,map_particle_pars_fragment:vr,metalnessmap_fragment:rn,metalnessmap_pars_fragment:Yr,morphnormal_vertex:$t,morphtarget_pars_vertex:Mr,morphtarget_vertex:Nr,normal_fragment_begin:an,normal_fragment_maps:fn,normal_pars_fragment:Hn,normal_pars_vertex:na,normal_vertex:ai,normalmap_pars_fragment:ws,clearcoat_normal_fragment_begin:Uo,clearcoat_normal_fragment_maps:Au,clearcoat_pars_fragment:mo,output_fragment:Ni,packing:ba,premultiplied_alpha_fragment:Ms,project_vertex:vo,dithering_fragment:oh,dithering_pars_fragment:uh,roughnessmap_fragment:Gr,roughnessmap_pars_fragment:mn,shadowmap_pars_fragment:kn,shadowmap_pars_vertex:wi,shadowmap_vertex:Mi,shadowmask_pars_fragment:Li,skinbase_vertex:Si,skinning_pars_vertex:pi,skinning_vertex:Ca,skinnormal_vertex:ns,specularmap_fragment:Ga,specularmap_pars_fragment:Va,tonemapping_fragment:bs,tonemapping_pars_fragment:Fs,transmission_fragment:zo,transmission_pars_fragment:wu,uv_pars_fragment:Es,uv_pars_vertex:Go,uv_vertex:Vo,uv2_pars_fragment:Wo,uv2_pars_vertex:Ho,uv2_vertex:qo,worldpos_vertex:Xo,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`},Pr={common:{diffuse:{value:new Or(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Yt},uv2Transform:{value:new Yt},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new We(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Or(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Or(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Yt}},sprite:{diffuse:{value:new Or(16777215)},opacity:{value:1},center:{value:new We(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Yt}}},Qa={basic:{uniforms:Na([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.fog]),vertexShader:Kn.meshbasic_vert,fragmentShader:Kn.meshbasic_frag},lambert:{uniforms:Na([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.fog,Pr.lights,{emissive:{value:new Or(0)}}]),vertexShader:Kn.meshlambert_vert,fragmentShader:Kn.meshlambert_frag},phong:{uniforms:Na([Pr.common,Pr.specularmap,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,Pr.lights,{emissive:{value:new Or(0)},specular:{value:new Or(1118481)},shininess:{value:30}}]),vertexShader:Kn.meshphong_vert,fragmentShader:Kn.meshphong_frag},standard:{uniforms:Na([Pr.common,Pr.envmap,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.roughnessmap,Pr.metalnessmap,Pr.fog,Pr.lights,{emissive:{value:new Or(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag},toon:{uniforms:Na([Pr.common,Pr.aomap,Pr.lightmap,Pr.emissivemap,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.gradientmap,Pr.fog,Pr.lights,{emissive:{value:new Or(0)}}]),vertexShader:Kn.meshtoon_vert,fragmentShader:Kn.meshtoon_frag},matcap:{uniforms:Na([Pr.common,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,Pr.fog,{matcap:{value:null}}]),vertexShader:Kn.meshmatcap_vert,fragmentShader:Kn.meshmatcap_frag},points:{uniforms:Na([Pr.points,Pr.fog]),vertexShader:Kn.points_vert,fragmentShader:Kn.points_frag},dashed:{uniforms:Na([Pr.common,Pr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kn.linedashed_vert,fragmentShader:Kn.linedashed_frag},depth:{uniforms:Na([Pr.common,Pr.displacementmap]),vertexShader:Kn.depth_vert,fragmentShader:Kn.depth_frag},normal:{uniforms:Na([Pr.common,Pr.bumpmap,Pr.normalmap,Pr.displacementmap,{opacity:{value:1}}]),vertexShader:Kn.meshnormal_vert,fragmentShader:Kn.meshnormal_frag},sprite:{uniforms:Na([Pr.sprite,Pr.fog]),vertexShader:Kn.sprite_vert,fragmentShader:Kn.sprite_frag},background:{uniforms:{uvTransform:{value:new Yt},t2D:{value:null}},vertexShader:Kn.background_vert,fragmentShader:Kn.background_frag},cube:{uniforms:Na([Pr.envmap,{opacity:{value:1}}]),vertexShader:Kn.cube_vert,fragmentShader:Kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kn.equirect_vert,fragmentShader:Kn.equirect_frag},distanceRGBA:{uniforms:Na([Pr.common,Pr.displacementmap,{referencePosition:{value:new dt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kn.distanceRGBA_vert,fragmentShader:Kn.distanceRGBA_frag},shadow:{uniforms:Na([Pr.lights,Pr.fog,{color:{value:new Or(0)},opacity:{value:1}}]),vertexShader:Kn.shadow_vert,fragmentShader:Kn.shadow_frag}};Qa.physical={uniforms:Na([Qa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new We(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Or(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new We},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Or(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Or(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag};function vp(f,e,i,o,l,d){const w=new Or(0);let I=l===!0?0:1,J,ee,he=null,fe=0,de=null;function ve(Ne,Ke){let Oe=!1,xe=Ke.isScene===!0?Ke.background:null;xe&&xe.isTexture&&(xe=e.get(xe));const ut=f.xr,rt=ut.getSession&&ut.getSession();rt&&rt.environmentBlendMode==="additive"&&(xe=null),xe===null?Ce(w,I):xe&&xe.isColor&&(Ce(xe,1),Oe=!0),(f.autoClear||Oe)&&f.clear(f.autoClearColor,f.autoClearDepth,f.autoClearStencil),xe&&(xe.isCubeTexture||xe.mapping===lt)?(ee===void 0&&(ee=new ra(new ho(1,1,1),new Jn({name:"BackgroundCubeMaterial",uniforms:Ju(Qa.cube.uniforms),vertexShader:Qa.cube.vertexShader,fragmentShader:Qa.cube.fragmentShader,side:V,depthTest:!1,depthWrite:!1,fog:!1})),ee.geometry.deleteAttribute("normal"),ee.geometry.deleteAttribute("uv"),ee.onBeforeRender=function(ft,Mt,Rt){this.matrixWorld.copyPosition(Rt.matrixWorld)},Object.defineProperty(ee.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(ee)),ee.material.uniforms.envMap.value=xe,ee.material.uniforms.flipEnvMap.value=xe.isCubeTexture&&xe.isRenderTargetTexture===!1?-1:1,(he!==xe||fe!==xe.version||de!==f.toneMapping)&&(ee.material.needsUpdate=!0,he=xe,fe=xe.version,de=f.toneMapping),Ne.unshift(ee,ee.geometry,ee.material,0,0,null)):xe&&xe.isTexture&&(J===void 0&&(J=new ra(new po(2,2),new Jn({name:"BackgroundMaterial",uniforms:Ju(Qa.background.uniforms),vertexShader:Qa.background.vertexShader,fragmentShader:Qa.background.fragmentShader,side:B,depthTest:!1,depthWrite:!1,fog:!1})),J.geometry.deleteAttribute("normal"),Object.defineProperty(J.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(J)),J.material.uniforms.t2D.value=xe,xe.matrixAutoUpdate===!0&&xe.updateMatrix(),J.material.uniforms.uvTransform.value.copy(xe.matrix),(he!==xe||fe!==xe.version||de!==f.toneMapping)&&(J.material.needsUpdate=!0,he=xe,fe=xe.version,de=f.toneMapping),Ne.unshift(J,J.geometry,J.material,0,0,null))}function Ce(Ne,Ke){i.buffers.color.setClear(Ne.r,Ne.g,Ne.b,Ke,d)}return{getClearColor:function(){return w},setClearColor:function(Ne,Ke=1){w.set(Ne),I=Ke,Ce(w,I)},getClearAlpha:function(){return I},setClearAlpha:function(Ne){I=Ne,Ce(w,I)},render:ve}}function sv(f,e,i,o){const l=f.getParameter(f.MAX_VERTEX_ATTRIBS),d=o.isWebGL2?null:e.get("OES_vertex_array_object"),w=o.isWebGL2||d!==null,I={},J=Ne(null);let ee=J;function he(Vt,Zt,Jt,jt,ir){let Sr=!1;if(w){const Hr=Ce(jt,Jt,Zt);ee!==Hr&&(ee=Hr,de(ee.object)),Sr=Ke(jt,ir),Sr&&Oe(jt,ir)}else{const Hr=Zt.wireframe===!0;(ee.geometry!==jt.id||ee.program!==Jt.id||ee.wireframe!==Hr)&&(ee.geometry=jt.id,ee.program=Jt.id,ee.wireframe=Hr,Sr=!0)}Vt.isInstancedMesh===!0&&(Sr=!0),ir!==null&&i.update(ir,f.ELEMENT_ARRAY_BUFFER),Sr&&(Rt(Vt,Zt,Jt,jt),ir!==null&&f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,i.get(ir).buffer))}function fe(){return o.isWebGL2?f.createVertexArray():d.createVertexArrayOES()}function de(Vt){return o.isWebGL2?f.bindVertexArray(Vt):d.bindVertexArrayOES(Vt)}function ve(Vt){return o.isWebGL2?f.deleteVertexArray(Vt):d.deleteVertexArrayOES(Vt)}function Ce(Vt,Zt,Jt){const jt=Jt.wireframe===!0;let ir=I[Vt.id];ir===void 0&&(ir={},I[Vt.id]=ir);let Sr=ir[Zt.id];Sr===void 0&&(Sr={},ir[Zt.id]=Sr);let Hr=Sr[jt];return Hr===void 0&&(Hr=Ne(fe()),Sr[jt]=Hr),Hr}function Ne(Vt){const Zt=[],Jt=[],jt=[];for(let ir=0;ir<l;ir++)Zt[ir]=0,Jt[ir]=0,jt[ir]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Zt,enabledAttributes:Jt,attributeDivisors:jt,object:Vt,attributes:{},index:null}}function Ke(Vt,Zt){const Jt=ee.attributes,jt=Vt.attributes;let ir=0;for(const Sr in jt){const Hr=Jt[Sr],or=jt[Sr];if(Hr===void 0||Hr.attribute!==or||Hr.data!==or.data)return!0;ir++}return ee.attributesNum!==ir||ee.index!==Zt}function Oe(Vt,Zt){const Jt={},jt=Vt.attributes;let ir=0;for(const Sr in jt){const Hr=jt[Sr],or={};or.attribute=Hr,Hr.data&&(or.data=Hr.data),Jt[Sr]=or,ir++}ee.attributes=Jt,ee.attributesNum=ir,ee.index=Zt}function xe(){const Vt=ee.newAttributes;for(let Zt=0,Jt=Vt.length;Zt<Jt;Zt++)Vt[Zt]=0}function ut(Vt){rt(Vt,0)}function rt(Vt,Zt){const Jt=ee.newAttributes,jt=ee.enabledAttributes,ir=ee.attributeDivisors;Jt[Vt]=1,jt[Vt]===0&&(f.enableVertexAttribArray(Vt),jt[Vt]=1),ir[Vt]!==Zt&&((o.isWebGL2?f:e.get("ANGLE_instanced_arrays"))[o.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Vt,Zt),ir[Vt]=Zt)}function ft(){const Vt=ee.newAttributes,Zt=ee.enabledAttributes;for(let Jt=0,jt=Zt.length;Jt<jt;Jt++)Zt[Jt]!==Vt[Jt]&&(f.disableVertexAttribArray(Jt),Zt[Jt]=0)}function Mt(Vt,Zt,Jt,jt,ir,Sr){o.isWebGL2===!0&&(Jt===f.INT||Jt===f.UNSIGNED_INT)?f.vertexAttribIPointer(Vt,Zt,Jt,ir,Sr):f.vertexAttribPointer(Vt,Zt,Jt,jt,ir,Sr)}function Rt(Vt,Zt,Jt,jt){if(o.isWebGL2===!1&&(Vt.isInstancedMesh||jt.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;xe();const ir=jt.attributes,Sr=Jt.getAttributes(),Hr=Zt.defaultAttributeValues;for(const or in Sr){const tr=Sr[or];if(tr.location>=0){let Br=ir[or];if(Br===void 0&&(or==="instanceMatrix"&&Vt.instanceMatrix&&(Br=Vt.instanceMatrix),or==="instanceColor"&&Vt.instanceColor&&(Br=Vt.instanceColor)),Br!==void 0){const nn=Br.normalized,vn=Br.itemSize,Ft=i.get(Br);if(Ft===void 0)continue;const mi=Ft.buffer,gn=Ft.type,Dn=Ft.bytesPerElement;if(Br.isInterleavedBufferAttribute){const Kr=Br.data,rr=Kr.stride,Bn=Br.offset;if(Kr&&Kr.isInstancedInterleavedBuffer){for(let pr=0;pr<tr.locationSize;pr++)rt(tr.location+pr,Kr.meshPerAttribute);Vt.isInstancedMesh!==!0&&jt._maxInstanceCount===void 0&&(jt._maxInstanceCount=Kr.meshPerAttribute*Kr.count)}else for(let pr=0;pr<tr.locationSize;pr++)ut(tr.location+pr);f.bindBuffer(f.ARRAY_BUFFER,mi);for(let pr=0;pr<tr.locationSize;pr++)Mt(tr.location+pr,vn/tr.locationSize,gn,nn,rr*Dn,(Bn+vn/tr.locationSize*pr)*Dn)}else{if(Br.isInstancedBufferAttribute){for(let Kr=0;Kr<tr.locationSize;Kr++)rt(tr.location+Kr,Br.meshPerAttribute);Vt.isInstancedMesh!==!0&&jt._maxInstanceCount===void 0&&(jt._maxInstanceCount=Br.meshPerAttribute*Br.count)}else for(let Kr=0;Kr<tr.locationSize;Kr++)ut(tr.location+Kr);f.bindBuffer(f.ARRAY_BUFFER,mi);for(let Kr=0;Kr<tr.locationSize;Kr++)Mt(tr.location+Kr,vn/tr.locationSize,gn,nn,vn*Dn,vn/tr.locationSize*Kr*Dn)}}else if(Hr!==void 0){const nn=Hr[or];if(nn!==void 0)switch(nn.length){case 2:f.vertexAttrib2fv(tr.location,nn);break;case 3:f.vertexAttrib3fv(tr.location,nn);break;case 4:f.vertexAttrib4fv(tr.location,nn);break;default:f.vertexAttrib1fv(tr.location,nn)}}}}ft()}function kt(){it();for(const Vt in I){const Zt=I[Vt];for(const Jt in Zt){const jt=Zt[Jt];for(const ir in jt)ve(jt[ir].object),delete jt[ir];delete Zt[Jt]}delete I[Vt]}}function nr(Vt){if(I[Vt.id]===void 0)return;const Zt=I[Vt.id];for(const Jt in Zt){const jt=Zt[Jt];for(const ir in jt)ve(jt[ir].object),delete jt[ir];delete Zt[Jt]}delete I[Vt.id]}function Xt(Vt){for(const Zt in I){const Jt=I[Zt];if(Jt[Vt.id]===void 0)continue;const jt=Jt[Vt.id];for(const ir in jt)ve(jt[ir].object),delete jt[ir];delete Jt[Vt.id]}}function it(){Pt(),ee!==J&&(ee=J,de(ee.object))}function Pt(){J.geometry=null,J.program=null,J.wireframe=!1}return{setup:he,reset:it,resetDefaultState:Pt,dispose:kt,releaseStatesOfGeometry:nr,releaseStatesOfProgram:Xt,initAttributes:xe,enableAttribute:ut,disableUnusedAttributes:ft}}function Pd(f,e,i,o){const l=o.isWebGL2;let d;function w(ee){d=ee}function I(ee,he){f.drawArrays(d,ee,he),i.update(he,d,1)}function J(ee,he,fe){if(fe===0)return;let de,ve;if(l)de=f,ve="drawArraysInstanced";else if(de=e.get("ANGLE_instanced_arrays"),ve="drawArraysInstancedANGLE",de===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}de[ve](d,ee,he,fe),i.update(he,d,fe)}this.setMode=w,this.render=I,this.renderInstances=J}function Ld(f,e,i){let o;function l(){if(o!==void 0)return o;if(e.has("EXT_texture_filter_anisotropic")===!0){const Rt=e.get("EXT_texture_filter_anisotropic");o=f.getParameter(Rt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function d(Rt){if(Rt==="highp"){if(f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.HIGH_FLOAT).precision>0&&f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.HIGH_FLOAT).precision>0)return"highp";Rt="mediump"}return Rt==="mediump"&&f.getShaderPrecisionFormat(f.VERTEX_SHADER,f.MEDIUM_FLOAT).precision>0&&f.getShaderPrecisionFormat(f.FRAGMENT_SHADER,f.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const w=typeof WebGL2RenderingContext<"u"&&f instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&f instanceof WebGL2ComputeRenderingContext;let I=i.precision!==void 0?i.precision:"highp";const J=d(I);J!==I&&(console.warn("THREE.WebGLRenderer:",I,"not supported, using",J,"instead."),I=J);const ee=w||e.has("WEBGL_draw_buffers"),he=i.logarithmicDepthBuffer===!0,fe=f.getParameter(f.MAX_TEXTURE_IMAGE_UNITS),de=f.getParameter(f.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ve=f.getParameter(f.MAX_TEXTURE_SIZE),Ce=f.getParameter(f.MAX_CUBE_MAP_TEXTURE_SIZE),Ne=f.getParameter(f.MAX_VERTEX_ATTRIBS),Ke=f.getParameter(f.MAX_VERTEX_UNIFORM_VECTORS),Oe=f.getParameter(f.MAX_VARYING_VECTORS),xe=f.getParameter(f.MAX_FRAGMENT_UNIFORM_VECTORS),ut=de>0,rt=w||e.has("OES_texture_float"),ft=ut&&rt,Mt=w?f.getParameter(f.MAX_SAMPLES):0;return{isWebGL2:w,drawBuffers:ee,getMaxAnisotropy:l,getMaxPrecision:d,precision:I,logarithmicDepthBuffer:he,maxTextures:fe,maxVertexTextures:de,maxTextureSize:ve,maxCubemapSize:Ce,maxAttributes:Ne,maxVertexUniforms:Ke,maxVaryings:Oe,maxFragmentUniforms:xe,vertexTextures:ut,floatFragmentTextures:rt,floatVertexTextures:ft,maxSamples:Mt}}function Xl(f){const e=this;let i=null,o=0,l=!1,d=!1;const w=new Ys,I=new Yt,J={value:null,needsUpdate:!1};this.uniform=J,this.numPlanes=0,this.numIntersection=0,this.init=function(fe,de,ve){const Ce=fe.length!==0||de||o!==0||l;return l=de,i=he(fe,ve,0),o=fe.length,Ce},this.beginShadows=function(){d=!0,he(null)},this.endShadows=function(){d=!1,ee()},this.setState=function(fe,de,ve){const Ce=fe.clippingPlanes,Ne=fe.clipIntersection,Ke=fe.clipShadows,Oe=f.get(fe);if(!l||Ce===null||Ce.length===0||d&&!Ke)d?he(null):ee();else{const xe=d?0:o,ut=xe*4;let rt=Oe.clippingState||null;J.value=rt,rt=he(Ce,de,ut,ve);for(let ft=0;ft!==ut;++ft)rt[ft]=i[ft];Oe.clippingState=rt,this.numIntersection=Ne?this.numPlanes:0,this.numPlanes+=xe}};function ee(){J.value!==i&&(J.value=i,J.needsUpdate=o>0),e.numPlanes=o,e.numIntersection=0}function he(fe,de,ve,Ce){const Ne=fe!==null?fe.length:0;let Ke=null;if(Ne!==0){if(Ke=J.value,Ce!==!0||Ke===null){const Oe=ve+Ne*4,xe=de.matrixWorldInverse;I.getNormalMatrix(xe),(Ke===null||Ke.length<Oe)&&(Ke=new Float32Array(Oe));for(let ut=0,rt=ve;ut!==Ne;++ut,rt+=4)w.copy(fe[ut]).applyMatrix4(xe,I),w.normal.toArray(Ke,rt),Ke[rt+3]=w.constant}J.value=Ke,J.needsUpdate=!0}return e.numPlanes=Ne,e.numIntersection=0,Ke}}function gp(f){let e=new WeakMap;function i(w,I){return I===we?w.mapping=me:I===je&&(w.mapping=be),w}function o(w){if(w&&w.isTexture&&w.isRenderTargetTexture===!1){const I=w.mapping;if(I===we||I===je)if(e.has(w)){const J=e.get(w).texture;return i(J,w.mapping)}else{const J=w.image;if(J&&J.height>0){const ee=new _u(J.height/2);return ee.fromEquirectangularTexture(f,w),e.set(w,ee),w.addEventListener("dispose",l),i(ee.texture,w.mapping)}else return null}}return w}function l(w){const I=w.target;I.removeEventListener("dispose",l);const J=e.get(I);J!==void 0&&(e.delete(I),J.dispose())}function d(){e=new WeakMap}return{get:o,dispose:d}}class rf extends Qn{constructor(e=-1,i=1,o=1,l=-1,d=.1,w=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=o,this.bottom=l,this.near=d,this.far=w,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,o,l,d,w){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=o,this.view.offsetY=l,this.view.width=d,this.view.height=w,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,l=(this.top+this.bottom)/2;let d=o-e,w=o+e,I=l+i,J=l-i;if(this.view!==null&&this.view.enabled){const ee=(this.right-this.left)/this.view.fullWidth/this.zoom,he=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=ee*this.view.offsetX,w=d+ee*this.view.width,I-=he*this.view.offsetY,J=I-he*this.view.height}this.projectionMatrix.makeOrthographic(d,w,I,J,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}rf.prototype.isOrthographicCamera=!0;class Mu extends Jn{constructor(e){super(e),this.type="RawShaderMaterial"}}Mu.prototype.isRawShaderMaterial=!0;const cs=4,Ku=8,Zo=Math.pow(2,Ku),ov=[.125,.215,.35,.446,.526,.582],uv=Ku-cs+1+ov.length,nf=20,yp=new rf,{_lodPlanes:Zl,_sizeLods:_p,_sigmas:Od}=A2(),lv=new Or;let xp=null;const jl=(1+Math.sqrt(5))/2,af=1/jl,cv=[new dt(1,1,1),new dt(-1,1,1),new dt(1,1,-1),new dt(-1,1,-1),new dt(0,jl,af),new dt(0,jl,-af),new dt(af,0,jl),new dt(-af,0,jl),new dt(jl,af,0),new dt(-jl,af,0)];class Ap{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=w2(nf),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,o=.1,l=100){xp=this._renderer.getRenderTarget();const d=this._allocateTargets();return this._sceneToCubeUV(e,o,l,d),i>0&&this._blur(d,0,0,i),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=fv(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=of(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<Zl.length;e++)Zl[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(xp),e.scissorTest=!1,sf(e,0,0,e.width,e.height)}_fromTexture(e,i){xp=this._renderer.getRenderTarget();const o=i||this._allocateTargets(e);return this._textureToCubeUV(e,o),this._applyPMREM(o),this._cleanup(o),o}_allocateTargets(e){const i={magFilter:at,minFilter:at,generateMipmaps:!1,type:zr,format:xn,encoding:fi,depthBuffer:!1},o=wp(i);return o.depthBuffer=!e,this._pingPongRenderTarget===null&&(this._pingPongRenderTarget=wp(i)),o}_compileMaterial(e){const i=new ra(Zl[0],e);this._renderer.compile(i,yp)}_sceneToCubeUV(e,i,o,l){const I=new da(90,1,i,o),J=[1,-1,1,1,1,1],ee=[1,1,1,-1,-1,-1],he=this._renderer,fe=he.autoClear,de=he.toneMapping;he.getClearColor(lv),he.toneMapping=tt,he.autoClear=!1;const ve=new co({name:"PMREM.Background",side:V,depthWrite:!1,depthTest:!1}),Ce=new ra(new ho,ve);let Ne=!1;const Ke=e.background;Ke?Ke.isColor&&(ve.color.copy(Ke),e.background=null,Ne=!0):(ve.color.copy(lv),Ne=!0);for(let Oe=0;Oe<6;Oe++){const xe=Oe%3;xe===0?(I.up.set(0,J[Oe],0),I.lookAt(ee[Oe],0,0)):xe===1?(I.up.set(0,0,J[Oe]),I.lookAt(0,ee[Oe],0)):(I.up.set(0,J[Oe],0),I.lookAt(0,0,ee[Oe])),sf(l,xe*Zo,Oe>2?Zo:0,Zo,Zo),he.setRenderTarget(l),Ne&&he.render(Ce,I),he.render(e,I)}Ce.geometry.dispose(),Ce.material.dispose(),he.toneMapping=de,he.autoClear=fe,e.background=Ke}_textureToCubeUV(e,i){const o=this._renderer,l=e.mapping===me||e.mapping===be;l?(this._cubemapShader===null&&(this._cubemapShader=fv()),this._cubemapShader.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectShader===null&&(this._equirectShader=of());const d=l?this._cubemapShader:this._equirectShader,w=new ra(Zl[0],d),I=d.uniforms;I.envMap.value=e,l||I.texelSize.value.set(1/e.image.width,1/e.image.height),sf(i,0,0,3*Zo,2*Zo),o.setRenderTarget(i),o.render(w,yp)}_applyPMREM(e){const i=this._renderer,o=i.autoClear;i.autoClear=!1;for(let l=1;l<uv;l++){const d=Math.sqrt(Od[l]*Od[l]-Od[l-1]*Od[l-1]),w=cv[(l-1)%cv.length];this._blur(e,l-1,l,d,w)}i.autoClear=o}_blur(e,i,o,l,d){const w=this._pingPongRenderTarget;this._halfBlur(e,w,i,o,l,"latitudinal",d),this._halfBlur(w,e,o,o,l,"longitudinal",d)}_halfBlur(e,i,o,l,d,w,I){const J=this._renderer,ee=this._blurMaterial;w!=="latitudinal"&&w!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const he=3,fe=new ra(Zl[l],ee),de=ee.uniforms,ve=_p[o]-1,Ce=isFinite(d)?Math.PI/(2*ve):2*Math.PI/(2*nf-1),Ne=d/Ce,Ke=isFinite(d)?1+Math.floor(he*Ne):nf;Ke>nf&&console.warn(`sigmaRadians, ${d}, is too large and will clip, as it requested ${Ke} samples when the maximum is set to ${nf}`);const Oe=[];let xe=0;for(let Mt=0;Mt<nf;++Mt){const Rt=Mt/Ne,kt=Math.exp(-Rt*Rt/2);Oe.push(kt),Mt===0?xe+=kt:Mt<Ke&&(xe+=2*kt)}for(let Mt=0;Mt<Oe.length;Mt++)Oe[Mt]=Oe[Mt]/xe;de.envMap.value=e.texture,de.samples.value=Ke,de.weights.value=Oe,de.latitudinal.value=w==="latitudinal",I&&(de.poleAxis.value=I),de.dTheta.value=Ce,de.mipInt.value=Ku-o;const ut=_p[l],rt=3*Math.max(0,Zo-2*ut),ft=(l===0?0:2*Zo)+2*ut*(l>Ku-cs?l-Ku+cs:0);sf(i,rt,ft,3*ut,2*ut),J.setRenderTarget(i),J.render(fe,yp)}}function A2(){const f=[],e=[],i=[];let o=Ku;for(let l=0;l<uv;l++){const d=Math.pow(2,o);e.push(d);let w=1/d;l>Ku-cs?w=ov[l-Ku+cs-1]:l===0&&(w=0),i.push(w);const I=1/(d-1),J=-I/2,ee=1+I/2,he=[J,J,ee,J,ee,ee,J,J,ee,ee,J,ee],fe=6,de=6,ve=3,Ce=2,Ne=1,Ke=new Float32Array(ve*de*fe),Oe=new Float32Array(Ce*de*fe),xe=new Float32Array(Ne*de*fe);for(let rt=0;rt<fe;rt++){const ft=rt%3*2/3-1,Mt=rt>2?0:-1,Rt=[ft,Mt,0,ft+2/3,Mt,0,ft+2/3,Mt+1,0,ft,Mt,0,ft+2/3,Mt+1,0,ft,Mt+1,0];Ke.set(Rt,ve*de*rt),Oe.set(he,Ce*de*rt);const kt=[rt,rt,rt,rt,rt,rt];xe.set(kt,Ne*de*rt)}const ut=new An;ut.setAttribute("position",new ti(Ke,ve)),ut.setAttribute("uv",new ti(Oe,Ce)),ut.setAttribute("faceIndex",new ti(xe,Ne)),f.push(ut),o>cs&&o--}return{_lodPlanes:f,_sizeLods:e,_sigmas:i}}function wp(f){const e=new Ta(3*Zo,3*Zo,f);return e.texture.mapping=lt,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function sf(f,e,i,o,l){f.viewport.set(e,i,o,l),f.scissor.set(e,i,o,l)}function w2(f){const e=new Float32Array(f),i=new dt(0,1,0);return new Mu({name:"SphericalGaussianBlur",defines:{n:f},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Mp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:b,depthTest:!1,depthWrite:!1})}function of(){const f=new We(1,1);return new Mu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:f}},vertexShader:Mp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = texture2D ( envMap, uv ).rgb;
				uv.x += texelSize.x;
				vec3 tr = texture2D ( envMap, uv ).rgb;
				uv.y += texelSize.y;
				vec3 br = texture2D ( envMap, uv ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = texture2D ( envMap, uv ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:b,depthTest:!1,depthWrite:!1})}function fv(){return new Mu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Mp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:b,depthTest:!1,depthWrite:!1})}function Mp(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function hv(f){let e=new WeakMap,i=null;function o(I){if(I&&I.isTexture){const J=I.mapping,ee=J===we||J===je,he=J===me||J===be;if(ee||he)if(I.isRenderTargetTexture&&I.needsPMREMUpdate===!0){I.needsPMREMUpdate=!1;let fe=e.get(I);return i===null&&(i=new Ap(f)),fe=ee?i.fromEquirectangular(I,fe):i.fromCubemap(I,fe),e.set(I,fe),fe.texture}else{if(e.has(I))return e.get(I).texture;{const fe=I.image;if(ee&&fe&&fe.height>0||he&&fe&&l(fe)){i===null&&(i=new Ap(f));const de=ee?i.fromEquirectangular(I):i.fromCubemap(I);return e.set(I,de),I.addEventListener("dispose",d),de.texture}else return null}}}return I}function l(I){let J=0;const ee=6;for(let he=0;he<ee;he++)I[he]!==void 0&&J++;return J===ee}function d(I){const J=I.target;J.removeEventListener("dispose",d);const ee=e.get(J);ee!==void 0&&(e.delete(J),ee.dispose())}function w(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:o,dispose:w}}function M2(f){const e={};function i(o){if(e[o]!==void 0)return e[o];let l;switch(o){case"WEBGL_depth_texture":l=f.getExtension("WEBGL_depth_texture")||f.getExtension("MOZ_WEBGL_depth_texture")||f.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":l=f.getExtension("EXT_texture_filter_anisotropic")||f.getExtension("MOZ_EXT_texture_filter_anisotropic")||f.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":l=f.getExtension("WEBGL_compressed_texture_s3tc")||f.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":l=f.getExtension("WEBGL_compressed_texture_pvrtc")||f.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:l=f.getExtension(o)}return e[o]=l,l}return{has:function(o){return i(o)!==null},init:function(o){o.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(o){const l=i(o);return l===null&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),l}}}function b2(f,e,i,o){const l={},d=new WeakMap;function w(fe){const de=fe.target;de.index!==null&&e.remove(de.index);for(const Ce in de.attributes)e.remove(de.attributes[Ce]);de.removeEventListener("dispose",w),delete l[de.id];const ve=d.get(de);ve&&(e.remove(ve),d.delete(de)),o.releaseStatesOfGeometry(de),de.isInstancedBufferGeometry===!0&&delete de._maxInstanceCount,i.memory.geometries--}function I(fe,de){return l[de.id]===!0||(de.addEventListener("dispose",w),l[de.id]=!0,i.memory.geometries++),de}function J(fe){const de=fe.attributes;for(const Ce in de)e.update(de[Ce],f.ARRAY_BUFFER);const ve=fe.morphAttributes;for(const Ce in ve){const Ne=ve[Ce];for(let Ke=0,Oe=Ne.length;Ke<Oe;Ke++)e.update(Ne[Ke],f.ARRAY_BUFFER)}}function ee(fe){const de=[],ve=fe.index,Ce=fe.attributes.position;let Ne=0;if(ve!==null){const xe=ve.array;Ne=ve.version;for(let ut=0,rt=xe.length;ut<rt;ut+=3){const ft=xe[ut+0],Mt=xe[ut+1],Rt=xe[ut+2];de.push(ft,Mt,Mt,Rt,Rt,ft)}}else{const xe=Ce.array;Ne=Ce.version;for(let ut=0,rt=xe.length/3-1;ut<rt;ut+=3){const ft=ut+0,Mt=ut+1,Rt=ut+2;de.push(ft,Mt,Mt,Rt,Rt,ft)}}const Ke=new(Er(de)?Dl:qc)(de,1);Ke.version=Ne;const Oe=d.get(fe);Oe&&e.remove(Oe),d.set(fe,Ke)}function he(fe){const de=d.get(fe);if(de){const ve=fe.index;ve!==null&&de.version<ve.version&&ee(fe)}else ee(fe);return d.get(fe)}return{get:I,update:J,getWireframeAttribute:he}}function E2(f,e,i,o){const l=o.isWebGL2;let d;function w(de){d=de}let I,J;function ee(de){I=de.type,J=de.bytesPerElement}function he(de,ve){f.drawElements(d,ve,I,de*J),i.update(ve,d,1)}function fe(de,ve,Ce){if(Ce===0)return;let Ne,Ke;if(l)Ne=f,Ke="drawElementsInstanced";else if(Ne=e.get("ANGLE_instanced_arrays"),Ke="drawElementsInstancedANGLE",Ne===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}Ne[Ke](d,ve,I,de*J,Ce),i.update(ve,d,Ce)}this.setMode=w,this.setIndex=ee,this.render=he,this.renderInstances=fe}function T2(f){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function o(d,w,I){switch(i.calls++,w){case f.TRIANGLES:i.triangles+=I*(d/3);break;case f.LINES:i.lines+=I*(d/2);break;case f.LINE_STRIP:i.lines+=I*(d-1);break;case f.LINE_LOOP:i.lines+=I*d;break;case f.POINTS:i.points+=I*d;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",w);break}}function l(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:l,update:o}}class Fd extends Cn{constructor(e=null,i=1,o=1,l=1){super(null),this.image={data:e,width:i,height:o,depth:l},this.magFilter=oe,this.minFilter=oe,this.wrapR=Ie,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Fd.prototype.isDataTexture2DArray=!0;function S2(f,e){return f[0]-e[0]}function R2(f,e){return Math.abs(e[1])-Math.abs(f[1])}function dv(f,e){let i=1;const o=e.isInterleavedBufferAttribute?e.data.array:e.array;o instanceof Int8Array?i=127:o instanceof Int16Array?i=32767:o instanceof Int32Array?i=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",o),f.divideScalar(i)}function pv(f,e,i){const o={},l=new Float32Array(8),d=new WeakMap,w=new dt,I=[];for(let ee=0;ee<8;ee++)I[ee]=[ee,0];function J(ee,he,fe,de){const ve=ee.morphTargetInfluences;if(e.isWebGL2===!0){const Ne=he.morphAttributes.position.length;let Ke=d.get(he);if(Ke===void 0||Ke.count!==Ne){let Vt=function(){it.dispose(),d.delete(he),he.removeEventListener("dispose",Vt)};var Ce=Vt;Ke!==void 0&&Ke.texture.dispose();const ut=he.morphAttributes.normal!==void 0,rt=he.morphAttributes.position,ft=he.morphAttributes.normal||[],Mt=he.attributes.position.count,Rt=ut===!0?2:1;let kt=Mt*Rt,nr=1;kt>e.maxTextureSize&&(nr=Math.ceil(kt/e.maxTextureSize),kt=e.maxTextureSize);const Xt=new Float32Array(kt*nr*4*Ne),it=new Fd(Xt,kt,nr,Ne);it.format=xn,it.type=dr,it.needsUpdate=!0;const Pt=Rt*4;for(let Zt=0;Zt<Ne;Zt++){const Jt=rt[Zt],jt=ft[Zt],ir=kt*nr*4*Zt;for(let Sr=0;Sr<Jt.count;Sr++){w.fromBufferAttribute(Jt,Sr),Jt.normalized===!0&&dv(w,Jt);const Hr=Sr*Pt;Xt[ir+Hr+0]=w.x,Xt[ir+Hr+1]=w.y,Xt[ir+Hr+2]=w.z,Xt[ir+Hr+3]=0,ut===!0&&(w.fromBufferAttribute(jt,Sr),jt.normalized===!0&&dv(w,jt),Xt[ir+Hr+4]=w.x,Xt[ir+Hr+5]=w.y,Xt[ir+Hr+6]=w.z,Xt[ir+Hr+7]=0)}}Ke={count:Ne,texture:it,size:new We(kt,nr)},d.set(he,Ke),he.addEventListener("dispose",Vt)}let Oe=0;for(let ut=0;ut<ve.length;ut++)Oe+=ve[ut];const xe=he.morphTargetsRelative?1:1-Oe;de.getUniforms().setValue(f,"morphTargetBaseInfluence",xe),de.getUniforms().setValue(f,"morphTargetInfluences",ve),de.getUniforms().setValue(f,"morphTargetsTexture",Ke.texture,i),de.getUniforms().setValue(f,"morphTargetsTextureSize",Ke.size)}else{const Ne=ve===void 0?0:ve.length;let Ke=o[he.id];if(Ke===void 0||Ke.length!==Ne){Ke=[];for(let ft=0;ft<Ne;ft++)Ke[ft]=[ft,0];o[he.id]=Ke}for(let ft=0;ft<Ne;ft++){const Mt=Ke[ft];Mt[0]=ft,Mt[1]=ve[ft]}Ke.sort(R2);for(let ft=0;ft<8;ft++)ft<Ne&&Ke[ft][1]?(I[ft][0]=Ke[ft][0],I[ft][1]=Ke[ft][1]):(I[ft][0]=Number.MAX_SAFE_INTEGER,I[ft][1]=0);I.sort(S2);const Oe=he.morphAttributes.position,xe=he.morphAttributes.normal;let ut=0;for(let ft=0;ft<8;ft++){const Mt=I[ft],Rt=Mt[0],kt=Mt[1];Rt!==Number.MAX_SAFE_INTEGER&&kt?(Oe&&he.getAttribute("morphTarget"+ft)!==Oe[Rt]&&he.setAttribute("morphTarget"+ft,Oe[Rt]),xe&&he.getAttribute("morphNormal"+ft)!==xe[Rt]&&he.setAttribute("morphNormal"+ft,xe[Rt]),l[ft]=kt,ut+=kt):(Oe&&he.hasAttribute("morphTarget"+ft)===!0&&he.deleteAttribute("morphTarget"+ft),xe&&he.hasAttribute("morphNormal"+ft)===!0&&he.deleteAttribute("morphNormal"+ft),l[ft]=0)}const rt=he.morphTargetsRelative?1:1-ut;de.getUniforms().setValue(f,"morphTargetBaseInfluence",rt),de.getUniforms().setValue(f,"morphTargetInfluences",l)}}return{update:J}}function mv(f,e,i,o){let l=new WeakMap;function d(J){const ee=o.render.frame,he=J.geometry,fe=e.get(J,he);return l.get(fe)!==ee&&(e.update(fe),l.set(fe,ee)),J.isInstancedMesh&&(J.hasEventListener("dispose",I)===!1&&J.addEventListener("dispose",I),i.update(J.instanceMatrix,f.ARRAY_BUFFER),J.instanceColor!==null&&i.update(J.instanceColor,f.ARRAY_BUFFER)),fe}function w(){l=new WeakMap}function I(J){const ee=J.target;ee.removeEventListener("dispose",I),i.remove(ee.instanceMatrix),ee.instanceColor!==null&&i.remove(ee.instanceColor)}return{update:d,dispose:w}}class bp extends Cn{constructor(e=null,i=1,o=1,l=1){super(null),this.image={data:e,width:i,height:o,depth:l},this.magFilter=oe,this.minFilter=oe,this.wrapR=Ie,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}bp.prototype.isDataTexture3D=!0;const vv=new Cn,Ep=new Fd,Tp=new bp,Sp=new $u,gv=[],yv=[],_v=new Float32Array(16),xv=new Float32Array(9),Av=new Float32Array(4);function uf(f,e,i){const o=f[0];if(o<=0||o>0)return f;const l=e*i;let d=gv[l];if(d===void 0&&(d=new Float32Array(l),gv[l]=d),e!==0){o.toArray(d,0);for(let w=1,I=0;w!==e;++w)I+=i,f[w].toArray(d,I)}return d}function fs(f,e){if(f.length!==e.length)return!1;for(let i=0,o=f.length;i<o;i++)if(f[i]!==e[i])return!1;return!0}function is(f,e){for(let i=0,o=e.length;i<o;i++)f[i]=e[i]}function Id(f,e){let i=yv[e];i===void 0&&(i=new Int32Array(e),yv[e]=i);for(let o=0;o!==e;++o)i[o]=f.allocateTextureUnit();return i}function C2(f,e){const i=this.cache;i[0]!==e&&(f.uniform1f(this.addr,e),i[0]=e)}function wv(f,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(f.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(fs(i,e))return;f.uniform2fv(this.addr,e),is(i,e)}}function P2(f,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(f.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(f.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(fs(i,e))return;f.uniform3fv(this.addr,e),is(i,e)}}function L2(f,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(f.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(fs(i,e))return;f.uniform4fv(this.addr,e),is(i,e)}}function Mv(f,e){const i=this.cache,o=e.elements;if(o===void 0){if(fs(i,e))return;f.uniformMatrix2fv(this.addr,!1,e),is(i,e)}else{if(fs(i,o))return;Av.set(o),f.uniformMatrix2fv(this.addr,!1,Av),is(i,o)}}function O2(f,e){const i=this.cache,o=e.elements;if(o===void 0){if(fs(i,e))return;f.uniformMatrix3fv(this.addr,!1,e),is(i,e)}else{if(fs(i,o))return;xv.set(o),f.uniformMatrix3fv(this.addr,!1,xv),is(i,o)}}function bv(f,e){const i=this.cache,o=e.elements;if(o===void 0){if(fs(i,e))return;f.uniformMatrix4fv(this.addr,!1,e),is(i,e)}else{if(fs(i,o))return;_v.set(o),f.uniformMatrix4fv(this.addr,!1,_v),is(i,o)}}function F2(f,e){const i=this.cache;i[0]!==e&&(f.uniform1i(this.addr,e),i[0]=e)}function Ev(f,e){const i=this.cache;fs(i,e)||(f.uniform2iv(this.addr,e),is(i,e))}function I2(f,e){const i=this.cache;fs(i,e)||(f.uniform3iv(this.addr,e),is(i,e))}function Tv(f,e){const i=this.cache;fs(i,e)||(f.uniform4iv(this.addr,e),is(i,e))}function Sv(f,e){const i=this.cache;i[0]!==e&&(f.uniform1ui(this.addr,e),i[0]=e)}function k2(f,e){const i=this.cache;fs(i,e)||(f.uniform2uiv(this.addr,e),is(i,e))}function D2(f,e){const i=this.cache;fs(i,e)||(f.uniform3uiv(this.addr,e),is(i,e))}function Rv(f,e){const i=this.cache;fs(i,e)||(f.uniform4uiv(this.addr,e),is(i,e))}function lh(f,e,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(f.uniform1i(this.addr,l),o[0]=l),i.safeSetTexture2D(e||vv,l)}function Rp(f,e,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(f.uniform1i(this.addr,l),o[0]=l),i.setTexture3D(e||Tp,l)}function Cv(f,e,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(f.uniform1i(this.addr,l),o[0]=l),i.safeSetTextureCube(e||Sp,l)}function Pv(f,e,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(f.uniform1i(this.addr,l),o[0]=l),i.setTexture2DArray(e||Ep,l)}function kd(f){switch(f){case 5126:return C2;case 35664:return wv;case 35665:return P2;case 35666:return L2;case 35674:return Mv;case 35675:return O2;case 35676:return bv;case 5124:case 35670:return F2;case 35667:case 35671:return Ev;case 35668:case 35672:return I2;case 35669:case 35673:return Tv;case 5125:return Sv;case 36294:return k2;case 36295:return D2;case 36296:return Rv;case 35678:case 36198:case 36298:case 36306:case 35682:return lh;case 35679:case 36299:case 36307:return Rp;case 35680:case 36300:case 36308:case 36293:return Cv;case 36289:case 36303:case 36311:case 36292:return Pv}}function Lv(f,e){f.uniform1fv(this.addr,e)}function Ov(f,e){const i=uf(e,this.size,2);f.uniform2fv(this.addr,i)}function Fv(f,e){const i=uf(e,this.size,3);f.uniform3fv(this.addr,i)}function Iv(f,e){const i=uf(e,this.size,4);f.uniform4fv(this.addr,i)}function N2(f,e){const i=uf(e,this.size,4);f.uniformMatrix2fv(this.addr,!1,i)}function B2(f,e){const i=uf(e,this.size,9);f.uniformMatrix3fv(this.addr,!1,i)}function el(f,e){const i=uf(e,this.size,16);f.uniformMatrix4fv(this.addr,!1,i)}function U2(f,e){f.uniform1iv(this.addr,e)}function z2(f,e){f.uniform2iv(this.addr,e)}function tl(f,e){f.uniform3iv(this.addr,e)}function Yl(f,e){f.uniform4iv(this.addr,e)}function G2(f,e){f.uniform1uiv(this.addr,e)}function V2(f,e){f.uniform2uiv(this.addr,e)}function W2(f,e){f.uniform3uiv(this.addr,e)}function kv(f,e){f.uniform4uiv(this.addr,e)}function H2(f,e,i){const o=e.length,l=Id(i,o);f.uniform1iv(this.addr,l);for(let d=0;d!==o;++d)i.safeSetTexture2D(e[d]||vv,l[d])}function q2(f,e,i){const o=e.length,l=Id(i,o);f.uniform1iv(this.addr,l);for(let d=0;d!==o;++d)i.setTexture3D(e[d]||Tp,l[d])}function X2(f,e,i){const o=e.length,l=Id(i,o);f.uniform1iv(this.addr,l);for(let d=0;d!==o;++d)i.safeSetTextureCube(e[d]||Sp,l[d])}function Dv(f,e,i){const o=e.length,l=Id(i,o);f.uniform1iv(this.addr,l);for(let d=0;d!==o;++d)i.setTexture2DArray(e[d]||Ep,l[d])}function Z2(f){switch(f){case 5126:return Lv;case 35664:return Ov;case 35665:return Fv;case 35666:return Iv;case 35674:return N2;case 35675:return B2;case 35676:return el;case 5124:case 35670:return U2;case 35667:case 35671:return z2;case 35668:case 35672:return tl;case 35669:case 35673:return Yl;case 5125:return G2;case 36294:return V2;case 36295:return W2;case 36296:return kv;case 35678:case 36198:case 36298:case 36306:case 35682:return H2;case 35679:case 36299:case 36307:return q2;case 35680:case 36300:case 36308:case 36293:return X2;case 36289:case 36303:case 36311:case 36292:return Dv}}function j2(f,e,i){this.id=f,this.addr=i,this.cache=[],this.setValue=kd(e.type)}function Nv(f,e,i){this.id=f,this.addr=i,this.cache=[],this.size=e.size,this.setValue=Z2(e.type)}Nv.prototype.updateCache=function(f){const e=this.cache;f instanceof Float32Array&&e.length!==f.length&&(this.cache=new Float32Array(f.length)),is(e,f)};function Bv(f){this.id=f,this.seq=[],this.map={}}Bv.prototype.setValue=function(f,e,i){const o=this.seq;for(let l=0,d=o.length;l!==d;++l){const w=o[l];w.setValue(f,e[w.id],i)}};const Cp=/(\w+)(\])?(\[|\.)?/g;function Uv(f,e){f.seq.push(e),f.map[e.id]=e}function zv(f,e,i){const o=f.name,l=o.length;for(Cp.lastIndex=0;;){const d=Cp.exec(o),w=Cp.lastIndex;let I=d[1];const J=d[2]==="]",ee=d[3];if(J&&(I=I|0),ee===void 0||ee==="["&&w+2===l){Uv(i,ee===void 0?new j2(I,f,e):new Nv(I,f,e));break}else{let fe=i.map[I];fe===void 0&&(fe=new Bv(I),Uv(i,fe)),i=fe}}}function rl(f,e){this.seq=[],this.map={};const i=f.getProgramParameter(e,f.ACTIVE_UNIFORMS);for(let o=0;o<i;++o){const l=f.getActiveUniform(e,o),d=f.getUniformLocation(e,l.name);zv(l,d,this)}}rl.prototype.setValue=function(f,e,i,o){const l=this.map[e];l!==void 0&&l.setValue(f,i,o)},rl.prototype.setOptional=function(f,e,i){const o=e[i];o!==void 0&&this.setValue(f,i,o)},rl.upload=function(f,e,i,o){for(let l=0,d=e.length;l!==d;++l){const w=e[l],I=i[w.id];I.needsUpdate!==!1&&w.setValue(f,I.value,o)}},rl.seqWithValue=function(f,e){const i=[];for(let o=0,l=f.length;o!==l;++o){const d=f[o];d.id in e&&i.push(d)}return i};function Gv(f,e,i){const o=f.createShader(e);return f.shaderSource(o,i),f.compileShader(o),o}let Y2=0;function J2(f){const e=f.split(`
`);for(let i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join(`
`)}function $2(f){switch(f){case fi:return["Linear","( value )"];case xi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",f),["Linear","( value )"]}}function Vv(f,e,i){const o=f.getShaderParameter(e,f.COMPILE_STATUS),l=f.getShaderInfoLog(e).trim();return o&&l===""?"":i.toUpperCase()+`

`+l+`

`+J2(f.getShaderSource(e))}function Q2(f,e){const i=$2(e);return"vec4 "+f+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function Wv(f,e){let i;switch(e){case ye:i="Linear";break;case Ze:i="Reinhard";break;case Ge:i="OptimizedCineon";break;case Ae:i="ACESFilmic";break;case Se:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+f+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function K2(f){return[f.extensionDerivatives||f.envMapCubeUV||f.bumpMap||f.tangentSpaceNormalMap||f.clearcoatNormalMap||f.flatShading||f.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(f.extensionFragDepth||f.logarithmicDepthBuffer)&&f.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",f.extensionDrawBuffers&&f.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(f.extensionShaderTextureLOD||f.envMap||f.transmission)&&f.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ch).join(`
`)}function e1(f){const e=[];for(const i in f){const o=f[i];o!==!1&&e.push("#define "+i+" "+o)}return e.join(`
`)}function Pp(f,e){const i={},o=f.getProgramParameter(e,f.ACTIVE_ATTRIBUTES);for(let l=0;l<o;l++){const d=f.getActiveAttrib(e,l),w=d.name;let I=1;d.type===f.FLOAT_MAT2&&(I=2),d.type===f.FLOAT_MAT3&&(I=3),d.type===f.FLOAT_MAT4&&(I=4),i[w]={type:d.type,location:f.getAttribLocation(e,w),locationSize:I}}return i}function ch(f){return f!==""}function fh(f,e){return f.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Hv(f,e){return f.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const t1=/^[ \t]*#include +<([\w\d./]+)>/gm;function Lp(f){return f.replace(t1,r1)}function r1(f,e){const i=Kn[e];if(i===void 0)throw new Error("Can not resolve #include <"+e+">");return Lp(i)}const Op=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,n1=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function qv(f){return f.replace(n1,Fp).replace(Op,i1)}function i1(f,e,i,o){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Fp(f,e,i,o)}function Fp(f,e,i,o){let l="";for(let d=parseInt(e);d<parseInt(i);d++)l+=o.replace(/\[\s*i\s*\]/g,"[ "+d+" ]").replace(/UNROLLED_LOOP_INDEX/g,d);return l}function Xv(f){let e="precision "+f.precision+` float;
precision `+f.precision+" int;";return f.precision==="highp"?e+=`
#define HIGH_PRECISION`:f.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:f.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function a1(f){let e="SHADOWMAP_TYPE_BASIC";return f.shadowMapType===g?e="SHADOWMAP_TYPE_PCF":f.shadowMapType===C?e="SHADOWMAP_TYPE_PCF_SOFT":f.shadowMapType===D&&(e="SHADOWMAP_TYPE_VSM"),e}function s1(f){let e="ENVMAP_TYPE_CUBE";if(f.envMap)switch(f.envMapMode){case me:case be:e="ENVMAP_TYPE_CUBE";break;case lt:case ot:e="ENVMAP_TYPE_CUBE_UV";break}return e}function o1(f){let e="ENVMAP_MODE_REFLECTION";if(f.envMap)switch(f.envMapMode){case be:case ot:e="ENVMAP_MODE_REFRACTION";break}return e}function u1(f){let e="ENVMAP_BLENDING_NONE";if(f.envMap)switch(f.combine){case et:e="ENVMAP_BLENDING_MULTIPLY";break;case ze:e="ENVMAP_BLENDING_MIX";break;case Xe:e="ENVMAP_BLENDING_ADD";break}return e}function l1(f,e,i,o){const l=f.getContext(),d=i.defines;let w=i.vertexShader,I=i.fragmentShader;const J=a1(i),ee=s1(i),he=o1(i),fe=u1(i),de=i.isWebGL2?"":K2(i),ve=e1(d),Ce=l.createProgram();let Ne,Ke,Oe=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(Ne=[ve].filter(ch).join(`
`),Ne.length>0&&(Ne+=`
`),Ke=[de,ve].filter(ch).join(`
`),Ke.length>0&&(Ke+=`
`)):(Ne=[Xv(i),"#define SHADER_NAME "+i.shaderName,ve,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+he:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphTargets&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargets&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+J:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ch).join(`
`),Ke=[de,Xv(i),"#define SHADER_NAME "+i.shaderName,ve,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+ee:"",i.envMap?"#define "+he:"",i.envMap?"#define "+fe:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+J:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==tt?"#define TONE_MAPPING":"",i.toneMapping!==tt?Kn.tonemapping_pars_fragment:"",i.toneMapping!==tt?Wv("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.transparent?"":"#define OPAQUE",Kn.encodings_pars_fragment,Q2("linearToOutputTexel",i.outputEncoding),i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(ch).join(`
`)),w=Lp(w),w=fh(w,i),w=Hv(w,i),I=Lp(I),I=fh(I,i),I=Hv(I,i),w=qv(w),I=qv(I),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(Oe=`#version 300 es
`,Ne=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Ne,Ke=["#define varying in",i.glslVersion===yl?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===yl?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Ke);const xe=Oe+Ne+w,ut=Oe+Ke+I,rt=Gv(l,l.VERTEX_SHADER,xe),ft=Gv(l,l.FRAGMENT_SHADER,ut);if(l.attachShader(Ce,rt),l.attachShader(Ce,ft),i.index0AttributeName!==void 0?l.bindAttribLocation(Ce,0,i.index0AttributeName):i.morphTargets===!0&&l.bindAttribLocation(Ce,0,"position"),l.linkProgram(Ce),f.debug.checkShaderErrors){const kt=l.getProgramInfoLog(Ce).trim(),nr=l.getShaderInfoLog(rt).trim(),Xt=l.getShaderInfoLog(ft).trim();let it=!0,Pt=!0;if(l.getProgramParameter(Ce,l.LINK_STATUS)===!1){it=!1;const Vt=Vv(l,rt,"vertex"),Zt=Vv(l,ft,"fragment");console.error("THREE.WebGLProgram: Shader Error "+l.getError()+" - VALIDATE_STATUS "+l.getProgramParameter(Ce,l.VALIDATE_STATUS)+`

Program Info Log: `+kt+`
`+Vt+`
`+Zt)}else kt!==""?console.warn("THREE.WebGLProgram: Program Info Log:",kt):(nr===""||Xt==="")&&(Pt=!1);Pt&&(this.diagnostics={runnable:it,programLog:kt,vertexShader:{log:nr,prefix:Ne},fragmentShader:{log:Xt,prefix:Ke}})}l.deleteShader(rt),l.deleteShader(ft);let Mt;this.getUniforms=function(){return Mt===void 0&&(Mt=new rl(l,Ce)),Mt};let Rt;return this.getAttributes=function(){return Rt===void 0&&(Rt=Pp(l,Ce)),Rt},this.destroy=function(){o.releaseStatesOfProgram(this),l.deleteProgram(Ce),this.program=void 0},this.name=i.shaderName,this.id=Y2++,this.cacheKey=e,this.usedTimes=1,this.program=Ce,this.vertexShader=rt,this.fragmentShader=ft,this}let c1=0;class f1{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,o=e.fragmentShader,l=this._getShaderStage(i),d=this._getShaderStage(o),w=this._getShaderCacheForMaterial(e);return w.has(l)===!1&&(w.add(l),l.usedTimes++),w.has(d)===!1&&(w.add(d),d.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const o of i)o.usedTimes--,o.usedTimes===0&&this.shaderCache.delete(o);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;return i.has(e)===!1&&i.set(e,new Set),i.get(e)}_getShaderStage(e){const i=this.shaderCache;if(i.has(e)===!1){const o=new h1;i.set(e,o)}return i.get(e)}}class h1{constructor(){this.id=c1++,this.usedTimes=0}}function d1(f,e,i,o,l,d,w){const I=new Ll,J=new f1,ee=[],he=l.isWebGL2,fe=l.logarithmicDepthBuffer,de=l.floatVertexTextures,ve=l.maxVertexUniforms,Ce=l.vertexTextures;let Ne=l.precision;const Ke={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Oe(it){const Vt=it.skeleton.bones;if(de)return 1024;{const Jt=Math.floor((ve-20)/4),jt=Math.min(Jt,Vt.length);return jt<Vt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Vt.length+" bones. This GPU supports "+jt+"."),0):jt}}function xe(it,Pt,Vt,Zt,Jt){const jt=Zt.fog,ir=it.isMeshStandardMaterial?Zt.environment:null,Sr=(it.isMeshStandardMaterial?i:e).get(it.envMap||ir),Hr=Ke[it.type],or=Jt.isSkinnedMesh?Oe(Jt):0;it.precision!==null&&(Ne=l.getMaxPrecision(it.precision),Ne!==it.precision&&console.warn("THREE.WebGLProgram.getParameters:",it.precision,"not supported, using",Ne,"instead."));let tr,Br,nn,vn;if(Hr){const Kr=Qa[Hr];tr=Kr.vertexShader,Br=Kr.fragmentShader}else tr=it.vertexShader,Br=it.fragmentShader,J.update(it),nn=J.getVertexShaderID(it),vn=J.getFragmentShaderID(it);const Ft=f.getRenderTarget(),mi=it.alphaTest>0,gn=it.clearcoat>0;return{isWebGL2:he,shaderID:Hr,shaderName:it.type,vertexShader:tr,fragmentShader:Br,defines:it.defines,customVertexShaderID:nn,customFragmentShaderID:vn,isRawShaderMaterial:it.isRawShaderMaterial===!0,glslVersion:it.glslVersion,precision:Ne,instancing:Jt.isInstancedMesh===!0,instancingColor:Jt.isInstancedMesh===!0&&Jt.instanceColor!==null,supportsVertexTextures:Ce,outputEncoding:Ft===null?f.outputEncoding:Ft.isXRRenderTarget===!0?Ft.texture.encoding:fi,map:!!it.map,matcap:!!it.matcap,envMap:!!Sr,envMapMode:Sr&&Sr.mapping,envMapCubeUV:!!Sr&&(Sr.mapping===lt||Sr.mapping===ot),lightMap:!!it.lightMap,aoMap:!!it.aoMap,emissiveMap:!!it.emissiveMap,bumpMap:!!it.bumpMap,normalMap:!!it.normalMap,objectSpaceNormalMap:it.normalMapType===Du,tangentSpaceNormalMap:it.normalMapType===Gs,decodeVideoTexture:!!it.map&&it.map.isVideoTexture===!0&&it.map.encoding===xi,clearcoat:gn,clearcoatMap:gn&&!!it.clearcoatMap,clearcoatRoughnessMap:gn&&!!it.clearcoatRoughnessMap,clearcoatNormalMap:gn&&!!it.clearcoatNormalMap,displacementMap:!!it.displacementMap,roughnessMap:!!it.roughnessMap,metalnessMap:!!it.metalnessMap,specularMap:!!it.specularMap,specularIntensityMap:!!it.specularIntensityMap,specularColorMap:!!it.specularColorMap,transparent:it.transparent,alphaMap:!!it.alphaMap,alphaTest:mi,gradientMap:!!it.gradientMap,sheen:it.sheen>0,sheenColorMap:!!it.sheenColorMap,sheenRoughnessMap:!!it.sheenRoughnessMap,transmission:it.transmission>0,transmissionMap:!!it.transmissionMap,thicknessMap:!!it.thicknessMap,combine:it.combine,vertexTangents:!!it.normalMap&&!!Jt.geometry&&!!Jt.geometry.attributes.tangent,vertexColors:it.vertexColors,vertexAlphas:it.vertexColors===!0&&!!Jt.geometry&&!!Jt.geometry.attributes.color&&Jt.geometry.attributes.color.itemSize===4,vertexUvs:!!it.map||!!it.bumpMap||!!it.normalMap||!!it.specularMap||!!it.alphaMap||!!it.emissiveMap||!!it.roughnessMap||!!it.metalnessMap||!!it.clearcoatMap||!!it.clearcoatRoughnessMap||!!it.clearcoatNormalMap||!!it.displacementMap||!!it.transmissionMap||!!it.thicknessMap||!!it.specularIntensityMap||!!it.specularColorMap||!!it.sheenColorMap||!!it.sheenRoughnessMap,uvsVertexOnly:!(!!it.map||!!it.bumpMap||!!it.normalMap||!!it.specularMap||!!it.alphaMap||!!it.emissiveMap||!!it.roughnessMap||!!it.metalnessMap||!!it.clearcoatNormalMap||it.transmission>0||!!it.transmissionMap||!!it.thicknessMap||!!it.specularIntensityMap||!!it.specularColorMap||it.sheen>0||!!it.sheenColorMap||!!it.sheenRoughnessMap)&&!!it.displacementMap,fog:!!jt,useFog:it.fog,fogExp2:jt&&jt.isFogExp2,flatShading:!!it.flatShading,sizeAttenuation:it.sizeAttenuation,logarithmicDepthBuffer:fe,skinning:Jt.isSkinnedMesh===!0&&or>0,maxBones:or,useVertexTexture:de,morphTargets:!!Jt.geometry&&!!Jt.geometry.morphAttributes.position,morphNormals:!!Jt.geometry&&!!Jt.geometry.morphAttributes.normal,morphTargetsCount:!!Jt.geometry&&!!Jt.geometry.morphAttributes.position?Jt.geometry.morphAttributes.position.length:0,numDirLights:Pt.directional.length,numPointLights:Pt.point.length,numSpotLights:Pt.spot.length,numRectAreaLights:Pt.rectArea.length,numHemiLights:Pt.hemi.length,numDirLightShadows:Pt.directionalShadowMap.length,numPointLightShadows:Pt.pointShadowMap.length,numSpotLightShadows:Pt.spotShadowMap.length,numClippingPlanes:w.numPlanes,numClipIntersection:w.numIntersection,dithering:it.dithering,shadowMapEnabled:f.shadowMap.enabled&&Vt.length>0,shadowMapType:f.shadowMap.type,toneMapping:it.toneMapped?f.toneMapping:tt,physicallyCorrectLights:f.physicallyCorrectLights,premultipliedAlpha:it.premultipliedAlpha,doubleSided:it.side===P,flipSided:it.side===V,depthPacking:it.depthPacking!==void 0?it.depthPacking:!1,index0AttributeName:it.index0AttributeName,extensionDerivatives:it.extensions&&it.extensions.derivatives,extensionFragDepth:it.extensions&&it.extensions.fragDepth,extensionDrawBuffers:it.extensions&&it.extensions.drawBuffers,extensionShaderTextureLOD:it.extensions&&it.extensions.shaderTextureLOD,rendererExtensionFragDepth:he||o.has("EXT_frag_depth"),rendererExtensionDrawBuffers:he||o.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:he||o.has("EXT_shader_texture_lod"),customProgramCacheKey:it.customProgramCacheKey()}}function ut(it){const Pt=[];if(it.shaderID?Pt.push(it.shaderID):(Pt.push(it.customVertexShaderID),Pt.push(it.customFragmentShaderID)),it.defines!==void 0)for(const Vt in it.defines)Pt.push(Vt),Pt.push(it.defines[Vt]);return it.isRawShaderMaterial===!1&&(rt(Pt,it),ft(Pt,it),Pt.push(f.outputEncoding)),Pt.push(it.customProgramCacheKey),Pt.join()}function rt(it,Pt){it.push(Pt.precision),it.push(Pt.outputEncoding),it.push(Pt.envMapMode),it.push(Pt.combine),it.push(Pt.vertexUvs),it.push(Pt.fogExp2),it.push(Pt.sizeAttenuation),it.push(Pt.maxBones),it.push(Pt.morphTargetsCount),it.push(Pt.numDirLights),it.push(Pt.numPointLights),it.push(Pt.numSpotLights),it.push(Pt.numHemiLights),it.push(Pt.numRectAreaLights),it.push(Pt.numDirLightShadows),it.push(Pt.numPointLightShadows),it.push(Pt.numSpotLightShadows),it.push(Pt.shadowMapType),it.push(Pt.toneMapping),it.push(Pt.numClippingPlanes),it.push(Pt.numClipIntersection)}function ft(it,Pt){I.disableAll(),Pt.isWebGL2&&I.enable(0),Pt.supportsVertexTextures&&I.enable(1),Pt.instancing&&I.enable(2),Pt.instancingColor&&I.enable(3),Pt.map&&I.enable(4),Pt.matcap&&I.enable(5),Pt.envMap&&I.enable(6),Pt.envMapCubeUV&&I.enable(7),Pt.lightMap&&I.enable(8),Pt.aoMap&&I.enable(9),Pt.emissiveMap&&I.enable(10),Pt.bumpMap&&I.enable(11),Pt.normalMap&&I.enable(12),Pt.objectSpaceNormalMap&&I.enable(13),Pt.tangentSpaceNormalMap&&I.enable(14),Pt.clearcoat&&I.enable(15),Pt.clearcoatMap&&I.enable(16),Pt.clearcoatRoughnessMap&&I.enable(17),Pt.clearcoatNormalMap&&I.enable(18),Pt.displacementMap&&I.enable(19),Pt.specularMap&&I.enable(20),Pt.roughnessMap&&I.enable(21),Pt.metalnessMap&&I.enable(22),Pt.gradientMap&&I.enable(23),Pt.alphaMap&&I.enable(24),Pt.alphaTest&&I.enable(25),Pt.vertexColors&&I.enable(26),Pt.vertexAlphas&&I.enable(27),Pt.vertexUvs&&I.enable(28),Pt.vertexTangents&&I.enable(29),Pt.uvsVertexOnly&&I.enable(30),Pt.fog&&I.enable(31),it.push(I.mask),I.disableAll(),Pt.useFog&&I.enable(0),Pt.flatShading&&I.enable(1),Pt.logarithmicDepthBuffer&&I.enable(2),Pt.skinning&&I.enable(3),Pt.useVertexTexture&&I.enable(4),Pt.morphTargets&&I.enable(5),Pt.morphNormals&&I.enable(6),Pt.premultipliedAlpha&&I.enable(7),Pt.shadowMapEnabled&&I.enable(8),Pt.physicallyCorrectLights&&I.enable(9),Pt.doubleSided&&I.enable(10),Pt.flipSided&&I.enable(11),Pt.depthPacking&&I.enable(12),Pt.dithering&&I.enable(13),Pt.specularIntensityMap&&I.enable(14),Pt.specularColorMap&&I.enable(15),Pt.transmission&&I.enable(16),Pt.transmissionMap&&I.enable(17),Pt.thicknessMap&&I.enable(18),Pt.sheen&&I.enable(19),Pt.sheenColorMap&&I.enable(20),Pt.sheenRoughnessMap&&I.enable(21),Pt.decodeVideoTexture&&I.enable(22),Pt.transparent&&I.enable(23),it.push(I.mask)}function Mt(it){const Pt=Ke[it.type];let Vt;if(Pt){const Zt=Qa[Pt];Vt=gd.clone(Zt.uniforms)}else Vt=it.uniforms;return Vt}function Rt(it,Pt){let Vt;for(let Zt=0,Jt=ee.length;Zt<Jt;Zt++){const jt=ee[Zt];if(jt.cacheKey===Pt){Vt=jt,++Vt.usedTimes;break}}return Vt===void 0&&(Vt=new l1(f,Pt,it,d),ee.push(Vt)),Vt}function kt(it){if(--it.usedTimes===0){const Pt=ee.indexOf(it);ee[Pt]=ee[ee.length-1],ee.pop(),it.destroy()}}function nr(it){J.remove(it)}function Xt(){J.dispose()}return{getParameters:xe,getProgramCacheKey:ut,getUniforms:Mt,acquireProgram:Rt,releaseProgram:kt,releaseShaderCache:nr,programs:ee,dispose:Xt}}function p1(){let f=new WeakMap;function e(d){let w=f.get(d);return w===void 0&&(w={},f.set(d,w)),w}function i(d){f.delete(d)}function o(d,w,I){f.get(d)[w]=I}function l(){f=new WeakMap}return{get:e,remove:i,update:o,dispose:l}}function m1(f,e){return f.groupOrder!==e.groupOrder?f.groupOrder-e.groupOrder:f.renderOrder!==e.renderOrder?f.renderOrder-e.renderOrder:f.material.id!==e.material.id?f.material.id-e.material.id:f.z!==e.z?f.z-e.z:f.id-e.id}function Zv(f,e){return f.groupOrder!==e.groupOrder?f.groupOrder-e.groupOrder:f.renderOrder!==e.renderOrder?f.renderOrder-e.renderOrder:f.z!==e.z?e.z-f.z:f.id-e.id}function Ip(){const f=[];let e=0;const i=[],o=[],l=[];function d(){e=0,i.length=0,o.length=0,l.length=0}function w(fe,de,ve,Ce,Ne,Ke){let Oe=f[e];return Oe===void 0?(Oe={id:fe.id,object:fe,geometry:de,material:ve,groupOrder:Ce,renderOrder:fe.renderOrder,z:Ne,group:Ke},f[e]=Oe):(Oe.id=fe.id,Oe.object=fe,Oe.geometry=de,Oe.material=ve,Oe.groupOrder=Ce,Oe.renderOrder=fe.renderOrder,Oe.z=Ne,Oe.group=Ke),e++,Oe}function I(fe,de,ve,Ce,Ne,Ke){const Oe=w(fe,de,ve,Ce,Ne,Ke);ve.transmission>0?o.push(Oe):ve.transparent===!0?l.push(Oe):i.push(Oe)}function J(fe,de,ve,Ce,Ne,Ke){const Oe=w(fe,de,ve,Ce,Ne,Ke);ve.transmission>0?o.unshift(Oe):ve.transparent===!0?l.unshift(Oe):i.unshift(Oe)}function ee(fe,de){i.length>1&&i.sort(fe||m1),o.length>1&&o.sort(de||Zv),l.length>1&&l.sort(de||Zv)}function he(){for(let fe=e,de=f.length;fe<de;fe++){const ve=f[fe];if(ve.id===null)break;ve.id=null,ve.object=null,ve.geometry=null,ve.material=null,ve.group=null}}return{opaque:i,transmissive:o,transparent:l,init:d,push:I,unshift:J,finish:he,sort:ee}}function v1(){let f=new WeakMap;function e(o,l){let d;return f.has(o)===!1?(d=new Ip,f.set(o,[d])):l>=f.get(o).length?(d=new Ip,f.get(o).push(d)):d=f.get(o)[l],d}function i(){f=new WeakMap}return{get:e,dispose:i}}function g1(){const f={};return{get:function(e){if(f[e.id]!==void 0)return f[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new dt,color:new Or};break;case"SpotLight":i={position:new dt,direction:new dt,color:new Or,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new dt,color:new Or,distance:0,decay:0};break;case"HemisphereLight":i={direction:new dt,skyColor:new Or,groundColor:new Or};break;case"RectAreaLight":i={color:new Or,position:new dt,halfWidth:new dt,halfHeight:new dt};break}return f[e.id]=i,i}}}function jv(){const f={};return{get:function(e){if(f[e.id]!==void 0)return f[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We,shadowCameraNear:1,shadowCameraFar:1e3};break}return f[e.id]=i,i}}}let y1=0;function Yv(f,e){return(e.castShadow?1:0)-(f.castShadow?1:0)}function _1(f,e){const i=new g1,o=jv(),l={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let he=0;he<9;he++)l.probe.push(new dt);const d=new dt,w=new jr,I=new jr;function J(he,fe){let de=0,ve=0,Ce=0;for(let nr=0;nr<9;nr++)l.probe[nr].set(0,0,0);let Ne=0,Ke=0,Oe=0,xe=0,ut=0,rt=0,ft=0,Mt=0;he.sort(Yv);const Rt=fe!==!0?Math.PI:1;for(let nr=0,Xt=he.length;nr<Xt;nr++){const it=he[nr],Pt=it.color,Vt=it.intensity,Zt=it.distance,Jt=it.shadow&&it.shadow.map?it.shadow.map.texture:null;if(it.isAmbientLight)de+=Pt.r*Vt*Rt,ve+=Pt.g*Vt*Rt,Ce+=Pt.b*Vt*Rt;else if(it.isLightProbe)for(let jt=0;jt<9;jt++)l.probe[jt].addScaledVector(it.sh.coefficients[jt],Vt);else if(it.isDirectionalLight){const jt=i.get(it);if(jt.color.copy(it.color).multiplyScalar(it.intensity*Rt),it.castShadow){const ir=it.shadow,Sr=o.get(it);Sr.shadowBias=ir.bias,Sr.shadowNormalBias=ir.normalBias,Sr.shadowRadius=ir.radius,Sr.shadowMapSize=ir.mapSize,l.directionalShadow[Ne]=Sr,l.directionalShadowMap[Ne]=Jt,l.directionalShadowMatrix[Ne]=it.shadow.matrix,rt++}l.directional[Ne]=jt,Ne++}else if(it.isSpotLight){const jt=i.get(it);if(jt.position.setFromMatrixPosition(it.matrixWorld),jt.color.copy(Pt).multiplyScalar(Vt*Rt),jt.distance=Zt,jt.coneCos=Math.cos(it.angle),jt.penumbraCos=Math.cos(it.angle*(1-it.penumbra)),jt.decay=it.decay,it.castShadow){const ir=it.shadow,Sr=o.get(it);Sr.shadowBias=ir.bias,Sr.shadowNormalBias=ir.normalBias,Sr.shadowRadius=ir.radius,Sr.shadowMapSize=ir.mapSize,l.spotShadow[Oe]=Sr,l.spotShadowMap[Oe]=Jt,l.spotShadowMatrix[Oe]=it.shadow.matrix,Mt++}l.spot[Oe]=jt,Oe++}else if(it.isRectAreaLight){const jt=i.get(it);jt.color.copy(Pt).multiplyScalar(Vt),jt.halfWidth.set(it.width*.5,0,0),jt.halfHeight.set(0,it.height*.5,0),l.rectArea[xe]=jt,xe++}else if(it.isPointLight){const jt=i.get(it);if(jt.color.copy(it.color).multiplyScalar(it.intensity*Rt),jt.distance=it.distance,jt.decay=it.decay,it.castShadow){const ir=it.shadow,Sr=o.get(it);Sr.shadowBias=ir.bias,Sr.shadowNormalBias=ir.normalBias,Sr.shadowRadius=ir.radius,Sr.shadowMapSize=ir.mapSize,Sr.shadowCameraNear=ir.camera.near,Sr.shadowCameraFar=ir.camera.far,l.pointShadow[Ke]=Sr,l.pointShadowMap[Ke]=Jt,l.pointShadowMatrix[Ke]=it.shadow.matrix,ft++}l.point[Ke]=jt,Ke++}else if(it.isHemisphereLight){const jt=i.get(it);jt.skyColor.copy(it.color).multiplyScalar(Vt*Rt),jt.groundColor.copy(it.groundColor).multiplyScalar(Vt*Rt),l.hemi[ut]=jt,ut++}}xe>0&&(e.isWebGL2||f.has("OES_texture_float_linear")===!0?(l.rectAreaLTC1=Pr.LTC_FLOAT_1,l.rectAreaLTC2=Pr.LTC_FLOAT_2):f.has("OES_texture_half_float_linear")===!0?(l.rectAreaLTC1=Pr.LTC_HALF_1,l.rectAreaLTC2=Pr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),l.ambient[0]=de,l.ambient[1]=ve,l.ambient[2]=Ce;const kt=l.hash;(kt.directionalLength!==Ne||kt.pointLength!==Ke||kt.spotLength!==Oe||kt.rectAreaLength!==xe||kt.hemiLength!==ut||kt.numDirectionalShadows!==rt||kt.numPointShadows!==ft||kt.numSpotShadows!==Mt)&&(l.directional.length=Ne,l.spot.length=Oe,l.rectArea.length=xe,l.point.length=Ke,l.hemi.length=ut,l.directionalShadow.length=rt,l.directionalShadowMap.length=rt,l.pointShadow.length=ft,l.pointShadowMap.length=ft,l.spotShadow.length=Mt,l.spotShadowMap.length=Mt,l.directionalShadowMatrix.length=rt,l.pointShadowMatrix.length=ft,l.spotShadowMatrix.length=Mt,kt.directionalLength=Ne,kt.pointLength=Ke,kt.spotLength=Oe,kt.rectAreaLength=xe,kt.hemiLength=ut,kt.numDirectionalShadows=rt,kt.numPointShadows=ft,kt.numSpotShadows=Mt,l.version=y1++)}function ee(he,fe){let de=0,ve=0,Ce=0,Ne=0,Ke=0;const Oe=fe.matrixWorldInverse;for(let xe=0,ut=he.length;xe<ut;xe++){const rt=he[xe];if(rt.isDirectionalLight){const ft=l.directional[de];ft.direction.setFromMatrixPosition(rt.matrixWorld),d.setFromMatrixPosition(rt.target.matrixWorld),ft.direction.sub(d),ft.direction.transformDirection(Oe),de++}else if(rt.isSpotLight){const ft=l.spot[Ce];ft.position.setFromMatrixPosition(rt.matrixWorld),ft.position.applyMatrix4(Oe),ft.direction.setFromMatrixPosition(rt.matrixWorld),d.setFromMatrixPosition(rt.target.matrixWorld),ft.direction.sub(d),ft.direction.transformDirection(Oe),Ce++}else if(rt.isRectAreaLight){const ft=l.rectArea[Ne];ft.position.setFromMatrixPosition(rt.matrixWorld),ft.position.applyMatrix4(Oe),I.identity(),w.copy(rt.matrixWorld),w.premultiply(Oe),I.extractRotation(w),ft.halfWidth.set(rt.width*.5,0,0),ft.halfHeight.set(0,rt.height*.5,0),ft.halfWidth.applyMatrix4(I),ft.halfHeight.applyMatrix4(I),Ne++}else if(rt.isPointLight){const ft=l.point[ve];ft.position.setFromMatrixPosition(rt.matrixWorld),ft.position.applyMatrix4(Oe),ve++}else if(rt.isHemisphereLight){const ft=l.hemi[Ke];ft.direction.setFromMatrixPosition(rt.matrixWorld),ft.direction.transformDirection(Oe),ft.direction.normalize(),Ke++}}}return{setup:J,setupView:ee,state:l}}function Jv(f,e){const i=new _1(f,e),o=[],l=[];function d(){o.length=0,l.length=0}function w(fe){o.push(fe)}function I(fe){l.push(fe)}function J(fe){i.setup(o,fe)}function ee(fe){i.setupView(o,fe)}return{init:d,state:{lightsArray:o,shadowsArray:l,lights:i},setupLights:J,setupLightsView:ee,pushLight:w,pushShadow:I}}function x1(f,e){let i=new WeakMap;function o(d,w=0){let I;return i.has(d)===!1?(I=new Jv(f,e),i.set(d,[I])):w>=i.get(d).length?(I=new Jv(f,e),i.get(d).push(I)):I=i.get(d)[w],I}function l(){i=new WeakMap}return{get:o,dispose:l}}class Dd extends Ti{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=Sc,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Dd.prototype.isMeshDepthMaterial=!0;class hh extends Ti{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new dt,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}hh.prototype.isMeshDistanceMaterial=!0;const A1=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,w1=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function $v(f,e,i){let o=new Ba;const l=new We,d=new We,w=new cn,I=new Dd({depthPacking:_s}),J=new hh,ee={},he=i.maxTextureSize,fe={0:V,1:B,2:P},de=new Jn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new We},radius:{value:4}},vertexShader:A1,fragmentShader:w1}),ve=de.clone();ve.defines.HORIZONTAL_PASS=1;const Ce=new An;Ce.setAttribute("position",new ti(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Ne=new ra(Ce,de),Ke=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g,this.render=function(rt,ft,Mt){if(Ke.enabled===!1||Ke.autoUpdate===!1&&Ke.needsUpdate===!1||rt.length===0)return;const Rt=f.getRenderTarget(),kt=f.getActiveCubeFace(),nr=f.getActiveMipmapLevel(),Xt=f.state;Xt.setBlending(b),Xt.buffers.color.setClear(1,1,1,1),Xt.buffers.depth.setTest(!0),Xt.setScissorTest(!1);for(let it=0,Pt=rt.length;it<Pt;it++){const Vt=rt[it],Zt=Vt.shadow;if(Zt===void 0){console.warn("THREE.WebGLShadowMap:",Vt,"has no shadow.");continue}if(Zt.autoUpdate===!1&&Zt.needsUpdate===!1)continue;l.copy(Zt.mapSize);const Jt=Zt.getFrameExtents();if(l.multiply(Jt),d.copy(Zt.mapSize),(l.x>he||l.y>he)&&(l.x>he&&(d.x=Math.floor(he/Jt.x),l.x=d.x*Jt.x,Zt.mapSize.x=d.x),l.y>he&&(d.y=Math.floor(he/Jt.y),l.y=d.y*Jt.y,Zt.mapSize.y=d.y)),Zt.map===null&&!Zt.isPointLightShadow&&this.type===D){const ir={minFilter:at,magFilter:at,format:xn};Zt.map=new Ta(l.x,l.y,ir),Zt.map.texture.name=Vt.name+".shadowMap",Zt.mapPass=new Ta(l.x,l.y,ir),Zt.camera.updateProjectionMatrix()}if(Zt.map===null){const ir={minFilter:oe,magFilter:oe,format:xn};Zt.map=new Ta(l.x,l.y,ir),Zt.map.texture.name=Vt.name+".shadowMap",Zt.camera.updateProjectionMatrix()}f.setRenderTarget(Zt.map),f.clear();const jt=Zt.getViewportCount();for(let ir=0;ir<jt;ir++){const Sr=Zt.getViewport(ir);w.set(d.x*Sr.x,d.y*Sr.y,d.x*Sr.z,d.y*Sr.w),Xt.viewport(w),Zt.updateMatrices(Vt,ir),o=Zt.getFrustum(),ut(ft,Mt,Zt.camera,Vt,this.type)}!Zt.isPointLightShadow&&this.type===D&&Oe(Zt,Mt),Zt.needsUpdate=!1}Ke.needsUpdate=!1,f.setRenderTarget(Rt,kt,nr)};function Oe(rt,ft){const Mt=e.update(Ne);de.defines.VSM_SAMPLES!==rt.blurSamples&&(de.defines.VSM_SAMPLES=rt.blurSamples,ve.defines.VSM_SAMPLES=rt.blurSamples,de.needsUpdate=!0,ve.needsUpdate=!0),de.uniforms.shadow_pass.value=rt.map.texture,de.uniforms.resolution.value=rt.mapSize,de.uniforms.radius.value=rt.radius,f.setRenderTarget(rt.mapPass),f.clear(),f.renderBufferDirect(ft,null,Mt,de,Ne,null),ve.uniforms.shadow_pass.value=rt.mapPass.texture,ve.uniforms.resolution.value=rt.mapSize,ve.uniforms.radius.value=rt.radius,f.setRenderTarget(rt.map),f.clear(),f.renderBufferDirect(ft,null,Mt,ve,Ne,null)}function xe(rt,ft,Mt,Rt,kt,nr,Xt){let it=null;const Pt=Rt.isPointLight===!0?rt.customDistanceMaterial:rt.customDepthMaterial;if(Pt!==void 0?it=Pt:it=Rt.isPointLight===!0?J:I,f.localClippingEnabled&&Mt.clipShadows===!0&&Mt.clippingPlanes.length!==0||Mt.displacementMap&&Mt.displacementScale!==0||Mt.alphaMap&&Mt.alphaTest>0){const Vt=it.uuid,Zt=Mt.uuid;let Jt=ee[Vt];Jt===void 0&&(Jt={},ee[Vt]=Jt);let jt=Jt[Zt];jt===void 0&&(jt=it.clone(),Jt[Zt]=jt),it=jt}return it.visible=Mt.visible,it.wireframe=Mt.wireframe,Xt===D?it.side=Mt.shadowSide!==null?Mt.shadowSide:Mt.side:it.side=Mt.shadowSide!==null?Mt.shadowSide:fe[Mt.side],it.alphaMap=Mt.alphaMap,it.alphaTest=Mt.alphaTest,it.clipShadows=Mt.clipShadows,it.clippingPlanes=Mt.clippingPlanes,it.clipIntersection=Mt.clipIntersection,it.displacementMap=Mt.displacementMap,it.displacementScale=Mt.displacementScale,it.displacementBias=Mt.displacementBias,it.wireframeLinewidth=Mt.wireframeLinewidth,it.linewidth=Mt.linewidth,Rt.isPointLight===!0&&it.isMeshDistanceMaterial===!0&&(it.referencePosition.setFromMatrixPosition(Rt.matrixWorld),it.nearDistance=kt,it.farDistance=nr),it}function ut(rt,ft,Mt,Rt,kt){if(rt.visible===!1)return;if(rt.layers.test(ft.layers)&&(rt.isMesh||rt.isLine||rt.isPoints)&&(rt.castShadow||rt.receiveShadow&&kt===D)&&(!rt.frustumCulled||o.intersectsObject(rt))){rt.modelViewMatrix.multiplyMatrices(Mt.matrixWorldInverse,rt.matrixWorld);const it=e.update(rt),Pt=rt.material;if(Array.isArray(Pt)){const Vt=it.groups;for(let Zt=0,Jt=Vt.length;Zt<Jt;Zt++){const jt=Vt[Zt],ir=Pt[jt.materialIndex];if(ir&&ir.visible){const Sr=xe(rt,it,ir,Rt,Mt.near,Mt.far,kt);f.renderBufferDirect(Mt,null,it,Sr,rt,jt)}}}else if(Pt.visible){const Vt=xe(rt,it,Pt,Rt,Mt.near,Mt.far,kt);f.renderBufferDirect(Mt,null,it,Vt,rt,null)}}const Xt=rt.children;for(let it=0,Pt=Xt.length;it<Pt;it++)ut(Xt[it],ft,Mt,Rt,kt)}}function Qv(f,e,i){const o=i.isWebGL2;function l(){let It=!1;const sn=new cn;let Jr=null;const Fn=new cn(0,0,0,0);return{setMask:function(mr){Jr!==mr&&!It&&(f.colorMask(mr,mr,mr,mr),Jr=mr)},setLocked:function(mr){It=mr},setClear:function(mr,En,si,Qi,Ds){Ds===!0&&(mr*=Qi,En*=Qi,si*=Qi),sn.set(mr,En,si,Qi),Fn.equals(sn)===!1&&(f.clearColor(mr,En,si,Qi),Fn.copy(sn))},reset:function(){It=!1,Jr=null,Fn.set(-1,0,0,0)}}}function d(){let It=!1,sn=null,Jr=null,Fn=null;return{setTest:function(mr){mr?Ft(f.DEPTH_TEST):mi(f.DEPTH_TEST)},setMask:function(mr){sn!==mr&&!It&&(f.depthMask(mr),sn=mr)},setFunc:function(mr){if(Jr!==mr){if(mr)switch(mr){case Y:f.depthFunc(f.NEVER);break;case pe:f.depthFunc(f.ALWAYS);break;case Ee:f.depthFunc(f.LESS);break;case Fe:f.depthFunc(f.LEQUAL);break;case $e:f.depthFunc(f.EQUAL);break;case pt:f.depthFunc(f.GEQUAL);break;case Ue:f.depthFunc(f.GREATER);break;case Je:f.depthFunc(f.NOTEQUAL);break;default:f.depthFunc(f.LEQUAL)}else f.depthFunc(f.LEQUAL);Jr=mr}},setLocked:function(mr){It=mr},setClear:function(mr){Fn!==mr&&(f.clearDepth(mr),Fn=mr)},reset:function(){It=!1,sn=null,Jr=null,Fn=null}}}function w(){let It=!1,sn=null,Jr=null,Fn=null,mr=null,En=null,si=null,Qi=null,Ds=null;return{setTest:function(Ki){It||(Ki?Ft(f.STENCIL_TEST):mi(f.STENCIL_TEST))},setMask:function(Ki){sn!==Ki&&!It&&(f.stencilMask(Ki),sn=Ki)},setFunc:function(Ki,Js,$s){(Jr!==Ki||Fn!==Js||mr!==$s)&&(f.stencilFunc(Ki,Js,$s),Jr=Ki,Fn=Js,mr=$s)},setOp:function(Ki,Js,$s){(En!==Ki||si!==Js||Qi!==$s)&&(f.stencilOp(Ki,Js,$s),En=Ki,si=Js,Qi=$s)},setLocked:function(Ki){It=Ki},setClear:function(Ki){Ds!==Ki&&(f.clearStencil(Ki),Ds=Ki)},reset:function(){It=!1,sn=null,Jr=null,Fn=null,mr=null,En=null,si=null,Qi=null,Ds=null}}}const I=new l,J=new d,ee=new w;let he={},fe={},de=new WeakMap,ve=[],Ce=null,Ne=!1,Ke=null,Oe=null,xe=null,ut=null,rt=null,ft=null,Mt=null,Rt=!1,kt=null,nr=null,Xt=null,it=null,Pt=null;const Vt=f.getParameter(f.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Zt=!1,Jt=0;const jt=f.getParameter(f.VERSION);jt.indexOf("WebGL")!==-1?(Jt=parseFloat(/^WebGL (\d)/.exec(jt)[1]),Zt=Jt>=1):jt.indexOf("OpenGL ES")!==-1&&(Jt=parseFloat(/^OpenGL ES (\d)/.exec(jt)[1]),Zt=Jt>=2);let ir=null,Sr={};const Hr=f.getParameter(f.SCISSOR_BOX),or=f.getParameter(f.VIEWPORT),tr=new cn().fromArray(Hr),Br=new cn().fromArray(or);function nn(It,sn,Jr){const Fn=new Uint8Array(4),mr=f.createTexture();f.bindTexture(It,mr),f.texParameteri(It,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(It,f.TEXTURE_MAG_FILTER,f.NEAREST);for(let En=0;En<Jr;En++)f.texImage2D(sn+En,0,f.RGBA,1,1,0,f.RGBA,f.UNSIGNED_BYTE,Fn);return mr}const vn={};vn[f.TEXTURE_2D]=nn(f.TEXTURE_2D,f.TEXTURE_2D,1),vn[f.TEXTURE_CUBE_MAP]=nn(f.TEXTURE_CUBE_MAP,f.TEXTURE_CUBE_MAP_POSITIVE_X,6),I.setClear(0,0,0,1),J.setClear(1),ee.setClear(0),Ft(f.DEPTH_TEST),J.setFunc(Fe),Cr(!1),en(M),Ft(f.CULL_FACE),pr(b);function Ft(It){he[It]!==!0&&(f.enable(It),he[It]=!0)}function mi(It){he[It]!==!1&&(f.disable(It),he[It]=!1)}function gn(It,sn){return fe[It]!==sn?(f.bindFramebuffer(It,sn),fe[It]=sn,o&&(It===f.DRAW_FRAMEBUFFER&&(fe[f.FRAMEBUFFER]=sn),It===f.FRAMEBUFFER&&(fe[f.DRAW_FRAMEBUFFER]=sn)),!0):!1}function Dn(It,sn){let Jr=ve,Fn=!1;if(It)if(Jr=de.get(sn),Jr===void 0&&(Jr=[],de.set(sn,Jr)),It.isWebGLMultipleRenderTargets){const mr=It.texture;if(Jr.length!==mr.length||Jr[0]!==f.COLOR_ATTACHMENT0){for(let En=0,si=mr.length;En<si;En++)Jr[En]=f.COLOR_ATTACHMENT0+En;Jr.length=mr.length,Fn=!0}}else Jr[0]!==f.COLOR_ATTACHMENT0&&(Jr[0]=f.COLOR_ATTACHMENT0,Fn=!0);else Jr[0]!==f.BACK&&(Jr[0]=f.BACK,Fn=!0);Fn&&(i.isWebGL2?f.drawBuffers(Jr):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Jr))}function Kr(It){return Ce!==It?(f.useProgram(It),Ce=It,!0):!1}const rr={[H]:f.FUNC_ADD,[q]:f.FUNC_SUBTRACT,[te]:f.FUNC_REVERSE_SUBTRACT};if(o)rr[Q]=f.MIN,rr[Z]=f.MAX;else{const It=e.get("EXT_blend_minmax");It!==null&&(rr[Q]=It.MIN_EXT,rr[Z]=It.MAX_EXT)}const Bn={[ae]:f.ZERO,[F]:f.ONE,[W]:f.SRC_COLOR,[X]:f.SRC_ALPHA,[ue]:f.SRC_ALPHA_SATURATE,[ce]:f.DST_COLOR,[j]:f.DST_ALPHA,[O]:f.ONE_MINUS_SRC_COLOR,[G]:f.ONE_MINUS_SRC_ALPHA,[se]:f.ONE_MINUS_DST_COLOR,[K]:f.ONE_MINUS_DST_ALPHA};function pr(It,sn,Jr,Fn,mr,En,si,Qi){if(It===b){Ne===!0&&(mi(f.BLEND),Ne=!1);return}if(Ne===!1&&(Ft(f.BLEND),Ne=!0),It!==U){if(It!==Ke||Qi!==Rt){if((Oe!==H||rt!==H)&&(f.blendEquation(f.FUNC_ADD),Oe=H,rt=H),Qi)switch(It){case _:f.blendFuncSeparate(f.ONE,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA);break;case x:f.blendFunc(f.ONE,f.ONE);break;case T:f.blendFuncSeparate(f.ZERO,f.ONE_MINUS_SRC_COLOR,f.ZERO,f.ONE);break;case N:f.blendFuncSeparate(f.ZERO,f.SRC_COLOR,f.ZERO,f.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",It);break}else switch(It){case _:f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA);break;case x:f.blendFunc(f.SRC_ALPHA,f.ONE);break;case T:f.blendFuncSeparate(f.ZERO,f.ONE_MINUS_SRC_COLOR,f.ZERO,f.ONE);break;case N:f.blendFunc(f.ZERO,f.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",It);break}xe=null,ut=null,ft=null,Mt=null,Ke=It,Rt=Qi}return}mr=mr||sn,En=En||Jr,si=si||Fn,(sn!==Oe||mr!==rt)&&(f.blendEquationSeparate(rr[sn],rr[mr]),Oe=sn,rt=mr),(Jr!==xe||Fn!==ut||En!==ft||si!==Mt)&&(f.blendFuncSeparate(Bn[Jr],Bn[Fn],Bn[En],Bn[si]),xe=Jr,ut=Fn,ft=En,Mt=si),Ke=It,Rt=null}function Fr(It,sn){It.side===P?mi(f.CULL_FACE):Ft(f.CULL_FACE);let Jr=It.side===V;sn&&(Jr=!Jr),Cr(Jr),It.blending===_&&It.transparent===!1?pr(b):pr(It.blending,It.blendEquation,It.blendSrc,It.blendDst,It.blendEquationAlpha,It.blendSrcAlpha,It.blendDstAlpha,It.premultipliedAlpha),J.setFunc(It.depthFunc),J.setTest(It.depthTest),J.setMask(It.depthWrite),I.setMask(It.colorWrite);const Fn=It.stencilWrite;ee.setTest(Fn),Fn&&(ee.setMask(It.stencilWriteMask),ee.setFunc(It.stencilFunc,It.stencilRef,It.stencilFuncMask),ee.setOp(It.stencilFail,It.stencilZFail,It.stencilZPass)),On(It.polygonOffset,It.polygonOffsetFactor,It.polygonOffsetUnits),It.alphaToCoverage===!0?Ft(f.SAMPLE_ALPHA_TO_COVERAGE):mi(f.SAMPLE_ALPHA_TO_COVERAGE)}function Cr(It){kt!==It&&(It?f.frontFace(f.CW):f.frontFace(f.CCW),kt=It)}function en(It){It!==R?(Ft(f.CULL_FACE),It!==nr&&(It===M?f.cullFace(f.BACK):It===v?f.cullFace(f.FRONT):f.cullFace(f.FRONT_AND_BACK))):mi(f.CULL_FACE),nr=It}function Zr(It){It!==Xt&&(Zt&&f.lineWidth(It),Xt=It)}function On(It,sn,Jr){It?(Ft(f.POLYGON_OFFSET_FILL),(it!==sn||Pt!==Jr)&&(f.polygonOffset(sn,Jr),it=sn,Pt=Jr)):mi(f.POLYGON_OFFSET_FILL)}function Sn(It){It?Ft(f.SCISSOR_TEST):mi(f.SCISSOR_TEST)}function li(It){It===void 0&&(It=f.TEXTURE0+Vt-1),ir!==It&&(f.activeTexture(It),ir=It)}function Ui(It,sn){ir===null&&li();let Jr=Sr[ir];Jr===void 0&&(Jr={type:void 0,texture:void 0},Sr[ir]=Jr),(Jr.type!==It||Jr.texture!==sn)&&(f.bindTexture(It,sn||vn[It]),Jr.type=It,Jr.texture=sn)}function Ci(){const It=Sr[ir];It!==void 0&&It.type!==void 0&&(f.bindTexture(It.type,null),It.type=void 0,It.texture=void 0)}function Et(){try{f.compressedTexImage2D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function mt(){try{f.texSubImage2D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function lr(){try{f.texSubImage3D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function Rr(){try{f.compressedTexSubImage2D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function hn(){try{f.texStorage2D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function ur(){try{f.texStorage3D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function wn(){try{f.texImage2D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function yn(){try{f.texImage3D.apply(f,arguments)}catch(It){console.error("THREE.WebGLState:",It)}}function qr(It){tr.equals(It)===!1&&(f.scissor(It.x,It.y,It.z,It.w),tr.copy(It))}function Vr(It){Br.equals(It)===!1&&(f.viewport(It.x,It.y,It.z,It.w),Br.copy(It))}function Vn(){f.disable(f.BLEND),f.disable(f.CULL_FACE),f.disable(f.DEPTH_TEST),f.disable(f.POLYGON_OFFSET_FILL),f.disable(f.SCISSOR_TEST),f.disable(f.STENCIL_TEST),f.disable(f.SAMPLE_ALPHA_TO_COVERAGE),f.blendEquation(f.FUNC_ADD),f.blendFunc(f.ONE,f.ZERO),f.blendFuncSeparate(f.ONE,f.ZERO,f.ONE,f.ZERO),f.colorMask(!0,!0,!0,!0),f.clearColor(0,0,0,0),f.depthMask(!0),f.depthFunc(f.LESS),f.clearDepth(1),f.stencilMask(4294967295),f.stencilFunc(f.ALWAYS,0,4294967295),f.stencilOp(f.KEEP,f.KEEP,f.KEEP),f.clearStencil(0),f.cullFace(f.BACK),f.frontFace(f.CCW),f.polygonOffset(0,0),f.activeTexture(f.TEXTURE0),f.bindFramebuffer(f.FRAMEBUFFER,null),o===!0&&(f.bindFramebuffer(f.DRAW_FRAMEBUFFER,null),f.bindFramebuffer(f.READ_FRAMEBUFFER,null)),f.useProgram(null),f.lineWidth(1),f.scissor(0,0,f.canvas.width,f.canvas.height),f.viewport(0,0,f.canvas.width,f.canvas.height),he={},ir=null,Sr={},fe={},de=new WeakMap,ve=[],Ce=null,Ne=!1,Ke=null,Oe=null,xe=null,ut=null,rt=null,ft=null,Mt=null,Rt=!1,kt=null,nr=null,Xt=null,it=null,Pt=null,tr.set(0,0,f.canvas.width,f.canvas.height),Br.set(0,0,f.canvas.width,f.canvas.height),I.reset(),J.reset(),ee.reset()}return{buffers:{color:I,depth:J,stencil:ee},enable:Ft,disable:mi,bindFramebuffer:gn,drawBuffers:Dn,useProgram:Kr,setBlending:pr,setMaterial:Fr,setFlipSided:Cr,setCullFace:en,setLineWidth:Zr,setPolygonOffset:On,setScissorTest:Sn,activeTexture:li,bindTexture:Ui,unbindTexture:Ci,compressedTexImage2D:Et,texImage2D:wn,texImage3D:yn,texStorage2D:hn,texStorage3D:ur,texSubImage2D:mt,texSubImage3D:lr,compressedTexSubImage2D:Rr,scissor:qr,viewport:Vr,reset:Vn}}function M1(f,e,i,o,l,d,w){const I=l.isWebGL2,J=l.maxTextures,ee=l.maxCubemapSize,he=l.maxTextureSize,fe=l.maxSamples,ve=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,Ce=new WeakMap;let Ne,Ke=!1;try{Ke=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function Oe(Et,mt){return Ke?new OffscreenCanvas(Et,mt):$n("canvas")}function xe(Et,mt,lr,Rr){let hn=1;if((Et.width>Rr||Et.height>Rr)&&(hn=Rr/Math.max(Et.width,Et.height)),hn<1||mt===!0)if(typeof HTMLImageElement<"u"&&Et instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Et instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Et instanceof ImageBitmap){const ur=mt?ie:Math.floor,wn=ur(hn*Et.width),yn=ur(hn*Et.height);Ne===void 0&&(Ne=Oe(wn,yn));const qr=lr?Oe(wn,yn):Ne;return qr.width=wn,qr.height=yn,qr.getContext("2d").drawImage(Et,0,0,wn,yn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Et.width+"x"+Et.height+") to ("+wn+"x"+yn+")."),qr}else return"data"in Et&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Et.width+"x"+Et.height+")."),Et;return Et}function ut(Et){return qe(Et.width)&&qe(Et.height)}function rt(Et){return I?!1:Et.wrapS!==Ie||Et.wrapT!==Ie||Et.minFilter!==oe&&Et.minFilter!==at}function ft(Et,mt){return Et.generateMipmaps&&mt&&Et.minFilter!==oe&&Et.minFilter!==at}function Mt(Et){f.generateMipmap(Et)}function Rt(Et,mt,lr,Rr,hn=!1){if(I===!1)return mt;if(Et!==null){if(f[Et]!==void 0)return f[Et];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Et+"'")}let ur=mt;return mt===f.RED&&(lr===f.FLOAT&&(ur=f.R32F),lr===f.HALF_FLOAT&&(ur=f.R16F),lr===f.UNSIGNED_BYTE&&(ur=f.R8)),mt===f.RG&&(lr===f.FLOAT&&(ur=f.RG32F),lr===f.HALF_FLOAT&&(ur=f.RG16F),lr===f.UNSIGNED_BYTE&&(ur=f.RG8)),mt===f.RGBA&&(lr===f.FLOAT&&(ur=f.RGBA32F),lr===f.HALF_FLOAT&&(ur=f.RGBA16F),lr===f.UNSIGNED_BYTE&&(ur=Rr===xi&&hn===!1?f.SRGB8_ALPHA8:f.RGBA8),lr===f.UNSIGNED_SHORT_4_4_4_4&&(ur=f.RGBA4),lr===f.UNSIGNED_SHORT_5_5_5_1&&(ur=f.RGB5_A1)),(ur===f.R16F||ur===f.R32F||ur===f.RG16F||ur===f.RG32F||ur===f.RGBA16F||ur===f.RGBA32F)&&e.get("EXT_color_buffer_float"),ur}function kt(Et,mt,lr){return ft(Et,lr)===!0||Et.isFramebufferTexture&&Et.minFilter!==oe&&Et.minFilter!==at?Math.log2(Math.max(mt.width,mt.height))+1:Et.mipmaps!==void 0&&Et.mipmaps.length>0?Et.mipmaps.length:Et.isCompressedTexture&&Array.isArray(Et.image)?mt.mipmaps.length:1}function nr(Et){return Et===oe||Et===_e||Et===ke?f.NEAREST:f.LINEAR}function Xt(Et){const mt=Et.target;mt.removeEventListener("dispose",Xt),Pt(mt),mt.isVideoTexture&&Ce.delete(mt),w.memory.textures--}function it(Et){const mt=Et.target;mt.removeEventListener("dispose",it),Vt(mt)}function Pt(Et){const mt=o.get(Et);mt.__webglInit!==void 0&&(f.deleteTexture(mt.__webglTexture),o.remove(Et))}function Vt(Et){const mt=Et.texture,lr=o.get(Et),Rr=o.get(mt);if(!!Et){if(Rr.__webglTexture!==void 0&&(f.deleteTexture(Rr.__webglTexture),w.memory.textures--),Et.depthTexture&&Et.depthTexture.dispose(),Et.isWebGLCubeRenderTarget)for(let hn=0;hn<6;hn++)f.deleteFramebuffer(lr.__webglFramebuffer[hn]),lr.__webglDepthbuffer&&f.deleteRenderbuffer(lr.__webglDepthbuffer[hn]);else f.deleteFramebuffer(lr.__webglFramebuffer),lr.__webglDepthbuffer&&f.deleteRenderbuffer(lr.__webglDepthbuffer),lr.__webglMultisampledFramebuffer&&f.deleteFramebuffer(lr.__webglMultisampledFramebuffer),lr.__webglColorRenderbuffer&&f.deleteRenderbuffer(lr.__webglColorRenderbuffer),lr.__webglDepthRenderbuffer&&f.deleteRenderbuffer(lr.__webglDepthRenderbuffer);if(Et.isWebGLMultipleRenderTargets)for(let hn=0,ur=mt.length;hn<ur;hn++){const wn=o.get(mt[hn]);wn.__webglTexture&&(f.deleteTexture(wn.__webglTexture),w.memory.textures--),o.remove(mt[hn])}o.remove(mt),o.remove(Et)}}let Zt=0;function Jt(){Zt=0}function jt(){const Et=Zt;return Et>=J&&console.warn("THREE.WebGLTextures: Trying to use "+Et+" texture units while this GPU supports only "+J),Zt+=1,Et}function ir(Et,mt){const lr=o.get(Et);if(Et.isVideoTexture&&Zr(Et),Et.version>0&&lr.__version!==Et.version){const Rr=Et.image;if(Rr===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Rr.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ft(lr,Et,mt);return}}i.activeTexture(f.TEXTURE0+mt),i.bindTexture(f.TEXTURE_2D,lr.__webglTexture)}function Sr(Et,mt){const lr=o.get(Et);if(Et.version>0&&lr.__version!==Et.version){Ft(lr,Et,mt);return}i.activeTexture(f.TEXTURE0+mt),i.bindTexture(f.TEXTURE_2D_ARRAY,lr.__webglTexture)}function Hr(Et,mt){const lr=o.get(Et);if(Et.version>0&&lr.__version!==Et.version){Ft(lr,Et,mt);return}i.activeTexture(f.TEXTURE0+mt),i.bindTexture(f.TEXTURE_3D,lr.__webglTexture)}function or(Et,mt){const lr=o.get(Et);if(Et.version>0&&lr.__version!==Et.version){mi(lr,Et,mt);return}i.activeTexture(f.TEXTURE0+mt),i.bindTexture(f.TEXTURE_CUBE_MAP,lr.__webglTexture)}const tr={[bt]:f.REPEAT,[Ie]:f.CLAMP_TO_EDGE,[re]:f.MIRRORED_REPEAT},Br={[oe]:f.NEAREST,[_e]:f.NEAREST_MIPMAP_NEAREST,[ke]:f.NEAREST_MIPMAP_LINEAR,[at]:f.LINEAR,[wt]:f.LINEAR_MIPMAP_NEAREST,[_t]:f.LINEAR_MIPMAP_LINEAR};function nn(Et,mt,lr){if(lr?(f.texParameteri(Et,f.TEXTURE_WRAP_S,tr[mt.wrapS]),f.texParameteri(Et,f.TEXTURE_WRAP_T,tr[mt.wrapT]),(Et===f.TEXTURE_3D||Et===f.TEXTURE_2D_ARRAY)&&f.texParameteri(Et,f.TEXTURE_WRAP_R,tr[mt.wrapR]),f.texParameteri(Et,f.TEXTURE_MAG_FILTER,Br[mt.magFilter]),f.texParameteri(Et,f.TEXTURE_MIN_FILTER,Br[mt.minFilter])):(f.texParameteri(Et,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(Et,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),(Et===f.TEXTURE_3D||Et===f.TEXTURE_2D_ARRAY)&&f.texParameteri(Et,f.TEXTURE_WRAP_R,f.CLAMP_TO_EDGE),(mt.wrapS!==Ie||mt.wrapT!==Ie)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),f.texParameteri(Et,f.TEXTURE_MAG_FILTER,nr(mt.magFilter)),f.texParameteri(Et,f.TEXTURE_MIN_FILTER,nr(mt.minFilter)),mt.minFilter!==oe&&mt.minFilter!==at&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const Rr=e.get("EXT_texture_filter_anisotropic");if(mt.type===dr&&e.has("OES_texture_float_linear")===!1||I===!1&&mt.type===zr&&e.has("OES_texture_half_float_linear")===!1)return;(mt.anisotropy>1||o.get(mt).__currentAnisotropy)&&(f.texParameterf(Et,Rr.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(mt.anisotropy,l.getMaxAnisotropy())),o.get(mt).__currentAnisotropy=mt.anisotropy)}}function vn(Et,mt){Et.__webglInit===void 0&&(Et.__webglInit=!0,mt.addEventListener("dispose",Xt),Et.__webglTexture=f.createTexture(),w.memory.textures++)}function Ft(Et,mt,lr){let Rr=f.TEXTURE_2D;mt.isDataTexture2DArray&&(Rr=f.TEXTURE_2D_ARRAY),mt.isDataTexture3D&&(Rr=f.TEXTURE_3D),vn(Et,mt),i.activeTexture(f.TEXTURE0+lr),i.bindTexture(Rr,Et.__webglTexture),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,mt.flipY),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,mt.premultiplyAlpha),f.pixelStorei(f.UNPACK_ALIGNMENT,mt.unpackAlignment),f.pixelStorei(f.UNPACK_COLORSPACE_CONVERSION_WEBGL,f.NONE);const hn=rt(mt)&&ut(mt.image)===!1;let ur=xe(mt.image,hn,!1,he);ur=On(mt,ur);const wn=ut(ur)||I,yn=d.convert(mt.format,mt.encoding);let qr=d.convert(mt.type),Vr=Rt(mt.internalFormat,yn,qr,mt.encoding,mt.isVideoTexture);nn(Rr,mt,wn);let Vn;const It=mt.mipmaps,sn=I&&mt.isVideoTexture!==!0,Jr=Et.__version===void 0,Fn=kt(mt,ur,wn);if(mt.isDepthTexture)Vr=f.DEPTH_COMPONENT,I?mt.type===dr?Vr=f.DEPTH_COMPONENT32F:mt.type===er?Vr=f.DEPTH_COMPONENT24:mt.type===tn?Vr=f.DEPTH24_STENCIL8:Vr=f.DEPTH_COMPONENT16:mt.type===dr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),mt.format===ta&&Vr===f.DEPTH_COMPONENT&&mt.type!==Dt&&mt.type!==er&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),mt.type=Dt,qr=d.convert(mt.type)),mt.format===ji&&Vr===f.DEPTH_COMPONENT&&(Vr=f.DEPTH_STENCIL,mt.type!==tn&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),mt.type=tn,qr=d.convert(mt.type))),sn&&Jr?i.texStorage2D(f.TEXTURE_2D,1,Vr,ur.width,ur.height):i.texImage2D(f.TEXTURE_2D,0,Vr,ur.width,ur.height,0,yn,qr,null);else if(mt.isDataTexture)if(It.length>0&&wn){sn&&Jr&&i.texStorage2D(f.TEXTURE_2D,Fn,Vr,It[0].width,It[0].height);for(let mr=0,En=It.length;mr<En;mr++)Vn=It[mr],sn?i.texSubImage2D(f.TEXTURE_2D,0,0,0,Vn.width,Vn.height,yn,qr,Vn.data):i.texImage2D(f.TEXTURE_2D,mr,Vr,Vn.width,Vn.height,0,yn,qr,Vn.data);mt.generateMipmaps=!1}else sn?(Jr&&i.texStorage2D(f.TEXTURE_2D,Fn,Vr,ur.width,ur.height),i.texSubImage2D(f.TEXTURE_2D,0,0,0,ur.width,ur.height,yn,qr,ur.data)):i.texImage2D(f.TEXTURE_2D,0,Vr,ur.width,ur.height,0,yn,qr,ur.data);else if(mt.isCompressedTexture){sn&&Jr&&i.texStorage2D(f.TEXTURE_2D,Fn,Vr,It[0].width,It[0].height);for(let mr=0,En=It.length;mr<En;mr++)Vn=It[mr],mt.format!==xn?yn!==null?sn?i.compressedTexSubImage2D(f.TEXTURE_2D,mr,0,0,Vn.width,Vn.height,yn,Vn.data):i.compressedTexImage2D(f.TEXTURE_2D,mr,Vr,Vn.width,Vn.height,0,Vn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):sn?i.texSubImage2D(f.TEXTURE_2D,mr,0,0,Vn.width,Vn.height,yn,qr,Vn.data):i.texImage2D(f.TEXTURE_2D,mr,Vr,Vn.width,Vn.height,0,yn,qr,Vn.data)}else if(mt.isDataTexture2DArray)sn?(Jr&&i.texStorage3D(f.TEXTURE_2D_ARRAY,Fn,Vr,ur.width,ur.height,ur.depth),i.texSubImage3D(f.TEXTURE_2D_ARRAY,0,0,0,0,ur.width,ur.height,ur.depth,yn,qr,ur.data)):i.texImage3D(f.TEXTURE_2D_ARRAY,0,Vr,ur.width,ur.height,ur.depth,0,yn,qr,ur.data);else if(mt.isDataTexture3D)sn?(Jr&&i.texStorage3D(f.TEXTURE_3D,Fn,Vr,ur.width,ur.height,ur.depth),i.texSubImage3D(f.TEXTURE_3D,0,0,0,0,ur.width,ur.height,ur.depth,yn,qr,ur.data)):i.texImage3D(f.TEXTURE_3D,0,Vr,ur.width,ur.height,ur.depth,0,yn,qr,ur.data);else if(mt.isFramebufferTexture)sn&&Jr?i.texStorage2D(f.TEXTURE_2D,Fn,Vr,ur.width,ur.height):i.texImage2D(f.TEXTURE_2D,0,Vr,ur.width,ur.height,0,yn,qr,null);else if(It.length>0&&wn){sn&&Jr&&i.texStorage2D(f.TEXTURE_2D,Fn,Vr,It[0].width,It[0].height);for(let mr=0,En=It.length;mr<En;mr++)Vn=It[mr],sn?i.texSubImage2D(f.TEXTURE_2D,mr,0,0,yn,qr,Vn):i.texImage2D(f.TEXTURE_2D,mr,Vr,yn,qr,Vn);mt.generateMipmaps=!1}else sn?(Jr&&i.texStorage2D(f.TEXTURE_2D,Fn,Vr,ur.width,ur.height),i.texSubImage2D(f.TEXTURE_2D,0,0,0,yn,qr,ur)):i.texImage2D(f.TEXTURE_2D,0,Vr,yn,qr,ur);ft(mt,wn)&&Mt(Rr),Et.__version=mt.version,mt.onUpdate&&mt.onUpdate(mt)}function mi(Et,mt,lr){if(mt.image.length!==6)return;vn(Et,mt),i.activeTexture(f.TEXTURE0+lr),i.bindTexture(f.TEXTURE_CUBE_MAP,Et.__webglTexture),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,mt.flipY),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,mt.premultiplyAlpha),f.pixelStorei(f.UNPACK_ALIGNMENT,mt.unpackAlignment),f.pixelStorei(f.UNPACK_COLORSPACE_CONVERSION_WEBGL,f.NONE);const Rr=mt&&(mt.isCompressedTexture||mt.image[0].isCompressedTexture),hn=mt.image[0]&&mt.image[0].isDataTexture,ur=[];for(let mr=0;mr<6;mr++)!Rr&&!hn?ur[mr]=xe(mt.image[mr],!1,!0,ee):ur[mr]=hn?mt.image[mr].image:mt.image[mr],ur[mr]=On(mt,ur[mr]);const wn=ur[0],yn=ut(wn)||I,qr=d.convert(mt.format,mt.encoding),Vr=d.convert(mt.type),Vn=Rt(mt.internalFormat,qr,Vr,mt.encoding),It=I&&mt.isVideoTexture!==!0,sn=Et.__version===void 0;let Jr=kt(mt,wn,yn);nn(f.TEXTURE_CUBE_MAP,mt,yn);let Fn;if(Rr){It&&sn&&i.texStorage2D(f.TEXTURE_CUBE_MAP,Jr,Vn,wn.width,wn.height);for(let mr=0;mr<6;mr++){Fn=ur[mr].mipmaps;for(let En=0;En<Fn.length;En++){const si=Fn[En];mt.format!==xn?qr!==null?It?i.compressedTexSubImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En,0,0,si.width,si.height,qr,si.data):i.compressedTexImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En,Vn,si.width,si.height,0,si.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):It?i.texSubImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En,0,0,si.width,si.height,qr,Vr,si.data):i.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En,Vn,si.width,si.height,0,qr,Vr,si.data)}}}else{Fn=mt.mipmaps,It&&sn&&(Fn.length>0&&Jr++,i.texStorage2D(f.TEXTURE_CUBE_MAP,Jr,Vn,ur[0].width,ur[0].height));for(let mr=0;mr<6;mr++)if(hn){It?i.texSubImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,0,0,0,ur[mr].width,ur[mr].height,qr,Vr,ur[mr].data):i.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,0,Vn,ur[mr].width,ur[mr].height,0,qr,Vr,ur[mr].data);for(let En=0;En<Fn.length;En++){const Qi=Fn[En].image[mr].image;It?i.texSubImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En+1,0,0,Qi.width,Qi.height,qr,Vr,Qi.data):i.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En+1,Vn,Qi.width,Qi.height,0,qr,Vr,Qi.data)}}else{It?i.texSubImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,0,0,0,qr,Vr,ur[mr]):i.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,0,Vn,qr,Vr,ur[mr]);for(let En=0;En<Fn.length;En++){const si=Fn[En];It?i.texSubImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En+1,0,0,qr,Vr,si.image[mr]):i.texImage2D(f.TEXTURE_CUBE_MAP_POSITIVE_X+mr,En+1,Vn,qr,Vr,si.image[mr])}}}ft(mt,yn)&&Mt(f.TEXTURE_CUBE_MAP),Et.__version=mt.version,mt.onUpdate&&mt.onUpdate(mt)}function gn(Et,mt,lr,Rr,hn){const ur=d.convert(lr.format,lr.encoding),wn=d.convert(lr.type),yn=Rt(lr.internalFormat,ur,wn,lr.encoding);o.get(mt).__hasExternalTextures||(hn===f.TEXTURE_3D||hn===f.TEXTURE_2D_ARRAY?i.texImage3D(hn,0,yn,mt.width,mt.height,mt.depth,0,ur,wn,null):i.texImage2D(hn,0,yn,mt.width,mt.height,0,ur,wn,null)),i.bindFramebuffer(f.FRAMEBUFFER,Et),mt.useRenderToTexture?ve.framebufferTexture2DMultisampleEXT(f.FRAMEBUFFER,Rr,hn,o.get(lr).__webglTexture,0,en(mt)):f.framebufferTexture2D(f.FRAMEBUFFER,Rr,hn,o.get(lr).__webglTexture,0),i.bindFramebuffer(f.FRAMEBUFFER,null)}function Dn(Et,mt,lr){if(f.bindRenderbuffer(f.RENDERBUFFER,Et),mt.depthBuffer&&!mt.stencilBuffer){let Rr=f.DEPTH_COMPONENT16;if(lr||mt.useRenderToTexture){const hn=mt.depthTexture;hn&&hn.isDepthTexture&&(hn.type===dr?Rr=f.DEPTH_COMPONENT32F:hn.type===er&&(Rr=f.DEPTH_COMPONENT24));const ur=en(mt);mt.useRenderToTexture?ve.renderbufferStorageMultisampleEXT(f.RENDERBUFFER,ur,Rr,mt.width,mt.height):f.renderbufferStorageMultisample(f.RENDERBUFFER,ur,Rr,mt.width,mt.height)}else f.renderbufferStorage(f.RENDERBUFFER,Rr,mt.width,mt.height);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,Et)}else if(mt.depthBuffer&&mt.stencilBuffer){const Rr=en(mt);lr&&mt.useRenderbuffer?f.renderbufferStorageMultisample(f.RENDERBUFFER,Rr,f.DEPTH24_STENCIL8,mt.width,mt.height):mt.useRenderToTexture?ve.renderbufferStorageMultisampleEXT(f.RENDERBUFFER,Rr,f.DEPTH24_STENCIL8,mt.width,mt.height):f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_STENCIL,mt.width,mt.height),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.RENDERBUFFER,Et)}else{const Rr=mt.isWebGLMultipleRenderTargets===!0?mt.texture[0]:mt.texture,hn=d.convert(Rr.format,Rr.encoding),ur=d.convert(Rr.type),wn=Rt(Rr.internalFormat,hn,ur,Rr.encoding),yn=en(mt);lr&&mt.useRenderbuffer?f.renderbufferStorageMultisample(f.RENDERBUFFER,yn,wn,mt.width,mt.height):mt.useRenderToTexture?ve.renderbufferStorageMultisampleEXT(f.RENDERBUFFER,yn,wn,mt.width,mt.height):f.renderbufferStorage(f.RENDERBUFFER,wn,mt.width,mt.height)}f.bindRenderbuffer(f.RENDERBUFFER,null)}function Kr(Et,mt){if(mt&&mt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(f.FRAMEBUFFER,Et),!(mt.depthTexture&&mt.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!o.get(mt.depthTexture).__webglTexture||mt.depthTexture.image.width!==mt.width||mt.depthTexture.image.height!==mt.height)&&(mt.depthTexture.image.width=mt.width,mt.depthTexture.image.height=mt.height,mt.depthTexture.needsUpdate=!0),ir(mt.depthTexture,0);const Rr=o.get(mt.depthTexture).__webglTexture,hn=en(mt);if(mt.depthTexture.format===ta)mt.useRenderToTexture?ve.framebufferTexture2DMultisampleEXT(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,Rr,0,hn):f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.TEXTURE_2D,Rr,0);else if(mt.depthTexture.format===ji)mt.useRenderToTexture?ve.framebufferTexture2DMultisampleEXT(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.TEXTURE_2D,Rr,0,hn):f.framebufferTexture2D(f.FRAMEBUFFER,f.DEPTH_STENCIL_ATTACHMENT,f.TEXTURE_2D,Rr,0);else throw new Error("Unknown depthTexture format")}function rr(Et){const mt=o.get(Et),lr=Et.isWebGLCubeRenderTarget===!0;if(Et.depthTexture&&!mt.__autoAllocateDepthBuffer){if(lr)throw new Error("target.depthTexture not supported in Cube render targets");Kr(mt.__webglFramebuffer,Et)}else if(lr){mt.__webglDepthbuffer=[];for(let Rr=0;Rr<6;Rr++)i.bindFramebuffer(f.FRAMEBUFFER,mt.__webglFramebuffer[Rr]),mt.__webglDepthbuffer[Rr]=f.createRenderbuffer(),Dn(mt.__webglDepthbuffer[Rr],Et,!1)}else i.bindFramebuffer(f.FRAMEBUFFER,mt.__webglFramebuffer),mt.__webglDepthbuffer=f.createRenderbuffer(),Dn(mt.__webglDepthbuffer,Et,!1);i.bindFramebuffer(f.FRAMEBUFFER,null)}function Bn(Et,mt,lr){const Rr=o.get(Et);mt!==void 0&&gn(Rr.__webglFramebuffer,Et,Et.texture,f.COLOR_ATTACHMENT0,f.TEXTURE_2D),lr!==void 0&&rr(Et)}function pr(Et){const mt=Et.texture,lr=o.get(Et),Rr=o.get(mt);Et.addEventListener("dispose",it),Et.isWebGLMultipleRenderTargets!==!0&&(Rr.__webglTexture===void 0&&(Rr.__webglTexture=f.createTexture()),Rr.__version=mt.version,w.memory.textures++);const hn=Et.isWebGLCubeRenderTarget===!0,ur=Et.isWebGLMultipleRenderTargets===!0,wn=mt.isDataTexture3D||mt.isDataTexture2DArray,yn=ut(Et)||I;if(hn){lr.__webglFramebuffer=[];for(let qr=0;qr<6;qr++)lr.__webglFramebuffer[qr]=f.createFramebuffer()}else if(lr.__webglFramebuffer=f.createFramebuffer(),ur)if(l.drawBuffers){const qr=Et.texture;for(let Vr=0,Vn=qr.length;Vr<Vn;Vr++){const It=o.get(qr[Vr]);It.__webglTexture===void 0&&(It.__webglTexture=f.createTexture(),w.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Et.useRenderbuffer)if(I){lr.__webglMultisampledFramebuffer=f.createFramebuffer(),lr.__webglColorRenderbuffer=f.createRenderbuffer(),f.bindRenderbuffer(f.RENDERBUFFER,lr.__webglColorRenderbuffer);const qr=d.convert(mt.format,mt.encoding),Vr=d.convert(mt.type),Vn=Rt(mt.internalFormat,qr,Vr,mt.encoding),It=en(Et);f.renderbufferStorageMultisample(f.RENDERBUFFER,It,Vn,Et.width,Et.height),i.bindFramebuffer(f.FRAMEBUFFER,lr.__webglMultisampledFramebuffer),f.framebufferRenderbuffer(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.RENDERBUFFER,lr.__webglColorRenderbuffer),f.bindRenderbuffer(f.RENDERBUFFER,null),Et.depthBuffer&&(lr.__webglDepthRenderbuffer=f.createRenderbuffer(),Dn(lr.__webglDepthRenderbuffer,Et,!0)),i.bindFramebuffer(f.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(hn){i.bindTexture(f.TEXTURE_CUBE_MAP,Rr.__webglTexture),nn(f.TEXTURE_CUBE_MAP,mt,yn);for(let qr=0;qr<6;qr++)gn(lr.__webglFramebuffer[qr],Et,mt,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+qr);ft(mt,yn)&&Mt(f.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(ur){const qr=Et.texture;for(let Vr=0,Vn=qr.length;Vr<Vn;Vr++){const It=qr[Vr],sn=o.get(It);i.bindTexture(f.TEXTURE_2D,sn.__webglTexture),nn(f.TEXTURE_2D,It,yn),gn(lr.__webglFramebuffer,Et,It,f.COLOR_ATTACHMENT0+Vr,f.TEXTURE_2D),ft(It,yn)&&Mt(f.TEXTURE_2D)}i.unbindTexture()}else{let qr=f.TEXTURE_2D;wn&&(I?qr=mt.isDataTexture3D?f.TEXTURE_3D:f.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),i.bindTexture(qr,Rr.__webglTexture),nn(qr,mt,yn),gn(lr.__webglFramebuffer,Et,mt,f.COLOR_ATTACHMENT0,qr),ft(mt,yn)&&Mt(qr),i.unbindTexture()}Et.depthBuffer&&rr(Et)}function Fr(Et){const mt=ut(Et)||I,lr=Et.isWebGLMultipleRenderTargets===!0?Et.texture:[Et.texture];for(let Rr=0,hn=lr.length;Rr<hn;Rr++){const ur=lr[Rr];if(ft(ur,mt)){const wn=Et.isWebGLCubeRenderTarget?f.TEXTURE_CUBE_MAP:f.TEXTURE_2D,yn=o.get(ur).__webglTexture;i.bindTexture(wn,yn),Mt(wn),i.unbindTexture()}}}function Cr(Et){if(Et.useRenderbuffer)if(I){const mt=Et.width,lr=Et.height;let Rr=f.COLOR_BUFFER_BIT;const hn=[f.COLOR_ATTACHMENT0],ur=Et.stencilBuffer?f.DEPTH_STENCIL_ATTACHMENT:f.DEPTH_ATTACHMENT;Et.depthBuffer&&hn.push(ur),Et.ignoreDepthForMultisampleCopy||(Et.depthBuffer&&(Rr|=f.DEPTH_BUFFER_BIT),Et.stencilBuffer&&(Rr|=f.STENCIL_BUFFER_BIT));const wn=o.get(Et);i.bindFramebuffer(f.READ_FRAMEBUFFER,wn.__webglMultisampledFramebuffer),i.bindFramebuffer(f.DRAW_FRAMEBUFFER,wn.__webglFramebuffer),Et.ignoreDepthForMultisampleCopy&&(f.invalidateFramebuffer(f.READ_FRAMEBUFFER,[ur]),f.invalidateFramebuffer(f.DRAW_FRAMEBUFFER,[ur])),f.blitFramebuffer(0,0,mt,lr,0,0,mt,lr,Rr,f.NEAREST),f.invalidateFramebuffer(f.READ_FRAMEBUFFER,hn),i.bindFramebuffer(f.READ_FRAMEBUFFER,null),i.bindFramebuffer(f.DRAW_FRAMEBUFFER,wn.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function en(Et){return I&&(Et.useRenderbuffer||Et.useRenderToTexture)?Math.min(fe,Et.samples):0}function Zr(Et){const mt=w.render.frame;Ce.get(Et)!==mt&&(Ce.set(Et,mt),Et.update())}function On(Et,mt){const lr=Et.encoding,Rr=Et.format,hn=Et.type;return Et.isCompressedTexture===!0||Et.isVideoTexture===!0||Et.format===_l||lr!==fi&&(lr===xi?I===!1?e.has("EXT_sRGB")===!0&&Rr===xn?(Et.format=_l,Et.minFilter=at,Et.generateMipmaps=!1):mt=Ia.sRGBToLinear(mt):(Rr!==xn||hn!==Ct)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",lr)),mt}let Sn=!1,li=!1;function Ui(Et,mt){Et&&Et.isWebGLRenderTarget&&(Sn===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Sn=!0),Et=Et.texture),ir(Et,mt)}function Ci(Et,mt){Et&&Et.isWebGLCubeRenderTarget&&(li===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),li=!0),Et=Et.texture),or(Et,mt)}this.allocateTextureUnit=jt,this.resetTextureUnits=Jt,this.setTexture2D=ir,this.setTexture2DArray=Sr,this.setTexture3D=Hr,this.setTextureCube=or,this.rebindTextures=Bn,this.setupRenderTarget=pr,this.updateRenderTargetMipmap=Fr,this.updateMultisampleRenderTarget=Cr,this.setupDepthRenderbuffer=rr,this.setupFrameBufferTexture=gn,this.safeSetTexture2D=Ui,this.safeSetTextureCube=Ci}function Kv(f,e,i){const o=i.isWebGL2;function l(d,w=null){let I;if(d===Ct)return f.UNSIGNED_BYTE;if(d===Ut)return f.UNSIGNED_SHORT_4_4_4_4;if(d===on)return f.UNSIGNED_SHORT_5_5_5_1;if(d===vt)return f.BYTE;if(d===ct)return f.SHORT;if(d===Dt)return f.UNSIGNED_SHORT;if(d===fr)return f.INT;if(d===er)return f.UNSIGNED_INT;if(d===dr)return f.FLOAT;if(d===zr)return o?f.HALF_FLOAT:(I=e.get("OES_texture_half_float"),I!==null?I.HALF_FLOAT_OES:null);if(d===Ln)return f.ALPHA;if(d===xn)return f.RGBA;if(d===ri)return f.LUMINANCE;if(d===_n)return f.LUMINANCE_ALPHA;if(d===ta)return f.DEPTH_COMPONENT;if(d===ji)return f.DEPTH_STENCIL;if(d===ss)return f.RED;if(d===_i)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),f.RGBA;if(d===_l)return I=e.get("EXT_sRGB"),I!==null?I.SRGB_ALPHA_EXT:null;if(d===Ii)return f.RED_INTEGER;if(d===Ha)return f.RG;if(d===to)return f.RG_INTEGER;if(d===Ou)return f.RGBA_INTEGER;if(d===ms||d===Us||d===Ka||d===Fu)if(w===xi)if(I=e.get("WEBGL_compressed_texture_s3tc_srgb"),I!==null){if(d===ms)return I.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(d===Us)return I.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(d===Ka)return I.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(d===Fu)return I.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(I=e.get("WEBGL_compressed_texture_s3tc"),I!==null){if(d===ms)return I.COMPRESSED_RGB_S3TC_DXT1_EXT;if(d===Us)return I.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(d===Ka)return I.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(d===Fu)return I.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(d===vs||d===gs||d===la||d===ou)if(I=e.get("WEBGL_compressed_texture_pvrtc"),I!==null){if(d===vs)return I.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(d===gs)return I.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(d===la)return I.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(d===ou)return I.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(d===ml)return I=e.get("WEBGL_compressed_texture_etc1"),I!==null?I.COMPRESSED_RGB_ETC1_WEBGL:null;if(d===qa||d===wr)if(I=e.get("WEBGL_compressed_texture_etc"),I!==null){if(d===qa)return w===xi?I.COMPRESSED_SRGB8_ETC2:I.COMPRESSED_RGB8_ETC2;if(d===wr)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:I.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(d===bn||d===Rn||d===Xa||d===Hi||d===Tn||d===Ec||d===Iu||d===ku||d===ro||d===es||d===Pi||d===zf||d===zs||d===vl)if(I=e.get("WEBGL_compressed_texture_astc"),I!==null){if(d===bn)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:I.COMPRESSED_RGBA_ASTC_4x4_KHR;if(d===Rn)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:I.COMPRESSED_RGBA_ASTC_5x4_KHR;if(d===Xa)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:I.COMPRESSED_RGBA_ASTC_5x5_KHR;if(d===Hi)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:I.COMPRESSED_RGBA_ASTC_6x5_KHR;if(d===Tn)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:I.COMPRESSED_RGBA_ASTC_6x6_KHR;if(d===Ec)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:I.COMPRESSED_RGBA_ASTC_8x5_KHR;if(d===Iu)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:I.COMPRESSED_RGBA_ASTC_8x6_KHR;if(d===ku)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:I.COMPRESSED_RGBA_ASTC_8x8_KHR;if(d===ro)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:I.COMPRESSED_RGBA_ASTC_10x5_KHR;if(d===es)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:I.COMPRESSED_RGBA_ASTC_10x6_KHR;if(d===Pi)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:I.COMPRESSED_RGBA_ASTC_10x8_KHR;if(d===zf)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:I.COMPRESSED_RGBA_ASTC_10x10_KHR;if(d===zs)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:I.COMPRESSED_RGBA_ASTC_12x10_KHR;if(d===vl)return w===xi?I.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:I.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(d===uu)if(I=e.get("EXT_texture_compression_bptc"),I!==null){if(d===uu)return w===xi?I.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:I.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(d===tn)return o?f.UNSIGNED_INT_24_8:(I=e.get("WEBGL_depth_texture"),I!==null?I.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:l}}class kp extends da{constructor(e=[]){super(),this.cameras=e}}kp.prototype.isArrayCamera=!0;class Jl extends Gn{constructor(){super(),this.type="Group"}}Jl.prototype.isGroup=!0;const b1={type:"move"};class Dp{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Jl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Jl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new dt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new dt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Jl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new dt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new dt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,o){let l=null,d=null,w=null;const I=this._targetRay,J=this._grip,ee=this._hand;if(e&&i.session.visibilityState!=="visible-blurred")if(I!==null&&(l=i.getPose(e.targetRaySpace,o),l!==null&&(I.matrix.fromArray(l.transform.matrix),I.matrix.decompose(I.position,I.rotation,I.scale),l.linearVelocity?(I.hasLinearVelocity=!0,I.linearVelocity.copy(l.linearVelocity)):I.hasLinearVelocity=!1,l.angularVelocity?(I.hasAngularVelocity=!0,I.angularVelocity.copy(l.angularVelocity)):I.hasAngularVelocity=!1,this.dispatchEvent(b1))),ee&&e.hand){w=!0;for(const Ne of e.hand.values()){const Ke=i.getJointPose(Ne,o);if(ee.joints[Ne.jointName]===void 0){const xe=new Jl;xe.matrixAutoUpdate=!1,xe.visible=!1,ee.joints[Ne.jointName]=xe,ee.add(xe)}const Oe=ee.joints[Ne.jointName];Ke!==null&&(Oe.matrix.fromArray(Ke.transform.matrix),Oe.matrix.decompose(Oe.position,Oe.rotation,Oe.scale),Oe.jointRadius=Ke.radius),Oe.visible=Ke!==null}const he=ee.joints["index-finger-tip"],fe=ee.joints["thumb-tip"],de=he.position.distanceTo(fe.position),ve=.02,Ce=.005;ee.inputState.pinching&&de>ve+Ce?(ee.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!ee.inputState.pinching&&de<=ve-Ce&&(ee.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else J!==null&&e.gripSpace&&(d=i.getPose(e.gripSpace,o),d!==null&&(J.matrix.fromArray(d.transform.matrix),J.matrix.decompose(J.position,J.rotation,J.scale),d.linearVelocity?(J.hasLinearVelocity=!0,J.linearVelocity.copy(d.linearVelocity)):J.hasLinearVelocity=!1,d.angularVelocity?(J.hasAngularVelocity=!0,J.angularVelocity.copy(d.angularVelocity)):J.hasAngularVelocity=!1));return I!==null&&(I.visible=l!==null),J!==null&&(J.visible=d!==null),ee!==null&&(ee.visible=w!==null),this}}class Nd extends Cn{constructor(e,i,o,l,d,w,I,J,ee,he){if(he=he!==void 0?he:ta,he!==ta&&he!==ji)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&he===ta&&(o=Dt),o===void 0&&he===ji&&(o=tn),super(null,l,d,w,I,J,he,o,ee),this.image={width:e,height:i},this.magFilter=I!==void 0?I:oe,this.minFilter=J!==void 0?J:oe,this.flipY=!1,this.generateMipmaps=!1}}Nd.prototype.isDepthTexture=!0;class E1 extends Vs{constructor(e,i){super();const o=this;let l=null,d=1,w=null,I="local-floor";const J=e.extensions.has("WEBGL_multisampled_render_to_texture");let ee=null,he=null,fe=null,de=null,ve=!1,Ce=null;const Ne=i.getContextAttributes();let Ke=null,Oe=null;const xe=[],ut=new Map,rt=new da;rt.layers.enable(1),rt.viewport=new cn;const ft=new da;ft.layers.enable(2),ft.viewport=new cn;const Mt=[rt,ft],Rt=new kp;Rt.layers.enable(1),Rt.layers.enable(2);let kt=null,nr=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(or){let tr=xe[or];return tr===void 0&&(tr=new Dp,xe[or]=tr),tr.getTargetRaySpace()},this.getControllerGrip=function(or){let tr=xe[or];return tr===void 0&&(tr=new Dp,xe[or]=tr),tr.getGripSpace()},this.getHand=function(or){let tr=xe[or];return tr===void 0&&(tr=new Dp,xe[or]=tr),tr.getHandSpace()};function Xt(or){const tr=ut.get(or.inputSource);tr&&tr.dispatchEvent({type:or.type,data:or.inputSource})}function it(){ut.forEach(function(or,tr){or.disconnect(tr)}),ut.clear(),kt=null,nr=null,e.setRenderTarget(Ke),de=null,fe=null,he=null,l=null,Oe=null,Hr.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(or){d=or,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(or){I=or,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return w},this.getBaseLayer=function(){return fe!==null?fe:de},this.getBinding=function(){return he},this.getFrame=function(){return Ce},this.getSession=function(){return l},this.setSession=async function(or){if(l=or,l!==null){if(Ke=e.getRenderTarget(),l.addEventListener("select",Xt),l.addEventListener("selectstart",Xt),l.addEventListener("selectend",Xt),l.addEventListener("squeeze",Xt),l.addEventListener("squeezestart",Xt),l.addEventListener("squeezeend",Xt),l.addEventListener("end",it),l.addEventListener("inputsourceschange",Pt),Ne.xrCompatible!==!0&&await i.makeXRCompatible(),l.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const tr={antialias:l.renderState.layers===void 0?Ne.antialias:!0,alpha:Ne.alpha,depth:Ne.depth,stencil:Ne.stencil,framebufferScaleFactor:d};de=new XRWebGLLayer(l,i,tr),l.updateRenderState({baseLayer:de}),Oe=new Ta(de.framebufferWidth,de.framebufferHeight,{format:xn,type:Ct,encoding:e.outputEncoding})}else{ve=Ne.antialias;let tr=null,Br=null,nn=null;Ne.depth&&(nn=Ne.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,tr=Ne.stencil?ji:ta,Br=Ne.stencil?tn:Dt);const vn={colorFormat:e.outputEncoding===xi?i.SRGB8_ALPHA8:i.RGBA8,depthFormat:nn,scaleFactor:d};he=new XRWebGLBinding(l,i),fe=he.createProjectionLayer(vn),l.updateRenderState({layers:[fe]}),ve?Oe=new El(fe.textureWidth,fe.textureHeight,{format:xn,type:Ct,depthTexture:new Nd(fe.textureWidth,fe.textureHeight,Br,void 0,void 0,void 0,void 0,void 0,void 0,tr),stencilBuffer:Ne.stencil,ignoreDepth:fe.ignoreDepthValues,useRenderToTexture:J,encoding:e.outputEncoding}):Oe=new Ta(fe.textureWidth,fe.textureHeight,{format:xn,type:Ct,depthTexture:new Nd(fe.textureWidth,fe.textureHeight,Br,void 0,void 0,void 0,void 0,void 0,void 0,tr),stencilBuffer:Ne.stencil,ignoreDepth:fe.ignoreDepthValues,encoding:e.outputEncoding})}Oe.isXRRenderTarget=!0,this.setFoveation(1),w=await l.requestReferenceSpace(I),Hr.setContext(l),Hr.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}};function Pt(or){const tr=l.inputSources;for(let Br=0;Br<xe.length;Br++)ut.set(tr[Br],xe[Br]);for(let Br=0;Br<or.removed.length;Br++){const nn=or.removed[Br],vn=ut.get(nn);vn&&(vn.dispatchEvent({type:"disconnected",data:nn}),ut.delete(nn))}for(let Br=0;Br<or.added.length;Br++){const nn=or.added[Br],vn=ut.get(nn);vn&&vn.dispatchEvent({type:"connected",data:nn})}}const Vt=new dt,Zt=new dt;function Jt(or,tr,Br){Vt.setFromMatrixPosition(tr.matrixWorld),Zt.setFromMatrixPosition(Br.matrixWorld);const nn=Vt.distanceTo(Zt),vn=tr.projectionMatrix.elements,Ft=Br.projectionMatrix.elements,mi=vn[14]/(vn[10]-1),gn=vn[14]/(vn[10]+1),Dn=(vn[9]+1)/vn[5],Kr=(vn[9]-1)/vn[5],rr=(vn[8]-1)/vn[0],Bn=(Ft[8]+1)/Ft[0],pr=mi*rr,Fr=mi*Bn,Cr=nn/(-rr+Bn),en=Cr*-rr;tr.matrixWorld.decompose(or.position,or.quaternion,or.scale),or.translateX(en),or.translateZ(Cr),or.matrixWorld.compose(or.position,or.quaternion,or.scale),or.matrixWorldInverse.copy(or.matrixWorld).invert();const Zr=mi+Cr,On=gn+Cr,Sn=pr-en,li=Fr+(nn-en),Ui=Dn*gn/On*Zr,Ci=Kr*gn/On*Zr;or.projectionMatrix.makePerspective(Sn,li,Ui,Ci,Zr,On)}function jt(or,tr){tr===null?or.matrixWorld.copy(or.matrix):or.matrixWorld.multiplyMatrices(tr.matrixWorld,or.matrix),or.matrixWorldInverse.copy(or.matrixWorld).invert()}this.updateCamera=function(or){if(l===null)return;Rt.near=ft.near=rt.near=or.near,Rt.far=ft.far=rt.far=or.far,(kt!==Rt.near||nr!==Rt.far)&&(l.updateRenderState({depthNear:Rt.near,depthFar:Rt.far}),kt=Rt.near,nr=Rt.far);const tr=or.parent,Br=Rt.cameras;jt(Rt,tr);for(let vn=0;vn<Br.length;vn++)jt(Br[vn],tr);Rt.matrixWorld.decompose(Rt.position,Rt.quaternion,Rt.scale),or.position.copy(Rt.position),or.quaternion.copy(Rt.quaternion),or.scale.copy(Rt.scale),or.matrix.copy(Rt.matrix),or.matrixWorld.copy(Rt.matrixWorld);const nn=or.children;for(let vn=0,Ft=nn.length;vn<Ft;vn++)nn[vn].updateMatrixWorld(!0);Br.length===2?Jt(Rt,rt,ft):Rt.projectionMatrix.copy(rt.projectionMatrix)},this.getCamera=function(){return Rt},this.getFoveation=function(){if(fe!==null)return fe.fixedFoveation;if(de!==null)return de.fixedFoveation},this.setFoveation=function(or){fe!==null&&(fe.fixedFoveation=or),de!==null&&de.fixedFoveation!==void 0&&(de.fixedFoveation=or)};let ir=null;function Sr(or,tr){if(ee=tr.getViewerPose(w),Ce=tr,ee!==null){const nn=ee.views;de!==null&&(e.setRenderTargetFramebuffer(Oe,de.framebuffer),e.setRenderTarget(Oe));let vn=!1;nn.length!==Rt.cameras.length&&(Rt.cameras.length=0,vn=!0);for(let Ft=0;Ft<nn.length;Ft++){const mi=nn[Ft];let gn=null;if(de!==null)gn=de.getViewport(mi);else{const Kr=he.getViewSubImage(fe,mi);gn=Kr.viewport,Ft===0&&(e.setRenderTargetTextures(Oe,Kr.colorTexture,fe.ignoreDepthValues?void 0:Kr.depthStencilTexture),e.setRenderTarget(Oe))}const Dn=Mt[Ft];Dn.matrix.fromArray(mi.transform.matrix),Dn.projectionMatrix.fromArray(mi.projectionMatrix),Dn.viewport.set(gn.x,gn.y,gn.width,gn.height),Ft===0&&Rt.matrix.copy(Dn.matrix),vn===!0&&Rt.cameras.push(Dn)}}const Br=l.inputSources;for(let nn=0;nn<xe.length;nn++){const vn=xe[nn],Ft=Br[nn];vn.update(Ft,tr,w)}ir&&ir(or,tr),Ce=null}const Hr=new eh;Hr.setAnimationLoop(Sr),this.setAnimationLoop=function(or){ir=or},this.dispose=function(){}}}function T1(f){function e(Oe,xe){Oe.fogColor.value.copy(xe.color),xe.isFog?(Oe.fogNear.value=xe.near,Oe.fogFar.value=xe.far):xe.isFogExp2&&(Oe.fogDensity.value=xe.density)}function i(Oe,xe,ut,rt,ft){xe.isMeshBasicMaterial?o(Oe,xe):xe.isMeshLambertMaterial?(o(Oe,xe),J(Oe,xe)):xe.isMeshToonMaterial?(o(Oe,xe),he(Oe,xe)):xe.isMeshPhongMaterial?(o(Oe,xe),ee(Oe,xe)):xe.isMeshStandardMaterial?(o(Oe,xe),xe.isMeshPhysicalMaterial?de(Oe,xe,ft):fe(Oe,xe)):xe.isMeshMatcapMaterial?(o(Oe,xe),ve(Oe,xe)):xe.isMeshDepthMaterial?(o(Oe,xe),Ce(Oe,xe)):xe.isMeshDistanceMaterial?(o(Oe,xe),Ne(Oe,xe)):xe.isMeshNormalMaterial?(o(Oe,xe),Ke(Oe,xe)):xe.isLineBasicMaterial?(l(Oe,xe),xe.isLineDashedMaterial&&d(Oe,xe)):xe.isPointsMaterial?w(Oe,xe,ut,rt):xe.isSpriteMaterial?I(Oe,xe):xe.isShadowMaterial?(Oe.color.value.copy(xe.color),Oe.opacity.value=xe.opacity):xe.isShaderMaterial&&(xe.uniformsNeedUpdate=!1)}function o(Oe,xe){Oe.opacity.value=xe.opacity,xe.color&&Oe.diffuse.value.copy(xe.color),xe.emissive&&Oe.emissive.value.copy(xe.emissive).multiplyScalar(xe.emissiveIntensity),xe.map&&(Oe.map.value=xe.map),xe.alphaMap&&(Oe.alphaMap.value=xe.alphaMap),xe.specularMap&&(Oe.specularMap.value=xe.specularMap),xe.alphaTest>0&&(Oe.alphaTest.value=xe.alphaTest);const ut=f.get(xe).envMap;ut&&(Oe.envMap.value=ut,Oe.flipEnvMap.value=ut.isCubeTexture&&ut.isRenderTargetTexture===!1?-1:1,Oe.reflectivity.value=xe.reflectivity,Oe.ior.value=xe.ior,Oe.refractionRatio.value=xe.refractionRatio),xe.lightMap&&(Oe.lightMap.value=xe.lightMap,Oe.lightMapIntensity.value=xe.lightMapIntensity),xe.aoMap&&(Oe.aoMap.value=xe.aoMap,Oe.aoMapIntensity.value=xe.aoMapIntensity);let rt;xe.map?rt=xe.map:xe.specularMap?rt=xe.specularMap:xe.displacementMap?rt=xe.displacementMap:xe.normalMap?rt=xe.normalMap:xe.bumpMap?rt=xe.bumpMap:xe.roughnessMap?rt=xe.roughnessMap:xe.metalnessMap?rt=xe.metalnessMap:xe.alphaMap?rt=xe.alphaMap:xe.emissiveMap?rt=xe.emissiveMap:xe.clearcoatMap?rt=xe.clearcoatMap:xe.clearcoatNormalMap?rt=xe.clearcoatNormalMap:xe.clearcoatRoughnessMap?rt=xe.clearcoatRoughnessMap:xe.specularIntensityMap?rt=xe.specularIntensityMap:xe.specularColorMap?rt=xe.specularColorMap:xe.transmissionMap?rt=xe.transmissionMap:xe.thicknessMap?rt=xe.thicknessMap:xe.sheenColorMap?rt=xe.sheenColorMap:xe.sheenRoughnessMap&&(rt=xe.sheenRoughnessMap),rt!==void 0&&(rt.isWebGLRenderTarget&&(rt=rt.texture),rt.matrixAutoUpdate===!0&&rt.updateMatrix(),Oe.uvTransform.value.copy(rt.matrix));let ft;xe.aoMap?ft=xe.aoMap:xe.lightMap&&(ft=xe.lightMap),ft!==void 0&&(ft.isWebGLRenderTarget&&(ft=ft.texture),ft.matrixAutoUpdate===!0&&ft.updateMatrix(),Oe.uv2Transform.value.copy(ft.matrix))}function l(Oe,xe){Oe.diffuse.value.copy(xe.color),Oe.opacity.value=xe.opacity}function d(Oe,xe){Oe.dashSize.value=xe.dashSize,Oe.totalSize.value=xe.dashSize+xe.gapSize,Oe.scale.value=xe.scale}function w(Oe,xe,ut,rt){Oe.diffuse.value.copy(xe.color),Oe.opacity.value=xe.opacity,Oe.size.value=xe.size*ut,Oe.scale.value=rt*.5,xe.map&&(Oe.map.value=xe.map),xe.alphaMap&&(Oe.alphaMap.value=xe.alphaMap),xe.alphaTest>0&&(Oe.alphaTest.value=xe.alphaTest);let ft;xe.map?ft=xe.map:xe.alphaMap&&(ft=xe.alphaMap),ft!==void 0&&(ft.matrixAutoUpdate===!0&&ft.updateMatrix(),Oe.uvTransform.value.copy(ft.matrix))}function I(Oe,xe){Oe.diffuse.value.copy(xe.color),Oe.opacity.value=xe.opacity,Oe.rotation.value=xe.rotation,xe.map&&(Oe.map.value=xe.map),xe.alphaMap&&(Oe.alphaMap.value=xe.alphaMap),xe.alphaTest>0&&(Oe.alphaTest.value=xe.alphaTest);let ut;xe.map?ut=xe.map:xe.alphaMap&&(ut=xe.alphaMap),ut!==void 0&&(ut.matrixAutoUpdate===!0&&ut.updateMatrix(),Oe.uvTransform.value.copy(ut.matrix))}function J(Oe,xe){xe.emissiveMap&&(Oe.emissiveMap.value=xe.emissiveMap)}function ee(Oe,xe){Oe.specular.value.copy(xe.specular),Oe.shininess.value=Math.max(xe.shininess,1e-4),xe.emissiveMap&&(Oe.emissiveMap.value=xe.emissiveMap),xe.bumpMap&&(Oe.bumpMap.value=xe.bumpMap,Oe.bumpScale.value=xe.bumpScale,xe.side===V&&(Oe.bumpScale.value*=-1)),xe.normalMap&&(Oe.normalMap.value=xe.normalMap,Oe.normalScale.value.copy(xe.normalScale),xe.side===V&&Oe.normalScale.value.negate()),xe.displacementMap&&(Oe.displacementMap.value=xe.displacementMap,Oe.displacementScale.value=xe.displacementScale,Oe.displacementBias.value=xe.displacementBias)}function he(Oe,xe){xe.gradientMap&&(Oe.gradientMap.value=xe.gradientMap),xe.emissiveMap&&(Oe.emissiveMap.value=xe.emissiveMap),xe.bumpMap&&(Oe.bumpMap.value=xe.bumpMap,Oe.bumpScale.value=xe.bumpScale,xe.side===V&&(Oe.bumpScale.value*=-1)),xe.normalMap&&(Oe.normalMap.value=xe.normalMap,Oe.normalScale.value.copy(xe.normalScale),xe.side===V&&Oe.normalScale.value.negate()),xe.displacementMap&&(Oe.displacementMap.value=xe.displacementMap,Oe.displacementScale.value=xe.displacementScale,Oe.displacementBias.value=xe.displacementBias)}function fe(Oe,xe){Oe.roughness.value=xe.roughness,Oe.metalness.value=xe.metalness,xe.roughnessMap&&(Oe.roughnessMap.value=xe.roughnessMap),xe.metalnessMap&&(Oe.metalnessMap.value=xe.metalnessMap),xe.emissiveMap&&(Oe.emissiveMap.value=xe.emissiveMap),xe.bumpMap&&(Oe.bumpMap.value=xe.bumpMap,Oe.bumpScale.value=xe.bumpScale,xe.side===V&&(Oe.bumpScale.value*=-1)),xe.normalMap&&(Oe.normalMap.value=xe.normalMap,Oe.normalScale.value.copy(xe.normalScale),xe.side===V&&Oe.normalScale.value.negate()),xe.displacementMap&&(Oe.displacementMap.value=xe.displacementMap,Oe.displacementScale.value=xe.displacementScale,Oe.displacementBias.value=xe.displacementBias),f.get(xe).envMap&&(Oe.envMapIntensity.value=xe.envMapIntensity)}function de(Oe,xe,ut){fe(Oe,xe),Oe.ior.value=xe.ior,xe.sheen>0&&(Oe.sheenColor.value.copy(xe.sheenColor).multiplyScalar(xe.sheen),Oe.sheenRoughness.value=xe.sheenRoughness,xe.sheenColorMap&&(Oe.sheenColorMap.value=xe.sheenColorMap),xe.sheenRoughnessMap&&(Oe.sheenRoughnessMap.value=xe.sheenRoughnessMap)),xe.clearcoat>0&&(Oe.clearcoat.value=xe.clearcoat,Oe.clearcoatRoughness.value=xe.clearcoatRoughness,xe.clearcoatMap&&(Oe.clearcoatMap.value=xe.clearcoatMap),xe.clearcoatRoughnessMap&&(Oe.clearcoatRoughnessMap.value=xe.clearcoatRoughnessMap),xe.clearcoatNormalMap&&(Oe.clearcoatNormalScale.value.copy(xe.clearcoatNormalScale),Oe.clearcoatNormalMap.value=xe.clearcoatNormalMap,xe.side===V&&Oe.clearcoatNormalScale.value.negate())),xe.transmission>0&&(Oe.transmission.value=xe.transmission,Oe.transmissionSamplerMap.value=ut.texture,Oe.transmissionSamplerSize.value.set(ut.width,ut.height),xe.transmissionMap&&(Oe.transmissionMap.value=xe.transmissionMap),Oe.thickness.value=xe.thickness,xe.thicknessMap&&(Oe.thicknessMap.value=xe.thicknessMap),Oe.attenuationDistance.value=xe.attenuationDistance,Oe.attenuationColor.value.copy(xe.attenuationColor)),Oe.specularIntensity.value=xe.specularIntensity,Oe.specularColor.value.copy(xe.specularColor),xe.specularIntensityMap&&(Oe.specularIntensityMap.value=xe.specularIntensityMap),xe.specularColorMap&&(Oe.specularColorMap.value=xe.specularColorMap)}function ve(Oe,xe){xe.matcap&&(Oe.matcap.value=xe.matcap),xe.bumpMap&&(Oe.bumpMap.value=xe.bumpMap,Oe.bumpScale.value=xe.bumpScale,xe.side===V&&(Oe.bumpScale.value*=-1)),xe.normalMap&&(Oe.normalMap.value=xe.normalMap,Oe.normalScale.value.copy(xe.normalScale),xe.side===V&&Oe.normalScale.value.negate()),xe.displacementMap&&(Oe.displacementMap.value=xe.displacementMap,Oe.displacementScale.value=xe.displacementScale,Oe.displacementBias.value=xe.displacementBias)}function Ce(Oe,xe){xe.displacementMap&&(Oe.displacementMap.value=xe.displacementMap,Oe.displacementScale.value=xe.displacementScale,Oe.displacementBias.value=xe.displacementBias)}function Ne(Oe,xe){xe.displacementMap&&(Oe.displacementMap.value=xe.displacementMap,Oe.displacementScale.value=xe.displacementScale,Oe.displacementBias.value=xe.displacementBias),Oe.referencePosition.value.copy(xe.referencePosition),Oe.nearDistance.value=xe.nearDistance,Oe.farDistance.value=xe.farDistance}function Ke(Oe,xe){xe.bumpMap&&(Oe.bumpMap.value=xe.bumpMap,Oe.bumpScale.value=xe.bumpScale,xe.side===V&&(Oe.bumpScale.value*=-1)),xe.normalMap&&(Oe.normalMap.value=xe.normalMap,Oe.normalScale.value.copy(xe.normalScale),xe.side===V&&Oe.normalScale.value.negate()),xe.displacementMap&&(Oe.displacementMap.value=xe.displacementMap,Oe.displacementScale.value=xe.displacementScale,Oe.displacementBias.value=xe.displacementBias)}return{refreshFogUniforms:e,refreshMaterialUniforms:i}}function S1(){const f=$n("canvas");return f.style.display="block",f}function Ri(f={}){const e=f.canvas!==void 0?f.canvas:S1(),i=f.context!==void 0?f.context:null,o=f.alpha!==void 0?f.alpha:!1,l=f.depth!==void 0?f.depth:!0,d=f.stencil!==void 0?f.stencil:!0,w=f.antialias!==void 0?f.antialias:!1,I=f.premultipliedAlpha!==void 0?f.premultipliedAlpha:!0,J=f.preserveDrawingBuffer!==void 0?f.preserveDrawingBuffer:!1,ee=f.powerPreference!==void 0?f.powerPreference:"default",he=f.failIfMajorPerformanceCaveat!==void 0?f.failIfMajorPerformanceCaveat:!1;let fe=null,de=null;const ve=[],Ce=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=fi,this.physicallyCorrectLights=!1,this.toneMapping=tt,this.toneMappingExposure=1;const Ne=this;let Ke=!1,Oe=0,xe=0,ut=null,rt=-1,ft=null;const Mt=new cn,Rt=new cn;let kt=null,nr=e.width,Xt=e.height,it=1,Pt=null,Vt=null;const Zt=new cn(0,0,nr,Xt),Jt=new cn(0,0,nr,Xt);let jt=!1;const ir=new Ba;let Sr=!1,Hr=!1,or=null;const tr=new jr,Br=new dt,nn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function vn(){return ut===null?it:1}let Ft=i;function mi(xt,qt){for(let Kt=0;Kt<xt.length;Kt++){const Qt=xt[Kt],gr=e.getContext(Qt,qt);if(gr!==null)return gr}return null}try{const xt={alpha:!0,depth:l,stencil:d,antialias:w,premultipliedAlpha:I,preserveDrawingBuffer:J,powerPreference:ee,failIfMajorPerformanceCaveat:he};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${a}`),e.addEventListener("webglcontextlost",Vn,!1),e.addEventListener("webglcontextrestored",It,!1),Ft===null){const qt=["webgl2","webgl","experimental-webgl"];if(Ne.isWebGL1Renderer===!0&&qt.shift(),Ft=mi(qt,xt),Ft===null)throw mi(qt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Ft.getShaderPrecisionFormat===void 0&&(Ft.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(xt){throw console.error("THREE.WebGLRenderer: "+xt.message),xt}let gn,Dn,Kr,rr,Bn,pr,Fr,Cr,en,Zr,On,Sn,li,Ui,Ci,Et,mt,lr,Rr,hn,ur,wn,yn;function qr(){gn=new M2(Ft),Dn=new Ld(Ft,gn,f),gn.init(Dn),wn=new Kv(Ft,gn,Dn),Kr=new Qv(Ft,gn,Dn),rr=new T2(Ft),Bn=new p1,pr=new M1(Ft,gn,Kr,Bn,Dn,wn,rr),Fr=new gp(Ne),Cr=new hv(Ne),en=new _d(Ft,Dn),yn=new sv(Ft,gn,en,Dn),Zr=new b2(Ft,en,rr,yn),On=new mv(Ft,Zr,en,rr),Rr=new pv(Ft,Dn,pr),Et=new Xl(Bn),Sn=new d1(Ne,Fr,Cr,gn,Dn,yn,Et),li=new T1(Bn),Ui=new v1,Ci=new x1(gn,Dn),lr=new vp(Ne,Fr,Kr,On,o,I),mt=new $v(Ne,On,Dn),hn=new Pd(Ft,gn,rr,Dn),ur=new E2(Ft,gn,rr,Dn),rr.programs=Sn.programs,Ne.capabilities=Dn,Ne.extensions=gn,Ne.properties=Bn,Ne.renderLists=Ui,Ne.shadowMap=mt,Ne.state=Kr,Ne.info=rr}qr();const Vr=new E1(Ne,Ft);this.xr=Vr,this.getContext=function(){return Ft},this.getContextAttributes=function(){return Ft.getContextAttributes()},this.forceContextLoss=function(){const xt=gn.get("WEBGL_lose_context");xt&&xt.loseContext()},this.forceContextRestore=function(){const xt=gn.get("WEBGL_lose_context");xt&&xt.restoreContext()},this.getPixelRatio=function(){return it},this.setPixelRatio=function(xt){xt!==void 0&&(it=xt,this.setSize(nr,Xt,!1))},this.getSize=function(xt){return xt.set(nr,Xt)},this.setSize=function(xt,qt,Kt){if(Vr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}nr=xt,Xt=qt,e.width=Math.floor(xt*it),e.height=Math.floor(qt*it),Kt!==!1&&(e.style.width=xt+"px",e.style.height=qt+"px"),this.setViewport(0,0,xt,qt)},this.getDrawingBufferSize=function(xt){return xt.set(nr*it,Xt*it).floor()},this.setDrawingBufferSize=function(xt,qt,Kt){nr=xt,Xt=qt,it=Kt,e.width=Math.floor(xt*Kt),e.height=Math.floor(qt*Kt),this.setViewport(0,0,xt,qt)},this.getCurrentViewport=function(xt){return xt.copy(Mt)},this.getViewport=function(xt){return xt.copy(Zt)},this.setViewport=function(xt,qt,Kt,Qt){xt.isVector4?Zt.set(xt.x,xt.y,xt.z,xt.w):Zt.set(xt,qt,Kt,Qt),Kr.viewport(Mt.copy(Zt).multiplyScalar(it).floor())},this.getScissor=function(xt){return xt.copy(Jt)},this.setScissor=function(xt,qt,Kt,Qt){xt.isVector4?Jt.set(xt.x,xt.y,xt.z,xt.w):Jt.set(xt,qt,Kt,Qt),Kr.scissor(Rt.copy(Jt).multiplyScalar(it).floor())},this.getScissorTest=function(){return jt},this.setScissorTest=function(xt){Kr.setScissorTest(jt=xt)},this.setOpaqueSort=function(xt){Pt=xt},this.setTransparentSort=function(xt){Vt=xt},this.getClearColor=function(xt){return xt.copy(lr.getClearColor())},this.setClearColor=function(){lr.setClearColor.apply(lr,arguments)},this.getClearAlpha=function(){return lr.getClearAlpha()},this.setClearAlpha=function(){lr.setClearAlpha.apply(lr,arguments)},this.clear=function(xt,qt,Kt){let Qt=0;(xt===void 0||xt)&&(Qt|=Ft.COLOR_BUFFER_BIT),(qt===void 0||qt)&&(Qt|=Ft.DEPTH_BUFFER_BIT),(Kt===void 0||Kt)&&(Qt|=Ft.STENCIL_BUFFER_BIT),Ft.clear(Qt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Vn,!1),e.removeEventListener("webglcontextrestored",It,!1),Ui.dispose(),Ci.dispose(),Bn.dispose(),Fr.dispose(),Cr.dispose(),On.dispose(),yn.dispose(),Sn.dispose(),Vr.dispose(),Vr.removeEventListener("sessionstart",si),Vr.removeEventListener("sessionend",Qi),or&&(or.dispose(),or=null),Ds.stop()};function Vn(xt){xt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Ke=!0}function It(){console.log("THREE.WebGLRenderer: Context Restored."),Ke=!1;const xt=rr.autoReset,qt=mt.enabled,Kt=mt.autoUpdate,Qt=mt.needsUpdate,gr=mt.type;qr(),rr.autoReset=xt,mt.enabled=qt,mt.autoUpdate=Kt,mt.needsUpdate=Qt,mt.type=gr}function sn(xt){const qt=xt.target;qt.removeEventListener("dispose",sn),Jr(qt)}function Jr(xt){Fn(xt),Bn.remove(xt)}function Fn(xt){const qt=Bn.get(xt).programs;qt!==void 0&&(qt.forEach(function(Kt){Sn.releaseProgram(Kt)}),xt.isShaderMaterial&&Sn.releaseShaderCache(xt))}this.renderBufferDirect=function(xt,qt,Kt,Qt,gr,zn){qt===null&&(qt=nn);const Wn=gr.isMesh&&gr.matrixWorld.determinant()<0,cr=Ty(xt,qt,Kt,Qt,gr);Kr.setMaterial(Qt,Wn);let Zn=Kt.index;const bi=Kt.attributes.position;if(Zn===null){if(bi===void 0||bi.count===0)return}else if(Zn.count===0)return;let ci=1;Qt.wireframe===!0&&(Zn=Zr.getWireframeAttribute(Kt),ci=2),yn.setup(gr,Qt,cr,Kt,Zn);let hi,aa=hn;Zn!==null&&(hi=en.get(Zn),aa=ur,aa.setIndex(hi));const _c=Zn!==null?Zn.count:bi.count,Cf=Kt.drawRange.start*ci,di=Kt.drawRange.count*ci,eu=zn!==null?zn.start*ci:0,Pa=zn!==null?zn.count*ci:1/0,vi=Math.max(Cf,eu),Qs=Math.min(_c,Cf+di,eu+Pa)-1,tu=Math.max(0,Qs-vi+1);if(tu!==0){if(gr.isMesh)Qt.wireframe===!0?(Kr.setLineWidth(Qt.wireframeLinewidth*vn()),aa.setMode(Ft.LINES)):aa.setMode(Ft.TRIANGLES);else if(gr.isLine){let Su=Qt.linewidth;Su===void 0&&(Su=1),Kr.setLineWidth(Su*vn()),gr.isLineSegments?aa.setMode(Ft.LINES):gr.isLineLoop?aa.setMode(Ft.LINE_LOOP):aa.setMode(Ft.LINE_STRIP)}else gr.isPoints?aa.setMode(Ft.POINTS):gr.isSprite&&aa.setMode(Ft.TRIANGLES);if(gr.isInstancedMesh)aa.renderInstances(vi,tu,gr.count);else if(Kt.isInstancedBufferGeometry){const Su=Math.min(Kt.instanceCount,Kt._maxInstanceCount);aa.renderInstances(vi,tu,Su)}else aa.render(vi,tu)}},this.compile=function(xt,qt){de=Ci.get(xt),de.init(),Ce.push(de),xt.traverseVisible(function(Kt){Kt.isLight&&Kt.layers.test(qt.layers)&&(de.pushLight(Kt),Kt.castShadow&&de.pushShadow(Kt))}),de.setupLights(Ne.physicallyCorrectLights),xt.traverse(function(Kt){const Qt=Kt.material;if(Qt)if(Array.isArray(Qt))for(let gr=0;gr<Qt.length;gr++){const zn=Qt[gr];g0(zn,xt,Kt)}else g0(Qt,xt,Kt)}),Ce.pop(),de=null};let mr=null;function En(xt){mr&&mr(xt)}function si(){Ds.stop()}function Qi(){Ds.start()}const Ds=new eh;Ds.setAnimationLoop(En),typeof window<"u"&&Ds.setContext(window),this.setAnimationLoop=function(xt){mr=xt,Vr.setAnimationLoop(xt),xt===null?Ds.stop():Ds.start()},Vr.addEventListener("sessionstart",si),Vr.addEventListener("sessionend",Qi),this.render=function(xt,qt){if(qt!==void 0&&qt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Ke===!0)return;xt.autoUpdate===!0&&xt.updateMatrixWorld(),qt.parent===null&&qt.updateMatrixWorld(),Vr.enabled===!0&&Vr.isPresenting===!0&&(Vr.cameraAutoUpdate===!0&&Vr.updateCamera(qt),qt=Vr.getCamera()),xt.isScene===!0&&xt.onBeforeRender(Ne,xt,qt,ut),de=Ci.get(xt,Ce.length),de.init(),Ce.push(de),tr.multiplyMatrices(qt.projectionMatrix,qt.matrixWorldInverse),ir.setFromProjectionMatrix(tr),Hr=this.localClippingEnabled,Sr=Et.init(this.clippingPlanes,Hr,qt),fe=Ui.get(xt,ve.length),fe.init(),ve.push(fe),Ki(xt,qt,0,Ne.sortObjects),fe.finish(),Ne.sortObjects===!0&&fe.sort(Pt,Vt),Sr===!0&&Et.beginShadows();const Kt=de.state.shadowsArray;if(mt.render(Kt,xt,qt),Sr===!0&&Et.endShadows(),this.info.autoReset===!0&&this.info.reset(),lr.render(fe,xt),de.setupLights(Ne.physicallyCorrectLights),qt.isArrayCamera){const Qt=qt.cameras;for(let gr=0,zn=Qt.length;gr<zn;gr++){const Wn=Qt[gr];Js(fe,xt,Wn,Wn.viewport)}}else Js(fe,xt,qt);ut!==null&&(pr.updateMultisampleRenderTarget(ut),pr.updateRenderTargetMipmap(ut)),xt.isScene===!0&&xt.onAfterRender(Ne,xt,qt),Kr.buffers.depth.setTest(!0),Kr.buffers.depth.setMask(!0),Kr.buffers.color.setMask(!0),Kr.setPolygonOffset(!1),yn.resetDefaultState(),rt=-1,ft=null,Ce.pop(),Ce.length>0?de=Ce[Ce.length-1]:de=null,ve.pop(),ve.length>0?fe=ve[ve.length-1]:fe=null};function Ki(xt,qt,Kt,Qt){if(xt.visible===!1)return;if(xt.layers.test(qt.layers)){if(xt.isGroup)Kt=xt.renderOrder;else if(xt.isLOD)xt.autoUpdate===!0&&xt.update(qt);else if(xt.isLight)de.pushLight(xt),xt.castShadow&&de.pushShadow(xt);else if(xt.isSprite){if(!xt.frustumCulled||ir.intersectsSprite(xt)){Qt&&Br.setFromMatrixPosition(xt.matrixWorld).applyMatrix4(tr);const Wn=On.update(xt),cr=xt.material;cr.visible&&fe.push(xt,Wn,cr,Kt,Br.z,null)}}else if((xt.isMesh||xt.isLine||xt.isPoints)&&(xt.isSkinnedMesh&&xt.skeleton.frame!==rr.render.frame&&(xt.skeleton.update(),xt.skeleton.frame=rr.render.frame),!xt.frustumCulled||ir.intersectsObject(xt))){Qt&&Br.setFromMatrixPosition(xt.matrixWorld).applyMatrix4(tr);const Wn=On.update(xt),cr=xt.material;if(Array.isArray(cr)){const Zn=Wn.groups;for(let bi=0,ci=Zn.length;bi<ci;bi++){const hi=Zn[bi],aa=cr[hi.materialIndex];aa&&aa.visible&&fe.push(xt,Wn,aa,Kt,Br.z,hi)}}else cr.visible&&fe.push(xt,Wn,cr,Kt,Br.z,null)}}const zn=xt.children;for(let Wn=0,cr=zn.length;Wn<cr;Wn++)Ki(zn[Wn],qt,Kt,Qt)}function Js(xt,qt,Kt,Qt){const gr=xt.opaque,zn=xt.transmissive,Wn=xt.transparent;de.setupLightsView(Kt),zn.length>0&&$s(gr,qt,Kt),Qt&&Kr.viewport(Mt.copy(Qt)),gr.length>0&&v0(gr,qt,Kt),zn.length>0&&v0(zn,qt,Kt),Wn.length>0&&v0(Wn,qt,Kt)}function $s(xt,qt,Kt){if(or===null){const Wn=w===!0&&Dn.isWebGL2===!0?El:Ta;or=new Wn(1024,1024,{generateMipmaps:!0,type:wn.convert(zr)!==null?zr:Ct,minFilter:_t,magFilter:oe,wrapS:Ie,wrapT:Ie,useRenderToTexture:gn.has("WEBGL_multisampled_render_to_texture")})}const Qt=Ne.getRenderTarget();Ne.setRenderTarget(or),Ne.clear();const gr=Ne.toneMapping;Ne.toneMapping=tt,v0(xt,qt,Kt),Ne.toneMapping=gr,pr.updateMultisampleRenderTarget(or),pr.updateRenderTargetMipmap(or),Ne.setRenderTarget(Qt)}function v0(xt,qt,Kt){const Qt=qt.isScene===!0?qt.overrideMaterial:null;for(let gr=0,zn=xt.length;gr<zn;gr++){const Wn=xt[gr],cr=Wn.object,Zn=Wn.geometry,bi=Qt===null?Wn.material:Qt,ci=Wn.group;cr.layers.test(Kt.layers)&&yc(cr,qt,Kt,Zn,bi,ci)}}function yc(xt,qt,Kt,Qt,gr,zn){xt.onBeforeRender(Ne,qt,Kt,Qt,gr,zn),xt.modelViewMatrix.multiplyMatrices(Kt.matrixWorldInverse,xt.matrixWorld),xt.normalMatrix.getNormalMatrix(xt.modelViewMatrix),gr.onBeforeRender(Ne,qt,Kt,Qt,xt,zn),gr.transparent===!0&&gr.side===P?(gr.side=V,gr.needsUpdate=!0,Ne.renderBufferDirect(Kt,qt,Qt,gr,xt,zn),gr.side=B,gr.needsUpdate=!0,Ne.renderBufferDirect(Kt,qt,Qt,gr,xt,zn),gr.side=P):Ne.renderBufferDirect(Kt,qt,Qt,gr,xt,zn),xt.onAfterRender(Ne,qt,Kt,Qt,gr,zn)}function g0(xt,qt,Kt){qt.isScene!==!0&&(qt=nn);const Qt=Bn.get(xt),gr=de.state.lights,zn=de.state.shadowsArray,Wn=gr.state.version,cr=Sn.getParameters(xt,gr.state,zn,qt,Kt),Zn=Sn.getProgramCacheKey(cr);let bi=Qt.programs;Qt.environment=xt.isMeshStandardMaterial?qt.environment:null,Qt.fog=qt.fog,Qt.envMap=(xt.isMeshStandardMaterial?Cr:Fr).get(xt.envMap||Qt.environment),bi===void 0&&(xt.addEventListener("dispose",sn),bi=new Map,Qt.programs=bi);let ci=bi.get(Zn);if(ci!==void 0){if(Qt.currentProgram===ci&&Qt.lightsStateVersion===Wn)return Ey(xt,cr),ci}else cr.uniforms=Sn.getUniforms(xt),xt.onBuild(Kt,cr,Ne),xt.onBeforeCompile(cr,Ne),ci=Sn.acquireProgram(cr,Zn),bi.set(Zn,ci),Qt.uniforms=cr.uniforms;const hi=Qt.uniforms;(!xt.isShaderMaterial&&!xt.isRawShaderMaterial||xt.clipping===!0)&&(hi.clippingPlanes=Et.uniform),Ey(xt,cr),Qt.needsLights=Sy(xt),Qt.lightsStateVersion=Wn,Qt.needsLights&&(hi.ambientLightColor.value=gr.state.ambient,hi.lightProbe.value=gr.state.probe,hi.directionalLights.value=gr.state.directional,hi.directionalLightShadows.value=gr.state.directionalShadow,hi.spotLights.value=gr.state.spot,hi.spotLightShadows.value=gr.state.spotShadow,hi.rectAreaLights.value=gr.state.rectArea,hi.ltc_1.value=gr.state.rectAreaLTC1,hi.ltc_2.value=gr.state.rectAreaLTC2,hi.pointLights.value=gr.state.point,hi.pointLightShadows.value=gr.state.pointShadow,hi.hemisphereLights.value=gr.state.hemi,hi.directionalShadowMap.value=gr.state.directionalShadowMap,hi.directionalShadowMatrix.value=gr.state.directionalShadowMatrix,hi.spotShadowMap.value=gr.state.spotShadowMap,hi.spotShadowMatrix.value=gr.state.spotShadowMatrix,hi.pointShadowMap.value=gr.state.pointShadowMap,hi.pointShadowMatrix.value=gr.state.pointShadowMatrix);const aa=ci.getUniforms(),_c=rl.seqWithValue(aa.seq,hi);return Qt.currentProgram=ci,Qt.uniformsList=_c,ci}function Ey(xt,qt){const Kt=Bn.get(xt);Kt.outputEncoding=qt.outputEncoding,Kt.instancing=qt.instancing,Kt.skinning=qt.skinning,Kt.morphTargets=qt.morphTargets,Kt.morphNormals=qt.morphNormals,Kt.morphTargetsCount=qt.morphTargetsCount,Kt.numClippingPlanes=qt.numClippingPlanes,Kt.numIntersection=qt.numClipIntersection,Kt.vertexAlphas=qt.vertexAlphas,Kt.vertexTangents=qt.vertexTangents,Kt.toneMapping=qt.toneMapping}function Ty(xt,qt,Kt,Qt,gr){qt.isScene!==!0&&(qt=nn),pr.resetTextureUnits();const zn=qt.fog,Wn=Qt.isMeshStandardMaterial?qt.environment:null,cr=ut===null?Ne.outputEncoding:ut.isXRRenderTarget===!0?ut.texture.encoding:fi,Zn=(Qt.isMeshStandardMaterial?Cr:Fr).get(Qt.envMap||Wn),bi=Qt.vertexColors===!0&&!!Kt.attributes.color&&Kt.attributes.color.itemSize===4,ci=!!Qt.normalMap&&!!Kt.attributes.tangent,hi=!!Kt.morphAttributes.position,aa=!!Kt.morphAttributes.normal,_c=Kt.morphAttributes.position?Kt.morphAttributes.position.length:0,Cf=Qt.toneMapped?Ne.toneMapping:tt,di=Bn.get(Qt),eu=de.state.lights;if(Sr===!0&&(Hr===!0||xt!==ft)){const La=xt===ft&&Qt.id===rt;Et.setState(Qt,xt,La)}let Pa=!1;Qt.version===di.__version?(di.needsLights&&di.lightsStateVersion!==eu.state.version||di.outputEncoding!==cr||gr.isInstancedMesh&&di.instancing===!1||!gr.isInstancedMesh&&di.instancing===!0||gr.isSkinnedMesh&&di.skinning===!1||!gr.isSkinnedMesh&&di.skinning===!0||di.envMap!==Zn||Qt.fog&&di.fog!==zn||di.numClippingPlanes!==void 0&&(di.numClippingPlanes!==Et.numPlanes||di.numIntersection!==Et.numIntersection)||di.vertexAlphas!==bi||di.vertexTangents!==ci||di.morphTargets!==hi||di.morphNormals!==aa||di.toneMapping!==Cf||Dn.isWebGL2===!0&&di.morphTargetsCount!==_c)&&(Pa=!0):(Pa=!0,di.__version=Qt.version);let vi=di.currentProgram;Pa===!0&&(vi=g0(Qt,qt,gr));let Qs=!1,tu=!1,Su=!1;const Wa=vi.getUniforms(),zh=di.uniforms;if(Kr.useProgram(vi.program)&&(Qs=!0,tu=!0,Su=!0),Qt.id!==rt&&(rt=Qt.id,tu=!0),Qs||ft!==xt){if(Wa.setValue(Ft,"projectionMatrix",xt.projectionMatrix),Dn.logarithmicDepthBuffer&&Wa.setValue(Ft,"logDepthBufFC",2/(Math.log(xt.far+1)/Math.LN2)),ft!==xt&&(ft=xt,tu=!0,Su=!0),Qt.isShaderMaterial||Qt.isMeshPhongMaterial||Qt.isMeshToonMaterial||Qt.isMeshStandardMaterial||Qt.envMap){const La=Wa.map.cameraPosition;La!==void 0&&La.setValue(Ft,Br.setFromMatrixPosition(xt.matrixWorld))}(Qt.isMeshPhongMaterial||Qt.isMeshToonMaterial||Qt.isMeshLambertMaterial||Qt.isMeshBasicMaterial||Qt.isMeshStandardMaterial||Qt.isShaderMaterial)&&Wa.setValue(Ft,"isOrthographic",xt.isOrthographicCamera===!0),(Qt.isMeshPhongMaterial||Qt.isMeshToonMaterial||Qt.isMeshLambertMaterial||Qt.isMeshBasicMaterial||Qt.isMeshStandardMaterial||Qt.isShaderMaterial||Qt.isShadowMaterial||gr.isSkinnedMesh)&&Wa.setValue(Ft,"viewMatrix",xt.matrixWorldInverse)}if(gr.isSkinnedMesh){Wa.setOptional(Ft,gr,"bindMatrix"),Wa.setOptional(Ft,gr,"bindMatrixInverse");const La=gr.skeleton;La&&(Dn.floatVertexTextures?(La.boneTexture===null&&La.computeBoneTexture(),Wa.setValue(Ft,"boneTexture",La.boneTexture,pr),Wa.setValue(Ft,"boneTextureSize",La.boneTextureSize)):Wa.setOptional(Ft,La,"boneMatrices"))}return!!Kt&&(Kt.morphAttributes.position!==void 0||Kt.morphAttributes.normal!==void 0)&&Rr.update(gr,Kt,Qt,vi),(tu||di.receiveShadow!==gr.receiveShadow)&&(di.receiveShadow=gr.receiveShadow,Wa.setValue(Ft,"receiveShadow",gr.receiveShadow)),tu&&(Wa.setValue(Ft,"toneMappingExposure",Ne.toneMappingExposure),di.needsLights&&px(zh,Su),zn&&Qt.fog&&li.refreshFogUniforms(zh,zn),li.refreshMaterialUniforms(zh,Qt,it,Xt,or),rl.upload(Ft,di.uniformsList,zh,pr)),Qt.isShaderMaterial&&Qt.uniformsNeedUpdate===!0&&(rl.upload(Ft,di.uniformsList,zh,pr),Qt.uniformsNeedUpdate=!1),Qt.isSpriteMaterial&&Wa.setValue(Ft,"center",gr.center),Wa.setValue(Ft,"modelViewMatrix",gr.modelViewMatrix),Wa.setValue(Ft,"normalMatrix",gr.normalMatrix),Wa.setValue(Ft,"modelMatrix",gr.matrixWorld),vi}function px(xt,qt){xt.ambientLightColor.needsUpdate=qt,xt.lightProbe.needsUpdate=qt,xt.directionalLights.needsUpdate=qt,xt.directionalLightShadows.needsUpdate=qt,xt.pointLights.needsUpdate=qt,xt.pointLightShadows.needsUpdate=qt,xt.spotLights.needsUpdate=qt,xt.spotLightShadows.needsUpdate=qt,xt.rectAreaLights.needsUpdate=qt,xt.hemisphereLights.needsUpdate=qt}function Sy(xt){return xt.isMeshLambertMaterial||xt.isMeshToonMaterial||xt.isMeshPhongMaterial||xt.isMeshStandardMaterial||xt.isShadowMaterial||xt.isShaderMaterial&&xt.lights===!0}this.getActiveCubeFace=function(){return Oe},this.getActiveMipmapLevel=function(){return xe},this.getRenderTarget=function(){return ut},this.setRenderTargetTextures=function(xt,qt,Kt){Bn.get(xt.texture).__webglTexture=qt,Bn.get(xt.depthTexture).__webglTexture=Kt;const Qt=Bn.get(xt);Qt.__hasExternalTextures=!0,Qt.__hasExternalTextures&&(Qt.__autoAllocateDepthBuffer=Kt===void 0,Qt.__autoAllocateDepthBuffer||xt.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),xt.useRenderToTexture=!1,xt.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(xt,qt){const Kt=Bn.get(xt);Kt.__webglFramebuffer=qt,Kt.__useDefaultFramebuffer=qt===void 0},this.setRenderTarget=function(xt,qt=0,Kt=0){ut=xt,Oe=qt,xe=Kt;let Qt=!0;if(xt){const Zn=Bn.get(xt);Zn.__useDefaultFramebuffer!==void 0?(Kr.bindFramebuffer(Ft.FRAMEBUFFER,null),Qt=!1):Zn.__webglFramebuffer===void 0?pr.setupRenderTarget(xt):Zn.__hasExternalTextures&&pr.rebindTextures(xt,Bn.get(xt.texture).__webglTexture,Bn.get(xt.depthTexture).__webglTexture)}let gr=null,zn=!1,Wn=!1;if(xt){const Zn=xt.texture;(Zn.isDataTexture3D||Zn.isDataTexture2DArray)&&(Wn=!0);const bi=Bn.get(xt).__webglFramebuffer;xt.isWebGLCubeRenderTarget?(gr=bi[qt],zn=!0):xt.useRenderbuffer?gr=Bn.get(xt).__webglMultisampledFramebuffer:gr=bi,Mt.copy(xt.viewport),Rt.copy(xt.scissor),kt=xt.scissorTest}else Mt.copy(Zt).multiplyScalar(it).floor(),Rt.copy(Jt).multiplyScalar(it).floor(),kt=jt;if(Kr.bindFramebuffer(Ft.FRAMEBUFFER,gr)&&Dn.drawBuffers&&Qt&&Kr.drawBuffers(xt,gr),Kr.viewport(Mt),Kr.scissor(Rt),Kr.setScissorTest(kt),zn){const Zn=Bn.get(xt.texture);Ft.framebufferTexture2D(Ft.FRAMEBUFFER,Ft.COLOR_ATTACHMENT0,Ft.TEXTURE_CUBE_MAP_POSITIVE_X+qt,Zn.__webglTexture,Kt)}else if(Wn){const Zn=Bn.get(xt.texture),bi=qt||0;Ft.framebufferTextureLayer(Ft.FRAMEBUFFER,Ft.COLOR_ATTACHMENT0,Zn.__webglTexture,Kt||0,bi)}rt=-1},this.readRenderTargetPixels=function(xt,qt,Kt,Qt,gr,zn,Wn){if(!(xt&&xt.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let cr=Bn.get(xt).__webglFramebuffer;if(xt.isWebGLCubeRenderTarget&&Wn!==void 0&&(cr=cr[Wn]),cr){Kr.bindFramebuffer(Ft.FRAMEBUFFER,cr);try{const Zn=xt.texture,bi=Zn.format,ci=Zn.type;if(bi!==xn&&wn.convert(bi)!==Ft.getParameter(Ft.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const hi=ci===zr&&(gn.has("EXT_color_buffer_half_float")||Dn.isWebGL2&&gn.has("EXT_color_buffer_float"));if(ci!==Ct&&wn.convert(ci)!==Ft.getParameter(Ft.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ci===dr&&(Dn.isWebGL2||gn.has("OES_texture_float")||gn.has("WEBGL_color_buffer_float")))&&!hi){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ft.checkFramebufferStatus(Ft.FRAMEBUFFER)===Ft.FRAMEBUFFER_COMPLETE?qt>=0&&qt<=xt.width-Qt&&Kt>=0&&Kt<=xt.height-gr&&Ft.readPixels(qt,Kt,Qt,gr,wn.convert(bi),wn.convert(ci),zn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Zn=ut!==null?Bn.get(ut).__webglFramebuffer:null;Kr.bindFramebuffer(Ft.FRAMEBUFFER,Zn)}}},this.copyFramebufferToTexture=function(xt,qt,Kt=0){if(qt.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}const Qt=Math.pow(2,-Kt),gr=Math.floor(qt.image.width*Qt),zn=Math.floor(qt.image.height*Qt);pr.setTexture2D(qt,0),Ft.copyTexSubImage2D(Ft.TEXTURE_2D,Kt,0,0,xt.x,xt.y,gr,zn),Kr.unbindTexture()},this.copyTextureToTexture=function(xt,qt,Kt,Qt=0){const gr=qt.image.width,zn=qt.image.height,Wn=wn.convert(Kt.format),cr=wn.convert(Kt.type);pr.setTexture2D(Kt,0),Ft.pixelStorei(Ft.UNPACK_FLIP_Y_WEBGL,Kt.flipY),Ft.pixelStorei(Ft.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Kt.premultiplyAlpha),Ft.pixelStorei(Ft.UNPACK_ALIGNMENT,Kt.unpackAlignment),qt.isDataTexture?Ft.texSubImage2D(Ft.TEXTURE_2D,Qt,xt.x,xt.y,gr,zn,Wn,cr,qt.image.data):qt.isCompressedTexture?Ft.compressedTexSubImage2D(Ft.TEXTURE_2D,Qt,xt.x,xt.y,qt.mipmaps[0].width,qt.mipmaps[0].height,Wn,qt.mipmaps[0].data):Ft.texSubImage2D(Ft.TEXTURE_2D,Qt,xt.x,xt.y,Wn,cr,qt.image),Qt===0&&Kt.generateMipmaps&&Ft.generateMipmap(Ft.TEXTURE_2D),Kr.unbindTexture()},this.copyTextureToTexture3D=function(xt,qt,Kt,Qt,gr=0){if(Ne.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const zn=xt.max.x-xt.min.x+1,Wn=xt.max.y-xt.min.y+1,cr=xt.max.z-xt.min.z+1,Zn=wn.convert(Qt.format),bi=wn.convert(Qt.type);let ci;if(Qt.isDataTexture3D)pr.setTexture3D(Qt,0),ci=Ft.TEXTURE_3D;else if(Qt.isDataTexture2DArray)pr.setTexture2DArray(Qt,0),ci=Ft.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ft.pixelStorei(Ft.UNPACK_FLIP_Y_WEBGL,Qt.flipY),Ft.pixelStorei(Ft.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Qt.premultiplyAlpha),Ft.pixelStorei(Ft.UNPACK_ALIGNMENT,Qt.unpackAlignment);const hi=Ft.getParameter(Ft.UNPACK_ROW_LENGTH),aa=Ft.getParameter(Ft.UNPACK_IMAGE_HEIGHT),_c=Ft.getParameter(Ft.UNPACK_SKIP_PIXELS),Cf=Ft.getParameter(Ft.UNPACK_SKIP_ROWS),di=Ft.getParameter(Ft.UNPACK_SKIP_IMAGES),eu=Kt.isCompressedTexture?Kt.mipmaps[0]:Kt.image;Ft.pixelStorei(Ft.UNPACK_ROW_LENGTH,eu.width),Ft.pixelStorei(Ft.UNPACK_IMAGE_HEIGHT,eu.height),Ft.pixelStorei(Ft.UNPACK_SKIP_PIXELS,xt.min.x),Ft.pixelStorei(Ft.UNPACK_SKIP_ROWS,xt.min.y),Ft.pixelStorei(Ft.UNPACK_SKIP_IMAGES,xt.min.z),Kt.isDataTexture||Kt.isDataTexture3D?Ft.texSubImage3D(ci,gr,qt.x,qt.y,qt.z,zn,Wn,cr,Zn,bi,eu.data):Kt.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ft.compressedTexSubImage3D(ci,gr,qt.x,qt.y,qt.z,zn,Wn,cr,Zn,eu.data)):Ft.texSubImage3D(ci,gr,qt.x,qt.y,qt.z,zn,Wn,cr,Zn,bi,eu),Ft.pixelStorei(Ft.UNPACK_ROW_LENGTH,hi),Ft.pixelStorei(Ft.UNPACK_IMAGE_HEIGHT,aa),Ft.pixelStorei(Ft.UNPACK_SKIP_PIXELS,_c),Ft.pixelStorei(Ft.UNPACK_SKIP_ROWS,Cf),Ft.pixelStorei(Ft.UNPACK_SKIP_IMAGES,di),gr===0&&Qt.generateMipmaps&&Ft.generateMipmap(ci),Kr.unbindTexture()},this.initTexture=function(xt){pr.setTexture2D(xt,0),Kr.unbindTexture()},this.resetState=function(){Oe=0,xe=0,ut=null,Kr.reset(),yn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ri.prototype.isWebGLRenderer=!0;class eg extends Ri{}eg.prototype.isWebGL1Renderer=!0;class dh{constructor(e,i=25e-5){this.name="",this.color=new Or(e),this.density=i}clone(){return new dh(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}dh.prototype.isFogExp2=!0;class ph{constructor(e,i=1,o=1e3){this.name="",this.color=new Or(e),this.near=i,this.far=o}clone(){return new ph(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}ph.prototype.isFog=!0;class nl extends Gn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),i}}nl.prototype.isScene=!0;class $l{constructor(e,i){this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=Uu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=os()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,o){e*=this.stride,o*=i.stride;for(let l=0,d=this.stride;l<d;l++)this.array[e+l]=i.array[o+l];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=os()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),o=new this.constructor(i,this.stride);return o.setUsage(this.usage),o}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=os()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}$l.prototype.isInterleavedBuffer=!0;const Yi=new dt;class il{constructor(e,i,o,l=!1){this.name="",this.data=e,this.itemSize=i,this.offset=o,this.normalized=l===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,o=this.data.count;i<o;i++)Yi.x=this.getX(i),Yi.y=this.getY(i),Yi.z=this.getZ(i),Yi.applyMatrix4(e),this.setXYZ(i,Yi.x,Yi.y,Yi.z);return this}applyNormalMatrix(e){for(let i=0,o=this.count;i<o;i++)Yi.x=this.getX(i),Yi.y=this.getY(i),Yi.z=this.getZ(i),Yi.applyNormalMatrix(e),this.setXYZ(i,Yi.x,Yi.y,Yi.z);return this}transformDirection(e){for(let i=0,o=this.count;i<o;i++)Yi.x=this.getX(i),Yi.y=this.getY(i),Yi.z=this.getZ(i),Yi.transformDirection(e),this.setXYZ(i,Yi.x,Yi.y,Yi.z);return this}setX(e,i){return this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,i,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=i,this.data.array[e+1]=o,this}setXYZ(e,i,o,l){return e=e*this.data.stride+this.offset,this.data.array[e+0]=i,this.data.array[e+1]=o,this.data.array[e+2]=l,this}setXYZW(e,i,o,l,d){return e=e*this.data.stride+this.offset,this.data.array[e+0]=i,this.data.array[e+1]=o,this.data.array[e+2]=l,this.data.array[e+3]=d,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let o=0;o<this.count;o++){const l=o*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)i.push(this.data.array[l+d])}return new ti(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new il(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let o=0;o<this.count;o++){const l=o*this.data.stride+this.offset;for(let d=0;d<this.itemSize;d++)i.push(this.data.array[l+d])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}il.prototype.isInterleavedBufferAttribute=!0;class Bd extends Ti{constructor(e){super(),this.type="SpriteMaterial",this.color=new Or(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}Bd.prototype.isSpriteMaterial=!0;let lf;const mh=new dt,cf=new dt,ff=new dt,Ql=new We,vh=new We,tg=new jr,Ud=new dt,gh=new dt,zd=new dt,rg=new We,Np=new We,ng=new We;class Gd extends Gn{constructor(e){if(super(),this.type="Sprite",lf===void 0){lf=new An;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),o=new $l(i,5);lf.setIndex([0,1,2,0,2,3]),lf.setAttribute("position",new il(o,3,0,!1)),lf.setAttribute("uv",new il(o,2,3,!1))}this.geometry=lf,this.material=e!==void 0?e:new Bd,this.center=new We(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),cf.setFromMatrixScale(this.matrixWorld),tg.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ff.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&cf.multiplyScalar(-ff.z);const o=this.material.rotation;let l,d;o!==0&&(d=Math.cos(o),l=Math.sin(o));const w=this.center;yh(Ud.set(-.5,-.5,0),ff,w,cf,l,d),yh(gh.set(.5,-.5,0),ff,w,cf,l,d),yh(zd.set(.5,.5,0),ff,w,cf,l,d),rg.set(0,0),Np.set(1,0),ng.set(1,1);let I=e.ray.intersectTriangle(Ud,gh,zd,!1,mh);if(I===null&&(yh(gh.set(-.5,.5,0),ff,w,cf,l,d),Np.set(0,1),I=e.ray.intersectTriangle(Ud,zd,gh,!1,mh),I===null))return;const J=e.ray.origin.distanceTo(mh);J<e.near||J>e.far||i.push({distance:J,point:mh.clone(),uv:zi.getUV(mh,Ud,gh,zd,rg,Np,ng,new We),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}Gd.prototype.isSprite=!0;function yh(f,e,i,o,l,d){Ql.subVectors(f,i).addScalar(.5).multiply(o),l!==void 0?(vh.x=d*Ql.x-l*Ql.y,vh.y=l*Ql.x+d*Ql.y):vh.copy(Ql),f.copy(e),f.x+=vh.x,f.y+=vh.y,f.applyMatrix4(tg)}const Vd=new dt,ig=new dt;class Kl extends Gn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let o=0,l=i.length;o<l;o++){const d=i[o];this.addLevel(d.object.clone(),d.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0){i=Math.abs(i);const o=this.levels;let l;for(l=0;l<o.length&&!(i<o[l].distance);l++);return o.splice(l,0,{distance:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let o,l;for(o=1,l=i.length;o<l&&!(e<i[o].distance);o++);return i[o-1].object}return null}raycast(e,i){if(this.levels.length>0){Vd.setFromMatrixPosition(this.matrixWorld);const l=e.ray.origin.distanceTo(Vd);this.getObjectForDistance(l).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){Vd.setFromMatrixPosition(e.matrixWorld),ig.setFromMatrixPosition(this.matrixWorld);const o=Vd.distanceTo(ig)/e.zoom;i[0].object.visible=!0;let l,d;for(l=1,d=i.length;l<d&&o>=i[l].distance;l++)i[l-1].object.visible=!1,i[l].object.visible=!0;for(this._currentLevel=l-1;l<d;l++)i[l].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const o=this.levels;for(let l=0,d=o.length;l<d;l++){const w=o[l];i.object.levels.push({object:w.object.uuid,distance:w.distance})}return i}}const ag=new dt,sg=new cn,og=new cn,R1=new dt,ug=new jr;class hf extends ra{constructor(e,i){super(e,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new jr,this.bindMatrixInverse=new jr}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new cn,i=this.geometry.attributes.skinWeight;for(let o=0,l=i.count;o<l;o++){e.x=i.getX(o),e.y=i.getY(o),e.z=i.getZ(o),e.w=i.getW(o);const d=1/e.manhattanLength();d!==1/0?e.multiplyScalar(d):e.set(1,0,0,0),i.setXYZW(o,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,i){const o=this.skeleton,l=this.geometry;sg.fromBufferAttribute(l.attributes.skinIndex,e),og.fromBufferAttribute(l.attributes.skinWeight,e),ag.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let d=0;d<4;d++){const w=og.getComponent(d);if(w!==0){const I=sg.getComponent(d);ug.multiplyMatrices(o.bones[I].matrixWorld,o.boneInverses[I]),i.addScaledVector(R1.copy(ag).applyMatrix4(ug),w)}}return i.applyMatrix4(this.bindMatrixInverse)}}hf.prototype.isSkinnedMesh=!0;class ec extends Gn{constructor(){super(),this.type="Bone"}}ec.prototype.isBone=!0;class tc extends Cn{constructor(e=null,i=1,o=1,l,d,w,I,J,ee=oe,he=oe,fe,de){super(null,w,I,J,ee,he,l,d,fe,de),this.image={data:e,width:i,height:o},this.magFilter=ee,this.minFilter=he,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}tc.prototype.isDataTexture=!0;const lg=new jr,C1=new jr;class _h{constructor(e=[],i=[]){this.uuid=os(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let o=0,l=this.bones.length;o<l;o++)this.boneInverses.push(new jr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const o=new jr;this.bones[e]&&o.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(o)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const o=this.bones[e];o&&o.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const o=this.bones[e];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}}update(){const e=this.bones,i=this.boneInverses,o=this.boneMatrices,l=this.boneTexture;for(let d=0,w=e.length;d<w;d++){const I=e[d]?e[d].matrixWorld:C1;lg.multiplyMatrices(I,i[d]),lg.toArray(o,d*16)}l!==null&&(l.needsUpdate=!0)}clone(){return new _h(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=yt(e),e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const o=new tc(i,e,e,xn,dr);return o.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=o,this.boneTextureSize=e,this}getBoneByName(e){for(let i=0,o=this.bones.length;i<o;i++){const l=this.bones[i];if(l.name===e)return l}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let o=0,l=e.bones.length;o<l;o++){const d=e.bones[o];let w=i[d];w===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",d),w=new ec),this.bones.push(w),this.boneInverses.push(new jr().fromArray(e.boneInverses[o]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,o=this.boneInverses;for(let l=0,d=i.length;l<d;l++){const w=i[l];e.bones.push(w.uuid);const I=o[l];e.boneInverses.push(I.toArray())}return e}}class rc extends ti{constructor(e,i,o,l=1){typeof o=="number"&&(l=o,o=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,i,o),this.meshPerAttribute=l}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}rc.prototype.isInstancedBufferAttribute=!0;const cg=new jr,fg=new jr,Wd=[],xh=new ra;class Bp extends ra{constructor(e,i,o){super(e,i),this.instanceMatrix=new rc(new Float32Array(o*16),16),this.instanceColor=null,this.count=o,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}raycast(e,i){const o=this.matrixWorld,l=this.count;if(xh.geometry=this.geometry,xh.material=this.material,xh.material!==void 0)for(let d=0;d<l;d++){this.getMatrixAt(d,cg),fg.multiplyMatrices(o,cg),xh.matrixWorld=fg,xh.raycast(e,Wd);for(let w=0,I=Wd.length;w<I;w++){const J=Wd[w];J.instanceId=d,J.object=this,i.push(J)}Wd.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new rc(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Bp.prototype.isInstancedMesh=!0;class Ji extends Ti{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Or(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}Ji.prototype.isLineBasicMaterial=!0;const nc=new dt,ic=new dt,hg=new jr,Up=new Co,df=new mu;class jo extends Gn{constructor(e=new An,i=new Ji){super(),this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const i=e.attributes.position,o=[0];for(let l=1,d=i.count;l<d;l++)nc.fromBufferAttribute(i,l-1),ic.fromBufferAttribute(i,l),o[l]=o[l-1],o[l]+=nc.distanceTo(ic);e.setAttribute("lineDistance",new Qr(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,i){const o=this.geometry,l=this.matrixWorld,d=e.params.Line.threshold,w=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),df.copy(o.boundingSphere),df.applyMatrix4(l),df.radius+=d,e.ray.intersectsSphere(df)===!1)return;hg.copy(l).invert(),Up.copy(e.ray).applyMatrix4(hg);const I=d/((this.scale.x+this.scale.y+this.scale.z)/3),J=I*I,ee=new dt,he=new dt,fe=new dt,de=new dt,ve=this.isLineSegments?2:1;if(o.isBufferGeometry){const Ce=o.index,Ke=o.attributes.position;if(Ce!==null){const Oe=Math.max(0,w.start),xe=Math.min(Ce.count,w.start+w.count);for(let ut=Oe,rt=xe-1;ut<rt;ut+=ve){const ft=Ce.getX(ut),Mt=Ce.getX(ut+1);if(ee.fromBufferAttribute(Ke,ft),he.fromBufferAttribute(Ke,Mt),Up.distanceSqToSegment(ee,he,de,fe)>J)continue;de.applyMatrix4(this.matrixWorld);const kt=e.ray.origin.distanceTo(de);kt<e.near||kt>e.far||i.push({distance:kt,point:fe.clone().applyMatrix4(this.matrixWorld),index:ut,face:null,faceIndex:null,object:this})}}else{const Oe=Math.max(0,w.start),xe=Math.min(Ke.count,w.start+w.count);for(let ut=Oe,rt=xe-1;ut<rt;ut+=ve){if(ee.fromBufferAttribute(Ke,ut),he.fromBufferAttribute(Ke,ut+1),Up.distanceSqToSegment(ee,he,de,fe)>J)continue;de.applyMatrix4(this.matrixWorld);const Mt=e.ray.origin.distanceTo(de);Mt<e.near||Mt>e.far||i.push({distance:Mt,point:fe.clone().applyMatrix4(this.matrixWorld),index:ut,face:null,faceIndex:null,object:this})}}}else o.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const i=e.morphAttributes,o=Object.keys(i);if(o.length>0){const l=i[o[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,w=l.length;d<w;d++){const I=l[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[I]=d}}}}else{const i=e.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}jo.prototype.isLine=!0;const dg=new dt,Ah=new dt;class Ts extends jo{constructor(e,i){super(e,i),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(e.index===null){const i=e.attributes.position,o=[];for(let l=0,d=i.count;l<d;l+=2)dg.fromBufferAttribute(i,l),Ah.fromBufferAttribute(i,l+1),o[l]=l===0?0:o[l-1],o[l+1]=o[l]+dg.distanceTo(Ah);e.setAttribute("lineDistance",new Qr(o,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Ts.prototype.isLineSegments=!0;class zp extends jo{constructor(e,i){super(e,i),this.type="LineLoop"}}zp.prototype.isLineLoop=!0;class ac extends Ti{constructor(e){super(),this.type="PointsMaterial",this.color=new Or(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}ac.prototype.isPointsMaterial=!0;const pg=new jr,Gp=new Co,Hd=new mu,qd=new dt;class wh extends Gn{constructor(e=new An,i=new ac){super(),this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,i){const o=this.geometry,l=this.matrixWorld,d=e.params.Points.threshold,w=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),Hd.copy(o.boundingSphere),Hd.applyMatrix4(l),Hd.radius+=d,e.ray.intersectsSphere(Hd)===!1)return;pg.copy(l).invert(),Gp.copy(e.ray).applyMatrix4(pg);const I=d/((this.scale.x+this.scale.y+this.scale.z)/3),J=I*I;if(o.isBufferGeometry){const ee=o.index,fe=o.attributes.position;if(ee!==null){const de=Math.max(0,w.start),ve=Math.min(ee.count,w.start+w.count);for(let Ce=de,Ne=ve;Ce<Ne;Ce++){const Ke=ee.getX(Ce);qd.fromBufferAttribute(fe,Ke),Vp(qd,Ke,J,l,e,i,this)}}else{const de=Math.max(0,w.start),ve=Math.min(fe.count,w.start+w.count);for(let Ce=de,Ne=ve;Ce<Ne;Ce++)qd.fromBufferAttribute(fe,Ce),Vp(qd,Ce,J,l,e,i,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const i=e.morphAttributes,o=Object.keys(i);if(o.length>0){const l=i[o[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let d=0,w=l.length;d<w;d++){const I=l[d].name||String(d);this.morphTargetInfluences.push(0),this.morphTargetDictionary[I]=d}}}}else{const i=e.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}wh.prototype.isPoints=!0;function Vp(f,e,i,o,l,d,w){const I=Gp.distanceSqToPoint(f);if(I<i){const J=new dt;Gp.closestPointToPoint(f,J),J.applyMatrix4(o);const ee=l.ray.origin.distanceTo(J);if(ee<l.near||ee>l.far)return;d.push({distance:ee,distanceToRay:Math.sqrt(I),point:J,index:e,face:null,object:w})}}class mg extends Cn{constructor(e,i,o,l,d,w,I,J,ee){super(e,i,o,l,d,w,I,J,ee),this.minFilter=w!==void 0?w:at,this.magFilter=d!==void 0?d:at,this.generateMipmaps=!1;const he=this;function fe(){he.needsUpdate=!0,e.requestVideoFrameCallback(fe)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(fe)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}mg.prototype.isVideoTexture=!0;class vg extends Cn{constructor(e,i,o){super({width:e,height:i}),this.format=o,this.magFilter=oe,this.minFilter=oe,this.generateMipmaps=!1,this.needsUpdate=!0}}vg.prototype.isFramebufferTexture=!0;class Wp extends Cn{constructor(e,i,o,l,d,w,I,J,ee,he,fe,de){super(null,w,I,J,ee,he,l,d,fe,de),this.image={width:i,height:o},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Wp.prototype.isCompressedTexture=!0;class gg extends Cn{constructor(e,i,o,l,d,w,I,J,ee){super(e,i,o,l,d,w,I,J,ee),this.needsUpdate=!0}}gg.prototype.isCanvasTexture=!0;class pf extends An{constructor(e=1,i=8,o=0,l=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:o,thetaLength:l},i=Math.max(3,i);const d=[],w=[],I=[],J=[],ee=new dt,he=new We;w.push(0,0,0),I.push(0,0,1),J.push(.5,.5);for(let fe=0,de=3;fe<=i;fe++,de+=3){const ve=o+fe/i*l;ee.x=e*Math.cos(ve),ee.y=e*Math.sin(ve),w.push(ee.x,ee.y,ee.z),I.push(0,0,1),he.x=(w[de]/e+1)/2,he.y=(w[de+1]/e+1)/2,J.push(he.x,he.y)}for(let fe=1;fe<=i;fe++)d.push(fe,fe+1,0);this.setIndex(d),this.setAttribute("position",new Qr(w,3)),this.setAttribute("normal",new Qr(I,3)),this.setAttribute("uv",new Qr(J,2))}static fromJSON(e){return new pf(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class al extends An{constructor(e=1,i=1,o=1,l=8,d=1,w=!1,I=0,J=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:o,radialSegments:l,heightSegments:d,openEnded:w,thetaStart:I,thetaLength:J};const ee=this;l=Math.floor(l),d=Math.floor(d);const he=[],fe=[],de=[],ve=[];let Ce=0;const Ne=[],Ke=o/2;let Oe=0;xe(),w===!1&&(e>0&&ut(!0),i>0&&ut(!1)),this.setIndex(he),this.setAttribute("position",new Qr(fe,3)),this.setAttribute("normal",new Qr(de,3)),this.setAttribute("uv",new Qr(ve,2));function xe(){const rt=new dt,ft=new dt;let Mt=0;const Rt=(i-e)/o;for(let kt=0;kt<=d;kt++){const nr=[],Xt=kt/d,it=Xt*(i-e)+e;for(let Pt=0;Pt<=l;Pt++){const Vt=Pt/l,Zt=Vt*J+I,Jt=Math.sin(Zt),jt=Math.cos(Zt);ft.x=it*Jt,ft.y=-Xt*o+Ke,ft.z=it*jt,fe.push(ft.x,ft.y,ft.z),rt.set(Jt,Rt,jt).normalize(),de.push(rt.x,rt.y,rt.z),ve.push(Vt,1-Xt),nr.push(Ce++)}Ne.push(nr)}for(let kt=0;kt<l;kt++)for(let nr=0;nr<d;nr++){const Xt=Ne[nr][kt],it=Ne[nr+1][kt],Pt=Ne[nr+1][kt+1],Vt=Ne[nr][kt+1];he.push(Xt,it,Vt),he.push(it,Pt,Vt),Mt+=6}ee.addGroup(Oe,Mt,0),Oe+=Mt}function ut(rt){const ft=Ce,Mt=new We,Rt=new dt;let kt=0;const nr=rt===!0?e:i,Xt=rt===!0?1:-1;for(let Pt=1;Pt<=l;Pt++)fe.push(0,Ke*Xt,0),de.push(0,Xt,0),ve.push(.5,.5),Ce++;const it=Ce;for(let Pt=0;Pt<=l;Pt++){const Zt=Pt/l*J+I,Jt=Math.cos(Zt),jt=Math.sin(Zt);Rt.x=nr*jt,Rt.y=Ke*Xt,Rt.z=nr*Jt,fe.push(Rt.x,Rt.y,Rt.z),de.push(0,Xt,0),Mt.x=Jt*.5+.5,Mt.y=jt*.5*Xt+.5,ve.push(Mt.x,Mt.y),Ce++}for(let Pt=0;Pt<l;Pt++){const Vt=ft+Pt,Zt=it+Pt;rt===!0?he.push(Zt,Zt+1,Vt):he.push(Zt+1,Zt,Vt),kt+=3}ee.addGroup(Oe,kt,rt===!0?1:2),Oe+=kt}}static fromJSON(e){return new al(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mf extends al{constructor(e=1,i=1,o=8,l=1,d=!1,w=0,I=Math.PI*2){super(0,e,i,o,l,d,w,I),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:o,heightSegments:l,openEnded:d,thetaStart:w,thetaLength:I}}static fromJSON(e){return new mf(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Yo extends An{constructor(e=[],i=[],o=1,l=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:o,detail:l};const d=[],w=[];I(l),ee(o),he(),this.setAttribute("position",new Qr(d,3)),this.setAttribute("normal",new Qr(d.slice(),3)),this.setAttribute("uv",new Qr(w,2)),l===0?this.computeVertexNormals():this.normalizeNormals();function I(xe){const ut=new dt,rt=new dt,ft=new dt;for(let Mt=0;Mt<i.length;Mt+=3)ve(i[Mt+0],ut),ve(i[Mt+1],rt),ve(i[Mt+2],ft),J(ut,rt,ft,xe)}function J(xe,ut,rt,ft){const Mt=ft+1,Rt=[];for(let kt=0;kt<=Mt;kt++){Rt[kt]=[];const nr=xe.clone().lerp(rt,kt/Mt),Xt=ut.clone().lerp(rt,kt/Mt),it=Mt-kt;for(let Pt=0;Pt<=it;Pt++)Pt===0&&kt===Mt?Rt[kt][Pt]=nr:Rt[kt][Pt]=nr.clone().lerp(Xt,Pt/it)}for(let kt=0;kt<Mt;kt++)for(let nr=0;nr<2*(Mt-kt)-1;nr++){const Xt=Math.floor(nr/2);nr%2===0?(de(Rt[kt][Xt+1]),de(Rt[kt+1][Xt]),de(Rt[kt][Xt])):(de(Rt[kt][Xt+1]),de(Rt[kt+1][Xt+1]),de(Rt[kt+1][Xt]))}}function ee(xe){const ut=new dt;for(let rt=0;rt<d.length;rt+=3)ut.x=d[rt+0],ut.y=d[rt+1],ut.z=d[rt+2],ut.normalize().multiplyScalar(xe),d[rt+0]=ut.x,d[rt+1]=ut.y,d[rt+2]=ut.z}function he(){const xe=new dt;for(let ut=0;ut<d.length;ut+=3){xe.x=d[ut+0],xe.y=d[ut+1],xe.z=d[ut+2];const rt=Ke(xe)/2/Math.PI+.5,ft=Oe(xe)/Math.PI+.5;w.push(rt,1-ft)}Ce(),fe()}function fe(){for(let xe=0;xe<w.length;xe+=6){const ut=w[xe+0],rt=w[xe+2],ft=w[xe+4],Mt=Math.max(ut,rt,ft),Rt=Math.min(ut,rt,ft);Mt>.9&&Rt<.1&&(ut<.2&&(w[xe+0]+=1),rt<.2&&(w[xe+2]+=1),ft<.2&&(w[xe+4]+=1))}}function de(xe){d.push(xe.x,xe.y,xe.z)}function ve(xe,ut){const rt=xe*3;ut.x=e[rt+0],ut.y=e[rt+1],ut.z=e[rt+2]}function Ce(){const xe=new dt,ut=new dt,rt=new dt,ft=new dt,Mt=new We,Rt=new We,kt=new We;for(let nr=0,Xt=0;nr<d.length;nr+=9,Xt+=6){xe.set(d[nr+0],d[nr+1],d[nr+2]),ut.set(d[nr+3],d[nr+4],d[nr+5]),rt.set(d[nr+6],d[nr+7],d[nr+8]),Mt.set(w[Xt+0],w[Xt+1]),Rt.set(w[Xt+2],w[Xt+3]),kt.set(w[Xt+4],w[Xt+5]),ft.copy(xe).add(ut).add(rt).divideScalar(3);const it=Ke(ft);Ne(Mt,Xt+0,xe,it),Ne(Rt,Xt+2,ut,it),Ne(kt,Xt+4,rt,it)}}function Ne(xe,ut,rt,ft){ft<0&&xe.x===1&&(w[ut]=xe.x-1),rt.x===0&&rt.z===0&&(w[ut]=ft/2/Math.PI+.5)}function Ke(xe){return Math.atan2(xe.z,-xe.x)}function Oe(xe){return Math.atan2(-xe.y,Math.sqrt(xe.x*xe.x+xe.z*xe.z))}}static fromJSON(e){return new Yo(e.vertices,e.indices,e.radius,e.details)}}class vf extends Yo{constructor(e=1,i=0){const o=(1+Math.sqrt(5))/2,l=1/o,d=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-l,-o,0,-l,o,0,l,-o,0,l,o,-l,-o,0,-l,o,0,l,-o,0,l,o,0,-o,0,-l,o,0,-l,-o,0,l,o,0,l],w=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(d,w,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new vf(e.radius,e.detail)}}const Xd=new dt,Zd=new dt,Hp=new dt,jd=new zi;class qp extends An{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const l=Math.pow(10,4),d=Math.cos(ja*i),w=e.getIndex(),I=e.getAttribute("position"),J=w?w.count:I.count,ee=[0,0,0],he=["a","b","c"],fe=new Array(3),de={},ve=[];for(let Ce=0;Ce<J;Ce+=3){w?(ee[0]=w.getX(Ce),ee[1]=w.getX(Ce+1),ee[2]=w.getX(Ce+2)):(ee[0]=Ce,ee[1]=Ce+1,ee[2]=Ce+2);const{a:Ne,b:Ke,c:Oe}=jd;if(Ne.fromBufferAttribute(I,ee[0]),Ke.fromBufferAttribute(I,ee[1]),Oe.fromBufferAttribute(I,ee[2]),jd.getNormal(Hp),fe[0]=`${Math.round(Ne.x*l)},${Math.round(Ne.y*l)},${Math.round(Ne.z*l)}`,fe[1]=`${Math.round(Ke.x*l)},${Math.round(Ke.y*l)},${Math.round(Ke.z*l)}`,fe[2]=`${Math.round(Oe.x*l)},${Math.round(Oe.y*l)},${Math.round(Oe.z*l)}`,!(fe[0]===fe[1]||fe[1]===fe[2]||fe[2]===fe[0]))for(let xe=0;xe<3;xe++){const ut=(xe+1)%3,rt=fe[xe],ft=fe[ut],Mt=jd[he[xe]],Rt=jd[he[ut]],kt=`${rt}_${ft}`,nr=`${ft}_${rt}`;nr in de&&de[nr]?(Hp.dot(de[nr].normal)<=d&&(ve.push(Mt.x,Mt.y,Mt.z),ve.push(Rt.x,Rt.y,Rt.z)),de[nr]=null):kt in de||(de[kt]={index0:ee[xe],index1:ee[ut],normal:Hp.clone()})}}for(const Ce in de)if(de[Ce]){const{index0:Ne,index1:Ke}=de[Ce];Xd.fromBufferAttribute(I,Ne),Zd.fromBufferAttribute(I,Ke),ve.push(Xd.x,Xd.y,Xd.z),ve.push(Zd.x,Zd.y,Zd.z)}this.setAttribute("position",new Qr(ve,3))}}}class Is{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const o=this.getUtoTmapping(e);return this.getPoint(o,i)}getPoints(e=5){const i=[];for(let o=0;o<=e;o++)i.push(this.getPoint(o/e));return i}getSpacedPoints(e=5){const i=[];for(let o=0;o<=e;o++)i.push(this.getPointAt(o/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let o,l=this.getPoint(0),d=0;i.push(0);for(let w=1;w<=e;w++)o=this.getPoint(w/e),d+=o.distanceTo(l),i.push(d),l=o;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const o=this.getLengths();let l=0;const d=o.length;let w;i?w=i:w=e*o[d-1];let I=0,J=d-1,ee;for(;I<=J;)if(l=Math.floor(I+(J-I)/2),ee=o[l]-w,ee<0)I=l+1;else if(ee>0)J=l-1;else{J=l;break}if(l=J,o[l]===w)return l/(d-1);const he=o[l],de=o[l+1]-he,ve=(w-he)/de;return(l+ve)/(d-1)}getTangent(e,i){let l=e-1e-4,d=e+1e-4;l<0&&(l=0),d>1&&(d=1);const w=this.getPoint(l),I=this.getPoint(d),J=i||(w.isVector2?new We:new dt);return J.copy(I).sub(w).normalize(),J}getTangentAt(e,i){const o=this.getUtoTmapping(e);return this.getTangent(o,i)}computeFrenetFrames(e,i){const o=new dt,l=[],d=[],w=[],I=new dt,J=new jr;for(let ve=0;ve<=e;ve++){const Ce=ve/e;l[ve]=this.getTangentAt(Ce,new dt)}d[0]=new dt,w[0]=new dt;let ee=Number.MAX_VALUE;const he=Math.abs(l[0].x),fe=Math.abs(l[0].y),de=Math.abs(l[0].z);he<=ee&&(ee=he,o.set(1,0,0)),fe<=ee&&(ee=fe,o.set(0,1,0)),de<=ee&&o.set(0,0,1),I.crossVectors(l[0],o).normalize(),d[0].crossVectors(l[0],I),w[0].crossVectors(l[0],d[0]);for(let ve=1;ve<=e;ve++){if(d[ve]=d[ve-1].clone(),w[ve]=w[ve-1].clone(),I.crossVectors(l[ve-1],l[ve]),I.length()>Number.EPSILON){I.normalize();const Ce=Math.acos(un(l[ve-1].dot(l[ve]),-1,1));d[ve].applyMatrix4(J.makeRotationAxis(I,Ce))}w[ve].crossVectors(l[ve],d[ve])}if(i===!0){let ve=Math.acos(un(d[0].dot(d[e]),-1,1));ve/=e,l[0].dot(I.crossVectors(d[0],d[e]))>0&&(ve=-ve);for(let Ce=1;Ce<=e;Ce++)d[Ce].applyMatrix4(J.makeRotationAxis(l[Ce],ve*Ce)),w[Ce].crossVectors(l[Ce],d[Ce])}return{tangents:l,normals:d,binormals:w}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Mh extends Is{constructor(e=0,i=0,o=1,l=1,d=0,w=Math.PI*2,I=!1,J=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=o,this.yRadius=l,this.aStartAngle=d,this.aEndAngle=w,this.aClockwise=I,this.aRotation=J}getPoint(e,i){const o=i||new We,l=Math.PI*2;let d=this.aEndAngle-this.aStartAngle;const w=Math.abs(d)<Number.EPSILON;for(;d<0;)d+=l;for(;d>l;)d-=l;d<Number.EPSILON&&(w?d=0:d=l),this.aClockwise===!0&&!w&&(d===l?d=-l:d=d-l);const I=this.aStartAngle+e*d;let J=this.aX+this.xRadius*Math.cos(I),ee=this.aY+this.yRadius*Math.sin(I);if(this.aRotation!==0){const he=Math.cos(this.aRotation),fe=Math.sin(this.aRotation),de=J-this.aX,ve=ee-this.aY;J=de*he-ve*fe+this.aX,ee=de*fe+ve*he+this.aY}return o.set(J,ee)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Mh.prototype.isEllipseCurve=!0;class Yd extends Mh{constructor(e,i,o,l,d,w){super(e,i,o,o,l,d,w),this.type="ArcCurve"}}Yd.prototype.isArcCurve=!0;function Xp(){let f=0,e=0,i=0,o=0;function l(d,w,I,J){f=d,e=I,i=-3*d+3*w-2*I-J,o=2*d-2*w+I+J}return{initCatmullRom:function(d,w,I,J,ee){l(w,I,ee*(I-d),ee*(J-w))},initNonuniformCatmullRom:function(d,w,I,J,ee,he,fe){let de=(w-d)/ee-(I-d)/(ee+he)+(I-w)/he,ve=(I-w)/he-(J-w)/(he+fe)+(J-I)/fe;de*=he,ve*=he,l(w,I,de,ve)},calc:function(d){const w=d*d,I=w*d;return f+e*d+i*w+o*I}}}const Jd=new dt,Zp=new Xp,jp=new Xp,Yp=new Xp;class Jp extends Is{constructor(e=[],i=!1,o="centripetal",l=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=o,this.tension=l}getPoint(e,i=new dt){const o=i,l=this.points,d=l.length,w=(d-(this.closed?0:1))*e;let I=Math.floor(w),J=w-I;this.closed?I+=I>0?0:(Math.floor(Math.abs(I)/d)+1)*d:J===0&&I===d-1&&(I=d-2,J=1);let ee,he;this.closed||I>0?ee=l[(I-1)%d]:(Jd.subVectors(l[0],l[1]).add(l[0]),ee=Jd);const fe=l[I%d],de=l[(I+1)%d];if(this.closed||I+2<d?he=l[(I+2)%d]:(Jd.subVectors(l[d-1],l[d-2]).add(l[d-1]),he=Jd),this.curveType==="centripetal"||this.curveType==="chordal"){const ve=this.curveType==="chordal"?.5:.25;let Ce=Math.pow(ee.distanceToSquared(fe),ve),Ne=Math.pow(fe.distanceToSquared(de),ve),Ke=Math.pow(de.distanceToSquared(he),ve);Ne<1e-4&&(Ne=1),Ce<1e-4&&(Ce=Ne),Ke<1e-4&&(Ke=Ne),Zp.initNonuniformCatmullRom(ee.x,fe.x,de.x,he.x,Ce,Ne,Ke),jp.initNonuniformCatmullRom(ee.y,fe.y,de.y,he.y,Ce,Ne,Ke),Yp.initNonuniformCatmullRom(ee.z,fe.z,de.z,he.z,Ce,Ne,Ke)}else this.curveType==="catmullrom"&&(Zp.initCatmullRom(ee.x,fe.x,de.x,he.x,this.tension),jp.initCatmullRom(ee.y,fe.y,de.y,he.y,this.tension),Yp.initCatmullRom(ee.z,fe.z,de.z,he.z,this.tension));return o.set(Zp.calc(J),jp.calc(J),Yp.calc(J)),o}copy(e){super.copy(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const l=e.points[i];this.points.push(l.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,o=this.points.length;i<o;i++){const l=this.points[i];e.points.push(l.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const l=e.points[i];this.points.push(new dt().fromArray(l))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}Jp.prototype.isCatmullRomCurve3=!0;function yg(f,e,i,o,l){const d=(o-e)*.5,w=(l-i)*.5,I=f*f,J=f*I;return(2*i-2*o+d+w)*J+(-3*i+3*o-2*d-w)*I+d*f+i}function P1(f,e){const i=1-f;return i*i*e}function L1(f,e){return 2*(1-f)*f*e}function O1(f,e){return f*f*e}function bh(f,e,i,o){return P1(f,e)+L1(f,i)+O1(f,o)}function F1(f,e){const i=1-f;return i*i*i*e}function I1(f,e){const i=1-f;return 3*i*i*f*e}function k1(f,e){return 3*(1-f)*f*f*e}function D1(f,e){return f*f*f*e}function Eh(f,e,i,o,l){return F1(f,e)+I1(f,i)+k1(f,o)+D1(f,l)}class Th extends Is{constructor(e=new We,i=new We,o=new We,l=new We){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=o,this.v3=l}getPoint(e,i=new We){const o=i,l=this.v0,d=this.v1,w=this.v2,I=this.v3;return o.set(Eh(e,l.x,d.x,w.x,I.x),Eh(e,l.y,d.y,w.y,I.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Th.prototype.isCubicBezierCurve=!0;class $p extends Is{constructor(e=new dt,i=new dt,o=new dt,l=new dt){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=o,this.v3=l}getPoint(e,i=new dt){const o=i,l=this.v0,d=this.v1,w=this.v2,I=this.v3;return o.set(Eh(e,l.x,d.x,w.x,I.x),Eh(e,l.y,d.y,w.y,I.y),Eh(e,l.z,d.z,w.z,I.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}$p.prototype.isCubicBezierCurve3=!0;class Sh extends Is{constructor(e=new We,i=new We){super(),this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new We){const o=i;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i){const o=i||new We;return o.copy(this.v2).sub(this.v1).normalize(),o}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Sh.prototype.isLineCurve=!0;class _g extends Is{constructor(e=new dt,i=new dt){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=i}getPoint(e,i=new dt){const o=i;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,i){return this.getPoint(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class $d extends Is{constructor(e=new We,i=new We,o=new We){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=o}getPoint(e,i=new We){const o=i,l=this.v0,d=this.v1,w=this.v2;return o.set(bh(e,l.x,d.x,w.x),bh(e,l.y,d.y,w.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}$d.prototype.isQuadraticBezierCurve=!0;class Qd extends Is{constructor(e=new dt,i=new dt,o=new dt){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=o}getPoint(e,i=new dt){const o=i,l=this.v0,d=this.v1,w=this.v2;return o.set(bh(e,l.x,d.x,w.x),bh(e,l.y,d.y,w.y),bh(e,l.z,d.z,w.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Qd.prototype.isQuadraticBezierCurve3=!0;class Kd extends Is{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,i=new We){const o=i,l=this.points,d=(l.length-1)*e,w=Math.floor(d),I=d-w,J=l[w===0?w:w-1],ee=l[w],he=l[w>l.length-2?l.length-1:w+1],fe=l[w>l.length-3?l.length-1:w+2];return o.set(yg(I,J.x,ee.x,he.x,fe.x),yg(I,J.y,ee.y,he.y,fe.y)),o}copy(e){super.copy(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const l=e.points[i];this.points.push(l.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,o=this.points.length;i<o;i++){const l=this.points[i];e.points.push(l.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const l=e.points[i];this.points.push(new We().fromArray(l))}return this}}Kd.prototype.isSplineCurve=!0;var Qp=Object.freeze({__proto__:null,ArcCurve:Yd,CatmullRomCurve3:Jp,CubicBezierCurve:Th,CubicBezierCurve3:$p,EllipseCurve:Mh,LineCurve:Sh,LineCurve3:_g,QuadraticBezierCurve:$d,QuadraticBezierCurve3:Qd,SplineCurve:Kd});class xg extends Is{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);e.equals(i)||this.curves.push(new Sh(i,e))}getPoint(e,i){const o=e*this.getLength(),l=this.getCurveLengths();let d=0;for(;d<l.length;){if(l[d]>=o){const w=l[d]-o,I=this.curves[d],J=I.getLength(),ee=J===0?0:1-w/J;return I.getPointAt(ee,i)}d++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let o=0,l=this.curves.length;o<l;o++)i+=this.curves[o].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let o=0;o<=e;o++)i.push(this.getPoint(o/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let o;for(let l=0,d=this.curves;l<d.length;l++){const w=d[l],I=w&&w.isEllipseCurve?e*2:w&&(w.isLineCurve||w.isLineCurve3)?1:w&&w.isSplineCurve?e*w.points.length:e,J=w.getPoints(I);for(let ee=0;ee<J.length;ee++){const he=J[ee];o&&o.equals(he)||(i.push(he),o=he)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,o=e.curves.length;i<o;i++){const l=e.curves[i];this.curves.push(l.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,o=this.curves.length;i<o;i++){const l=this.curves[i];e.curves.push(l.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,o=e.curves.length;i<o;i++){const l=e.curves[i];this.curves.push(new Qp[l.type]().fromJSON(l))}return this}}class Rh extends xg{constructor(e){super(),this.type="Path",this.currentPoint=new We,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,o=e.length;i<o;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const o=new Sh(this.currentPoint.clone(),new We(e,i));return this.curves.push(o),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,o,l){const d=new $d(this.currentPoint.clone(),new We(e,i),new We(o,l));return this.curves.push(d),this.currentPoint.set(o,l),this}bezierCurveTo(e,i,o,l,d,w){const I=new Th(this.currentPoint.clone(),new We(e,i),new We(o,l),new We(d,w));return this.curves.push(I),this.currentPoint.set(d,w),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),o=new Kd(i);return this.curves.push(o),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,o,l,d,w){const I=this.currentPoint.x,J=this.currentPoint.y;return this.absarc(e+I,i+J,o,l,d,w),this}absarc(e,i,o,l,d,w){return this.absellipse(e,i,o,o,l,d,w),this}ellipse(e,i,o,l,d,w,I,J){const ee=this.currentPoint.x,he=this.currentPoint.y;return this.absellipse(e+ee,i+he,o,l,d,w,I,J),this}absellipse(e,i,o,l,d,w,I,J){const ee=new Mh(e,i,o,l,d,w,I,J);if(this.curves.length>0){const fe=ee.getPoint(0);fe.equals(this.currentPoint)||this.lineTo(fe.x,fe.y)}this.curves.push(ee);const he=ee.getPoint(1);return this.currentPoint.copy(he),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Jo extends Rh{constructor(e){super(e),this.uuid=os(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let o=0,l=this.holes.length;o<l;o++)i[o]=this.holes[o].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,o=e.holes.length;i<o;i++){const l=e.holes[i];this.holes.push(l.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,o=this.holes.length;i<o;i++){const l=this.holes[i];e.holes.push(l.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,o=e.holes.length;i<o;i++){const l=e.holes[i];this.holes.push(new Rh().fromJSON(l))}return this}}const N1={triangulate:function(f,e,i=2){const o=e&&e.length,l=o?e[0]*i:f.length;let d=Ag(f,0,l,i,!0);const w=[];if(!d||d.next===d.prev)return w;let I,J,ee,he,fe,de,ve;if(o&&(d=wg(f,e,d,i)),f.length>80*i){I=ee=f[0],J=he=f[1];for(let Ce=i;Ce<l;Ce+=i)fe=f[Ce],de=f[Ce+1],fe<I&&(I=fe),de<J&&(J=de),fe>ee&&(ee=fe),de>he&&(he=de);ve=Math.max(ee-I,he-J),ve=ve!==0?1/ve:0}return Ch(d,w,i,I,J,ve),w}};function Ag(f,e,i,o,l){let d,w;if(l===Q1(f,e,i,o)>0)for(d=e;d<i;d+=o)w=Eg(d,f[d],f[d+1],w);else for(d=i-o;d>=e;d-=o)w=Eg(d,f[d],f[d+1],w);return w&&e0(w,w.next)&&(Oh(w),w=w.next),w}function sl(f,e){if(!f)return f;e||(e=f);let i=f,o;do if(o=!1,!i.steiner&&(e0(i,i.next)||$i(i.prev,i,i.next)===0)){if(Oh(i),i=e=i.prev,i===i.next)break;o=!0}else i=i.next;while(o||i!==e);return e}function Ch(f,e,i,o,l,d,w){if(!f)return;!w&&d&&X1(f,o,l,d);let I=f,J,ee;for(;f.prev!==f.next;){if(J=f.prev,ee=f.next,d?U1(f,o,l,d):B1(f)){e.push(J.i/i),e.push(f.i/i),e.push(ee.i/i),Oh(f),f=ee.next,I=ee.next;continue}if(f=ee,f===I){w?w===1?(f=z1(sl(f),e,i),Ch(f,e,i,o,l,d,2)):w===2&&G1(f,e,i,o,l,d):Ch(sl(f),e,i,o,l,d,1);break}}}function B1(f){const e=f.prev,i=f,o=f.next;if($i(e,i,o)>=0)return!1;let l=f.next.next;for(;l!==f.prev;){if(gf(e.x,e.y,i.x,i.y,o.x,o.y,l.x,l.y)&&$i(l.prev,l,l.next)>=0)return!1;l=l.next}return!0}function U1(f,e,i,o){const l=f.prev,d=f,w=f.next;if($i(l,d,w)>=0)return!1;const I=l.x<d.x?l.x<w.x?l.x:w.x:d.x<w.x?d.x:w.x,J=l.y<d.y?l.y<w.y?l.y:w.y:d.y<w.y?d.y:w.y,ee=l.x>d.x?l.x>w.x?l.x:w.x:d.x>w.x?d.x:w.x,he=l.y>d.y?l.y>w.y?l.y:w.y:d.y>w.y?d.y:w.y,fe=Kp(I,J,e,i,o),de=Kp(ee,he,e,i,o);let ve=f.prevZ,Ce=f.nextZ;for(;ve&&ve.z>=fe&&Ce&&Ce.z<=de;){if(ve!==f.prev&&ve!==f.next&&gf(l.x,l.y,d.x,d.y,w.x,w.y,ve.x,ve.y)&&$i(ve.prev,ve,ve.next)>=0||(ve=ve.prevZ,Ce!==f.prev&&Ce!==f.next&&gf(l.x,l.y,d.x,d.y,w.x,w.y,Ce.x,Ce.y)&&$i(Ce.prev,Ce,Ce.next)>=0))return!1;Ce=Ce.nextZ}for(;ve&&ve.z>=fe;){if(ve!==f.prev&&ve!==f.next&&gf(l.x,l.y,d.x,d.y,w.x,w.y,ve.x,ve.y)&&$i(ve.prev,ve,ve.next)>=0)return!1;ve=ve.prevZ}for(;Ce&&Ce.z<=de;){if(Ce!==f.prev&&Ce!==f.next&&gf(l.x,l.y,d.x,d.y,w.x,w.y,Ce.x,Ce.y)&&$i(Ce.prev,Ce,Ce.next)>=0)return!1;Ce=Ce.nextZ}return!0}function z1(f,e,i){let o=f;do{const l=o.prev,d=o.next.next;!e0(l,d)&&Mg(l,o,o.next,d)&&Lh(l,d)&&Lh(d,l)&&(e.push(l.i/i),e.push(o.i/i),e.push(d.i/i),Oh(o),Oh(o.next),o=f=d),o=o.next}while(o!==f);return sl(o)}function G1(f,e,i,o,l,d){let w=f;do{let I=w.next.next;for(;I!==w.prev;){if(w.i!==I.i&&Y1(w,I)){let J=bg(w,I);w=sl(w,w.next),J=sl(J,J.next),Ch(w,e,i,o,l,d),Ch(J,e,i,o,l,d);return}I=I.next}w=w.next}while(w!==f)}function wg(f,e,i,o){const l=[];let d,w,I,J,ee;for(d=0,w=e.length;d<w;d++)I=e[d]*o,J=d<w-1?e[d+1]*o:f.length,ee=Ag(f,I,J,o,!1),ee===ee.next&&(ee.steiner=!0),l.push(j1(ee));for(l.sort(V1),d=0;d<l.length;d++)W1(l[d],i),i=sl(i,i.next);return i}function V1(f,e){return f.x-e.x}function W1(f,e){if(e=H1(f,e),e){const i=bg(e,f);sl(e,e.next),sl(i,i.next)}}function H1(f,e){let i=e;const o=f.x,l=f.y;let d=-1/0,w;do{if(l<=i.y&&l>=i.next.y&&i.next.y!==i.y){const de=i.x+(l-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(de<=o&&de>d){if(d=de,de===o){if(l===i.y)return i;if(l===i.next.y)return i.next}w=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!w)return null;if(o===d)return w;const I=w,J=w.x,ee=w.y;let he=1/0,fe;i=w;do o>=i.x&&i.x>=J&&o!==i.x&&gf(l<ee?o:d,l,J,ee,l<ee?d:o,l,i.x,i.y)&&(fe=Math.abs(l-i.y)/(o-i.x),Lh(i,f)&&(fe<he||fe===he&&(i.x>w.x||i.x===w.x&&q1(w,i)))&&(w=i,he=fe)),i=i.next;while(i!==I);return w}function q1(f,e){return $i(f.prev,f,e.prev)<0&&$i(e.next,f,f.next)<0}function X1(f,e,i,o){let l=f;do l.z===null&&(l.z=Kp(l.x,l.y,e,i,o)),l.prevZ=l.prev,l.nextZ=l.next,l=l.next;while(l!==f);l.prevZ.nextZ=null,l.prevZ=null,Z1(l)}function Z1(f){let e,i,o,l,d,w,I,J,ee=1;do{for(i=f,f=null,d=null,w=0;i;){for(w++,o=i,I=0,e=0;e<ee&&(I++,o=o.nextZ,!!o);e++);for(J=ee;I>0||J>0&&o;)I!==0&&(J===0||!o||i.z<=o.z)?(l=i,i=i.nextZ,I--):(l=o,o=o.nextZ,J--),d?d.nextZ=l:f=l,l.prevZ=d,d=l;i=o}d.nextZ=null,ee*=2}while(w>1);return f}function Kp(f,e,i,o,l){return f=32767*(f-i)*l,e=32767*(e-o)*l,f=(f|f<<8)&16711935,f=(f|f<<4)&252645135,f=(f|f<<2)&858993459,f=(f|f<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,f|e<<1}function j1(f){let e=f,i=f;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==f);return i}function gf(f,e,i,o,l,d,w,I){return(l-w)*(e-I)-(f-w)*(d-I)>=0&&(f-w)*(o-I)-(i-w)*(e-I)>=0&&(i-w)*(d-I)-(l-w)*(o-I)>=0}function Y1(f,e){return f.next.i!==e.i&&f.prev.i!==e.i&&!J1(f,e)&&(Lh(f,e)&&Lh(e,f)&&$1(f,e)&&($i(f.prev,f,e.prev)||$i(f,e.prev,e))||e0(f,e)&&$i(f.prev,f,f.next)>0&&$i(e.prev,e,e.next)>0)}function $i(f,e,i){return(e.y-f.y)*(i.x-e.x)-(e.x-f.x)*(i.y-e.y)}function e0(f,e){return f.x===e.x&&f.y===e.y}function Mg(f,e,i,o){const l=Ph($i(f,e,i)),d=Ph($i(f,e,o)),w=Ph($i(i,o,f)),I=Ph($i(i,o,e));return!!(l!==d&&w!==I||l===0&&t0(f,i,e)||d===0&&t0(f,o,e)||w===0&&t0(i,f,o)||I===0&&t0(i,e,o))}function t0(f,e,i){return e.x<=Math.max(f.x,i.x)&&e.x>=Math.min(f.x,i.x)&&e.y<=Math.max(f.y,i.y)&&e.y>=Math.min(f.y,i.y)}function Ph(f){return f>0?1:f<0?-1:0}function J1(f,e){let i=f;do{if(i.i!==f.i&&i.next.i!==f.i&&i.i!==e.i&&i.next.i!==e.i&&Mg(i,i.next,f,e))return!0;i=i.next}while(i!==f);return!1}function Lh(f,e){return $i(f.prev,f,f.next)<0?$i(f,e,f.next)>=0&&$i(f,f.prev,e)>=0:$i(f,e,f.prev)<0||$i(f,f.next,e)<0}function $1(f,e){let i=f,o=!1;const l=(f.x+e.x)/2,d=(f.y+e.y)/2;do i.y>d!=i.next.y>d&&i.next.y!==i.y&&l<(i.next.x-i.x)*(d-i.y)/(i.next.y-i.y)+i.x&&(o=!o),i=i.next;while(i!==f);return o}function bg(f,e){const i=new em(f.i,f.x,f.y),o=new em(e.i,e.x,e.y),l=f.next,d=e.prev;return f.next=e,e.prev=f,i.next=l,l.prev=i,o.next=i,i.prev=o,d.next=o,o.prev=d,o}function Eg(f,e,i,o){const l=new em(f,e,i);return o?(l.next=o.next,l.prev=o,o.next.prev=l,o.next=l):(l.prev=l,l.next=l),l}function Oh(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function em(f,e,i){this.i=f,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Q1(f,e,i,o){let l=0;for(let d=e,w=i-o;d<i;d+=o)l+=(f[w]-f[d])*(f[d+1]+f[w+1]),w=d;return l}class $o{static area(e){const i=e.length;let o=0;for(let l=i-1,d=0;d<i;l=d++)o+=e[l].x*e[d].y-e[d].x*e[l].y;return o*.5}static isClockWise(e){return $o.area(e)<0}static triangulateShape(e,i){const o=[],l=[],d=[];Tg(e),Sg(o,e);let w=e.length;i.forEach(Tg);for(let J=0;J<i.length;J++)l.push(w),w+=i[J].length,Sg(o,i[J]);const I=N1.triangulate(o,l);for(let J=0;J<I.length;J+=3)d.push(I.slice(J,J+3));return d}}function Tg(f){const e=f.length;e>2&&f[e-1].equals(f[0])&&f.pop()}function Sg(f,e){for(let i=0;i<e.length;i++)f.push(e[i].x),f.push(e[i].y)}class bu extends An{constructor(e=new Jo([new We(.5,.5),new We(-.5,.5),new We(-.5,-.5),new We(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const o=this,l=[],d=[];for(let I=0,J=e.length;I<J;I++){const ee=e[I];w(ee)}this.setAttribute("position",new Qr(l,3)),this.setAttribute("uv",new Qr(d,2)),this.computeVertexNormals();function w(I){const J=[],ee=i.curveSegments!==void 0?i.curveSegments:12,he=i.steps!==void 0?i.steps:1;let fe=i.depth!==void 0?i.depth:1,de=i.bevelEnabled!==void 0?i.bevelEnabled:!0,ve=i.bevelThickness!==void 0?i.bevelThickness:.2,Ce=i.bevelSize!==void 0?i.bevelSize:ve-.1,Ne=i.bevelOffset!==void 0?i.bevelOffset:0,Ke=i.bevelSegments!==void 0?i.bevelSegments:3;const Oe=i.extrudePath,xe=i.UVGenerator!==void 0?i.UVGenerator:K1;i.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),fe=i.amount);let ut,rt=!1,ft,Mt,Rt,kt;Oe&&(ut=Oe.getSpacedPoints(he),rt=!0,de=!1,ft=Oe.computeFrenetFrames(he,!1),Mt=new dt,Rt=new dt,kt=new dt),de||(Ke=0,ve=0,Ce=0,Ne=0);const nr=I.extractPoints(ee);let Xt=nr.shape;const it=nr.holes;if(!$o.isClockWise(Xt)){Xt=Xt.reverse();for(let pr=0,Fr=it.length;pr<Fr;pr++){const Cr=it[pr];$o.isClockWise(Cr)&&(it[pr]=Cr.reverse())}}const Vt=$o.triangulateShape(Xt,it),Zt=Xt;for(let pr=0,Fr=it.length;pr<Fr;pr++){const Cr=it[pr];Xt=Xt.concat(Cr)}function Jt(pr,Fr,Cr){return Fr||console.error("THREE.ExtrudeGeometry: vec does not exist"),Fr.clone().multiplyScalar(Cr).add(pr)}const jt=Xt.length,ir=Vt.length;function Sr(pr,Fr,Cr){let en,Zr,On;const Sn=pr.x-Fr.x,li=pr.y-Fr.y,Ui=Cr.x-pr.x,Ci=Cr.y-pr.y,Et=Sn*Sn+li*li,mt=Sn*Ci-li*Ui;if(Math.abs(mt)>Number.EPSILON){const lr=Math.sqrt(Et),Rr=Math.sqrt(Ui*Ui+Ci*Ci),hn=Fr.x-li/lr,ur=Fr.y+Sn/lr,wn=Cr.x-Ci/Rr,yn=Cr.y+Ui/Rr,qr=((wn-hn)*Ci-(yn-ur)*Ui)/(Sn*Ci-li*Ui);en=hn+Sn*qr-pr.x,Zr=ur+li*qr-pr.y;const Vr=en*en+Zr*Zr;if(Vr<=2)return new We(en,Zr);On=Math.sqrt(Vr/2)}else{let lr=!1;Sn>Number.EPSILON?Ui>Number.EPSILON&&(lr=!0):Sn<-Number.EPSILON?Ui<-Number.EPSILON&&(lr=!0):Math.sign(li)===Math.sign(Ci)&&(lr=!0),lr?(en=-li,Zr=Sn,On=Math.sqrt(Et)):(en=Sn,Zr=li,On=Math.sqrt(Et/2))}return new We(en/On,Zr/On)}const Hr=[];for(let pr=0,Fr=Zt.length,Cr=Fr-1,en=pr+1;pr<Fr;pr++,Cr++,en++)Cr===Fr&&(Cr=0),en===Fr&&(en=0),Hr[pr]=Sr(Zt[pr],Zt[Cr],Zt[en]);const or=[];let tr,Br=Hr.concat();for(let pr=0,Fr=it.length;pr<Fr;pr++){const Cr=it[pr];tr=[];for(let en=0,Zr=Cr.length,On=Zr-1,Sn=en+1;en<Zr;en++,On++,Sn++)On===Zr&&(On=0),Sn===Zr&&(Sn=0),tr[en]=Sr(Cr[en],Cr[On],Cr[Sn]);or.push(tr),Br=Br.concat(tr)}for(let pr=0;pr<Ke;pr++){const Fr=pr/Ke,Cr=ve*Math.cos(Fr*Math.PI/2),en=Ce*Math.sin(Fr*Math.PI/2)+Ne;for(let Zr=0,On=Zt.length;Zr<On;Zr++){const Sn=Jt(Zt[Zr],Hr[Zr],en);gn(Sn.x,Sn.y,-Cr)}for(let Zr=0,On=it.length;Zr<On;Zr++){const Sn=it[Zr];tr=or[Zr];for(let li=0,Ui=Sn.length;li<Ui;li++){const Ci=Jt(Sn[li],tr[li],en);gn(Ci.x,Ci.y,-Cr)}}}const nn=Ce+Ne;for(let pr=0;pr<jt;pr++){const Fr=de?Jt(Xt[pr],Br[pr],nn):Xt[pr];rt?(Rt.copy(ft.normals[0]).multiplyScalar(Fr.x),Mt.copy(ft.binormals[0]).multiplyScalar(Fr.y),kt.copy(ut[0]).add(Rt).add(Mt),gn(kt.x,kt.y,kt.z)):gn(Fr.x,Fr.y,0)}for(let pr=1;pr<=he;pr++)for(let Fr=0;Fr<jt;Fr++){const Cr=de?Jt(Xt[Fr],Br[Fr],nn):Xt[Fr];rt?(Rt.copy(ft.normals[pr]).multiplyScalar(Cr.x),Mt.copy(ft.binormals[pr]).multiplyScalar(Cr.y),kt.copy(ut[pr]).add(Rt).add(Mt),gn(kt.x,kt.y,kt.z)):gn(Cr.x,Cr.y,fe/he*pr)}for(let pr=Ke-1;pr>=0;pr--){const Fr=pr/Ke,Cr=ve*Math.cos(Fr*Math.PI/2),en=Ce*Math.sin(Fr*Math.PI/2)+Ne;for(let Zr=0,On=Zt.length;Zr<On;Zr++){const Sn=Jt(Zt[Zr],Hr[Zr],en);gn(Sn.x,Sn.y,fe+Cr)}for(let Zr=0,On=it.length;Zr<On;Zr++){const Sn=it[Zr];tr=or[Zr];for(let li=0,Ui=Sn.length;li<Ui;li++){const Ci=Jt(Sn[li],tr[li],en);rt?gn(Ci.x,Ci.y+ut[he-1].y,ut[he-1].x+Cr):gn(Ci.x,Ci.y,fe+Cr)}}}vn(),Ft();function vn(){const pr=l.length/3;if(de){let Fr=0,Cr=jt*Fr;for(let en=0;en<ir;en++){const Zr=Vt[en];Dn(Zr[2]+Cr,Zr[1]+Cr,Zr[0]+Cr)}Fr=he+Ke*2,Cr=jt*Fr;for(let en=0;en<ir;en++){const Zr=Vt[en];Dn(Zr[0]+Cr,Zr[1]+Cr,Zr[2]+Cr)}}else{for(let Fr=0;Fr<ir;Fr++){const Cr=Vt[Fr];Dn(Cr[2],Cr[1],Cr[0])}for(let Fr=0;Fr<ir;Fr++){const Cr=Vt[Fr];Dn(Cr[0]+jt*he,Cr[1]+jt*he,Cr[2]+jt*he)}}o.addGroup(pr,l.length/3-pr,0)}function Ft(){const pr=l.length/3;let Fr=0;mi(Zt,Fr),Fr+=Zt.length;for(let Cr=0,en=it.length;Cr<en;Cr++){const Zr=it[Cr];mi(Zr,Fr),Fr+=Zr.length}o.addGroup(pr,l.length/3-pr,1)}function mi(pr,Fr){let Cr=pr.length;for(;--Cr>=0;){const en=Cr;let Zr=Cr-1;Zr<0&&(Zr=pr.length-1);for(let On=0,Sn=he+Ke*2;On<Sn;On++){const li=jt*On,Ui=jt*(On+1),Ci=Fr+en+li,Et=Fr+Zr+li,mt=Fr+Zr+Ui,lr=Fr+en+Ui;Kr(Ci,Et,mt,lr)}}}function gn(pr,Fr,Cr){J.push(pr),J.push(Fr),J.push(Cr)}function Dn(pr,Fr,Cr){rr(pr),rr(Fr),rr(Cr);const en=l.length/3,Zr=xe.generateTopUV(o,l,en-3,en-2,en-1);Bn(Zr[0]),Bn(Zr[1]),Bn(Zr[2])}function Kr(pr,Fr,Cr,en){rr(pr),rr(Fr),rr(en),rr(Fr),rr(Cr),rr(en);const Zr=l.length/3,On=xe.generateSideWallUV(o,l,Zr-6,Zr-3,Zr-2,Zr-1);Bn(On[0]),Bn(On[1]),Bn(On[3]),Bn(On[1]),Bn(On[2]),Bn(On[3])}function rr(pr){l.push(J[pr*3+0]),l.push(J[pr*3+1]),l.push(J[pr*3+2])}function Bn(pr){d.push(pr.x),d.push(pr.y)}}}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,o=this.parameters.options;return e_(i,o,e)}static fromJSON(e,i){const o=[];for(let d=0,w=e.shapes.length;d<w;d++){const I=i[e.shapes[d]];o.push(I)}const l=e.options.extrudePath;return l!==void 0&&(e.options.extrudePath=new Qp[l.type]().fromJSON(l)),new bu(o,e.options)}}const K1={generateTopUV:function(f,e,i,o,l){const d=e[i*3],w=e[i*3+1],I=e[o*3],J=e[o*3+1],ee=e[l*3],he=e[l*3+1];return[new We(d,w),new We(I,J),new We(ee,he)]},generateSideWallUV:function(f,e,i,o,l,d){const w=e[i*3],I=e[i*3+1],J=e[i*3+2],ee=e[o*3],he=e[o*3+1],fe=e[o*3+2],de=e[l*3],ve=e[l*3+1],Ce=e[l*3+2],Ne=e[d*3],Ke=e[d*3+1],Oe=e[d*3+2];return Math.abs(I-he)<Math.abs(w-ee)?[new We(w,1-J),new We(ee,1-fe),new We(de,1-Ce),new We(Ne,1-Oe)]:[new We(I,1-J),new We(he,1-fe),new We(ve,1-Ce),new We(Ke,1-Oe)]}};function e_(f,e,i){if(i.shapes=[],Array.isArray(f))for(let o=0,l=f.length;o<l;o++){const d=f[o];i.shapes.push(d.uuid)}else i.shapes.push(f.uuid);return e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class yf extends Yo{constructor(e=1,i=0){const o=(1+Math.sqrt(5))/2,l=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],d=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(l,d,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new yf(e.radius,e.detail)}}class _f extends An{constructor(e=[new We(0,.5),new We(.5,0),new We(0,-.5)],i=12,o=0,l=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:o,phiLength:l},i=Math.floor(i),l=un(l,0,Math.PI*2);const d=[],w=[],I=[],J=[],ee=[],he=1/i,fe=new dt,de=new We,ve=new dt,Ce=new dt,Ne=new dt;let Ke=0,Oe=0;for(let xe=0;xe<=e.length-1;xe++)switch(xe){case 0:Ke=e[xe+1].x-e[xe].x,Oe=e[xe+1].y-e[xe].y,ve.x=Oe*1,ve.y=-Ke,ve.z=Oe*0,Ne.copy(ve),ve.normalize(),J.push(ve.x,ve.y,ve.z);break;case e.length-1:J.push(Ne.x,Ne.y,Ne.z);break;default:Ke=e[xe+1].x-e[xe].x,Oe=e[xe+1].y-e[xe].y,ve.x=Oe*1,ve.y=-Ke,ve.z=Oe*0,Ce.copy(ve),ve.x+=Ne.x,ve.y+=Ne.y,ve.z+=Ne.z,ve.normalize(),J.push(ve.x,ve.y,ve.z),Ne.copy(Ce)}for(let xe=0;xe<=i;xe++){const ut=o+xe*he*l,rt=Math.sin(ut),ft=Math.cos(ut);for(let Mt=0;Mt<=e.length-1;Mt++){fe.x=e[Mt].x*rt,fe.y=e[Mt].y,fe.z=e[Mt].x*ft,w.push(fe.x,fe.y,fe.z),de.x=xe/i,de.y=Mt/(e.length-1),I.push(de.x,de.y);const Rt=J[3*Mt+0]*rt,kt=J[3*Mt+1],nr=J[3*Mt+0]*ft;ee.push(Rt,kt,nr)}}for(let xe=0;xe<i;xe++)for(let ut=0;ut<e.length-1;ut++){const rt=ut+xe*e.length,ft=rt,Mt=rt+e.length,Rt=rt+e.length+1,kt=rt+1;d.push(ft,Mt,kt),d.push(Rt,kt,Mt)}this.setIndex(d),this.setAttribute("position",new Qr(w,3)),this.setAttribute("uv",new Qr(I,2)),this.setAttribute("normal",new Qr(ee,3))}static fromJSON(e){return new _f(e.points,e.segments,e.phiStart,e.phiLength)}}class xo extends Yo{constructor(e=1,i=0){const o=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],l=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(o,l,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new xo(e.radius,e.detail)}}class xf extends An{constructor(e=.5,i=1,o=8,l=1,d=0,w=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:o,phiSegments:l,thetaStart:d,thetaLength:w},o=Math.max(3,o),l=Math.max(1,l);const I=[],J=[],ee=[],he=[];let fe=e;const de=(i-e)/l,ve=new dt,Ce=new We;for(let Ne=0;Ne<=l;Ne++){for(let Ke=0;Ke<=o;Ke++){const Oe=d+Ke/o*w;ve.x=fe*Math.cos(Oe),ve.y=fe*Math.sin(Oe),J.push(ve.x,ve.y,ve.z),ee.push(0,0,1),Ce.x=(ve.x/i+1)/2,Ce.y=(ve.y/i+1)/2,he.push(Ce.x,Ce.y)}fe+=de}for(let Ne=0;Ne<l;Ne++){const Ke=Ne*(o+1);for(let Oe=0;Oe<o;Oe++){const xe=Oe+Ke,ut=xe,rt=xe+o+1,ft=xe+o+2,Mt=xe+1;I.push(ut,rt,Mt),I.push(rt,ft,Mt)}}this.setIndex(I),this.setAttribute("position",new Qr(J,3)),this.setAttribute("normal",new Qr(ee,3)),this.setAttribute("uv",new Qr(he,2))}static fromJSON(e){return new xf(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class sc extends An{constructor(e=new Jo([new We(0,.5),new We(-.5,-.5),new We(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const o=[],l=[],d=[],w=[];let I=0,J=0;if(Array.isArray(e)===!1)ee(e);else for(let he=0;he<e.length;he++)ee(e[he]),this.addGroup(I,J,he),I+=J,J=0;this.setIndex(o),this.setAttribute("position",new Qr(l,3)),this.setAttribute("normal",new Qr(d,3)),this.setAttribute("uv",new Qr(w,2));function ee(he){const fe=l.length/3,de=he.extractPoints(i);let ve=de.shape;const Ce=de.holes;$o.isClockWise(ve)===!1&&(ve=ve.reverse());for(let Ke=0,Oe=Ce.length;Ke<Oe;Ke++){const xe=Ce[Ke];$o.isClockWise(xe)===!0&&(Ce[Ke]=xe.reverse())}const Ne=$o.triangulateShape(ve,Ce);for(let Ke=0,Oe=Ce.length;Ke<Oe;Ke++){const xe=Ce[Ke];ve=ve.concat(xe)}for(let Ke=0,Oe=ve.length;Ke<Oe;Ke++){const xe=ve[Ke];l.push(xe.x,xe.y,0),d.push(0,0,1),w.push(xe.x,xe.y)}for(let Ke=0,Oe=Ne.length;Ke<Oe;Ke++){const xe=Ne[Ke],ut=xe[0]+fe,rt=xe[1]+fe,ft=xe[2]+fe;o.push(ut,rt,ft),J+=3}}}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return Rg(i,e)}static fromJSON(e,i){const o=[];for(let l=0,d=e.shapes.length;l<d;l++){const w=i[e.shapes[l]];o.push(w)}return new sc(o,e.curveSegments)}}function Rg(f,e){if(e.shapes=[],Array.isArray(f))for(let i=0,o=f.length;i<o;i++){const l=f[i];e.shapes.push(l.uuid)}else e.shapes.push(f.uuid);return e}class oc extends An{constructor(e=1,i=32,o=16,l=0,d=Math.PI*2,w=0,I=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:o,phiStart:l,phiLength:d,thetaStart:w,thetaLength:I},i=Math.max(3,Math.floor(i)),o=Math.max(2,Math.floor(o));const J=Math.min(w+I,Math.PI);let ee=0;const he=[],fe=new dt,de=new dt,ve=[],Ce=[],Ne=[],Ke=[];for(let Oe=0;Oe<=o;Oe++){const xe=[],ut=Oe/o;let rt=0;Oe==0&&w==0?rt=.5/i:Oe==o&&J==Math.PI&&(rt=-.5/i);for(let ft=0;ft<=i;ft++){const Mt=ft/i;fe.x=-e*Math.cos(l+Mt*d)*Math.sin(w+ut*I),fe.y=e*Math.cos(w+ut*I),fe.z=e*Math.sin(l+Mt*d)*Math.sin(w+ut*I),Ce.push(fe.x,fe.y,fe.z),de.copy(fe).normalize(),Ne.push(de.x,de.y,de.z),Ke.push(Mt+rt,1-ut),xe.push(ee++)}he.push(xe)}for(let Oe=0;Oe<o;Oe++)for(let xe=0;xe<i;xe++){const ut=he[Oe][xe+1],rt=he[Oe][xe],ft=he[Oe+1][xe],Mt=he[Oe+1][xe+1];(Oe!==0||w>0)&&ve.push(ut,rt,Mt),(Oe!==o-1||J<Math.PI)&&ve.push(rt,ft,Mt)}this.setIndex(ve),this.setAttribute("position",new Qr(Ce,3)),this.setAttribute("normal",new Qr(Ne,3)),this.setAttribute("uv",new Qr(Ke,2))}static fromJSON(e){return new oc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Af extends Yo{constructor(e=1,i=0){const o=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],l=[2,1,0,0,3,2,1,3,0,2,3,1];super(o,l,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Af(e.radius,e.detail)}}class wf extends An{constructor(e=1,i=.4,o=8,l=6,d=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:o,tubularSegments:l,arc:d},o=Math.floor(o),l=Math.floor(l);const w=[],I=[],J=[],ee=[],he=new dt,fe=new dt,de=new dt;for(let ve=0;ve<=o;ve++)for(let Ce=0;Ce<=l;Ce++){const Ne=Ce/l*d,Ke=ve/o*Math.PI*2;fe.x=(e+i*Math.cos(Ke))*Math.cos(Ne),fe.y=(e+i*Math.cos(Ke))*Math.sin(Ne),fe.z=i*Math.sin(Ke),I.push(fe.x,fe.y,fe.z),he.x=e*Math.cos(Ne),he.y=e*Math.sin(Ne),de.subVectors(fe,he).normalize(),J.push(de.x,de.y,de.z),ee.push(Ce/l),ee.push(ve/o)}for(let ve=1;ve<=o;ve++)for(let Ce=1;Ce<=l;Ce++){const Ne=(l+1)*ve+Ce-1,Ke=(l+1)*(ve-1)+Ce-1,Oe=(l+1)*(ve-1)+Ce,xe=(l+1)*ve+Ce;w.push(Ne,Ke,xe),w.push(Ke,Oe,xe)}this.setIndex(w),this.setAttribute("position",new Qr(I,3)),this.setAttribute("normal",new Qr(J,3)),this.setAttribute("uv",new Qr(ee,2))}static fromJSON(e){return new wf(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Mf extends An{constructor(e=1,i=.4,o=64,l=8,d=2,w=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:o,radialSegments:l,p:d,q:w},o=Math.floor(o),l=Math.floor(l);const I=[],J=[],ee=[],he=[],fe=new dt,de=new dt,ve=new dt,Ce=new dt,Ne=new dt,Ke=new dt,Oe=new dt;for(let ut=0;ut<=o;++ut){const rt=ut/o*d*Math.PI*2;xe(rt,d,w,e,ve),xe(rt+.01,d,w,e,Ce),Ke.subVectors(Ce,ve),Oe.addVectors(Ce,ve),Ne.crossVectors(Ke,Oe),Oe.crossVectors(Ne,Ke),Ne.normalize(),Oe.normalize();for(let ft=0;ft<=l;++ft){const Mt=ft/l*Math.PI*2,Rt=-i*Math.cos(Mt),kt=i*Math.sin(Mt);fe.x=ve.x+(Rt*Oe.x+kt*Ne.x),fe.y=ve.y+(Rt*Oe.y+kt*Ne.y),fe.z=ve.z+(Rt*Oe.z+kt*Ne.z),J.push(fe.x,fe.y,fe.z),de.subVectors(fe,ve).normalize(),ee.push(de.x,de.y,de.z),he.push(ut/o),he.push(ft/l)}}for(let ut=1;ut<=o;ut++)for(let rt=1;rt<=l;rt++){const ft=(l+1)*(ut-1)+(rt-1),Mt=(l+1)*ut+(rt-1),Rt=(l+1)*ut+rt,kt=(l+1)*(ut-1)+rt;I.push(ft,Mt,kt),I.push(Mt,Rt,kt)}this.setIndex(I),this.setAttribute("position",new Qr(J,3)),this.setAttribute("normal",new Qr(ee,3)),this.setAttribute("uv",new Qr(he,2));function xe(ut,rt,ft,Mt,Rt){const kt=Math.cos(ut),nr=Math.sin(ut),Xt=ft/rt*ut,it=Math.cos(Xt);Rt.x=Mt*(2+it)*.5*kt,Rt.y=Mt*(2+it)*nr*.5,Rt.z=Mt*Math.sin(Xt)*.5}}static fromJSON(e){return new Mf(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class bf extends An{constructor(e=new Qd(new dt(-1,-1,0),new dt(-1,1,0),new dt(1,1,0)),i=64,o=1,l=8,d=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:o,radialSegments:l,closed:d};const w=e.computeFrenetFrames(i,d);this.tangents=w.tangents,this.normals=w.normals,this.binormals=w.binormals;const I=new dt,J=new dt,ee=new We;let he=new dt;const fe=[],de=[],ve=[],Ce=[];Ne(),this.setIndex(Ce),this.setAttribute("position",new Qr(fe,3)),this.setAttribute("normal",new Qr(de,3)),this.setAttribute("uv",new Qr(ve,2));function Ne(){for(let ut=0;ut<i;ut++)Ke(ut);Ke(d===!1?i:0),xe(),Oe()}function Ke(ut){he=e.getPointAt(ut/i,he);const rt=w.normals[ut],ft=w.binormals[ut];for(let Mt=0;Mt<=l;Mt++){const Rt=Mt/l*Math.PI*2,kt=Math.sin(Rt),nr=-Math.cos(Rt);J.x=nr*rt.x+kt*ft.x,J.y=nr*rt.y+kt*ft.y,J.z=nr*rt.z+kt*ft.z,J.normalize(),de.push(J.x,J.y,J.z),I.x=he.x+o*J.x,I.y=he.y+o*J.y,I.z=he.z+o*J.z,fe.push(I.x,I.y,I.z)}}function Oe(){for(let ut=1;ut<=i;ut++)for(let rt=1;rt<=l;rt++){const ft=(l+1)*(ut-1)+(rt-1),Mt=(l+1)*ut+(rt-1),Rt=(l+1)*ut+rt,kt=(l+1)*(ut-1)+rt;Ce.push(ft,Mt,kt),Ce.push(Mt,Rt,kt)}}function xe(){for(let ut=0;ut<=i;ut++)for(let rt=0;rt<=l;rt++)ee.x=ut/i,ee.y=rt/l,ve.push(ee.x,ee.y)}}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new bf(new Qp[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Ef extends An{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],o=new Set,l=new dt,d=new dt;if(e.index!==null){const w=e.attributes.position,I=e.index;let J=e.groups;J.length===0&&(J=[{start:0,count:I.count,materialIndex:0}]);for(let ee=0,he=J.length;ee<he;++ee){const fe=J[ee],de=fe.start,ve=fe.count;for(let Ce=de,Ne=de+ve;Ce<Ne;Ce+=3)for(let Ke=0;Ke<3;Ke++){const Oe=I.getX(Ce+Ke),xe=I.getX(Ce+(Ke+1)%3);l.fromBufferAttribute(w,Oe),d.fromBufferAttribute(w,xe),Fh(l,d,o)===!0&&(i.push(l.x,l.y,l.z),i.push(d.x,d.y,d.z))}}}else{const w=e.attributes.position;for(let I=0,J=w.count/3;I<J;I++)for(let ee=0;ee<3;ee++){const he=3*I+ee,fe=3*I+(ee+1)%3;l.fromBufferAttribute(w,he),d.fromBufferAttribute(w,fe),Fh(l,d,o)===!0&&(i.push(l.x,l.y,l.z),i.push(d.x,d.y,d.z))}}this.setAttribute("position",new Qr(i,3))}}}function Fh(f,e,i){const o=`${f.x},${f.y},${f.z}-${e.x},${e.y},${e.z}`,l=`${e.x},${e.y},${e.z}-${f.x},${f.y},${f.z}`;return i.has(o)===!0||i.has(l)===!0?!1:(i.add(o,l),!0)}var tm=Object.freeze({__proto__:null,BoxGeometry:ho,BoxBufferGeometry:ho,CircleGeometry:pf,CircleBufferGeometry:pf,ConeGeometry:mf,ConeBufferGeometry:mf,CylinderGeometry:al,CylinderBufferGeometry:al,DodecahedronGeometry:vf,DodecahedronBufferGeometry:vf,EdgesGeometry:qp,ExtrudeGeometry:bu,ExtrudeBufferGeometry:bu,IcosahedronGeometry:yf,IcosahedronBufferGeometry:yf,LatheGeometry:_f,LatheBufferGeometry:_f,OctahedronGeometry:xo,OctahedronBufferGeometry:xo,PlaneGeometry:po,PlaneBufferGeometry:po,PolyhedronGeometry:Yo,PolyhedronBufferGeometry:Yo,RingGeometry:xf,RingBufferGeometry:xf,ShapeGeometry:sc,ShapeBufferGeometry:sc,SphereGeometry:oc,SphereBufferGeometry:oc,TetrahedronGeometry:Af,TetrahedronBufferGeometry:Af,TorusGeometry:wf,TorusBufferGeometry:wf,TorusKnotGeometry:Mf,TorusKnotBufferGeometry:Mf,TubeGeometry:bf,TubeBufferGeometry:bf,WireframeGeometry:Ef});class rm extends Ti{constructor(e){super(),this.type="ShadowMaterial",this.color=new Or(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}rm.prototype.isShadowMaterial=!0;class r0 extends Ti{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Or(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gs,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}r0.prototype.isMeshStandardMaterial=!0;class nm extends r0{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new We(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return un(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.sheenColor=new Or(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Or(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Or(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}nm.prototype.isMeshPhysicalMaterial=!0;class im extends Ti{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Or(16777215),this.specular=new Or(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gs,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=et,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}im.prototype.isMeshPhongMaterial=!0;class am extends Ti{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Or(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gs,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}am.prototype.isMeshToonMaterial=!0;class sm extends Ti{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gs,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}sm.prototype.isMeshNormalMaterial=!0;class om extends Ti{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=et,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}om.prototype.isMeshLambertMaterial=!0;class um extends Ti{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Or(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gs,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}um.prototype.isMeshMatcapMaterial=!0;class lm extends Ji{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}lm.prototype.isLineDashedMaterial=!0;var t_=Object.freeze({__proto__:null,ShadowMaterial:rm,SpriteMaterial:Bd,RawShaderMaterial:Mu,ShaderMaterial:Jn,PointsMaterial:ac,MeshPhysicalMaterial:nm,MeshStandardMaterial:r0,MeshPhongMaterial:im,MeshToonMaterial:am,MeshNormalMaterial:sm,MeshLambertMaterial:om,MeshDepthMaterial:Dd,MeshDistanceMaterial:hh,MeshBasicMaterial:co,MeshMatcapMaterial:um,LineDashedMaterial:lm,LineBasicMaterial:Ji,Material:Ti});const Gi={arraySlice:function(f,e,i){return Gi.isTypedArray(f)?new f.constructor(f.subarray(e,i!==void 0?i:f.length)):f.slice(e,i)},convertArray:function(f,e,i){return!f||!i&&f.constructor===e?f:typeof e.BYTES_PER_ELEMENT=="number"?new e(f):Array.prototype.slice.call(f)},isTypedArray:function(f){return ArrayBuffer.isView(f)&&!(f instanceof DataView)},getKeyframeOrder:function(f){function e(l,d){return f[l]-f[d]}const i=f.length,o=new Array(i);for(let l=0;l!==i;++l)o[l]=l;return o.sort(e),o},sortedArray:function(f,e,i){const o=f.length,l=new f.constructor(o);for(let d=0,w=0;w!==o;++d){const I=i[d]*e;for(let J=0;J!==e;++J)l[w++]=f[I+J]}return l},flattenJSON:function(f,e,i,o){let l=1,d=f[0];for(;d!==void 0&&d[o]===void 0;)d=f[l++];if(d===void 0)return;let w=d[o];if(w!==void 0)if(Array.isArray(w))do w=d[o],w!==void 0&&(e.push(d.time),i.push.apply(i,w)),d=f[l++];while(d!==void 0);else if(w.toArray!==void 0)do w=d[o],w!==void 0&&(e.push(d.time),w.toArray(i,i.length)),d=f[l++];while(d!==void 0);else do w=d[o],w!==void 0&&(e.push(d.time),i.push(w)),d=f[l++];while(d!==void 0)},subclip:function(f,e,i,o,l=30){const d=f.clone();d.name=e;const w=[];for(let J=0;J<d.tracks.length;++J){const ee=d.tracks[J],he=ee.getValueSize(),fe=[],de=[];for(let ve=0;ve<ee.times.length;++ve){const Ce=ee.times[ve]*l;if(!(Ce<i||Ce>=o)){fe.push(ee.times[ve]);for(let Ne=0;Ne<he;++Ne)de.push(ee.values[ve*he+Ne])}}fe.length!==0&&(ee.times=Gi.convertArray(fe,ee.times.constructor),ee.values=Gi.convertArray(de,ee.values.constructor),w.push(ee))}d.tracks=w;let I=1/0;for(let J=0;J<d.tracks.length;++J)I>d.tracks[J].times[0]&&(I=d.tracks[J].times[0]);for(let J=0;J<d.tracks.length;++J)d.tracks[J].shift(-1*I);return d.resetDuration(),d},makeClipAdditive:function(f,e=0,i=f,o=30){o<=0&&(o=30);const l=i.tracks.length,d=e/o;for(let w=0;w<l;++w){const I=i.tracks[w],J=I.ValueTypeName;if(J==="bool"||J==="string")continue;const ee=f.tracks.find(function(Oe){return Oe.name===I.name&&Oe.ValueTypeName===J});if(ee===void 0)continue;let he=0;const fe=I.getValueSize();I.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(he=fe/3);let de=0;const ve=ee.getValueSize();ee.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(de=ve/3);const Ce=I.times.length-1;let Ne;if(d<=I.times[0]){const Oe=he,xe=fe-he;Ne=Gi.arraySlice(I.values,Oe,xe)}else if(d>=I.times[Ce]){const Oe=Ce*fe+he,xe=Oe+fe-he;Ne=Gi.arraySlice(I.values,Oe,xe)}else{const Oe=I.createInterpolant(),xe=he,ut=fe-he;Oe.evaluate(d),Ne=Gi.arraySlice(Oe.resultBuffer,xe,ut)}J==="quaternion"&&new ha().fromArray(Ne).normalize().conjugate().toArray(Ne);const Ke=ee.times.length;for(let Oe=0;Oe<Ke;++Oe){const xe=Oe*ve+de;if(J==="quaternion")ha.multiplyQuaternionsFlat(ee.values,xe,Ne,0,ee.values,xe);else{const ut=ve-de*2;for(let rt=0;rt<ut;++rt)ee.values[xe+rt]-=Ne[rt]}}}return f.blendMode=fu,f}};class Eu{constructor(e,i,o,l){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=l!==void 0?l:new i.constructor(o),this.sampleValues=i,this.valueSize=o,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let o=this._cachedIndex,l=i[o],d=i[o-1];e:{t:{let w;r:{n:if(!(e<l)){for(let I=o+2;;){if(l===void 0){if(e<d)break n;return o=i.length,this._cachedIndex=o,this.afterEnd_(o-1,e,d)}if(o===I)break;if(d=l,l=i[++o],e<l)break t}w=i.length;break r}if(!(e>=d)){const I=i[1];e<I&&(o=2,d=I);for(let J=o-2;;){if(d===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,l);if(o===J)break;if(l=d,d=i[--o-1],e>=d)break t}w=o,o=0;break r}break e}for(;o<w;){const I=o+w>>>1;e<i[I]?w=I:o=I+1}if(l=i[o],d=i[o-1],d===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,l);if(l===void 0)return o=i.length,this._cachedIndex=o,this.afterEnd_(o-1,d,e)}this._cachedIndex=o,this.intervalChanged_(o,d,l)}return this.interpolate_(o,d,e,l)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,o=this.sampleValues,l=this.valueSize,d=e*l;for(let w=0;w!==l;++w)i[w]=o[d+w];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Eu.prototype.beforeStart_=Eu.prototype.copySampleValue_,Eu.prototype.afterEnd_=Eu.prototype.copySampleValue_;class Cg extends Eu{constructor(e,i,o,l){super(e,i,o,l),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:fa,endingEnd:fa}}intervalChanged_(e,i,o){const l=this.parameterPositions;let d=e-2,w=e+1,I=l[d],J=l[w];if(I===void 0)switch(this.getSettings_().endingStart){case bo:d=e,I=2*i-o;break;case Eo:d=l.length-2,I=i+l[d]-l[d+1];break;default:d=e,I=o}if(J===void 0)switch(this.getSettings_().endingEnd){case bo:w=e,J=2*o-i;break;case Eo:w=1,J=o+l[1]-l[0];break;default:w=e-1,J=i}const ee=(o-i)*.5,he=this.valueSize;this._weightPrev=ee/(i-I),this._weightNext=ee/(J-o),this._offsetPrev=d*he,this._offsetNext=w*he}interpolate_(e,i,o,l){const d=this.resultBuffer,w=this.sampleValues,I=this.valueSize,J=e*I,ee=J-I,he=this._offsetPrev,fe=this._offsetNext,de=this._weightPrev,ve=this._weightNext,Ce=(o-i)/(l-i),Ne=Ce*Ce,Ke=Ne*Ce,Oe=-de*Ke+2*de*Ne-de*Ce,xe=(1+de)*Ke+(-1.5-2*de)*Ne+(-.5+de)*Ce+1,ut=(-1-ve)*Ke+(1.5+ve)*Ne+.5*Ce,rt=ve*Ke-ve*Ne;for(let ft=0;ft!==I;++ft)d[ft]=Oe*w[he+ft]+xe*w[ee+ft]+ut*w[J+ft]+rt*w[fe+ft];return d}}class Ih extends Eu{constructor(e,i,o,l){super(e,i,o,l)}interpolate_(e,i,o,l){const d=this.resultBuffer,w=this.sampleValues,I=this.valueSize,J=e*I,ee=J-I,he=(o-i)/(l-i),fe=1-he;for(let de=0;de!==I;++de)d[de]=w[ee+de]*fe+w[J+de]*he;return d}}class cm extends Eu{constructor(e,i,o,l){super(e,i,o,l)}interpolate_(e){return this.copySampleValue_(e-1)}}class ks{constructor(e,i,o,l){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Gi.convertArray(i,this.TimeBufferType),this.values=Gi.convertArray(o,this.ValueBufferType),this.setInterpolation(l||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let o;if(i.toJSON!==this.toJSON)o=i.toJSON(e);else{o={name:e.name,times:Gi.convertArray(e.times,Array),values:Gi.convertArray(e.values,Array)};const l=e.getInterpolation();l!==e.DefaultInterpolation&&(o.interpolation=l)}return o.type=e.ValueTypeName,o}InterpolantFactoryMethodDiscrete(e){return new cm(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ih(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Cg(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case lu:i=this.InterpolantFactoryMethodDiscrete;break;case cu:i=this.InterpolantFactoryMethodLinear;break;case ts:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(o);return console.warn("THREE.KeyframeTrack:",o),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return lu;case this.InterpolantFactoryMethodLinear:return cu;case this.InterpolantFactoryMethodSmooth:return ts}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let o=0,l=i.length;o!==l;++o)i[o]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let o=0,l=i.length;o!==l;++o)i[o]*=e}return this}trim(e,i){const o=this.times,l=o.length;let d=0,w=l-1;for(;d!==l&&o[d]<e;)++d;for(;w!==-1&&o[w]>i;)--w;if(++w,d!==0||w!==l){d>=w&&(w=Math.max(w,1),d=w-1);const I=this.getValueSize();this.times=Gi.arraySlice(o,d,w),this.values=Gi.arraySlice(this.values,d*I,w*I)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const o=this.times,l=this.values,d=o.length;d===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let w=null;for(let I=0;I!==d;I++){const J=o[I];if(typeof J=="number"&&isNaN(J)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,I,J),e=!1;break}if(w!==null&&w>J){console.error("THREE.KeyframeTrack: Out of order keys.",this,I,J,w),e=!1;break}w=J}if(l!==void 0&&Gi.isTypedArray(l))for(let I=0,J=l.length;I!==J;++I){const ee=l[I];if(isNaN(ee)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,I,ee),e=!1;break}}return e}optimize(){const e=Gi.arraySlice(this.times),i=Gi.arraySlice(this.values),o=this.getValueSize(),l=this.getInterpolation()===ts,d=e.length-1;let w=1;for(let I=1;I<d;++I){let J=!1;const ee=e[I],he=e[I+1];if(ee!==he&&(I!==1||ee!==e[0]))if(l)J=!0;else{const fe=I*o,de=fe-o,ve=fe+o;for(let Ce=0;Ce!==o;++Ce){const Ne=i[fe+Ce];if(Ne!==i[de+Ce]||Ne!==i[ve+Ce]){J=!0;break}}}if(J){if(I!==w){e[w]=e[I];const fe=I*o,de=w*o;for(let ve=0;ve!==o;++ve)i[de+ve]=i[fe+ve]}++w}}if(d>0){e[w]=e[d];for(let I=d*o,J=w*o,ee=0;ee!==o;++ee)i[J+ee]=i[I+ee];++w}return w!==e.length?(this.times=Gi.arraySlice(e,0,w),this.values=Gi.arraySlice(i,0,w*o)):(this.times=e,this.values=i),this}clone(){const e=Gi.arraySlice(this.times,0),i=Gi.arraySlice(this.values,0),o=this.constructor,l=new o(this.name,e,i);return l.createInterpolant=this.createInterpolant,l}}ks.prototype.TimeBufferType=Float32Array,ks.prototype.ValueBufferType=Float32Array,ks.prototype.DefaultInterpolation=cu;class uc extends ks{}uc.prototype.ValueTypeName="bool",uc.prototype.ValueBufferType=Array,uc.prototype.DefaultInterpolation=lu,uc.prototype.InterpolantFactoryMethodLinear=void 0,uc.prototype.InterpolantFactoryMethodSmooth=void 0;class n0 extends ks{}n0.prototype.ValueTypeName="color";class kh extends ks{}kh.prototype.ValueTypeName="number";class Pg extends Eu{constructor(e,i,o,l){super(e,i,o,l)}interpolate_(e,i,o,l){const d=this.resultBuffer,w=this.sampleValues,I=this.valueSize,J=(o-i)/(l-i);let ee=e*I;for(let he=ee+I;ee!==he;ee+=4)ha.slerpFlat(d,0,w,ee-I,w,ee,J);return d}}class Tf extends ks{InterpolantFactoryMethodLinear(e){return new Pg(this.times,this.values,this.getValueSize(),e)}}Tf.prototype.ValueTypeName="quaternion",Tf.prototype.DefaultInterpolation=cu,Tf.prototype.InterpolantFactoryMethodSmooth=void 0;class lc extends ks{}lc.prototype.ValueTypeName="string",lc.prototype.ValueBufferType=Array,lc.prototype.DefaultInterpolation=lu,lc.prototype.InterpolantFactoryMethodLinear=void 0,lc.prototype.InterpolantFactoryMethodSmooth=void 0;class Dh extends ks{}Dh.prototype.ValueTypeName="vector";class Sf{constructor(e,i=-1,o,l=ki){this.name=e,this.tracks=o,this.duration=i,this.blendMode=l,this.uuid=os(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],o=e.tracks,l=1/(e.fps||1);for(let w=0,I=o.length;w!==I;++w)i.push(fm(o[w]).scale(l));const d=new this(e.name,e.duration,i,e.blendMode);return d.uuid=e.uuid,d}static toJSON(e){const i=[],o=e.tracks,l={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let d=0,w=o.length;d!==w;++d)i.push(ks.toJSON(o[d]));return l}static CreateFromMorphTargetSequence(e,i,o,l){const d=i.length,w=[];for(let I=0;I<d;I++){let J=[],ee=[];J.push((I+d-1)%d,I,(I+1)%d),ee.push(0,1,0);const he=Gi.getKeyframeOrder(J);J=Gi.sortedArray(J,1,he),ee=Gi.sortedArray(ee,1,he),!l&&J[0]===0&&(J.push(d),ee.push(ee[0])),w.push(new kh(".morphTargetInfluences["+i[I].name+"]",J,ee).scale(1/o))}return new this(e,-1,w)}static findByName(e,i){let o=e;if(!Array.isArray(e)){const l=e;o=l.geometry&&l.geometry.animations||l.animations}for(let l=0;l<o.length;l++)if(o[l].name===i)return o[l];return null}static CreateClipsFromMorphTargetSequences(e,i,o){const l={},d=/^([\w-]*?)([\d]+)$/;for(let I=0,J=e.length;I<J;I++){const ee=e[I],he=ee.name.match(d);if(he&&he.length>1){const fe=he[1];let de=l[fe];de||(l[fe]=de=[]),de.push(ee)}}const w=[];for(const I in l)w.push(this.CreateFromMorphTargetSequence(I,l[I],i,o));return w}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const o=function(fe,de,ve,Ce,Ne){if(ve.length!==0){const Ke=[],Oe=[];Gi.flattenJSON(ve,Ke,Oe,Ce),Ke.length!==0&&Ne.push(new fe(de,Ke,Oe))}},l=[],d=e.name||"default",w=e.fps||30,I=e.blendMode;let J=e.length||-1;const ee=e.hierarchy||[];for(let fe=0;fe<ee.length;fe++){const de=ee[fe].keys;if(!(!de||de.length===0))if(de[0].morphTargets){const ve={};let Ce;for(Ce=0;Ce<de.length;Ce++)if(de[Ce].morphTargets)for(let Ne=0;Ne<de[Ce].morphTargets.length;Ne++)ve[de[Ce].morphTargets[Ne]]=-1;for(const Ne in ve){const Ke=[],Oe=[];for(let xe=0;xe!==de[Ce].morphTargets.length;++xe){const ut=de[Ce];Ke.push(ut.time),Oe.push(ut.morphTarget===Ne?1:0)}l.push(new kh(".morphTargetInfluence["+Ne+"]",Ke,Oe))}J=ve.length*(w||1)}else{const ve=".bones["+i[fe].name+"]";o(Dh,ve+".position",de,"pos",l),o(Tf,ve+".quaternion",de,"rot",l),o(Dh,ve+".scale",de,"scl",l)}}return l.length===0?null:new this(d,J,l,I)}resetDuration(){const e=this.tracks;let i=0;for(let o=0,l=e.length;o!==l;++o){const d=this.tracks[o];i=Math.max(i,d.times[d.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function r_(f){switch(f.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return kh;case"vector":case"vector2":case"vector3":case"vector4":return Dh;case"color":return n0;case"quaternion":return Tf;case"bool":case"boolean":return uc;case"string":return lc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+f)}function fm(f){if(f.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=r_(f.type);if(f.times===void 0){const i=[],o=[];Gi.flattenJSON(f.keys,i,o,"value"),f.times=i,f.values=o}return e.parse!==void 0?e.parse(f):new e(f.name,f.times,f.values,f.interpolation)}const cc={enabled:!1,files:{},add:function(f,e){this.enabled!==!1&&(this.files[f]=e)},get:function(f){if(this.enabled!==!1)return this.files[f]},remove:function(f){delete this.files[f]},clear:function(){this.files={}}};class hm{constructor(e,i,o){const l=this;let d=!1,w=0,I=0,J;const ee=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=o,this.itemStart=function(he){I++,d===!1&&l.onStart!==void 0&&l.onStart(he,w,I),d=!0},this.itemEnd=function(he){w++,l.onProgress!==void 0&&l.onProgress(he,w,I),w===I&&(d=!1,l.onLoad!==void 0&&l.onLoad())},this.itemError=function(he){l.onError!==void 0&&l.onError(he)},this.resolveURL=function(he){return J?J(he):he},this.setURLModifier=function(he){return J=he,this},this.addHandler=function(he,fe){return ee.push(he,fe),this},this.removeHandler=function(he){const fe=ee.indexOf(he);return fe!==-1&&ee.splice(fe,2),this},this.getHandler=function(he){for(let fe=0,de=ee.length;fe<de;fe+=2){const ve=ee[fe],Ce=ee[fe+1];if(ve.global&&(ve.lastIndex=0),ve.test(he))return Ce}return null}}}const Lg=new hm;class hs{constructor(e){this.manager=e!==void 0?e:Lg,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const o=this;return new Promise(function(l,d){o.load(e,l,i,d)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Tu={};class Qo extends hs{constructor(e){super(e)}load(e,i,o,l){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const d=cc.get(e);if(d!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(d),this.manager.itemEnd(e)},0),d;if(Tu[e]!==void 0){Tu[e].push({onLoad:i,onProgress:o,onError:l});return}Tu[e]=[],Tu[e].push({onLoad:i,onProgress:o,onError:l});const w=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),I=this.mimeType,J=this.responseType;fetch(w).then(ee=>{if(ee.status===200||ee.status===0){if(ee.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||ee.body.getReader===void 0)return ee;const he=Tu[e],fe=ee.body.getReader(),de=ee.headers.get("Content-Length"),ve=de?parseInt(de):0,Ce=ve!==0;let Ne=0;const Ke=new ReadableStream({start(Oe){xe();function xe(){fe.read().then(({done:ut,value:rt})=>{if(ut)Oe.close();else{Ne+=rt.byteLength;const ft=new ProgressEvent("progress",{lengthComputable:Ce,loaded:Ne,total:ve});for(let Mt=0,Rt=he.length;Mt<Rt;Mt++){const kt=he[Mt];kt.onProgress&&kt.onProgress(ft)}Oe.enqueue(rt),xe()}})}}});return new Response(Ke)}else throw Error(`fetch for "${ee.url}" responded with ${ee.status}: ${ee.statusText}`)}).then(ee=>{switch(J){case"arraybuffer":return ee.arrayBuffer();case"blob":return ee.blob();case"document":return ee.text().then(he=>new DOMParser().parseFromString(he,I));case"json":return ee.json();default:if(I===void 0)return ee.text();{const fe=/charset="?([^;"\s]*)"?/i.exec(I),de=fe&&fe[1]?fe[1].toLowerCase():void 0,ve=new TextDecoder(de);return ee.arrayBuffer().then(Ce=>ve.decode(Ce))}}}).then(ee=>{cc.add(e,ee);const he=Tu[e];delete Tu[e];for(let fe=0,de=he.length;fe<de;fe++){const ve=he[fe];ve.onLoad&&ve.onLoad(ee)}}).catch(ee=>{const he=Tu[e];if(he===void 0)throw this.manager.itemError(e),ee;delete Tu[e];for(let fe=0,de=he.length;fe<de;fe++){const ve=he[fe];ve.onError&&ve.onError(ee)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class n_ extends hs{constructor(e){super(e)}load(e,i,o,l){const d=this,w=new Qo(this.manager);w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials),w.load(e,function(I){try{i(d.parse(JSON.parse(I)))}catch(J){l?l(J):console.error(J),d.manager.itemError(e)}},o,l)}parse(e){const i=[];for(let o=0;o<e.length;o++){const l=Sf.parse(e[o]);i.push(l)}return i}}class i_ extends hs{constructor(e){super(e)}load(e,i,o,l){const d=this,w=[],I=new Wp,J=new Qo(this.manager);J.setPath(this.path),J.setResponseType("arraybuffer"),J.setRequestHeader(this.requestHeader),J.setWithCredentials(d.withCredentials);let ee=0;function he(fe){J.load(e[fe],function(de){const ve=d.parse(de,!0);w[fe]={width:ve.width,height:ve.height,format:ve.format,mipmaps:ve.mipmaps},ee+=1,ee===6&&(ve.mipmapCount===1&&(I.minFilter=at),I.image=w,I.format=ve.format,I.needsUpdate=!0,i&&i(I))},o,l)}if(Array.isArray(e))for(let fe=0,de=e.length;fe<de;++fe)he(fe);else J.load(e,function(fe){const de=d.parse(fe,!0);if(de.isCubemap){const ve=de.mipmaps.length/de.mipmapCount;for(let Ce=0;Ce<ve;Ce++){w[Ce]={mipmaps:[]};for(let Ne=0;Ne<de.mipmapCount;Ne++)w[Ce].mipmaps.push(de.mipmaps[Ce*de.mipmapCount+Ne]),w[Ce].format=de.format,w[Ce].width=de.width,w[Ce].height=de.height}I.image=w}else I.image.width=de.width,I.image.height=de.height,I.mipmaps=de.mipmaps;de.mipmapCount===1&&(I.minFilter=at),I.format=de.format,I.needsUpdate=!0,i&&i(I)},o,l);return I}}class i0 extends hs{constructor(e){super(e)}load(e,i,o,l){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const d=this,w=cc.get(e);if(w!==void 0)return d.manager.itemStart(e),setTimeout(function(){i&&i(w),d.manager.itemEnd(e)},0),w;const I=$n("img");function J(){he(),cc.add(e,this),i&&i(this),d.manager.itemEnd(e)}function ee(fe){he(),l&&l(fe),d.manager.itemError(e),d.manager.itemEnd(e)}function he(){I.removeEventListener("load",J,!1),I.removeEventListener("error",ee,!1)}return I.addEventListener("load",J,!1),I.addEventListener("error",ee,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(I.crossOrigin=this.crossOrigin),d.manager.itemStart(e),I.src=e,I}}class Og extends hs{constructor(e){super(e)}load(e,i,o,l){const d=new $u,w=new i0(this.manager);w.setCrossOrigin(this.crossOrigin),w.setPath(this.path);let I=0;function J(ee){w.load(e[ee],function(he){d.images[ee]=he,I++,I===6&&(d.needsUpdate=!0,i&&i(d))},void 0,l)}for(let ee=0;ee<e.length;++ee)J(ee);return d}}class Fg extends hs{constructor(e){super(e)}load(e,i,o,l){const d=this,w=new tc,I=new Qo(this.manager);return I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setPath(this.path),I.setWithCredentials(d.withCredentials),I.load(e,function(J){const ee=d.parse(J);!ee||(ee.image!==void 0?w.image=ee.image:ee.data!==void 0&&(w.image.width=ee.width,w.image.height=ee.height,w.image.data=ee.data),w.wrapS=ee.wrapS!==void 0?ee.wrapS:Ie,w.wrapT=ee.wrapT!==void 0?ee.wrapT:Ie,w.magFilter=ee.magFilter!==void 0?ee.magFilter:at,w.minFilter=ee.minFilter!==void 0?ee.minFilter:at,w.anisotropy=ee.anisotropy!==void 0?ee.anisotropy:1,ee.encoding!==void 0&&(w.encoding=ee.encoding),ee.flipY!==void 0&&(w.flipY=ee.flipY),ee.format!==void 0&&(w.format=ee.format),ee.type!==void 0&&(w.type=ee.type),ee.mipmaps!==void 0&&(w.mipmaps=ee.mipmaps,w.minFilter=_t),ee.mipmapCount===1&&(w.minFilter=at),ee.generateMipmaps!==void 0&&(w.generateMipmaps=ee.generateMipmaps),w.needsUpdate=!0,i&&i(w,ee))},o,l),w}}class Ig extends hs{constructor(e){super(e)}load(e,i,o,l){const d=new Cn,w=new i0(this.manager);return w.setCrossOrigin(this.crossOrigin),w.setPath(this.path),w.load(e,function(I){d.image=I,d.needsUpdate=!0,i!==void 0&&i(d)},o,l),d}}class Ao extends Gn{constructor(e,i=1){super(),this.type="Light",this.color=new Or(e),this.intensity=i}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}Ao.prototype.isLight=!0;class fc extends Ao{constructor(e,i,o){super(e,o),this.type="HemisphereLight",this.position.copy(Gn.DefaultUp),this.updateMatrix(),this.groundColor=new Or(i)}copy(e){return Ao.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}fc.prototype.isHemisphereLight=!0;const kg=new jr,Dg=new dt,Ng=new dt;class dm{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new We(512,512),this.map=null,this.mapPass=null,this.matrix=new jr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ba,this._frameExtents=new We(1,1),this._viewportCount=1,this._viewports=[new cn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,o=this.matrix;Dg.setFromMatrixPosition(e.matrixWorld),i.position.copy(Dg),Ng.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(Ng),i.updateMatrixWorld(),kg.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kg),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(i.projectionMatrix),o.multiply(i.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Bg extends dm{constructor(){super(new da(50,1,.5,500)),this.focus=1}updateMatrices(e){const i=this.camera,o=Al*2*e.angle*this.focus,l=this.mapSize.width/this.mapSize.height,d=e.distance||i.far;(o!==i.fov||l!==i.aspect||d!==i.far)&&(i.fov=o,i.aspect=l,i.far=d,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Bg.prototype.isSpotLightShadow=!0;class pm extends Ao{constructor(e,i,o=0,l=Math.PI/3,d=0,w=1){super(e,i),this.type="SpotLight",this.position.copy(Gn.DefaultUp),this.updateMatrix(),this.target=new Gn,this.distance=o,this.angle=l,this.penumbra=d,this.decay=w,this.shadow=new Bg}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}pm.prototype.isSpotLight=!0;const Ug=new jr,Nh=new dt,mm=new dt;class zg extends dm{constructor(){super(new da(90,1,.5,500)),this._frameExtents=new We(4,2),this._viewportCount=6,this._viewports=[new cn(2,1,1,1),new cn(0,1,1,1),new cn(3,1,1,1),new cn(1,1,1,1),new cn(3,0,1,1),new cn(1,0,1,1)],this._cubeDirections=[new dt(1,0,0),new dt(-1,0,0),new dt(0,0,1),new dt(0,0,-1),new dt(0,1,0),new dt(0,-1,0)],this._cubeUps=[new dt(0,1,0),new dt(0,1,0),new dt(0,1,0),new dt(0,1,0),new dt(0,0,1),new dt(0,0,-1)]}updateMatrices(e,i=0){const o=this.camera,l=this.matrix,d=e.distance||o.far;d!==o.far&&(o.far=d,o.updateProjectionMatrix()),Nh.setFromMatrixPosition(e.matrixWorld),o.position.copy(Nh),mm.copy(o.position),mm.add(this._cubeDirections[i]),o.up.copy(this._cubeUps[i]),o.lookAt(mm),o.updateMatrixWorld(),l.makeTranslation(-Nh.x,-Nh.y,-Nh.z),Ug.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ug)}}zg.prototype.isPointLightShadow=!0;class vm extends Ao{constructor(e,i,o=0,l=1){super(e,i),this.type="PointLight",this.distance=o,this.decay=l,this.shadow=new zg}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}vm.prototype.isPointLight=!0;class Gg extends dm{constructor(){super(new rf(-5,5,5,-5,.5,500))}}Gg.prototype.isDirectionalLightShadow=!0;class gm extends Ao{constructor(e,i){super(e,i),this.type="DirectionalLight",this.position.copy(Gn.DefaultUp),this.updateMatrix(),this.target=new Gn,this.shadow=new Gg}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}gm.prototype.isDirectionalLight=!0;class ym extends Ao{constructor(e,i){super(e,i),this.type="AmbientLight"}}ym.prototype.isAmbientLight=!0;class _m extends Ao{constructor(e,i,o=10,l=10){super(e,i),this.type="RectAreaLight",this.width=o,this.height=l}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}_m.prototype.isRectAreaLight=!0;class xm{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new dt)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const o=e.x,l=e.y,d=e.z,w=this.coefficients;return i.copy(w[0]).multiplyScalar(.282095),i.addScaledVector(w[1],.488603*l),i.addScaledVector(w[2],.488603*d),i.addScaledVector(w[3],.488603*o),i.addScaledVector(w[4],1.092548*(o*l)),i.addScaledVector(w[5],1.092548*(l*d)),i.addScaledVector(w[6],.315392*(3*d*d-1)),i.addScaledVector(w[7],1.092548*(o*d)),i.addScaledVector(w[8],.546274*(o*o-l*l)),i}getIrradianceAt(e,i){const o=e.x,l=e.y,d=e.z,w=this.coefficients;return i.copy(w[0]).multiplyScalar(.886227),i.addScaledVector(w[1],2*.511664*l),i.addScaledVector(w[2],2*.511664*d),i.addScaledVector(w[3],2*.511664*o),i.addScaledVector(w[4],2*.429043*o*l),i.addScaledVector(w[5],2*.429043*l*d),i.addScaledVector(w[6],.743125*d*d-.247708),i.addScaledVector(w[7],2*.429043*o*d),i.addScaledVector(w[8],.429043*(o*o-l*l)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let o=0;o<9;o++)this.coefficients[o].addScaledVector(e.coefficients[o],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let o=0;o<9;o++)this.coefficients[o].lerp(e.coefficients[o],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const o=this.coefficients;for(let l=0;l<9;l++)o[l].fromArray(e,i+l*3);return this}toArray(e=[],i=0){const o=this.coefficients;for(let l=0;l<9;l++)o[l].toArray(e,i+l*3);return e}static getBasisAt(e,i){const o=e.x,l=e.y,d=e.z;i[0]=.282095,i[1]=.488603*l,i[2]=.488603*d,i[3]=.488603*o,i[4]=1.092548*o*l,i[5]=1.092548*l*d,i[6]=.315392*(3*d*d-1),i[7]=1.092548*o*d,i[8]=.546274*(o*o-l*l)}}xm.prototype.isSphericalHarmonics3=!0;class Bh extends Ao{constructor(e=new xm,i=1){super(void 0,i),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}Bh.prototype.isLightProbe=!0;class Vg extends hs{constructor(e){super(e),this.textures={}}load(e,i,o,l){const d=this,w=new Qo(d.manager);w.setPath(d.path),w.setRequestHeader(d.requestHeader),w.setWithCredentials(d.withCredentials),w.load(e,function(I){try{i(d.parse(JSON.parse(I)))}catch(J){l?l(J):console.error(J),d.manager.itemError(e)}},o,l)}parse(e){const i=this.textures;function o(d){return i[d]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",d),i[d]}const l=new t_[e.type];if(e.uuid!==void 0&&(l.uuid=e.uuid),e.name!==void 0&&(l.name=e.name),e.color!==void 0&&l.color!==void 0&&l.color.setHex(e.color),e.roughness!==void 0&&(l.roughness=e.roughness),e.metalness!==void 0&&(l.metalness=e.metalness),e.sheen!==void 0&&(l.sheen=e.sheen),e.sheenColor!==void 0&&(l.sheenColor=new Or().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(l.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&l.emissive!==void 0&&l.emissive.setHex(e.emissive),e.specular!==void 0&&l.specular!==void 0&&l.specular.setHex(e.specular),e.specularIntensity!==void 0&&(l.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&l.specularColor!==void 0&&l.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(l.shininess=e.shininess),e.clearcoat!==void 0&&(l.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(l.clearcoatRoughness=e.clearcoatRoughness),e.transmission!==void 0&&(l.transmission=e.transmission),e.thickness!==void 0&&(l.thickness=e.thickness),e.attenuationDistance!==void 0&&(l.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&l.attenuationColor!==void 0&&l.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(l.fog=e.fog),e.flatShading!==void 0&&(l.flatShading=e.flatShading),e.blending!==void 0&&(l.blending=e.blending),e.combine!==void 0&&(l.combine=e.combine),e.side!==void 0&&(l.side=e.side),e.shadowSide!==void 0&&(l.shadowSide=e.shadowSide),e.opacity!==void 0&&(l.opacity=e.opacity),e.transparent!==void 0&&(l.transparent=e.transparent),e.alphaTest!==void 0&&(l.alphaTest=e.alphaTest),e.depthTest!==void 0&&(l.depthTest=e.depthTest),e.depthWrite!==void 0&&(l.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(l.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(l.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(l.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(l.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(l.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(l.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(l.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(l.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(l.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(l.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(l.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(l.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(l.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(l.rotation=e.rotation),e.linewidth!==1&&(l.linewidth=e.linewidth),e.dashSize!==void 0&&(l.dashSize=e.dashSize),e.gapSize!==void 0&&(l.gapSize=e.gapSize),e.scale!==void 0&&(l.scale=e.scale),e.polygonOffset!==void 0&&(l.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(l.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(l.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(l.dithering=e.dithering),e.alphaToCoverage!==void 0&&(l.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(l.premultipliedAlpha=e.premultipliedAlpha),e.visible!==void 0&&(l.visible=e.visible),e.toneMapped!==void 0&&(l.toneMapped=e.toneMapped),e.userData!==void 0&&(l.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?l.vertexColors=e.vertexColors>0:l.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const d in e.uniforms){const w=e.uniforms[d];switch(l.uniforms[d]={},w.type){case"t":l.uniforms[d].value=o(w.value);break;case"c":l.uniforms[d].value=new Or().setHex(w.value);break;case"v2":l.uniforms[d].value=new We().fromArray(w.value);break;case"v3":l.uniforms[d].value=new dt().fromArray(w.value);break;case"v4":l.uniforms[d].value=new cn().fromArray(w.value);break;case"m3":l.uniforms[d].value=new Yt().fromArray(w.value);break;case"m4":l.uniforms[d].value=new jr().fromArray(w.value);break;default:l.uniforms[d].value=w.value}}if(e.defines!==void 0&&(l.defines=e.defines),e.vertexShader!==void 0&&(l.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(l.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(const d in e.extensions)l.extensions[d]=e.extensions[d];if(e.shading!==void 0&&(l.flatShading=e.shading===1),e.size!==void 0&&(l.size=e.size),e.sizeAttenuation!==void 0&&(l.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(l.map=o(e.map)),e.matcap!==void 0&&(l.matcap=o(e.matcap)),e.alphaMap!==void 0&&(l.alphaMap=o(e.alphaMap)),e.bumpMap!==void 0&&(l.bumpMap=o(e.bumpMap)),e.bumpScale!==void 0&&(l.bumpScale=e.bumpScale),e.normalMap!==void 0&&(l.normalMap=o(e.normalMap)),e.normalMapType!==void 0&&(l.normalMapType=e.normalMapType),e.normalScale!==void 0){let d=e.normalScale;Array.isArray(d)===!1&&(d=[d,d]),l.normalScale=new We().fromArray(d)}return e.displacementMap!==void 0&&(l.displacementMap=o(e.displacementMap)),e.displacementScale!==void 0&&(l.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(l.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(l.roughnessMap=o(e.roughnessMap)),e.metalnessMap!==void 0&&(l.metalnessMap=o(e.metalnessMap)),e.emissiveMap!==void 0&&(l.emissiveMap=o(e.emissiveMap)),e.emissiveIntensity!==void 0&&(l.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(l.specularMap=o(e.specularMap)),e.specularIntensityMap!==void 0&&(l.specularIntensityMap=o(e.specularIntensityMap)),e.specularColorMap!==void 0&&(l.specularColorMap=o(e.specularColorMap)),e.envMap!==void 0&&(l.envMap=o(e.envMap)),e.envMapIntensity!==void 0&&(l.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(l.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(l.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(l.lightMap=o(e.lightMap)),e.lightMapIntensity!==void 0&&(l.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(l.aoMap=o(e.aoMap)),e.aoMapIntensity!==void 0&&(l.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(l.gradientMap=o(e.gradientMap)),e.clearcoatMap!==void 0&&(l.clearcoatMap=o(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(l.clearcoatRoughnessMap=o(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(l.clearcoatNormalMap=o(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(l.clearcoatNormalScale=new We().fromArray(e.clearcoatNormalScale)),e.transmissionMap!==void 0&&(l.transmissionMap=o(e.transmissionMap)),e.thicknessMap!==void 0&&(l.thicknessMap=o(e.thicknessMap)),e.sheenColorMap!==void 0&&(l.sheenColorMap=o(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(l.sheenRoughnessMap=o(e.sheenRoughnessMap)),l}setTextures(e){return this.textures=e,this}}class a0{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let o=0,l=e.length;o<l;o++)i+=String.fromCharCode(e[o]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.substr(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class Am extends An{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Am.prototype.isInstancedBufferGeometry=!0;class s0 extends hs{constructor(e){super(e)}load(e,i,o,l){const d=this,w=new Qo(d.manager);w.setPath(d.path),w.setRequestHeader(d.requestHeader),w.setWithCredentials(d.withCredentials),w.load(e,function(I){try{i(d.parse(JSON.parse(I)))}catch(J){l?l(J):console.error(J),d.manager.itemError(e)}},o,l)}parse(e){const i={},o={};function l(ve,Ce){if(i[Ce]!==void 0)return i[Ce];const Ke=ve.interleavedBuffers[Ce],Oe=d(ve,Ke.buffer),xe=Nt(Ke.type,Oe),ut=new $l(xe,Ke.stride);return ut.uuid=Ke.uuid,i[Ce]=ut,ut}function d(ve,Ce){if(o[Ce]!==void 0)return o[Ce];const Ke=ve.arrayBuffers[Ce],Oe=new Uint32Array(Ke).buffer;return o[Ce]=Oe,Oe}const w=e.isInstancedBufferGeometry?new Am:new An,I=e.data.index;if(I!==void 0){const ve=Nt(I.type,I.array);w.setIndex(new ti(ve,1))}const J=e.data.attributes;for(const ve in J){const Ce=J[ve];let Ne;if(Ce.isInterleavedBufferAttribute){const Ke=l(e.data,Ce.data);Ne=new il(Ke,Ce.itemSize,Ce.offset,Ce.normalized)}else{const Ke=Nt(Ce.type,Ce.array),Oe=Ce.isInstancedBufferAttribute?rc:ti;Ne=new Oe(Ke,Ce.itemSize,Ce.normalized)}Ce.name!==void 0&&(Ne.name=Ce.name),Ce.usage!==void 0&&Ne.setUsage(Ce.usage),Ce.updateRange!==void 0&&(Ne.updateRange.offset=Ce.updateRange.offset,Ne.updateRange.count=Ce.updateRange.count),w.setAttribute(ve,Ne)}const ee=e.data.morphAttributes;if(ee)for(const ve in ee){const Ce=ee[ve],Ne=[];for(let Ke=0,Oe=Ce.length;Ke<Oe;Ke++){const xe=Ce[Ke];let ut;if(xe.isInterleavedBufferAttribute){const rt=l(e.data,xe.data);ut=new il(rt,xe.itemSize,xe.offset,xe.normalized)}else{const rt=Nt(xe.type,xe.array);ut=new ti(rt,xe.itemSize,xe.normalized)}xe.name!==void 0&&(ut.name=xe.name),Ne.push(ut)}w.morphAttributes[ve]=Ne}e.data.morphTargetsRelative&&(w.morphTargetsRelative=!0);const fe=e.data.groups||e.data.drawcalls||e.data.offsets;if(fe!==void 0)for(let ve=0,Ce=fe.length;ve!==Ce;++ve){const Ne=fe[ve];w.addGroup(Ne.start,Ne.count,Ne.materialIndex)}const de=e.data.boundingSphere;if(de!==void 0){const ve=new dt;de.center!==void 0&&ve.fromArray(de.center),w.boundingSphere=new mu(ve,de.radius)}return e.name&&(w.name=e.name),e.userData&&(w.userData=e.userData),w}}class a_ extends hs{constructor(e){super(e)}load(e,i,o,l){const d=this,w=this.path===""?a0.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||w;const I=new Qo(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.setWithCredentials(this.withCredentials),I.load(e,function(J){let ee=null;try{ee=JSON.parse(J)}catch(fe){l!==void 0&&l(fe),console.error("THREE:ObjectLoader: Can't parse "+e+".",fe.message);return}const he=ee.metadata;if(he===void 0||he.type===void 0||he.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}d.parse(ee,i)},o,l)}async loadAsync(e,i){const o=this,l=this.path===""?a0.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||l;const d=new Qo(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials);const w=await d.loadAsync(e,i),I=JSON.parse(w),J=I.metadata;if(J===void 0||J.type===void 0||J.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await o.parseAsync(I)}parse(e,i){const o=this.parseAnimations(e.animations),l=this.parseShapes(e.shapes),d=this.parseGeometries(e.geometries,l),w=this.parseImages(e.images,function(){i!==void 0&&i(ee)}),I=this.parseTextures(e.textures,w),J=this.parseMaterials(e.materials,I),ee=this.parseObject(e.object,d,J,I,o),he=this.parseSkeletons(e.skeletons,ee);if(this.bindSkeletons(ee,he),i!==void 0){let fe=!1;for(const de in w)if(w[de]instanceof HTMLImageElement){fe=!0;break}fe===!1&&i(ee)}return ee}async parseAsync(e){const i=this.parseAnimations(e.animations),o=this.parseShapes(e.shapes),l=this.parseGeometries(e.geometries,o),d=await this.parseImagesAsync(e.images),w=this.parseTextures(e.textures,d),I=this.parseMaterials(e.materials,w),J=this.parseObject(e.object,l,I,w,i),ee=this.parseSkeletons(e.skeletons,J);return this.bindSkeletons(J,ee),J}parseShapes(e){const i={};if(e!==void 0)for(let o=0,l=e.length;o<l;o++){const d=new Jo().fromJSON(e[o]);i[d.uuid]=d}return i}parseSkeletons(e,i){const o={},l={};if(i.traverse(function(d){d.isBone&&(l[d.uuid]=d)}),e!==void 0)for(let d=0,w=e.length;d<w;d++){const I=new _h().fromJSON(e[d],l);o[I.uuid]=I}return o}parseGeometries(e,i){const o={};if(e!==void 0){const l=new s0;for(let d=0,w=e.length;d<w;d++){let I;const J=e[d];switch(J.type){case"BufferGeometry":case"InstancedBufferGeometry":I=l.parse(J);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:J.type in tm?I=tm[J.type].fromJSON(J,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${J.type}"`)}I.uuid=J.uuid,J.name!==void 0&&(I.name=J.name),I.isBufferGeometry===!0&&J.userData!==void 0&&(I.userData=J.userData),o[J.uuid]=I}}return o}parseMaterials(e,i){const o={},l={};if(e!==void 0){const d=new Vg;d.setTextures(i);for(let w=0,I=e.length;w<I;w++){const J=e[w];if(J.type==="MultiMaterial"){const ee=[];for(let he=0;he<J.materials.length;he++){const fe=J.materials[he];o[fe.uuid]===void 0&&(o[fe.uuid]=d.parse(fe)),ee.push(o[fe.uuid])}l[J.uuid]=ee}else o[J.uuid]===void 0&&(o[J.uuid]=d.parse(J)),l[J.uuid]=o[J.uuid]}}return l}parseAnimations(e){const i={};if(e!==void 0)for(let o=0;o<e.length;o++){const l=e[o],d=Sf.parse(l);i[d.uuid]=d}return i}parseImages(e,i){const o=this,l={};let d;function w(J){return o.manager.itemStart(J),d.load(J,function(){o.manager.itemEnd(J)},void 0,function(){o.manager.itemError(J),o.manager.itemEnd(J)})}function I(J){if(typeof J=="string"){const ee=J,he=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ee)?ee:o.resourcePath+ee;return w(he)}else return J.data?{data:Nt(J.type,J.data),width:J.width,height:J.height}:null}if(e!==void 0&&e.length>0){const J=new hm(i);d=new i0(J),d.setCrossOrigin(this.crossOrigin);for(let ee=0,he=e.length;ee<he;ee++){const fe=e[ee],de=fe.url;if(Array.isArray(de)){l[fe.uuid]=[];for(let ve=0,Ce=de.length;ve<Ce;ve++){const Ne=de[ve],Ke=I(Ne);Ke!==null&&(Ke instanceof HTMLImageElement?l[fe.uuid].push(Ke):l[fe.uuid].push(new tc(Ke.data,Ke.width,Ke.height)))}}else{const ve=I(fe.url);ve!==null&&(l[fe.uuid]=ve)}}}return l}async parseImagesAsync(e){const i=this,o={};let l;async function d(w){if(typeof w=="string"){const I=w,J=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(I)?I:i.resourcePath+I;return await l.loadAsync(J)}else return w.data?{data:Nt(w.type,w.data),width:w.width,height:w.height}:null}if(e!==void 0&&e.length>0){l=new i0(this.manager),l.setCrossOrigin(this.crossOrigin);for(let w=0,I=e.length;w<I;w++){const J=e[w],ee=J.url;if(Array.isArray(ee)){o[J.uuid]=[];for(let he=0,fe=ee.length;he<fe;he++){const de=ee[he],ve=await d(de);ve!==null&&(ve instanceof HTMLImageElement?o[J.uuid].push(ve):o[J.uuid].push(new tc(ve.data,ve.width,ve.height)))}}else{const he=await d(J.url);he!==null&&(o[J.uuid]=he)}}}return o}parseTextures(e,i){function o(d,w){return typeof d=="number"?d:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",d),w[d])}const l={};if(e!==void 0)for(let d=0,w=e.length;d<w;d++){const I=e[d];I.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',I.uuid),i[I.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",I.image);let J;const ee=i[I.image];Array.isArray(ee)?(J=new $u(ee),ee.length===6&&(J.needsUpdate=!0)):(ee&&ee.data?J=new tc(ee.data,ee.width,ee.height):J=new Cn(ee),ee&&(J.needsUpdate=!0)),J.uuid=I.uuid,I.name!==void 0&&(J.name=I.name),I.mapping!==void 0&&(J.mapping=o(I.mapping,wm)),I.offset!==void 0&&J.offset.fromArray(I.offset),I.repeat!==void 0&&J.repeat.fromArray(I.repeat),I.center!==void 0&&J.center.fromArray(I.center),I.rotation!==void 0&&(J.rotation=I.rotation),I.wrap!==void 0&&(J.wrapS=o(I.wrap[0],Wg),J.wrapT=o(I.wrap[1],Wg)),I.format!==void 0&&(J.format=I.format),I.type!==void 0&&(J.type=I.type),I.encoding!==void 0&&(J.encoding=I.encoding),I.minFilter!==void 0&&(J.minFilter=o(I.minFilter,Hg)),I.magFilter!==void 0&&(J.magFilter=o(I.magFilter,Hg)),I.anisotropy!==void 0&&(J.anisotropy=I.anisotropy),I.flipY!==void 0&&(J.flipY=I.flipY),I.premultiplyAlpha!==void 0&&(J.premultiplyAlpha=I.premultiplyAlpha),I.unpackAlignment!==void 0&&(J.unpackAlignment=I.unpackAlignment),I.userData!==void 0&&(J.userData=I.userData),l[I.uuid]=J}return l}parseObject(e,i,o,l,d){let w;function I(de){return i[de]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",de),i[de]}function J(de){if(de!==void 0){if(Array.isArray(de)){const ve=[];for(let Ce=0,Ne=de.length;Ce<Ne;Ce++){const Ke=de[Ce];o[Ke]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Ke),ve.push(o[Ke])}return ve}return o[de]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",de),o[de]}}function ee(de){return l[de]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",de),l[de]}let he,fe;switch(e.type){case"Scene":w=new nl,e.background!==void 0&&(Number.isInteger(e.background)?w.background=new Or(e.background):w.background=ee(e.background)),e.environment!==void 0&&(w.environment=ee(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?w.fog=new ph(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(w.fog=new dh(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":w=new da(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(w.focus=e.focus),e.zoom!==void 0&&(w.zoom=e.zoom),e.filmGauge!==void 0&&(w.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(w.filmOffset=e.filmOffset),e.view!==void 0&&(w.view=Object.assign({},e.view));break;case"OrthographicCamera":w=new rf(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(w.zoom=e.zoom),e.view!==void 0&&(w.view=Object.assign({},e.view));break;case"AmbientLight":w=new ym(e.color,e.intensity);break;case"DirectionalLight":w=new gm(e.color,e.intensity);break;case"PointLight":w=new vm(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":w=new _m(e.color,e.intensity,e.width,e.height);break;case"SpotLight":w=new pm(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":w=new fc(e.color,e.groundColor,e.intensity);break;case"LightProbe":w=new Bh().fromJSON(e);break;case"SkinnedMesh":he=I(e.geometry),fe=J(e.material),w=new hf(he,fe),e.bindMode!==void 0&&(w.bindMode=e.bindMode),e.bindMatrix!==void 0&&w.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(w.skeleton=e.skeleton);break;case"Mesh":he=I(e.geometry),fe=J(e.material),w=new ra(he,fe);break;case"InstancedMesh":he=I(e.geometry),fe=J(e.material);const de=e.count,ve=e.instanceMatrix,Ce=e.instanceColor;w=new Bp(he,fe,de),w.instanceMatrix=new rc(new Float32Array(ve.array),16),Ce!==void 0&&(w.instanceColor=new rc(new Float32Array(Ce.array),Ce.itemSize));break;case"LOD":w=new Kl;break;case"Line":w=new jo(I(e.geometry),J(e.material));break;case"LineLoop":w=new zp(I(e.geometry),J(e.material));break;case"LineSegments":w=new Ts(I(e.geometry),J(e.material));break;case"PointCloud":case"Points":w=new wh(I(e.geometry),J(e.material));break;case"Sprite":w=new Gd(J(e.material));break;case"Group":w=new Jl;break;case"Bone":w=new ec;break;default:w=new Gn}if(w.uuid=e.uuid,e.name!==void 0&&(w.name=e.name),e.matrix!==void 0?(w.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(w.matrixAutoUpdate=e.matrixAutoUpdate),w.matrixAutoUpdate&&w.matrix.decompose(w.position,w.quaternion,w.scale)):(e.position!==void 0&&w.position.fromArray(e.position),e.rotation!==void 0&&w.rotation.fromArray(e.rotation),e.quaternion!==void 0&&w.quaternion.fromArray(e.quaternion),e.scale!==void 0&&w.scale.fromArray(e.scale)),e.castShadow!==void 0&&(w.castShadow=e.castShadow),e.receiveShadow!==void 0&&(w.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(w.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(w.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(w.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&w.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(w.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(w.visible=e.visible),e.frustumCulled!==void 0&&(w.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(w.renderOrder=e.renderOrder),e.userData!==void 0&&(w.userData=e.userData),e.layers!==void 0&&(w.layers.mask=e.layers),e.children!==void 0){const de=e.children;for(let ve=0;ve<de.length;ve++)w.add(this.parseObject(de[ve],i,o,l,d))}if(e.animations!==void 0){const de=e.animations;for(let ve=0;ve<de.length;ve++){const Ce=de[ve];w.animations.push(d[Ce])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(w.autoUpdate=e.autoUpdate);const de=e.levels;for(let ve=0;ve<de.length;ve++){const Ce=de[ve],Ne=w.getObjectByProperty("uuid",Ce.object);Ne!==void 0&&w.addLevel(Ne,Ce.distance)}}return w}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(o){if(o.isSkinnedMesh===!0&&o.skeleton!==void 0){const l=i[o.skeleton];l===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",o.skeleton):o.bind(l,o.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const wm={UVMapping:Te,CubeReflectionMapping:me,CubeRefractionMapping:be,EquirectangularReflectionMapping:we,EquirectangularRefractionMapping:je,CubeUVReflectionMapping:lt,CubeUVRefractionMapping:ot},Wg={RepeatWrapping:bt,ClampToEdgeWrapping:Ie,MirroredRepeatWrapping:re},Hg={NearestFilter:oe,NearestMipmapNearestFilter:_e,NearestMipmapLinearFilter:ke,LinearFilter:at,LinearMipmapNearestFilter:wt,LinearMipmapLinearFilter:_t};class qg extends hs{constructor(e){super(e),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,o,l){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const d=this,w=cc.get(e);if(w!==void 0)return d.manager.itemStart(e),setTimeout(function(){i&&i(w),d.manager.itemEnd(e)},0),w;const I={};I.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",I.headers=this.requestHeader,fetch(e,I).then(function(J){return J.blob()}).then(function(J){return createImageBitmap(J,Object.assign(d.options,{colorSpaceConversion:"none"}))}).then(function(J){cc.add(e,J),i&&i(J),d.manager.itemEnd(e)}).catch(function(J){l&&l(J),d.manager.itemError(e),d.manager.itemEnd(e)}),d.manager.itemStart(e)}}qg.prototype.isImageBitmapLoader=!0;let o0;const Mm={getContext:function(){return o0===void 0&&(o0=new(window.AudioContext||window.webkitAudioContext)),o0},setContext:function(f){o0=f}};class Xg extends hs{constructor(e){super(e)}load(e,i,o,l){const d=this,w=new Qo(this.manager);w.setResponseType("arraybuffer"),w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials),w.load(e,function(I){try{const J=I.slice(0);Mm.getContext().decodeAudioData(J,function(he){i(he)})}catch(J){l?l(J):console.error(J),d.manager.itemError(e)}},o,l)}}class Zg extends Bh{constructor(e,i,o=1){super(void 0,o);const l=new Or().set(e),d=new Or().set(i),w=new dt(l.r,l.g,l.b),I=new dt(d.r,d.g,d.b),J=Math.sqrt(Math.PI),ee=J*Math.sqrt(.75);this.sh.coefficients[0].copy(w).add(I).multiplyScalar(J),this.sh.coefficients[1].copy(w).sub(I).multiplyScalar(ee)}}Zg.prototype.isHemisphereLightProbe=!0;class jg extends Bh{constructor(e,i=1){super(void 0,i);const o=new Or().set(e);this.sh.coefficients[0].set(o.r,o.g,o.b).multiplyScalar(2*Math.sqrt(Math.PI))}}jg.prototype.isAmbientLightProbe=!0;const Yg=new jr,Jg=new jr,hc=new jr;class s_{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new da,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new da,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,hc.copy(e.projectionMatrix);const l=i.eyeSep/2,d=l*i.near/i.focus,w=i.near*Math.tan(ja*i.fov*.5)/i.zoom;let I,J;Jg.elements[12]=-l,Yg.elements[12]=l,I=-w*i.aspect+d,J=w*i.aspect+d,hc.elements[0]=2*i.near/(J-I),hc.elements[8]=(J+I)/(J-I),this.cameraL.projectionMatrix.copy(hc),I=-w*i.aspect-d,J=w*i.aspect-d,hc.elements[0]=2*i.near/(J-I),hc.elements[8]=(J+I)/(J-I),this.cameraR.projectionMatrix.copy(hc)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Jg),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Yg)}}class $g{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Qg(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=Qg();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function Qg(){return(typeof performance>"u"?Date:performance).now()}const dc=new dt,bm=new ha,o_=new dt,pc=new dt;class u_ extends Gn{constructor(){super(),this.type="AudioListener",this.context=Mm.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new $g}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,o=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(dc,bm,o_),pc.set(0,0,-1).applyQuaternion(bm),i.positionX){const l=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(dc.x,l),i.positionY.linearRampToValueAtTime(dc.y,l),i.positionZ.linearRampToValueAtTime(dc.z,l),i.forwardX.linearRampToValueAtTime(pc.x,l),i.forwardY.linearRampToValueAtTime(pc.y,l),i.forwardZ.linearRampToValueAtTime(pc.z,l),i.upX.linearRampToValueAtTime(o.x,l),i.upY.linearRampToValueAtTime(o.y,l),i.upZ.linearRampToValueAtTime(o.z,l)}else i.setPosition(dc.x,dc.y,dc.z),i.setOrientation(pc.x,pc.y,pc.z,o.x,o.y,o.z)}}class Em extends Gn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const mc=new dt,Kg=new ha,l_=new dt,vc=new dt;class c_ extends Em{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,o){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=o,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(mc,Kg,l_),vc.set(0,0,1).applyQuaternion(Kg);const i=this.panner;if(i.positionX){const o=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(mc.x,o),i.positionY.linearRampToValueAtTime(mc.y,o),i.positionZ.linearRampToValueAtTime(mc.z,o),i.orientationX.linearRampToValueAtTime(vc.x,o),i.orientationY.linearRampToValueAtTime(vc.y,o),i.orientationZ.linearRampToValueAtTime(vc.z,o)}else i.setPosition(mc.x,mc.y,mc.z),i.setOrientation(vc.x,vc.y,vc.z)}}class ey{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let o=0;o<i.length;o++)e+=i[o];return e/i.length}}class ty{constructor(e,i,o){this.binding=e,this.valueSize=o;let l,d,w;switch(i){case"quaternion":l=this._slerp,d=this._slerpAdditive,w=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(o*6),this._workIndex=5;break;case"string":case"bool":l=this._select,d=this._select,w=this._setAdditiveIdentityOther,this.buffer=new Array(o*5);break;default:l=this._lerp,d=this._lerpAdditive,w=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(o*5)}this._mixBufferRegion=l,this._mixBufferRegionAdditive=d,this._setIdentity=w,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const o=this.buffer,l=this.valueSize,d=e*l+l;let w=this.cumulativeWeight;if(w===0){for(let I=0;I!==l;++I)o[d+I]=o[I];w=i}else{w+=i;const I=i/w;this._mixBufferRegion(o,d,0,I,l)}this.cumulativeWeight=w}accumulateAdditive(e){const i=this.buffer,o=this.valueSize,l=o*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,l,0,e,o),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,o=this.buffer,l=e*i+i,d=this.cumulativeWeight,w=this.cumulativeWeightAdditive,I=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,d<1){const J=i*this._origIndex;this._mixBufferRegion(o,l,J,1-d,i)}w>0&&this._mixBufferRegionAdditive(o,l,this._addIndex*i,1,i);for(let J=i,ee=i+i;J!==ee;++J)if(o[J]!==o[J+i]){I.setValue(o,l);break}}saveOriginalState(){const e=this.binding,i=this.buffer,o=this.valueSize,l=o*this._origIndex;e.getValue(i,l);for(let d=o,w=l;d!==w;++d)i[d]=i[l+d%o];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let o=e;o<i;o++)this.buffer[o]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let o=0;o<this.valueSize;o++)this.buffer[i+o]=this.buffer[e+o]}_select(e,i,o,l,d){if(l>=.5)for(let w=0;w!==d;++w)e[i+w]=e[o+w]}_slerp(e,i,o,l){ha.slerpFlat(e,i,e,i,e,o,l)}_slerpAdditive(e,i,o,l,d){const w=this._workIndex*d;ha.multiplyQuaternionsFlat(e,w,e,i,e,o),ha.slerpFlat(e,i,e,i,e,w,l)}_lerp(e,i,o,l,d){const w=1-l;for(let I=0;I!==d;++I){const J=i+I;e[J]=e[J]*w+e[o+I]*l}}_lerpAdditive(e,i,o,l,d){for(let w=0;w!==d;++w){const I=i+w;e[I]=e[I]+e[o+w]*l}}}const Tm="\\[\\]\\.:\\/",f_=new RegExp("["+Tm+"]","g"),Sm="[^"+Tm+"]",h_="[^"+Tm.replace("\\.","")+"]",d_=/((?:WC+[\/:])*)/.source.replace("WC",Sm),p_=/(WCOD+)?/.source.replace("WCOD",h_),m_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Sm),v_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Sm),g_=new RegExp("^"+d_+p_+m_+v_+"$"),ry=["material","materials","bones"];class ny{constructor(e,i,o){const l=o||ui.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,l)}getValue(e,i){this.bind();const o=this._targetGroup.nCachedObjects_,l=this._bindings[o];l!==void 0&&l.getValue(e,i)}setValue(e,i){const o=this._bindings;for(let l=this._targetGroup.nCachedObjects_,d=o.length;l!==d;++l)o[l].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,o=e.length;i!==o;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,o=e.length;i!==o;++i)e[i].unbind()}}class ui{constructor(e,i,o){this.path=i,this.parsedPath=o||ui.parseTrackName(i),this.node=ui.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,o){return e&&e.isAnimationObjectGroup?new ui.Composite(e,i,o):new ui(e,i,o)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(f_,"")}static parseTrackName(e){const i=g_.exec(e);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const o={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},l=o.nodeName&&o.nodeName.lastIndexOf(".");if(l!==void 0&&l!==-1){const d=o.nodeName.substring(l+1);ry.indexOf(d)!==-1&&(o.nodeName=o.nodeName.substring(0,l),o.objectName=d)}if(o.propertyName===null||o.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return o}static findNode(e,i){if(!i||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const o=e.skeleton.getBoneByName(i);if(o!==void 0)return o}if(e.children){const o=function(d){for(let w=0;w<d.length;w++){const I=d[w];if(I.name===i||I.uuid===i)return I;const J=o(I.children);if(J)return J}return null},l=o(e.children);if(l)return l}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)e[i++]=o[l]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const o=this.resolvedProperty;for(let l=0,d=o.length;l!==d;++l)o[l]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,o=i.objectName,l=i.propertyName;let d=i.propertyIndex;if(e||(e=ui.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(o){let ee=i.objectIndex;switch(o){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let he=0;he<e.length;he++)if(e[he].name===ee){ee=he;break}break;default:if(e[o]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[o]}if(ee!==void 0){if(e[ee]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[ee]}}const w=e[l];if(w===void 0){const ee=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+ee+"."+l+" but it wasn't found.",e);return}let I=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?I=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(I=this.Versioning.MatrixWorldNeedsUpdate);let J=this.BindingType.Direct;if(d!==void 0){if(l==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[d]!==void 0&&(d=e.morphTargetDictionary[d])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}J=this.BindingType.ArrayElement,this.resolvedProperty=w,this.propertyIndex=d}else w.fromArray!==void 0&&w.toArray!==void 0?(J=this.BindingType.HasFromToArray,this.resolvedProperty=w):Array.isArray(w)?(J=this.BindingType.EntireArray,this.resolvedProperty=w):this.propertyName=l;this.getValue=this.GetterByBindingType[J],this.setValue=this.SetterByBindingTypeAndVersioning[J][I]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ui.Composite=ny,ui.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ui.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ui.prototype.GetterByBindingType=[ui.prototype._getValue_direct,ui.prototype._getValue_array,ui.prototype._getValue_arrayElement,ui.prototype._getValue_toArray],ui.prototype.SetterByBindingTypeAndVersioning=[[ui.prototype._setValue_direct,ui.prototype._setValue_direct_setNeedsUpdate,ui.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ui.prototype._setValue_array,ui.prototype._setValue_array_setNeedsUpdate,ui.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ui.prototype._setValue_arrayElement,ui.prototype._setValue_arrayElement_setNeedsUpdate,ui.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ui.prototype._setValue_fromArray,ui.prototype._setValue_fromArray_setNeedsUpdate,ui.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Rm{constructor(){this.uuid=os(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let o=0,l=arguments.length;o!==l;++o)e[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,o=this._paths,l=this._parsedPaths,d=this._bindings,w=d.length;let I,J=e.length,ee=this.nCachedObjects_;for(let he=0,fe=arguments.length;he!==fe;++he){const de=arguments[he],ve=de.uuid;let Ce=i[ve];if(Ce===void 0){Ce=J++,i[ve]=Ce,e.push(de);for(let Ne=0,Ke=w;Ne!==Ke;++Ne)d[Ne].push(new ui(de,o[Ne],l[Ne]))}else if(Ce<ee){I=e[Ce];const Ne=--ee,Ke=e[Ne];i[Ke.uuid]=Ce,e[Ce]=Ke,i[ve]=Ne,e[Ne]=de;for(let Oe=0,xe=w;Oe!==xe;++Oe){const ut=d[Oe],rt=ut[Ne];let ft=ut[Ce];ut[Ce]=rt,ft===void 0&&(ft=new ui(de,o[Oe],l[Oe])),ut[Ne]=ft}}else e[Ce]!==I&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=ee}remove(){const e=this._objects,i=this._indicesByUUID,o=this._bindings,l=o.length;let d=this.nCachedObjects_;for(let w=0,I=arguments.length;w!==I;++w){const J=arguments[w],ee=J.uuid,he=i[ee];if(he!==void 0&&he>=d){const fe=d++,de=e[fe];i[de.uuid]=he,e[he]=de,i[ee]=fe,e[fe]=J;for(let ve=0,Ce=l;ve!==Ce;++ve){const Ne=o[ve],Ke=Ne[fe],Oe=Ne[he];Ne[he]=Ke,Ne[fe]=Oe}}}this.nCachedObjects_=d}uncache(){const e=this._objects,i=this._indicesByUUID,o=this._bindings,l=o.length;let d=this.nCachedObjects_,w=e.length;for(let I=0,J=arguments.length;I!==J;++I){const ee=arguments[I],he=ee.uuid,fe=i[he];if(fe!==void 0)if(delete i[he],fe<d){const de=--d,ve=e[de],Ce=--w,Ne=e[Ce];i[ve.uuid]=fe,e[fe]=ve,i[Ne.uuid]=de,e[de]=Ne,e.pop();for(let Ke=0,Oe=l;Ke!==Oe;++Ke){const xe=o[Ke],ut=xe[de],rt=xe[Ce];xe[fe]=ut,xe[de]=rt,xe.pop()}}else{const de=--w,ve=e[de];de>0&&(i[ve.uuid]=fe),e[fe]=ve,e.pop();for(let Ce=0,Ne=l;Ce!==Ne;++Ce){const Ke=o[Ce];Ke[fe]=Ke[de],Ke.pop()}}}this.nCachedObjects_=d}subscribe_(e,i){const o=this._bindingsIndicesByPath;let l=o[e];const d=this._bindings;if(l!==void 0)return d[l];const w=this._paths,I=this._parsedPaths,J=this._objects,ee=J.length,he=this.nCachedObjects_,fe=new Array(ee);l=d.length,o[e]=l,w.push(e),I.push(i),d.push(fe);for(let de=he,ve=J.length;de!==ve;++de){const Ce=J[de];fe[de]=new ui(Ce,e,i)}return fe}unsubscribe_(e){const i=this._bindingsIndicesByPath,o=i[e];if(o!==void 0){const l=this._paths,d=this._parsedPaths,w=this._bindings,I=w.length-1,J=w[I],ee=e[I];i[ee]=o,w[o]=J,w.pop(),d[o]=d[I],d.pop(),l[o]=l[I],l.pop()}}}Rm.prototype.isAnimationObjectGroup=!0;class iy{constructor(e,i,o=null,l=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=o,this.blendMode=l;const d=i.tracks,w=d.length,I=new Array(w),J={endingStart:fa,endingEnd:fa};for(let ee=0;ee!==w;++ee){const he=d[ee].createInterpolant(null);I[ee]=he,he.settings=J}this._interpolantSettings=J,this._interpolants=I,this._propertyBindings=new Array(w),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Fa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,o){if(e.fadeOut(i),this.fadeIn(i),o){const l=this._clip.duration,d=e._clip.duration,w=d/l,I=l/d;e.warp(1,w,i),this.warp(I,1,i)}return this}crossFadeTo(e,i,o){return e.crossFadeFrom(this,i,o)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,o){const l=this._mixer,d=l.time,w=this.timeScale;let I=this._timeScaleInterpolant;I===null&&(I=l._lendControlInterpolant(),this._timeScaleInterpolant=I);const J=I.parameterPositions,ee=I.sampleValues;return J[0]=d,J[1]=d+o,ee[0]=e/w,ee[1]=i/w,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,o,l){if(!this.enabled){this._updateWeight(e);return}const d=this._startTime;if(d!==null){const J=(e-d)*o;if(J<0||o===0)return;this._startTime=null,i=o*J}i*=this._updateTimeScale(e);const w=this._updateTime(i),I=this._updateWeight(e);if(I>0){const J=this._interpolants,ee=this._propertyBindings;switch(this.blendMode){case fu:for(let he=0,fe=J.length;he!==fe;++he)J[he].evaluate(w),ee[he].accumulateAdditive(I);break;case ki:default:for(let he=0,fe=J.length;he!==fe;++he)J[he].evaluate(w),ee[he].accumulate(l,I)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const o=this._weightInterpolant;if(o!==null){const l=o.evaluate(e)[0];i*=l,e>o.parameterPositions[1]&&(this.stopFading(),l===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const o=this._timeScaleInterpolant;o!==null&&(i*=o.evaluate(e)[0],e>o.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i))}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,o=this.loop;let l=this.time+e,d=this._loopCount;const w=o===ca;if(e===0)return d===-1?l:w&&(d&1)===1?i-l:l;if(o===Gf){d===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(l>=i)l=i;else if(l<0)l=0;else{this.time=l;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=l,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(d===-1&&(e>=0?(d=0,this._setEndings(!0,this.repetitions===0,w)):this._setEndings(this.repetitions===0,!0,w)),l>=i||l<0){const I=Math.floor(l/i);l-=i*I,d+=Math.abs(I);const J=this.repetitions-d;if(J<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,l=e>0?i:0,this.time=l,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(J===1){const ee=e<0;this._setEndings(ee,!ee,w)}else this._setEndings(!1,!1,w);this._loopCount=d,this.time=l,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:I})}}else this.time=l;if(w&&(d&1)===1)return i-l}return l}_setEndings(e,i,o){const l=this._interpolantSettings;o?(l.endingStart=bo,l.endingEnd=bo):(e?l.endingStart=this.zeroSlopeAtStart?bo:fa:l.endingStart=Eo,i?l.endingEnd=this.zeroSlopeAtEnd?bo:fa:l.endingEnd=Eo)}_scheduleFading(e,i,o){const l=this._mixer,d=l.time;let w=this._weightInterpolant;w===null&&(w=l._lendControlInterpolant(),this._weightInterpolant=w);const I=w.parameterPositions,J=w.sampleValues;return I[0]=d,J[0]=i,I[1]=d+e,J[1]=o,this}}class Cm extends Vs{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const o=e._localRoot||this._root,l=e._clip.tracks,d=l.length,w=e._propertyBindings,I=e._interpolants,J=o.uuid,ee=this._bindingsByRootAndName;let he=ee[J];he===void 0&&(he={},ee[J]=he);for(let fe=0;fe!==d;++fe){const de=l[fe],ve=de.name;let Ce=he[ve];if(Ce!==void 0)++Ce.referenceCount,w[fe]=Ce;else{if(Ce=w[fe],Ce!==void 0){Ce._cacheIndex===null&&(++Ce.referenceCount,this._addInactiveBinding(Ce,J,ve));continue}const Ne=i&&i._propertyBindings[fe].binding.parsedPath;Ce=new ty(ui.create(o,ve,Ne),de.ValueTypeName,de.getValueSize()),++Ce.referenceCount,this._addInactiveBinding(Ce,J,ve),w[fe]=Ce}I[fe].resultBuffer=Ce.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const o=(e._localRoot||this._root).uuid,l=e._clip.uuid,d=this._actionsByClip[l];this._bindAction(e,d&&d.knownActions[0]),this._addInactiveAction(e,l,o)}const i=e._propertyBindings;for(let o=0,l=i.length;o!==l;++o){const d=i[o];d.useCount++===0&&(this._lendBinding(d),d.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let o=0,l=i.length;o!==l;++o){const d=i[o];--d.useCount===0&&(d.restoreOriginalState(),this._takeBackBinding(d))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,o){const l=this._actions,d=this._actionsByClip;let w=d[i];if(w===void 0)w={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,d[i]=w;else{const I=w.knownActions;e._byClipCacheIndex=I.length,I.push(e)}e._cacheIndex=l.length,l.push(e),w.actionByRoot[o]=e}_removeInactiveAction(e){const i=this._actions,o=i[i.length-1],l=e._cacheIndex;o._cacheIndex=l,i[l]=o,i.pop(),e._cacheIndex=null;const d=e._clip.uuid,w=this._actionsByClip,I=w[d],J=I.knownActions,ee=J[J.length-1],he=e._byClipCacheIndex;ee._byClipCacheIndex=he,J[he]=ee,J.pop(),e._byClipCacheIndex=null;const fe=I.actionByRoot,de=(e._localRoot||this._root).uuid;delete fe[de],J.length===0&&delete w[d],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let o=0,l=i.length;o!==l;++o){const d=i[o];--d.referenceCount===0&&this._removeInactiveBinding(d)}}_lendAction(e){const i=this._actions,o=e._cacheIndex,l=this._nActiveActions++,d=i[l];e._cacheIndex=l,i[l]=e,d._cacheIndex=o,i[o]=d}_takeBackAction(e){const i=this._actions,o=e._cacheIndex,l=--this._nActiveActions,d=i[l];e._cacheIndex=l,i[l]=e,d._cacheIndex=o,i[o]=d}_addInactiveBinding(e,i,o){const l=this._bindingsByRootAndName,d=this._bindings;let w=l[i];w===void 0&&(w={},l[i]=w),w[o]=e,e._cacheIndex=d.length,d.push(e)}_removeInactiveBinding(e){const i=this._bindings,o=e.binding,l=o.rootNode.uuid,d=o.path,w=this._bindingsByRootAndName,I=w[l],J=i[i.length-1],ee=e._cacheIndex;J._cacheIndex=ee,i[ee]=J,i.pop(),delete I[d],Object.keys(I).length===0&&delete w[l]}_lendBinding(e){const i=this._bindings,o=e._cacheIndex,l=this._nActiveBindings++,d=i[l];e._cacheIndex=l,i[l]=e,d._cacheIndex=o,i[o]=d}_takeBackBinding(e){const i=this._bindings,o=e._cacheIndex,l=--this._nActiveBindings,d=i[l];e._cacheIndex=l,i[l]=e,d._cacheIndex=o,i[o]=d}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let o=e[i];return o===void 0&&(o=new Ih(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),o.__cacheIndex=i,e[i]=o),o}_takeBackControlInterpolant(e){const i=this._controlInterpolants,o=e.__cacheIndex,l=--this._nActiveControlInterpolants,d=i[l];e.__cacheIndex=l,i[l]=e,d.__cacheIndex=o,i[o]=d}clipAction(e,i,o){const l=i||this._root,d=l.uuid;let w=typeof e=="string"?Sf.findByName(l,e):e;const I=w!==null?w.uuid:e,J=this._actionsByClip[I];let ee=null;if(o===void 0&&(w!==null?o=w.blendMode:o=ki),J!==void 0){const fe=J.actionByRoot[d];if(fe!==void 0&&fe.blendMode===o)return fe;ee=J.knownActions[0],w===null&&(w=ee._clip)}if(w===null)return null;const he=new iy(this,w,i,o);return this._bindAction(he,ee),this._addInactiveAction(he,I,d),he}existingAction(e,i){const o=i||this._root,l=o.uuid,d=typeof e=="string"?Sf.findByName(o,e):e,w=d?d.uuid:e,I=this._actionsByClip[w];return I!==void 0&&I.actionByRoot[l]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let o=i-1;o>=0;--o)e[o].stop();return this}update(e){e*=this.timeScale;const i=this._actions,o=this._nActiveActions,l=this.time+=e,d=Math.sign(e),w=this._accuIndex^=1;for(let ee=0;ee!==o;++ee)i[ee]._update(l,e,d,w);const I=this._bindings,J=this._nActiveBindings;for(let ee=0;ee!==J;++ee)I[ee].apply(w);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,o=e.uuid,l=this._actionsByClip,d=l[o];if(d!==void 0){const w=d.knownActions;for(let I=0,J=w.length;I!==J;++I){const ee=w[I];this._deactivateAction(ee);const he=ee._cacheIndex,fe=i[i.length-1];ee._cacheIndex=null,ee._byClipCacheIndex=null,fe._cacheIndex=he,i[he]=fe,i.pop(),this._removeInactiveBindingsForAction(ee)}delete l[o]}}uncacheRoot(e){const i=e.uuid,o=this._actionsByClip;for(const w in o){const I=o[w].actionByRoot,J=I[i];J!==void 0&&(this._deactivateAction(J),this._removeInactiveAction(J))}const l=this._bindingsByRootAndName,d=l[i];if(d!==void 0)for(const w in d){const I=d[w];I.restoreOriginalState(),this._removeInactiveBinding(I)}}uncacheAction(e,i){const o=this.existingAction(e,i);o!==null&&(this._deactivateAction(o),this._removeInactiveAction(o))}}Cm.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class u0{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new u0(this.value.clone===void 0?this.value:this.value.clone())}}class ay extends $l{constructor(e,i,o=1){super(e,i),this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}ay.prototype.isInstancedInterleavedBuffer=!0;class sy{constructor(e,i,o,l,d){this.buffer=e,this.type=i,this.itemSize=o,this.elementSize=l,this.count=d,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}sy.prototype.isGLBufferAttribute=!0;class y_{constructor(e,i,o=0,l=1/0){this.ray=new Co(e,i),this.near=o,this.far=l,this.camera=null,this.layers=new Ll,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(e,i=!0,o=[]){return Pm(e,this,o,i),o.sort(oy),o}intersectObjects(e,i=!0,o=[]){for(let l=0,d=e.length;l<d;l++)Pm(e[l],this,o,i);return o.sort(oy),o}}function oy(f,e){return f.distance-e.distance}function Pm(f,e,i,o){if(f.layers.test(e.layers)&&f.raycast(e,i),o===!0){const l=f.children;for(let d=0,w=l.length;d<w;d++)Pm(l[d],e,i,!0)}}class __{constructor(e=1,i=0,o=0){return this.radius=e,this.phi=i,this.theta=o,this}set(e,i,o){return this.radius=e,this.phi=i,this.theta=o,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,o){return this.radius=Math.sqrt(e*e+i*i+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,o),this.phi=Math.acos(un(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class x_{constructor(e=1,i=0,o=0){return this.radius=e,this.theta=i,this.y=o,this}set(e,i,o){return this.radius=e,this.theta=i,this.y=o,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,o){return this.radius=Math.sqrt(e*e+o*o),this.theta=Math.atan2(e,o),this.y=i,this}clone(){return new this.constructor().copy(this)}}const uy=new We;class Rf{constructor(e=new We(1/0,1/0),i=new We(-1/0,-1/0)){this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,o=e.length;i<o;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const o=uy.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return uy.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Rf.prototype.isBox2=!0;const ly=new dt,l0=new dt;class cy{constructor(e=new dt,i=new dt){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){ly.subVectors(e,this.start),l0.subVectors(this.end,this.start);const o=l0.dot(l0);let d=l0.dot(ly)/o;return i&&(d=un(d,0,1)),d}closestPointToPoint(e,i,o){const l=this.closestPointToPointParameter(e,i);return this.delta(o).multiplyScalar(l).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const fy=new dt;class A_ extends Gn{constructor(e,i){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const o=new An,l=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let w=0,I=1,J=32;w<J;w++,I++){const ee=w/J*Math.PI*2,he=I/J*Math.PI*2;l.push(Math.cos(ee),Math.sin(ee),1,Math.cos(he),Math.sin(he),1)}o.setAttribute("position",new Qr(l,3));const d=new Ji({fog:!1,toneMapped:!1});this.cone=new Ts(o,d),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),fy.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(fy),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ol=new dt,c0=new jr,Lm=new jr;class hy extends Ts{constructor(e){const i=dy(e),o=new An,l=[],d=[],w=new Or(0,0,1),I=new Or(0,1,0);for(let ee=0;ee<i.length;ee++){const he=i[ee];he.parent&&he.parent.isBone&&(l.push(0,0,0),l.push(0,0,0),d.push(w.r,w.g,w.b),d.push(I.r,I.g,I.b))}o.setAttribute("position",new Qr(l,3)),o.setAttribute("color",new Qr(d,3));const J=new Ji({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(o,J),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,o=this.geometry,l=o.getAttribute("position");Lm.copy(this.root.matrixWorld).invert();for(let d=0,w=0;d<i.length;d++){const I=i[d];I.parent&&I.parent.isBone&&(c0.multiplyMatrices(Lm,I.matrixWorld),ol.setFromMatrixPosition(c0),l.setXYZ(w,ol.x,ol.y,ol.z),c0.multiplyMatrices(Lm,I.parent.matrixWorld),ol.setFromMatrixPosition(c0),l.setXYZ(w+1,ol.x,ol.y,ol.z),w+=2)}o.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function dy(f){const e=[];f&&f.isBone&&e.push(f);for(let i=0;i<f.children.length;i++)e.push.apply(e,dy(f.children[i]));return e}class w_ extends ra{constructor(e,i,o){const l=new oc(i,4,2),d=new co({wireframe:!0,fog:!1,toneMapped:!1});super(l,d),this.light=e,this.light.updateMatrixWorld(),this.color=o,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const M_=new dt,py=new Or,my=new Or;class b_ extends Gn{constructor(e,i,o){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o;const l=new xo(i);l.rotateY(Math.PI*.5),this.material=new co({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const d=l.getAttribute("position"),w=new Float32Array(d.count*3);l.setAttribute("color",new ti(w,3)),this.add(new ra(l,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");py.copy(this.light.color),my.copy(this.light.groundColor);for(let o=0,l=i.count;o<l;o++){const d=o<l/2?py:my;i.setXYZ(o,d.r,d.g,d.b)}i.needsUpdate=!0}e.lookAt(M_.setFromMatrixPosition(this.light.matrixWorld).negate())}}class vy extends Ts{constructor(e=10,i=10,o=4473924,l=8947848){o=new Or(o),l=new Or(l);const d=i/2,w=e/i,I=e/2,J=[],ee=[];for(let de=0,ve=0,Ce=-I;de<=i;de++,Ce+=w){J.push(-I,0,Ce,I,0,Ce),J.push(Ce,0,-I,Ce,0,I);const Ne=de===d?o:l;Ne.toArray(ee,ve),ve+=3,Ne.toArray(ee,ve),ve+=3,Ne.toArray(ee,ve),ve+=3,Ne.toArray(ee,ve),ve+=3}const he=new An;he.setAttribute("position",new Qr(J,3)),he.setAttribute("color",new Qr(ee,3));const fe=new Ji({vertexColors:!0,toneMapped:!1});super(he,fe),this.type="GridHelper"}}class E_ extends Ts{constructor(e=10,i=16,o=8,l=64,d=4473924,w=8947848){d=new Or(d),w=new Or(w);const I=[],J=[];for(let fe=0;fe<=i;fe++){const de=fe/i*(Math.PI*2),ve=Math.sin(de)*e,Ce=Math.cos(de)*e;I.push(0,0,0),I.push(ve,0,Ce);const Ne=fe&1?d:w;J.push(Ne.r,Ne.g,Ne.b),J.push(Ne.r,Ne.g,Ne.b)}for(let fe=0;fe<=o;fe++){const de=fe&1?d:w,ve=e-e/o*fe;for(let Ce=0;Ce<l;Ce++){let Ne=Ce/l*(Math.PI*2),Ke=Math.sin(Ne)*ve,Oe=Math.cos(Ne)*ve;I.push(Ke,0,Oe),J.push(de.r,de.g,de.b),Ne=(Ce+1)/l*(Math.PI*2),Ke=Math.sin(Ne)*ve,Oe=Math.cos(Ne)*ve,I.push(Ke,0,Oe),J.push(de.r,de.g,de.b)}}const ee=new An;ee.setAttribute("position",new Qr(I,3)),ee.setAttribute("color",new Qr(J,3));const he=new Ji({vertexColors:!0,toneMapped:!1});super(ee,he),this.type="PolarGridHelper"}}const gy=new dt,f0=new dt,yy=new dt;class T_ extends Gn{constructor(e,i,o){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,i===void 0&&(i=1);let l=new An;l.setAttribute("position",new Qr([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const d=new Ji({fog:!1,toneMapped:!1});this.lightPlane=new jo(l,d),this.add(this.lightPlane),l=new An,l.setAttribute("position",new Qr([0,0,0,0,0,1],3)),this.targetLine=new jo(l,d),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){gy.setFromMatrixPosition(this.light.matrixWorld),f0.setFromMatrixPosition(this.light.target.matrixWorld),yy.subVectors(f0,gy),this.lightPlane.lookAt(f0),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(f0),this.targetLine.scale.z=yy.length()}}const h0=new dt,ia=new Qn;class S_ extends Ts{constructor(e){const i=new An,o=new Ji({color:16777215,vertexColors:!0,toneMapped:!1}),l=[],d=[],w={},I=new Or(16755200),J=new Or(16711680),ee=new Or(43775),he=new Or(16777215),fe=new Or(3355443);de("n1","n2",I),de("n2","n4",I),de("n4","n3",I),de("n3","n1",I),de("f1","f2",I),de("f2","f4",I),de("f4","f3",I),de("f3","f1",I),de("n1","f1",I),de("n2","f2",I),de("n3","f3",I),de("n4","f4",I),de("p","n1",J),de("p","n2",J),de("p","n3",J),de("p","n4",J),de("u1","u2",ee),de("u2","u3",ee),de("u3","u1",ee),de("c","t",he),de("p","c",fe),de("cn1","cn2",fe),de("cn3","cn4",fe),de("cf1","cf2",fe),de("cf3","cf4",fe);function de(Ce,Ne,Ke){ve(Ce,Ke),ve(Ne,Ke)}function ve(Ce,Ne){l.push(0,0,0),d.push(Ne.r,Ne.g,Ne.b),w[Ce]===void 0&&(w[Ce]=[]),w[Ce].push(l.length/3-1)}i.setAttribute("position",new Qr(l,3)),i.setAttribute("color",new Qr(d,3)),super(i,o),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=w,this.update()}update(){const e=this.geometry,i=this.pointMap,o=1,l=1;ia.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ma("c",i,e,ia,0,0,-1),ma("t",i,e,ia,0,0,1),ma("n1",i,e,ia,-o,-l,-1),ma("n2",i,e,ia,o,-l,-1),ma("n3",i,e,ia,-o,l,-1),ma("n4",i,e,ia,o,l,-1),ma("f1",i,e,ia,-o,-l,1),ma("f2",i,e,ia,o,-l,1),ma("f3",i,e,ia,-o,l,1),ma("f4",i,e,ia,o,l,1),ma("u1",i,e,ia,o*.7,l*1.1,-1),ma("u2",i,e,ia,-o*.7,l*1.1,-1),ma("u3",i,e,ia,0,l*2,-1),ma("cf1",i,e,ia,-o,0,1),ma("cf2",i,e,ia,o,0,1),ma("cf3",i,e,ia,0,-l,1),ma("cf4",i,e,ia,0,l,1),ma("cn1",i,e,ia,-o,0,-1),ma("cn2",i,e,ia,o,0,-1),ma("cn3",i,e,ia,0,-l,-1),ma("cn4",i,e,ia,0,l,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ma(f,e,i,o,l,d,w){h0.set(l,d,w).unproject(o);const I=e[f];if(I!==void 0){const J=i.getAttribute("position");for(let ee=0,he=I.length;ee<he;ee++)J.setXYZ(I[ee],h0.x,h0.y,h0.z)}}const d0=new Ja;class _y extends Ts{constructor(e,i=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),l=new Float32Array(8*3),d=new An;d.setIndex(new ti(o,1)),d.setAttribute("position",new ti(l,3)),super(d,new Ji({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&d0.setFromObject(this.object),d0.isEmpty())return;const i=d0.min,o=d0.max,l=this.geometry.attributes.position,d=l.array;d[0]=o.x,d[1]=o.y,d[2]=o.z,d[3]=i.x,d[4]=o.y,d[5]=o.z,d[6]=i.x,d[7]=i.y,d[8]=o.z,d[9]=o.x,d[10]=i.y,d[11]=o.z,d[12]=o.x,d[13]=o.y,d[14]=i.z,d[15]=i.x,d[16]=o.y,d[17]=i.z,d[18]=i.x,d[19]=i.y,d[20]=i.z,d[21]=o.x,d[22]=i.y,d[23]=i.z,l.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return Ts.prototype.copy.call(this,e),this.object=e.object,this}}class R_ extends Ts{constructor(e,i=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),l=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],d=new An;d.setIndex(new ti(o,1)),d.setAttribute("position",new Qr(l,3)),super(d,new Ji({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class C_ extends jo{constructor(e,i=1,o=16776960){const l=o,d=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],w=new An;w.setAttribute("position",new Qr(d,3)),w.computeBoundingSphere(),super(w,new Ji({color:l,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const I=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],J=new An;J.setAttribute("position",new Qr(I,3)),J.computeBoundingSphere(),this.add(new ra(J,new co({color:l,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let i=-this.plane.constant;Math.abs(i)<1e-8&&(i=1e-8),this.scale.set(.5*this.size,.5*this.size,i),this.children[0].material.side=i<0?V:B,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const xy=new dt;let p0,Om;class P_ extends Gn{constructor(e=new dt(0,0,1),i=new dt(0,0,0),o=1,l=16776960,d=o*.2,w=d*.2){super(),this.type="ArrowHelper",p0===void 0&&(p0=new An,p0.setAttribute("position",new Qr([0,0,0,0,1,0],3)),Om=new al(0,.5,1,5,1),Om.translate(0,-.5,0)),this.position.copy(i),this.line=new jo(p0,new Ji({color:l,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ra(Om,new co({color:l,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(o,d,w)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{xy.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(xy,i)}}setLength(e,i=e*.2,o=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(o,i,o),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class Ay extends Ts{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],o=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],l=new An;l.setAttribute("position",new Qr(i,3)),l.setAttribute("color",new Qr(o,3));const d=new Ji({vertexColors:!0,toneMapped:!1});super(l,d),this.type="AxesHelper"}setColors(e,i,o){const l=new Or,d=this.geometry.attributes.color.array;return l.set(e),l.toArray(d,0),l.toArray(d,3),l.set(i),l.toArray(d,6),l.toArray(d,9),l.set(o),l.toArray(d,12),l.toArray(d,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class L_{constructor(){this.type="ShapePath",this.color=new Or,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new Rh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,o,l){return this.currentPath.quadraticCurveTo(e,i,o,l),this}bezierCurveTo(e,i,o,l,d,w){return this.currentPath.bezierCurveTo(e,i,o,l,d,w),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,i){function o(xe){const ut=[];for(let rt=0,ft=xe.length;rt<ft;rt++){const Mt=xe[rt],Rt=new Jo;Rt.curves=Mt.curves,ut.push(Rt)}return ut}function l(xe,ut){const rt=ut.length;let ft=!1;for(let Mt=rt-1,Rt=0;Rt<rt;Mt=Rt++){let kt=ut[Mt],nr=ut[Rt],Xt=nr.x-kt.x,it=nr.y-kt.y;if(Math.abs(it)>Number.EPSILON){if(it<0&&(kt=ut[Rt],Xt=-Xt,nr=ut[Mt],it=-it),xe.y<kt.y||xe.y>nr.y)continue;if(xe.y===kt.y){if(xe.x===kt.x)return!0}else{const Pt=it*(xe.x-kt.x)-Xt*(xe.y-kt.y);if(Pt===0)return!0;if(Pt<0)continue;ft=!ft}}else{if(xe.y!==kt.y)continue;if(nr.x<=xe.x&&xe.x<=kt.x||kt.x<=xe.x&&xe.x<=nr.x)return!0}}return ft}const d=$o.isClockWise,w=this.subPaths;if(w.length===0)return[];if(i===!0)return o(w);let I,J,ee;const he=[];if(w.length===1)return J=w[0],ee=new Jo,ee.curves=J.curves,he.push(ee),he;let fe=!d(w[0].getPoints());fe=e?!fe:fe;const de=[],ve=[];let Ce=[],Ne=0,Ke;ve[Ne]=void 0,Ce[Ne]=[];for(let xe=0,ut=w.length;xe<ut;xe++)J=w[xe],Ke=J.getPoints(),I=d(Ke),I=e?!I:I,I?(!fe&&ve[Ne]&&Ne++,ve[Ne]={s:new Jo,p:Ke},ve[Ne].s.curves=J.curves,fe&&Ne++,Ce[Ne]=[]):Ce[Ne].push({h:J,p:Ke[0]});if(!ve[0])return o(w);if(ve.length>1){let xe=!1;const ut=[];for(let rt=0,ft=ve.length;rt<ft;rt++)de[rt]=[];for(let rt=0,ft=ve.length;rt<ft;rt++){const Mt=Ce[rt];for(let Rt=0;Rt<Mt.length;Rt++){const kt=Mt[Rt];let nr=!0;for(let Xt=0;Xt<ve.length;Xt++)l(kt.p,ve[Xt].p)&&(rt!==Xt&&ut.push({froms:rt,tos:Xt,hole:Rt}),nr?(nr=!1,de[Xt].push(kt)):xe=!0);nr&&de[rt].push(kt)}}ut.length>0&&(xe||(Ce=de))}let Oe;for(let xe=0,ut=ve.length;xe<ut;xe++){ee=ve[xe].s,he.push(ee),Oe=Ce[xe];for(let rt=0,ft=Oe.length;rt<ft;rt++)ee.holes.push(Oe[rt].h)}return he}}const wy=new Float32Array(1),O_=new Int32Array(wy.buffer);class F_{static toHalfFloat(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),wy[0]=e;const i=O_[0];let o=i>>16&32768,l=i>>12&2047;const d=i>>23&255;return d<103?o:d>142?(o|=31744,o|=(d==255?0:1)&&i&8388607,o):d<113?(l|=2048,o|=(l>>114-d)+(l>>113-d&1),o):(o|=d-112<<10|l>>1,o+=l&1,o)}}const I_=0,k_=1,D_=0,N_=1,B_=2;function U_(f){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),f}function z_(f=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),f.isMultiMaterial=!0,f.materials=f,f.clone=function(){return f.slice()},f}function G_(f,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new wh(f,e)}function V_(f){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Gd(f)}function W_(f,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new wh(f,e)}function H_(f){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ac(f)}function q_(f){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ac(f)}function X_(f){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ac(f)}function Z_(f,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new dt(f,e,i)}function j_(f,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new ti(f,e).setUsage(zu)}function Y_(f,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new qu(f,e)}function J_(f,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new $f(f,e)}function $_(f,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Wc(f,e)}function Q_(f,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Hc(f,e)}function K_(f,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new qc(f,e)}function ex(f,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new vd(f,e)}function tx(f,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Dl(f,e)}function rx(f,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Qr(f,e)}function nx(f,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Fo(f,e)}Is.create=function(f,e){return console.log("THREE.Curve.create() has been deprecated"),f.prototype=Object.create(Is.prototype),f.prototype.constructor=f,f.prototype.getPoint=e,f},Rh.prototype.fromPoints=function(f){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(f)};function Ko(f){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Ay(f)}function Uh(f,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new _y(f,e)}function My(f,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ts(new qp(f.geometry),new Ji({color:e!==void 0?e:16777215}))}vy.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},hy.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function by(f,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ts(new Ef(f.geometry),new Ji({color:e!==void 0?e:16777215}))}hs.prototype.extractUrlBase=function(f){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),a0.extractUrlBase(f)},hs.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function m0(f){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Qo(f)}function ix(f){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Fg(f)}Rf.prototype.center=function(f){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(f)},Rf.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Rf.prototype.isIntersectionBox=function(f){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(f)},Rf.prototype.size=function(f){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(f)},Ja.prototype.center=function(f){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(f)},Ja.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ja.prototype.isIntersectionBox=function(f){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(f)},Ja.prototype.isIntersectionSphere=function(f){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(f)},Ja.prototype.size=function(f){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(f)},mu.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ba.prototype.setFromMatrix=function(f){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(f)},cy.prototype.center=function(f){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(f)},Yt.prototype.flattenToArrayOffset=function(f,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(f,e)},Yt.prototype.multiplyVector3=function(f){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),f.applyMatrix3(this)},Yt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Yt.prototype.applyToBufferAttribute=function(f){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),f.applyMatrix3(this)},Yt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Yt.prototype.getInverse=function(f){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(f).invert()},jr.prototype.extractPosition=function(f){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(f)},jr.prototype.flattenToArrayOffset=function(f,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(f,e)},jr.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new dt().setFromMatrixColumn(this,3)},jr.prototype.setRotationFromQuaternion=function(f){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(f)},jr.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},jr.prototype.multiplyVector3=function(f){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},jr.prototype.multiplyVector4=function(f){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},jr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},jr.prototype.rotateAxis=function(f){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),f.transformDirection(this)},jr.prototype.crossVector=function(f){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},jr.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},jr.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},jr.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},jr.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},jr.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},jr.prototype.applyToBufferAttribute=function(f){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),f.applyMatrix4(this)},jr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},jr.prototype.makeFrustum=function(f,e,i,o,l,d){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(f,e,o,i,l,d)},jr.prototype.getInverse=function(f){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(f).invert()},Ys.prototype.isIntersectionLine=function(f){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(f)},ha.prototype.multiplyVector3=function(f){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),f.applyQuaternion(this)},ha.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Co.prototype.isIntersectionBox=function(f){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(f)},Co.prototype.isIntersectionPlane=function(f){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(f)},Co.prototype.isIntersectionSphere=function(f){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(f)},zi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},zi.prototype.barycoordFromPoint=function(f,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(f,e)},zi.prototype.midpoint=function(f){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(f)},zi.prototypenormal=function(f){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(f)},zi.prototype.plane=function(f){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(f)},zi.barycoordFromPoint=function(f,e,i,o,l){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),zi.getBarycoord(f,e,i,o,l)},zi.normal=function(f,e,i,o){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),zi.getNormal(f,e,i,o)},Jo.prototype.extractAllPoints=function(f){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(f)},Jo.prototype.extrude=function(f){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new bu(this,f)},Jo.prototype.makeGeometry=function(f){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new sc(this,f)},We.prototype.fromAttribute=function(f,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(f,e,i)},We.prototype.distanceToManhattan=function(f){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(f)},We.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},dt.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},dt.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},dt.prototype.getPositionFromMatrix=function(f){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(f)},dt.prototype.getScaleFromMatrix=function(f){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(f)},dt.prototype.getColumnFromMatrix=function(f,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,f)},dt.prototype.applyProjection=function(f){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(f)},dt.prototype.fromAttribute=function(f,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(f,e,i)},dt.prototype.distanceToManhattan=function(f){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(f)},dt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},cn.prototype.fromAttribute=function(f,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(f,e,i)},cn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Gn.prototype.getChildByName=function(f){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(f)},Gn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Gn.prototype.translate=function(f,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,f)},Gn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Gn.prototype.applyMatrix=function(f){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(f)},Object.defineProperties(Gn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(f){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=f}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ra.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(ra.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Tc},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),hf.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},da.prototype.setLens=function(f,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(f)},Object.defineProperties(Ao.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(f){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=f}},shadowCameraLeft:{set:function(f){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=f}},shadowCameraRight:{set:function(f){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=f}},shadowCameraTop:{set:function(f){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=f}},shadowCameraBottom:{set:function(f){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=f}},shadowCameraNear:{set:function(f){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=f}},shadowCameraFar:{set:function(f){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=f}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(f){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=f}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(f){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=f}},shadowMapHeight:{set:function(f){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=f}}}),Object.defineProperties(ti.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===zu},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(zu)}}}),ti.prototype.setDynamic=function(f){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(f===!0?zu:Uu),this},ti.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},ti.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},An.prototype.addIndex=function(f){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(f)},An.prototype.addAttribute=function(f,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(e&&e.isBufferAttribute)&&!(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(f,new ti(arguments[1],arguments[2]))):f==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(f,e)},An.prototype.addDrawCall=function(f,e,i){i!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(f,e)},An.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},An.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},An.prototype.removeAttribute=function(f){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(f)},An.prototype.applyMatrix=function(f){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(f)},Object.defineProperties(An.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),$l.prototype.setDynamic=function(f){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(f===!0?zu:Uu),this},$l.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},bu.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},bu.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},bu.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},nl.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},u0.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Ti.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Or}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(f){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=f===L}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(f){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=f}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Jn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(f){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=f}}}),Ri.prototype.clearTarget=function(f,e,i,o){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(f),this.clear(e,i,o)},Ri.prototype.animate=function(f){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(f)},Ri.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Ri.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Ri.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Ri.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Ri.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Ri.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Ri.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Ri.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Ri.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Ri.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Ri.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Ri.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Ri.prototype.enableScissorTest=function(f){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(f)},Ri.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Ri.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Ri.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Ri.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Ri.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Ri.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Ri.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Ri.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Ri.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Ri.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Ri.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(f){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=f}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(f){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=f}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(f){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=f===!0?xi:fi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties($v.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function ax(f,e,i){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new _u(f,i)}Object.defineProperties(Ta.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(f){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=f}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(f){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=f}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(f){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=f}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(f){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=f}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(f){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=f}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(f){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=f}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(f){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=f}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(f){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=f}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(f){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=f}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(f){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=f}}}),Em.prototype.load=function(f){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return new Xg().load(f,function(o){e.setBuffer(o)}),this},ey.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Jc.prototype.updateCubeMap=function(f,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(f,e)},Jc.prototype.clear=function(f,e,i,o){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(f,e,i,o)},Ia.crossOrigin=void 0,Ia.loadTexture=function(f,e,i,o){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const l=new Ig;l.setCrossOrigin(this.crossOrigin);const d=l.load(f,i,void 0,o);return e&&(d.mapping=e),d},Ia.loadTextureCube=function(f,e,i,o){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const l=new Og;l.setCrossOrigin(this.crossOrigin);const d=l.load(f,i,void 0,o);return e&&(d.mapping=e),d},Ia.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ia.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function sx(){console.error("THREE.CanvasRenderer has been removed")}function ox(){console.error("THREE.JSONLoader has been removed.")}const ux={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function lx(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function gc(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new An}function cx(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new An}function fx(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function hx(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function dx(){console.error("THREE.ImmediateRenderObject has been removed.")}return typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:a}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=a),Ve.ACESFilmicToneMapping=Ae,Ve.AddEquation=H,Ve.AddOperation=Xe,Ve.AdditiveAnimationBlendMode=fu,Ve.AdditiveBlending=x,Ve.AlphaFormat=Ln,Ve.AlwaysDepth=pe,Ve.AlwaysStencilFunc=ud,Ve.AmbientLight=ym,Ve.AmbientLightProbe=jg,Ve.AnimationClip=Sf,Ve.AnimationLoader=n_,Ve.AnimationMixer=Cm,Ve.AnimationObjectGroup=Rm,Ve.AnimationUtils=Gi,Ve.ArcCurve=Yd,Ve.ArrayCamera=kp,Ve.ArrowHelper=P_,Ve.Audio=Em,Ve.AudioAnalyser=ey,Ve.AudioContext=Mm,Ve.AudioListener=u_,Ve.AudioLoader=Xg,Ve.AxesHelper=Ay,Ve.AxisHelper=Ko,Ve.BackSide=V,Ve.BasicDepthPacking=Sc,Ve.BasicShadowMap=p,Ve.BinaryTextureLoader=ix,Ve.Bone=ec,Ve.BooleanKeyframeTrack=uc,Ve.BoundingBoxHelper=Uh,Ve.Box2=Rf,Ve.Box3=Ja,Ve.Box3Helper=R_,Ve.BoxBufferGeometry=ho,Ve.BoxGeometry=ho,Ve.BoxHelper=_y,Ve.BufferAttribute=ti,Ve.BufferGeometry=An,Ve.BufferGeometryLoader=s0,Ve.ByteType=vt,Ve.Cache=cc,Ve.Camera=Qn,Ve.CameraHelper=S_,Ve.CanvasRenderer=sx,Ve.CanvasTexture=gg,Ve.CatmullRomCurve3=Jp,Ve.CineonToneMapping=Ge,Ve.CircleBufferGeometry=pf,Ve.CircleGeometry=pf,Ve.ClampToEdgeWrapping=Ie,Ve.Clock=$g,Ve.Color=Or,Ve.ColorKeyframeTrack=n0,Ve.CompressedTexture=Wp,Ve.CompressedTextureLoader=i_,Ve.ConeBufferGeometry=mf,Ve.ConeGeometry=mf,Ve.CubeCamera=Jc,Ve.CubeReflectionMapping=me,Ve.CubeRefractionMapping=be,Ve.CubeTexture=$u,Ve.CubeTextureLoader=Og,Ve.CubeUVReflectionMapping=lt,Ve.CubeUVRefractionMapping=ot,Ve.CubicBezierCurve=Th,Ve.CubicBezierCurve3=$p,Ve.CubicInterpolant=Cg,Ve.CullFaceBack=M,Ve.CullFaceFront=v,Ve.CullFaceFrontBack=y,Ve.CullFaceNone=R,Ve.Curve=Is,Ve.CurvePath=xg,Ve.CustomBlending=U,Ve.CustomToneMapping=Se,Ve.CylinderBufferGeometry=al,Ve.CylinderGeometry=al,Ve.Cylindrical=x_,Ve.DataTexture=tc,Ve.DataTexture2DArray=Fd,Ve.DataTexture3D=bp,Ve.DataTextureLoader=Fg,Ve.DataUtils=F_,Ve.DecrementStencilOp=z0,Ve.DecrementWrapStencilOp=Za,Ve.DefaultLoadingManager=Lg,Ve.DepthFormat=ta,Ve.DepthStencilFormat=ji,Ve.DepthTexture=Nd,Ve.DirectionalLight=gm,Ve.DirectionalLightHelper=T_,Ve.DiscreteInterpolant=cm,Ve.DodecahedronBufferGeometry=vf,Ve.DodecahedronGeometry=vf,Ve.DoubleSide=P,Ve.DstAlphaFactor=j,Ve.DstColorFactor=ce,Ve.DynamicBufferAttribute=j_,Ve.DynamicCopyUsage=q0,Ve.DynamicDrawUsage=zu,Ve.DynamicReadUsage=W0,Ve.EdgesGeometry=qp,Ve.EdgesHelper=My,Ve.EllipseCurve=Mh,Ve.EqualDepth=$e,Ve.EqualStencilFunc=To,Ve.EquirectangularReflectionMapping=we,Ve.EquirectangularRefractionMapping=je,Ve.Euler=Lo,Ve.EventDispatcher=Vs,Ve.ExtrudeBufferGeometry=bu,Ve.ExtrudeGeometry=bu,Ve.FaceColors=N_,Ve.FileLoader=Qo,Ve.FlatShading=L,Ve.Float16BufferAttribute=fo,Ve.Float32Attribute=rx,Ve.Float32BufferAttribute=Qr,Ve.Float64Attribute=nx,Ve.Float64BufferAttribute=Fo,Ve.FloatType=dr,Ve.Fog=ph,Ve.FogExp2=dh,Ve.Font=hx,Ve.FontLoader=fx,Ve.FramebufferTexture=vg,Ve.FrontSide=B,Ve.Frustum=Ba,Ve.GLBufferAttribute=sy,Ve.GLSL1=X0,Ve.GLSL3=yl,Ve.GreaterDepth=Ue,Ve.GreaterEqualDepth=pt,Ve.GreaterEqualStencilFunc=Pc,Ve.GreaterStencilFunc=G0,Ve.GridHelper=vy,Ve.Group=Jl,Ve.HalfFloatType=zr,Ve.HemisphereLight=fc,Ve.HemisphereLightHelper=b_,Ve.HemisphereLightProbe=Zg,Ve.IcosahedronBufferGeometry=yf,Ve.IcosahedronGeometry=yf,Ve.ImageBitmapLoader=qg,Ve.ImageLoader=i0,Ve.ImageUtils=Ia,Ve.ImmediateRenderObject=dx,Ve.IncrementStencilOp=U0,Ve.IncrementWrapStencilOp=Rc,Ve.InstancedBufferAttribute=rc,Ve.InstancedBufferGeometry=Am,Ve.InstancedInterleavedBuffer=ay,Ve.InstancedMesh=Bp,Ve.Int16Attribute=Q_,Ve.Int16BufferAttribute=Hc,Ve.Int32Attribute=ex,Ve.Int32BufferAttribute=vd,Ve.Int8Attribute=Y_,Ve.Int8BufferAttribute=qu,Ve.IntType=fr,Ve.InterleavedBuffer=$l,Ve.InterleavedBufferAttribute=il,Ve.Interpolant=Eu,Ve.InterpolateDiscrete=lu,Ve.InterpolateLinear=cu,Ve.InterpolateSmooth=ts,Ve.InvertStencilOp=od,Ve.JSONLoader=ox,Ve.KeepStencilOp=Nu,Ve.KeyframeTrack=ks,Ve.LOD=Kl,Ve.LatheBufferGeometry=_f,Ve.LatheGeometry=_f,Ve.Layers=Ll,Ve.LensFlare=lx,Ve.LessDepth=Ee,Ve.LessEqualDepth=Fe,Ve.LessEqualStencilFunc=gl,Ve.LessStencilFunc=Cc,Ve.Light=Ao,Ve.LightProbe=Bh,Ve.Line=jo,Ve.Line3=cy,Ve.LineBasicMaterial=Ji,Ve.LineCurve=Sh,Ve.LineCurve3=_g,Ve.LineDashedMaterial=lm,Ve.LineLoop=zp,Ve.LinePieces=k_,Ve.LineSegments=Ts,Ve.LineStrip=I_,Ve.LinearEncoding=fi,Ve.LinearFilter=at,Ve.LinearInterpolant=Ih,Ve.LinearMipMapLinearFilter=St,Ve.LinearMipMapNearestFilter=ht,Ve.LinearMipmapLinearFilter=_t,Ve.LinearMipmapNearestFilter=wt,Ve.LinearToneMapping=ye,Ve.Loader=hs,Ve.LoaderUtils=a0,Ve.LoadingManager=hm,Ve.LoopOnce=Gf,Ve.LoopPingPong=ca,Ve.LoopRepeat=Fa,Ve.LuminanceAlphaFormat=_n,Ve.LuminanceFormat=ri,Ve.MOUSE=u,Ve.Material=Ti,Ve.MaterialLoader=Vg,Ve.Math=r,Ve.MathUtils=r,Ve.Matrix3=Yt,Ve.Matrix4=jr,Ve.MaxEquation=Z,Ve.Mesh=ra,Ve.MeshBasicMaterial=co,Ve.MeshDepthMaterial=Dd,Ve.MeshDistanceMaterial=hh,Ve.MeshFaceMaterial=U_,Ve.MeshLambertMaterial=om,Ve.MeshMatcapMaterial=um,Ve.MeshNormalMaterial=sm,Ve.MeshPhongMaterial=im,Ve.MeshPhysicalMaterial=nm,Ve.MeshStandardMaterial=r0,Ve.MeshToonMaterial=am,Ve.MinEquation=Q,Ve.MirroredRepeatWrapping=re,Ve.MixOperation=ze,Ve.MultiMaterial=z_,Ve.MultiplyBlending=N,Ve.MultiplyOperation=et,Ve.NearestFilter=oe,Ve.NearestMipMapLinearFilter=Be,Ve.NearestMipMapNearestFilter=Re,Ve.NearestMipmapLinearFilter=ke,Ve.NearestMipmapNearestFilter=_e,Ve.NeverDepth=Y,Ve.NeverStencilFunc=hu,Ve.NoBlending=b,Ve.NoColors=D_,Ve.NoToneMapping=tt,Ve.NormalAnimationBlendMode=ki,Ve.NormalBlending=_,Ve.NotEqualDepth=Je,Ve.NotEqualStencilFunc=du,Ve.NumberKeyframeTrack=kh,Ve.Object3D=Gn,Ve.ObjectLoader=a_,Ve.ObjectSpaceNormalMap=Du,Ve.OctahedronBufferGeometry=xo,Ve.OctahedronGeometry=xo,Ve.OneFactor=F,Ve.OneMinusDstAlphaFactor=K,Ve.OneMinusDstColorFactor=se,Ve.OneMinusSrcAlphaFactor=G,Ve.OneMinusSrcColorFactor=O,Ve.OrthographicCamera=rf,Ve.PCFShadowMap=g,Ve.PCFSoftShadowMap=C,Ve.PMREMGenerator=Ap,Ve.ParametricGeometry=gc,Ve.Particle=V_,Ve.ParticleBasicMaterial=q_,Ve.ParticleSystem=W_,Ve.ParticleSystemMaterial=X_,Ve.Path=Rh,Ve.PerspectiveCamera=da,Ve.Plane=Ys,Ve.PlaneBufferGeometry=po,Ve.PlaneGeometry=po,Ve.PlaneHelper=C_,Ve.PointCloud=G_,Ve.PointCloudMaterial=H_,Ve.PointLight=vm,Ve.PointLightHelper=w_,Ve.Points=wh,Ve.PointsMaterial=ac,Ve.PolarGridHelper=E_,Ve.PolyhedronBufferGeometry=Yo,Ve.PolyhedronGeometry=Yo,Ve.PositionalAudio=c_,Ve.PropertyBinding=ui,Ve.PropertyMixer=ty,Ve.QuadraticBezierCurve=$d,Ve.QuadraticBezierCurve3=Qd,Ve.Quaternion=ha,Ve.QuaternionKeyframeTrack=Tf,Ve.QuaternionLinearInterpolant=Pg,Ve.REVISION=a,Ve.RGBADepthPacking=_s,Ve.RGBAFormat=xn,Ve.RGBAIntegerFormat=Ou,Ve.RGBA_ASTC_10x10_Format=zf,Ve.RGBA_ASTC_10x5_Format=ro,Ve.RGBA_ASTC_10x6_Format=es,Ve.RGBA_ASTC_10x8_Format=Pi,Ve.RGBA_ASTC_12x10_Format=zs,Ve.RGBA_ASTC_12x12_Format=vl,Ve.RGBA_ASTC_4x4_Format=bn,Ve.RGBA_ASTC_5x4_Format=Rn,Ve.RGBA_ASTC_5x5_Format=Xa,Ve.RGBA_ASTC_6x5_Format=Hi,Ve.RGBA_ASTC_6x6_Format=Tn,Ve.RGBA_ASTC_8x5_Format=Ec,Ve.RGBA_ASTC_8x6_Format=Iu,Ve.RGBA_ASTC_8x8_Format=ku,Ve.RGBA_BPTC_Format=uu,Ve.RGBA_ETC2_EAC_Format=wr,Ve.RGBA_PVRTC_2BPPV1_Format=ou,Ve.RGBA_PVRTC_4BPPV1_Format=la,Ve.RGBA_S3TC_DXT1_Format=Us,Ve.RGBA_S3TC_DXT3_Format=Ka,Ve.RGBA_S3TC_DXT5_Format=Fu,Ve.RGBFormat=_i,Ve.RGB_ETC1_Format=ml,Ve.RGB_ETC2_Format=qa,Ve.RGB_PVRTC_2BPPV1_Format=gs,Ve.RGB_PVRTC_4BPPV1_Format=vs,Ve.RGB_S3TC_DXT1_Format=ms,Ve.RGFormat=Ha,Ve.RGIntegerFormat=to,Ve.RawShaderMaterial=Mu,Ve.Ray=Co,Ve.Raycaster=y_,Ve.RectAreaLight=_m,Ve.RedFormat=ss,Ve.RedIntegerFormat=Ii,Ve.ReinhardToneMapping=Ze,Ve.RepeatWrapping=bt,Ve.ReplaceStencilOp=Bu,Ve.ReverseSubtractEquation=te,Ve.RingBufferGeometry=xf,Ve.RingGeometry=xf,Ve.Scene=nl,Ve.SceneUtils=ux,Ve.ShaderChunk=Kn,Ve.ShaderLib=Qa,Ve.ShaderMaterial=Jn,Ve.ShadowMaterial=rm,Ve.Shape=Jo,Ve.ShapeBufferGeometry=sc,Ve.ShapeGeometry=sc,Ve.ShapePath=L_,Ve.ShapeUtils=$o,Ve.ShortType=ct,Ve.Skeleton=_h,Ve.SkeletonHelper=hy,Ve.SkinnedMesh=hf,Ve.SmoothShading=E,Ve.Sphere=mu,Ve.SphereBufferGeometry=oc,Ve.SphereGeometry=oc,Ve.Spherical=__,Ve.SphericalHarmonics3=xm,Ve.SplineCurve=Kd,Ve.SpotLight=pm,Ve.SpotLightHelper=A_,Ve.Sprite=Gd,Ve.SpriteMaterial=Bd,Ve.SrcAlphaFactor=X,Ve.SrcAlphaSaturateFactor=ue,Ve.SrcColorFactor=W,Ve.StaticCopyUsage=H0,Ve.StaticDrawUsage=Uu,Ve.StaticReadUsage=V0,Ve.StereoCamera=s_,Ve.StreamCopyUsage=cd,Ve.StreamDrawUsage=Vf,Ve.StreamReadUsage=ld,Ve.StringKeyframeTrack=lc,Ve.SubtractEquation=q,Ve.SubtractiveBlending=T,Ve.TOUCH=h,Ve.TangentSpaceNormalMap=Gs,Ve.TetrahedronBufferGeometry=Af,Ve.TetrahedronGeometry=Af,Ve.TextGeometry=cx,Ve.Texture=Cn,Ve.TextureLoader=Ig,Ve.TorusBufferGeometry=wf,Ve.TorusGeometry=wf,Ve.TorusKnotBufferGeometry=Mf,Ve.TorusKnotGeometry=Mf,Ve.Triangle=zi,Ve.TriangleFanDrawMode=B0,Ve.TriangleStripDrawMode=ys,Ve.TrianglesDrawMode=Tc,Ve.TubeBufferGeometry=bf,Ve.TubeGeometry=bf,Ve.UVMapping=Te,Ve.Uint16Attribute=K_,Ve.Uint16BufferAttribute=qc,Ve.Uint32Attribute=tx,Ve.Uint32BufferAttribute=Dl,Ve.Uint8Attribute=J_,Ve.Uint8BufferAttribute=$f,Ve.Uint8ClampedAttribute=$_,Ve.Uint8ClampedBufferAttribute=Wc,Ve.Uniform=u0,Ve.UniformsLib=Pr,Ve.UniformsUtils=gd,Ve.UnsignedByteType=Ct,Ve.UnsignedInt248Type=tn,Ve.UnsignedIntType=er,Ve.UnsignedShort4444Type=Ut,Ve.UnsignedShort5551Type=on,Ve.UnsignedShortType=Dt,Ve.VSMShadowMap=D,Ve.Vector2=We,Ve.Vector3=dt,Ve.Vector4=cn,Ve.VectorKeyframeTrack=Dh,Ve.Vertex=Z_,Ve.VertexColors=B_,Ve.VideoTexture=mg,Ve.WebGL1Renderer=eg,Ve.WebGLCubeRenderTarget=_u,Ve.WebGLMultipleRenderTargets=oi,Ve.WebGLMultisampleRenderTarget=El,Ve.WebGLRenderTarget=Ta,Ve.WebGLRenderTargetCube=ax,Ve.WebGLRenderer=Ri,Ve.WebGLUtils=Kv,Ve.WireframeGeometry=Ef,Ve.WireframeHelper=by,Ve.WrapAroundEnding=Eo,Ve.XHRLoader=m0,Ve.ZeroCurvatureEnding=fa,Ve.ZeroFactor=ae,Ve.ZeroSlopeEnding=bo,Ve.ZeroStencilOp=sd,Ve._SRGBAFormat=_l,Ve.sRGBEncoding=xi,Ve}var Tx={};function X3(a){a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),a.WGS84=a["EPSG:4326"],a["EPSG:3785"]=a["EPSG:3857"],a.GOOGLE=a["EPSG:3857"],a["EPSG:900913"]=a["EPSG:3857"],a["EPSG:102113"]=a["EPSG:3857"]}var jh=1,Yh=2,Uy=3,Z3=4,FM=5,Db=6378137,j3=6356752314e-3,Nb=.0066943799901413165,jm=484813681109536e-20,Tr=Math.PI/2,Y3=.16666666666666666,J3=.04722222222222222,$3=.022156084656084655,Ur=1e-10,ds=.017453292519943295,ll=57.29577951308232,Oi=Math.PI/4,Ym=Math.PI*2,Oa=3.14159265359,eo={};eo.greenwich=0;eo.lisbon=-9.131906111111;eo.paris=2.337229166667;eo.bogota=-74.080916666667;eo.madrid=-3.687938888889;eo.rome=12.452333333333;eo.bern=7.439583333333;eo.jakarta=106.807719444444;eo.ferro=-17.666666666667;eo.brussels=4.367975;eo.stockholm=18.058277777778;eo.athens=23.7163375;eo.oslo=10.722916666667;const Q3={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var Bb=/[\s_\-\/\(\)]/g;function Df(a,u){if(a[u])return a[u];for(var h=Object.keys(a),R=u.toLowerCase().replace(Bb,""),M=-1,v,y;++M<h.length;)if(v=h[M],y=v.toLowerCase().replace(Bb,""),y===R)return a[v]}function IM(a){var u={},h=a.split("+").map(function(p){return p.trim()}).filter(function(p){return p}).reduce(function(p,g){var C=g.split("=");return C.push(!0),p[C[0].toLowerCase()]=C[1],p},{}),R,M,v,y={proj:"projName",datum:"datumCode",rf:function(p){u.rf=parseFloat(p)},lat_0:function(p){u.lat0=p*ds},lat_1:function(p){u.lat1=p*ds},lat_2:function(p){u.lat2=p*ds},lat_ts:function(p){u.lat_ts=p*ds},lon_0:function(p){u.long0=p*ds},lon_1:function(p){u.long1=p*ds},lon_2:function(p){u.long2=p*ds},alpha:function(p){u.alpha=parseFloat(p)*ds},gamma:function(p){u.rectified_grid_angle=parseFloat(p)},lonc:function(p){u.longc=p*ds},x_0:function(p){u.x0=parseFloat(p)},y_0:function(p){u.y0=parseFloat(p)},k_0:function(p){u.k0=parseFloat(p)},k:function(p){u.k0=parseFloat(p)},a:function(p){u.a=parseFloat(p)},b:function(p){u.b=parseFloat(p)},r_a:function(){u.R_A=!0},zone:function(p){u.zone=parseInt(p,10)},south:function(){u.utmSouth=!0},towgs84:function(p){u.datum_params=p.split(",").map(function(g){return parseFloat(g)})},to_meter:function(p){u.to_meter=parseFloat(p)},units:function(p){u.units=p;var g=Df(Q3,p);g&&(u.to_meter=g.to_meter)},from_greenwich:function(p){u.from_greenwich=p*ds},pm:function(p){var g=Df(eo,p);u.from_greenwich=(g||parseFloat(p))*ds},nadgrids:function(p){p==="@null"?u.datumCode="none":u.nadgrids=p},axis:function(p){var g="ewnsud";p.length===3&&g.indexOf(p.substr(0,1))!==-1&&g.indexOf(p.substr(1,1))!==-1&&g.indexOf(p.substr(2,1))!==-1&&(u.axis=p)},approx:function(){u.approx=!0}};for(R in h)M=h[R],R in y?(v=y[R],typeof v=="function"?v(M):u[v]=M):u[R]=M;return typeof u.datumCode=="string"&&u.datumCode!=="WGS84"&&(u.datumCode=u.datumCode.toLowerCase()),u}var Jm=1,xR=2,AR=3,Wy=4,wR=5,BM=-1,K3=/\s/,eP=/[A-Za-z]/,tP=/[A-Za-z84_]/,e2=/[,\]]/,MR=/[\d\.E\-\+]/;function bc(a){if(typeof a!="string")throw new Error("not a string");this.text=a.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=Jm}bc.prototype.readCharicter=function(){var a=this.text[this.place++];if(this.state!==Wy)for(;K3.test(a);){if(this.place>=this.text.length)return;a=this.text[this.place++]}switch(this.state){case Jm:return this.neutral(a);case xR:return this.keyword(a);case Wy:return this.quoted(a);case wR:return this.afterquote(a);case AR:return this.number(a);case BM:return}};bc.prototype.afterquote=function(a){if(a==='"'){this.word+='"',this.state=Wy;return}if(e2.test(a)){this.word=this.word.trim(),this.afterItem(a);return}throw new Error(`havn't handled "`+a+'" in afterquote yet, index '+this.place)};bc.prototype.afterItem=function(a){if(a===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=Jm;return}if(a==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=Jm,this.currentObject=this.stack.pop(),this.currentObject||(this.state=BM);return}};bc.prototype.number=function(a){if(MR.test(a)){this.word+=a;return}if(e2.test(a)){this.word=parseFloat(this.word),this.afterItem(a);return}throw new Error(`havn't handled "`+a+'" in number yet, index '+this.place)};bc.prototype.quoted=function(a){if(a==='"'){this.state=wR;return}this.word+=a};bc.prototype.keyword=function(a){if(tP.test(a)){this.word+=a;return}if(a==="["){var u=[];u.push(this.word),this.level++,this.root===null?this.root=u:this.currentObject.push(u),this.stack.push(this.currentObject),this.currentObject=u,this.state=Jm;return}if(e2.test(a)){this.afterItem(a);return}throw new Error(`havn't handled "`+a+'" in keyword yet, index '+this.place)};bc.prototype.neutral=function(a){if(eP.test(a)){this.word=a,this.state=xR;return}if(a==='"'){this.word="",this.state=Wy;return}if(MR.test(a)){this.word=a,this.state=AR;return}if(e2.test(a)){this.afterItem(a);return}throw new Error(`havn't handled "`+a+'" in neutral yet, index '+this.place)};bc.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===BM)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function rP(a){var u=new bc(a);return u.output()}function Ub(a,u,h){Array.isArray(u)&&(h.unshift(u),u=null);var R=u?{}:a,M=h.reduce(function(v,y){return w0(y,v),v},R);u&&(a[u]=M)}function w0(a,u){if(!Array.isArray(a)){u[a]=!0;return}var h=a.shift();if(h==="PARAMETER"&&(h=a.shift()),a.length===1){if(Array.isArray(a[0])){u[h]={},w0(a[0],u[h]);return}u[h]=a[0];return}if(!a.length){u[h]=!0;return}if(h==="TOWGS84"){u[h]=a;return}if(h==="AXIS"){h in u||(u[h]=[]),u[h].push(a);return}Array.isArray(h)||(u[h]={});var R;switch(h){case"UNIT":case"PRIMEM":case"VERT_DATUM":u[h]={name:a[0].toLowerCase(),convert:a[1]},a.length===3&&w0(a[2],u[h]);return;case"SPHEROID":case"ELLIPSOID":u[h]={name:a[0],a:a[1],rf:a[2]},a.length===4&&w0(a[3],u[h]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":a[0]=["name",a[0]],Ub(u,h,a);return;default:for(R=-1;++R<a.length;)if(!Array.isArray(a[R]))return w0(a,u[h]);return Ub(u,h,a)}}var nP=.017453292519943295;function iP(a,u){var h=u[0],R=u[1];!(h in a)&&R in a&&(a[h]=a[R],u.length===3&&(a[h]=u[2](a[h])))}function xc(a){return a*nP}function aP(a){if(a.type==="GEOGCS"?a.projName="longlat":a.type==="LOCAL_CS"?(a.projName="identity",a.local=!0):typeof a.PROJECTION=="object"?a.projName=Object.keys(a.PROJECTION)[0]:a.projName=a.PROJECTION,a.AXIS){for(var u="",h=0,R=a.AXIS.length;h<R;++h){var M=[a.AXIS[h][0].toLowerCase(),a.AXIS[h][1].toLowerCase()];M[0].indexOf("north")!==-1||(M[0]==="y"||M[0]==="lat")&&M[1]==="north"?u+="n":M[0].indexOf("south")!==-1||(M[0]==="y"||M[0]==="lat")&&M[1]==="south"?u+="s":M[0].indexOf("east")!==-1||(M[0]==="x"||M[0]==="lon")&&M[1]==="east"?u+="e":(M[0].indexOf("west")!==-1||(M[0]==="x"||M[0]==="lon")&&M[1]==="west")&&(u+="w")}u.length===2&&(u+="u"),u.length===3&&(a.axis=u)}a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),a.units==="metre"&&(a.units="meter"),a.UNIT.convert&&(a.type==="GEOGCS"?a.DATUM&&a.DATUM.SPHEROID&&(a.to_meter=a.UNIT.convert*a.DATUM.SPHEROID.a):a.to_meter=a.UNIT.convert));var v=a.GEOGCS;a.type==="GEOGCS"&&(v=a),v&&(v.DATUM?a.datumCode=v.DATUM.name.toLowerCase():a.datumCode=v.name.toLowerCase(),a.datumCode.slice(0,2)==="d_"&&(a.datumCode=a.datumCode.slice(2)),(a.datumCode==="new_zealand_geodetic_datum_1949"||a.datumCode==="new_zealand_1949")&&(a.datumCode="nzgd49"),(a.datumCode==="wgs_1984"||a.datumCode==="world_geodetic_system_1984")&&(a.PROJECTION==="Mercator_Auxiliary_Sphere"&&(a.sphere=!0),a.datumCode="wgs84"),a.datumCode.slice(-6)==="_ferro"&&(a.datumCode=a.datumCode.slice(0,-6)),a.datumCode.slice(-8)==="_jakarta"&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),v.DATUM&&v.DATUM.SPHEROID&&(a.ellps=v.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),a.ellps.toLowerCase().slice(0,13)==="international"&&(a.ellps="intl"),a.a=v.DATUM.SPHEROID.a,a.rf=parseFloat(v.DATUM.SPHEROID.rf,10)),v.DATUM&&v.DATUM.TOWGS84&&(a.datum_params=v.DATUM.TOWGS84),~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36"),~a.datumCode.indexOf("osni_1952")&&(a.datumCode="osni52"),(~a.datumCode.indexOf("tm65")||~a.datumCode.indexOf("geodetic_datum_of_1965"))&&(a.datumCode="ire65"),a.datumCode==="ch1903+"&&(a.datumCode="ch1903"),~a.datumCode.indexOf("israel")&&(a.datumCode="isr93")),a.b&&!isFinite(a.b)&&(a.b=a.a);function y(C){var D=a.to_meter||1;return C*D}var p=function(C){return iP(a,C)},g=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",xc],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",xc],["x0","false_easting",y],["y0","false_northing",y],["long0","central_meridian",xc],["lat0","latitude_of_origin",xc],["lat0","standard_parallel_1",xc],["lat1","standard_parallel_1",xc],["lat2","standard_parallel_2",xc],["azimuth","Azimuth"],["alpha","azimuth",xc],["srsCode","name"]];g.forEach(p),!a.long0&&a.longc&&(a.projName==="Albers_Conic_Equal_Area"||a.projName==="Lambert_Azimuthal_Equal_Area")&&(a.long0=a.longc),!a.lat_ts&&a.lat1&&(a.projName==="Stereographic_South_Pole"||a.projName==="Polar Stereographic (variant B)")&&(a.lat0=xc(a.lat1>0?90:-90),a.lat_ts=a.lat1)}function bR(a){var u=rP(a),h=u.shift(),R=u.shift();u.unshift(["name",R]),u.unshift(["type",h]);var M={};return w0(u,M),aP(M),M}function Ns(a){var u=this;if(arguments.length===2){var h=arguments[1];typeof h=="string"?h.charAt(0)==="+"?Ns[a]=IM(arguments[1]):Ns[a]=bR(arguments[1]):Ns[a]=h}else if(arguments.length===1){if(Array.isArray(a))return a.map(function(R){Array.isArray(R)?Ns.apply(u,R):Ns(R)});if(typeof a=="string"){if(a in Ns)return Ns[a]}else"EPSG"in a?Ns["EPSG:"+a.EPSG]=a:"ESRI"in a?Ns["ESRI:"+a.ESRI]=a:"IAU2000"in a?Ns["IAU2000:"+a.IAU2000]=a:console.log(a);return}}X3(Ns);function sP(a){return typeof a=="string"}function oP(a){return a in Ns}var uP=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function lP(a){return uP.some(function(u){return a.indexOf(u)>-1})}var cP=["3857","900913","3785","102113"];function fP(a){var u=Df(a,"authority");if(!!u){var h=Df(u,"epsg");return h&&cP.indexOf(h)>-1}}function hP(a){var u=Df(a,"extension");if(!!u)return Df(u,"proj4")}function dP(a){return a[0]==="+"}function pP(a){if(sP(a)){if(oP(a))return Ns[a];if(lP(a)){var u=bR(a);if(fP(u))return Ns["EPSG:3857"];var h=hP(u);return h?IM(h):u}if(dP(a))return IM(a)}else return a}function zb(a,u){a=a||{};var h,R;if(!u)return a;for(R in u)h=u[R],h!==void 0&&(a[R]=h);return a}function fl(a,u,h){var R=a*u;return h/Math.sqrt(1-R*R)}function Km(a){return a<0?-1:1}function $r(a){return Math.abs(a)<=Oa?a:a-Km(a)*Ym}function Lu(a,u,h){var R=a*h,M=.5*a;return R=Math.pow((1-R)/(1+R),M),Math.tan(.5*(Tr-u))/R}function $m(a,u){for(var h=.5*a,R,M,v=Tr-2*Math.atan(u),y=0;y<=15;y++)if(R=a*Math.sin(v),M=Tr-2*Math.atan(u*Math.pow((1-R)/(1+R),h))-v,v+=M,Math.abs(M)<=1e-10)return v;return-9999}function mP(){var a=this.b/this.a;this.es=1-a*a,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=fl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function vP(a){var u=a.x,h=a.y;if(h*ll>90&&h*ll<-90&&u*ll>180&&u*ll<-180)return null;var R,M;if(Math.abs(Math.abs(h)-Tr)<=Ur)return null;if(this.sphere)R=this.x0+this.a*this.k0*$r(u-this.long0),M=this.y0+this.a*this.k0*Math.log(Math.tan(Oi+.5*h));else{var v=Math.sin(h),y=Lu(this.e,h,v);R=this.x0+this.a*this.k0*$r(u-this.long0),M=this.y0-this.a*this.k0*Math.log(y)}return a.x=R,a.y=M,a}function gP(a){var u=a.x-this.x0,h=a.y-this.y0,R,M;if(this.sphere)M=Tr-2*Math.atan(Math.exp(-h/(this.a*this.k0)));else{var v=Math.exp(-h/(this.a*this.k0));if(M=$m(this.e,v),M===-9999)return null}return R=$r(this.long0+u/(this.a*this.k0)),a.x=R,a.y=M,a}var yP=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const _P={init:mP,forward:vP,inverse:gP,names:yP};function xP(){}function Gb(a){return a}var AP=["longlat","identity"];const wP={init:xP,forward:Gb,inverse:Gb,names:AP};var MP=[_P,wP],zy={},Hy=[];function ER(a,u){var h=Hy.length;return a.names?(Hy[h]=a,a.names.forEach(function(R){zy[R.toLowerCase()]=h}),this):(console.log(u),!0)}function bP(a){if(!a)return!1;var u=a.toLowerCase();if(typeof zy[u]<"u"&&Hy[zy[u]])return Hy[zy[u]]}function EP(){MP.forEach(ER)}const TP={start:EP,add:ER,get:bP};var qn={};qn.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};qn.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};qn.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};qn.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};qn.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};qn.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};qn.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};qn.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};qn.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};qn.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};qn.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};qn.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};qn.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};qn.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};qn.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};qn.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};qn.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};qn.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};qn.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};qn.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};qn.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};qn.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};qn.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};qn.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};qn.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};qn.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};qn.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};qn.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};qn.hough={a:6378270,rf:297,ellipseName:"Hough"};qn.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};qn.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};qn.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};qn.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};qn.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};qn.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};qn.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};qn.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};qn.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};qn.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};qn.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};qn.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var SP=qn.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};qn.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function RP(a,u,h,R){var M=a*a,v=u*u,y=(M-v)/M,p=0;R?(a*=1-y*(Y3+y*(J3+y*$3)),M=a*a,y=0):p=Math.sqrt(y);var g=(M-v)/v;return{es:y,e:p,ep2:g}}function CP(a,u,h,R,M){if(!a){var v=Df(qn,R);v||(v=SP),a=v.a,u=v.b,h=v.rf}return h&&!u&&(u=(1-1/h)*a),(h===0||Math.abs(a-u)<Ur)&&(M=!0,u=a),{a,b:u,rf:h,sphere:M}}var as={};as.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};as.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};as.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};as.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};as.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};as.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};as.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};as.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"};as.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"};as.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};as.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};as.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};as.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};as.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};as.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};as.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};as.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function PP(a,u,h,R,M,v,y){var p={};return a===void 0||a==="none"?p.datum_type=FM:p.datum_type=Z3,u&&(p.datum_params=u.map(parseFloat),(p.datum_params[0]!==0||p.datum_params[1]!==0||p.datum_params[2]!==0)&&(p.datum_type=jh),p.datum_params.length>3&&(p.datum_params[3]!==0||p.datum_params[4]!==0||p.datum_params[5]!==0||p.datum_params[6]!==0)&&(p.datum_type=Yh,p.datum_params[3]*=jm,p.datum_params[4]*=jm,p.datum_params[5]*=jm,p.datum_params[6]=p.datum_params[6]/1e6+1)),y&&(p.datum_type=Uy,p.grids=y),p.a=h,p.b=R,p.es=M,p.ep2=v,p}var TR={};function LP(a,u){var h=new DataView(u),R=IP(h),M=kP(h,R);M.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var v=DP(h,M,R),y={header:M,subgrids:v};return TR[a]=y,y}function OP(a){if(a===void 0)return null;var u=a.split(",");return u.map(FP)}function FP(a){if(a.length===0)return null;var u=a[0]==="@";return u&&(a=a.slice(1)),a==="null"?{name:"null",mandatory:!u,grid:null,isNull:!0}:{name:a,mandatory:!u,grid:TR[a]||null,isNull:!1}}function M0(a){return a/3600*Math.PI/180}function IP(a){var u=a.getInt32(8,!1);return u===11?!1:(u=a.getInt32(8,!0),u!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function kP(a,u){return{nFields:a.getInt32(8,u),nSubgridFields:a.getInt32(24,u),nSubgrids:a.getInt32(40,u),shiftType:kM(a,56,56+8).trim(),fromSemiMajorAxis:a.getFloat64(120,u),fromSemiMinorAxis:a.getFloat64(136,u),toSemiMajorAxis:a.getFloat64(152,u),toSemiMinorAxis:a.getFloat64(168,u)}}function kM(a,u,h){return String.fromCharCode.apply(null,new Uint8Array(a.buffer.slice(u,h)))}function DP(a,u,h){for(var R=176,M=[],v=0;v<u.nSubgrids;v++){var y=BP(a,R,h),p=UP(a,R,y,h),g=Math.round(1+(y.upperLongitude-y.lowerLongitude)/y.longitudeInterval),C=Math.round(1+(y.upperLatitude-y.lowerLatitude)/y.latitudeInterval);M.push({ll:[M0(y.lowerLongitude),M0(y.lowerLatitude)],del:[M0(y.longitudeInterval),M0(y.latitudeInterval)],lim:[g,C],count:y.gridNodeCount,cvs:NP(p)})}return M}function NP(a){return a.map(function(u){return[M0(u.longitudeShift),M0(u.latitudeShift)]})}function BP(a,u,h){return{name:kM(a,u+8,u+16).trim(),parent:kM(a,u+24,u+24+8).trim(),lowerLatitude:a.getFloat64(u+72,h),upperLatitude:a.getFloat64(u+88,h),lowerLongitude:a.getFloat64(u+104,h),upperLongitude:a.getFloat64(u+120,h),latitudeInterval:a.getFloat64(u+136,h),longitudeInterval:a.getFloat64(u+152,h),gridNodeCount:a.getInt32(u+168,h)}}function UP(a,u,h,R){for(var M=u+176,v=16,y=[],p=0;p<h.gridNodeCount;p++){var g={latitudeShift:a.getFloat32(M+p*v,R),longitudeShift:a.getFloat32(M+p*v+4,R),latitudeAccuracy:a.getFloat32(M+p*v+8,R),longitudeAccuracy:a.getFloat32(M+p*v+12,R)};y.push(g)}return y}function cl(a,u){if(!(this instanceof cl))return new cl(a);u=u||function(C){if(C)throw C};var h=pP(a);if(typeof h!="object"){u(a);return}var R=cl.projections.get(h.projName);if(!R){u(a);return}if(h.datumCode&&h.datumCode!=="none"){var M=Df(as,h.datumCode);M&&(h.datum_params=h.datum_params||(M.towgs84?M.towgs84.split(","):null),h.ellps=M.ellipse,h.datumName=M.datumName?M.datumName:h.datumCode)}h.k0=h.k0||1,h.axis=h.axis||"enu",h.ellps=h.ellps||"wgs84",h.lat1=h.lat1||h.lat0;var v=CP(h.a,h.b,h.rf,h.ellps,h.sphere),y=RP(v.a,v.b,v.rf,h.R_A),p=OP(h.nadgrids),g=h.datum||PP(h.datumCode,h.datum_params,v.a,v.b,y.es,y.ep2,p);zb(this,h),zb(this,R),this.a=v.a,this.b=v.b,this.rf=v.rf,this.sphere=v.sphere,this.es=y.es,this.e=y.e,this.ep2=y.ep2,this.datum=g,this.init(),u(null,this)}cl.projections=TP;cl.projections.start();function zP(a,u){return a.datum_type!==u.datum_type||a.a!==u.a||Math.abs(a.es-u.es)>5e-11?!1:a.datum_type===jh?a.datum_params[0]===u.datum_params[0]&&a.datum_params[1]===u.datum_params[1]&&a.datum_params[2]===u.datum_params[2]:a.datum_type===Yh?a.datum_params[0]===u.datum_params[0]&&a.datum_params[1]===u.datum_params[1]&&a.datum_params[2]===u.datum_params[2]&&a.datum_params[3]===u.datum_params[3]&&a.datum_params[4]===u.datum_params[4]&&a.datum_params[5]===u.datum_params[5]&&a.datum_params[6]===u.datum_params[6]:!0}function SR(a,u,h){var R=a.x,M=a.y,v=a.z?a.z:0,y,p,g,C;if(M<-Tr&&M>-1.001*Tr)M=-Tr;else if(M>Tr&&M<1.001*Tr)M=Tr;else{if(M<-Tr)return{x:-1/0,y:-1/0,z:a.z};if(M>Tr)return{x:1/0,y:1/0,z:a.z}}return R>Math.PI&&(R-=2*Math.PI),p=Math.sin(M),C=Math.cos(M),g=p*p,y=h/Math.sqrt(1-u*g),{x:(y+v)*C*Math.cos(R),y:(y+v)*C*Math.sin(R),z:(y*(1-u)+v)*p}}function RR(a,u,h,R){var M=1e-12,v=M*M,y=30,p,g,C,D,B,V,P,L,E,b,_,x,T,N=a.x,U=a.y,H=a.z?a.z:0,q,te,Q;if(p=Math.sqrt(N*N+U*U),g=Math.sqrt(N*N+U*U+H*H),p/h<M){if(q=0,g/h<M)return te=Tr,Q=-R,{x:a.x,y:a.y,z:a.z}}else q=Math.atan2(U,N);C=H/g,D=p/g,B=1/Math.sqrt(1-u*(2-u)*D*D),L=D*(1-u)*B,E=C*B,T=0;do T++,P=h/Math.sqrt(1-u*E*E),Q=p*L+H*E-P*(1-u*E*E),V=u*P/(P+Q),B=1/Math.sqrt(1-V*(2-V)*D*D),b=D*(1-V)*B,_=C*B,x=_*L-b*E,L=b,E=_;while(x*x>v&&T<y);return te=Math.atan(_/Math.abs(b)),{x:q,y:te,z:Q}}function GP(a,u,h){if(u===jh)return{x:a.x+h[0],y:a.y+h[1],z:a.z+h[2]};if(u===Yh){var R=h[0],M=h[1],v=h[2],y=h[3],p=h[4],g=h[5],C=h[6];return{x:C*(a.x-g*a.y+p*a.z)+R,y:C*(g*a.x+a.y-y*a.z)+M,z:C*(-p*a.x+y*a.y+a.z)+v}}}function VP(a,u,h){if(u===jh)return{x:a.x-h[0],y:a.y-h[1],z:a.z-h[2]};if(u===Yh){var R=h[0],M=h[1],v=h[2],y=h[3],p=h[4],g=h[5],C=h[6],D=(a.x-R)/C,B=(a.y-M)/C,V=(a.z-v)/C;return{x:D+g*B-p*V,y:-g*D+B+y*V,z:p*D-y*B+V}}}function Fy(a){return a===jh||a===Yh}function WP(a,u,h){if(zP(a,u)||a.datum_type===FM||u.datum_type===FM)return h;var R=a.a,M=a.es;if(a.datum_type===Uy){var v=Vb(a,!1,h);if(v!==0)return;R=Db,M=Nb}var y=u.a,p=u.b,g=u.es;if(u.datum_type===Uy&&(y=Db,p=j3,g=Nb),M===g&&R===y&&!Fy(a.datum_type)&&!Fy(u.datum_type))return h;if(h=SR(h,M,R),Fy(a.datum_type)&&(h=GP(h,a.datum_type,a.datum_params)),Fy(u.datum_type)&&(h=VP(h,u.datum_type,u.datum_params)),h=RR(h,g,y,p),u.datum_type===Uy){var C=Vb(u,!0,h);if(C!==0)return}return h}function Vb(a,u,h){if(a.grids===null||a.grids.length===0)return console.log("Grid shift grids not found"),-1;for(var R={x:-h.x,y:h.y},M={x:Number.NaN,y:Number.NaN},v=[],y=0;y<a.grids.length;y++){var p=a.grids[y];if(v.push(p.name),p.isNull){M=R;break}if(p.mandatory,p.grid===null){if(p.mandatory)return console.log("Unable to find mandatory grid '"+p.name+"'"),-1;continue}var g=p.grid.subgrids[0],C=(Math.abs(g.del[1])+Math.abs(g.del[0]))/1e4,D=g.ll[0]-C,B=g.ll[1]-C,V=g.ll[0]+(g.lim[0]-1)*g.del[0]+C,P=g.ll[1]+(g.lim[1]-1)*g.del[1]+C;if(!(B>R.y||D>R.x||P<R.y||V<R.x)&&(M=HP(R,u,g),!isNaN(M.x)))break}return isNaN(M.x)?(console.log("Failed to find a grid shift table for location '"+-R.x*ll+" "+R.y*ll+" tried: '"+v+"'"),-1):(h.x=-M.x,h.y=M.y,0)}function HP(a,u,h){var R={x:Number.NaN,y:Number.NaN};if(isNaN(a.x))return R;var M={x:a.x,y:a.y};M.x-=h.ll[0],M.y-=h.ll[1],M.x=$r(M.x-Math.PI)+Math.PI;var v=Wb(M,h);if(u){if(isNaN(v.x))return R;v.x=M.x-v.x,v.y=M.y-v.y;var y=9,p=1e-12,g,C;do{if(C=Wb(v,h),isNaN(C.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}g={x:M.x-(C.x+v.x),y:M.y-(C.y+v.y)},v.x+=g.x,v.y+=g.y}while(y--&&Math.abs(g.x)>p&&Math.abs(g.y)>p);if(y<0)return console.log("Inverse grid shift iterator failed to converge."),R;R.x=$r(v.x+h.ll[0]),R.y=v.y+h.ll[1]}else isNaN(v.x)||(R.x=a.x+v.x,R.y=a.y+v.y);return R}function Wb(a,u){var h={x:a.x/u.del[0],y:a.y/u.del[1]},R={x:Math.floor(h.x),y:Math.floor(h.y)},M={x:h.x-1*R.x,y:h.y-1*R.y},v={x:Number.NaN,y:Number.NaN},y;if(R.x<0||R.x>=u.lim[0]||R.y<0||R.y>=u.lim[1])return v;y=R.y*u.lim[0]+R.x;var p={x:u.cvs[y][0],y:u.cvs[y][1]};y++;var g={x:u.cvs[y][0],y:u.cvs[y][1]};y+=u.lim[0];var C={x:u.cvs[y][0],y:u.cvs[y][1]};y--;var D={x:u.cvs[y][0],y:u.cvs[y][1]},B=M.x*M.y,V=M.x*(1-M.y),P=(1-M.x)*(1-M.y),L=(1-M.x)*M.y;return v.x=P*p.x+V*g.x+L*D.x+B*C.x,v.y=P*p.y+V*g.y+L*D.y+B*C.y,v}function Hb(a,u,h){var R=h.x,M=h.y,v=h.z||0,y,p,g,C={};for(g=0;g<3;g++)if(!(u&&g===2&&h.z===void 0))switch(g===0?(y=R,"ew".indexOf(a.axis[g])!==-1?p="x":p="y"):g===1?(y=M,"ns".indexOf(a.axis[g])!==-1?p="y":p="x"):(y=v,p="z"),a.axis[g]){case"e":C[p]=y;break;case"w":C[p]=-y;break;case"n":C[p]=y;break;case"s":C[p]=-y;break;case"u":h[p]!==void 0&&(C.z=y);break;case"d":h[p]!==void 0&&(C.z=-y);break;default:return null}return C}function CR(a){var u={x:a[0],y:a[1]};return a.length>2&&(u.z=a[2]),a.length>3&&(u.m=a[3]),u}function qP(a){qb(a.x),qb(a.y)}function qb(a){if(typeof Number.isFinite=="function"){if(Number.isFinite(a))return;throw new TypeError("coordinates must be finite numbers")}if(typeof a!="number"||a!==a||!isFinite(a))throw new TypeError("coordinates must be finite numbers")}function XP(a,u){return(a.datum.datum_type===jh||a.datum.datum_type===Yh)&&u.datumCode!=="WGS84"||(u.datum.datum_type===jh||u.datum.datum_type===Yh)&&a.datumCode!=="WGS84"}function qy(a,u,h,R){var M;if(Array.isArray(h)&&(h=CR(h)),qP(h),a.datum&&u.datum&&XP(a,u)&&(M=new cl("WGS84"),h=qy(a,M,h,R),a=M),R&&a.axis!=="enu"&&(h=Hb(a,!1,h)),a.projName==="longlat")h={x:h.x*ds,y:h.y*ds,z:h.z||0};else if(a.to_meter&&(h={x:h.x*a.to_meter,y:h.y*a.to_meter,z:h.z||0}),h=a.inverse(h),!h)return;if(a.from_greenwich&&(h.x+=a.from_greenwich),h=WP(a.datum,u.datum,h),!!h)return u.from_greenwich&&(h={x:h.x-u.from_greenwich,y:h.y,z:h.z||0}),u.projName==="longlat"?h={x:h.x*ll,y:h.y*ll,z:h.z||0}:(h=u.forward(h),u.to_meter&&(h={x:h.x/u.to_meter,y:h.y/u.to_meter,z:h.z||0})),R&&u.axis!=="enu"?Hb(u,!0,h):h}var Xb=cl("WGS84");function Sx(a,u,h,R){var M,v,y;return Array.isArray(h)?(M=qy(a,u,h,R)||{x:NaN,y:NaN},h.length>2?typeof a.name<"u"&&a.name==="geocent"||typeof u.name<"u"&&u.name==="geocent"?typeof M.z=="number"?[M.x,M.y,M.z].concat(h.splice(3)):[M.x,M.y,h[2]].concat(h.splice(3)):[M.x,M.y].concat(h.splice(2)):[M.x,M.y]):(v=qy(a,u,h,R),y=Object.keys(h),y.length===2||y.forEach(function(p){if(typeof a.name<"u"&&a.name==="geocent"||typeof u.name<"u"&&u.name==="geocent"){if(p==="x"||p==="y"||p==="z")return}else if(p==="x"||p==="y")return;v[p]=h[p]}),v)}function Zb(a){return a instanceof cl?a:a.oProj?a.oProj:cl(a)}function Mo(a,u,h){a=Zb(a);var R=!1,M;return typeof u>"u"?(u=a,a=Xb,R=!0):(typeof u.x<"u"||Array.isArray(u))&&(h=u,u=a,a=Xb,R=!0),u=Zb(u),h?Sx(a,u,h):(M={forward:function(v,y){return Sx(a,u,v,y)},inverse:function(v,y){return Sx(u,a,v,y)}},R&&(M.oProj=u),M)}var jb=6,PR="AJSAJS",LR="AFAFAF",b0=65,Ks=73,su=79,Hm=86,qm=90;const ZP={forward:OR,inverse:jP,toPoint:FR};function OR(a,u){return u=u||5,$P(YP({lat:a[1],lon:a[0]}),u)}function jP(a){var u=UM(kR(a.toUpperCase()));return u.lat&&u.lon?[u.lon,u.lat,u.lon,u.lat]:[u.left,u.bottom,u.right,u.top]}function FR(a){var u=UM(kR(a.toUpperCase()));return u.lat&&u.lon?[u.lon,u.lat]:[(u.left+u.right)/2,(u.top+u.bottom)/2]}function Rx(a){return a*(Math.PI/180)}function Yb(a){return 180*(a/Math.PI)}function YP(a){var u=a.lat,h=a.lon,R=6378137,M=.00669438,v=.9996,y,p,g,C,D,B,V,P=Rx(u),L=Rx(h),E,b;b=Math.floor((h+180)/6)+1,h===180&&(b=60),u>=56&&u<64&&h>=3&&h<12&&(b=32),u>=72&&u<84&&(h>=0&&h<9?b=31:h>=9&&h<21?b=33:h>=21&&h<33?b=35:h>=33&&h<42&&(b=37)),y=(b-1)*6-180+3,E=Rx(y),p=M/(1-M),g=R/Math.sqrt(1-M*Math.sin(P)*Math.sin(P)),C=Math.tan(P)*Math.tan(P),D=p*Math.cos(P)*Math.cos(P),B=Math.cos(P)*(L-E),V=R*((1-M/4-3*M*M/64-5*M*M*M/256)*P-(3*M/8+3*M*M/32+45*M*M*M/1024)*Math.sin(2*P)+(15*M*M/256+45*M*M*M/1024)*Math.sin(4*P)-35*M*M*M/3072*Math.sin(6*P));var _=v*g*(B+(1-C+D)*B*B*B/6+(5-18*C+C*C+72*D-58*p)*B*B*B*B*B/120)+5e5,x=v*(V+g*Math.tan(P)*(B*B/2+(5-C+9*D+4*D*D)*B*B*B*B/24+(61-58*C+C*C+600*D-330*p)*B*B*B*B*B*B/720));return u<0&&(x+=1e7),{northing:Math.round(x),easting:Math.round(_),zoneNumber:b,zoneLetter:JP(u)}}function UM(a){var u=a.northing,h=a.easting,R=a.zoneLetter,M=a.zoneNumber;if(M<0||M>60)return null;var v=.9996,y=6378137,p=.00669438,g,C=(1-Math.sqrt(1-p))/(1+Math.sqrt(1-p)),D,B,V,P,L,E,b,_,x,T=h-5e5,N=u;R<"N"&&(N-=1e7),b=(M-1)*6-180+3,g=p/(1-p),E=N/v,_=E/(y*(1-p/4-3*p*p/64-5*p*p*p/256)),x=_+(3*C/2-27*C*C*C/32)*Math.sin(2*_)+(21*C*C/16-55*C*C*C*C/32)*Math.sin(4*_)+151*C*C*C/96*Math.sin(6*_),D=y/Math.sqrt(1-p*Math.sin(x)*Math.sin(x)),B=Math.tan(x)*Math.tan(x),V=g*Math.cos(x)*Math.cos(x),P=y*(1-p)/Math.pow(1-p*Math.sin(x)*Math.sin(x),1.5),L=T/(D*v);var U=x-D*Math.tan(x)/P*(L*L/2-(5+3*B+10*V-4*V*V-9*g)*L*L*L*L/24+(61+90*B+298*V+45*B*B-252*g-3*V*V)*L*L*L*L*L*L/720);U=Yb(U);var H=(L-(1+2*B+V)*L*L*L/6+(5-2*V+28*B-3*V*V+8*g+24*B*B)*L*L*L*L*L/120)/Math.cos(x);H=b+Yb(H);var q;if(a.accuracy){var te=UM({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber});q={top:te.lat,right:te.lon,bottom:U,left:H}}else q={lat:U,lon:H};return q}function JP(a){var u="Z";return 84>=a&&a>=72?u="X":72>a&&a>=64?u="W":64>a&&a>=56?u="V":56>a&&a>=48?u="U":48>a&&a>=40?u="T":40>a&&a>=32?u="S":32>a&&a>=24?u="R":24>a&&a>=16?u="Q":16>a&&a>=8?u="P":8>a&&a>=0?u="N":0>a&&a>=-8?u="M":-8>a&&a>=-16?u="L":-16>a&&a>=-24?u="K":-24>a&&a>=-32?u="J":-32>a&&a>=-40?u="H":-40>a&&a>=-48?u="G":-48>a&&a>=-56?u="F":-56>a&&a>=-64?u="E":-64>a&&a>=-72?u="D":-72>a&&a>=-80&&(u="C"),u}function $P(a,u){var h="00000"+a.easting,R="00000"+a.northing;return a.zoneNumber+a.zoneLetter+QP(a.easting,a.northing,a.zoneNumber)+h.substr(h.length-5,u)+R.substr(R.length-5,u)}function QP(a,u,h){var R=IR(h),M=Math.floor(a/1e5),v=Math.floor(u/1e5)%20;return KP(M,v,R)}function IR(a){var u=a%jb;return u===0&&(u=jb),u}function KP(a,u,h){var R=h-1,M=PR.charCodeAt(R),v=LR.charCodeAt(R),y=M+a-1,p=v+u,g=!1;y>qm&&(y=y-qm+b0-1,g=!0),(y===Ks||M<Ks&&y>Ks||(y>Ks||M<Ks)&&g)&&y++,(y===su||M<su&&y>su||(y>su||M<su)&&g)&&(y++,y===Ks&&y++),y>qm&&(y=y-qm+b0-1),p>Hm?(p=p-Hm+b0-1,g=!0):g=!1,(p===Ks||v<Ks&&p>Ks||(p>Ks||v<Ks)&&g)&&p++,(p===su||v<su&&p>su||(p>su||v<su)&&g)&&(p++,p===Ks&&p++),p>Hm&&(p=p-Hm+b0-1);var C=String.fromCharCode(y)+String.fromCharCode(p);return C}function kR(a){if(a&&a.length===0)throw"MGRSPoint coverting from nothing";for(var u=a.length,h=null,R="",M,v=0;!/[A-Z]/.test(M=a.charAt(v));){if(v>=2)throw"MGRSPoint bad conversion from: "+a;R+=M,v++}var y=parseInt(R,10);if(v===0||v+3>u)throw"MGRSPoint bad conversion from: "+a;var p=a.charAt(v++);if(p<="A"||p==="B"||p==="Y"||p>="Z"||p==="I"||p==="O")throw"MGRSPoint zone letter "+p+" not handled: "+a;h=a.substring(v,v+=2);for(var g=IR(y),C=e4(h.charAt(0),g),D=t4(h.charAt(1),g);D<r4(p);)D+=2e6;var B=u-v;if(B%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+a;var V=B/2,P=0,L=0,E,b,_,x,T;return V>0&&(E=1e5/Math.pow(10,V),b=a.substring(v,v+V),P=parseFloat(b)*E,_=a.substring(v+V),L=parseFloat(_)*E),x=P+C,T=L+D,{easting:x,northing:T,zoneLetter:p,zoneNumber:y,accuracy:E}}function e4(a,u){for(var h=PR.charCodeAt(u-1),R=1e5,M=!1;h!==a.charCodeAt(0);){if(h++,h===Ks&&h++,h===su&&h++,h>qm){if(M)throw"Bad character: "+a;h=b0,M=!0}R+=1e5}return R}function t4(a,u){if(a>"V")throw"MGRSPoint given invalid Northing "+a;for(var h=LR.charCodeAt(u-1),R=0,M=!1;h!==a.charCodeAt(0);){if(h++,h===Ks&&h++,h===su&&h++,h>Hm){if(M)throw"Bad character: "+a;h=b0,M=!0}R+=1e5}return R}function r4(a){var u;switch(a){case"C":u=11e5;break;case"D":u=2e6;break;case"E":u=28e5;break;case"F":u=37e5;break;case"G":u=46e5;break;case"H":u=55e5;break;case"J":u=64e5;break;case"K":u=73e5;break;case"L":u=82e5;break;case"M":u=91e5;break;case"N":u=0;break;case"P":u=8e5;break;case"Q":u=17e5;break;case"R":u=26e5;break;case"S":u=35e5;break;case"T":u=44e5;break;case"U":u=53e5;break;case"V":u=62e5;break;case"W":u=7e6;break;case"X":u=79e5;break;default:u=-1}if(u>=0)return u;throw"Invalid zone letter: "+a}function R0(a,u,h){if(!(this instanceof R0))return new R0(a,u,h);if(Array.isArray(a))this.x=a[0],this.y=a[1],this.z=a[2]||0;else if(typeof a=="object")this.x=a.x,this.y=a.y,this.z=a.z||0;else if(typeof a=="string"&&typeof u>"u"){var R=a.split(",");this.x=parseFloat(R[0],10),this.y=parseFloat(R[1],10),this.z=parseFloat(R[2],10)||0}else this.x=a,this.y=u,this.z=h||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}R0.fromMGRS=function(a){return new R0(FR(a))};R0.prototype.toMGRS=function(a){return OR([this.x,this.y],a)};var n4=1,i4=.25,Jb=.046875,$b=.01953125,Qb=.01068115234375,a4=.75,s4=.46875,o4=.013020833333333334,u4=.007120768229166667,l4=.3645833333333333,c4=.005696614583333333,f4=.3076171875;function DR(a){var u=[];u[0]=n4-a*(i4+a*(Jb+a*($b+a*Qb))),u[1]=a*(a4-a*(Jb+a*($b+a*Qb)));var h=a*a;return u[2]=h*(s4-a*(o4+a*u4)),h*=a,u[3]=h*(l4-a*c4),u[4]=h*a*f4,u}function t2(a,u,h,R){return h*=u,u*=u,R[0]*a-h*(R[1]+u*(R[2]+u*(R[3]+u*R[4])))}var h4=20;function NR(a,u,h){for(var R=1/(1-u),M=a,v=h4;v;--v){var y=Math.sin(M),p=1-u*y*y;if(p=(t2(M,y,Math.cos(M),h)-a)*(p*Math.sqrt(p))*R,M-=p,Math.abs(p)<Ur)return M}return M}function d4(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=DR(this.es),this.ml0=t2(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function p4(a){var u=a.x,h=a.y,R=$r(u-this.long0),M,v,y,p=Math.sin(h),g=Math.cos(h);if(this.es){var D=g*R,B=Math.pow(D,2),V=this.ep2*Math.pow(g,2),P=Math.pow(V,2),L=Math.abs(g)>Ur?Math.tan(h):0,E=Math.pow(L,2),b=Math.pow(E,2);M=1-this.es*Math.pow(p,2),D=D/Math.sqrt(M);var _=t2(h,p,g,this.en);v=this.a*(this.k0*D*(1+B/6*(1-E+V+B/20*(5-18*E+b+14*V-58*E*V+B/42*(61+179*b-b*E-479*E)))))+this.x0,y=this.a*(this.k0*(_-this.ml0+p*R*D/2*(1+B/12*(5-E+9*V+4*P+B/30*(61+b-58*E+270*V-330*E*V+B/56*(1385+543*b-b*E-3111*E))))))+this.y0}else{var C=g*Math.sin(R);if(Math.abs(Math.abs(C)-1)<Ur)return 93;if(v=.5*this.a*this.k0*Math.log((1+C)/(1-C))+this.x0,y=g*Math.cos(R)/Math.sqrt(1-Math.pow(C,2)),C=Math.abs(y),C>=1){if(C-1>Ur)return 93;y=0}else y=Math.acos(y);h<0&&(y=-y),y=this.a*this.k0*(y-this.lat0)+this.y0}return a.x=v,a.y=y,a}function m4(a){var u,h,R,M,v=(a.x-this.x0)*(1/this.a),y=(a.y-this.y0)*(1/this.a);if(this.es)if(u=this.ml0+y/this.k0,h=NR(u,this.es,this.en),Math.abs(h)<Tr){var B=Math.sin(h),V=Math.cos(h),P=Math.abs(V)>Ur?Math.tan(h):0,L=this.ep2*Math.pow(V,2),E=Math.pow(L,2),b=Math.pow(P,2),_=Math.pow(b,2);u=1-this.es*Math.pow(B,2);var x=v*Math.sqrt(u)/this.k0,T=Math.pow(x,2);u=u*P,R=h-u*T/(1-this.es)*.5*(1-T/12*(5+3*b-9*L*b+L-4*E-T/30*(61+90*b-252*L*b+45*_+46*L-T/56*(1385+3633*b+4095*_+1574*_*b)))),M=$r(this.long0+x*(1-T/6*(1+2*b+L-T/20*(5+28*b+24*_+8*L*b+6*L-T/42*(61+662*b+1320*_+720*_*b))))/V)}else R=Tr*Km(y),M=0;else{var p=Math.exp(v/this.k0),g=.5*(p-1/p),C=this.lat0+y/this.k0,D=Math.cos(C);u=Math.sqrt((1-Math.pow(D,2))/(1+Math.pow(g,2))),R=Math.asin(u),y<0&&(R=-R),g===0&&D===0?M=0:M=$r(Math.atan2(g,D)+this.long0)}return a.x=M,a.y=R,a}var v4=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const Gy={init:d4,forward:p4,inverse:m4,names:v4};function BR(a){var u=Math.exp(a);return u=(u-1/u)/2,u}function Pu(a,u){a=Math.abs(a),u=Math.abs(u);var h=Math.max(a,u),R=Math.min(a,u)/(h||1);return h*Math.sqrt(1+Math.pow(R,2))}function g4(a){var u=1+a,h=u-1;return h===0?a:a*Math.log(u)/h}function y4(a){var u=Math.abs(a);return u=g4(u*(1+u/(Pu(1,u)+1))),a<0?-u:u}function zM(a,u){for(var h=2*Math.cos(2*u),R=a.length-1,M=a[R],v=0,y;--R>=0;)y=-v+h*M+a[R],v=M,M=y;return u+y*Math.sin(2*u)}function _4(a,u){for(var h=2*Math.cos(u),R=a.length-1,M=a[R],v=0,y;--R>=0;)y=-v+h*M+a[R],v=M,M=y;return Math.sin(u)*y}function x4(a){var u=Math.exp(a);return u=(u+1/u)/2,u}function UR(a,u,h){for(var R=Math.sin(u),M=Math.cos(u),v=BR(h),y=x4(h),p=2*M*y,g=-2*R*v,C=a.length-1,D=a[C],B=0,V=0,P=0,L,E;--C>=0;)L=V,E=B,V=D,B=P,D=-L+p*V-g*B+a[C],P=-E+g*V+p*B;return p=R*y,g=M*v,[p*D-g*P,p*P+g*D]}function A4(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Gy.init.apply(this),this.forward=Gy.forward,this.inverse=Gy.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var a=this.es/(1+Math.sqrt(1-this.es)),u=a/(2-a),h=u;this.cgb[0]=u*(2+u*(-2/3+u*(-2+u*(116/45+u*(26/45+u*(-2854/675)))))),this.cbg[0]=u*(-2+u*(2/3+u*(4/3+u*(-82/45+u*(32/45+u*(4642/4725)))))),h=h*u,this.cgb[1]=h*(7/3+u*(-8/5+u*(-227/45+u*(2704/315+u*(2323/945))))),this.cbg[1]=h*(5/3+u*(-16/15+u*(-13/9+u*(904/315+u*(-1522/945))))),h=h*u,this.cgb[2]=h*(56/15+u*(-136/35+u*(-1262/105+u*(73814/2835)))),this.cbg[2]=h*(-26/15+u*(34/21+u*(8/5+u*(-12686/2835)))),h=h*u,this.cgb[3]=h*(4279/630+u*(-332/35+u*(-399572/14175))),this.cbg[3]=h*(1237/630+u*(-12/5+u*(-24832/14175))),h=h*u,this.cgb[4]=h*(4174/315+u*(-144838/6237)),this.cbg[4]=h*(-734/315+u*(109598/31185)),h=h*u,this.cgb[5]=h*(601676/22275),this.cbg[5]=h*(444337/155925),h=Math.pow(u,2),this.Qn=this.k0/(1+u)*(1+h*(1/4+h*(1/64+h/256))),this.utg[0]=u*(-.5+u*(2/3+u*(-37/96+u*(1/360+u*(81/512+u*(-96199/604800)))))),this.gtu[0]=u*(.5+u*(-2/3+u*(5/16+u*(41/180+u*(-127/288+u*(7891/37800)))))),this.utg[1]=h*(-1/48+u*(-1/15+u*(437/1440+u*(-46/105+u*(1118711/3870720))))),this.gtu[1]=h*(13/48+u*(-3/5+u*(557/1440+u*(281/630+u*(-1983433/1935360))))),h=h*u,this.utg[2]=h*(-17/480+u*(37/840+u*(209/4480+u*(-5569/90720)))),this.gtu[2]=h*(61/240+u*(-103/140+u*(15061/26880+u*(167603/181440)))),h=h*u,this.utg[3]=h*(-4397/161280+u*(11/504+u*(830251/7257600))),this.gtu[3]=h*(49561/161280+u*(-179/168+u*(6601661/7257600))),h=h*u,this.utg[4]=h*(-4583/161280+u*(108847/3991680)),this.gtu[4]=h*(34729/80640+u*(-3418889/1995840)),h=h*u,this.utg[5]=h*(-20648693/638668800),this.gtu[5]=h*(212378941/319334400);var R=zM(this.cbg,this.lat0);this.Zb=-this.Qn*(R+_4(this.gtu,2*R))}function w4(a){var u=$r(a.x-this.long0),h=a.y;h=zM(this.cbg,h);var R=Math.sin(h),M=Math.cos(h),v=Math.sin(u),y=Math.cos(u);h=Math.atan2(R,y*M),u=Math.atan2(v*M,Pu(R,M*y)),u=y4(Math.tan(u));var p=UR(this.gtu,2*h,2*u);h=h+p[0],u=u+p[1];var g,C;return Math.abs(u)<=2.623395162778?(g=this.a*(this.Qn*u)+this.x0,C=this.a*(this.Qn*h+this.Zb)+this.y0):(g=1/0,C=1/0),a.x=g,a.y=C,a}function M4(a){var u=(a.x-this.x0)*(1/this.a),h=(a.y-this.y0)*(1/this.a);h=(h-this.Zb)/this.Qn,u=u/this.Qn;var R,M;if(Math.abs(u)<=2.623395162778){var v=UR(this.utg,2*h,2*u);h=h+v[0],u=u+v[1],u=Math.atan(BR(u));var y=Math.sin(h),p=Math.cos(h),g=Math.sin(u),C=Math.cos(u);h=Math.atan2(y*C,Pu(g,C*p)),u=Math.atan2(g,C*p),R=$r(u+this.long0),M=zM(this.cgb,h)}else R=1/0,M=1/0;return a.x=R,a.y=M,a}var b4=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"];const Vy={init:A4,forward:w4,inverse:M4,names:b4};function E4(a,u){if(a===void 0){if(a=Math.floor(($r(u)+Math.PI)*30/Math.PI)+1,a<0)return 0;if(a>60)return 60}return a}var T4="etmerc";function S4(){var a=E4(this.zone,this.long0);if(a===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(a)-183)*ds,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Vy.init.apply(this),this.forward=Vy.forward,this.inverse=Vy.inverse}var R4=["Universal Transverse Mercator System","utm"];const C4={init:S4,names:R4,dependsOn:T4};function GM(a,u){return Math.pow((1-a)/(1+a),u)}var P4=20;function L4(){var a=Math.sin(this.lat0),u=Math.cos(this.lat0);u*=u,this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a),this.C=Math.sqrt(1+this.es*u*u/(1-this.es)),this.phic0=Math.asin(a/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Oi)/(Math.pow(Math.tan(.5*this.lat0+Oi),this.C)*GM(this.e*a,this.ratexp))}function O4(a){var u=a.x,h=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*h+Oi),this.C)*GM(this.e*Math.sin(h),this.ratexp))-Tr,a.x=this.C*u,a}function F4(a){for(var u=1e-14,h=a.x/this.C,R=a.y,M=Math.pow(Math.tan(.5*R+Oi)/this.K,1/this.C),v=P4;v>0&&(R=2*Math.atan(M*GM(this.e*Math.sin(a.y),-.5*this.e))-Tr,!(Math.abs(R-a.y)<u));--v)a.y=R;return v?(a.x=h,a.y=R,a):null}var I4=["gauss"];const VM={init:L4,forward:O4,inverse:F4,names:I4};function k4(){VM.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function D4(a){var u,h,R,M;return a.x=$r(a.x-this.long0),VM.forward.apply(this,[a]),u=Math.sin(a.y),h=Math.cos(a.y),R=Math.cos(a.x),M=this.k0*this.R2/(1+this.sinc0*u+this.cosc0*h*R),a.x=M*h*Math.sin(a.x),a.y=M*(this.cosc0*u-this.sinc0*h*R),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a}function N4(a){var u,h,R,M,v;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,v=Math.sqrt(a.x*a.x+a.y*a.y)){var y=2*Math.atan2(v,this.R2);u=Math.sin(y),h=Math.cos(y),M=Math.asin(h*this.sinc0+a.y*u*this.cosc0/v),R=Math.atan2(a.x*u,v*this.cosc0*h-a.y*this.sinc0*u)}else M=this.phic0,R=0;return a.x=R,a.y=M,VM.inverse.apply(this,[a]),a.x=$r(a.x+this.long0),a}var B4=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const U4={init:k4,forward:D4,inverse:N4,names:B4};function z4(a,u,h){return u*=h,Math.tan(.5*(Tr+a))*Math.pow((1-u)/(1+u),.5*h)}function G4(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ur&&(this.k0=.5*(1+Km(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Ur&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ur&&(this.k0=.5*this.cons*fl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Lu(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=fl(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Tr,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function V4(a){var u=a.x,h=a.y,R=Math.sin(h),M=Math.cos(h),v,y,p,g,C,D,B=$r(u-this.long0);return Math.abs(Math.abs(u-this.long0)-Math.PI)<=Ur&&Math.abs(h+this.lat0)<=Ur?(a.x=NaN,a.y=NaN,a):this.sphere?(v=2*this.k0/(1+this.sinlat0*R+this.coslat0*M*Math.cos(B)),a.x=this.a*v*M*Math.sin(B)+this.x0,a.y=this.a*v*(this.coslat0*R-this.sinlat0*M*Math.cos(B))+this.y0,a):(y=2*Math.atan(this.ssfn_(h,R,this.e))-Tr,g=Math.cos(y),p=Math.sin(y),Math.abs(this.coslat0)<=Ur?(C=Lu(this.e,h*this.con,this.con*R),D=2*this.a*this.k0*C/this.cons,a.x=this.x0+D*Math.sin(u-this.long0),a.y=this.y0-this.con*D*Math.cos(u-this.long0),a):(Math.abs(this.sinlat0)<Ur?(v=2*this.a*this.k0/(1+g*Math.cos(B)),a.y=v*p):(v=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*p+this.cosX0*g*Math.cos(B))),a.y=v*(this.cosX0*p-this.sinX0*g*Math.cos(B))+this.y0),a.x=v*g*Math.sin(B)+this.x0,a))}function W4(a){a.x-=this.x0,a.y-=this.y0;var u,h,R,M,v,y=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){var p=2*Math.atan(y/(2*this.a*this.k0));return u=this.long0,h=this.lat0,y<=Ur?(a.x=u,a.y=h,a):(h=Math.asin(Math.cos(p)*this.sinlat0+a.y*Math.sin(p)*this.coslat0/y),Math.abs(this.coslat0)<Ur?this.lat0>0?u=$r(this.long0+Math.atan2(a.x,-1*a.y)):u=$r(this.long0+Math.atan2(a.x,a.y)):u=$r(this.long0+Math.atan2(a.x*Math.sin(p),y*this.coslat0*Math.cos(p)-a.y*this.sinlat0*Math.sin(p))),a.x=u,a.y=h,a)}else if(Math.abs(this.coslat0)<=Ur){if(y<=Ur)return h=this.lat0,u=this.long0,a.x=u,a.y=h,a;a.x*=this.con,a.y*=this.con,R=y*this.cons/(2*this.a*this.k0),h=this.con*$m(this.e,R),u=this.con*$r(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else M=2*Math.atan(y*this.cosX0/(2*this.a*this.k0*this.ms1)),u=this.long0,y<=Ur?v=this.X0:(v=Math.asin(Math.cos(M)*this.sinX0+a.y*Math.sin(M)*this.cosX0/y),u=$r(this.long0+Math.atan2(a.x*Math.sin(M),y*this.cosX0*Math.cos(M)-a.y*this.sinX0*Math.sin(M)))),h=-1*$m(this.e,Math.tan(.5*(Tr+v)));return a.x=u,a.y=h,a}var H4=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"];const q4={init:G4,forward:V4,inverse:W4,names:H4,ssfn_:z4};function X4(){var a=this.lat0;this.lambda0=this.long0;var u=Math.sin(a),h=this.a,R=this.rf,M=1/R,v=2*M-Math.pow(M,2),y=this.e=Math.sqrt(v);this.R=this.k0*h*Math.sqrt(1-v)/(1-v*Math.pow(u,2)),this.alpha=Math.sqrt(1+v/(1-v)*Math.pow(Math.cos(a),4)),this.b0=Math.asin(u/this.alpha);var p=Math.log(Math.tan(Math.PI/4+this.b0/2)),g=Math.log(Math.tan(Math.PI/4+a/2)),C=Math.log((1+y*u)/(1-y*u));this.K=p-this.alpha*g+this.alpha*y/2*C}function Z4(a){var u=Math.log(Math.tan(Math.PI/4-a.y/2)),h=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),R=-this.alpha*(u+h)+this.K,M=2*(Math.atan(Math.exp(R))-Math.PI/4),v=this.alpha*(a.x-this.lambda0),y=Math.atan(Math.sin(v)/(Math.sin(this.b0)*Math.tan(M)+Math.cos(this.b0)*Math.cos(v))),p=Math.asin(Math.cos(this.b0)*Math.sin(M)-Math.sin(this.b0)*Math.cos(M)*Math.cos(v));return a.y=this.R/2*Math.log((1+Math.sin(p))/(1-Math.sin(p)))+this.y0,a.x=this.R*y+this.x0,a}function j4(a){for(var u=a.x-this.x0,h=a.y-this.y0,R=u/this.R,M=2*(Math.atan(Math.exp(h/this.R))-Math.PI/4),v=Math.asin(Math.cos(this.b0)*Math.sin(M)+Math.sin(this.b0)*Math.cos(M)*Math.cos(R)),y=Math.atan(Math.sin(R)/(Math.cos(this.b0)*Math.cos(R)-Math.sin(this.b0)*Math.tan(M))),p=this.lambda0+y/this.alpha,g=0,C=v,D=-1e3,B=0;Math.abs(C-D)>1e-7;){if(++B>20)return;g=1/this.alpha*(Math.log(Math.tan(Math.PI/4+v/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(C))/2)),D=C,C=2*Math.atan(Math.exp(g))-Math.PI/2}return a.x=p,a.y=C,a}var Y4=["somerc"];const J4={init:X4,forward:Z4,inverse:j4,names:Y4};var A0=1e-7;function $4(a){var u=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],h=typeof a.PROJECTION=="object"?Object.keys(a.PROJECTION)[0]:a.PROJECTION;return"no_uoff"in a||"no_off"in a||u.indexOf(h)!==-1}function Q4(){var a,u,h,R,M,v,y,p,g,C,D=0,B,V=0,P=0,L=0,E=0,b=0,_=0;this.no_off=$4(this),this.no_rot="no_rot"in this;var x=!1;"alpha"in this&&(x=!0);var T=!1;if("rectified_grid_angle"in this&&(T=!0),x&&(_=this.alpha),T&&(D=this.rectified_grid_angle*ds),x||T)V=this.longc;else if(P=this.long1,E=this.lat1,L=this.long2,b=this.lat2,Math.abs(E-b)<=A0||(a=Math.abs(E))<=A0||Math.abs(a-Tr)<=A0||Math.abs(Math.abs(this.lat0)-Tr)<=A0||Math.abs(Math.abs(b)-Tr)<=A0)throw new Error;var N=1-this.es;u=Math.sqrt(N),Math.abs(this.lat0)>Ur?(p=Math.sin(this.lat0),h=Math.cos(this.lat0),a=1-this.es*p*p,this.B=h*h,this.B=Math.sqrt(1+this.es*this.B*this.B/N),this.A=this.B*this.k0*u/a,R=this.B*u/(h*Math.sqrt(a)),M=R*R-1,M<=0?M=0:(M=Math.sqrt(M),this.lat0<0&&(M=-M)),this.E=M+=R,this.E*=Math.pow(Lu(this.e,this.lat0,p),this.B)):(this.B=1/u,this.A=this.k0,this.E=R=M=1),x||T?(x?(B=Math.asin(Math.sin(_)/R),T||(D=_)):(B=D,_=Math.asin(R*Math.sin(B))),this.lam0=V-Math.asin(.5*(M-1/M)*Math.tan(B))/this.B):(v=Math.pow(Lu(this.e,E,Math.sin(E)),this.B),y=Math.pow(Lu(this.e,b,Math.sin(b)),this.B),M=this.E/v,g=(y-v)/(y+v),C=this.E*this.E,C=(C-y*v)/(C+y*v),a=P-L,a<-Math.pi?L-=Ym:a>Math.pi&&(L+=Ym),this.lam0=$r(.5*(P+L)-Math.atan(C*Math.tan(.5*this.B*(P-L))/g)/this.B),B=Math.atan(2*Math.sin(this.B*$r(P-this.lam0))/(M-1/M)),D=_=Math.asin(R*Math.sin(B))),this.singam=Math.sin(B),this.cosgam=Math.cos(B),this.sinrot=Math.sin(D),this.cosrot=Math.cos(D),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(R*R-1)/Math.cos(_))),this.lat0<0&&(this.u_0=-this.u_0)),M=.5*B,this.v_pole_n=this.ArB*Math.log(Math.tan(Oi-M)),this.v_pole_s=this.ArB*Math.log(Math.tan(Oi+M))}function K4(a){var u={},h,R,M,v,y,p,g,C;if(a.x=a.x-this.lam0,Math.abs(Math.abs(a.y)-Tr)>Ur){if(y=this.E/Math.pow(Lu(this.e,a.y,Math.sin(a.y)),this.B),p=1/y,h=.5*(y-p),R=.5*(y+p),v=Math.sin(this.B*a.x),M=(h*this.singam-v*this.cosgam)/R,Math.abs(Math.abs(M)-1)<Ur)throw new Error;C=.5*this.ArB*Math.log((1-M)/(1+M)),p=Math.cos(this.B*a.x),Math.abs(p)<A0?g=this.A*a.x:g=this.ArB*Math.atan2(h*this.cosgam+v*this.singam,p)}else C=a.y>0?this.v_pole_n:this.v_pole_s,g=this.ArB*a.y;return this.no_rot?(u.x=g,u.y=C):(g-=this.u_0,u.x=C*this.cosrot+g*this.sinrot,u.y=g*this.cosrot-C*this.sinrot),u.x=this.a*u.x+this.x0,u.y=this.a*u.y+this.y0,u}function eL(a){var u,h,R,M,v,y,p,g={};if(a.x=(a.x-this.x0)*(1/this.a),a.y=(a.y-this.y0)*(1/this.a),this.no_rot?(h=a.y,u=a.x):(h=a.x*this.cosrot-a.y*this.sinrot,u=a.y*this.cosrot+a.x*this.sinrot+this.u_0),R=Math.exp(-this.BrA*h),M=.5*(R-1/R),v=.5*(R+1/R),y=Math.sin(this.BrA*u),p=(y*this.cosgam+M*this.singam)/v,Math.abs(Math.abs(p)-1)<Ur)g.x=0,g.y=p<0?-Tr:Tr;else{if(g.y=this.E/Math.sqrt((1+p)/(1-p)),g.y=$m(this.e,Math.pow(g.y,1/this.B)),g.y===1/0)throw new Error;g.x=-this.rB*Math.atan2(M*this.cosgam-y*this.singam,Math.cos(this.BrA*u))}return g.x+=this.lam0,g}var tL=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const rL={init:Q4,forward:K4,inverse:eL,names:tL};function nL(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Ur)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var u=Math.sin(this.lat1),h=Math.cos(this.lat1),R=fl(this.e,u,h),M=Lu(this.e,this.lat1,u),v=Math.sin(this.lat2),y=Math.cos(this.lat2),p=fl(this.e,v,y),g=Lu(this.e,this.lat2,v),C=Lu(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Ur?this.ns=Math.log(R/p)/Math.log(M/g):this.ns=u,isNaN(this.ns)&&(this.ns=u),this.f0=R/(this.ns*Math.pow(M,this.ns)),this.rh=this.a*this.f0*Math.pow(C,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function iL(a){var u=a.x,h=a.y;Math.abs(2*Math.abs(h)-Math.PI)<=Ur&&(h=Km(h)*(Tr-2*Ur));var R=Math.abs(Math.abs(h)-Tr),M,v;if(R>Ur)M=Lu(this.e,h,Math.sin(h)),v=this.a*this.f0*Math.pow(M,this.ns);else{if(R=h*this.ns,R<=0)return null;v=0}var y=this.ns*$r(u-this.long0);return a.x=this.k0*(v*Math.sin(y))+this.x0,a.y=this.k0*(this.rh-v*Math.cos(y))+this.y0,a}function aL(a){var u,h,R,M,v,y=(a.x-this.x0)/this.k0,p=this.rh-(a.y-this.y0)/this.k0;this.ns>0?(u=Math.sqrt(y*y+p*p),h=1):(u=-Math.sqrt(y*y+p*p),h=-1);var g=0;if(u!==0&&(g=Math.atan2(h*y,h*p)),u!==0||this.ns>0){if(h=1/this.ns,R=Math.pow(u/(this.a*this.f0),h),M=$m(this.e,R),M===-9999)return null}else M=-Tr;return v=$r(g/this.ns+this.long0),a.x=v,a.y=M,a}var sL=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const oL={init:nL,forward:iL,inverse:aL,names:sL};function uL(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function lL(a){var u,h,R,M,v,y,p,g=a.x,C=a.y,D=$r(g-this.long0);return u=Math.pow((1+this.e*Math.sin(C))/(1-this.e*Math.sin(C)),this.alfa*this.e/2),h=2*(Math.atan(this.k*Math.pow(Math.tan(C/2+this.s45),this.alfa)/u)-this.s45),R=-D*this.alfa,M=Math.asin(Math.cos(this.ad)*Math.sin(h)+Math.sin(this.ad)*Math.cos(h)*Math.cos(R)),v=Math.asin(Math.cos(h)*Math.sin(R)/Math.cos(M)),y=this.n*v,p=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(M/2+this.s45),this.n),a.y=p*Math.cos(y)/1,a.x=p*Math.sin(y)/1,this.czech||(a.y*=-1,a.x*=-1),a}function cL(a){var u,h,R,M,v,y,p,g,C=a.x;a.x=a.y,a.y=C,this.czech||(a.y*=-1,a.x*=-1),y=Math.sqrt(a.x*a.x+a.y*a.y),v=Math.atan2(a.y,a.x),M=v/Math.sin(this.s0),R=2*(Math.atan(Math.pow(this.ro0/y,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),u=Math.asin(Math.cos(this.ad)*Math.sin(R)-Math.sin(this.ad)*Math.cos(R)*Math.cos(M)),h=Math.asin(Math.cos(R)*Math.sin(M)/Math.cos(u)),a.x=this.long0-h/this.alfa,p=u,g=0;var D=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(u/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(p))/(1-this.e*Math.sin(p)),this.e/2))-this.s45),Math.abs(p-a.y)<1e-10&&(g=1),p=a.y,D+=1;while(g===0&&D<15);return D>=15?null:a}var fL=["Krovak","krovak"];const hL={init:uL,forward:lL,inverse:cL,names:fL};function Bs(a,u,h,R,M){return a*M-u*Math.sin(2*M)+h*Math.sin(4*M)-R*Math.sin(6*M)}function ev(a){return 1-.25*a*(1+a/16*(3+1.25*a))}function tv(a){return .375*a*(1+.25*a*(1+.46875*a))}function rv(a){return .05859375*a*a*(1+.75*a)}function nv(a){return a*a*a*(35/3072)}function C0(a,u,h){var R=u*h;return a/Math.sqrt(1-R*R)}function L0(a){return Math.abs(a)<Tr?a:a-Km(a)*Math.PI}function Xy(a,u,h,R,M){var v,y;v=a/u;for(var p=0;p<15;p++)if(y=(a-(u*v-h*Math.sin(2*v)+R*Math.sin(4*v)-M*Math.sin(6*v)))/(u-2*h*Math.cos(2*v)+4*R*Math.cos(4*v)-6*M*Math.cos(6*v)),v+=y,Math.abs(y)<=1e-10)return v;return NaN}function dL(){this.sphere||(this.e0=ev(this.es),this.e1=tv(this.es),this.e2=rv(this.es),this.e3=nv(this.es),this.ml0=this.a*Bs(this.e0,this.e1,this.e2,this.e3,this.lat0))}function pL(a){var u,h,R=a.x,M=a.y;if(R=$r(R-this.long0),this.sphere)u=this.a*Math.asin(Math.cos(M)*Math.sin(R)),h=this.a*(Math.atan2(Math.tan(M),Math.cos(R))-this.lat0);else{var v=Math.sin(M),y=Math.cos(M),p=C0(this.a,this.e,v),g=Math.tan(M)*Math.tan(M),C=R*Math.cos(M),D=C*C,B=this.es*y*y/(1-this.es),V=this.a*Bs(this.e0,this.e1,this.e2,this.e3,M);u=p*C*(1-D*g*(1/6-(8-g+8*B)*D/120)),h=V-this.ml0+p*v/y*D*(.5+(5-g+6*B)*D/24)}return a.x=u+this.x0,a.y=h+this.y0,a}function mL(a){a.x-=this.x0,a.y-=this.y0;var u=a.x/this.a,h=a.y/this.a,R,M;if(this.sphere){var v=h+this.lat0;R=Math.asin(Math.sin(v)*Math.cos(u)),M=Math.atan2(Math.tan(u),Math.cos(v))}else{var y=this.ml0/this.a+h,p=Xy(y,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(p)-Tr)<=Ur)return a.x=this.long0,a.y=Tr,h<0&&(a.y*=-1),a;var g=C0(this.a,this.e,Math.sin(p)),C=g*g*g/this.a/this.a*(1-this.es),D=Math.pow(Math.tan(p),2),B=u*this.a/g,V=B*B;R=p-g*Math.tan(p)/C*B*B*(.5-(1+3*D)*B*B/24),M=B*(1-V*(D/3+(1+3*D)*D*V/15))/Math.cos(p)}return a.x=$r(M+this.long0),a.y=L0(R),a}var vL=["Cassini","Cassini_Soldner","cass"];const gL={init:dL,forward:pL,inverse:mL,names:vL};function kf(a,u){var h;return a>1e-7?(h=a*u,(1-a*a)*(u/(1-h*h)-.5/a*Math.log((1-h)/(1+h)))):2*u}var yL=1,_L=2,xL=3,AL=4;function wL(){var a=Math.abs(this.lat0);if(Math.abs(a-Tr)<Ur?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(a)<Ur?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var u;switch(this.qp=kf(this.e,1),this.mmf=.5/(1-this.es),this.apa=LL(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),u=Math.sin(this.lat0),this.sinb1=kf(this.e,u)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*u*u)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function ML(a){var u,h,R,M,v,y,p,g,C,D,B=a.x,V=a.y;if(B=$r(B-this.long0),this.sphere){if(v=Math.sin(V),D=Math.cos(V),R=Math.cos(B),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(h=this.mode===this.EQUIT?1+D*R:1+this.sinph0*v+this.cosph0*D*R,h<=Ur)return null;h=Math.sqrt(2/h),u=h*D*Math.sin(B),h*=this.mode===this.EQUIT?v:this.cosph0*v-this.sinph0*D*R}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(R=-R),Math.abs(V+this.lat0)<Ur)return null;h=Oi-V*.5,h=2*(this.mode===this.S_POLE?Math.cos(h):Math.sin(h)),u=h*Math.sin(B),h*=R}}else{switch(p=0,g=0,C=0,R=Math.cos(B),M=Math.sin(B),v=Math.sin(V),y=kf(this.e,v),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=y/this.qp,g=Math.sqrt(1-p*p)),this.mode){case this.OBLIQ:C=1+this.sinb1*p+this.cosb1*g*R;break;case this.EQUIT:C=1+g*R;break;case this.N_POLE:C=Tr+V,y=this.qp-y;break;case this.S_POLE:C=V-Tr,y=this.qp+y;break}if(Math.abs(C)<Ur)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:C=Math.sqrt(2/C),this.mode===this.OBLIQ?h=this.ymf*C*(this.cosb1*p-this.sinb1*g*R):h=(C=Math.sqrt(2/(1+g*R)))*p*this.ymf,u=this.xmf*C*g*M;break;case this.N_POLE:case this.S_POLE:y>=0?(u=(C=Math.sqrt(y))*M,h=R*(this.mode===this.S_POLE?C:-C)):u=h=0;break}}return a.x=this.a*u+this.x0,a.y=this.a*h+this.y0,a}function bL(a){a.x-=this.x0,a.y-=this.y0;var u=a.x/this.a,h=a.y/this.a,R,M,v,y,p,g,C;if(this.sphere){var D=0,B,V=0;if(B=Math.sqrt(u*u+h*h),M=B*.5,M>1)return null;switch(M=2*Math.asin(M),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(V=Math.sin(M),D=Math.cos(M)),this.mode){case this.EQUIT:M=Math.abs(B)<=Ur?0:Math.asin(h*V/B),u*=V,h=D*B;break;case this.OBLIQ:M=Math.abs(B)<=Ur?this.lat0:Math.asin(D*this.sinph0+h*V*this.cosph0/B),u*=V*this.cosph0,h=(D-Math.sin(M)*this.sinph0)*B;break;case this.N_POLE:h=-h,M=Tr-M;break;case this.S_POLE:M-=Tr;break}R=h===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(u,h)}else{if(C=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,h*=this.dd,g=Math.sqrt(u*u+h*h),g<Ur)return a.x=this.long0,a.y=this.lat0,a;y=2*Math.asin(.5*g/this.rq),v=Math.cos(y),u*=y=Math.sin(y),this.mode===this.OBLIQ?(C=v*this.sinb1+h*y*this.cosb1/g,p=this.qp*C,h=g*this.cosb1*v-h*this.sinb1*y):(C=h*y/g,p=this.qp*C,h=g*v)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(h=-h),p=u*u+h*h,!p)return a.x=this.long0,a.y=this.lat0,a;C=1-p/this.qp,this.mode===this.S_POLE&&(C=-C)}R=Math.atan2(u,h),M=OL(Math.asin(C),this.apa)}return a.x=$r(this.long0+R),a.y=M,a}var EL=.3333333333333333,TL=.17222222222222222,SL=.10257936507936508,RL=.06388888888888888,CL=.0664021164021164,PL=.016415012942191543;function LL(a){var u,h=[];return h[0]=a*EL,u=a*a,h[0]+=u*TL,h[1]=u*RL,u*=a,h[0]+=u*SL,h[1]+=u*CL,h[2]=u*PL,h}function OL(a,u){var h=a+a;return a+u[0]*Math.sin(h)+u[1]*Math.sin(h+h)+u[2]*Math.sin(h+h+h)}var FL=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const IL={init:wL,forward:ML,inverse:bL,names:FL,S_POLE:yL,N_POLE:_L,EQUIT:xL,OBLIQ:AL};function Nf(a){return Math.abs(a)>1&&(a=a>1?1:-1),Math.asin(a)}function kL(){Math.abs(this.lat1+this.lat2)<Ur||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=fl(this.e3,this.sin_po,this.cos_po),this.qs1=kf(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=fl(this.e3,this.sin_po,this.cos_po),this.qs2=kf(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=kf(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>Ur?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function DL(a){var u=a.x,h=a.y;this.sin_phi=Math.sin(h),this.cos_phi=Math.cos(h);var R=kf(this.e3,this.sin_phi,this.cos_phi),M=this.a*Math.sqrt(this.c-this.ns0*R)/this.ns0,v=this.ns0*$r(u-this.long0),y=M*Math.sin(v)+this.x0,p=this.rh-M*Math.cos(v)+this.y0;return a.x=y,a.y=p,a}function NL(a){var u,h,R,M,v,y;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,this.ns0>=0?(u=Math.sqrt(a.x*a.x+a.y*a.y),R=1):(u=-Math.sqrt(a.x*a.x+a.y*a.y),R=-1),M=0,u!==0&&(M=Math.atan2(R*a.x,R*a.y)),R=u*this.ns0/this.a,this.sphere?y=Math.asin((this.c-R*R)/(2*this.ns0)):(h=(this.c-R*R)/this.ns0,y=this.phi1z(this.e3,h)),v=$r(M/this.ns0+this.long0),a.x=v,a.y=y,a}function BL(a,u){var h,R,M,v,y,p=Nf(.5*u);if(a<Ur)return p;for(var g=a*a,C=1;C<=25;C++)if(h=Math.sin(p),R=Math.cos(p),M=a*h,v=1-M*M,y=.5*v*v/R*(u/(1-g)-h/v+.5/a*Math.log((1-M)/(1+M))),p=p+y,Math.abs(y)<=1e-7)return p;return null}var UL=["Albers_Conic_Equal_Area","Albers","aea"];const zL={init:kL,forward:DL,inverse:NL,names:UL,phi1z:BL};function GL(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function VL(a){var u,h,R,M,v,y,p,g,C=a.x,D=a.y;return R=$r(C-this.long0),u=Math.sin(D),h=Math.cos(D),M=Math.cos(R),y=this.sin_p14*u+this.cos_p14*h*M,v=1,y>0||Math.abs(y)<=Ur?(p=this.x0+this.a*v*h*Math.sin(R)/y,g=this.y0+this.a*v*(this.cos_p14*u-this.sin_p14*h*M)/y):(p=this.x0+this.infinity_dist*h*Math.sin(R),g=this.y0+this.infinity_dist*(this.cos_p14*u-this.sin_p14*h*M)),a.x=p,a.y=g,a}function WL(a){var u,h,R,M,v,y;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(u=Math.sqrt(a.x*a.x+a.y*a.y))?(M=Math.atan2(u,this.rc),h=Math.sin(M),R=Math.cos(M),y=Nf(R*this.sin_p14+a.y*h*this.cos_p14/u),v=Math.atan2(a.x*h,u*this.cos_p14*R-a.y*this.sin_p14*h),v=$r(this.long0+v)):(y=this.phic0,v=0),a.x=v,a.y=y,a}var HL=["gnom"];const qL={init:GL,forward:VL,inverse:WL,names:HL};function XL(a,u){var h=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(Math.abs(Math.abs(u)-h)<1e-6)return u<0?-1*Tr:Tr;for(var R=Math.asin(.5*u),M,v,y,p,g=0;g<30;g++)if(v=Math.sin(R),y=Math.cos(R),p=a*v,M=Math.pow(1-p*p,2)/(2*y)*(u/(1-a*a)-v/(1-p*p)+.5/a*Math.log((1-p)/(1+p))),R+=M,Math.abs(M)<=1e-10)return R;return NaN}function ZL(){this.sphere||(this.k0=fl(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function jL(a){var u=a.x,h=a.y,R,M,v=$r(u-this.long0);if(this.sphere)R=this.x0+this.a*v*Math.cos(this.lat_ts),M=this.y0+this.a*Math.sin(h)/Math.cos(this.lat_ts);else{var y=kf(this.e,Math.sin(h));R=this.x0+this.a*this.k0*v,M=this.y0+this.a*y*.5/this.k0}return a.x=R,a.y=M,a}function YL(a){a.x-=this.x0,a.y-=this.y0;var u,h;return this.sphere?(u=$r(this.long0+a.x/this.a/Math.cos(this.lat_ts)),h=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(h=XL(this.e,2*a.y*this.k0/this.a),u=$r(this.long0+a.x/(this.a*this.k0))),a.x=u,a.y=h,a}var JL=["cea"];const $L={init:ZL,forward:jL,inverse:YL,names:JL};function QL(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function KL(a){var u=a.x,h=a.y,R=$r(u-this.long0),M=L0(h-this.lat0);return a.x=this.x0+this.a*R*this.rc,a.y=this.y0+this.a*M,a}function eO(a){var u=a.x,h=a.y;return a.x=$r(this.long0+(u-this.x0)/(this.a*this.rc)),a.y=L0(this.lat0+(h-this.y0)/this.a),a}var tO=["Equirectangular","Equidistant_Cylindrical","eqc"];const rO={init:QL,forward:KL,inverse:eO,names:tO};var Kb=20;function nO(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ev(this.es),this.e1=tv(this.es),this.e2=rv(this.es),this.e3=nv(this.es),this.ml0=this.a*Bs(this.e0,this.e1,this.e2,this.e3,this.lat0)}function iO(a){var u=a.x,h=a.y,R,M,v,y=$r(u-this.long0);if(v=y*Math.sin(h),this.sphere)Math.abs(h)<=Ur?(R=this.a*y,M=-1*this.a*this.lat0):(R=this.a*Math.sin(v)/Math.tan(h),M=this.a*(L0(h-this.lat0)+(1-Math.cos(v))/Math.tan(h)));else if(Math.abs(h)<=Ur)R=this.a*y,M=-1*this.ml0;else{var p=C0(this.a,this.e,Math.sin(h))/Math.tan(h);R=p*Math.sin(v),M=this.a*Bs(this.e0,this.e1,this.e2,this.e3,h)-this.ml0+p*(1-Math.cos(v))}return a.x=R+this.x0,a.y=M+this.y0,a}function aO(a){var u,h,R,M,v,y,p,g,C;if(R=a.x-this.x0,M=a.y-this.y0,this.sphere)if(Math.abs(M+this.a*this.lat0)<=Ur)u=$r(R/this.a+this.long0),h=0;else{y=this.lat0+M/this.a,p=R*R/this.a/this.a+y*y,g=y;var D;for(v=Kb;v;--v)if(D=Math.tan(g),C=-1*(y*(g*D+1)-g-.5*(g*g+p)*D)/((g-y)/D-1),g+=C,Math.abs(C)<=Ur){h=g;break}u=$r(this.long0+Math.asin(R*Math.tan(g)/this.a)/Math.sin(h))}else if(Math.abs(M+this.ml0)<=Ur)h=0,u=$r(this.long0+R/this.a);else{y=(this.ml0+M)/this.a,p=R*R/this.a/this.a+y*y,g=y;var B,V,P,L,E;for(v=Kb;v;--v)if(E=this.e*Math.sin(g),B=Math.sqrt(1-E*E)*Math.tan(g),V=this.a*Bs(this.e0,this.e1,this.e2,this.e3,g),P=this.e0-2*this.e1*Math.cos(2*g)+4*this.e2*Math.cos(4*g)-6*this.e3*Math.cos(6*g),L=V/this.a,C=(y*(B*L+1)-L-.5*B*(L*L+p))/(this.es*Math.sin(2*g)*(L*L+p-2*y*L)/(4*B)+(y-L)*(B*P-2/Math.sin(2*g))-P),g-=C,Math.abs(C)<=Ur){h=g;break}B=Math.sqrt(1-this.es*Math.pow(Math.sin(h),2))*Math.tan(h),u=$r(this.long0+Math.asin(R*B/this.a)/Math.sin(h))}return a.x=u,a.y=h,a}var sO=["Polyconic","poly"];const oO={init:nO,forward:iO,inverse:aO,names:sO};function uO(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function lO(a){var u,h=a.x,R=a.y,M=R-this.lat0,v=h-this.long0,y=M/jm*1e-5,p=v,g=1,C=0;for(u=1;u<=10;u++)g=g*y,C=C+this.A[u]*g;var D=C,B=p,V=1,P=0,L,E,b=0,_=0;for(u=1;u<=6;u++)L=V*D-P*B,E=P*D+V*B,V=L,P=E,b=b+this.B_re[u]*V-this.B_im[u]*P,_=_+this.B_im[u]*V+this.B_re[u]*P;return a.x=_*this.a+this.x0,a.y=b*this.a+this.y0,a}function cO(a){var u,h=a.x,R=a.y,M=h-this.x0,v=R-this.y0,y=v/this.a,p=M/this.a,g=1,C=0,D,B,V=0,P=0;for(u=1;u<=6;u++)D=g*y-C*p,B=C*y+g*p,g=D,C=B,V=V+this.C_re[u]*g-this.C_im[u]*C,P=P+this.C_im[u]*g+this.C_re[u]*C;for(var L=0;L<this.iterations;L++){var E=V,b=P,_,x,T=y,N=p;for(u=2;u<=6;u++)_=E*V-b*P,x=b*V+E*P,E=_,b=x,T=T+(u-1)*(this.B_re[u]*E-this.B_im[u]*b),N=N+(u-1)*(this.B_im[u]*E+this.B_re[u]*b);E=1,b=0;var U=this.B_re[1],H=this.B_im[1];for(u=2;u<=6;u++)_=E*V-b*P,x=b*V+E*P,E=_,b=x,U=U+u*(this.B_re[u]*E-this.B_im[u]*b),H=H+u*(this.B_im[u]*E+this.B_re[u]*b);var q=U*U+H*H;V=(T*U+N*H)/q,P=(N*U-T*H)/q}var te=V,Q=P,Z=1,ae=0;for(u=1;u<=9;u++)Z=Z*te,ae=ae+this.D[u]*Z;var F=this.lat0+ae*jm*1e5,W=this.long0+Q;return a.x=W,a.y=F,a}var fO=["New_Zealand_Map_Grid","nzmg"];const hO={init:uO,forward:lO,inverse:cO,names:fO};function dO(){}function pO(a){var u=a.x,h=a.y,R=$r(u-this.long0),M=this.x0+this.a*R,v=this.y0+this.a*Math.log(Math.tan(Math.PI/4+h/2.5))*1.25;return a.x=M,a.y=v,a}function mO(a){a.x-=this.x0,a.y-=this.y0;var u=$r(this.long0+a.x/this.a),h=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=u,a.y=h,a}var vO=["Miller_Cylindrical","mill"];const gO={init:dO,forward:pO,inverse:mO,names:vO};var yO=20;function _O(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=DR(this.es)}function xO(a){var u,h,R=a.x,M=a.y;if(R=$r(R-this.long0),this.sphere){if(!this.m)M=this.n!==1?Math.asin(this.n*Math.sin(M)):M;else for(var v=this.n*Math.sin(M),y=yO;y;--y){var p=(this.m*M+Math.sin(M)-v)/(this.m+Math.cos(M));if(M-=p,Math.abs(p)<Ur)break}u=this.a*this.C_x*R*(this.m+Math.cos(M)),h=this.a*this.C_y*M}else{var g=Math.sin(M),C=Math.cos(M);h=this.a*t2(M,g,C,this.en),u=this.a*R*C/Math.sqrt(1-this.es*g*g)}return a.x=u,a.y=h,a}function AO(a){var u,h,R,M;return a.x-=this.x0,R=a.x/this.a,a.y-=this.y0,u=a.y/this.a,this.sphere?(u/=this.C_y,R=R/(this.C_x*(this.m+Math.cos(u))),this.m?u=Nf((this.m*u+Math.sin(u))/this.n):this.n!==1&&(u=Nf(Math.sin(u)/this.n)),R=$r(R+this.long0),u=L0(u)):(u=NR(a.y/this.a,this.es,this.en),M=Math.abs(u),M<Tr?(M=Math.sin(u),h=this.long0+a.x*Math.sqrt(1-this.es*M*M)/(this.a*Math.cos(u)),R=$r(h)):M-Ur<Tr&&(R=this.long0)),a.x=R,a.y=u,a}var wO=["Sinusoidal","sinu"];const MO={init:_O,forward:xO,inverse:AO,names:wO};function bO(){}function EO(a){for(var u=a.x,h=a.y,R=$r(u-this.long0),M=h,v=Math.PI*Math.sin(h);;){var y=-(M+Math.sin(M)-v)/(1+Math.cos(M));if(M+=y,Math.abs(y)<Ur)break}M/=2,Math.PI/2-Math.abs(h)<Ur&&(R=0);var p=.900316316158*this.a*R*Math.cos(M)+this.x0,g=1.4142135623731*this.a*Math.sin(M)+this.y0;return a.x=p,a.y=g,a}function TO(a){var u,h;a.x-=this.x0,a.y-=this.y0,h=a.y/(1.4142135623731*this.a),Math.abs(h)>.999999999999&&(h=.999999999999),u=Math.asin(h);var R=$r(this.long0+a.x/(.900316316158*this.a*Math.cos(u)));R<-Math.PI&&(R=-Math.PI),R>Math.PI&&(R=Math.PI),h=(2*u+Math.sin(2*u))/Math.PI,Math.abs(h)>1&&(h=1);var M=Math.asin(h);return a.x=R,a.y=M,a}var SO=["Mollweide","moll"];const RO={init:bO,forward:EO,inverse:TO,names:SO};function CO(){Math.abs(this.lat1+this.lat2)<Ur||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ev(this.es),this.e1=tv(this.es),this.e2=rv(this.es),this.e3=nv(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=fl(this.e,this.sinphi,this.cosphi),this.ml1=Bs(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Ur?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=fl(this.e,this.sinphi,this.cosphi),this.ml2=Bs(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Bs(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function PO(a){var u=a.x,h=a.y,R;if(this.sphere)R=this.a*(this.g-h);else{var M=Bs(this.e0,this.e1,this.e2,this.e3,h);R=this.a*(this.g-M)}var v=this.ns*$r(u-this.long0),y=this.x0+R*Math.sin(v),p=this.y0+this.rh-R*Math.cos(v);return a.x=y,a.y=p,a}function LO(a){a.x-=this.x0,a.y=this.rh-a.y+this.y0;var u,h,R,M;this.ns>=0?(h=Math.sqrt(a.x*a.x+a.y*a.y),u=1):(h=-Math.sqrt(a.x*a.x+a.y*a.y),u=-1);var v=0;if(h!==0&&(v=Math.atan2(u*a.x,u*a.y)),this.sphere)return M=$r(this.long0+v/this.ns),R=L0(this.g-h/this.a),a.x=M,a.y=R,a;var y=this.g-h/this.a;return R=Xy(y,this.e0,this.e1,this.e2,this.e3),M=$r(this.long0+v/this.ns),a.x=M,a.y=R,a}var OO=["Equidistant_Conic","eqdc"];const FO={init:CO,forward:PO,inverse:LO,names:OO};function IO(){this.R=this.a}function kO(a){var u=a.x,h=a.y,R=$r(u-this.long0),M,v;Math.abs(h)<=Ur&&(M=this.x0+this.R*R,v=this.y0);var y=Nf(2*Math.abs(h/Math.PI));(Math.abs(R)<=Ur||Math.abs(Math.abs(h)-Tr)<=Ur)&&(M=this.x0,h>=0?v=this.y0+Math.PI*this.R*Math.tan(.5*y):v=this.y0+Math.PI*this.R*-Math.tan(.5*y));var p=.5*Math.abs(Math.PI/R-R/Math.PI),g=p*p,C=Math.sin(y),D=Math.cos(y),B=D/(C+D-1),V=B*B,P=B*(2/C-1),L=P*P,E=Math.PI*this.R*(p*(B-L)+Math.sqrt(g*(B-L)*(B-L)-(L+g)*(V-L)))/(L+g);R<0&&(E=-E),M=this.x0+E;var b=g+B;return E=Math.PI*this.R*(P*b-p*Math.sqrt((L+g)*(g+1)-b*b))/(L+g),h>=0?v=this.y0+E:v=this.y0-E,a.x=M,a.y=v,a}function DO(a){var u,h,R,M,v,y,p,g,C,D,B,V,P;return a.x-=this.x0,a.y-=this.y0,B=Math.PI*this.R,R=a.x/B,M=a.y/B,v=R*R+M*M,y=-Math.abs(M)*(1+v),p=y-2*M*M+R*R,g=-2*y+1+2*M*M+v*v,P=M*M/g+(2*p*p*p/g/g/g-9*y*p/g/g)/27,C=(y-p*p/3/g)/g,D=2*Math.sqrt(-C/3),B=3*P/C/D,Math.abs(B)>1&&(B>=0?B=1:B=-1),V=Math.acos(B)/3,a.y>=0?h=(-D*Math.cos(V+Math.PI/3)-p/3/g)*Math.PI:h=-(-D*Math.cos(V+Math.PI/3)-p/3/g)*Math.PI,Math.abs(R)<Ur?u=this.long0:u=$r(this.long0+Math.PI*(v-1+Math.sqrt(1+2*(R*R-M*M)+v*v))/2/R),a.x=u,a.y=h,a}var NO=["Van_der_Grinten_I","VanDerGrinten","vandg"];const BO={init:IO,forward:kO,inverse:DO,names:NO};function UO(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function zO(a){var u=a.x,h=a.y,R=Math.sin(a.y),M=Math.cos(a.y),v=$r(u-this.long0),y,p,g,C,D,B,V,P,L,E,b,_,x,T,N,U,H,q,te,Q,Z,ae,F;return this.sphere?Math.abs(this.sin_p12-1)<=Ur?(a.x=this.x0+this.a*(Tr-h)*Math.sin(v),a.y=this.y0-this.a*(Tr-h)*Math.cos(v),a):Math.abs(this.sin_p12+1)<=Ur?(a.x=this.x0+this.a*(Tr+h)*Math.sin(v),a.y=this.y0+this.a*(Tr+h)*Math.cos(v),a):(q=this.sin_p12*R+this.cos_p12*M*Math.cos(v),U=Math.acos(q),H=U?U/Math.sin(U):1,a.x=this.x0+this.a*H*M*Math.sin(v),a.y=this.y0+this.a*H*(this.cos_p12*R-this.sin_p12*M*Math.cos(v)),a):(y=ev(this.es),p=tv(this.es),g=rv(this.es),C=nv(this.es),Math.abs(this.sin_p12-1)<=Ur?(D=this.a*Bs(y,p,g,C,Tr),B=this.a*Bs(y,p,g,C,h),a.x=this.x0+(D-B)*Math.sin(v),a.y=this.y0-(D-B)*Math.cos(v),a):Math.abs(this.sin_p12+1)<=Ur?(D=this.a*Bs(y,p,g,C,Tr),B=this.a*Bs(y,p,g,C,h),a.x=this.x0+(D+B)*Math.sin(v),a.y=this.y0+(D+B)*Math.cos(v),a):(V=R/M,P=C0(this.a,this.e,this.sin_p12),L=C0(this.a,this.e,R),E=Math.atan((1-this.es)*V+this.es*P*this.sin_p12/(L*M)),b=Math.atan2(Math.sin(v),this.cos_p12*Math.tan(E)-this.sin_p12*Math.cos(v)),b===0?te=Math.asin(this.cos_p12*Math.sin(E)-this.sin_p12*Math.cos(E)):Math.abs(Math.abs(b)-Math.PI)<=Ur?te=-Math.asin(this.cos_p12*Math.sin(E)-this.sin_p12*Math.cos(E)):te=Math.asin(Math.sin(v)*Math.cos(E)/Math.sin(b)),_=this.e*this.sin_p12/Math.sqrt(1-this.es),x=this.e*this.cos_p12*Math.cos(b)/Math.sqrt(1-this.es),T=_*x,N=x*x,Q=te*te,Z=Q*te,ae=Z*te,F=ae*te,U=P*te*(1-Q*N*(1-N)/6+Z/8*T*(1-2*N)+ae/120*(N*(4-7*N)-3*_*_*(1-7*N))-F/48*T),a.x=this.x0+U*Math.sin(b),a.y=this.y0+U*Math.cos(b),a))}function GO(a){a.x-=this.x0,a.y-=this.y0;var u,h,R,M,v,y,p,g,C,D,B,V,P,L,E,b,_,x,T,N,U,H,q,te;return this.sphere?(u=Math.sqrt(a.x*a.x+a.y*a.y),u>2*Tr*this.a?void 0:(h=u/this.a,R=Math.sin(h),M=Math.cos(h),v=this.long0,Math.abs(u)<=Ur?y=this.lat0:(y=Nf(M*this.sin_p12+a.y*R*this.cos_p12/u),p=Math.abs(this.lat0)-Tr,Math.abs(p)<=Ur?this.lat0>=0?v=$r(this.long0+Math.atan2(a.x,-a.y)):v=$r(this.long0-Math.atan2(-a.x,a.y)):v=$r(this.long0+Math.atan2(a.x*R,u*this.cos_p12*M-a.y*this.sin_p12*R))),a.x=v,a.y=y,a)):(g=ev(this.es),C=tv(this.es),D=rv(this.es),B=nv(this.es),Math.abs(this.sin_p12-1)<=Ur?(V=this.a*Bs(g,C,D,B,Tr),u=Math.sqrt(a.x*a.x+a.y*a.y),P=V-u,y=Xy(P/this.a,g,C,D,B),v=$r(this.long0+Math.atan2(a.x,-1*a.y)),a.x=v,a.y=y,a):Math.abs(this.sin_p12+1)<=Ur?(V=this.a*Bs(g,C,D,B,Tr),u=Math.sqrt(a.x*a.x+a.y*a.y),P=u-V,y=Xy(P/this.a,g,C,D,B),v=$r(this.long0+Math.atan2(a.x,a.y)),a.x=v,a.y=y,a):(u=Math.sqrt(a.x*a.x+a.y*a.y),b=Math.atan2(a.x,a.y),L=C0(this.a,this.e,this.sin_p12),_=Math.cos(b),x=this.e*this.cos_p12*_,T=-x*x/(1-this.es),N=3*this.es*(1-T)*this.sin_p12*this.cos_p12*_/(1-this.es),U=u/L,H=U-T*(1+T)*Math.pow(U,3)/6-N*(1+3*T)*Math.pow(U,4)/24,q=1-T*H*H/2-U*H*H*H/6,E=Math.asin(this.sin_p12*Math.cos(H)+this.cos_p12*Math.sin(H)*_),v=$r(this.long0+Math.asin(Math.sin(b)*Math.sin(H)/Math.cos(E))),te=Math.sin(E),y=Math.atan2((te-this.es*q*this.sin_p12)*Math.tan(E),te*(1-this.es)),a.x=v,a.y=y,a))}var VO=["Azimuthal_Equidistant","aeqd"];const WO={init:UO,forward:zO,inverse:GO,names:VO};function HO(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function qO(a){var u,h,R,M,v,y,p,g,C=a.x,D=a.y;return R=$r(C-this.long0),u=Math.sin(D),h=Math.cos(D),M=Math.cos(R),y=this.sin_p14*u+this.cos_p14*h*M,v=1,(y>0||Math.abs(y)<=Ur)&&(p=this.a*v*h*Math.sin(R),g=this.y0+this.a*v*(this.cos_p14*u-this.sin_p14*h*M)),a.x=p,a.y=g,a}function XO(a){var u,h,R,M,v,y,p;return a.x-=this.x0,a.y-=this.y0,u=Math.sqrt(a.x*a.x+a.y*a.y),h=Nf(u/this.a),R=Math.sin(h),M=Math.cos(h),y=this.long0,Math.abs(u)<=Ur?(p=this.lat0,a.x=y,a.y=p,a):(p=Nf(M*this.sin_p14+a.y*R*this.cos_p14/u),v=Math.abs(this.lat0)-Tr,Math.abs(v)<=Ur?(this.lat0>=0?y=$r(this.long0+Math.atan2(a.x,-a.y)):y=$r(this.long0-Math.atan2(-a.x,a.y)),a.x=y,a.y=p,a):(y=$r(this.long0+Math.atan2(a.x*R,u*this.cos_p14*M-a.y*this.sin_p14*R)),a.x=y,a.y=p,a))}var ZO=["ortho"];const jO={init:HO,forward:qO,inverse:XO,names:ZO};var ga={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Fi={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function YO(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Tr-Oi/2?this.face=ga.TOP:this.lat0<=-(Tr-Oi/2)?this.face=ga.BOTTOM:Math.abs(this.long0)<=Oi?this.face=ga.FRONT:Math.abs(this.long0)<=Tr+Oi?this.face=this.long0>0?ga.RIGHT:ga.LEFT:this.face=ga.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function JO(a){var u={x:0,y:0},h,R,M,v,y,p,g={value:0};if(a.x-=this.long0,this.es!==0?h=Math.atan(this.one_minus_f_squared*Math.tan(a.y)):h=a.y,R=a.x,this.face===ga.TOP)v=Tr-h,R>=Oi&&R<=Tr+Oi?(g.value=Fi.AREA_0,M=R-Tr):R>Tr+Oi||R<=-(Tr+Oi)?(g.value=Fi.AREA_1,M=R>0?R-Oa:R+Oa):R>-(Tr+Oi)&&R<=-Oi?(g.value=Fi.AREA_2,M=R+Tr):(g.value=Fi.AREA_3,M=R);else if(this.face===ga.BOTTOM)v=Tr+h,R>=Oi&&R<=Tr+Oi?(g.value=Fi.AREA_0,M=-R+Tr):R<Oi&&R>=-Oi?(g.value=Fi.AREA_1,M=-R):R<-Oi&&R>=-(Tr+Oi)?(g.value=Fi.AREA_2,M=-R-Tr):(g.value=Fi.AREA_3,M=R>0?-R+Oa:-R-Oa);else{var C,D,B,V,P,L,E;this.face===ga.RIGHT?R=T0(R,+Tr):this.face===ga.BACK?R=T0(R,+Oa):this.face===ga.LEFT&&(R=T0(R,-Tr)),V=Math.sin(h),P=Math.cos(h),L=Math.sin(R),E=Math.cos(R),C=P*E,D=P*L,B=V,this.face===ga.FRONT?(v=Math.acos(C),M=Iy(v,B,D,g)):this.face===ga.RIGHT?(v=Math.acos(D),M=Iy(v,B,-C,g)):this.face===ga.BACK?(v=Math.acos(-C),M=Iy(v,B,-D,g)):this.face===ga.LEFT?(v=Math.acos(-D),M=Iy(v,B,C,g)):(v=M=0,g.value=Fi.AREA_0)}return p=Math.atan(12/Oa*(M+Math.acos(Math.sin(M)*Math.cos(Oi))-Tr)),y=Math.sqrt((1-Math.cos(v))/(Math.cos(p)*Math.cos(p))/(1-Math.cos(Math.atan(1/Math.cos(M))))),g.value===Fi.AREA_1?p+=Tr:g.value===Fi.AREA_2?p+=Oa:g.value===Fi.AREA_3&&(p+=1.5*Oa),u.x=y*Math.cos(p),u.y=y*Math.sin(p),u.x=u.x*this.a+this.x0,u.y=u.y*this.a+this.y0,a.x=u.x,a.y=u.y,a}function $O(a){var u={lam:0,phi:0},h,R,M,v,y,p,g,C,D,B={value:0};if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,R=Math.atan(Math.sqrt(a.x*a.x+a.y*a.y)),h=Math.atan2(a.y,a.x),a.x>=0&&a.x>=Math.abs(a.y)?B.value=Fi.AREA_0:a.y>=0&&a.y>=Math.abs(a.x)?(B.value=Fi.AREA_1,h-=Tr):a.x<0&&-a.x>=Math.abs(a.y)?(B.value=Fi.AREA_2,h=h<0?h+Oa:h-Oa):(B.value=Fi.AREA_3,h+=Tr),D=Oa/12*Math.tan(h),y=Math.sin(D)/(Math.cos(D)-1/Math.sqrt(2)),p=Math.atan(y),M=Math.cos(h),v=Math.tan(R),g=1-M*M*v*v*(1-Math.cos(Math.atan(1/Math.cos(p)))),g<-1?g=-1:g>1&&(g=1),this.face===ga.TOP)C=Math.acos(g),u.phi=Tr-C,B.value===Fi.AREA_0?u.lam=p+Tr:B.value===Fi.AREA_1?u.lam=p<0?p+Oa:p-Oa:B.value===Fi.AREA_2?u.lam=p-Tr:u.lam=p;else if(this.face===ga.BOTTOM)C=Math.acos(g),u.phi=C-Tr,B.value===Fi.AREA_0?u.lam=-p+Tr:B.value===Fi.AREA_1?u.lam=-p:B.value===Fi.AREA_2?u.lam=-p-Tr:u.lam=p<0?-p-Oa:-p+Oa;else{var V,P,L;V=g,D=V*V,D>=1?L=0:L=Math.sqrt(1-D)*Math.sin(p),D+=L*L,D>=1?P=0:P=Math.sqrt(1-D),B.value===Fi.AREA_1?(D=P,P=-L,L=D):B.value===Fi.AREA_2?(P=-P,L=-L):B.value===Fi.AREA_3&&(D=P,P=L,L=-D),this.face===ga.RIGHT?(D=V,V=-P,P=D):this.face===ga.BACK?(V=-V,P=-P):this.face===ga.LEFT&&(D=V,V=P,P=-D),u.phi=Math.acos(-L)-Tr,u.lam=Math.atan2(P,V),this.face===ga.RIGHT?u.lam=T0(u.lam,-Tr):this.face===ga.BACK?u.lam=T0(u.lam,-Oa):this.face===ga.LEFT&&(u.lam=T0(u.lam,+Tr))}if(this.es!==0){var E,b,_;E=u.phi<0?1:0,b=Math.tan(u.phi),_=this.b/Math.sqrt(b*b+this.one_minus_f_squared),u.phi=Math.atan(Math.sqrt(this.a*this.a-_*_)/(this.one_minus_f*_)),E&&(u.phi=-u.phi)}return u.lam+=this.long0,a.x=u.lam,a.y=u.phi,a}function Iy(a,u,h,R){var M;return a<Ur?(R.value=Fi.AREA_0,M=0):(M=Math.atan2(u,h),Math.abs(M)<=Oi?R.value=Fi.AREA_0:M>Oi&&M<=Tr+Oi?(R.value=Fi.AREA_1,M-=Tr):M>Tr+Oi||M<=-(Tr+Oi)?(R.value=Fi.AREA_2,M=M>=0?M-Oa:M+Oa):(R.value=Fi.AREA_3,M+=Tr)),M}function T0(a,u){var h=a+u;return h<-Oa?h+=Ym:h>+Oa&&(h-=Ym),h}var QO=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const KO={init:YO,forward:JO,inverse:$O,names:QO};var DM=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Xm=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],zR=.8487,GR=1.3523,VR=ll/5,eF=1/VR,E0=18,Zy=function(a,u){return a[0]+u*(a[1]+u*(a[2]+u*a[3]))},tF=function(a,u){return a[1]+u*(2*a[2]+u*3*a[3])};function rF(a,u,h,R){for(var M=u;R;--R){var v=a(M);if(M-=v,Math.abs(v)<h)break}return M}function nF(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function iF(a){var u=$r(a.x-this.long0),h=Math.abs(a.y),R=Math.floor(h*VR);R<0?R=0:R>=E0&&(R=E0-1),h=ll*(h-eF*R);var M={x:Zy(DM[R],h)*u,y:Zy(Xm[R],h)};return a.y<0&&(M.y=-M.y),M.x=M.x*this.a*zR+this.x0,M.y=M.y*this.a*GR+this.y0,M}function aF(a){var u={x:(a.x-this.x0)/(this.a*zR),y:Math.abs(a.y-this.y0)/(this.a*GR)};if(u.y>=1)u.x/=DM[E0][0],u.y=a.y<0?-Tr:Tr;else{var h=Math.floor(u.y*E0);for(h<0?h=0:h>=E0&&(h=E0-1);;)if(Xm[h][0]>u.y)--h;else if(Xm[h+1][0]<=u.y)++h;else break;var R=Xm[h],M=5*(u.y-R[0])/(Xm[h+1][0]-R[0]);M=rF(function(v){return(Zy(R,v)-u.y)/tF(R,v)},M,Ur,100),u.x/=Zy(DM[h],M),u.y=(5*h+M)*ds,a.y<0&&(u.y=-u.y)}return u.x=$r(u.x+this.long0),u}var sF=["Robinson","robin"];const oF={init:nF,forward:iF,inverse:aF,names:sF};function uF(){this.name="geocent"}function lF(a){var u=SR(a,this.es,this.a);return u}function cF(a){var u=RR(a,this.es,this.a,this.b);return u}var fF=["Geocentric","geocentric","geocent","Geocent"];const hF={init:uF,forward:lF,inverse:cF,names:fF};var Rs={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Um={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function dF(){if(Object.keys(Um).forEach(function(h){if(typeof this[h]>"u")this[h]=Um[h].def;else{if(Um[h].num&&isNaN(this[h]))throw new Error("Invalid parameter value, must be numeric "+h+" = "+this[h]);Um[h].num&&(this[h]=parseFloat(this[h]))}Um[h].degrees&&(this[h]=this[h]*ds)}.bind(this)),Math.abs(Math.abs(this.lat0)-Tr)<Ur?this.mode=this.lat0<0?Rs.S_POLE:Rs.N_POLE:Math.abs(this.lat0)<Ur?this.mode=Rs.EQUIT:(this.mode=Rs.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var a=this.tilt,u=this.azi;this.cg=Math.cos(u),this.sg=Math.sin(u),this.cw=Math.cos(a),this.sw=Math.sin(a)}function pF(a){a.x-=this.long0;var u=Math.sin(a.y),h=Math.cos(a.y),R=Math.cos(a.x),M,v;switch(this.mode){case Rs.OBLIQ:v=this.sinph0*u+this.cosph0*h*R;break;case Rs.EQUIT:v=h*R;break;case Rs.S_POLE:v=-u;break;case Rs.N_POLE:v=u;break}switch(v=this.pn1/(this.p-v),M=v*h*Math.sin(a.x),this.mode){case Rs.OBLIQ:v*=this.cosph0*u-this.sinph0*h*R;break;case Rs.EQUIT:v*=u;break;case Rs.N_POLE:v*=-(h*R);break;case Rs.S_POLE:v*=h*R;break}var y,p;return y=v*this.cg+M*this.sg,p=1/(y*this.sw*this.h1+this.cw),M=(M*this.cg-v*this.sg)*this.cw*p,v=y*p,a.x=M*this.a,a.y=v*this.a,a}function mF(a){a.x/=this.a,a.y/=this.a;var u={x:a.x,y:a.y},h,R,M;M=1/(this.pn1-a.y*this.sw),h=this.pn1*a.x*M,R=this.pn1*a.y*this.cw*M,a.x=h*this.cg+R*this.sg,a.y=R*this.cg-h*this.sg;var v=Pu(a.x,a.y);if(Math.abs(v)<Ur)u.x=0,u.y=a.y;else{var y,p;switch(p=1-v*v*this.pfact,p=(this.p-Math.sqrt(p))/(this.pn1/v+v/this.pn1),y=Math.sqrt(1-p*p),this.mode){case Rs.OBLIQ:u.y=Math.asin(y*this.sinph0+a.y*p*this.cosph0/v),a.y=(y-this.sinph0*Math.sin(u.y))*v,a.x*=p*this.cosph0;break;case Rs.EQUIT:u.y=Math.asin(a.y*p/v),a.y=y*v,a.x*=p;break;case Rs.N_POLE:u.y=Math.asin(y),a.y=-a.y;break;case Rs.S_POLE:u.y=-Math.asin(y);break}u.x=Math.atan2(a.x,a.y)}return a.x=u.x+this.long0,a.y=u.y,a}var vF=["Tilted_Perspective","tpers"];const gF={init:dF,forward:pF,inverse:mF,names:vF};function yF(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var a=1-this.es,u=1/a;this.radius_p=Math.sqrt(a),this.radius_p2=a,this.radius_p_inv2=u,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function _F(a){var u=a.x,h=a.y,R,M,v,y;if(u=u-this.long0,this.shape==="ellipse"){h=Math.atan(this.radius_p2*Math.tan(h));var p=this.radius_p/Pu(this.radius_p*Math.cos(h),Math.sin(h));if(M=p*Math.cos(u)*Math.cos(h),v=p*Math.sin(u)*Math.cos(h),y=p*Math.sin(h),(this.radius_g-M)*M-v*v-y*y*this.radius_p_inv2<0)return a.x=Number.NaN,a.y=Number.NaN,a;R=this.radius_g-M,this.flip_axis?(a.x=this.radius_g_1*Math.atan(v/Pu(y,R)),a.y=this.radius_g_1*Math.atan(y/R)):(a.x=this.radius_g_1*Math.atan(v/R),a.y=this.radius_g_1*Math.atan(y/Pu(v,R)))}else this.shape==="sphere"&&(R=Math.cos(h),M=Math.cos(u)*R,v=Math.sin(u)*R,y=Math.sin(h),R=this.radius_g-M,this.flip_axis?(a.x=this.radius_g_1*Math.atan(v/Pu(y,R)),a.y=this.radius_g_1*Math.atan(y/R)):(a.x=this.radius_g_1*Math.atan(v/R),a.y=this.radius_g_1*Math.atan(y/Pu(v,R))));return a.x=a.x*this.a,a.y=a.y*this.a,a}function xF(a){var u=-1,h=0,R=0,M,v,y,p;if(a.x=a.x/this.a,a.y=a.y/this.a,this.shape==="ellipse"){this.flip_axis?(R=Math.tan(a.y/this.radius_g_1),h=Math.tan(a.x/this.radius_g_1)*Pu(1,R)):(h=Math.tan(a.x/this.radius_g_1),R=Math.tan(a.y/this.radius_g_1)*Pu(1,h));var g=R/this.radius_p;if(M=h*h+g*g+u*u,v=2*this.radius_g*u,y=v*v-4*M*this.C,y<0)return a.x=Number.NaN,a.y=Number.NaN,a;p=(-v-Math.sqrt(y))/(2*M),u=this.radius_g+p*u,h*=p,R*=p,a.x=Math.atan2(h,u),a.y=Math.atan(R*Math.cos(a.x)/u),a.y=Math.atan(this.radius_p_inv2*Math.tan(a.y))}else if(this.shape==="sphere"){if(this.flip_axis?(R=Math.tan(a.y/this.radius_g_1),h=Math.tan(a.x/this.radius_g_1)*Math.sqrt(1+R*R)):(h=Math.tan(a.x/this.radius_g_1),R=Math.tan(a.y/this.radius_g_1)*Math.sqrt(1+h*h)),M=h*h+R*R+u*u,v=2*this.radius_g*u,y=v*v-4*M*this.C,y<0)return a.x=Number.NaN,a.y=Number.NaN,a;p=(-v-Math.sqrt(y))/(2*M),u=this.radius_g+p*u,h*=p,R*=p,a.x=Math.atan2(h,u),a.y=Math.atan(R*Math.cos(a.x)/u)}return a.x=a.x+this.long0,a}var AF=["Geostationary Satellite View","Geostationary_Satellite","geos"];const wF={init:yF,forward:_F,inverse:xF,names:AF};function MF(a){a.Proj.projections.add(Gy),a.Proj.projections.add(Vy),a.Proj.projections.add(C4),a.Proj.projections.add(U4),a.Proj.projections.add(q4),a.Proj.projections.add(J4),a.Proj.projections.add(rL),a.Proj.projections.add(oL),a.Proj.projections.add(hL),a.Proj.projections.add(gL),a.Proj.projections.add(IL),a.Proj.projections.add(zL),a.Proj.projections.add(qL),a.Proj.projections.add($L),a.Proj.projections.add(rO),a.Proj.projections.add(oO),a.Proj.projections.add(hO),a.Proj.projections.add(gO),a.Proj.projections.add(MO),a.Proj.projections.add(RO),a.Proj.projections.add(FO),a.Proj.projections.add(BO),a.Proj.projections.add(WO),a.Proj.projections.add(jO),a.Proj.projections.add(KO),a.Proj.projections.add(oF),a.Proj.projections.add(hF),a.Proj.projections.add(gF),a.Proj.projections.add(wF)}Mo.defaultDatum="WGS84";Mo.Proj=cl;Mo.WGS84=new Mo.Proj("WGS84");Mo.Point=R0;Mo.toPoint=CR;Mo.defs=Ns;Mo.nadgrid=LP;Mo.transform=qy;Mo.mgrs=ZP;Mo.version="__VERSION__";MF(Mo);const bF=Object.freeze(Object.defineProperty({__proto__:null,default:Mo},Symbol.toStringTag,{value:"Module"})),Jh=Ky(bF);var Cx={},eE;function ps(){return eE||(eE=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Jh);h.default.defs("EPSG:4978","+proj=geocent +datum=WGS84 +units=m +no_defs");function R(L){return L.startsWith("TMS")}function M(L){return L.startsWith("EPSG")}function v(L){return R(L)?L:"TMS:".concat(L.match(/\d+/)[0])}function y(L){return M(L)?L:"EPSG:".concat(L.match(/\d+/)[0])}var p={DEGREE:1,METER:2};function g(L){return L==="EPSG:4326"}function C(L){var E=h.default.defs(L);return E?E.projName=="geocent":!1}function D(L){return L==="degrees"?p.DEGREE:L==="m"?p.METER:void 0}function B(L){switch(L){case"EPSG:4326":return p.DEGREE;case"EPSG:4978":return p.METER;default:{var E=h.default.defs(y(L));return E?D(E.units):void 0}}}function V(L){var E=B(L);if(L===void 0||E===void 0)throw new Error("Invalid crs parameter value '".concat(L,"'"));return E}var P={UNIT:p,isValid:function(E){V(E)},isGeographic:function(E){return V(E)==p.DEGREE},isMetricUnit:function(E){return B(E)==p.METER},toUnit:B,is4326:g,isGeocentric:C,reasonnableEpsilon:function(E){return g(E)?.01:.001},formatToEPSG:y,formatToTms:v,isTms:R,isEpsg:M,tms_3857:"TMS:3857",tms_4326:"TMS:4326",defs:function(E,b){return h.default.defs(E,b)}};a.default=P}(Cx)),Cx}var Px={},tE;function $h(){return tE||(tE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.ellipsoidSizes=a.default=void 0;var R=u(Ir()),M=u(kr()),v=C(Dr()),y=u(Jh),p=u(Zi());function g(L){if(typeof WeakMap!="function")return null;var E=new WeakMap,b=new WeakMap;return(g=function(x){return x?b:E})(L)}function C(L,E){if(!E&&L&&L.__esModule)return L;if(L===null||h(L)!=="object"&&typeof L!="function")return{default:L};var b=g(E);if(b&&b.has(L))return b.get(L);var _={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in L)if(T!=="default"&&Object.prototype.hasOwnProperty.call(L,T)){var N=x?Object.getOwnPropertyDescriptor(L,T):null;N&&(N.get||N.set)?Object.defineProperty(_,T,N):_[T]=L[T]}return _.default=L,b&&b.set(L,_),_}var D=new v.Vector3(y.default.WGS84.a,y.default.WGS84.a,y.default.WGS84.b);a.ellipsoidSizes=D;var B=new v.Vector3,V=function(){function L(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:D;(0,R.default)(this,L),this.size=new v.Vector3,this._radiiSquared=new v.Vector3,this._invRadiiSquared=new v.Vector3,this.eccentricity=0,this.setSize(E)}return(0,M.default)(L,[{key:"geodeticSurfaceNormal",value:function(b){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new v.Vector3;return b.toVector3(_).multiply(this._invRadiiSquared).normalize()}},{key:"geodeticSurfaceNormalCartographic",value:function(b){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new v.Vector3,x=v.MathUtils.degToRad(b.longitude),T=v.MathUtils.degToRad(b.latitude),N=Math.cos(T);return _.set(N*Math.cos(x),N*Math.sin(x),Math.sin(T))}},{key:"setSize",value:function(b){this.size.set(b.x,b.y,b.z),this._radiiSquared.multiplyVectors(b,b),this._invRadiiSquared.x=b.x==0?0:1/this._radiiSquared.x,this._invRadiiSquared.y=b.y==0?0:1/this._radiiSquared.y,this._invRadiiSquared.z=b.z==0?0:1/this._radiiSquared.z,this.eccentricity=Math.sqrt(this._radiiSquared.x-this._radiiSquared.z)/this.size.x}},{key:"cartographicToCartesian",value:function(b){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new v.Vector3;B.copy(b.geodesicNormal),_.multiplyVectors(this._radiiSquared,B);var x=Math.sqrt(B.dot(_));return _.divideScalar(x),B.multiplyScalar(b.altitude),_.add(B)}},{key:"cartesianToCartographic",value:function(b){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new p.default("EPSG:4326",0,0,0),x=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z),T=this.size.x,N=this.size.z,U=Math.abs((T*T-N*N)/(T*T)),H=1-Math.sqrt(1-U),q=Math.sqrt(b.x*b.x+b.y*b.y),te=Math.atan2(b.y,b.x),Q=Math.atan(b.z/q*(1-H+U*T/x)),Z=Math.sin(Q),ae=Math.cos(Q),F=Math.atan((b.z*(1-H)+U*T*Z*Z*Z)/((1-H)*(q-U*T*ae*ae*ae))),W=q*Math.cos(F)+b.z*Math.sin(F)-T*Math.sqrt(1-U*Math.sin(F)*Math.sin(F));return _.setFromValues(v.MathUtils.radToDeg(te),v.MathUtils.radToDeg(F),W)}},{key:"cartographicToCartesianArray",value:function(b){for(var _=[],x=0;x<b.length;x++)_.push(this.cartographicToCartesian(b[x]));return _}},{key:"intersection",value:function(b){var _=1e-4,x=b.origin,T=b.direction,N=T.x*T.x*this._invRadiiSquared.x+T.y*T.y*this._invRadiiSquared.y+T.z*T.z*this._invRadiiSquared.z,U=2*x.x*T.x*this._invRadiiSquared.x+2*x.y*T.y*this._invRadiiSquared.y+2*x.z*T.z*this._invRadiiSquared.z,H=x.x*x.x*this._invRadiiSquared.x+x.y*x.y*this._invRadiiSquared.y+x.z*x.z*this._invRadiiSquared.z-1,q=U*U-4*N*H;if(q<0||N===0||U===0||H===0)return!1;q=Math.sqrt(q);var te=(-U+q)/(2*N),Q=(-U-q)/(2*N);if(te<=_&&Q<=_)return!1;var Z=0;if(te<=_?Z=Q:Q<=_?Z=te:Z=te<Q?te:Q,Z<_)return!1;var ae=new v.Vector3;return ae.addVectors(b.origin,T.clone().setLength(Z)),ae}},{key:"computeDistance",value:function(b,_){console.warn("computeDistance is renamed to geodesicDistance"),this.geodesicDistance(b,_)}},{key:"geodesicDistance",value:function(b,_){var x=v.MathUtils.degToRad(b.longitude),T=v.MathUtils.degToRad(b.latitude),N=v.MathUtils.degToRad(_.longitude),U=v.MathUtils.degToRad(_.latitude),H=Math.acos(Math.sin(T)*Math.sin(U)+Math.cos(T)*Math.cos(U)*Math.cos(N-x)),q=this.eccentricity,te=Math.pow(q*Math.sin((T+U)*.5),2),Q=this.size.x*(1-Math.pow(q,2))/Math.pow(1-te,3/2),Z=this.size.x/Math.sqrt(1-te);return H*Math.sqrt(Q*Z)}}]),L}(),P=V;a.default=P}(Px)),Px}var rE;function Zi(){return rE||(rE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=D(Dr()),y=u(Jh),p=u(ps()),g=u($h());function C(N){if(typeof WeakMap!="function")return null;var U=new WeakMap,H=new WeakMap;return(C=function(te){return te?H:U})(N)}function D(N,U){if(!U&&N&&N.__esModule)return N;if(N===null||h(N)!=="object"&&typeof N!="function")return{default:N};var H=C(U);if(H&&H.has(N))return H.get(N);var q={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in N)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(N,Q)){var Z=te?Object.getOwnPropertyDescriptor(N,Q):null;Z&&(Z.get||Z.set)?Object.defineProperty(q,Q,Z):q[Q]=N[Q]}return q.default=N,H&&H.set(N,q),q}y.default.defs("EPSG:4978","+proj=geocent +datum=WGS84 +units=m +no_defs");var B=new g.default,V={},P=new v.Vector3,L=new v.Vector3,E,b;function _(N,U){return V[N]||(V[N]={}),V[N][U]||(V[N][U]=(0,y.default)(N,U)),V[N][U]}var x=function(){function N(U){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,te=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;(0,R.default)(this,N),this.isCoordinates=!0,p.default.isValid(U),this.crs=U,this.x=0,this.y=0,this.z=0,this._normal=new v.Vector3,H.length>0?this.setFromArray(H):H.isVector3||H.isCoordinates?this.setFromVector3(H):this.setFromValues(H,q,te),this._normalNeedsUpdate=!0}return(0,M.default)(N,[{key:"setFromValues",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.x=H==null?0:H,this.y=q==null?0:q,this.z=te==null?0:te,this._normalNeedsUpdate=!0,this}},{key:"setFromArray",value:function(H){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.setFromValues(H[q],H[q+1],H[q+2])}},{key:"setFromVector3",value:function(H){return this.setFromValues(H.x,H.y,H.z)}},{key:"clone",value:function(){return new N(this.crs,this)}},{key:"copy",value:function(H){return this.crs=H.crs,this.setFromVector3(H)}},{key:"longitude",get:function(){return this.x}},{key:"latitude",get:function(){return this.y}},{key:"altitude",get:function(){return this.z},set:function(H){this.z=H}},{key:"geodesicNormal",get:function(){return this._normalNeedsUpdate&&(this._normalNeedsUpdate=!1,p.default.is4326(this.crs)?B.geodeticSurfaceNormalCartographic(this,this._normal):this.crs=="EPSG:4978"?B.geodeticSurfaceNormal(this,this._normal):this._normal.set(0,0,1)),this._normal}},{key:"toVector3",value:function(){var H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new v.Vector3;return H.copy(this)}},{key:"planarDistanceTo",value:function(H){return this.toVector3(P).setZ(0),H.toVector3(L).setZ(0),P.distanceTo(L)}},{key:"geodeticDistanceTo",value:function(H){return this.as("EPSG:4326",E),H.as("EPSG:4326",b),B.geodesicDistance(E,b)}},{key:"spatialEuclideanDistanceTo",value:function(H){return this.as("EPSG:4978",E).toVector3(P),H.as("EPSG:4978",b).toVector3(L),P.distanceTo(L)}},{key:"applyMatrix4",value:function(H){return v.Vector3.prototype.applyMatrix4.call(this,H)}},{key:"as",value:function(H){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new N(H);return this.crs==H?q.copy(this):(p.default.is4326(this.crs)&&H=="EPSG:3857"&&(this.y=v.MathUtils.clamp(this.y,-89.999999,89.999999)),q.setFromArray(_(this.crs,H).forward([this.x,this.y,this.z]))),q.crs=H,q}}]),N}();E=new x("EPSG:4326",0,0,0),b=new x("EPSG:4326",0,0,0);var T=x;a.default=T}(Tx)),Tx}var nE;function ya(){return nE||(nE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.schemeTiles=a.globalExtentTMS=a.default=void 0;var R=u(Ir()),M=u(kr()),v=C(Dr()),y=u(Zi()),p=u(ps());function g(se){if(typeof WeakMap!="function")return null;var ue=new WeakMap,Y=new WeakMap;return(g=function(Ee){return Ee?Y:ue})(se)}function C(se,ue){if(!ue&&se&&se.__esModule)return se;if(se===null||h(se)!=="object"&&typeof se!="function")return{default:se};var Y=g(ue);if(Y&&Y.has(se))return Y.get(se);var pe={},Ee=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Fe in se)if(Fe!=="default"&&Object.prototype.hasOwnProperty.call(se,Fe)){var $e=Ee?Object.getOwnPropertyDescriptor(se,Fe):null;$e&&($e.get||$e.set)?Object.defineProperty(pe,Fe,$e):pe[Fe]=se[Fe]}return pe.default=se,Y&&Y.set(se,pe),pe}var D=new v.Vector2,B=new v.Vector2,V=new v.Vector2,P=new v.Box3,L=new v.Vector2,E=new v.Vector2,b=new v.Vector2(2,2),_={row:0,col:0,invDiff:0},x=new y.default("EPSG:4326",0,0,0),T=new y.default("EPSG:4326",0,0,0),N=new y.default("EPSG:4326",0,0,0),U=new v.Vector3,H=new v.Vector3;function q(se,ue){var Y=se.zoom-ue,pe=Math.pow(2,Y);return _.invDiff=1/pe,_.row=(se.row-se.row%pe)*_.invDiff,_.col=(se.col-se.col%pe)*_.invDiff,_}for(var te,Q,Z=new Array(8),ae=Z.length-1;ae>=0;ae--)Z[ae]=new y.default("EPSG:4326",0,0,0,0);var F=new y.default("EPSG:4326",0,0),W=new Map;a.globalExtentTMS=W;var O=new Map;a.schemeTiles=O;function X(se){var ue=p.default.formatToEPSG(se),Y=W.get(ue),pe=Y.planarDimensions(B),Ee=p.default.formatToTms(se),Fe=O.get(Ee)||O.get("default"),$e=!Ee.includes(":NI");return{epsg:ue,globalExtent:Y,globalDimension:pe,sTs:Fe,isInverted:$e}}function G(se,ue){var Y=O.get(p.default.formatToTms(se))||O.get("default"),pe=Math.pow(2,ue);return V.set(pe,pe).multiply(Y),V}var j=function(){function se(ue,Y,pe,Ee,Fe){if((0,R.default)(this,se),p.default.isGeocentric(ue))throw new Error("".concat(ue," is a geocentric projection, it doesn't make sense with a geographical extent"));this.isExtent=!0,this.crs=ue,this.zoom=0,p.default.isTms(this.crs)?(this.row=0,this.col=0):(this.west=0,this.east=0,this.south=0,this.north=0),this.set(Y,pe,Ee,Fe)}return(0,M.default)(se,[{key:"clone",value:function(){return p.default.isTms(this.crs)?new se(this.crs,this.zoom,this.row,this.col):new se(this.crs,this.west,this.east,this.south,this.north)}},{key:"tiledCovering",value:function(Y){if(this.crs=="EPSG:4326"&&Y==p.default.tms_3857){var pe=[],Ee=te.copy(this).as(p.default.formatToEPSG(Y),Q),Fe=X(p.default.formatToEPSG(Y)),$e=Fe.globalExtent,pt=Fe.globalDimension,Ue=Fe.sTs;Ee.clampByExtent($e),Ee.planarDimensions(E);var Je=this.zoom+1||Math.floor(Math.log2(Math.round(pt.x/(E.x*Ue.x)))),et=G(Y,Je),ze=Ee.center(F);L.x=ze.x-$e.west,L.y=$e.north-Ee.north,L.divide(pt).multiply(et).floor();for(var Xe=Math.ceil(($e.north-Ee.south)/pt.x*et.y)-1,tt=Xe;tt>=L.y;tt--)pe.push(new se(Y,Je,tt,L.x));return pe}else{var ye=new se(Y,0,0,0),Ze=X(this.crs),Ge=Ze.globalExtent,Ae=Ze.globalDimension,Se=Ze.sTs,Te=Ze.isInverted,me=this.center(F);this.planarDimensions(E);var be=Math.floor(Math.log2(Math.round(Ae.x/(E.x*Se.x)))),we=G(Y,be);return L.x=me.x-Ge.west,L.y=Te?Ge.north-me.y:me.y-Ge.south,L.divide(Ae).multiply(we).floor(),ye.set(be,L.y,L.x),[ye]}}},{key:"as",value:function(Y,pe){if(p.default.isValid(Y),pe=pe||new se("EPSG:4326",[0,0,0,0]),p.default.isTms(this.crs)){var Ee=X(this.crs),Fe=Ee.epsg,$e=Ee.globalExtent,pt=Ee.globalDimension,Ue=G(this.crs,this.zoom);return E.set(1,1).divide(Ue).multiply(pt),pe.west=$e.west+(pt.x-E.x*(Ue.x-this.col)),pe.east=pe.west+E.x,pe.south=$e.south+E.y*(Ue.y-this.row-1),pe.north=pe.south+E.y,pe.crs=Fe,pe.zoom=this.zoom,Y==Fe?pe:pe.as(Y,pe)}else if(p.default.isEpsg(Y)){if(this.crs!=Y){var Je=this.center(F);Z[0].setFromValues(this.west,this.north),Z[1].setFromValues(Je.x,this.north),Z[2].setFromValues(this.east,this.north),Z[3].setFromValues(this.east,Je.y),Z[4].setFromValues(this.east,this.south),Z[5].setFromValues(Je.x,this.south),Z[6].setFromValues(this.west,this.south),Z[7].setFromValues(this.west,Je.y),pe.set(1/0,-1/0,1/0,-1/0);for(var et=0;et<Z.length;et++)Z[et].crs=this.crs,Z[et].as(Y,F),pe.north=Math.max(pe.north,F.y),pe.south=Math.min(pe.south,F.y),pe.east=Math.max(pe.east,F.x),pe.west=Math.min(pe.west,F.x);return pe.zoom=this.zoom,pe.crs=Y,pe}return pe.crs=Y,pe.zoom=this.zoom,pe.set(this.west,this.east,this.south,this.north),pe}}},{key:"center",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new y.default(this.crs);if(p.default.isTms(this.crs))throw new Error("Invalid operation for WMTS bbox");return this.planarDimensions(D),Y.crs=this.crs,Y.setFromValues(this.west+D.x*.5,this.south+D.y*.5),Y}},{key:"dimensions",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new v.Vector2;return console.warn("Extent.dimensions is deprecated, use planarDimensions, geodeticDimensions or spatialEuclideanDimensions"),Y.x=Math.abs(this.east-this.west),Y.y=Math.abs(this.north-this.south),Y}},{key:"planarDimensions",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new v.Vector2;return Y.set(Math.abs(this.east-this.west),Math.abs(this.north-this.south))}},{key:"geodeticDimensions",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new v.Vector2;return x.crs=this.crs,T.crs=this.crs,N.crs=this.crs,x.setFromValues(this.west,this.north,0),T.setFromValues(this.west,this.south,0),N.setFromValues(this.east,this.north,0),Y.set(x.geodeticDistanceTo(N),x.geodeticDistanceTo(T))}},{key:"spatialEuclideanDimensions",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new v.Vector2;return x.crs=this.crs,T.crs=this.crs,N.crs=this.crs,x.setFromValues(this.west,this.north,0),T.setFromValues(this.west,this.south,0),N.setFromValues(this.east,this.north,0),Y.set(x.spatialEuclideanDistanceTo(N),x.spatialEuclideanDistanceTo(T))}},{key:"isPointInside",value:function(Y){var pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.crs==Y.crs?F.copy(Y):Y.as(this.crs,F),F.x<=this.east+pe&&F.x>=this.west-pe&&F.y<=this.north+pe&&F.y>=this.south-pe}},{key:"isInside",value:function(Y,pe){return p.default.isTms(this.crs)?this.zoom==Y.zoom?this.row==Y.row&&this.col==Y.col:this.zoom<Y.zoom?!1:(q(this,Y.zoom),_.row==Y.row&&_.col==Y.col):(Y.as(this.crs,te),pe=pe==null?p.default.reasonnableEpsilon(this.crs):pe,this.east-te.east<=pe&&te.west-this.west<=pe&&this.north-te.north<=pe&&te.south-this.south<=pe)}},{key:"offsetToParent",value:function(Y){var pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new v.Vector4;if(this.crs!=Y.crs)throw new Error("unsupported mix");if(p.default.isTms(this.crs))return q(this,Y.zoom),pe.set(this.col*_.invDiff-_.col,this.row*_.invDiff-_.row,_.invDiff,_.invDiff);Y.planarDimensions(D),this.planarDimensions(B);var Ee=(this.west-Y.west)/D.x,Fe=(Y.north-this.north)/D.y,$e=B.x/D.x,pt=B.y/D.y;return pe.set(Ee,Fe,$e,pt)}},{key:"tiledExtentParent",value:function(Y){return Y&&Y<this.zoom?(q(this,Y),new se(this.crs,Y,_.row,_.col)):this}},{key:"intersectsExtent",value:function(Y){var pe=Y.crs==this.crs?Y:Y.as(this.crs,te);return!(this.west>=pe.east||this.east<=pe.west||this.south>=pe.north||this.north<=pe.south)}},{key:"intersect",value:function(Y){return this.intersectsExtent(Y)?(Y.crs!=this.crs&&(Y=Y.as(this.crs,te)),new se(this.crs,Math.max(this.west,Y.west),Math.min(this.east,Y.east),Math.max(this.south,Y.south),Math.min(this.north,Y.north))):new se(this.crs,0,0,0,0)}},{key:"set",value:function(Y,pe,Ee,Fe){if(Y==null)throw new Error("No values to set in the extent");return Y.isExtent&&(p.default.isTms(Y.crs)?(pe=Y.row,Ee=Y.col,Y=Y.zoom):(pe=Y.east,Ee=Y.south,Fe=Y.north,Y=Y.west)),p.default.isTms(this.crs)?(this.zoom=Y,this.row=pe,this.col=Ee):Y.isCoordinates?(this.west=Y.x,this.east=pe.x,this.south=Y.y,this.north=pe.y):Y.west!==void 0?(this.west=Y.west,this.east=Y.east,this.south=Y.south,this.north=Y.north):Y.length==4?(this.west=Y[0],this.east=Y[1],this.south=Y[2],this.north=Y[3]):Fe!==void 0&&(this.west=Y,this.east=pe,this.south=Ee,this.north=Fe),this}},{key:"copy",value:function(Y){return this.crs=Y.crs,this.set(Y)}},{key:"union",value:function(Y){if(Y.crs!=this.crs)throw new Error("unsupported union between 2 diff crs");if(this.west===1/0)this.copy(Y);else{var pe=Y.west;pe<this.west&&(this.west=pe);var Ee=Y.east;Ee>this.east&&(this.east=Ee);var Fe=Y.south;Fe<this.south&&(this.south=Fe);var $e=Y.north;$e>this.north&&(this.north=$e)}}},{key:"expandByCoordinates",value:function(Y){var pe=Y.crs==this.crs?Y:Y.as(this.crs,F);this.expandByValuesCoordinates(pe.x,pe.y)}},{key:"expandByValuesCoordinates",value:function(Y,pe){Y<this.west&&(this.west=Y),Y>this.east&&(this.east=Y),pe<this.south&&(this.south=pe),pe>this.north&&(this.north=pe)}},{key:"toString",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return p.default.isTms(this.crs)?"".concat(this.zoom).concat(Y).concat(this.row).concat(Y).concat(this.col):"".concat(this.east).concat(Y).concat(this.north).concat(Y).concat(this.west).concat(Y).concat(this.south)}},{key:"subdivision",value:function(){return this.subdivisionByScheme()}},{key:"subdivisionByScheme",value:function(){for(var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b,pe=[],Ee=this.planarDimensions(D).divide(Y),Fe=Y.x-1;Fe>=0;Fe--)for(var $e=Y.y-1;$e>=0;$e--){var pt=this.west+Fe*Ee.x,Ue=this.south+$e*Ee.y;pe.push(new se(this.crs,pt,pt+Ee.x,Ue,Ue+Ee.y))}return pe}},{key:"applyMatrix4",value:function(Y){if(!p.default.isTms(this.crs)){if(U.set(this.west,this.south,0).applyMatrix4(Y),H.set(this.east,this.north,0).applyMatrix4(Y),this.west=U.x,this.east=H.x,this.south=U.y,this.north=H.y,this.west>this.east){var pe=this.west;this.west=this.east,this.east=pe}if(this.south>this.north){var Ee=this.south;this.south=this.north,this.north=Ee}return this}}},{key:"clampSouthNorth",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.south,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.north;return this.south=Math.max(this.south,Y),this.north=Math.min(this.north,pe),this}},{key:"clampWestEast",value:function(){var Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.west,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.east;return this.west=Math.max(this.west,Y),this.east=Math.min(this.east,pe),this}},{key:"clampByExtent",value:function(Y){return this.clampSouthNorth(Y.south,Y.north),this.clampWestEast(Y.west,Y.east)}}],[{key:"fromBox3",value:function(Y,pe){return p.default.isGeocentric(Y)&&(Y="EPSG:4326",pe=P.copy(pe),T.crs=Y,T.setFromVector3(pe.min).as(Y,T).toVector3(pe.min),N.crs=Y,N.setFromVector3(pe.max).as(Y,N).toVector3(pe.max)),new se(Y,{west:pe.min.x,east:pe.max.x,south:pe.min.y,north:pe.max.y})}}]),se}();te=new j("EPSG:4326",[0,0,0,0]),Q=new j("EPSG:4326",[0,0,0,0]),W.set("EPSG:4326",new j("EPSG:4326",-180,180,-90,90));var K=W.get("EPSG:4326").as("EPSG:3857");K.clampSouthNorth(K.west,K.east),W.set("EPSG:3857",K),O.set("default",new v.Vector2(1,1)),O.set(p.default.tms_3857,O.get("default")),O.set(p.default.tms_4326,new v.Vector2(2,1));var ce=j;a.default=ce}(Mx)),Mx}var Lx={},iE;function r2(){return iE||(iE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=C(Dr()),y=u(Zi()),p=u(ps());function g(E){if(typeof WeakMap!="function")return null;var b=new WeakMap,_=new WeakMap;return(g=function(T){return T?_:b})(E)}function C(E,b){if(!b&&E&&E.__esModule)return E;if(E===null||h(E)!=="object"&&typeof E!="function")return{default:E};var _=g(b);if(_&&_.has(E))return _.get(E);var x={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in E)if(N!=="default"&&Object.prototype.hasOwnProperty.call(E,N)){var U=T?Object.getOwnPropertyDescriptor(E,N):null;U&&(U.get||U.set)?Object.defineProperty(x,N,U):x[N]=E[N]}return x.default=E,_&&_.set(E,x),x}var D=new y.default("EPSG:4326"),B=new v.Vector2;function V(E,b){var _=Math.floor(E.x),x=Math.floor(E.y),T=E.x-_,N=E.y-x;return(1-T)*((1-N)*b(x,_)+N*b(x+1,_))+T*((1-N)*b(x,_+1)+N*b(x+1,_+1))}var P=function(){function E(b,_,x){(0,R.default)(this,E),p.default.isGeographic(b.crs),this.extent=b,this.step=new v.Vector2(_.x,_.y||_.x),this.dimensions=this.extent.planarDimensions(),this.dataSize=new v.Vector2().addVectors(this.step,this.dimensions).divide(this.step).round(),this.getData=x}return(0,M.default)(E,[{key:"getHeightAtCoordinates",value:function(_){return _.as(this.extent.crs,D),B.set((this.dataSize.x-1)*(D.x-this.extent.west)/this.dimensions.x,(this.dataSize.y-1)*(D.y-this.extent.south)/this.dimensions.y),B.x<0||B.x>=this.dataSize.x-1||B.y<0||B.y>=this.dataSize.y-1?0:V(B,this.getData)}}]),E}(),L=P;a.default=L}(Lx)),Lx}var Ox={},Fx={exports:{}},aE;function Wi(){return aE||(aE=1,function(a){function u(h){if(h===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return h}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(Fx)),Fx.exports}var Ix={exports:{}},kx={exports:{}},Dx={exports:{}},sE;function ln(){return sE||(sE=1,function(a){function u(h){return a.exports=u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(M){return M.__proto__||Object.getPrototypeOf(M)},a.exports.__esModule=!0,a.exports.default=a.exports,u(h)}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(Dx)),Dx.exports}var oE;function EF(){return oE||(oE=1,function(a){var u=ln();function h(R,M){for(;!Object.prototype.hasOwnProperty.call(R,M)&&(R=u(R),R!==null););return R}a.exports=h,a.exports.__esModule=!0,a.exports.default=a.exports}(kx)),kx.exports}var uE;function Cs(){return uE||(uE=1,function(a){var u=EF();function h(){return typeof Reflect<"u"&&Reflect.get?(a.exports=h=Reflect.get.bind(),a.exports.__esModule=!0,a.exports.default=a.exports):(a.exports=h=function(M,v,y){var p=u(M,v);if(!!p){var g=Object.getOwnPropertyDescriptor(p,v);return g.get?g.get.call(arguments.length<3?M:y):g.value}},a.exports.__esModule=!0,a.exports.default=a.exports),h.apply(this,arguments)}a.exports=h,a.exports.__esModule=!0,a.exports.default=a.exports}(Ix)),Ix.exports}var Nx={exports:{}},Bx={exports:{}},lE;function TF(){return lE||(lE=1,function(a){function u(h,R){return a.exports=u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,y){return v.__proto__=y,v},a.exports.__esModule=!0,a.exports.default=a.exports,u(h,R)}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(Bx)),Bx.exports}var cE;function dn(){return cE||(cE=1,function(a){var u=TF();function h(R,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function");R.prototype=Object.create(M&&M.prototype,{constructor:{value:R,writable:!0,configurable:!0}}),Object.defineProperty(R,"prototype",{writable:!1}),M&&u(R,M)}a.exports=h,a.exports.__esModule=!0,a.exports.default=a.exports}(Nx)),Nx.exports}var Ux={exports:{}},fE;function pn(){return fE||(fE=1,function(a){var u=Lr.exports.default,h=Wi();function R(M,v){if(v&&(u(v)==="object"||typeof v=="function"))return v;if(v!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(M)}a.exports=R,a.exports.__esModule=!0,a.exports.default=a.exports}(Ux)),Ux.exports}var zx={},Gx={exports:{}},Vx={exports:{}},Wx={exports:{}},hE;function WR(){return hE||(hE=1,function(a){function u(h,R){(R==null||R>h.length)&&(R=h.length);for(var M=0,v=new Array(R);M<R;M++)v[M]=h[M];return v}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(Wx)),Wx.exports}var dE;function SF(){return dE||(dE=1,function(a){var u=WR();function h(R){if(Array.isArray(R))return u(R)}a.exports=h,a.exports.__esModule=!0,a.exports.default=a.exports}(Vx)),Vx.exports}var Hx={exports:{}},pE;function RF(){return pE||(pE=1,function(a){function u(h){if(typeof Symbol<"u"&&h[Symbol.iterator]!=null||h["@@iterator"]!=null)return Array.from(h)}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(Hx)),Hx.exports}var qx={exports:{}},mE;function HR(){return mE||(mE=1,function(a){var u=WR();function h(R,M){if(!!R){if(typeof R=="string")return u(R,M);var v=Object.prototype.toString.call(R).slice(8,-1);if(v==="Object"&&R.constructor&&(v=R.constructor.name),v==="Map"||v==="Set")return Array.from(R);if(v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v))return u(R,M)}}a.exports=h,a.exports.__esModule=!0,a.exports.default=a.exports}(qx)),qx.exports}var Xx={exports:{}},vE;function CF(){return vE||(vE=1,function(a){function u(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(Xx)),Xx.exports}var gE;function Qh(){return gE||(gE=1,function(a){var u=SF(),h=RF(),R=HR(),M=CF();function v(y){return u(y)||h(y)||R(y)||M()}a.exports=v,a.exports.__esModule=!0,a.exports.default=a.exports}(Gx)),Gx.exports}var Zx={exports:{}},jx={exports:{}},yE;function PF(){return yE||(yE=1,function(a){function u(h,R){return R.get?R.get.call(h):R.value}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(jx)),jx.exports}var Yx={exports:{}},_E;function qR(){return _E||(_E=1,function(a){function u(h,R,M){if(!R.has(h))throw new TypeError("attempted to "+M+" private field on non-instance");return R.get(h)}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(Yx)),Yx.exports}var xE;function Kh(){return xE||(xE=1,function(a){var u=PF(),h=qR();function R(M,v){var y=h(M,v,"get");return u(M,y)}a.exports=R,a.exports.__esModule=!0,a.exports.default=a.exports}(Zx)),Zx.exports}var Jx={exports:{}},$x={exports:{}},AE;function LF(){return AE||(AE=1,function(a){function u(h,R,M){if(R.set)R.set.call(h,M);else{if(!R.writable)throw new TypeError("attempted to set read only private field");R.value=M}}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}($x)),$x.exports}var wE;function O0(){return wE||(wE=1,function(a){var u=LF(),h=qR();function R(M,v,y){var p=h(M,v,"set");return u(M,p,y),y}a.exports=R,a.exports.__esModule=!0,a.exports.default=a.exports}(Jx)),Jx.exports}var Qx={},Kx={},eA={exports:{}},tA={exports:{}},ME;function OF(){return ME||(ME=1,function(a){function u(h){if(Array.isArray(h))return h}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(tA)),tA.exports}var rA={exports:{}},bE;function FF(){return bE||(bE=1,function(a){function u(h,R){var M=h==null?null:typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(M!=null){var v=[],y=!0,p=!1,g,C;try{for(M=M.call(h);!(y=(g=M.next()).done)&&(v.push(g.value),!(R&&v.length===R));y=!0);}catch(D){p=!0,C=D}finally{try{!y&&M.return!=null&&M.return()}finally{if(p)throw C}}return v}}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(rA)),rA.exports}var nA={exports:{}},EE;function IF(){return EE||(EE=1,function(a){function u(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}a.exports=u,a.exports.__esModule=!0,a.exports.default=a.exports}(nA)),nA.exports}var TE;function XR(){return TE||(TE=1,function(a){var u=OF(),h=FF(),R=HR(),M=IF();function v(y,p){return u(y)||h(y,p)||R(y,p)||M()}a.exports=v,a.exports.__esModule=!0,a.exports.default=a.exports}(eA)),eA.exports}var iA={},SE;function kF(){return SE||(SE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=p(Dr()),M=u(F0()),v=u(Zi());function y(V){if(typeof WeakMap!="function")return null;var P=new WeakMap,L=new WeakMap;return(y=function(b){return b?L:P})(V)}function p(V,P){if(!P&&V&&V.__esModule)return V;if(V===null||h(V)!=="object"&&typeof V!="function")return{default:V};var L=y(P);if(L&&L.has(V))return L.get(V);var E={},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in V)if(_!=="default"&&Object.prototype.hasOwnProperty.call(V,_)){var x=b?Object.getOwnPropertyDescriptor(V,_):null;x&&(x.get||x.set)?Object.defineProperty(E,_,x):E[_]=V[_]}return E.default=V,L&&L.set(V,E),E}var g={v:new R.Vector3,coord1:new v.default("EPSG:4978"),coord2:new v.default("EPSG:4978"),offset:new R.Vector2};function C(V,P,L,E,b,_){var x=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},T=arguments.length>7?arguments[7]:void 0,N=arguments.length>8?arguments[8]:void 0,U=T||new v.default(E);x.worldFromLocal?U.setFromVector3(g.v.copy(b).applyMatrix4(x.worldFromLocal)):U.setFromVector3(b);var H=M.default.getTerrainObjectAt(V,U,P,L,N);if(H)return H.coord.z+=_,H.coord.as(E,g.coord2).toVector3(b),x.localFromWorld&&b.applyMatrix4(x.localFromWorld),{id:H.texture.id,version:H.texture.version,tile:H.tile}}function D(V,P,L){var E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},b=arguments.length>4?arguments[4]:void 0;console.warn("placeObjectOnGround has been deprecated because it needs review and test");var _;if(b?_=b.concat(V.level0Nodes):_=V.level0Nodes,E.modifyGeometry){var N={worldFromLocal:L.matrixWorld,localFromWorld:new R.Matrix4().copy(L.matrixWorld).invert()},U=L.geometry;if(U.vertices){E.cache&&(E.cache.length=U.vertices.length);for(var H=!0,q=new v.default(P),te=0;te<U.vertices.length;te++){var Q=E.cache?E.cache[te]:void 0,Z=C(V,E.method||M.default.FAST_READ_Z,_,P,U.vertices[te],E.offset||0,N,q,Q);E.cache&&(E.cache[te]=Z),Z||(H=!1)}return U.verticesNeedUpdate=!0,H}else if(U.isBufferGeometry){E.cache&&(E.cache.length=U.attributes.position.count);for(var ae=!0,F=new R.Vector3,W=new v.default(P),O=0;O<U.attributes.position.count;O++){var X=E.cache?E.cache[O]:void 0;F.fromBufferAttribute(U.attributes.position,O);var G=F.z,j=C(V,E.method||M.default.FAST_READ_Z,_,P,F,E.offset||0,N,W,X);E.cache&&(E.cache[O]=j),j||(ae=!1),G!=F.z&&(U.attributes.position.needsUpdate=!0),U.attributes.position.setXYZ(O,F.x,F.y,F.z)}return ae}}else{E.cache&&(E.cache.length=1);var x={worldFromLocal:L.parent?L.parent.matrixWorld:void 0,localFromWorld:L.parent?new R.Matrix4().copy(L.parent.matrixWorld).invert():void 0},T=C(V,E.method||M.default.FAST_READ_Z,_,P,L.position,E.offset||0,x,void 0,E.cache?E.cache[0]:void 0);if(T)return E.cache&&(E.cache[0]=T),L.updateMatrix(),L.updateMatrixWorld(),!0}}var B=D;a.default=B}(iA)),iA}var RE;function F0(){return RE||(RE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.readTextureValueWithBilinearFiltering=x;var R=u(XR()),M=g(Dr()),v=u(Zi()),y=u(kF());function p(Z){if(typeof WeakMap!="function")return null;var ae=new WeakMap,F=new WeakMap;return(p=function(O){return O?F:ae})(Z)}function g(Z,ae){if(!ae&&Z&&Z.__esModule)return Z;if(Z===null||h(Z)!=="object"&&typeof Z!="function")return{default:Z};var F=p(ae);if(F&&F.has(Z))return F.get(Z);var W={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in Z)if(X!=="default"&&Object.prototype.hasOwnProperty.call(Z,X)){var G=O?Object.getOwnPropertyDescriptor(Z,X):null;G&&(G.get||G.set)?Object.defineProperty(W,X,G):W[X]=Z[X]}return W.default=Z,F&&F.set(Z,W),W}var C=0,D=1,B={getElevationValueAt:function(ae,F){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:C,O=arguments.length>3?arguments[3]:void 0,X=Q(ae,W,F,O||ae.level0Nodes);if(X)return X.coord.z},getTerrainObjectAt:function(ae,F){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:C,O=arguments.length>3?arguments[3]:void 0,X=arguments.length>4?arguments[4]:void 0;return Q(ae,W,F,O||ae.level0Nodes,X)},FAST_READ_Z:C,PRECISE_READ_Z:D,placeObjectOnGround:y.default};a.default=B;function V(Z,ae){if(ae.extent){if(!ae.extent.isPointInside(Z))return;for(var F=0;F<ae.children.length;F++){var W=V(Z,ae.children[F]);if(W)return W}var O=ae.material.getElevationLayer();return O&&O.level>=0?ae:void 0}}var P;function L(Z,ae){for(var F=arguments.length,W=new Array(F>2?F-2:0),O=2;O<F;O++)W[O-2]=arguments[O];for(var X=0;X<W.length;X+=2)W[X]=M.MathUtils.clamp(W[X],0,ae.image.width-1),W[X+1]=M.MathUtils.clamp(W[X+1],0,ae.image.height-1);if(ae.image.data){if(W.length===2){var G=ae.image.data[W[1]*ae.image.width+W[0]];return G!=Z.noDataValue?G:void 0}for(var j=[],K=0;K<W.length;K+=2){var ce=ae.image.data[W[K+1]*ae.image.width+W[K]];j.push(ce!=Z.noDataValue?ce:void 0)}return j}else{P||(P=document.createElement("canvas"),P.width=2,P.height=2);for(var se=1/0,ue=1/0,Y=-1/0,pe=-1/0,Ee=0;Ee<W.length;Ee+=2)se=Math.min(W[Ee],se),ue=Math.min(W[Ee+1],ue),Y=Math.max(W[Ee],Y),pe=Math.max(W[Ee+1],pe);var Fe=Y-se+1,$e=pe-ue+1;P.width=Math.max(P.width,Fe),P.height=Math.max(P.height,$e);var pt=P.getContext("2d");pt.drawImage(ae.image,se,ue,Fe,$e,0,0,Fe,$e);for(var Ue=pt.getImageData(0,0,Fe,$e),Je=[],et=0;et<W.length;et+=2){var ze=W[et]-se,Xe=W[et+1]-ue,tt=M.MathUtils.lerp(Z.colorTextureElevationMinZ,Z.colorTextureElevationMaxZ,Ue.data[4*Xe*Fe+4*ze]/255);Je.push(tt!=Z.noDataValue?tt:void 0)}return W.length===2?Je[0]:Je}}function E(Z,ae,F){var W=Z.image.width,O=Z.image.height,X=Math.max(0,ae*W-.5),G=Math.max(0,F*O-.5),j=Math.floor(X),K=Math.ceil(X),ce=Math.floor(G),se=Math.ceil(G);return{u1:j,u2:K,v1:ce,v2:se,wu:X-j,wv:G-ce}}function b(Z,ae,F,W){var O=E(ae,F,W),X=O.wu<=0?O.u1:O.u2,G=O.wv<=0?O.v1:O.v2;return L(Z,ae,X,G)}function _(Z,ae,F){return Z==null?ae:ae==null?Z:M.MathUtils.lerp(Z,ae,F)}function x(Z,ae,F,W){var O=E(ae,F,W),X=L(Z,ae,O.u1,O.v1,O.u2,O.v1,O.u1,O.v2,O.u2,O.v2),G=(0,R.default)(X,4),j=G[0],K=G[1],ce=G[2],se=G[3],ue=_(j,K,O.wu),Y=_(ce,se,O.wu);return _(ue,Y,O.wv)}function T(Z,ae,F){var W=Z.attachedLayers.filter(function(O){return O.isElevationLayer})[0];return b(W,ae,F.x,F.y)}var N=new M.Vector3;function U(Z,ae,F,W,O){var X=W.x/O.x/16,G=Math.floor(F.x/X)*X,j=Math.floor(F.y/X)*X;G==1&&(G-=X),j==1&&(j-=X);var K=G,ce=G+X,se=j,ue=j+X,Y=(F.x-G)/X,pe=(F.y-j)/X,Ee=new M.Triangle(new M.Vector3(K,ue),new M.Vector3(ce,se),pe==1||Y/(1-pe)>=1?new M.Vector3(ce,ue):new M.Vector3(K,se));Ee.getBarycoord(new M.Vector3(F.x,F.y),N);var Fe=Z.attachedLayers.filter(function(Je){return Je.isElevationLayer})[0],$e=x(Fe,ae,Ee.a.x,Ee.a.y),pt=x(Fe,ae,Ee.b.x,Ee.b.y),Ue=x(Fe,ae,Ee.c.x,Ee.c.y);return $e*N.x+pt*N.y+Ue*N.z}var H={v:new M.Vector3,coord1:new v.default("EPSG:4978"),coord2:new v.default("EPSG:4978"),offset:new M.Vector2},q=new M.Vector2;function te(Z,ae){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new M.Vector2;if(Z.crs!=ae.crs)throw new Error("Unsupported mix: ".concat(Z.crs," and ").concat(ae.crs));ae.planarDimensions(q);var W=(Z.x-ae.west)/q.x,O=(ae.north-Z.y)/q.y;return F.set(W,O)}function Q(Z,ae,F,W,O){var X,G=F.as(Z.extent.crs,H.coord1),j=null;O!=null&&(X=O.tile)!==null&&X!==void 0&&X.material&&(j=V(G,O.tile));for(var K=0;!j&&K<W.length;K++)j=V(G,W[K]);if(!!j){var ce=j,se=ce.material.getElevationLayer(),ue=se.textures[0];if(O&&O.id===ue.id&&O.version===ue.version)return{coord:G,texture:ue,tile:ce};for(var Y=Math.round(Math.log2(1/se.offsetScales[0].z)),pe=0;pe<Y;pe++)j=j.parent;if(te(G,j.extent,H.offset),ae==D?G.z=U(Z,ue,H.offset,ce.extent.planarDimensions(),j.extent.planarDimensions()):G.z=T(Z,ue,H.offset),G.z!=null)return{coord:G,texture:ue,tile:ce}}}}(Kx)),Kx}var CE;function ZR(){return CE||(CE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.CAMERA_TYPE=void 0;var R=u(Ir()),M=u(kr()),v=u(Kh()),y=u(O0()),p=B(Dr()),g=u(Zi()),C=u(F0());function D(te){if(typeof WeakMap!="function")return null;var Q=new WeakMap,Z=new WeakMap;return(D=function(F){return F?Z:Q})(te)}function B(te,Q){if(!Q&&te&&te.__esModule)return te;if(te===null||h(te)!=="object"&&typeof te!="function")return{default:te};var Z=D(Q);if(Z&&Z.has(te))return Z.get(te);var ae={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var W in te)if(W!=="default"&&Object.prototype.hasOwnProperty.call(te,W)){var O=F?Object.getOwnPropertyDescriptor(te,W):null;O&&(O.get||O.set)?Object.defineProperty(ae,W,O):ae[W]=te[W]}return ae.default=te,Z&&Z.set(te,ae),ae}function V(te,Q,Z){P(te,Q),Q.set(te,Z)}function P(te,Q){if(Q.has(te))throw new TypeError("Cannot initialize the same private elements twice on an object")}var L={PERSPECTIVE:0,ORTHOGRAPHIC:1};a.CAMERA_TYPE=L;var E={frustum:new p.Frustum,matrix:new p.Matrix4,box3:new p.Box3},b=new p.Box3(new p.Vector3(-1,-1,-1),new p.Vector3(1,1,1));function _(te,Q,Z){if(te.camera3D.isOrthographicCamera)te._preSSE=Q;else{var ae=p.MathUtils.degToRad(Z);te._preSSE=Q/(2*Math.tan(ae*.5))}}var x=new WeakMap,T=new WeakMap,N=function(){function te(Q,Z,ae){var F,W=this,O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if((0,R.default)(this,te),V(this,x,{writable:!0,value:!0}),V(this,T,{writable:!0,value:new p.Matrix4}),this.crs=Q,O.isCamera)console.warn("options.camera parameter is deprecated. Use options.camera.cameraThree to place a custom camera as a parameter. See the documentation of Camera."),this.camera3D=O;else if(O.cameraThree)this.camera3D=O.cameraThree;else switch(O.type){case L.ORTHOGRAPHIC:this.camera3D=new p.OrthographicCamera;break;case L.PERSPECTIVE:default:this.camera3D=new p.PerspectiveCamera(30);break}if(this.camera3D.aspect=(F=this.camera3D.aspect)!==null&&F!==void 0?F:1,this.width=Z,this.height=ae,this.resize(Z,ae),this._preSSE=1/0,this.camera3D.isPerspectiveCamera){var X=this.camera3D.fov;Object.defineProperty(this.camera3D,"fov",{get:function(){return X},set:function(j){X=j,_(W,W.height,X)}})}}return(0,M.default)(te,[{key:"resize",value:function(Z,ae){var F=Z/ae;if(this.camera3D.aspect!==F){if(this.camera3D.isOrthographicCamera){this.camera3D.zoom*=this.width/Z;var W=this.camera3D.top*this.camera3D.aspect/F;this.camera3D.bottom=-W,this.camera3D.top=W}else this.camera3D.isPerspectiveCamera&&(this.camera3D.fov=2*p.Math.radToDeg(Math.atan(ae/this.height*Math.tan(p.Math.degToRad(this.camera3D.fov)/2))));this.camera3D.aspect=F}this.width=Z,this.height=ae,_(this,this.height,this.camera3D.fov),this.camera3D.updateProjectionMatrix&&(this.camera3D.updateProjectionMatrix(),(0,y.default)(this,x,!0))}},{key:"update",value:function(){this.camera3D.updateMatrixWorld(),(0,y.default)(this,x,!0)}},{key:"position",value:function(Z){return new g.default(this.crs,this.camera3D.position).as(Z||this.crs)}},{key:"setPosition",value:function(Z){this.camera3D.position.copy(Z.as(this.crs))}},{key:"isBox3Visible",value:function(Z,ae){return this.box3SizeOnScreen(Z,ae).intersectsBox(b)}},{key:"isSphereVisible",value:function(Z,ae){return(0,v.default)(this,x)&&((0,v.default)(this,T).multiplyMatrices(this.camera3D.projectionMatrix,this.camera3D.matrixWorldInverse),(0,y.default)(this,x,!1)),ae?(E.matrix.multiplyMatrices((0,v.default)(this,T),ae),E.frustum.setFromProjectionMatrix(E.matrix)):E.frustum.setFromProjectionMatrix((0,v.default)(this,T)),E.frustum.intersectsSphere(Z)}},{key:"box3SizeOnScreen",value:function(Z,ae){var F=H(this,Z,ae);if(!F)return E.box3.makeEmpty();for(var W=0;W<8;W++)F[W].applyMatrix4(this.camera3D.projectionMatrix);return E.box3.setFromPoints(F)}},{key:"adjustAltitudeToAvoidCollisionWithLayer",value:function(Z,ae,F){var W=Z.camera.position().as("EPSG:4326");if(ae!==void 0){var O=C.default.getElevationValueAt(ae,W);if(O!==void 0){var X=W.altitude-(O+F);X<0&&(W.altitude=O+F,Z.camera.camera3D.position.copy(W.as(Z.referenceCrs)),Z.notifyChange(this.camera3D))}}}}]),te}(),U=[new p.Vector3,new p.Vector3,new p.Vector3,new p.Vector3,new p.Vector3,new p.Vector3,new p.Vector3,new p.Vector3];function H(te,Q,Z){var ae=te.camera3D.matrixWorldInverse;Z&&(ae=E.matrix.multiplyMatrices(te.camera3D.matrixWorldInverse,Z)),U[0].set(Q.min.x,Q.min.y,Q.min.z).applyMatrix4(ae),U[1].set(Q.min.x,Q.min.y,Q.max.z).applyMatrix4(ae),U[2].set(Q.min.x,Q.max.y,Q.min.z).applyMatrix4(ae),U[3].set(Q.min.x,Q.max.y,Q.max.z).applyMatrix4(ae),U[4].set(Q.max.x,Q.min.y,Q.min.z).applyMatrix4(ae),U[5].set(Q.max.x,Q.min.y,Q.max.z).applyMatrix4(ae),U[6].set(Q.max.x,Q.max.y,Q.min.z).applyMatrix4(ae),U[7].set(Q.max.x,Q.max.y,Q.max.z).applyMatrix4(ae);for(var F=!1,W=0;W<8;W++)U[W].z<=-te.camera3D.near?F=!0:U[W].z=-te.camera3D.near;return F?U:void 0}var q=N;a.default=q}(Qx)),Qx}var aA={},PE;function ed(){return PE||(PE=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.RENDERING_SCHEDULED=a.RENDERING_PAUSED=a.MAIN_LOOP_EVENTS=void 0;var h=u(Ir()),R=u(kr()),M=u(Wi()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(O0()),C=u(Kh()),D=Dr();function B(se){var ue=V();return function(){var Y=(0,p.default)(se),pe;if(ue){var Ee=(0,p.default)(this).constructor;pe=Reflect.construct(Y,arguments,Ee)}else pe=Y.apply(this,arguments);return(0,y.default)(this,pe)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P(se,ue){E(se,ue),ue.add(se)}function L(se,ue,Y){E(se,ue),ue.set(se,Y)}function E(se,ue){if(ue.has(se))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b(se,ue,Y){if(!ue.has(se))throw new TypeError("attempted to get private field on non-instance");return Y}function _(se,ue){var Y=typeof Symbol<"u"&&se[Symbol.iterator]||se["@@iterator"];if(!Y){if(Array.isArray(se)||(Y=x(se))||ue&&se&&typeof se.length=="number"){Y&&(se=Y);var pe=0,Ee=function(){};return{s:Ee,n:function(){return pe>=se.length?{done:!0}:{done:!1,value:se[pe++]}},e:function(Je){throw Je},f:Ee}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Fe=!0,$e=!1,pt;return{s:function(){Y=Y.call(se)},n:function(){var Je=Y.next();return Fe=Je.done,Je},e:function(Je){$e=!0,pt=Je},f:function(){try{!Fe&&Y.return!=null&&Y.return()}finally{if($e)throw pt}}}}function x(se,ue){if(!!se){if(typeof se=="string")return T(se,ue);var Y=Object.prototype.toString.call(se).slice(8,-1);if(Y==="Object"&&se.constructor&&(Y=se.constructor.name),Y==="Map"||Y==="Set")return Array.from(se);if(Y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Y))return T(se,ue)}}function T(se,ue){(ue==null||ue>se.length)&&(ue=se.length);for(var Y=0,pe=new Array(ue);Y<ue;Y++)pe[Y]=se[Y];return pe}var N=0;a.RENDERING_PAUSED=N;var U=1;a.RENDERING_SCHEDULED=U;var H={UPDATE_START:"update_start",BEFORE_CAMERA_UPDATE:"before_camera_update",AFTER_CAMERA_UPDATE:"after_camera_update",BEFORE_LAYER_UPDATE:"before_layer_update",AFTER_LAYER_UPDATE:"after_layer_update",BEFORE_RENDER:"before_render",AFTER_RENDER:"after_render",UPDATE_END:"update_end"};a.MAIN_LOOP_EVENTS=H;function q(se,ue,Y){if(!!Y){var pe=_(Y),Ee;try{for(pe.s();!(Ee=pe.n()).done;){var Fe=Ee.value,$e=ue.update(se,ue,Fe),pt=ue.getObjectToUpdateForAttachedLayers(Fe);if(pt){if(pt.element){var Ue=_(ue.attachedLayers),Je;try{for(Ue.s();!(Je=Ue.n()).done;){var et=Je.value;et.ready&&(et.update(se,et,pt.element,pt.parent),et.cache.flush())}}catch(Ze){Ue.e(Ze)}finally{Ue.f()}}else if(pt.elements)for(var ze=0;ze<pt.elements.length;ze++){if(!pt.elements[ze].isObject3D)throw new Error(`
                            Invalid object for attached layer to update.
                            Must be a THREE.Object and have a THREE.Material`);var Xe=_(ue.attachedLayers),tt;try{for(Xe.s();!(tt=Xe.n()).done;){var ye=tt.value;ye.ready&&(ye.update(se,ye,pt.elements[ze],pt.parent),ye.cache.flush())}}catch(Ze){Xe.e(Ze)}finally{Xe.f()}}}q(se,ue,$e)}}catch(Ze){pe.e(Ze)}finally{pe.f()}}}function te(se,ue){var Y=!1,pe=new Set;return se.forEach(function(Ee){Ee===ue||Ee.isCamera?(ue.info.clear(),Y=!0):Ee.layer===ue&&pe.add(Ee)}),Y?new Set([ue]):pe}var Q=new WeakMap,Z=new WeakMap,ae=new WeakMap,F=new WeakSet,W=new WeakSet,O=new WeakSet,X=function(se){(0,v.default)(Y,se);var ue=B(Y);function Y(pe,Ee){var Fe;return(0,h.default)(this,Y),Fe=ue.call(this),P((0,M.default)(Fe),O),P((0,M.default)(Fe),W),P((0,M.default)(Fe),F),L((0,M.default)(Fe),Q,{writable:!0,value:!1}),L((0,M.default)(Fe),Z,{writable:!0,value:!0}),L((0,M.default)(Fe),ae,{writable:!0,value:0}),Fe.renderingState=N,Fe.scheduler=pe,Fe.gfxEngine=Ee,Fe}return(0,R.default)(Y,[{key:"scheduleViewUpdate",value:function(Ee,Fe){var $e=this;(0,g.default)(this,Q,(0,C.default)(this,Q)|Fe),this.renderingState!==U&&(this.renderingState=U,requestAnimationFrame(function(pt){b($e,W,j).call($e,Ee,pt)}))}}]),Y}(D.EventDispatcher);function G(se,ue,Y){var pe={camera:se.camera,engine:this.gfxEngine,scheduler:this.scheduler,view:se};ue.forEach(function(Xe){var tt=Xe.layer||Xe;tt.isLayer&&tt.parent&&ue.add(tt.parent)});var Ee=_(se.getLayers(function(Xe,tt){return!tt})),Fe;try{for(Ee.s();!(Fe=Ee.n()).done;){var $e=Fe.value;if(pe.geometryLayer=$e,$e.ready&&$e.visible&&!$e.frozen){se.execFrameRequesters(H.BEFORE_LAYER_UPDATE,Y,(0,C.default)(this,Z),$e);var pt=te(ue,$e);if(pt.size>0){var Ue=_($e.attachedLayers),Je;try{for(Ue.s();!(Je=Ue.n()).done;){var et=Je.value;et.ready&&et.preUpdate&&et.preUpdate(pe,pt)}}catch(Xe){Ue.e(Xe)}finally{Ue.f()}var ze=$e.preUpdate(pe,pt);q(pe,$e,ze),$e.postUpdate(pe,$e,ue)}$e.cache.flush(),se.execFrameRequesters(H.AFTER_LAYER_UPDATE,Y,(0,C.default)(this,Z),$e)}}}catch(Xe){Ee.e(Xe)}finally{Ee.f()}}function j(se,ue){var Y=ue-(0,C.default)(this,ae);se._executeFrameRequestersRemovals(),se.execFrameRequesters(H.UPDATE_START,Y,(0,C.default)(this,Z));var pe=(0,C.default)(this,Q);(0,g.default)(this,ae,ue),(0,g.default)(this,Q,!1),this.renderingState=N;var Ee=new Set(se._changeSources);se._changeSources.clear();var Fe=this.gfxEngine.getWindowSize();se.execFrameRequesters(H.BEFORE_CAMERA_UPDATE,Y,(0,C.default)(this,Z)),se.camera.update(Fe.x,Fe.y),se.execFrameRequesters(H.AFTER_CAMERA_UPDATE,Y,(0,C.default)(this,Z));var $e=se.camera.camera3D.matrixAutoUpdate;se.camera.camera3D.matrixAutoUpdate=!1,b(this,F,G).call(this,se,Ee,Y),this.scheduler.commandsWaitingExecutionCount()==0&&this.dispatchEvent({type:"command-queue-empty"}),pe&&b(this,O,K).call(this,se,Y),(0,g.default)(this,Z,this.renderingState===N),se.camera.camera3D.matrixAutoUpdate=$e,se.execFrameRequesters(H.UPDATE_END,Y,(0,C.default)(this,Z))}function K(se,ue){se.execFrameRequesters(H.BEFORE_RENDER,ue,(0,C.default)(this,Z)),se.render?se.render():this.gfxEngine.renderView(se),se.execFrameRequesters(H.AFTER_RENDER,ue,(0,C.default)(this,Z))}var ce=X;a.default=ce}(aA)),aA}var sA={},LE;function td(){return LE||(LE=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=`uniform sampler2D uni[SAMPLE];
void main() {
    gl_FragColor += texture2D(uni[SAMPLE-1], vec2(0));
}`,h=`void main() {
    gl_Position = vec4( 0.0, 0.0, 0.0, 1.0 );
}`,R=!1,M=8,v=4096;function y(C,D,B){var V=C.getContext(),P=V.createShader(D);return V.shaderSource(P,B),V.compileShader(P),P}function p(){return navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox")}var g={isLogDepthBufferSupported:function(){return R},isFirefox:p,isInternetExplorer:function(){var D=!!document.documentMode;return D},getMaxTextureUnitsCount:function(){return M},getMaxTextureSize:function(){return v},updateCapabilities:function(D){var B=D.getContext();M=B.getParameter(B.MAX_TEXTURE_IMAGE_UNITS),v=B.getParameter(B.MAX_TEXTURE_SIZE);var V=B.createProgram(),P=y(D,B.VERTEX_SHADER,h),L="#define SAMPLE ".concat(M,`
`);L+=u;var E=y(D,B.FRAGMENT_SHADER,L);if(B.attachShader(V,P),B.attachShader(V,E),B.linkProgram(V),B.getProgramParameter(V,B.LINK_STATUS)===!1)if(M>16){var b=B.getProgramInfoLog(V);console.warn("".concat(b,": using a maximum of 16 texture units instead of the reported value (").concat(M,")")),p()&&console.warn(`It can come from a Mesa/Firefox bug;
                        the shader compiles to an error when using more than 16 sampler uniforms,
                        see https://bugzilla.mozilla.org/show_bug.cgi?id=777028`),M=16}else throw new Error(`The GPU capabilities could not be determined accurately.
                    Impossible to link a shader with the Maximum texture units `.concat(M));B.deleteProgram(V),B.deleteShader(P),B.deleteShader(E),R=D.capabilities.logarithmicDepthBuffer}};a.default=g}(sA)),sA}var oA={},uA={},au={},lA={},cA={},fA={},OE;function n2(){return OE||(OE=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u="gl_Position.*(?![^]*gl_Position)",h="[^\\w]*main[^\\w]*(void)?[^\\w]*{",R=new RegExp(u),M=new RegExp(h),v={patchMaterialForLogDepthSupport:function(p){if(!(p.vertexShader.includes("USE_LOGDEPTHBUF")||p.vertexShader.includes("logdepthbuf_pars_vertex"))){p.vertexShader=`#include <logdepthbuf_pars_vertex>
#define EPSILON 1e-6
`.concat(p.vertexShader);var g=R.exec(p.vertexShader),C=g[0].length+g.index;p.vertexShader="".concat(p.vertexShader.slice(0,C),`
#include <logdepthbuf_vertex>
`).concat(p.vertexShader.slice(C)),p.fragmentShader=`#include <itowns/precision_qualifier
`.concat(p.fragmentShader),p.fragmentShader=`#include <logdepthbuf_pars_fragment>
`.concat(p.fragmentShader),g=M.exec(p.fragmentShader),C=g[0].length+g.index,p.fragmentShader="".concat(p.fragmentShader.slice(0,C),`
#include <logdepthbuf_fragment>
`).concat(p.fragmentShader.slice(C)),p.defines={USE_LOGDEPTHBUF:1,USE_LOGDEPTHBUF_EXT:1}}},unrollLoops:function(p,g){function C(D,B,V,P){var L="";B=B in g?g[B]:parseInt(B,10),V=V in g?g[V]:parseInt(V,10);for(var E=B;E<V;E++)L+=P.replace(/\bi\b/g," ".concat(E," "));return L}return p.replace(/#pragma unroll_loop\s+for\s*\(\s*int\s+i\s*=\s*([\w\d]+);\s*i\s+<\s+([\w\d]+);\s*i\s*\+\+\s*\)\s*\{\n([^}]*)\}/g,C)}};a.default=v}(fA)),fA}var hA={},FE;function WM(){return FE||(FE=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u={FINAL:0,DEPTH:1,ID:2};function h(M,v){var y,p=(y=M.mode)!==null&&y!==void 0?y:u.FINAL;if(p==v)return function(){};var g=function(C){return function(D){var B=D.material;B&&(B.mode=C)}};return M.traverse(g(v)),function(){M.traverse(g(p))}}var R={MODES:u,push:h};a.default=R}(hA)),hA}var dA={},IE;function jR(){return IE||(IE=1,function(a){var u=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=M(Dr());function R(y){if(typeof WeakMap!="function")return null;var p=new WeakMap,g=new WeakMap;return(R=function(D){return D?g:p})(y)}function M(y,p){if(!p&&y&&y.__esModule)return y;if(y===null||u(y)!=="object"&&typeof y!="function")return{default:y};var g=R(p);if(g&&g.has(y))return g.get(y);var C={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in y)if(B!=="default"&&Object.prototype.hasOwnProperty.call(y,B)){var V=D?Object.getOwnPropertyDescriptor(y,B):null;V&&(V.get||V.set)?Object.defineProperty(C,B,V):C[B]=y[B]}return C.default=y,g&&g.set(y,C),C}var v={setDefineMapping:function(p,g,C){Object.keys(C).forEach(function(D){p.defines["".concat(g,"_").concat(D)]=C[D]})},setDefineProperty:function(p,g,C,D){p.defines[C]=D,Object.defineProperty(p,g,{get:function(){return p.defines[C]},set:function(V){p.defines[C]!=V&&(p.defines[C]=V,p.needsUpdate=!0)}})},setUniformProperty:function(p,g,C){p.uniforms[g]=new h.Uniform(C),Object.defineProperty(p,g,{get:function(){return p.uniforms[g].value},set:function(B){p.uniforms[g].value!=B&&(p.uniforms[g].value=B)}})}};a.default=v}(dA)),dA}var kE;function rd(){return kE||(kE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.colorLayerEffects=a.ELEVATION_MODES=void 0,a.getMaxColorSamplerUnitsCount=K,a.unpack1K=X;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=u(O0()),D=u(Kh()),B=_(Dr()),V=u(n2()),P=u(td()),L=u(WM()),E=u(jR());function b(Ue){if(typeof WeakMap!="function")return null;var Je=new WeakMap,et=new WeakMap;return(b=function(Xe){return Xe?et:Je})(Ue)}function _(Ue,Je){if(!Je&&Ue&&Ue.__esModule)return Ue;if(Ue===null||h(Ue)!=="object"&&typeof Ue!="function")return{default:Ue};var et=b(Je);if(et&&et.has(Ue))return et.get(Ue);var ze={},Xe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var tt in Ue)if(tt!=="default"&&Object.prototype.hasOwnProperty.call(Ue,tt)){var ye=Xe?Object.getOwnPropertyDescriptor(Ue,tt):null;ye&&(ye.get||ye.set)?Object.defineProperty(ze,tt,ye):ze[tt]=Ue[tt]}return ze.default=Ue,et&&et.set(Ue,ze),ze}function x(Ue){var Je=T();return function(){var et=(0,g.default)(Ue),ze;if(Je){var Xe=(0,g.default)(this).constructor;ze=Reflect.construct(et,arguments,Xe)}else ze=et.apply(this,arguments);return(0,p.default)(this,ze)}}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function N(Ue,Je,et){U(Ue,Je),Je.set(Ue,et)}function U(Ue,Je){if(Je.has(Ue))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H(Ue,Je){var et=typeof Symbol<"u"&&Ue[Symbol.iterator]||Ue["@@iterator"];if(!et){if(Array.isArray(Ue)||(et=q(Ue))||Je&&Ue&&typeof Ue.length=="number"){et&&(Ue=et);var ze=0,Xe=function(){};return{s:Xe,n:function(){return ze>=Ue.length?{done:!0}:{done:!1,value:Ue[ze++]}},e:function(Ae){throw Ae},f:Xe}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var tt=!0,ye=!1,Ze;return{s:function(){et=et.call(Ue)},n:function(){var Ae=et.next();return tt=Ae.done,Ae},e:function(Ae){ye=!0,Ze=Ae},f:function(){try{!tt&&et.return!=null&&et.return()}finally{if(ye)throw Ze}}}}function q(Ue,Je){if(!!Ue){if(typeof Ue=="string")return te(Ue,Je);var et=Object.prototype.toString.call(Ue).slice(8,-1);if(et==="Object"&&Ue.constructor&&(et=Ue.constructor.name),et==="Map"||et==="Set")return Array.from(Ue);if(et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(et))return te(Ue,Je)}}function te(Ue,Je){(Je==null||Je>Ue.length)&&(Je=Ue.length);for(var et=0,ze=new Array(Je);et<Je;et++)ze[et]=Ue[et];return ze}var Q=`#include <itowns/WebGL2_pars_vertex>
#include <itowns/precision_qualifier>
#include <common>
#include <itowns/project_pars_vertex>
#include <itowns/elevation_pars_vertex>
#include <logdepthbuf_pars_vertex>
attribute vec2      uv_0;
#if NUM_CRS > 1
attribute float     uv_1;
#endif
attribute vec3      normal;

uniform mat4 modelMatrix;
uniform bool lightingEnabled;
varying vec2 vHighPrecisionZW;

#if MODE == MODE_FINAL
#include <fog_pars_vertex>
varying vec3        vUv;
varying vec3        vNormal;
#endif
void main() {
        vec2 uv = vec2(uv_0.x, 1.0 - uv_0.y);

        #include <begin_vertex>
        #include <itowns/elevation_vertex>
        #include <itowns/geoid_vertex>
        #include <project_vertex>
        #include <logdepthbuf_vertex>
        vHighPrecisionZW = gl_Position.zw;
#if MODE == MODE_FINAL
        #include <fog_vertex>
        #if NUM_CRS > 1
        vUv = vec3(uv_0, (uv_1 > 0.) ? uv_1 : uv_0.y); // set uv_1 = uv_0 if uv_1 is undefined
        #else
        vUv = vec3(uv_0, 0.0);
        #endif
        vNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );
#endif
}
`,Z=`#include <itowns/WebGL2_pars_fragment>
#include <itowns/precision_qualifier>
#include <logdepthbuf_pars_fragment>
#include <itowns/pitUV>
#include <itowns/color_layers_pars_fragment>
#if MODE == MODE_FINAL
#include <itowns/fog_pars_fragment>
#include <itowns/overlay_pars_fragment>
#include <itowns/lighting_pars_fragment>
#endif
#include <itowns/mode_pars_fragment>

uniform vec3        diffuse;
uniform float       opacity;
varying vec3        vUv; // uv_0.x/uv_1.x, uv_0.y, uv_1.y
varying vec2        vHighPrecisionZW;

void main() {
    #include <logdepthbuf_fragment>

#if MODE == MODE_ID

    #include <itowns/mode_id_fragment>

#elif MODE == MODE_DEPTH

    #include <itowns/mode_depth_fragment>

#else

    gl_FragColor = vec4(diffuse, opacity);

    uvs[0] = vec3(vUv.xy, 0.);

#if NUM_CRS > 1
    uvs[1] = vec3(vUv.x, fract(vUv.z), floor(vUv.z));
#endif

    vec4 color;
    #pragma unroll_loop
    for ( int i = 0; i < NUM_FS_TEXTURES; i ++ ) {
        color = getLayerColor( i , colorTextures[ i ], colorOffsetScales[ i ], colorLayers[ i ]);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, color.rgb, color.a);
    }

  #if defined(DEBUG)
    if (showOutline) {
        #pragma unroll_loop
        for ( int i = 0; i < NUM_CRS; i ++) {
            color = getOutlineColor( outlineColors[ i ], uvs[ i ].xy);
            gl_FragColor.rgb = mix(gl_FragColor.rgb, color.rgb, color.a);
        }
    }
  #endif

    #include <itowns/fog_fragment>
    #include <itowns/lighting_fragment>
    #include <itowns/overlay_fragment>

#endif
}
`,ae=new B.Vector4(0,0,1,1),F=new B.Texture,W=255/256,O=new B.Vector4(W/(256*256*256),W/(256*256),W/256,W);function X(Ue,Je){return Je?O.dot(Ue)*Je:O.dot(Ue)}var G=15,j=1;function K(){var Ue=P.default.getMaxTextureUnitsCount();return Math.min(Ue-j,G)}var ce={noEffect:0,removeLightColor:1,removeWhiteColor:2,customEffect:3};a.colorLayerEffects=ce;var se={bias:0,zmin:0,zmax:0,scale:0,mode:0,textureOffset:0,opacity:0,crs:0,effect_parameter:0,effect_type:ce.noEffect,transparent:!1};function ue(Ue,Je,et){var ze=Ue.layers.value,Xe=Ue.textures.value,tt=Ue.offsetScales.value,ye=Ue.textureCount,Ze=0,Ge=H(Je),Ae;try{for(Ge.s();!(Ae=Ge.n()).done;){var Se=Ae.value;Se.textureOffset=Ze;for(var Te=0,me=Se.textures.length;Te<me;++Te,++Ze)Ze<et&&(tt[Ze]=Se.offsetScales[Te],Xe[Ze]=Se.textures[Te],ze[Ze]=Se)}}catch(we){Ge.e(we)}finally{Ge.f()}Ze>et&&console.warn("LayeredMaterial: Not enough texture units (".concat(et," < ").concat(Ze,"), excess textures have been discarded.")),ye.value=Ze;for(var be=Ze;be<Xe.length;be++)Xe[be]=F,tt[be]=ae,ze[be]=se}var Y={RGBA:0,COLOR:1,DATA:2};a.ELEVATION_MODES=Y;var pe,Ee=[],Fe=new WeakMap,$e=function(Ue){(0,y.default)(et,Ue);var Je=x(et);function et(){var ze,Xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},tt=arguments.length>1?arguments[1]:void 0;return(0,R.default)(this,et),ze=Je.call(this,Xe),N((0,v.default)(ze),Fe,{writable:!0,value:!0}),pe=pe||[j,K()],ze.defines.NUM_VS_TEXTURES=pe[0],ze.defines.NUM_FS_TEXTURES=pe[1],ze.defines.USE_FOG=1,ze.defines.NUM_CRS=tt,E.default.setDefineMapping((0,v.default)(ze),"ELEVATION",Y),E.default.setDefineMapping((0,v.default)(ze),"MODE",L.default.MODES),E.default.setDefineProperty((0,v.default)(ze),"mode","MODE",L.default.MODES.FINAL),P.default.isLogDepthBufferSupported()&&(ze.defines.USE_LOGDEPTHBUF=1,ze.defines.USE_LOGDEPTHBUF_EXT=1),ze.vertexShader=Q,Ee[tt]=Ee[tt]||V.default.unrollLoops(Z,ze.defines),ze.fragmentShader=Ee[tt],E.default.setUniformProperty((0,v.default)(ze),"diffuse",new B.Color(.04,.23,.35)),E.default.setUniformProperty((0,v.default)(ze),"opacity",ze.opacity),E.default.setUniformProperty((0,v.default)(ze),"lightingEnabled",!1),E.default.setUniformProperty((0,v.default)(ze),"lightPosition",new B.Vector3(-.5,0,1)),E.default.setUniformProperty((0,v.default)(ze),"fogDistance",1e9),E.default.setUniformProperty((0,v.default)(ze),"fogColor",new B.Color(.76,.85,1)),E.default.setUniformProperty((0,v.default)(ze),"overlayAlpha",0),E.default.setUniformProperty((0,v.default)(ze),"overlayColor",new B.Color(1,.3,0)),E.default.setUniformProperty((0,v.default)(ze),"objectId",0),E.default.setUniformProperty((0,v.default)(ze),"geoidHeight",0),E.default.setUniformProperty((0,v.default)(ze),"minBorderDistance",-.01),ze.layers=[],ze.elevationLayerIds=[],ze.colorLayerIds=[],ze.uniforms.elevationLayers=new B.Uniform(new Array(pe[0]).fill(se)),ze.uniforms.elevationTextures=new B.Uniform(new Array(pe[0]).fill(F)),ze.uniforms.elevationOffsetScales=new B.Uniform(new Array(pe[0]).fill(ae)),ze.uniforms.elevationTextureCount=new B.Uniform(0),ze.uniforms.colorLayers=new B.Uniform(new Array(pe[1]).fill(se)),ze.uniforms.colorTextures=new B.Uniform(new Array(pe[1]).fill(F)),ze.uniforms.colorOffsetScales=new B.Uniform(new Array(pe[1]).fill(ae)),ze.uniforms.colorTextureCount=new B.Uniform(0),Object.defineProperty((0,v.default)(ze),"visible",{get:function(){return(0,D.default)(this,Fe)},set:function(Ze){(0,D.default)(this,Fe)!=Ze&&((0,C.default)(this,Fe,Ze),this.dispatchEvent({type:Ze?"shown":"hidden"}))}}),ze}return(0,M.default)(et,[{key:"onBeforeCompile",value:function(Xe,tt){tt.capabilities.isWebGL2&&(this.defines.WEBGL2=!0,Xe.glslVersion="300 es")}},{key:"getUniformByType",value:function(Xe){return{layers:this.uniforms["".concat(Xe,"Layers")],textures:this.uniforms["".concat(Xe,"Textures")],offsetScales:this.uniforms["".concat(Xe,"OffsetScales")],textureCount:this.uniforms["".concat(Xe,"TextureCount")]}}},{key:"updateLayersUniforms",value:function(){var Xe=this,tt=this.layers.filter(function(Ze){return Xe.colorLayerIds.includes(Ze.id)&&Ze.visible&&Ze.opacity>0});if(tt.sort(function(Ze,Ge){return Xe.colorLayerIds.indexOf(Ze.id)-Xe.colorLayerIds.indexOf(Ge.id)}),ue(this.getUniformByType("color"),tt,this.defines.NUM_FS_TEXTURES),this.elevationLayerIds.some(function(Ze){return Xe.getLayer(Ze)})||this.uniforms.elevationTextureCount.value&&!this.elevationLayerIds.length){var ye=this.getElevationLayer()?[this.getElevationLayer()]:[];ue(this.getUniformByType("elevation"),ye,this.defines.NUM_VS_TEXTURES)}this.layersNeedUpdate=!1}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"}),this.layers.forEach(function(Xe){return Xe.dispose(!0)}),this.layers.length=0,this.layersNeedUpdate=!0}},{key:"setSequence",value:function(Xe){this.colorLayerIds=Xe,this.layersNeedUpdate=!0}},{key:"setSequenceElevation",value:function(Xe){this.elevationLayerIds[0]=Xe,this.layersNeedUpdate=!0}},{key:"removeLayer",value:function(Xe){var tt=this.layers.findIndex(function(Ze){return Ze.id===Xe});if(tt>-1){this.layers[tt].dispose(),this.layers.splice(tt,1);var ye=this.colorLayerIds.indexOf(Xe);ye>-1?this.colorLayerIds.splice(ye,1):this.elevationLayerIds=[]}}},{key:"addLayer",value:function(Xe){Xe.layer.id in this.layers&&console.warn('The "{layer.id}" layer was already present in the material, overwritting.'),this.layers.push(Xe)}},{key:"getLayer",value:function(Xe){return this.layers.find(function(tt){return tt.id===Xe})}},{key:"getLayers",value:function(Xe){return this.layers.filter(function(tt){return Xe.includes(tt.id)})}},{key:"getElevationLayer",value:function(){var Xe=this;return this.layers.find(function(tt){return tt.id===Xe.elevationLayerIds[0]})}},{key:"setElevationScale",value:function(Xe){this.elevationLayerIds.length&&(this.getElevationLayer().scale=Xe)}}]),et}(B.RawShaderMaterial),pt=$e;a.default=pt}(cA)),cA}var x0={},DE;function DF(){if(DE)return x0;DE=1;var a=hr.exports;Object.defineProperty(x0,"__esModule",{value:!0}),x0.checkNodeElevationTextureValidity=v,x0.computeMinMaxElevation=M,x0.insertSignificantValuesFromParent=p;var u=a(Qh()),h=F0();function R(g,C,D){var B=C.x,V=C.y,P=C.z,L=[(0,h.readTextureValueWithBilinearFiltering)({noDataValue:D},g,B,V),(0,h.readTextureValueWithBilinearFiltering)({noDataValue:D},g,B+P,V),(0,h.readTextureValueWithBilinearFiltering)({noDataValue:D},g,B+P,V+P),(0,h.readTextureValueWithBilinearFiltering)({noDataValue:D},g,B,V+P)].filter(function(E){return E!=null&&E>-10});if(L.length)return{min:Math.min.apply(Math,(0,u.default)(L)),max:Math.max.apply(Math,(0,u.default)(L))}}function M(g,C,D){var B=g.image,V=B.width,P=B.height,L=B.data;if(!L)return{min:null,max:null};var E=R(g,C,D)||{max:-1/0,min:1/0},b=E.min,_=E.max,x=Math.floor(C.z*V);if(x>2)for(var T=Math.floor(C.z*P),N=Math.floor(C.x*V),U=Math.floor(C.y*P),H=Math.max(Math.floor(x/32),2),q=U;q<U+T;q+=H){var te=q*(V||0),Q=te+N,Z=Q+x;for(Q;Q<Z;Q+=H){var ae=L[Q];ae>-10&&ae!=D&&(_=Math.max(_,ae),b=Math.min(b,ae))}}return _===-1/0||b===1/0?{min:null,max:null}:{min:b,max:_}}function v(g,C){var D=g.length;return g[0]>C&&g[D-1]>C&&g[Math.sqrt(D)-1]>C&&g[D-Math.sqrt(D)]>C}function y(g,C,D){var B=Math.floor(g/D)/D,V=C.x+g%D/D*C.z,P=C.y+B*C.w,L=Math.floor(P*D)*D+Math.floor(V*D);return L}function p(g,C,D,B){for(var V=0,P=g.length;V<P;++V)g[V]===D&&(g[V]=C[y(V,B,256)])}return x0}var NE;function HM(){return NE||(NE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.RasterElevationTile=a.RasterColorTile=a.EMPTY_TEXTURE_ZOOM=void 0;var R=u(Cs()),M=u(Ir()),v=u(kr()),y=u(dn()),p=u(pn()),g=u(ln()),C=L(Dr()),D=rd(),B=DF(),V=u(ps());function P(Z){if(typeof WeakMap!="function")return null;var ae=new WeakMap,F=new WeakMap;return(P=function(O){return O?F:ae})(Z)}function L(Z,ae){if(!ae&&Z&&Z.__esModule)return Z;if(Z===null||h(Z)!=="object"&&typeof Z!="function")return{default:Z};var F=P(ae);if(F&&F.has(Z))return F.get(Z);var W={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in Z)if(X!=="default"&&Object.prototype.hasOwnProperty.call(Z,X)){var G=O?Object.getOwnPropertyDescriptor(Z,X):null;G&&(G.get||G.set)?Object.defineProperty(W,X,G):W[X]=Z[X]}return W.default=Z,F&&F.set(Z,W),W}function E(Z,ae){var F=typeof Symbol<"u"&&Z[Symbol.iterator]||Z["@@iterator"];if(!F){if(Array.isArray(Z)||(F=b(Z))||ae&&Z&&typeof Z.length=="number"){F&&(Z=F);var W=0,O=function(){};return{s:O,n:function(){return W>=Z.length?{done:!0}:{done:!1,value:Z[W++]}},e:function(ce){throw ce},f:O}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var X=!0,G=!1,j;return{s:function(){F=F.call(Z)},n:function(){var ce=F.next();return X=ce.done,ce},e:function(ce){G=!0,j=ce},f:function(){try{!X&&F.return!=null&&F.return()}finally{if(G)throw j}}}}function b(Z,ae){if(!!Z){if(typeof Z=="string")return _(Z,ae);var F=Object.prototype.toString.call(Z).slice(8,-1);if(F==="Object"&&Z.constructor&&(F=Z.constructor.name),F==="Map"||F==="Set")return Array.from(Z);if(F==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F))return _(Z,ae)}}function _(Z,ae){(ae==null||ae>Z.length)&&(ae=Z.length);for(var F=0,W=new Array(ae);F<ae;F++)W[F]=Z[F];return W}function x(Z){var ae=T();return function(){var F=(0,g.default)(Z),W;if(ae){var O=(0,g.default)(this).constructor;W=Reflect.construct(F,arguments,O)}else W=F.apply(this,arguments);return(0,p.default)(this,W)}}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var N=-1;a.EMPTY_TEXTURE_ZOOM=N;var U=new C.Vector4,H=function(Z){(0,y.default)(F,Z);var ae=x(F);function F(W,O){var X;return(0,M.default)(this,F),X=ae.call(this),X.layer=O,X.crs=O.parent.tileMatrixSets.indexOf(V.default.formatToTms(O.crs)),X.crs==-1&&console.error("Unknown crs:",O.crs),X.textures=[],X.offsetScales=[],X.level=N,X.material=W,X._handlerCBEvent=function(){X.material.layersNeedUpdate=!0},O.addEventListener("visible-property-changed",X._handlerCBEvent),X}return(0,v.default)(F,[{key:"id",get:function(){return this.layer.id}},{key:"opacity",get:function(){return this.layer.opacity}},{key:"visible",get:function(){return this.layer.visible}},{key:"initFromParent",value:function(O,X){if(O&&O.level>this.level){var G=0,j=E(X),K;try{for(j.s();!(K=j.n()).done;){var ce=K.value,se=E(O.textures),ue;try{for(se.s();!(ue=se.n()).done;){var Y=ue.value;if(ce.isInside(Y.extent)){this.setTexture(G++,Y,ce.offsetToParent(Y.extent));break}}}catch(pe){se.e(pe)}finally{se.f()}}}catch(pe){j.e(pe)}finally{j.f()}}}},{key:"dispose",value:function(O){O&&(this.layer.removeEventListener("visible-property-changed",this._handlerCBEvent),this._listeners={});var X=E(this.textures),G;try{for(X.s();!(G=X.n()).done;){var j=G.value;j.isTexture&&j.dispose()}}catch(K){X.e(K)}finally{X.f()}this.level=N,this.textures=[],this.offsetScales=[],this.material.layersNeedUpdate=!0}},{key:"setTexture",value:function(O,X,G){this.level=X&&O==0?X.extent.zoom:this.level,this.textures[O]=X||null,this.offsetScales[O]=G,this.material.layersNeedUpdate=!0}},{key:"setTextures",value:function(O,X){this.dispose(!1);for(var G=0,j=O.length;G<j;++G)this.setTexture(G,O[G],X[G])}}]),F}(C.EventDispatcher),q=H;a.default=q;var te=function(Z){(0,y.default)(F,Z);var ae=x(F);function F(){return(0,M.default)(this,F),ae.apply(this,arguments)}return(0,v.default)(F,[{key:"effect_type",get:function(){return this.layer.effect_type}},{key:"effect_parameter",get:function(){return this.layer.effect_parameter}},{key:"transparent",get:function(){return this.layer.transparent}}]),F}(H);a.RasterColorTile=te;var Q=function(Z){(0,y.default)(F,Z);var ae=x(F);function F(W,O){var X;(0,M.default)(this,F),X=ae.call(this,W,O);var G={bias:0,mode:D.ELEVATION_MODES.DATA,zmin:0,zmax:1/0};if(X.scaleFactor=1,O.useRgbaTextureElevation)throw G.mode=D.ELEVATION_MODES.RGBA,G.zmax=5e3,new Error("Restore this feature");return O.useColorTextureElevation?(X.scaleFactor=O.colorTextureElevationMaxZ-O.colorTextureElevationMinZ,G.mode=D.ELEVATION_MODES.COLOR,G.bias=O.colorTextureElevationMinZ,X.min=X.layer.colorTextureElevationMinZ,X.max=X.layer.colorTextureElevationMaxZ):(X.min=0,X.max=0),X.bias=O.bias||G.bias,X.mode=O.mode||G.mode,X.zmin=O.zmin||G.zmin,X.zmax=O.zmax||G.zmax,O.addEventListener("scale-property-changed",X._handlerCBEvent),X}return(0,v.default)(F,[{key:"scale",get:function(){return this.layer.scale*this.scaleFactor}},{key:"dispose",value:function(O){(0,R.default)((0,g.default)(F.prototype),"dispose",this).call(this,O),O&&this.layer.removeEventListener("scale-property-changed",this._handlerCBEvent)}},{key:"initFromParent",value:function(O,X){(0,R.default)((0,g.default)(F.prototype),"initFromParent",this).call(this,O,X),this.updateMinMaxElevation()}},{key:"setTextures",value:function(O,X){this.replaceNoDataValueFromTexture(O[0]),(0,R.default)((0,g.default)(F.prototype),"setTextures",this).call(this,O,X),this.updateMinMaxElevation()}},{key:"updateMinMaxElevation",value:function(){if(this.textures[0]&&!this.layer.useColorTextureElevation){var O=(0,B.computeMinMaxElevation)(this.textures[0],this.offsetScales[0],this.layer.noDataValue),X=O.min,G=O.max;(this.min!=X||this.max!=G)&&(this.min=X,this.max=G,this.dispatchEvent({type:"updatedElevation",node:this}))}}},{key:"replaceNoDataValueFromTexture",value:function(O){var X=this.layer.noDataValue;if(X!=null){var G=this.textures[0],j=G&&G.image&&G.image.data,K=O.image&&O.image.data;K&&j&&!(0,B.checkNodeElevationTextureValidity)(K,X)&&(O.extent.offsetToParent(G.extent,U),(0,B.insertSignificantValuesFromParent)(K,j,X,U))}}}]),F}(H);a.RasterElevationTile=Q}(lA)),lA}var BE;function qM(){if(BE)return au;BE=1,Object.defineProperty(au,"__esModule",{value:!0}),au.STRATEGY_PROGRESSIVE=au.STRATEGY_MIN_NETWORK_TRAFFIC=au.STRATEGY_GROUP=au.STRATEGY_DICHOTOMY=void 0,au.chooseNextLevelToFetch=C;var a=HM(),u=0;au.STRATEGY_MIN_NETWORK_TRAFFIC=u;var h=1;au.STRATEGY_GROUP=h;var R=2;au.STRATEGY_PROGRESSIVE=R;var M=3;au.STRATEGY_DICHOTOMY=M;function v(D,B,V){return D.pendingSubdivision?V:B}function y(D,B){var V=B.groups.filter(function(P){return P<=D});return V.length?V[V.length-1]:B.groups[0]}function p(D,B,V){return Math.min(D,B+(V.increment||1))}function g(D,B){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return B==a.EMPTY_TEXTURE_ZOOM?V.zoom?V.zoom.min:0:Math.min(D,Math.ceil((B+D)/2))}function C(D,B){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:B.level,P=arguments.length>3?arguments[3]:void 0,L=arguments.length>4?arguments[4]:void 0,E=arguments.length>5?arguments[5]:void 0,b,_=L.source.zoom?L.source.zoom.max:1/0;if(E.lowestLevelError!=1/0)b=g(E.lowestLevelError,P,L.source),b=E.lowestLevelError==b?b-1:b,D==h&&(b=y(b,L.updateStrategy.options));else{switch(D){case h:b=y(V,L.updateStrategy.options);break;case R:{b=p(V,P,L.updateStrategy.options);break}case M:b=g(V,P,L.source);break;case u:default:b=v(B,V,P)}b=Math.min(b,_)}return b}return au}var pA={},UE;function YR(){return UE||(UE=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.InfoTiledGeometryLayer=void 0;var h=u(Qh()),R=u(dn()),M=u(pn()),v=u(ln()),y=u(Ir()),p=u(kr()),g=u(ya());function C(P){var L=D();return function(){var E=(0,v.default)(P),b;if(L){var _=(0,v.default)(this).constructor;b=Reflect.construct(E,arguments,_)}else b=E.apply(this,arguments);return(0,M.default)(this,b)}}function D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var B=function(){function P(L){(0,y.default)(this,P),this.layer=L}return(0,p.default)(P,[{key:"clear",value:function(){}},{key:"update",value:function(){}}]),P}();a.default=B;var V=function(P){(0,R.default)(E,P);var L=C(E);function E(b){var _;return(0,y.default)(this,E),_=L.call(this,b),_.displayed={tiles:new Set},Object.defineProperty(_.displayed,"layers",{get:function(){var T=[];return _.displayed.tiles.forEach(function(N){var U=N.material;T=(0,h.default)(new Set([].concat((0,h.default)(T),(0,h.default)(U.colorLayerIds.filter(function(H){return U.getLayer(H)})),(0,h.default)(U.elevationLayerIds))))}),_.layer.attachedLayers.filter(function(N){return T.includes(N.id)})}}),Object.defineProperty(_.displayed,"extent",{get:function(){var T=new g.default(_.layer.extent.crs,1/0,-1/0,1/0,-1/0);return T.min=1/0,T.max=-1/0,_.displayed.tiles.forEach(function(N){T.union(N.extent),T.min=Math.min(N.obb.z.min,T.min),T.max=Math.max(N.obb.z.max,T.max)}),T}}),_}return(0,p.default)(E,[{key:"clear",value:function(){this.displayed.tiles.clear()}},{key:"update",value:function(_){_.material.visible?this.displayed.tiles.add(_):this.displayed.tiles.delete(_)}}]),E}(B);a.InfoTiledGeometryLayer=V}(pA)),pA}var mA={},vA={},gA={},yA={},_A={},zE;function Bf(){return zE||(zE=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.CACHE_POLICIES=void 0;var h=u(Ir()),R=u(kr()),M,v={INFINITE:1/0,TEXTURE:9e5,GEOMETRY:9e5};a.CACHE_POLICIES=v;var y=function(){function g(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v.INFINITE;(0,h.default)(this,g),this.lifeTime=C,this.lastTimeFlush=Date.now(),this.data=new Map}return(0,R.default)(g,[{key:"getByArray",value:function(D){return this.get(D[0],D[1],D[2])}},{key:"setByArray",value:function(D,B){return this.set(D,B[0],B[1],B[2])}},{key:"get",value:function(D,B,V){var P=this.data.get(D);if(P!=null){if(P.lastTimeUsed!=null)M=P;else{var L=P.get(B);if(L==null)return;if(L.lastTimeUsed!=null)M=L;else{var E=L.get(V);if(E==null)return;M=E}}if(M.value)return M.lastTimeUsed=Date.now(),M.value}}},{key:"set",value:function(D,B,V,P){if(M={value:D,lastTimeUsed:Date.now()},V==null)return this.data.set(B,M),D;this.data.get(B)||this.data.set(B,new Map);var L=this.data.get(B);return P==null?(L.set(V,M),D):(L.get(V)||L.set(V,new Map),L.get(V).set(P,M),D)}},{key:"delete",value:function(D,B,V){var P=this.data.get(D);if(P!==void 0)if(P.lastTimeUsed!=null)delete this.data.get(D),this.data.delete(D);else{var L=P.get(B);if(L===void 0)return;if(L.lastTimeUsed!=null)delete P.get(B),P.delete(B),P.size==0&&this.data.delete(D);else{var E=L.get(V);if(E===void 0)return;delete L.get(V),L.delete(V),L.size==0&&(P.delete(B),P.size==0&&this.data.delete(D))}}}},{key:"clear",value:function(){this.data.clear()}},{key:"flush",value:function(){var D=this,B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Date.now();this.lifeTime==v.INFINITE||this.lifeTime>B-this.lastTimeFlush||!this.data.size||(this.lastTimeFlush=1/0,this.data.forEach(function(V,P){D.lifeTime<B-V.lastTimeUsed?(delete D.data.get(P),D.data.delete(P)):(V.forEach(function(L,E){D.lifeTime<B-L.lastTimeUsed?(delete V.get(E),V.delete(E)):(L.forEach(function(b,_){D.lifeTime<B-b.lastTimeUsed?(delete L.get(_),L.delete(_)):D.lastTimeFlush=Math.min(D.lastTimeFlush,b.lastTimeUsed)}),L.size||(delete V.get(E),V.delete(E)))}),V.size||(delete D.data.get(P),D.data.delete(P)))}),this.data.size==0&&(this.lastTimeFlush=Date.now()))}}]),g}(),p=y;a.default=p}(_A)),_A}var xA={},GE;function dl(){return GE||(GE=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=Dr();function h(B,V){var P=typeof Symbol<"u"&&B[Symbol.iterator]||B["@@iterator"];if(!P){if(Array.isArray(B)||(P=R(B))||V&&B&&typeof B.length=="number"){P&&(B=P);var L=0,E=function(){};return{s:E,n:function(){return L>=B.length?{done:!0}:{done:!1,value:B[L++]}},e:function(N){throw N},f:E}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var b=!0,_=!1,x;return{s:function(){P=P.call(B)},n:function(){var N=P.next();return b=N.done,N},e:function(N){_=!0,x=N},f:function(){try{!b&&P.return!=null&&P.return()}finally{if(_)throw x}}}}function R(B,V){if(!!B){if(typeof B=="string")return M(B,V);var P=Object.prototype.toString.call(B).slice(8,-1);if(P==="Object"&&B.constructor&&(P=B.constructor.name),P==="Map"||P==="Set")return Array.from(B);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return M(B,V)}}function M(B,V){(V==null||V>B.length)&&(V=B.length);for(var P=0,L=new Array(V);P<V;P++)L[P]=B[P];return L}var v=new u.TextureLoader,y=256;function p(B){if(!B.ok){var V=new Error("Error loading ".concat(B.url,": status ").concat(B.status));throw V.response=B,V}}var g=function(B){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fetch(B,V).then(function(P){return p(P),P.arrayBuffer()})};function C(B){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(V){var P=new u.DataTexture(B,y,y,u.RedFormat,u.FloatType);return P.internalFormat="R32F",P.needsUpdate=!0,P}else{var L=new u.DataTexture(B,y,y,u.AlphaFormat,u.FloatType);return L}}var D={text:function(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fetch(V,P).then(function(L){return p(L),L.text()})},json:function(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fetch(V,P).then(function(L){return p(L),L.json()})},xml:function(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fetch(V,P).then(function(L){return p(L),L.text()}).then(function(L){return new window.DOMParser().parseFromString(L,"text/xml")})},texture:function(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},L,E;v.crossOrigin=P.crossOrigin;var b=new Promise(function(_,x){L=_,E=x});return v.load(V,L,function(){},E),b},arrayBuffer:g,textureFloat:function(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return g(V,P).then(function(L){var E=new Float32Array(L),b=C(E,P.isWebGL2);return b})},multiple:function(V,P){var L=this,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=[],_;for(var x in P)if(this[x]){var T=h(P[x]),N;try{var U=function(){var q=N.value;_="".concat(V,".").concat(q),b.push(L[x](_,E).then(function(te){return{type:q,result:te}}))};for(T.s();!(N=T.n()).done;)U()}catch(H){T.e(H)}finally{T.f()}}else throw new Error("".concat(x," is not a valid Fetcher method."));return Promise.all(b).then(function(H){var q={},te=h(H),Q;try{for(te.s();!(Q=te.n()).done;){var Z=Q.value;q[Z.type]=Z.result}}catch(ae){te.e(ae)}finally{te.f()}return Promise.resolve(q)})}};a.default=D}(xA)),xA}var ky={exports:{}},VE;function $R(){return VE||(VE=1,function(a,u){(function(h,R){R(u)})(ua,function(h){var R=8,M={version:{required:!0,type:"enum",values:[8],doc:"Style specification version number. Must be 8.",example:8},name:{type:"string",doc:"A human-readable name for the style.",example:"Bright"},metadata:{type:"*",doc:"Arbitrary properties useful to track with the stylesheet, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},center:{type:"array",value:"number",doc:"Default map center in longitude and latitude.  The style center will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:[-73.9749,40.7736]},zoom:{type:"number",doc:"Default zoom level.  The style zoom will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:12.5},bearing:{type:"number",default:0,period:360,units:"degrees",doc:'Default bearing, in degrees. The bearing is the compass direction that is "up"; for example, a bearing of 90\xB0 orients the map so that east is up. This value will be used only if the map has not been positioned by other means (e.g. map options or user interaction).',example:29},pitch:{type:"number",default:0,units:"degrees",doc:"Default pitch, in degrees. Zero is perpendicular to the surface, for a look straight down at the map, while a greater value like 60 looks ahead towards the horizon. The style pitch will be used only if the map has not been positioned by other means (e.g. map options or user interaction).",example:50},light:{type:"light",doc:"The global light source.",example:{anchor:"viewport",color:"white",intensity:.4}},terrain:{type:"terrain",doc:"A global modifier that elevates layers and markers based on a DEM data source."},fog:{type:"fog",doc:"A global effect that fades layers and markers based on their distance to the camera. The fog can be used to approximate the effect of atmosphere on distant objects and enhance the depth perception of the map when used with terrain or 3D features. Note: fog is renamed to atmosphere in the Android and iOS SDKs and planned to be changed in GL-JS v.3.0.0."},sources:{required:!0,type:"sources",doc:"Data source specifications.",example:{"mapbox-streets":{type:"vector",url:"mapbox://mapbox.mapbox-streets-v6"}}},sprite:{type:"string",doc:"A base URL for retrieving the sprite image and metadata. The extensions `.png`, `.json` and scale factor `@2x.png` will be automatically appended. This property is required if any layer uses the `background-pattern`, `fill-pattern`, `line-pattern`, `fill-extrusion-pattern`, or `icon-image` properties. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://sprites/mapbox/bright-v8"},glyphs:{type:"string",doc:"A URL template for loading signed-distance-field glyph sets in PBF format. The URL must include `{fontstack}` and `{range}` tokens. This property is required if any layer uses the `text-field` layout property. The URL must be absolute, containing the [scheme, authority and path components](https://en.wikipedia.org/wiki/URL#Syntax).",example:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},transition:{type:"transition",doc:"A global transition definition to use as a default across properties, to be used for timing transitions between one value and the next when no property-specific transition is set. Collision-based symbol fading is controlled independently of the style's `transition` property.",example:{duration:300,delay:0}},projection:{type:"projection",doc:"The projection the map should be rendered in. Supported projections are Mercator, Globe, Albers, Equal Earth, Equirectangular (WGS84), Lambert conformal conic, Natural Earth, and Winkel Tripel. Terrain, sky and fog are supported by only Mercator and globe. CustomLayerInterface is not supported outside of Mercator.",example:{name:"albers",center:[-154,50],parallels:[55,65]}},layers:{required:!0,type:"array",value:"layer",doc:"Layers will be drawn in the order of this array.",example:[{id:"water",source:"mapbox-streets","source-layer":"water",type:"fill",paint:{"fill-color":"#00ffff"}}]}},v={"*":{type:"source",doc:"Specification of a data source. For vector and raster sources, either TileJSON or a URL to a TileJSON must be provided. For image and video sources, a URL must be provided. For GeoJSON sources, a URL or inline GeoJSON must be provided."}},y=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],p={type:{required:!0,type:"enum",values:{vector:{doc:"A vector tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`. If specified as a string for a vector tile source, the same property is used across all its source layers."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},g={type:{required:!0,type:"enum",values:{raster:{doc:"A raster tile source."}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},scheme:{type:"enum",values:{xyz:{doc:"Slippy map tilenames scheme."},tms:{doc:"OSGeo spec scheme."}},default:"xyz",doc:"Influences the y direction of the tile coordinates. The global-mercator (aka Spherical Mercator) profile is assumed."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},C={type:{required:!0,type:"enum",values:{"raster-dem":{doc:"A RGB-encoded raster DEM source"}},doc:"The type of the source."},url:{type:"string",doc:"A URL to a TileJSON resource. Supported protocols are `http:`, `https:`, and `mapbox://<Tileset ID>`."},tiles:{type:"array",value:"string",doc:"An array of one or more tile source URLs, as in the TileJSON spec."},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129],doc:"An array containing the longitude and latitude of the southwest and northeast corners of the source's bounding box in the following order: `[sw.lng, sw.lat, ne.lng, ne.lat]`. When this property is included in a source, no tiles outside of the given bounds are requested by Mapbox GL."},minzoom:{type:"number",default:0,doc:"Minimum zoom level for which tiles are available, as in the TileJSON spec."},maxzoom:{type:"number",default:22,doc:"Maximum zoom level for which tiles are available, as in the TileJSON spec. Data from tiles at the maxzoom are used when displaying the map at higher zoom levels."},tileSize:{type:"number",default:512,units:"pixels",doc:"The minimum visual size to display tiles for this layer. Only configurable for raster layers."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},encoding:{type:"enum",values:{terrarium:{doc:"Terrarium format PNG tiles. See https://aws.amazon.com/es/public-datasets/terrain/ for more info."},mapbox:{doc:"Mapbox Terrain RGB tiles. See https://www.mapbox.com/help/access-elevation-data/#mapbox-terrain-rgb for more info."}},default:"mapbox",doc:"The encoding used by this source. Mapbox Terrain RGB is used by default"},volatile:{type:"boolean",default:!1,doc:"A setting to determine whether a source's tiles are cached locally.","sdk-support":{"basic functionality":{android:"9.3.0",ios:"5.10.0"}}},"*":{type:"*",doc:"Other keys to configure the data source."}},D={type:{required:!0,type:"enum",values:{geojson:{doc:"A GeoJSON data source."}},doc:"The data type of the GeoJSON source."},data:{type:"*",doc:"A URL to a GeoJSON file, or inline GeoJSON."},maxzoom:{type:"number",default:18,doc:"Maximum zoom level at which to create vector tiles (higher means greater detail at high zoom levels)."},attribution:{type:"string",doc:"Contains an attribution to be displayed when the map is shown to a user."},buffer:{type:"number",default:128,maximum:512,minimum:0,doc:"Size of the tile buffer on each side. A value of 0 produces no buffer. A value of 512 produces a buffer as wide as the tile itself. Larger values produce fewer rendering artifacts near tile edges and slower performance."},filter:{type:"*",doc:"An expression for filtering features prior to processing them for rendering."},tolerance:{type:"number",default:.375,doc:"Douglas-Peucker simplification tolerance (higher means simpler geometries and faster performance)."},cluster:{type:"boolean",default:!1,doc:"If the data is a collection of point features, setting this to true clusters the points by radius into groups. Cluster groups become new `Point` features in the source with additional properties:\n * `cluster` Is `true` if the point is a cluster \n * `cluster_id` A unqiue id for the cluster to be used in conjunction with the [cluster inspection methods](https://www.mapbox.com/mapbox-gl-js/api/#geojsonsource#getclusterexpansionzoom)\n * `point_count` Number of original points grouped into this cluster\n * `point_count_abbreviated` An abbreviated point count"},clusterRadius:{type:"number",default:50,minimum:0,doc:"Radius of each cluster if clustering is enabled. A value of 512 indicates a radius equal to the width of a tile."},clusterMaxZoom:{type:"number",doc:"Max zoom on which to cluster points if clustering is enabled. Defaults to one zoom less than maxzoom (so that last zoom features are not clustered). Clusters are re-evaluated at integer zoom levels so setting clusterMaxZoom to 14 means the clusters will be displayed until z15."},clusterMinPoints:{type:"number",doc:"Minimum number of points necessary to form a cluster if clustering is enabled. Defaults to `2`."},clusterProperties:{type:"*",doc:'An object defining custom properties on the generated clusters if clustering is enabled, aggregating values from clustered points. Has the form `{"property_name": [operator, map_expression]}`. `operator` is any expression function that accepts at least 2 operands (e.g. `"+"` or `"max"`) \u2014 it accumulates the property value from clusters/points the cluster contains; `map_expression` produces the value of a single point.\n\nExample: `{"sum": ["+", ["get", "scalerank"]]}`.\n\nFor more advanced use cases, in place of `operator`, you can use a custom reduce expression that references a special `["accumulated"]` value, e.g.:\n`{"sum": [["+", ["accumulated"], ["get", "sum"]], ["get", "scalerank"]]}`'},lineMetrics:{type:"boolean",default:!1,doc:"Whether to calculate line distance metrics. This is required for line layers that specify `line-gradient` values."},generateId:{type:"boolean",default:!1,doc:"Whether to generate ids for the geojson features. When enabled, the `feature.id` property will be auto assigned based on its index in the `features` array, over-writing any previous values."},promoteId:{type:"promoteId",doc:"A property to use as a feature id (for feature state). Either a property name, or an object of the form `{<sourceLayer>: <propertyName>}`."}},B={type:{required:!0,type:"enum",values:{video:{doc:"A video data source."}},doc:"The data type of the video source."},urls:{required:!0,type:"array",value:"string",doc:"URLs to video content in order of preferred format."},coordinates:{required:!0,doc:"Corners of video specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},V={type:{required:!0,type:"enum",values:{image:{doc:"An image data source."}},doc:"The data type of the image source."},url:{required:!0,type:"string",doc:"URL that points to an image."},coordinates:{required:!0,doc:"Corners of image specified in longitude, latitude pairs.",type:"array",length:4,value:{type:"array",length:2,value:"number",doc:"A single longitude, latitude pair."}}},P={id:{type:"string",doc:"Unique layer name.",required:!0},type:{type:"enum",values:{fill:{doc:"A filled polygon with an optional stroked border.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},line:{doc:"A stroked line.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},symbol:{doc:"An icon or a text label.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},circle:{doc:"A filled circle.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},heatmap:{doc:"A heatmap.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"fill-extrusion":{doc:"An extruded (3D) polygon.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},raster:{doc:"Raster map textures such as satellite imagery.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},hillshade:{doc:"Client-side hillshading visualization based on DEM data. Currently, the implementation only supports Mapbox Terrain RGB and Mapzen Terrarium tiles.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},background:{doc:"The background color or pattern of the map.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}}},sky:{doc:"A spherical dome around the map that is always rendered behind all other layers.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},doc:"Rendering type of this layer.",required:!0},metadata:{type:"*",doc:"Arbitrary properties useful to track with the layer, but do not influence rendering. Properties should be prefixed to avoid collisions, like 'mapbox:'."},source:{type:"string",doc:"Name of a source description to be used for this layer. Required for all layer types except `background`."},"source-layer":{type:"string",doc:"Layer to use from a vector tile source. Required for vector tile sources; prohibited for all other source types, including GeoJSON sources."},minzoom:{type:"number",minimum:0,maximum:24,doc:"The minimum zoom level for the layer. At zoom levels less than the minzoom, the layer will be hidden."},maxzoom:{type:"number",minimum:0,maximum:24,doc:"The maximum zoom level for the layer. At zoom levels equal to or greater than the maxzoom, the layer will be hidden."},filter:{type:"filter",doc:'An expression specifying conditions on source features. Only features that match the filter are displayed. Zoom expressions in filters are only evaluated at integer zoom levels. The `["feature-state", ...]` expression is not supported in filter expressions.  The `["pitch"]` and `["distance-from-center"]` expressions are supported only for filter expressions on the symbol layer.'},layout:{type:"layout",doc:"Layout properties for the layer."},paint:{type:"paint",doc:"Default paint properties for this layer."}},L=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],E={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},b={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"constant"}},_={"fill-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},x={"circle-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"},"data-driven styling":{js:"1.2.0",android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},T={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},N={"line-cap":{type:"enum",values:{butt:{doc:"A cap with a squared-off end which is drawn to the exact endpoint of the line."},round:{doc:"A cap with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},square:{doc:"A cap with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."}},default:"butt",doc:"The display of line endings.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{doc:"A join with a squared-off end which is drawn beyond the endpoint of the line at a distance of one-half of the line's width."},round:{doc:"A join with a rounded end which is drawn beyond the endpoint of the line at a radius of one-half of the line's width and centered on the endpoint of the line."},miter:{doc:"A join with a sharp, angled corner which is drawn with the outer sides beyond the endpoint of the path until they meet."}},default:"miter",doc:"The display of lines when joining.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,doc:"Used to automatically convert miter joins to bevel joins for sharp angles.",requires:[{"line-join":"miter"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,doc:"Used to automatically convert round joins to miter joins for shallow angles.",requires:[{"line-join":"round"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with a higher sort key will appear above features with a lower sort key.","sdk-support":{"basic functionality":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"},"data-driven styling":{js:"1.2.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},U={"symbol-placement":{type:"enum",values:{point:{doc:"The label is placed at the point where the geometry is located."},line:{doc:"The label is placed along the line of the geometry. Can only be used on `LineString` and `Polygon` geometries."},"line-center":{doc:"The label is placed at the center of the line of the geometry. Can only be used on `LineString` and `Polygon` geometries. Note that a single feature in a vector tile may contain multiple line geometries."}},default:"point",doc:"Label placement relative to its geometry.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`line-center` value":{js:"0.47.0",android:"6.4.0",ios:"4.3.0",macos:"0.10.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",doc:"Distance between two symbol anchors.",requires:[{"symbol-placement":"line"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,doc:"If true, the symbols will not cross tile edges to avoid mutual collisions. Recommended in layers that don't have enough padding in the vector tile to prevent collisions, or if it is a point symbol layer placed after a line symbol layer. When using a client that supports global collision detection, like Mapbox GL JS version 0.42.0 or greater, enabling this property is not needed to prevent clipped labels at tile boundaries.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",doc:"Sorts features in ascending order based on this value. Features with lower sort keys are drawn and placed first.  When `icon-allow-overlap` or `text-allow-overlap` is `false`, features with a lower sort key will have priority during placement. When `icon-allow-overlap` or `text-allow-overlap` is set to `true`, features with a higher sort key will overlap over features with a lower sort key.","sdk-support":{"basic functionality":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"},"data-driven styling":{js:"0.53.0",android:"7.4.0",ios:"4.11.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},"viewport-y":{doc:"Sorts symbols by their y-position relative to the viewport if `icon-allow-overlap` or `text-allow-overlap` is set to `true` or `icon-ignore-placement` or `text-ignore-placement` is `false`."},source:{doc:"Sorts symbols by `symbol-sort-key` if set. Otherwise, no sorting is applied; symbols are rendered in the same order as the source data."}},default:"auto",doc:"Determines whether overlapping symbols in the same layer are rendered in the order that they appear in the data source or by their y-position relative to the viewport. To control the order and prioritization of symbols otherwise, use `symbol-sort-key`.","sdk-support":{"basic functionality":{js:"0.49.0",android:"6.6.0",ios:"4.5.0",macos:"0.12.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,doc:"If true, the icon will be visible even if it collides with other previously drawn symbols.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the icon.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,doc:"If true, text will display without their corresponding icons when the icon collides with other symbols and the text does not.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns icons east-west. When `symbol-placement` is set to `line` or `line-center`, aligns icon x-axes with the line."},viewport:{doc:"Produces icons whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of icons.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",doc:"Scales the original size of the icon by the provided factor. The new pixel size of the image will be the original pixel size multiplied by `icon-size`. 1 is the original size; 3 triples the size of the image.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{doc:"The icon is displayed at its intrinsic aspect ratio."},width:{doc:"The icon is scaled in the x-dimension to fit the width of the text."},height:{doc:"The icon is scaled in the y-dimension to fit the height of the text."},both:{doc:"The icon is scaled in both x- and y-dimensions."}},default:"none",doc:"Scales the icon to fit around the associated text.",requires:["icon-image","text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"stretchable icons":{js:"1.6.0",android:"9.2.0",ios:"5.8.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",doc:"Size of the additional area added to dimensions determined by `icon-text-fit`, in clockwise order: top, right, bottom, left.",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",doc:"Name of image in sprite to use for drawing an image background.",tokens:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the icon clockwise.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the icon bounding box used for detecting symbol collisions.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,doc:"If true, the icon may be flipped to prevent it from being rendered upside-down.",requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],doc:"Offset distance of icon from its anchor. Positive values indicate right and down, while negative values indicate left and up. Each component is multiplied by the value of `icon-size` to obtain the final offset in pixels. When combined with `icon-rotate` the offset will be as if the rotated direction was up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{doc:"The center of the icon is placed closest to the anchor."},left:{doc:"The left side of the icon is placed closest to the anchor."},right:{doc:"The right side of the icon is placed closest to the anchor."},top:{doc:"The top of the icon is placed closest to the anchor."},bottom:{doc:"The bottom of the icon is placed closest to the anchor."},"top-left":{doc:"The top left corner of the icon is placed closest to the anchor."},"top-right":{doc:"The top right corner of the icon is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the icon is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the icon is placed closest to the anchor."}},default:"center",doc:"Part of the icon placed closest to the anchor.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{doc:"The icon is aligned to the plane of the map."},viewport:{doc:"The icon is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `icon-rotation-alignment`."}},default:"auto",doc:"Orientation of icon when map is pitched.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{doc:"The text is aligned to the plane of the map."},viewport:{doc:"The text is aligned to the plane of the viewport."},auto:{doc:"Automatically matches the value of `text-rotation-alignment`."}},default:"auto",doc:"Orientation of text when map is pitched.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{doc:"When `symbol-placement` is set to `point`, aligns text east-west. When `symbol-placement` is set to `line` or `line-center`, aligns text x-axes with the line."},viewport:{doc:"Produces glyphs whose x-axes are aligned with the x-axis of the viewport, regardless of the value of `symbol-placement`."},auto:{doc:"When `symbol-placement` is set to `point`, this is equivalent to `viewport`. When `symbol-placement` is set to `line` or `line-center`, this is equivalent to `map`."}},default:"auto",doc:"In combination with `symbol-placement`, determines the rotation behavior of the individual glyphs forming the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"`auto` value":{js:"0.25.0",android:"4.2.0",ios:"3.4.0",macos:"0.3.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,doc:"Value to use for a text label. If a plain `string` is provided, it will be treated as a `formatted` with default/inherited formatting options. SDF images are not supported in formatted text and will be ignored.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],doc:"Font stack to use for displaying text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",doc:"Font size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",doc:"The maximum line width for text wrapping.",requires:["text-field",{"symbol-placement":["point"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",doc:"Text leading value for multi-line text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",doc:"Text tracking amount.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.40.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{doc:"The text is aligned towards the anchor position."},left:{doc:"The text is aligned to the left."},center:{doc:"The text is centered."},right:{doc:"The text is aligned to the right."}},default:"center",doc:"Text justification options.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"},auto:{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,doc:"Radial offset of text, in the direction of the symbol's anchor. Useful in combination with `text-variable-anchor`, which defaults to using the two-dimensional `text-offset` if present.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"},"data-driven styling":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},requires:["text-field",{"symbol-placement":["point"]}],doc:"To increase the chance of placing high-priority labels on the map, you can provide an array of `text-anchor` locations: the renderer will attempt to place the label at each location, in order, before moving onto the next label. Use `text-justify: auto` to choose justification based on anchor position. To apply an offset, use the `text-radial-offset` or the two-dimensional `text-offset`.","sdk-support":{"basic functionality":{js:"0.54.0",android:"7.4.0",ios:"4.10.0",macos:"0.14.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{doc:"The center of the text is placed closest to the anchor."},left:{doc:"The left side of the text is placed closest to the anchor."},right:{doc:"The right side of the text is placed closest to the anchor."},top:{doc:"The top of the text is placed closest to the anchor."},bottom:{doc:"The bottom of the text is placed closest to the anchor."},"top-left":{doc:"The top left corner of the text is placed closest to the anchor."},"top-right":{doc:"The top right corner of the text is placed closest to the anchor."},"bottom-left":{doc:"The bottom left corner of the text is placed closest to the anchor."},"bottom-right":{doc:"The bottom right corner of the text is placed closest to the anchor."}},default:"center",doc:"Part of the text placed closest to the anchor.",requires:["text-field",{"!":"text-variable-anchor"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",doc:"Maximum angle change between adjacent characters.",requires:["text-field",{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{doc:"If a text's language supports horizontal writing mode, symbols would be laid out horizontally."},vertical:{doc:"If a text's language supports vertical writing mode, symbols would be laid out vertically."}},doc:"The property allows control over a symbol's orientation. Note that the property values act as a hint, so that a symbol whose language doesn\u2019t support the provided orientation will be laid out in its natural orientation. Example: English point symbol will be rendered horizontally even if array value contains single 'vertical' enum value. For symbol with point placement, the order of elements in an array define priority order for the placement of an orientation variant. For symbol with line placement, the default text writing mode is either ['horizontal', 'vertical'] or ['vertical', 'horizontal'], the order doesn't affect the placement.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"1.3.0",android:"8.3.0",ios:"5.3.0",macos:"0.15.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",doc:"Rotates the text clockwise.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",doc:"Size of the additional area around the text bounding box used for detecting symbol collisions.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,doc:"If true, the text may be flipped vertically to prevent it from being rendered upside-down.",requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{doc:"The text is not altered."},uppercase:{doc:"Forces all letters to be displayed in uppercase."},lowercase:{doc:"Forces all letters to be displayed in lowercase."}},default:"none",doc:"Specifies how to capitalize text, similar to the CSS `text-transform` property.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",doc:"Offset distance of text from its anchor. Positive values indicate right and down, while negative values indicate left and up. If used with text-variable-anchor, input values will be taken as absolute values. Offsets along the x- and y-axis will be applied automatically based on the anchor position.",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.35.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,doc:"If true, the text will be visible even if it collides with other previously drawn symbols.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,doc:"If true, other symbols can be visible even if they collide with the text.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,doc:"If true, icons will display without their corresponding text when the text collides with other symbols and the icon does not.",requires:["text-field","icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},H={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},"property-type":"constant"}},q={visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},"property-type":"constant"}},te={type:"array",value:"*",doc:"A filter selects specific features from a layer."},Q={type:"boolean",doc:'Expression which determines whether or not to display a symbol. Symbols support dynamic filtering, meaning this expression can use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},Z={type:"boolean",doc:'Expression which determines whether or not to display a polygon. Fill layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},ae={type:"boolean",doc:'Expression which determines whether or not to display a Polygon or LineString. Line layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},F={type:"boolean",doc:'Expression which determines whether or not to display a circle. Circle layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},W={type:"boolean",doc:'Expression used to determine whether a point is being displayed or not. Heatmap layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},O={type:"enum",values:{"==":{doc:'`["==", key, value]` equality: `feature[key] = value`'},"!=":{doc:'`["!=", key, value]` inequality: `feature[key] \u2260 value`'},">":{doc:'`[">", key, value]` greater than: `feature[key] > value`'},">=":{doc:'`[">=", key, value]` greater than or equal: `feature[key] \u2265 value`'},"<":{doc:'`["<", key, value]` less than: `feature[key] < value`'},"<=":{doc:'`["<=", key, value]` less than or equal: `feature[key] \u2264 value`'},in:{doc:'`["in", key, v0, ..., vn]` set inclusion: `feature[key] \u2208 {v0, ..., vn}`'},"!in":{doc:'`["!in", key, v0, ..., vn]` set exclusion: `feature[key] \u2209 {v0, ..., vn}`'},all:{doc:'`["all", f0, ..., fn]` logical `AND`: `f0 \u2227 ... \u2227 fn`'},any:{doc:'`["any", f0, ..., fn]` logical `OR`: `f0 \u2228 ... \u2228 fn`'},none:{doc:'`["none", f0, ..., fn]` logical `NOR`: `\xACf0 \u2227 ... \u2227 \xACfn`'},has:{doc:'`["has", key]` `feature[key]` exists'},"!has":{doc:'`["!has", key]` `feature[key]` does not exist'},within:{doc:'`["within", object]` feature geometry is within object geometry'}},doc:"The filter operator."},X={type:"enum",values:{Point:{doc:"Filter to point geometries."},LineString:{doc:"Filter to line geometries."},Polygon:{doc:"Filter to polygon geometries."}},doc:"The geometry type for the filter to select."},G={type:"array",minimum:0,maximum:24,value:["number","color"],length:2,doc:"Zoom level and value pair."},j={type:"array",value:"*",minimum:1,doc:"An expression defines a function that can be used for data-driven style properties or feature filters."},K={doc:"",type:"enum",values:{let:{doc:'Binds expressions to named variables, which can then be referenced in the result expression using ["var", "variable_name"].',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},var:{doc:'References variable bound using "let".',group:"Variable binding","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},literal:{doc:"Provides a literal array or object value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},array:{doc:"Asserts that the input is an array (optionally with a specific item type and length).  If, when the input expression is evaluated, it is not of the asserted type, then this assertion will cause the whole expression to be aborted.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},at:{doc:"Retrieves an item from an array.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},in:{doc:"Determines whether an item exists in an array or a substring exists in a string. In the specific case when the second and third arguments are string literals, you must wrap at least one of them in a [`literal`](#types-literal) expression to hint correct interpretation to the [type system](#type-system).",group:"Lookup","sdk-support":{"basic functionality":{js:"1.6.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"index-of":{doc:"Returns the first position at which an item can be found in an array or a substring can be found in a string, or `-1` if the input cannot be found. Accepts an optional index from where to begin the search.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},slice:{doc:"Returns an item from an array or a substring from a string from a specified start index, or between a start index and an end index if set. The return value is inclusive of the start index but not of the end index.",group:"Lookup","sdk-support":{"basic functionality":{js:"1.10.0"}}},case:{doc:"Selects the first output whose corresponding test condition evaluates to true, or the fallback value otherwise.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},match:{doc:'Selects the output for which the label value matches the input value, or the fallback value if no match is found. The input can be any expression (for example, `["get", "building_type"]`). Each label must be unique, and must be either:\n - a single literal value; or\n - an array of literal values, the values of which must be all strings or all numbers (for example `[100, 101]` or `["c", "b"]`).\n\nThe input matches if any of the values in the array matches using strict equality, similar to the `"in"` operator.\nIf the input type does not match the type of the labels, the result will be the fallback value.',group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},coalesce:{doc:"Evaluates each expression in turn until the first valid value is obtained. Invalid values are `null` and [`'image'`](#types-image) expressions that are unavailable in the style. If all values are invalid, `coalesce` returns the first value listed.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},step:{doc:'Produces discrete, stepped results by evaluating a piecewise-constant function defined by pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. Returns the output value of the stop just less than the input, or the first output if the input is less than the first stop.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},interpolate:{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). The `input` may be any numeric expression (e.g., `["get", "population"]`). Stop inputs must be numeric literals in strictly ascending order. The output type must be `number`, `array<number>`, or `color`.\n\nInterpolation types:\n- `["linear"]`: Interpolates linearly between the pair of stops just less than and just greater than the input.\n- `["exponential", base]`: Interpolates exponentially between the stops just less than and just greater than the input. `base` controls the rate at which the output increases: higher values make the output increase more towards the high end of the range. With values close to 1 the output increases linearly.\n- `["cubic-bezier", x1, y1, x2, y2]`: Interpolates using the cubic bezier curve defined by the given control points.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"interpolate-hcl":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the Hue-Chroma-Luminance color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},"interpolate-lab":{doc:'Produces continuous, smooth results by interpolating between pairs of input and output values ("stops"). Works like `interpolate`, but the output type must be `color`, and the interpolation is performed in the CIELAB color space.',group:"Ramps, scales, curves","sdk-support":{"basic functionality":{js:"0.49.0"}}},ln2:{doc:"Returns mathematical constant ln(2).",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pi:{doc:"Returns the mathematical constant pi.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},e:{doc:"Returns the mathematical constant e.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},typeof:{doc:"Returns a string describing the type of the given value.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},string:{doc:"Asserts that the input value is a string. If multiple values are provided, each one is evaluated in order until a string is obtained. If none of the inputs are strings, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},number:{doc:"Asserts that the input value is a number. If multiple values are provided, each one is evaluated in order until a number is obtained. If none of the inputs are numbers, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},boolean:{doc:"Asserts that the input value is a boolean. If multiple values are provided, each one is evaluated in order until a boolean is obtained. If none of the inputs are booleans, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},object:{doc:"Asserts that the input value is an object. If multiple values are provided, each one is evaluated in order until an object is obtained. If none of the inputs are objects, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},collator:{doc:"Returns a `collator` for use in locale-dependent comparison operations. The `case-sensitive` and `diacritic-sensitive` options default to `false`. The `locale` argument specifies the IETF language tag of the locale to use. If none is provided, the default locale is used. If the requested locale is not available, the `collator` will use a system-defined fallback locale. Use `resolved-locale` to test the results of locale fallback behavior.",group:"Types","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},format:{doc:'Returns a `formatted` string for displaying mixed-format text in the `text-field` property. The input may contain a string literal or expression, including an [`\'image\'`](#types-image) expression. Strings may be followed by a style override object that supports the following properties:\n- `"text-font"`: Overrides the font stack specified by the root layout property.\n- `"text-color"`: Overrides the color specified by the root paint property.\n- `"font-scale"`: Applies a scaling factor on `text-size` as specified by the root layout property.',group:"Types","sdk-support":{"basic functionality":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-font":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"font-scale":{js:"0.48.0",android:"6.7.0",ios:"4.6.0",macos:"0.12.0"},"text-color":{js:"1.3.0",android:"7.3.0",ios:"4.10.0",macos:"0.14.0"},image:{js:"1.6.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},image:{doc:"Returns a [`ResolvedImage`](/mapbox-gl-js/style-spec/types/#resolvedimage) for use in [`icon-image`](/mapbox-gl-js/style-spec/layers/#layout-symbol-icon-image), `*-pattern` entries, and as a section in the [`'format'`](#types-format) expression. A [`'coalesce'`](#coalesce) expression containing `image` expressions will evaluate to the first listed image that is currently in the style. This validation process is synchronous and requires the image to have been added to the style before requesting it in the `'image'` argument.",group:"Types","sdk-support":{"basic functionality":{js:"1.4.0",android:"8.6.0",ios:"5.7.0",macos:"0.15.0"}}},"number-format":{doc:"Converts the input number into a string representation using the providing formatting rules. If set, the `locale` argument specifies the locale to use, as a BCP 47 language tag. If set, the `currency` argument specifies an ISO 4217 code to use for currency-style formatting. If set, the `unit` argument specifies a [simple ECMAScript unit](https://tc39.es/proposal-unified-intl-numberformat/section6/locales-currencies-tz_proposed_out.html#sec-issanctionedsimpleunitidentifier) to use for unit-style formatting. If set, the `min-fraction-digits` and `max-fraction-digits` arguments specify the minimum and maximum number of fractional digits to include.",group:"Types","sdk-support":{"basic functionality":{js:"0.54.0",android:"8.4.0",ios:"5.4.0",macos:"0.15.0"}}},"to-string":{doc:'Converts the input value to a string. If the input is `null`, the result is `""`. If the input is a [`boolean`](#types-boolean), the result is `"true"` or `"false"`. If the input is a number, it is converted to a string as specified by the ["NumberToString" algorithm](https://tc39.github.io/ecma262/#sec-tostring-applied-to-the-number-type) of the ECMAScript Language Specification. If the input is a [`color`](#color), it is converted to a string of the form `"rgba(r,g,b,a)"`, where `r`, `g`, and `b` are numerals ranging from 0 to 255, and `a` ranges from 0 to 1. If the input is an [`\'image\'`](#types-image) expression, `\'to-string\'` returns the image name. Otherwise, the input is converted to a string in the format specified by the [`JSON.stringify`](https://tc39.github.io/ecma262/#sec-json.stringify) function of the ECMAScript Language Specification.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-number":{doc:'Converts the input value to a number, if possible. If the input is `null` or `false`, the result is 0. If the input is `true`, the result is 1. If the input is a string, it is converted to a number as specified by the ["ToNumber Applied to the String Type" algorithm](https://tc39.github.io/ecma262/#sec-tonumber-applied-to-the-string-type) of the ECMAScript Language Specification. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.',group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-boolean":{doc:"Converts the input value to a boolean. The result is `false` when then input is an empty string, 0, `false`, `null`, or `NaN`; otherwise it is `true`.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-rgba":{doc:"Returns a four-element array containing the input color's red, green, blue, and alpha components, in that order.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"to-color":{doc:"Converts the input value to a color. If multiple values are provided, each one is evaluated in order until the first successful conversion is obtained. If none of the inputs can be converted, the expression is an error.",group:"Types","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgb:{doc:"Creates a color value from red, green, and blue components, which must range between 0 and 255, and an alpha component of 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},rgba:{doc:"Creates a color value from red, green, blue components, which must range between 0 and 255, and an alpha component which must range between 0 and 1. If any component is out of range, the expression is an error.",group:"Color","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},get:{doc:"Retrieves a property value from the current feature's properties, or from another object if a second argument is provided. Returns `null` if the requested property is missing.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},has:{doc:"Tests for the presence of an property value in the current feature's properties, or from another object if a second argument is provided.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},length:{doc:"Returns the length of an array or string.",group:"Lookup","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},properties:{doc:'Returns the feature properties object.  Note that in some cases, it may be more efficient to use `["get", "property_name"]` directly.',group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"feature-state":{doc:"Retrieves a property value from the current feature's state. Returns `null` if the requested property is not present on the feature's state. A feature's state is not part of the GeoJSON or vector tile data, and must be set programmatically on each feature. Features are identified by their `id` attribute, which must be an integer or a string that can be cast to an integer. Note that [\"feature-state\"] can only be used with paint properties that support data-driven styling.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.46.0"}}},"geometry-type":{doc:"Returns the feature's geometry type: `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`. `Multi*` feature types are only returned in GeoJSON sources. When working with vector tile sources, use the singular forms.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},id:{doc:"Returns the feature's id, if it has one.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},zoom:{doc:'Returns the current zoom level.  Note that in style layout and paint properties, ["zoom"] may only appear as the input to a top-level "step" or "interpolate" expression.',group:"Camera","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},pitch:{doc:'Returns the current pitch in degrees. `["pitch"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"distance-from-center":{doc:'Returns the distance of a `symbol` instance from the center of the map. The distance is measured in pixels divided by the height of the map container. It measures 0 at the center, decreases towards the camera and increase away from the camera. For example, if the height of the map is 1000px, a value of -1 means 1000px away from the center towards the camera, and a value of 1 means a distance of 1000px away from the camera from the center. `["distance-from-center"]` may only be used in the `filter` expression for a `symbol` layer.',group:"Camera","sdk-support":{"basic functionality":{js:"2.6.0"}}},"heatmap-density":{doc:"Returns the kernel density estimation of a pixel in a heatmap layer, which is a relative measure of how many data points are crowded around a particular pixel. Can only be used in the `heatmap-color` property.",group:"Heatmap","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"line-progress":{doc:"Returns the progress along a gradient line. Can only be used in the `line-gradient` property.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.6.0",macos:"0.12.0"}}},"sky-radial-progress":{doc:"Returns the distance of a point on the sky from the sun position. Returns 0 at sun position and 1 when the distance reaches `sky-gradient-radius`. Can only be used in the `sky-gradient` property.",group:"sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},accumulated:{doc:"Returns the value of a cluster property accumulated so far. Can only be used in the `clusterProperties` option of a clustered GeoJSON source.",group:"Feature data","sdk-support":{"basic functionality":{js:"0.53.0",android:"8.4.0",ios:"5.5.0",macos:"0.15.0"}}},"+":{doc:"Returns the sum of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"*":{doc:"Returns the product of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"-":{doc:"For two inputs, returns the result of subtracting the second input from the first. For a single input, returns the result of subtracting it from 0.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"/":{doc:"Returns the result of floating point division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"%":{doc:"Returns the remainder after integer division of the first input by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"^":{doc:"Returns the result of raising the first input to the power specified by the second.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sqrt:{doc:"Returns the square root of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.42.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log10:{doc:"Returns the base-ten logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ln:{doc:"Returns the natural logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},log2:{doc:"Returns the base-two logarithm of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},sin:{doc:"Returns the sine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},cos:{doc:"Returns the cosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},tan:{doc:"Returns the tangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},asin:{doc:"Returns the arcsine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},acos:{doc:"Returns the arccosine of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},atan:{doc:"Returns the arctangent of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},min:{doc:"Returns the minimum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},max:{doc:"Returns the maximum value of the inputs.",group:"Math","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},round:{doc:'Rounds the input to the nearest integer. Halfway values are rounded away from zero. For example, `["round", -1.5]` evaluates to -2.',group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},abs:{doc:"Returns the absolute value of the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},ceil:{doc:"Returns the smallest integer that is greater than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},floor:{doc:"Returns the largest integer that is less than or equal to the input.",group:"Math","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},distance:{doc:"Returns the shortest distance in meters between the evaluated feature and the input geometry. The input value can be a valid GeoJSON of type `Point`, `MultiPoint`, `LineString`, `MultiLineString`, `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Distance values returned may vary in precision due to loss in precision from encoding geometries, particularly below zoom level 13.",group:"Math","sdk-support":{"basic functionality":{android:"9.2.0",ios:"5.9.0",macos:"0.16.0"}}},"==":{doc:"Returns `true` if the input values are equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"!=":{doc:"Returns `true` if the input values are not equal, `false` otherwise. The comparison is strictly typed: values of different runtime types are always considered unequal. Cases where the types are known to be different at parse time are considered invalid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">":{doc:"Returns `true` if the first input is strictly greater than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<":{doc:"Returns `true` if the first input is strictly less than the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},">=":{doc:"Returns `true` if the first input is greater than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},"<=":{doc:"Returns `true` if the first input is less than or equal to the second, `false` otherwise. The arguments are required to be either both strings or both numbers; if during evaluation they are not, expression evaluation produces an error. Cases where this constraint is known not to hold at parse time are considered in valid and will produce a parse error. Accepts an optional `collator` argument to control locale-dependent string comparisons.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},collator:{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}},all:{doc:"Returns `true` if all the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `false`, the result is `false` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},any:{doc:"Returns `true` if any of the inputs are `true`, `false` otherwise. The inputs are evaluated in order, and evaluation is short-circuiting: once an input expression evaluates to `true`, the result is `true` and no further input expressions are evaluated.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"!":{doc:"Logical negation. Returns `true` if the input is `false`, and `false` if the input is `true`.",group:"Decision","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},within:{doc:"Returns `true` if the evaluated feature is fully contained inside a boundary of the input geometry, `false` otherwise. The input value can be a valid GeoJSON of type `Polygon`, `MultiPolygon`, `Feature`, or `FeatureCollection`. Supported features for evaluation:\n- `Point`: Returns `false` if a point is on the boundary or falls outside the boundary.\n- `LineString`: Returns `false` if any part of a line falls outside the boundary, the line intersects the boundary, or a line's endpoint is on the boundary.",group:"Decision","sdk-support":{"basic functionality":{js:"1.9.0",android:"9.1.0",ios:"5.8.0",macos:"0.15.0"}}},"is-supported-script":{doc:"Returns `true` if the input string is expected to render legibly. Returns `false` if the input string contains sections that cannot be rendered without potential loss of meaning (e.g. Indic scripts that require complex text shaping, or right-to-left scripts if the the `mapbox-gl-rtl-text` plugin is not in use in Mapbox GL JS).",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.6.0",ios:"4.1.0",macos:"0.8.0"}}},upcase:{doc:"Returns the input string converted to uppercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},downcase:{doc:"Returns the input string converted to lowercase. Follows the Unicode Default Case Conversion algorithm and the locale-insensitive case mappings in the Unicode Character Database.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},concat:{doc:"Returns a `string` consisting of the concatenation of the inputs. Each input is converted to a string as if by `to-string`.",group:"String","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}}},"resolved-locale":{doc:"Returns the IETF language tag of the locale being used by the provided `collator`. This can be used to determine the default system locale, or to determine if a requested locale was successfully loaded.",group:"String","sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.2.0",macos:"0.9.0"}}}}},ce={range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"The start and end distance range in which fog fades from fully transparent to fully opaque. The distance to the point at the center of the map is defined as zero, so that negative range values are closer to the camera, and positive values are farther away.",example:[.5,10],"sdk-support":{"basic functionality":{js:"2.3.0",android:"10.6.0",ios:"10.6.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the atmosphere region immediately below the horizon and within the `range` and above the horizon and within `horizon-blend`. Using opacity is recommended only for smoothly transitioning fog on/off as anything less than 100% opacity results in more tiles loaded and drawn.","sdk-support":{"basic functionality":{js:"2.3.0",android:"10.6.0",ios:"10.6.0"}}},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the atmosphere region above the horizon, `high-color` extends further above the horizon than the `color` property and its spread can be controlled with `horizon-blend`. The opacity can be set to `0` to remove the high atmosphere color contribution.","sdk-support":{"basic functionality":{js:"2.9.0",android:"10.6.0",ios:"10.6.0"}}},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The color of the region above the horizon and after the end of the `horizon-blend` contribution. The opacity can be set to `0` to have a transparent background.","sdk-support":{"basic functionality":{js:"2.9.0",android:"10.6.0",ios:"10.6.0"}}},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Horizon blend applies a smooth fade from the color of the atmosphere to the color of space. A value of zero leaves a sharp transition from atmosphere to space. Increasing the value blends the color of atmosphere into increasingly high angles of the sky.","sdk-support":{"basic functionality":{js:"2.3.0",android:"10.6.0",ios:"10.6.0"}}},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"A value controlling the star intensity where `0` will show no stars and `1` will show stars at their maximum intensity.","sdk-support":{"basic functionality":{js:"2.9.0",android:"10.6.0",ios:"10.6.0"}}}},se={anchor:{type:"enum",default:"viewport",values:{map:{doc:"The position of the light source is aligned to the rotation of the map."},viewport:{doc:"The position of the light source is aligned to the rotation of the viewport."}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},doc:"Whether extruded geometries are lit relative to the map or viewport.",example:"map","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},doc:"Position of the light source relative to lit (extruded) geometries, in [r radial coordinate, a azimuthal angle, p polar angle] where r indicates the distance from the center of the base of an object to its light, a indicates the position of the light relative to 0\xB0 (0\xB0 when `light.anchor` is set to `viewport` corresponds to the top of the viewport, or 0\xB0 when `light.anchor` is set to `map` corresponds to due north, and degrees proceed clockwise), and p indicates the height of the light (from 0\xB0, directly above, to 180\xB0, directly below).",example:[1.5,90,80],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Color tint for lighting extruded geometries.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Intensity of lighting (on a scale from 0 to 1). Higher numbers will present as more extreme contrast.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}}}},ue={name:{type:"enum",values:{albers:{doc:"An Albers equal-area projection centered on the continental United States. You can configure the projection for a different region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},equalEarth:{doc:"An Equal Earth projection."},equirectangular:{doc:"An Equirectangular projection. This projection is very similar to the Plate Carr\xE9e projection."},lambertConformalConic:{doc:"A Lambert conformal conic projection. You can configure the projection for a region by setting `center` and `parallels` properties. You may want to set max bounds to constrain the map to the relevant region."},mercator:{doc:"The Mercator projection is the default projection."},naturalEarth:{doc:"A Natural Earth projection."},winkelTripel:{doc:"A Winkel Tripel projection."},globe:{doc:"A globe projection."}},default:"mercator",doc:"The name of the projection to be used for rendering the map.",required:!0,"sdk-support":{"basic functionality":{js:"2.6.0"}}},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,doc:"The reference longitude and latitude of the projection. `center` takes the form of [lng, lat]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic). All other projections are centered on [0, 0].",example:[-96,37.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,doc:"The standard parallels of the projection, denoting the desired latitude range with minimal distortion. `parallels` takes the form of [lat0, lat1]. This property is only configurable for conic projections (Albers and Lambert Conformal Conic).",example:[29.5,45.5],requires:[{name:["albers","lambertConformalConic"]}],"sdk-support":{"basic functionality":{js:"2.6.0"}}}},Y={source:{type:"string",doc:"Name of a source of `raster_dem` type to be used for terrain elevation.",required:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Exaggerates the elevation of the terrain by multiplying the data from the DEM with this value.",requires:["source"],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}}}},pe=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],Ee={"fill-antialias":{type:"boolean",default:!0,doc:"Whether or not the fill should be antialiased.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill layer. In contrast to the `fill-color`, this value will also affect the 1px stroke around the fill, if the stroke is used.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.21.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",doc:"The color of the filled part of this layer. This color can be specified as `rgba` with an alpha component and the color's opacity will not affect the opacity of the 1px stroke, if it is used.",transition:!0,requires:[{"!":"fill-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",doc:"The outline color of the fill. Matches the value of `fill-color` if unspecified.",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.19.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{doc:"The fill is translated relative to the map."},viewport:{doc:"The fill is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-translate`.",default:"map",requires:["fill-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},Fe={"line-opacity":{type:"number",doc:"The opacity at which the line will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",doc:"The color with which the line will be drawn.",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.23.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{doc:"The line is translated relative to the map."},viewport:{doc:"The line is translated relative to the viewport."}},doc:"Controls the frame of reference for `line-translate`.",default:"map",requires:["line-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",doc:"Stroke thickness.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,doc:"Draws a line casing outside of a line's actual path. Value indicates the width of the inner gap.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,doc:"The line's offset. For linear features, a positive value offsets the line to the right, relative to the direction of the line, and a negative value to the left. For polygon features, a positive value results in an inset, and a negative value results in an outset.",transition:!0,units:"pixels","sdk-support":{"basic functionality":{js:"0.12.1",android:"3.0.0",ios:"3.1.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Blur applied to the line, in pixels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",doc:"Specifies the lengths of the alternating dashes and gaps that form the dash pattern. The lengths are later scaled by the line width. To convert a dash length to pixels, multiply the length by the current line width. Note that GeoJSON sources with `lineMetrics: true` specified won't render dashed lines to the expected scale. Also note that zoom-dependent expressions will be evaluated only at integer zoom levels.",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"2.3.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing image lines. For seamless patterns, image width must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",doc:'Defines a gradient with which to color a line feature. Can only be used with GeoJSON sources that specify `"lineMetrics": true`.',transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"0.45.0",android:"6.5.0",ios:"4.4.0",macos:"0.11.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",doc:"The line part between [trim-start, trim-end] will be marked as transparent to make a route vanishing effect. The line trim-off offset is based on the whole line range [0.0, 1.0].",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"sdk-support":{"basic functionality":{js:"2.9.0",android:"10.5.0",ios:"10.5.0",macos:"10.5.0"}},"property-type":"constant"}},$e={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",doc:"Circle radius.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",doc:"The fill color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.18.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,doc:"Amount to blur the circle. 1 blurs the circle such that only the centerpoint is full opacity.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",doc:"The opacity at which the circle will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.20.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up, respectively.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{doc:"The circle is translated relative to the map."},viewport:{doc:"The circle is translated relative to the viewport."}},doc:"Controls the frame of reference for `circle-translate`.",default:"map",requires:["circle-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{doc:"Circles are scaled according to their apparent distance to the camera."},viewport:{doc:"Circles are not scaled."}},default:"map",doc:"Controls the scaling behavior of the circle when the map is pitched.","sdk-support":{"basic functionality":{js:"0.21.0",android:"4.2.0",ios:"3.4.0",macos:"0.2.1"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{doc:"The circle is aligned to the plane of the map."},viewport:{doc:"The circle is aligned to the plane of the viewport."}},default:"viewport",doc:"Orientation of circle when map is pitched.","sdk-support":{"basic functionality":{js:"0.39.0",android:"5.2.0",ios:"3.7.0",macos:"0.6.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The width of the circle's stroke. Strokes are placed outside of the `circle-radius`.","sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",doc:"The stroke color of the circle.",transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",doc:"The opacity of the circle's stroke.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"},"data-driven styling":{js:"0.29.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},pt={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",doc:"Radius of influence of one heatmap point in pixels. Increasing the value makes the heatmap smoother, but less detailed. `queryRenderedFeatures` on heatmap layers will return points within this radius.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,doc:"A measure of how much an individual point contributes to the heatmap. A value of 10 would be equivalent to having 10 points of weight 1 in the same spot. Especially useful when combined with clustering.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,doc:"Similar to `heatmap-weight` but controls the intensity of the heatmap globally. Primarily used for adjusting the heatmap based on zoom level.","sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],doc:'Defines the color of each pixel based on its density value in a heatmap.  Should be an expression that uses `["heatmap-density"]` as input.',transition:!1,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",doc:"The global opacity at which the heatmap layer will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.41.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Ue={"icon-opacity":{doc:"The opacity at which the icon will be drawn.",type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,doc:"The color of the icon. This can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the icon's halo. Icon halos can only be used with [SDF icons](/help/troubleshooting/using-recolorable-images-in-mapbox-maps/).",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the icon outline.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Fade out the halo towards the outside.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the icon's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["icon-image"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{doc:"Icons are translated relative to the map."},viewport:{doc:"Icons are translated relative to the viewport."}},doc:"Controls the frame of reference for `icon-translate`.",default:"map",requires:["icon-image","icon-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",doc:"The opacity at which the text will be drawn.",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",doc:"The color with which the text will be drawn.",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,doc:"The color of the text's halo, which helps it stand out from backgrounds.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"Distance of halo to the font outline. Max text halo width is 1/4 of the font-size.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",doc:"The halo's fadeout distance towards the outside.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{js:"0.33.0",android:"5.0.0",ios:"3.5.0",macos:"0.4.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"Distance that the text's anchor is moved from its original placement. Positive values indicate right and down, while negative values indicate left and up.",requires:["text-field"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{doc:"The text is translated relative to the map."},viewport:{doc:"The text is translated relative to the viewport."}},doc:"Controls the frame of reference for `text-translate`.",default:"map",requires:["text-field","text-translate"],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},Je={"raster-opacity":{type:"number",doc:"The opacity at which the image will be drawn.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",doc:"Rotates hues around the color wheel.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the minimum brightness.",default:0,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",doc:"Increase or reduce the brightness of the image. The value is the maximum brightness.",default:1,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",doc:"Increase or reduce the saturation of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",doc:"Increase or reduce the contrast of the image.",default:0,minimum:-1,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",doc:"The resampling/interpolation method to use for overscaling, also known as texture magnification filter",values:{linear:{doc:"(Bi)linear filtering interpolates pixel values using the weighted average of the four closest original source pixels creating a smooth but blurry look when overscaled"},nearest:{doc:"Nearest neighbor filtering interpolates pixel values using the nearest original source pixel creating a sharp but pixelated look when overscaled"}},default:"linear","sdk-support":{"basic functionality":{js:"0.47.0",android:"6.3.0",ios:"4.2.0",macos:"0.9.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",doc:"Fade duration when a new tile is added.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},et={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,doc:"The direction of the light source used to generate the hillshading with 0 as the top of the viewport if `hillshade-illumination-anchor` is set to `viewport` and due north if `hillshade-illumination-anchor` is set to `map`.",transition:!1,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{doc:"The hillshade illumination is relative to the north direction."},viewport:{doc:"The hillshade illumination is relative to the top of the viewport."}},default:"viewport",doc:"Direction of light source when map is rotated.","sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",doc:"Intensity of the hillshade",default:.5,minimum:0,maximum:1,transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",doc:"The shading color of areas that face away from the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",doc:"The shading color of areas that faces towards the light source.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",doc:"The shading color used to accentuate rugged terrain like sharp cliffs and gorges.",transition:!0,"sdk-support":{"basic functionality":{js:"0.43.0",android:"6.0.0",ios:"4.0.0",macos:"0.7.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ze={"background-color":{type:"color",default:"#000000",doc:"The color with which the background will be drawn.",transition:!0,requires:[{"!":"background-pattern"}],"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing an image background. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"},"data-driven styling":{}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity at which the background will be drawn.",transition:!0,"sdk-support":{"basic functionality":{js:"0.10.0",android:"2.0.1",ios:"2.0.0",macos:"0.1.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Xe={"sky-type":{type:"enum",values:{gradient:{doc:"Renders the sky with a gradient that can be configured with `sky-gradient-radius` and `sky-gradient`."},atmosphere:{doc:"Renders the sky with a simulated atmospheric scattering algorithm, the sun direction can be attached to the light position or explicitly set through `sky-atmosphere-sun`."}},default:"atmosphere",doc:"The type of the sky","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the sun center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the sun relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the sun, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon. When this property is ommitted, the sun center is directly inherited from the light position.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,doc:"Intensity of the sun as a light source in the atmosphere (on a scale from 0 to a 100). Setting higher values will brighten up the sky.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,doc:"Position of the gradient center [a azimuthal angle, p polar angle]. The azimuthal angle indicates the position of the gradient center relative to 0\xB0 north, where degrees proceed clockwise. The polar angle indicates the height of the gradient center, where 0\xB0 is directly above, at zenith, and 90\xB0 at the horizon.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,doc:"The angular distance (measured in degrees) from `sky-gradient-center` up to which the gradient extends. A value of 180 causes the gradient to wrap around to the opposite direction from `sky-gradient-center`.","sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],doc:"Defines a radial color gradient with which to color the sky. The color values can be interpolated with an expression using `sky-radial-progress`. The range [0, 1] for the interpolant covers a radial distance (in degrees) of [0, `sky-gradient-radius`] centered at the position specified by `sky-gradient-center`.",transition:!1,requires:[{"sky-type":"gradient"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"},"data-driven styling":{}},expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",doc:"A color applied to the atmosphere sun halo. The alpha channel describes how strongly the sun halo is represented in an atmosphere sky layer.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",doc:"A color used to tweak the main atmospheric scattering coefficients. Using white applies the default coefficients giving the natural blue color to the atmosphere. This color affects how heavily the corresponding wavelength is represented during scattering. The alpha channel describes the density of the atmosphere, with 1 maximum density and 0 no density.",transition:!1,requires:[{"sky-type":"atmosphere"}],"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire sky layer.",transition:!0,"sdk-support":{"basic functionality":{js:"2.0.0",ios:"10.0.0",android:"10.0.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},tt={duration:{type:"number",default:300,minimum:0,units:"milliseconds",doc:"Time allotted for transitions to complete."},delay:{type:"number",default:0,minimum:0,units:"milliseconds",doc:"Length of time before a transition begins."}},ye={"*":{type:"string",doc:"A name of a feature property to use as ID for feature state."}},Ze={$version:R,$root:M,sources:v,source:y,source_vector:p,source_raster:g,source_raster_dem:C,source_geojson:D,source_video:B,source_image:V,layer:P,layout:L,layout_background:E,layout_sky:b,layout_fill:_,layout_circle:x,layout_heatmap:T,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{doc:"The layer is shown."},none:{doc:"The layer is not shown."}},default:"visible",doc:"Whether this layer is displayed.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},"property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,doc:"Radius of a fill extrusion edge in meters. If not zero, rounds extrusion edges for a smoother appearance.","sdk-support":{"basic functionality":{js:"v2.10.0"}},"property-type":"constant"}},layout_line:N,layout_symbol:U,layout_raster:H,layout_hillshade:q,filter:te,filter_symbol:Q,filter_fill:Z,filter_line:ae,filter_circle:F,"filter_fill-extrusion":{type:"boolean",doc:'Expression which determines whether or not to display a Polygon. Fill-extrusion layer does NOT support dynamic filtering, meaning this expression can NOT use the `["pitch"]` and `["distance-from-center"]` expressions to reference the current state of the view.',default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:W,filter_operator:O,geometry_type:X,function:{expression:{type:"expression",doc:"An expression."},stops:{type:"array",doc:"An array of stops.",value:"function_stop"},base:{type:"number",default:1,minimum:0,doc:"The exponential base of the interpolation curve. It controls the rate at which the result increases. Higher values make the result increase more towards the high end of the range. With `1` the stops are interpolated linearly."},property:{type:"string",doc:"The name of a feature property to use as the function input.",default:"$zoom"},type:{type:"enum",values:{identity:{doc:"Return the input value as the output value."},exponential:{doc:"Generate an output by interpolating between stops just less than and just greater than the function input."},interval:{doc:"Return the output value of the stop just less than the function input."},categorical:{doc:"Return the output value of the stop equal to the function input."}},doc:"The interpolation strategy to use in function evaluation.",default:"exponential"},colorSpace:{type:"enum",values:{rgb:{doc:"Use the RGB color space to interpolate color values"},lab:{doc:"Use the LAB color space to interpolate color values."},hcl:{doc:"Use the HCL color space to interpolate color values, interpolating the Hue, Chroma, and Luminance channels individually."}},doc:"The color space in which colors interpolated. Interpolating colors in perceptual color spaces like LAB and HCL tend to produce color ramps that look more consistent and produce colors that can be differentiated more easily than those interpolated in RGB space.",default:"rgb"},default:{type:"*",required:!1,doc:`A value to serve as a fallback function result when a value isn't otherwise available. It is used in the following circumstances:
* In categorical functions, when the feature value does not match any of the stop domain values.
* In property and zoom-and-property functions, when a feature does not contain a value for the specified property.
* In identity functions, when the feature value is not valid for the style property (for example, if the function is being used for a \`circle-color\` property but the feature property value is not a string or not a valid color).
* In interval or exponential property and zoom-and-property functions, when the feature value is not numeric.
If no default is provided, the style property's default is used in these circumstances.`}},function_stop:G,expression:j,expression_name:K,fog:ce,light:se,projection:ue,terrain:Y,paint:pe,paint_fill:Ee,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,doc:"The opacity of the entire fill extrusion layer. This is rendered on a per-layer, not per-feature, basis, and data-driven styling is not available.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",doc:"The base color of the extruded fill. The extrusion's surfaces will be shaded differently based on this color in combination with the root `light` settings. If this color is specified as `rgba` with an alpha component, the alpha component will be ignored; use `fill-extrusion-opacity` to set layer opacity.",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",doc:"The geometry's offset. Values are [x, y] where negatives indicate left and up (on the flat plane), respectively.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{doc:"The fill extrusion is translated relative to the map."},viewport:{doc:"The fill extrusion is translated relative to the viewport."}},doc:"Controls the frame of reference for `fill-extrusion-translate`.",default:"map",requires:["fill-extrusion-translate"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,doc:"Name of image in sprite to use for drawing images on extruded fills. For seamless patterns, image width and height must be a factor of two (2, 4, 8, ..., 512). Note that zoom-dependent expressions will be evaluated only at integer zoom levels.","sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.49.0",android:"6.5.0",macos:"0.11.0",ios:"4.4.0"}},expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude this layer.",transition:!0,"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",doc:"The height with which to extrude the base of this layer. Must be less than or equal to `fill-extrusion-height`.",transition:!0,requires:["fill-extrusion-height"],"sdk-support":{"basic functionality":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"},"data-driven styling":{js:"0.27.0",android:"5.1.0",ios:"3.6.0",macos:"0.5.0"}},expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,doc:"Whether to apply a vertical gradient to the sides of a fill-extrusion layer. If true, sides will be shaded slightly darker farther down.",transition:!1,"sdk-support":{"basic functionality":{js:"0.50.0",android:"7.0.0",ios:"4.7.0",macos:"0.13.0"}},expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"Controls the intensity of ambient occlusion (AO) shading. Current AO implementation is a low-cost best-effort approach that shades area near ground and concave angles between walls. Default value 0.0 disables ambient occlusion and values around 0.3 provide the most plausible results for buildings.","sdk-support":{"basic functionality":{js:"2.10.0",android:"10.7.0",ios:"10.7.0"}}},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,doc:"The radius of ambient occlusion (AO) shading, in meters. Current AO implementation is a low-cost best-effort approach that shades area near ground and concave angles between walls where the radius defines only vertical impact. Default value 3.0 corresponds to hight of one floor and brings the most plausible results for buildings.","sdk-support":{"basic functionality":{js:"2.10.0",android:"10.7.0",ios:"10.7.0"}}}},paint_line:Fe,paint_circle:$e,paint_heatmap:pt,paint_symbol:Ue,paint_raster:Je,paint_hillshade:et,paint_background:ze,paint_sky:Xe,transition:tt,"property-type":{"data-driven":{type:"property-type",doc:"Property is interpolable and can be represented using a property expression."},"cross-faded":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms."},"cross-faded-data-driven":{type:"property-type",doc:"Property is non-interpolable; rather, its values will be cross-faded to smoothly transition between integer zooms. It can be represented using a property expression."},"color-ramp":{type:"property-type",doc:"Property should be specified using a color ramp from which the output color can be sampled based on a property calculation."},"data-constant":{type:"property-type",doc:"Property is interpolable but cannot be represented using a property expression."},constant:{type:"property-type",doc:"Property is constant across all zoom levels and property values."}},promoteId:ye},Ge=/("(?:[^\\"]|\\.)*")|[:,]/g,Ae=function(A,k){var le,Pe,De;return k=k||{},le=JSON.stringify([1],void 0,k.indent===void 0?2:k.indent).slice(2,-3),Pe=le===""?1/0:k.maxLength===void 0?80:k.maxLength,De=k.replacer,function He(nt,Tt,At){var Ht,Wt,yr,br,Wr,vr,rn,Yr,$t,Mr,Nr,an;if(nt&&typeof nt.toJSON=="function"&&(nt=nt.toJSON()),Nr=JSON.stringify(nt,De),Nr===void 0)return Nr;if(rn=Pe-Tt.length-At,Nr.length<=rn&&($t=Nr.replace(Ge,function(fn,Hn){return Hn||fn+" "}),$t.length<=rn))return $t;if(De!=null&&(nt=JSON.parse(Nr),De=void 0),typeof nt=="object"&&nt!==null){if(Yr=Tt+le,yr=[],Wt=0,Array.isArray(nt))for(Mr="[",Ht="]",rn=nt.length;Wt<rn;Wt++)yr.push(He(nt[Wt],Yr,Wt===rn-1?0:1)||"null");else for(Mr="{",Ht="}",vr=Object.keys(nt),rn=vr.length;Wt<rn;Wt++)br=vr[Wt],Wr=JSON.stringify(br)+": ",an=He(nt[br],Yr,Wr.length+(Wt===rn-1?0:1)),an!==void 0&&yr.push(Wr+an);if(yr.length>0)return[Mr,le+yr.join(`,
`+Yr),Ht].join(`
`+Tt)}return Nr}(A,"",0)},Se=Ae;function Te(S,A){const k={};for(const le in A)S[le]!==void 0&&(k[le]=S[le]);for(const le in S)k[le]===void 0&&(k[le]=S[le]);return k}function me(S,A=2){return S=Te(S,Ze.$root),S.layers&&(S.layers=S.layers.map(k=>Te(k,Ze.layer))),Se(S,{indent:A})}var be=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ua<"u"?ua:typeof self<"u"?self:{};function we(S){var A={exports:{}};return S(A,A.exports),A.exports}function je(S){throw new Error('Could not dynamically require "'+S+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}/*! https://mths.be/punycode v1.3.2 by @mathias */var lt=we(function(S,A){(function(k){var le=A&&!A.nodeType&&A,Pe=S&&!S.nodeType&&S,De=typeof be=="object"&&be;(De.global===De||De.window===De||De.self===De)&&(k=De);var He,nt=2147483647,Tt=36,At=1,Ht=26,Wt=38,yr=700,br=72,Wr=128,vr="-",rn=/^xn--/,Yr=/[^\x20-\x7E]/,$t=/[\x2E\u3002\uFF0E\uFF61]/g,Mr={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Nr=Tt-At,an=Math.floor,fn=String.fromCharCode,Hn;function na(Gr){throw RangeError(Mr[Gr])}function ai(Gr,mn){for(var kn=Gr.length,wi=[];kn--;)wi[kn]=mn(Gr[kn]);return wi}function ws(Gr,mn){var kn=Gr.split("@"),wi="";kn.length>1&&(wi=kn[0]+"@",Gr=kn[1]),Gr=Gr.replace($t,".");var Mi=Gr.split("."),Li=ai(Mi,mn).join(".");return wi+Li}function Uo(Gr){for(var mn=[],kn=0,wi=Gr.length,Mi,Li;kn<wi;)Mi=Gr.charCodeAt(kn++),Mi>=55296&&Mi<=56319&&kn<wi?(Li=Gr.charCodeAt(kn++),(Li&64512)==56320?mn.push(((Mi&1023)<<10)+(Li&1023)+65536):(mn.push(Mi),kn--)):mn.push(Mi);return mn}function Au(Gr){return ai(Gr,function(mn){var kn="";return mn>65535&&(mn-=65536,kn+=fn(mn>>>10&1023|55296),mn=56320|mn&1023),kn+=fn(mn),kn}).join("")}function mo(Gr){return Gr-48<10?Gr-22:Gr-65<26?Gr-65:Gr-97<26?Gr-97:Tt}function Ni(Gr,mn){return Gr+22+75*(Gr<26)-((mn!=0)<<5)}function ba(Gr,mn,kn){var wi=0;for(Gr=kn?an(Gr/yr):Gr>>1,Gr+=an(Gr/mn);Gr>Nr*Ht>>1;wi+=Tt)Gr=an(Gr/Nr);return an(wi+(Nr+1)*Gr/(Gr+Wt))}function Ms(Gr){var mn=[],kn=Gr.length,wi,Mi=0,Li=Wr,Si=br,pi,Ca,ns,Ga,Va,bs,Fs,zo,wu;for(pi=Gr.lastIndexOf(vr),pi<0&&(pi=0),Ca=0;Ca<pi;++Ca)Gr.charCodeAt(Ca)>=128&&na("not-basic"),mn.push(Gr.charCodeAt(Ca));for(ns=pi>0?pi+1:0;ns<kn;){for(Ga=Mi,Va=1,bs=Tt;ns>=kn&&na("invalid-input"),Fs=mo(Gr.charCodeAt(ns++)),(Fs>=Tt||Fs>an((nt-Mi)/Va))&&na("overflow"),Mi+=Fs*Va,zo=bs<=Si?At:bs>=Si+Ht?Ht:bs-Si,!(Fs<zo);bs+=Tt)wu=Tt-zo,Va>an(nt/wu)&&na("overflow"),Va*=wu;wi=mn.length+1,Si=ba(Mi-Ga,wi,Ga==0),an(Mi/wi)>nt-Li&&na("overflow"),Li+=an(Mi/wi),Mi%=wi,mn.splice(Mi++,0,Li)}return Au(mn)}function vo(Gr){var mn,kn,wi,Mi,Li,Si,pi,Ca,ns,Ga,Va,bs=[],Fs,zo,wu,Es;for(Gr=Uo(Gr),Fs=Gr.length,mn=Wr,kn=0,Li=br,Si=0;Si<Fs;++Si)Va=Gr[Si],Va<128&&bs.push(fn(Va));for(wi=Mi=bs.length,Mi&&bs.push(vr);wi<Fs;){for(pi=nt,Si=0;Si<Fs;++Si)Va=Gr[Si],Va>=mn&&Va<pi&&(pi=Va);for(zo=wi+1,pi-mn>an((nt-kn)/zo)&&na("overflow"),kn+=(pi-mn)*zo,mn=pi,Si=0;Si<Fs;++Si)if(Va=Gr[Si],Va<mn&&++kn>nt&&na("overflow"),Va==mn){for(Ca=kn,ns=Tt;Ga=ns<=Li?At:ns>=Li+Ht?Ht:ns-Li,!(Ca<Ga);ns+=Tt)Es=Ca-Ga,wu=Tt-Ga,bs.push(fn(Ni(Ga+Es%wu,0))),Ca=an(Es/wu);bs.push(fn(Ni(Ca,0))),Li=ba(kn,zo,wi==Mi),kn=0,++wi}++kn,++mn}return bs.join("")}function oh(Gr){return ws(Gr,function(mn){return rn.test(mn)?Ms(mn.slice(4).toLowerCase()):mn})}function uh(Gr){return ws(Gr,function(mn){return Yr.test(mn)?"xn--"+vo(mn):mn})}if(He={version:"1.3.2",ucs2:{decode:Uo,encode:Au},decode:Ms,encode:vo,toASCII:uh,toUnicode:oh},le&&Pe)if(S.exports==le)Pe.exports=He;else for(Hn in He)He.hasOwnProperty(Hn)&&(le[Hn]=He[Hn]);else k.punycode=He})(be)}),ot={isString:function(S){return typeof S=="string"},isObject:function(S){return typeof S=="object"&&S!==null},isNull:function(S){return S===null},isNullOrUndefined:function(S){return S==null}};function bt(S,A){return Object.prototype.hasOwnProperty.call(S,A)}var Ie=function(S,A,k,le){A=A||"&",k=k||"=";var Pe={};if(typeof S!="string"||S.length===0)return Pe;var De=/\+/g;S=S.split(A);var He=1e3;le&&typeof le.maxKeys=="number"&&(He=le.maxKeys);var nt=S.length;He>0&&nt>He&&(nt=He);for(var Tt=0;Tt<nt;++Tt){var At=S[Tt].replace(De,"%20"),Ht=At.indexOf(k),Wt,yr,br,Wr;Ht>=0?(Wt=At.substr(0,Ht),yr=At.substr(Ht+1)):(Wt=At,yr=""),br=decodeURIComponent(Wt),Wr=decodeURIComponent(yr),bt(Pe,br)?Array.isArray(Pe[br])?Pe[br].push(Wr):Pe[br]=[Pe[br],Wr]:Pe[br]=Wr}return Pe},re=function(S){switch(typeof S){case"string":return S;case"boolean":return S?"true":"false";case"number":return isFinite(S)?S:"";default:return""}},oe=function(S,A,k,le){return A=A||"&",k=k||"=",S===null&&(S=void 0),typeof S=="object"?Object.keys(S).map(function(Pe){var De=encodeURIComponent(re(Pe))+k;return Array.isArray(S[Pe])?S[Pe].map(function(He){return De+encodeURIComponent(re(He))}).join(A):De+encodeURIComponent(re(S[Pe]))}).join(A):le?encodeURIComponent(re(le))+k+encodeURIComponent(re(S)):""},_e=we(function(S,A){A.decode=A.parse=Ie,A.encode=A.stringify=oe}),Re=_i,ke=ri,Be=_n,at=xn,wt=ht;function ht(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var _t=/^([a-z0-9.+-]+:)/i,St=/:[0-9]*$/,Ct=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,vt=["<",">",'"',"`"," ","\r",`
`,"	"],ct=["{","}","|","\\","^","`"].concat(vt),Dt=["'"].concat(ct),fr=["%","/","?",";","#"].concat(Dt),er=["/","?","#"],dr=255,zr=/^[+a-z0-9A-Z_-]{0,63}$/,Ut=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,on={javascript:!0,"javascript:":!0},tn={javascript:!0,"javascript:":!0},Ln={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function _i(S,A,k){if(S&&ot.isObject(S)&&S instanceof ht)return S;var le=new ht;return le.parse(S,A,k),le}ht.prototype.parse=function(S,A,k){if(!ot.isString(S))throw new TypeError("Parameter 'url' must be a string, not "+typeof S);var le=S.indexOf("?"),Pe=le!==-1&&le<S.indexOf("#")?"?":"#",De=S.split(Pe),He=/\\/g;De[0]=De[0].replace(He,"/"),S=De.join(Pe);var nt=S;if(nt=nt.trim(),!k&&S.split("#").length===1){var Tt=Ct.exec(nt);if(Tt)return this.path=nt,this.href=nt,this.pathname=Tt[1],Tt[2]?(this.search=Tt[2],A?this.query=_e.parse(this.search.substr(1)):this.query=this.search.substr(1)):A&&(this.search="",this.query={}),this}var At=_t.exec(nt);if(At){At=At[0];var Ht=At.toLowerCase();this.protocol=Ht,nt=nt.substr(At.length)}if(k||At||nt.match(/^\/\/[^@\/]+@[^@\/]+/)){var Wt=nt.substr(0,2)==="//";Wt&&!(At&&tn[At])&&(nt=nt.substr(2),this.slashes=!0)}if(!tn[At]&&(Wt||At&&!Ln[At])){for(var yr=-1,br=0;br<er.length;br++){var Wr=nt.indexOf(er[br]);Wr!==-1&&(yr===-1||Wr<yr)&&(yr=Wr)}var vr,rn;yr===-1?rn=nt.lastIndexOf("@"):rn=nt.lastIndexOf("@",yr),rn!==-1&&(vr=nt.slice(0,rn),nt=nt.slice(rn+1),this.auth=decodeURIComponent(vr)),yr=-1;for(var br=0;br<fr.length;br++){var Wr=nt.indexOf(fr[br]);Wr!==-1&&(yr===-1||Wr<yr)&&(yr=Wr)}yr===-1&&(yr=nt.length),this.host=nt.slice(0,yr),nt=nt.slice(yr),this.parseHost(),this.hostname=this.hostname||"";var Yr=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!Yr)for(var $t=this.hostname.split(/\./),br=0,Mr=$t.length;br<Mr;br++){var Nr=$t[br];if(!!Nr&&!Nr.match(zr)){for(var an="",fn=0,Hn=Nr.length;fn<Hn;fn++)Nr.charCodeAt(fn)>127?an+="x":an+=Nr[fn];if(!an.match(zr)){var na=$t.slice(0,br),ai=$t.slice(br+1),ws=Nr.match(Ut);ws&&(na.push(ws[1]),ai.unshift(ws[2])),ai.length&&(nt="/"+ai.join(".")+nt),this.hostname=na.join(".");break}}}this.hostname.length>dr?this.hostname="":this.hostname=this.hostname.toLowerCase(),Yr||(this.hostname=lt.toASCII(this.hostname));var Uo=this.port?":"+this.port:"",Au=this.hostname||"";this.host=Au+Uo,this.href+=this.host,Yr&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),nt[0]!=="/"&&(nt="/"+nt))}if(!on[Ht])for(var br=0,Mr=Dt.length;br<Mr;br++){var mo=Dt[br];if(nt.indexOf(mo)!==-1){var Ni=encodeURIComponent(mo);Ni===mo&&(Ni=escape(mo)),nt=nt.split(mo).join(Ni)}}var ba=nt.indexOf("#");ba!==-1&&(this.hash=nt.substr(ba),nt=nt.slice(0,ba));var Ms=nt.indexOf("?");if(Ms!==-1?(this.search=nt.substr(Ms),this.query=nt.substr(Ms+1),A&&(this.query=_e.parse(this.query)),nt=nt.slice(0,Ms)):A&&(this.search="",this.query={}),nt&&(this.pathname=nt),Ln[Ht]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var Uo=this.pathname||"",vo=this.search||"";this.path=Uo+vo}return this.href=this.format(),this};function xn(S){return ot.isString(S)&&(S=_i(S)),S instanceof ht?S.format():ht.prototype.format.call(S)}ht.prototype.format=function(){var S=this.auth||"";S&&(S=encodeURIComponent(S),S=S.replace(/%3A/i,":"),S+="@");var A=this.protocol||"",k=this.pathname||"",le=this.hash||"",Pe=!1,De="";this.host?Pe=S+this.host:this.hostname&&(Pe=S+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(Pe+=":"+this.port)),this.query&&ot.isObject(this.query)&&Object.keys(this.query).length&&(De=_e.stringify(this.query));var He=this.search||De&&"?"+De||"";return A&&A.substr(-1)!==":"&&(A+=":"),this.slashes||(!A||Ln[A])&&Pe!==!1?(Pe="//"+(Pe||""),k&&k.charAt(0)!=="/"&&(k="/"+k)):Pe||(Pe=""),le&&le.charAt(0)!=="#"&&(le="#"+le),He&&He.charAt(0)!=="?"&&(He="?"+He),k=k.replace(/[?#]/g,function(nt){return encodeURIComponent(nt)}),He=He.replace("#","%23"),A+Pe+k+He+le};function ri(S,A){return _i(S,!1,!0).resolve(A)}ht.prototype.resolve=function(S){return this.resolveObject(_i(S,!1,!0)).format()};function _n(S,A){return S?_i(S,!1,!0).resolveObject(A):A}ht.prototype.resolveObject=function(S){if(ot.isString(S)){var A=new ht;A.parse(S,!1,!0),S=A}for(var k=new ht,le=Object.keys(this),Pe=0;Pe<le.length;Pe++){var De=le[Pe];k[De]=this[De]}if(k.hash=S.hash,S.href==="")return k.href=k.format(),k;if(S.slashes&&!S.protocol){for(var He=Object.keys(S),nt=0;nt<He.length;nt++){var Tt=He[nt];Tt!=="protocol"&&(k[Tt]=S[Tt])}return Ln[k.protocol]&&k.hostname&&!k.pathname&&(k.path=k.pathname="/"),k.href=k.format(),k}if(S.protocol&&S.protocol!==k.protocol){if(!Ln[S.protocol]){for(var At=Object.keys(S),Ht=0;Ht<At.length;Ht++){var Wt=At[Ht];k[Wt]=S[Wt]}return k.href=k.format(),k}if(k.protocol=S.protocol,!S.host&&!tn[S.protocol]){for(var Mr=(S.pathname||"").split("/");Mr.length&&!(S.host=Mr.shift()););S.host||(S.host=""),S.hostname||(S.hostname=""),Mr[0]!==""&&Mr.unshift(""),Mr.length<2&&Mr.unshift(""),k.pathname=Mr.join("/")}else k.pathname=S.pathname;if(k.search=S.search,k.query=S.query,k.host=S.host||"",k.auth=S.auth,k.hostname=S.hostname||S.host,k.port=S.port,k.pathname||k.search){var yr=k.pathname||"",br=k.search||"";k.path=yr+br}return k.slashes=k.slashes||S.slashes,k.href=k.format(),k}var Wr=k.pathname&&k.pathname.charAt(0)==="/",vr=S.host||S.pathname&&S.pathname.charAt(0)==="/",rn=vr||Wr||k.host&&S.pathname,Yr=rn,$t=k.pathname&&k.pathname.split("/")||[],Mr=S.pathname&&S.pathname.split("/")||[],Nr=k.protocol&&!Ln[k.protocol];if(Nr&&(k.hostname="",k.port=null,k.host&&($t[0]===""?$t[0]=k.host:$t.unshift(k.host)),k.host="",S.protocol&&(S.hostname=null,S.port=null,S.host&&(Mr[0]===""?Mr[0]=S.host:Mr.unshift(S.host)),S.host=null),rn=rn&&(Mr[0]===""||$t[0]==="")),vr)k.host=S.host||S.host===""?S.host:k.host,k.hostname=S.hostname||S.hostname===""?S.hostname:k.hostname,k.search=S.search,k.query=S.query,$t=Mr;else if(Mr.length)$t||($t=[]),$t.pop(),$t=$t.concat(Mr),k.search=S.search,k.query=S.query;else if(!ot.isNullOrUndefined(S.search)){if(Nr){k.hostname=k.host=$t.shift();var an=k.host&&k.host.indexOf("@")>0?k.host.split("@"):!1;an&&(k.auth=an.shift(),k.host=k.hostname=an.shift())}return k.search=S.search,k.query=S.query,(!ot.isNull(k.pathname)||!ot.isNull(k.search))&&(k.path=(k.pathname?k.pathname:"")+(k.search?k.search:"")),k.href=k.format(),k}if(!$t.length)return k.pathname=null,k.search?k.path="/"+k.search:k.path=null,k.href=k.format(),k;for(var fn=$t.slice(-1)[0],Hn=(k.host||S.host||$t.length>1)&&(fn==="."||fn==="..")||fn==="",na=0,ai=$t.length;ai>=0;ai--)fn=$t[ai],fn==="."?$t.splice(ai,1):fn===".."?($t.splice(ai,1),na++):na&&($t.splice(ai,1),na--);if(!rn&&!Yr)for(;na--;na)$t.unshift("..");rn&&$t[0]!==""&&(!$t[0]||$t[0].charAt(0)!=="/")&&$t.unshift(""),Hn&&$t.join("/").substr(-1)!=="/"&&$t.push("");var ws=$t[0]===""||$t[0]&&$t[0].charAt(0)==="/";if(Nr){k.hostname=k.host=ws?"":$t.length?$t.shift():"";var an=k.host&&k.host.indexOf("@")>0?k.host.split("@"):!1;an&&(k.auth=an.shift(),k.host=k.hostname=an.shift())}return rn=rn||k.host&&$t.length,rn&&!ws&&$t.unshift(""),$t.length?k.pathname=$t.join("/"):(k.pathname=null,k.path=null),(!ot.isNull(k.pathname)||!ot.isNull(k.search))&&(k.path=(k.pathname?k.pathname:"")+(k.search?k.search:"")),k.auth=S.auth||k.auth,k.slashes=k.slashes||S.slashes,k.href=k.format(),k},ht.prototype.parseHost=function(){var S=this.host,A=St.exec(S);A&&(A=A[0],A!==":"&&(this.port=A.substr(1)),S=S.substr(0,S.length-A.length)),S&&(this.hostname=S)};var ta={parse:Re,resolve:ke,resolveObject:Be,format:at,Url:wt};function ji(S){for(let A=0;A<Ze.layout.length;A++)for(const k in Ze[Ze.layout[A]])if(k===S)return Ze[Ze.layout[A]][k];for(let A=0;A<Ze.paint.length;A++)for(const k in Ze[Ze.paint[A]])if(k===S)return Ze[Ze.paint[A]][k];return null}function ss(S,A){for(const k in S.sources)A(S.sources[k])}function Ii(S,A){for(const k of S.layers)A(k)}function Ha(S,A,k){function le(Pe,De){const He=Pe[De];!He||Object.keys(He).forEach(nt=>{k({path:[Pe.id,De,nt],key:nt,value:He[nt],reference:ji(nt),set(Tt){He[nt]=Tt}})})}Ii(S,Pe=>{A.paint&&le(Pe,"paint"),A.layout&&le(Pe,"layout")})}function to(S,A){for(const k in S)k.indexOf("layout")===0&&A(S[k],k)}function Ou(S,A){for(const k in S)k.indexOf("paint")===0&&A(S[k],k)}function ms(S,A){return typeof A=="string"&&A[0]==="@"?ms(S,S.constants[A]):A}function Us(S){return Array.isArray(S.stops)}function Ka(S,A,k){S[k]=S[A],delete S[A]}function Fu(S){S.version=8,ss(S,De=>{De.type==="video"&&De.url!==void 0&&Ka(De,"url","urls"),De.type==="video"&&De.coordinates.forEach(He=>He.reverse())}),Ii(S,De=>{to(De,He=>{He["symbol-min-distance"]!==void 0&&Ka(He,"symbol-min-distance","symbol-spacing")}),Ou(De,He=>{He["background-image"]!==void 0&&Ka(He,"background-image","background-pattern"),He["line-image"]!==void 0&&Ka(He,"line-image","line-pattern"),He["fill-image"]!==void 0&&Ka(He,"fill-image","fill-pattern")})}),Ha(S,{paint:!0,layout:!0},De=>{const He=ms(S,De.value);Us(He)&&He.stops.forEach(nt=>{nt[1]=ms(S,nt[1])}),De.set(He)}),delete S.constants,Ii(S,De=>{to(De,He=>{delete He["text-max-size"],delete He["icon-max-size"]}),Ou(De,He=>{He["text-size"]&&(De.layout||(De.layout={}),De.layout["text-size"]=He["text-size"],delete He["text-size"]),He["icon-size"]&&(De.layout||(De.layout={}),De.layout["icon-size"]=He["icon-size"],delete He["icon-size"])})});function A(De){const He=ta.parse(De),nt=He.pathname.split("/");if(He.protocol!=="mapbox:")return De;if(He.hostname==="fontstack")return"mapbox://fonts/mapbox/{fontstack}/{range}.pbf";if(He.hostname==="fonts")return`mapbox://fonts/${nt[2]}/{fontstack}/{range}.pbf`}S.glyphs&&(S.glyphs=A(S.glyphs));function k(De){function He(nt){return nt.split(",").map(Tt=>Tt.trim())}if(Array.isArray(De))return De;if(typeof De=="string")return He(De);if(typeof De=="object")return De.stops.forEach(nt=>{nt[1]=He(nt[1])}),De;throw new Error("unexpected font value")}Ii(S,De=>{to(De,He=>{He["text-font"]&&(He["text-font"]=k(He["text-font"]))})});let le=0;for(let De=S.layers.length-1;De>=0;De--)if(S.layers[De].type!=="symbol"){le=De+1;break}const Pe=S.layers.splice(le);return Pe.reverse(),S.layers=S.layers.concat(Pe),S}function vs(S,...A){for(const k of A)for(const le in k)S[le]=k[le];return S}class gs extends Error{constructor(A,k){super(k),this.message=k,this.key=A}}var la=gs;class ou{constructor(A,k=[]){this.parent=A,this.bindings={};for(const[le,Pe]of k)this.bindings[le]=Pe}concat(A){return new ou(this,A)}get(A){if(this.bindings[A])return this.bindings[A];if(this.parent)return this.parent.get(A);throw new Error(`${A} not found in scope.`)}has(A){return this.bindings[A]?!0:this.parent?this.parent.has(A):!1}}var ml=ou;const qa={kind:"null"},wr={kind:"number"},bn={kind:"string"},Rn={kind:"boolean"},Xa={kind:"color"},Hi={kind:"object"},Tn={kind:"value"},Ec={kind:"error"},Iu={kind:"collator"},ku={kind:"formatted"},ro={kind:"resolvedImage"};function es(S,A){return{kind:"array",itemType:S,N:A}}function Pi(S){if(S.kind==="array"){const A=Pi(S.itemType);return typeof S.N=="number"?`array<${A}, ${S.N}>`:S.itemType.kind==="value"?"array":`array<${A}>`}else return S.kind}const zf=[qa,wr,bn,Rn,Xa,ku,Hi,es(Tn),ro];function zs(S,A){if(A.kind==="error")return null;if(S.kind==="array"){if(A.kind==="array"&&(A.N===0&&A.itemType.kind==="value"||!zs(S.itemType,A.itemType))&&(typeof S.N!="number"||S.N===A.N))return null}else{if(S.kind===A.kind)return null;if(S.kind==="value"){for(const k of zf)if(!zs(k,A))return null}}return`Expected ${Pi(S)} but found ${Pi(A)} instead.`}function vl(S,A){return A.some(k=>k.kind===S.kind)}function uu(S,A){return A.some(k=>k==="null"?S===null:k==="array"?Array.isArray(S):k==="object"?S&&!Array.isArray(S)&&typeof S=="object":k===typeof S)}var Gf=we(function(S,A){var k={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function le(At){return At=Math.round(At),At<0?0:At>255?255:At}function Pe(At){return At<0?0:At>1?1:At}function De(At){return At[At.length-1]==="%"?le(parseFloat(At)/100*255):le(parseInt(At))}function He(At){return At[At.length-1]==="%"?Pe(parseFloat(At)/100):Pe(parseFloat(At))}function nt(At,Ht,Wt){return Wt<0?Wt+=1:Wt>1&&(Wt-=1),Wt*6<1?At+(Ht-At)*Wt*6:Wt*2<1?Ht:Wt*3<2?At+(Ht-At)*(2/3-Wt)*6:At}function Tt(At){var Ht=At.replace(/ /g,"").toLowerCase();if(Ht in k)return k[Ht].slice();if(Ht[0]==="#"){if(Ht.length===4){var Wt=parseInt(Ht.substr(1),16);return Wt>=0&&Wt<=4095?[(Wt&3840)>>4|(Wt&3840)>>8,Wt&240|(Wt&240)>>4,Wt&15|(Wt&15)<<4,1]:null}else if(Ht.length===7){var Wt=parseInt(Ht.substr(1),16);return Wt>=0&&Wt<=16777215?[(Wt&16711680)>>16,(Wt&65280)>>8,Wt&255,1]:null}return null}var yr=Ht.indexOf("("),br=Ht.indexOf(")");if(yr!==-1&&br+1===Ht.length){var Wr=Ht.substr(0,yr),vr=Ht.substr(yr+1,br-(yr+1)).split(","),rn=1;switch(Wr){case"rgba":if(vr.length!==4)return null;rn=He(vr.pop());case"rgb":return vr.length!==3?null:[De(vr[0]),De(vr[1]),De(vr[2]),rn];case"hsla":if(vr.length!==4)return null;rn=He(vr.pop());case"hsl":if(vr.length!==3)return null;var Yr=(parseFloat(vr[0])%360+360)%360/360,$t=He(vr[1]),Mr=He(vr[2]),Nr=Mr<=.5?Mr*($t+1):Mr+$t-Mr*$t,an=Mr*2-Nr;return[le(nt(an,Nr,Yr+1/3)*255),le(nt(an,Nr,Yr)*255),le(nt(an,Nr,Yr-1/3)*255),rn];default:return null}}return null}try{A.parseCSSColor=Tt}catch{}});class Fa{constructor(A,k,le,Pe=1){this.r=A,this.g=k,this.b=le,this.a=Pe}static parse(A){if(!A)return;if(A instanceof Fa)return A;if(typeof A!="string")return;const k=Gf.parseCSSColor(A);if(!!k)return new Fa(k[0]/255*k[3],k[1]/255*k[3],k[2]/255*k[3],k[3])}toString(){const[A,k,le,Pe]=this.toArray();return`rgba(${Math.round(A)},${Math.round(k)},${Math.round(le)},${Pe})`}toArray(){const{r:A,g:k,b:le,a:Pe}=this;return Pe===0?[0,0,0,0]:[A*255/Pe,k*255/Pe,le*255/Pe,Pe]}toArray01(){const{r:A,g:k,b:le,a:Pe}=this;return Pe===0?[0,0,0,0]:[A/Pe,k/Pe,le/Pe,Pe]}toArray01PremultipliedAlpha(){const{r:A,g:k,b:le,a:Pe}=this;return[A,k,le,Pe]}}Fa.black=new Fa(0,0,0,1),Fa.white=new Fa(1,1,1,1),Fa.transparent=new Fa(0,0,0,0),Fa.red=new Fa(1,0,0,1),Fa.blue=new Fa(0,0,1,1);var ca=Fa;class lu{constructor(A,k,le){A?this.sensitivity=k?"variant":"case":this.sensitivity=k?"accent":"base",this.locale=le,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(A,k){return this.collator.compare(A,k)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class cu{constructor(A,k,le,Pe,De){this.text=A.normalize?A.normalize():A,this.image=k,this.scale=le,this.fontStack=Pe,this.textColor=De}}class ts{constructor(A){this.sections=A}static fromString(A){return new ts([new cu(A,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(A=>A.text.length!==0||A.image&&A.image.name.length!==0)}static factory(A){return A instanceof ts?A:ts.fromString(A)}toString(){return this.sections.length===0?"":this.sections.map(A=>A.text).join("")}serialize(){const A=["format"];for(const k of this.sections){if(k.image){A.push(["image",k.image.name]);continue}A.push(k.text);const le={};k.fontStack&&(le["text-font"]=["literal",k.fontStack.split(",")]),k.scale&&(le["font-scale"]=k.scale),k.textColor&&(le["text-color"]=["rgba"].concat(k.textColor.toArray())),A.push(le)}return A}}class fa{constructor(A){this.name=A.name,this.available=A.available}toString(){return this.name}static fromString(A){return A?new fa({name:A,available:!1}):null}serialize(){return["image",this.name]}}function bo(S,A,k,le){return typeof S=="number"&&S>=0&&S<=255&&typeof A=="number"&&A>=0&&A<=255&&typeof k=="number"&&k>=0&&k<=255?typeof le>"u"||typeof le=="number"&&le>=0&&le<=1?null:`Invalid rgba value [${[S,A,k,le].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof le=="number"?[S,A,k,le]:[S,A,k]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Eo(S){if(S===null)return!0;if(typeof S=="string")return!0;if(typeof S=="boolean")return!0;if(typeof S=="number")return!0;if(S instanceof ca)return!0;if(S instanceof lu)return!0;if(S instanceof ts)return!0;if(S instanceof fa)return!0;if(Array.isArray(S)){for(const A of S)if(!Eo(A))return!1;return!0}else if(typeof S=="object"){for(const A in S)if(!Eo(S[A]))return!1;return!0}else return!1}function ki(S){if(S===null)return qa;if(typeof S=="string")return bn;if(typeof S=="boolean")return Rn;if(typeof S=="number")return wr;if(S instanceof ca)return Xa;if(S instanceof lu)return Iu;if(S instanceof ts)return ku;if(S instanceof fa)return ro;if(Array.isArray(S)){const A=S.length;let k;for(const le of S){const Pe=ki(le);if(!k)k=Pe;else{if(k===Pe)continue;k=Tn;break}}return es(k||Tn,A)}else return Hi}function fu(S){const A=typeof S;return S===null?"":A==="string"||A==="number"||A==="boolean"?String(S):S instanceof ca||S instanceof ts||S instanceof fa?S.toString():JSON.stringify(S)}class Tc{constructor(A,k){this.type=A,this.value=k}static parse(A,k){if(A.length!==2)return k.error(`'literal' expression requires exactly one argument, but found ${A.length-1} instead.`);if(!Eo(A[1]))return k.error("invalid value");const le=A[1];let Pe=ki(le);const De=k.expectedType;return Pe.kind==="array"&&Pe.N===0&&De&&De.kind==="array"&&(typeof De.N!="number"||De.N===0)&&(Pe=De),new Tc(Pe,le)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ca?["rgba"].concat(this.value.toArray()):this.value instanceof ts?this.value.serialize():this.value}}var ys=Tc;class B0{constructor(A){this.name="ExpressionEvaluationError",this.message=A}toJSON(){return this.message}}var fi=B0;const xi={string:bn,number:wr,boolean:Rn,object:Hi};class Sc{constructor(A,k){this.type=A,this.args=k}static parse(A,k){if(A.length<2)return k.error("Expected at least one argument.");let le=1,Pe;const De=A[0];if(De==="array"){let nt;if(A.length>2){const At=A[1];if(typeof At!="string"||!(At in xi)||At==="object")return k.error('The item type argument of "array" must be one of string, number, boolean',1);nt=xi[At],le++}else nt=Tn;let Tt;if(A.length>3){if(A[2]!==null&&(typeof A[2]!="number"||A[2]<0||A[2]!==Math.floor(A[2])))return k.error('The length argument to "array" must be a positive integer literal',2);Tt=A[2],le++}Pe=es(nt,Tt)}else Pe=xi[De];const He=[];for(;le<A.length;le++){const nt=k.parse(A[le],le,Tn);if(!nt)return null;He.push(nt)}return new Sc(Pe,He)}evaluate(A){for(let k=0;k<this.args.length;k++){const le=this.args[k].evaluate(A);if(zs(this.type,ki(le))){if(k===this.args.length-1)throw new fi(`Expected value to be of type ${Pi(this.type)}, but found ${Pi(ki(le))} instead.`)}else return le}return null}eachChild(A){this.args.forEach(A)}outputDefined(){return this.args.every(A=>A.outputDefined())}serialize(){const A=this.type,k=[A.kind];if(A.kind==="array"){const le=A.itemType;if(le.kind==="string"||le.kind==="number"||le.kind==="boolean"){k.push(le.kind);const Pe=A.N;(typeof Pe=="number"||this.args.length>1)&&k.push(Pe)}}return k.concat(this.args.map(le=>le.serialize()))}}var _s=Sc;class Gs{constructor(A){this.type=ku,this.sections=A}static parse(A,k){if(A.length<2)return k.error("Expected at least one argument.");const le=A[1];if(!Array.isArray(le)&&typeof le=="object")return k.error("First argument must be an image or text section.");const Pe=[];let De=!1;for(let He=1;He<=A.length-1;++He){const nt=A[He];if(De&&typeof nt=="object"&&!Array.isArray(nt)){De=!1;let Tt=null;if(nt["font-scale"]&&(Tt=k.parse(nt["font-scale"],1,wr),!Tt))return null;let At=null;if(nt["text-font"]&&(At=k.parse(nt["text-font"],1,es(bn)),!At))return null;let Ht=null;if(nt["text-color"]&&(Ht=k.parse(nt["text-color"],1,Xa),!Ht))return null;const Wt=Pe[Pe.length-1];Wt.scale=Tt,Wt.font=At,Wt.textColor=Ht}else{const Tt=k.parse(A[He],1,Tn);if(!Tt)return null;const At=Tt.type.kind;if(At!=="string"&&At!=="value"&&At!=="null"&&At!=="resolvedImage")return k.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");De=!0,Pe.push({content:Tt,scale:null,font:null,textColor:null})}}return new Gs(Pe)}evaluate(A){const k=le=>{const Pe=le.content.evaluate(A);return ki(Pe)===ro?new cu("",Pe,null,null,null):new cu(fu(Pe),null,le.scale?le.scale.evaluate(A):null,le.font?le.font.evaluate(A).join(","):null,le.textColor?le.textColor.evaluate(A):null)};return new ts(this.sections.map(k))}eachChild(A){for(const k of this.sections)A(k.content),k.scale&&A(k.scale),k.font&&A(k.font),k.textColor&&A(k.textColor)}outputDefined(){return!1}serialize(){const A=["format"];for(const k of this.sections){A.push(k.content.serialize());const le={};k.scale&&(le["font-scale"]=k.scale.serialize()),k.font&&(le["text-font"]=k.font.serialize()),k.textColor&&(le["text-color"]=k.textColor.serialize()),A.push(le)}return A}}class Du{constructor(A){this.type=ro,this.input=A}static parse(A,k){if(A.length!==2)return k.error("Expected two arguments.");const le=k.parse(A[1],1,bn);return le?new Du(le):k.error("No image name provided.")}evaluate(A){const k=this.input.evaluate(A),le=fa.fromString(k);return le&&A.availableImages&&(le.available=A.availableImages.indexOf(k)>-1),le}eachChild(A){A(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const sd={"to-boolean":Rn,"to-color":Xa,"to-number":wr,"to-string":bn};class Nu{constructor(A,k){this.type=A,this.args=k}static parse(A,k){if(A.length<2)return k.error("Expected at least one argument.");const le=A[0];if((le==="to-boolean"||le==="to-string")&&A.length!==2)return k.error("Expected one argument.");const Pe=sd[le],De=[];for(let He=1;He<A.length;He++){const nt=k.parse(A[He],He,Tn);if(!nt)return null;De.push(nt)}return new Nu(Pe,De)}evaluate(A){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(A));if(this.type.kind==="color"){let k,le;for(const Pe of this.args){if(k=Pe.evaluate(A),le=null,k instanceof ca)return k;if(typeof k=="string"){const De=A.parseColor(k);if(De)return De}else if(Array.isArray(k)&&(k.length<3||k.length>4?le=`Invalid rbga value ${JSON.stringify(k)}: expected an array containing either three or four numeric values.`:le=bo(k[0],k[1],k[2],k[3]),!le))return new ca(k[0]/255,k[1]/255,k[2]/255,k[3])}throw new fi(le||`Could not parse color from value '${typeof k=="string"?k:String(JSON.stringify(k))}'`)}else if(this.type.kind==="number"){let k=null;for(const le of this.args){if(k=le.evaluate(A),k===null)return 0;const Pe=Number(k);if(!isNaN(Pe))return Pe}throw new fi(`Could not convert ${JSON.stringify(k)} to number.`)}else return this.type.kind==="formatted"?ts.fromString(fu(this.args[0].evaluate(A))):this.type.kind==="resolvedImage"?fa.fromString(fu(this.args[0].evaluate(A))):fu(this.args[0].evaluate(A))}eachChild(A){this.args.forEach(A)}outputDefined(){return this.args.every(A=>A.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Gs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Du(this.args[0]).serialize();const A=[`to-${this.type.kind}`];return this.eachChild(k=>{A.push(k.serialize())}),A}}var Bu=Nu;const U0=["Unknown","Point","LineString","Polygon"];class z0{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?U0[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const A=this.featureDistanceData.center,k=this.featureDistanceData.scale,{x:le,y:Pe}=this.featureTileCoord,De=le*k-A[0],He=Pe*k-A[1],nt=this.featureDistanceData.bearing[0],Tt=this.featureDistanceData.bearing[1];return nt*De+Tt*He}return 0}parseColor(A){let k=this._parseColorCache[A];return k||(k=this._parseColorCache[A]=ca.parse(A)),k}}var Rc=z0;class Za{constructor(A,k,le,Pe){this.name=A,this.type=k,this._evaluate=le,this.args=Pe}evaluate(A){return this._evaluate(A,this.args)}eachChild(A){this.args.forEach(A)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(A=>A.serialize()))}static parse(A,k){const le=A[0],Pe=Za.definitions[le];if(!Pe)return k.error(`Unknown expression "${le}". If you wanted a literal array, use ["literal", [...]].`,0);const De=Array.isArray(Pe)?Pe[0]:Pe.type,He=Array.isArray(Pe)?[[Pe[1],Pe[2]]]:Pe.overloads,nt=He.filter(([At])=>!Array.isArray(At)||At.length===A.length-1);let Tt=null;for(const[At,Ht]of nt){Tt=new Hf(k.registry,k.path,null,k.scope);const Wt=[];let yr=!1;for(let br=1;br<A.length;br++){const Wr=A[br],vr=Array.isArray(At)?At[br-1]:At.type,rn=Tt.parse(Wr,1+Wt.length,vr);if(!rn){yr=!0;break}Wt.push(rn)}if(!yr){if(Array.isArray(At)&&At.length!==Wt.length){Tt.error(`Expected ${At.length} arguments, but found ${Wt.length} instead.`);continue}for(let br=0;br<Wt.length;br++){const Wr=Array.isArray(At)?At[br]:At.type,vr=Wt[br];Tt.concat(br+1).checkSubtype(Wr,vr.type)}if(Tt.errors.length===0)return new Za(le,De,Ht,Wt)}}if(nt.length===1)k.errors.push(...Tt.errors);else{const Ht=(nt.length?nt:He).map(([yr])=>od(yr)).join(" | "),Wt=[];for(let yr=1;yr<A.length;yr++){const br=k.parse(A[yr],1+Wt.length);if(!br)return null;Wt.push(Pi(br.type))}k.error(`Expected arguments of type ${Ht}, but found (${Wt.join(", ")}) instead.`)}return null}static register(A,k){Za.definitions=k;for(const le in k)A[le]=Za}}function od(S){return Array.isArray(S)?`(${S.map(Pi).join(", ")})`:`(${Pi(S.type)}...)`}var hu=Za;class Cc{constructor(A,k,le){this.type=Iu,this.locale=le,this.caseSensitive=A,this.diacriticSensitive=k}static parse(A,k){if(A.length!==2)return k.error("Expected one argument.");const le=A[1];if(typeof le!="object"||Array.isArray(le))return k.error("Collator options argument must be an object.");const Pe=k.parse(le["case-sensitive"]===void 0?!1:le["case-sensitive"],1,Rn);if(!Pe)return null;const De=k.parse(le["diacritic-sensitive"]===void 0?!1:le["diacritic-sensitive"],1,Rn);if(!De)return null;let He=null;return le.locale&&(He=k.parse(le.locale,1,bn),!He)?null:new Cc(Pe,De,He)}evaluate(A){return new lu(this.caseSensitive.evaluate(A),this.diacriticSensitive.evaluate(A),this.locale?this.locale.evaluate(A):null)}eachChild(A){A(this.caseSensitive),A(this.diacriticSensitive),this.locale&&A(this.locale)}outputDefined(){return!1}serialize(){const A={};return A["case-sensitive"]=this.caseSensitive.serialize(),A["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(A.locale=this.locale.serialize()),["collator",A]}}const To=8192;function gl(S,A){S[0]=Math.min(S[0],A[0]),S[1]=Math.min(S[1],A[1]),S[2]=Math.max(S[2],A[0]),S[3]=Math.max(S[3],A[1])}function G0(S){return(180+S)/360}function du(S){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+S*Math.PI/360)))/360}function Pc(S,A){return!(S[0]<=A[0]||S[2]>=A[2]||S[1]<=A[1]||S[3]>=A[3])}function ud(S,A){const k=G0(S[0]),le=du(S[1]),Pe=Math.pow(2,A.z);return[Math.round(k*Pe*To),Math.round(le*Pe*To)]}function Uu(S,A,k){const le=S[0]-A[0],Pe=S[1]-A[1],De=S[0]-k[0],He=S[1]-k[1];return le*He-De*Pe===0&&le*De<=0&&Pe*He<=0}function zu(S,A,k){return A[1]>S[1]!=k[1]>S[1]&&S[0]<(k[0]-A[0])*(S[1]-A[1])/(k[1]-A[1])+A[0]}function Vf(S,A){let k=!1;for(let le=0,Pe=A.length;le<Pe;le++){const De=A[le];for(let He=0,nt=De.length;He<nt-1;He++){if(Uu(S,De[He],De[He+1]))return!1;zu(S,De[He],De[He+1])&&(k=!k)}}return k}function V0(S,A){for(let k=0;k<A.length;k++)if(Vf(S,A[k]))return!0;return!1}function W0(S,A){return S[0]*A[1]-S[1]*A[0]}function ld(S,A,k,le){const Pe=S[0]-k[0],De=S[1]-k[1],He=A[0]-k[0],nt=A[1]-k[1],Tt=le[0]-k[0],At=le[1]-k[1],Ht=Pe*At-Tt*De,Wt=He*At-Tt*nt;return Ht>0&&Wt<0||Ht<0&&Wt>0}function H0(S,A,k,le){const Pe=[A[0]-S[0],A[1]-S[1]],De=[le[0]-k[0],le[1]-k[1]];return W0(De,Pe)===0?!1:!!(ld(S,A,k,le)&&ld(k,le,S,A))}function q0(S,A,k){for(const le of k)for(let Pe=0;Pe<le.length-1;++Pe)if(H0(S,A,le[Pe],le[Pe+1]))return!0;return!1}function cd(S,A){for(let k=0;k<S.length;++k)if(!Vf(S[k],A))return!1;for(let k=0;k<S.length-1;++k)if(q0(S[k],S[k+1],A))return!1;return!0}function X0(S,A){for(let k=0;k<A.length;k++)if(cd(S,A[k]))return!0;return!1}function yl(S,A,k){const le=[];for(let Pe=0;Pe<S.length;Pe++){const De=[];for(let He=0;He<S[Pe].length;He++){const nt=ud(S[Pe][He],k);gl(A,nt),De.push(nt)}le.push(De)}return le}function _l(S,A,k){const le=[];for(let Pe=0;Pe<S.length;Pe++){const De=yl(S[Pe],A,k);le.push(De)}return le}function Vs(S,A,k,le){if(S[0]<k[0]||S[0]>k[2]){const Pe=le*.5;let De=S[0]-k[0]>Pe?-le:k[0]-S[0]>Pe?le:0;De===0&&(De=S[0]-k[2]>Pe?-le:k[2]-S[0]>Pe?le:0),S[0]+=De}gl(A,S)}function Ea(S){S[0]=S[1]=1/0,S[2]=S[3]=-1/0}function xl(S,A,k,le){const Pe=Math.pow(2,le.z)*To,De=[le.x*To,le.y*To],He=[];if(!S)return He;for(const nt of S)for(const Tt of nt){const At=[Tt.x+De[0],Tt.y+De[1]];Vs(At,A,k,Pe),He.push(At)}return He}function ja(S,A,k,le){const Pe=Math.pow(2,le.z)*To,De=[le.x*To,le.y*To],He=[];if(!S)return He;for(const nt of S){const Tt=[];for(const At of nt){const Ht=[At.x+De[0],At.y+De[1]];gl(A,Ht),Tt.push(Ht)}He.push(Tt)}if(A[2]-A[0]<=Pe/2){Ea(A);for(const nt of He)for(const Tt of nt)Vs(Tt,A,k,Pe)}return He}function Al(S,A){const k=[1/0,1/0,-1/0,-1/0],le=[1/0,1/0,-1/0,-1/0],Pe=S.canonicalID();if(!Pe)return!1;if(A.type==="Polygon"){const De=yl(A.coordinates,le,Pe),He=xl(S.geometry(),k,le,Pe);if(!Pc(k,le))return!1;for(const nt of He)if(!Vf(nt,De))return!1}if(A.type==="MultiPolygon"){const De=_l(A.coordinates,le,Pe),He=xl(S.geometry(),k,le,Pe);if(!Pc(k,le))return!1;for(const nt of He)if(!V0(nt,De))return!1}return!0}function os(S,A){const k=[1/0,1/0,-1/0,-1/0],le=[1/0,1/0,-1/0,-1/0],Pe=S.canonicalID();if(!Pe)return!1;if(A.type==="Polygon"){const De=yl(A.coordinates,le,Pe),He=ja(S.geometry(),k,le,Pe);if(!Pc(k,le))return!1;for(const nt of He)if(!cd(nt,De))return!1}if(A.type==="MultiPolygon"){const De=_l(A.coordinates,le,Pe),He=ja(S.geometry(),k,le,Pe);if(!Pc(k,le))return!1;for(const nt of He)if(!X0(nt,De))return!1}return!0}class un{constructor(A,k){this.type=Rn,this.geojson=A,this.geometries=k}static parse(A,k){if(A.length!==2)return k.error(`'within' expression requires exactly one argument, but found ${A.length-1} instead.`);if(Eo(A[1])){const le=A[1];if(le.type==="FeatureCollection")for(let Pe=0;Pe<le.features.length;++Pe){const De=le.features[Pe].geometry.type;if(De==="Polygon"||De==="MultiPolygon")return new un(le,le.features[Pe].geometry)}else if(le.type==="Feature"){const Pe=le.geometry.type;if(Pe==="Polygon"||Pe==="MultiPolygon")return new un(le,le.geometry)}else if(le.type==="Polygon"||le.type==="MultiPolygon")return new un(le,le)}return k.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(A){if(A.geometry()!=null&&A.canonicalID()!=null){if(A.geometryType()==="Point")return Al(A,this.geometries);if(A.geometryType()==="LineString")return os(A,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var no=un;function wl(S){if(S instanceof hu){if(S.name==="get"&&S.args.length===1)return!1;if(S.name==="feature-state")return!1;if(S.name==="has"&&S.args.length===1)return!1;if(S.name==="properties"||S.name==="geometry-type"||S.name==="id")return!1;if(/^filter-/.test(S.name))return!1}if(S instanceof no)return!1;let A=!0;return S.eachChild(k=>{A&&!wl(k)&&(A=!1)}),A}function Ps(S){if(S instanceof hu&&S.name==="feature-state")return!1;let A=!0;return S.eachChild(k=>{A&&!Ps(k)&&(A=!1)}),A}function Ws(S,A){if(S instanceof hu&&A.indexOf(S.name)>=0)return!1;let k=!0;return S.eachChild(le=>{k&&!Ws(le,A)&&(k=!1)}),k}class Wf{constructor(A,k){this.type=k.type,this.name=A,this.boundExpression=k}static parse(A,k){if(A.length!==2||typeof A[1]!="string")return k.error("'var' expression requires exactly one string literal argument.");const le=A[1];return k.scope.has(le)?new Wf(le,k.scope.get(le)):k.error(`Unknown variable "${le}". Make sure "${le}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(A){return this.boundExpression.evaluate(A)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var fd=Wf;class Ml{constructor(A,k=[],le,Pe=new ml,De=[]){this.registry=A,this.path=k,this.key=k.map(He=>`[${He}]`).join(""),this.scope=Pe,this.errors=De,this.expectedType=le}parse(A,k,le,Pe,De={}){return k?this.concat(k,le,Pe)._parse(A,De):this._parse(A,De)}_parse(A,k){(A===null||typeof A=="string"||typeof A=="boolean"||typeof A=="number")&&(A=["literal",A]);function le(Pe,De,He){return He==="assert"?new _s(De,[Pe]):He==="coerce"?new Bu(De,[Pe]):Pe}if(Array.isArray(A)){if(A.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const Pe=A[0];if(typeof Pe!="string")return this.error(`Expression name must be a string, but found ${typeof Pe} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const De=this.registry[Pe];if(De){let He=De.parse(A,this);if(!He)return null;if(this.expectedType){const nt=this.expectedType,Tt=He.type;if((nt.kind==="string"||nt.kind==="number"||nt.kind==="boolean"||nt.kind==="object"||nt.kind==="array")&&Tt.kind==="value")He=le(He,nt,k.typeAnnotation||"assert");else if((nt.kind==="color"||nt.kind==="formatted"||nt.kind==="resolvedImage")&&(Tt.kind==="value"||Tt.kind==="string"))He=le(He,nt,k.typeAnnotation||"coerce");else if(this.checkSubtype(nt,Tt))return null}if(!(He instanceof ys)&&He.type.kind!=="resolvedImage"&&Lc(He)){const nt=new Rc;try{He=new ys(He.type,He.evaluate(nt))}catch(Tt){return this.error(Tt.message),null}}return He}return this.error(`Unknown expression "${Pe}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof A>"u"?this.error("'undefined' value invalid. Use null instead."):typeof A=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof A} instead.`)}concat(A,k,le){const Pe=typeof A=="number"?this.path.concat(A):this.path,De=le?this.scope.concat(le):this.scope;return new Ml(this.registry,Pe,k||null,De,this.errors)}error(A,...k){const le=`${this.key}${k.map(Pe=>`[${Pe}]`).join("")}`;this.errors.push(new la(le,A))}checkSubtype(A,k){const le=zs(A,k);return le&&this.error(le),le}}var Hf=Ml;function Lc(S){if(S instanceof fd)return Lc(S.boundExpression);if(S instanceof hu&&S.name==="error")return!1;if(S instanceof Cc)return!1;if(S instanceof no)return!1;const A=S instanceof Bu||S instanceof _s;let k=!0;return S.eachChild(le=>{A?k=k&&Lc(le):k=k&&le instanceof ys}),k?wl(S)&&Ws(S,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]):!1}function bl(S,A){const k=S.length-1;let le=0,Pe=k,De=0,He,nt;for(;le<=Pe;)if(De=Math.floor((le+Pe)/2),He=S[De],nt=S[De+1],He<=A){if(De===k||A<nt)return De;le=De+1}else if(He>A)Pe=De-1;else throw new fi("Input is not a number.");return 0}class Gu{constructor(A,k,le){this.type=A,this.input=k,this.labels=[],this.outputs=[];for(const[Pe,De]of le)this.labels.push(Pe),this.outputs.push(De)}static parse(A,k){if(A.length-1<4)return k.error(`Expected at least 4 arguments, but found only ${A.length-1}.`);if((A.length-1)%2!==0)return k.error("Expected an even number of arguments.");const le=k.parse(A[1],1,wr);if(!le)return null;const Pe=[];let De=null;k.expectedType&&k.expectedType.kind!=="value"&&(De=k.expectedType);for(let He=1;He<A.length;He+=2){const nt=He===1?-1/0:A[He],Tt=A[He+1],At=He,Ht=He+1;if(typeof nt!="number")return k.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',At);if(Pe.length&&Pe[Pe.length-1][0]>=nt)return k.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',At);const Wt=k.parse(Tt,Ht,De);if(!Wt)return null;De=De||Wt.type,Pe.push([nt,Wt])}return new Gu(De,le,Pe)}evaluate(A){const k=this.labels,le=this.outputs;if(k.length===1)return le[0].evaluate(A);const Pe=this.input.evaluate(A);if(Pe<=k[0])return le[0].evaluate(A);const De=k.length;if(Pe>=k[De-1])return le[De-1].evaluate(A);const He=bl(k,Pe);return le[He].evaluate(A)}eachChild(A){A(this.input);for(const k of this.outputs)A(k)}outputDefined(){return this.outputs.every(A=>A.outputDefined())}serialize(){const A=["step",this.input.serialize()];for(let k=0;k<this.labels.length;k++)k>0&&A.push(this.labels[k]),A.push(this.outputs[k].serialize());return A}}var hd=Gu,qf=Ye;function Ye(S,A,k,le){this.cx=3*S,this.bx=3*(k-S)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*A,this.by=3*(le-A)-this.cy,this.ay=1-this.cy-this.by,this.p1x=S,this.p1y=le,this.p2x=k,this.p2y=le}Ye.prototype.sampleCurveX=function(S){return((this.ax*S+this.bx)*S+this.cx)*S},Ye.prototype.sampleCurveY=function(S){return((this.ay*S+this.by)*S+this.cy)*S},Ye.prototype.sampleCurveDerivativeX=function(S){return(3*this.ax*S+2*this.bx)*S+this.cx},Ye.prototype.solveCurveX=function(S,A){typeof A>"u"&&(A=1e-6);var k,le,Pe,De,He;for(Pe=S,He=0;He<8;He++){if(De=this.sampleCurveX(Pe)-S,Math.abs(De)<A)return Pe;var nt=this.sampleCurveDerivativeX(Pe);if(Math.abs(nt)<1e-6)break;Pe=Pe-De/nt}if(k=0,le=1,Pe=S,Pe<k)return k;if(Pe>le)return le;for(;k<le;){if(De=this.sampleCurveX(Pe),Math.abs(De-S)<A)return Pe;S>De?k=Pe:le=Pe,Pe=(le-k)*.5+k}return Pe},Ye.prototype.solve=function(S,A){return this.sampleCurveY(this.solveCurveX(S,A))};function qe(S,A,k){return S*(1-k)+A*k}function yt(S,A,k){return new ca(qe(S.r,A.r,k),qe(S.g,A.g,k),qe(S.b,A.b,k),qe(S.a,A.a,k))}function ie(S,A,k){return S.map((le,Pe)=>qe(le,A[Pe],k))}var zt=Object.freeze({__proto__:null,number:qe,color:yt,array:ie});const r=.95047,We=1,Yt=1.08883,Er=4/29,xr=6/29,Nt=3*xr*xr,$n=xr*xr*xr,Ai=Math.PI/180,ni=180/Math.PI;function qi(S){return S>$n?Math.pow(S,1/3):S/Nt+Er}function _a(S){return S>xr?S*S*S:Nt*(S-Er)}function xa(S){return 255*(S<=.0031308?12.92*S:1.055*Math.pow(S,1/2.4)-.055)}function Ls(S){return S/=255,S<=.04045?S/12.92:Math.pow((S+.055)/1.055,2.4)}function Or(S){const A=Ls(S.r),k=Ls(S.g),le=Ls(S.b),Pe=qi((.4124564*A+.3575761*k+.1804375*le)/r),De=qi((.2126729*A+.7151522*k+.072175*le)/We),He=qi((.0193339*A+.119192*k+.9503041*le)/Yt);return{l:116*De-16,a:500*(Pe-De),b:200*(De-He),alpha:S.a}}function Nn(S){let A=(S.l+16)/116,k=isNaN(S.a)?A:A+S.a/500,le=isNaN(S.b)?A:A-S.b/200;return A=We*_a(A),k=r*_a(k),le=Yt*_a(le),new ca(xa(3.2404542*k-1.5371385*A-.4985314*le),xa(-.969266*k+1.8760108*A+.041556*le),xa(.0556434*k-.2040259*A+1.0572252*le),S.alpha)}function Ia(S,A,k){return{l:qe(S.l,A.l,k),a:qe(S.a,A.a,k),b:qe(S.b,A.b,k),alpha:qe(S.alpha,A.alpha,k)}}function Ya(S){const{l:A,a:k,b:le}=Or(S),Pe=Math.atan2(le,k)*ni;return{h:Pe<0?Pe+360:Pe,c:Math.sqrt(k*k+le*le),l:A,alpha:S.a}}function Cn(S){const A=S.h*Ai,k=S.c,le=S.l;return Nn({l:le,a:Math.cos(A)*k,b:Math.sin(A)*k,alpha:S.alpha})}function ei(S,A,k){const le=A-S;return S+k*(le>180||le<-180?le-360*Math.round(le/360):le)}function cn(S,A,k){return{h:ei(S.h,A.h,k),c:qe(S.c,A.c,k),l:qe(S.l,A.l,k),alpha:qe(S.alpha,A.alpha,k)}}const Ta={forward:Or,reverse:Nn,interpolate:Ia},oi={forward:Ya,reverse:Cn,interpolate:cn};var El=Object.freeze({__proto__:null,lab:Ta,hcl:oi});class ha{constructor(A,k,le,Pe,De){this.type=A,this.operator=k,this.interpolation=le,this.input=Pe,this.labels=[],this.outputs=[];for(const[He,nt]of De)this.labels.push(He),this.outputs.push(nt)}static interpolationFactor(A,k,le,Pe){let De=0;if(A.name==="exponential")De=dt(k,A.base,le,Pe);else if(A.name==="linear")De=dt(k,1,le,Pe);else if(A.name==="cubic-bezier"){const He=A.controlPoints;De=new qf(He[0],He[1],He[2],He[3]).solve(dt(k,1,le,Pe))}return De}static parse(A,k){let[le,Pe,De,...He]=A;if(!Array.isArray(Pe)||Pe.length===0)return k.error("Expected an interpolation type expression.",1);if(Pe[0]==="linear")Pe={name:"linear"};else if(Pe[0]==="exponential"){const At=Pe[1];if(typeof At!="number")return k.error("Exponential interpolation requires a numeric base.",1,1);Pe={name:"exponential",base:At}}else if(Pe[0]==="cubic-bezier"){const At=Pe.slice(1);if(At.length!==4||At.some(Ht=>typeof Ht!="number"||Ht<0||Ht>1))return k.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);Pe={name:"cubic-bezier",controlPoints:At}}else return k.error(`Unknown interpolation type ${String(Pe[0])}`,1,0);if(A.length-1<4)return k.error(`Expected at least 4 arguments, but found only ${A.length-1}.`);if((A.length-1)%2!==0)return k.error("Expected an even number of arguments.");if(De=k.parse(De,2,wr),!De)return null;const nt=[];let Tt=null;le==="interpolate-hcl"||le==="interpolate-lab"?Tt=Xa:k.expectedType&&k.expectedType.kind!=="value"&&(Tt=k.expectedType);for(let At=0;At<He.length;At+=2){const Ht=He[At],Wt=He[At+1],yr=At+3,br=At+4;if(typeof Ht!="number")return k.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',yr);if(nt.length&&nt[nt.length-1][0]>=Ht)return k.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',yr);const Wr=k.parse(Wt,br,Tt);if(!Wr)return null;Tt=Tt||Wr.type,nt.push([Ht,Wr])}return Tt.kind!=="number"&&Tt.kind!=="color"&&!(Tt.kind==="array"&&Tt.itemType.kind==="number"&&typeof Tt.N=="number")?k.error(`Type ${Pi(Tt)} is not interpolatable.`):new ha(Tt,le,Pe,De,nt)}evaluate(A){const k=this.labels,le=this.outputs;if(k.length===1)return le[0].evaluate(A);const Pe=this.input.evaluate(A);if(Pe<=k[0])return le[0].evaluate(A);const De=k.length;if(Pe>=k[De-1])return le[De-1].evaluate(A);const He=bl(k,Pe),nt=k[He],Tt=k[He+1],At=ha.interpolationFactor(this.interpolation,Pe,nt,Tt),Ht=le[He].evaluate(A),Wt=le[He+1].evaluate(A);return this.operator==="interpolate"?zt[this.type.kind.toLowerCase()](Ht,Wt,At):this.operator==="interpolate-hcl"?oi.reverse(oi.interpolate(oi.forward(Ht),oi.forward(Wt),At)):Ta.reverse(Ta.interpolate(Ta.forward(Ht),Ta.forward(Wt),At))}eachChild(A){A(this.input);for(const k of this.outputs)A(k)}outputDefined(){return this.outputs.every(A=>A.outputDefined())}serialize(){let A;this.interpolation.name==="linear"?A=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?A=["linear"]:A=["exponential",this.interpolation.base]:A=["cubic-bezier"].concat(this.interpolation.controlPoints);const k=[this.operator,A,this.input.serialize()];for(let le=0;le<this.labels.length;le++)k.push(this.labels[le],this.outputs[le].serialize());return k}}function dt(S,A,k,le){const Pe=le-k,De=S-k;return Pe===0?0:A===1?De/Pe:(Math.pow(A,De)-1)/(Math.pow(A,Pe)-1)}var Hs=ha;class Tl{constructor(A,k){this.type=A,this.args=k}static parse(A,k){if(A.length<2)return k.error("Expectected at least one argument.");let le=null;const Pe=k.expectedType;Pe&&Pe.kind!=="value"&&(le=Pe);const De=[];for(const nt of A.slice(1)){const Tt=k.parse(nt,1+De.length,le,void 0,{typeAnnotation:"omit"});if(!Tt)return null;le=le||Tt.type,De.push(Tt)}return Pe&&De.some(nt=>zs(Pe,nt.type))?new Tl(Tn,De):new Tl(le,De)}evaluate(A){let k=null,le=0,Pe;for(const De of this.args){if(le++,k=De.evaluate(A),k&&k instanceof fa&&!k.available&&(Pe||(Pe=k),k=null,le===this.args.length))return Pe;if(k!==null)break}return k}eachChild(A){this.args.forEach(A)}outputDefined(){return this.args.every(A=>A.outputDefined())}serialize(){const A=["coalesce"];return this.eachChild(k=>{A.push(k.serialize())}),A}}var Ja=Tl;class xs{constructor(A,k){this.type=k.type,this.bindings=[].concat(A),this.result=k}evaluate(A){return this.result.evaluate(A)}eachChild(A){for(const k of this.bindings)A(k[1]);A(this.result)}static parse(A,k){if(A.length<4)return k.error(`Expected at least 3 arguments, but found ${A.length-1} instead.`);const le=[];for(let De=1;De<A.length-1;De+=2){const He=A[De];if(typeof He!="string")return k.error(`Expected string, but found ${typeof He} instead.`,De);if(/[^a-zA-Z0-9_]/.test(He))return k.error("Variable names must contain only alphanumeric characters or '_'.",De);const nt=k.parse(A[De+1],De+1);if(!nt)return null;le.push([He,nt])}const Pe=k.parse(A[A.length-1],A.length-1,k.expectedType,le);return Pe?new xs(le,Pe):null}outputDefined(){return this.result.outputDefined()}serialize(){const A=["let"];for(const[k,le]of this.bindings)A.push(k,le.serialize());return A.push(this.result.serialize()),A}}var us=xs;class Sl{constructor(A,k,le){this.type=A,this.index=k,this.input=le}static parse(A,k){if(A.length!==3)return k.error(`Expected 2 arguments, but found ${A.length-1} instead.`);const le=k.parse(A[1],1,wr),Pe=k.parse(A[2],2,es(k.expectedType||Tn));if(!le||!Pe)return null;const De=Pe.type;return new Sl(De.itemType,le,Pe)}evaluate(A){const k=this.index.evaluate(A),le=this.input.evaluate(A);if(k<0)throw new fi(`Array index out of bounds: ${k} < 0.`);if(k>=le.length)throw new fi(`Array index out of bounds: ${k} > ${le.length-1}.`);if(k!==Math.floor(k))throw new fi(`Array index must be an integer, but found ${k} instead.`);return le[k]}eachChild(A){A(this.index),A(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var pu=Sl;class ka{constructor(A,k){this.type=Rn,this.needle=A,this.haystack=k}static parse(A,k){if(A.length!==3)return k.error(`Expected 2 arguments, but found ${A.length-1} instead.`);const le=k.parse(A[1],1,Tn),Pe=k.parse(A[2],2,Tn);return!le||!Pe?null:vl(le.type,[Rn,bn,wr,qa,Tn])?new ka(le,Pe):k.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(le.type)} instead`)}evaluate(A){const k=this.needle.evaluate(A),le=this.haystack.evaluate(A);if(le==null)return!1;if(!uu(k,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(ki(k))} instead.`);if(!uu(le,["string","array"]))throw new fi(`Expected second argument to be of type array or string, but found ${Pi(ki(le))} instead.`);return le.indexOf(k)>=0}eachChild(A){A(this.needle),A(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Sa=ka;class As{constructor(A,k,le){this.type=wr,this.needle=A,this.haystack=k,this.fromIndex=le}static parse(A,k){if(A.length<=2||A.length>=5)return k.error(`Expected 3 or 4 arguments, but found ${A.length-1} instead.`);const le=k.parse(A[1],1,Tn),Pe=k.parse(A[2],2,Tn);if(!le||!Pe)return null;if(!vl(le.type,[Rn,bn,wr,qa,Tn]))return k.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(le.type)} instead`);if(A.length===4){const De=k.parse(A[3],3,wr);return De?new As(le,Pe,De):null}else return new As(le,Pe)}evaluate(A){const k=this.needle.evaluate(A),le=this.haystack.evaluate(A);if(!uu(k,["boolean","string","number","null"]))throw new fi(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(ki(k))} instead.`);if(!uu(le,["string","array"]))throw new fi(`Expected second argument to be of type array or string, but found ${Pi(ki(le))} instead.`);if(this.fromIndex){const Pe=this.fromIndex.evaluate(A);return le.indexOf(k,Pe)}return le.indexOf(k)}eachChild(A){A(this.needle),A(this.haystack),this.fromIndex&&A(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const A=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),A]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var qs=As;class io{constructor(A,k,le,Pe,De,He){this.inputType=A,this.type=k,this.input=le,this.cases=Pe,this.outputs=De,this.otherwise=He}static parse(A,k){if(A.length<5)return k.error(`Expected at least 4 arguments, but found only ${A.length-1}.`);if(A.length%2!==1)return k.error("Expected an even number of arguments.");let le,Pe;k.expectedType&&k.expectedType.kind!=="value"&&(Pe=k.expectedType);const De={},He=[];for(let At=2;At<A.length-1;At+=2){let Ht=A[At];const Wt=A[At+1];Array.isArray(Ht)||(Ht=[Ht]);const yr=k.concat(At);if(Ht.length===0)return yr.error("Expected at least one branch label.");for(const Wr of Ht){if(typeof Wr!="number"&&typeof Wr!="string")return yr.error("Branch labels must be numbers or strings.");if(typeof Wr=="number"&&Math.abs(Wr)>Number.MAX_SAFE_INTEGER)return yr.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Wr=="number"&&Math.floor(Wr)!==Wr)return yr.error("Numeric branch labels must be integer values.");if(!le)le=ki(Wr);else if(yr.checkSubtype(le,ki(Wr)))return null;if(typeof De[String(Wr)]<"u")return yr.error("Branch labels must be unique.");De[String(Wr)]=He.length}const br=k.parse(Wt,At,Pe);if(!br)return null;Pe=Pe||br.type,He.push(br)}const nt=k.parse(A[1],1,Tn);if(!nt)return null;const Tt=k.parse(A[A.length-1],A.length-1,Pe);return!Tt||nt.type.kind!=="value"&&k.concat(1).checkSubtype(le,nt.type)?null:new io(le,Pe,nt,De,He,Tt)}evaluate(A){const k=this.input.evaluate(A);return(ki(k)===this.inputType&&this.outputs[this.cases[k]]||this.otherwise).evaluate(A)}eachChild(A){A(this.input),this.outputs.forEach(A),A(this.otherwise)}outputDefined(){return this.outputs.every(A=>A.outputDefined())&&this.otherwise.outputDefined()}serialize(){const A=["match",this.input.serialize()],k=Object.keys(this.cases).sort(),le=[],Pe={};for(const He of k){const nt=Pe[this.cases[He]];nt===void 0?(Pe[this.cases[He]]=le.length,le.push([this.cases[He],[He]])):le[nt][1].push(He)}const De=He=>this.inputType.kind==="number"?Number(He):He;for(const[He,nt]of le)nt.length===1?A.push(De(nt[0])):A.push(nt.map(De)),A.push(this.outputs[He].serialize());return A.push(this.otherwise.serialize()),A}}var Oc=io;class Rl{constructor(A,k,le){this.type=A,this.branches=k,this.otherwise=le}static parse(A,k){if(A.length<4)return k.error(`Expected at least 3 arguments, but found only ${A.length-1}.`);if(A.length%2!==0)return k.error("Expected an odd number of arguments.");let le;k.expectedType&&k.expectedType.kind!=="value"&&(le=k.expectedType);const Pe=[];for(let He=1;He<A.length-1;He+=2){const nt=k.parse(A[He],He,Rn);if(!nt)return null;const Tt=k.parse(A[He+1],He+1,le);if(!Tt)return null;Pe.push([nt,Tt]),le=le||Tt.type}const De=k.parse(A[A.length-1],A.length-1,le);return De?new Rl(le,Pe,De):null}evaluate(A){for(const[k,le]of this.branches)if(k.evaluate(A))return le.evaluate(A);return this.otherwise.evaluate(A)}eachChild(A){for(const[k,le]of this.branches)A(k),A(le);A(this.otherwise)}outputDefined(){return this.branches.every(([A,k])=>k.outputDefined())&&this.otherwise.outputDefined()}serialize(){const A=["case"];return this.eachChild(k=>{A.push(k.serialize())}),A}}var Fc=Rl;class ao{constructor(A,k,le,Pe){this.type=A,this.input=k,this.beginIndex=le,this.endIndex=Pe}static parse(A,k){if(A.length<=2||A.length>=5)return k.error(`Expected 3 or 4 arguments, but found ${A.length-1} instead.`);const le=k.parse(A[1],1,Tn),Pe=k.parse(A[2],2,wr);if(!le||!Pe)return null;if(!vl(le.type,[es(Tn),bn,Tn]))return k.error(`Expected first argument to be of type array or string, but found ${Pi(le.type)} instead`);if(A.length===4){const De=k.parse(A[3],3,wr);return De?new ao(le.type,le,Pe,De):null}else return new ao(le.type,le,Pe)}evaluate(A){const k=this.input.evaluate(A),le=this.beginIndex.evaluate(A);if(!uu(k,["string","array"]))throw new fi(`Expected first argument to be of type array or string, but found ${Pi(ki(k))} instead.`);if(this.endIndex){const Pe=this.endIndex.evaluate(A);return k.slice(le,Pe)}return k.slice(le)}eachChild(A){A(this.input),A(this.beginIndex),this.endIndex&&A(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const A=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),A]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Xf=ao;function dd(S,A){return S==="=="||S==="!="?A.kind==="boolean"||A.kind==="string"||A.kind==="number"||A.kind==="null"||A.kind==="value":A.kind==="string"||A.kind==="number"||A.kind==="value"}function pd(S,A,k){return A===k}function Cl(S,A,k){return A!==k}function Me(S,A,k){return A<k}function mu(S,A,k){return A>k}function So(S,A,k){return A<=k}function Zf(S,A,k){return A>=k}function Pl(S,A,k,le){return le.compare(A,k)===0}function Ro(S,A,k,le){return!Pl(S,A,k,le)}function jf(S,A,k,le){return le.compare(A,k)<0}function Ic(S,A,k,le){return le.compare(A,k)>0}function Yf(S,A,k,le){return le.compare(A,k)<=0}function Co(S,A,k,le){return le.compare(A,k)>=0}function jr(S,A,k){const le=S!=="=="&&S!=="!=";return class JR{constructor(De,He,nt){this.type=Rn,this.lhs=De,this.rhs=He,this.collator=nt,this.hasUntypedArgument=De.type.kind==="value"||He.type.kind==="value"}static parse(De,He){if(De.length!==3&&De.length!==4)return He.error("Expected two or three arguments.");const nt=De[0];let Tt=He.parse(De[1],1,Tn);if(!Tt)return null;if(!dd(nt,Tt.type))return He.concat(1).error(`"${nt}" comparisons are not supported for type '${Pi(Tt.type)}'.`);let At=He.parse(De[2],2,Tn);if(!At)return null;if(!dd(nt,At.type))return He.concat(2).error(`"${nt}" comparisons are not supported for type '${Pi(At.type)}'.`);if(Tt.type.kind!==At.type.kind&&Tt.type.kind!=="value"&&At.type.kind!=="value")return He.error(`Cannot compare types '${Pi(Tt.type)}' and '${Pi(At.type)}'.`);le&&(Tt.type.kind==="value"&&At.type.kind!=="value"?Tt=new _s(At.type,[Tt]):Tt.type.kind!=="value"&&At.type.kind==="value"&&(At=new _s(Tt.type,[At])));let Ht=null;if(De.length===4){if(Tt.type.kind!=="string"&&At.type.kind!=="string"&&Tt.type.kind!=="value"&&At.type.kind!=="value")return He.error("Cannot use collator to compare non-string types.");if(Ht=He.parse(De[3],3,Iu),!Ht)return null}return new JR(Tt,At,Ht)}evaluate(De){const He=this.lhs.evaluate(De),nt=this.rhs.evaluate(De);if(le&&this.hasUntypedArgument){const Tt=ki(He),At=ki(nt);if(Tt.kind!==At.kind||!(Tt.kind==="string"||Tt.kind==="number"))throw new fi(`Expected arguments for "${S}" to be (string, string) or (number, number), but found (${Tt.kind}, ${At.kind}) instead.`)}if(this.collator&&!le&&this.hasUntypedArgument){const Tt=ki(He),At=ki(nt);if(Tt.kind!=="string"||At.kind!=="string")return A(De,He,nt)}return this.collator?k(De,He,nt,this.collator.evaluate(De)):A(De,He,nt)}eachChild(De){De(this.lhs),De(this.rhs),this.collator&&De(this.collator)}outputDefined(){return!0}serialize(){const De=[S];return this.eachChild(He=>{De.push(He.serialize())}),De}}}const Vu=jr("==",pd,Pl),Os=jr("!=",Cl,Ro),Z0=jr("<",Me,jf),j0=jr(">",mu,Ic),Po=jr("<=",So,Yf),kc=jr(">=",Zf,Co);class Ra{constructor(A,k,le,Pe,De,He){this.type=bn,this.number=A,this.locale=k,this.currency=le,this.unit=Pe,this.minFractionDigits=De,this.maxFractionDigits=He}static parse(A,k){if(A.length!==3)return k.error("Expected two arguments.");const le=k.parse(A[1],1,wr);if(!le)return null;const Pe=A[2];if(typeof Pe!="object"||Array.isArray(Pe))return k.error("NumberFormat options argument must be an object.");let De=null;if(Pe.locale&&(De=k.parse(Pe.locale,1,bn),!De))return null;let He=null;if(Pe.currency&&(He=k.parse(Pe.currency,1,bn),!He))return null;let nt=null;if(Pe.unit&&(nt=k.parse(Pe.unit,1,bn),!nt))return null;let Tt=null;if(Pe["min-fraction-digits"]&&(Tt=k.parse(Pe["min-fraction-digits"],1,wr),!Tt))return null;let At=null;return Pe["max-fraction-digits"]&&(At=k.parse(Pe["max-fraction-digits"],1,wr),!At)?null:new Ra(le,De,He,nt,Tt,At)}evaluate(A){return new Intl.NumberFormat(this.locale?this.locale.evaluate(A):[],{style:this.currency&&"currency"||this.unit&&"unit"||"decimal",currency:this.currency?this.currency.evaluate(A):void 0,unit:this.unit?this.unit.evaluate(A):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(A):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(A):void 0}).format(this.number.evaluate(A))}eachChild(A){A(this.number),this.locale&&A(this.locale),this.currency&&A(this.currency),this.unit&&A(this.unit),this.minFractionDigits&&A(this.minFractionDigits),this.maxFractionDigits&&A(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const A={};return this.locale&&(A.locale=this.locale.serialize()),this.currency&&(A.currency=this.currency.serialize()),this.unit&&(A.unit=this.unit.serialize()),this.minFractionDigits&&(A["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(A["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),A]}}class Dc{constructor(A){this.type=wr,this.input=A}static parse(A,k){if(A.length!==2)return k.error(`Expected 1 argument, but found ${A.length-1} instead.`);const le=k.parse(A[1],1);return le?le.type.kind!=="array"&&le.type.kind!=="string"&&le.type.kind!=="value"?k.error(`Expected argument of type string or array, but found ${Pi(le.type)} instead.`):new Dc(le):null}evaluate(A){const k=this.input.evaluate(A);if(typeof k=="string")return k.length;if(Array.isArray(k))return k.length;throw new fi(`Expected value to be of type string or array, but found ${Pi(ki(k))} instead.`)}eachChild(A){A(this.input)}outputDefined(){return!1}serialize(){const A=["length"];return this.eachChild(k=>{A.push(k.serialize())}),A}}var Y0=Dc;const Lo={"==":Vu,"!=":Os,">":j0,"<":Z0,">=":kc,"<=":Po,array:_s,at:pu,boolean:_s,case:Fc,coalesce:Ja,collator:Cc,format:Gs,image:Du,in:Sa,"index-of":qs,interpolate:Hs,"interpolate-hcl":Hs,"interpolate-lab":Hs,length:Y0,let:us,literal:ys,match:Oc,number:_s,"number-format":Ra,object:_s,slice:Xf,step:hd,string:_s,"to-boolean":Bu,"to-color":Bu,"to-number":Bu,"to-string":Bu,var:fd,within:no};function Ll(S,[A,k,le,Pe]){A=A.evaluate(S),k=k.evaluate(S),le=le.evaluate(S);const De=Pe?Pe.evaluate(S):1,He=bo(A,k,le,De);if(He)throw new fi(He);return new ca(A/255*De,k/255*De,le/255*De,De)}function md(S,A){return S in A}function Nc(S,A){const k=A[S];return typeof k>"u"?null:k}function In(S,A,k,le){for(;k<=le;){const Pe=k+le>>1;if(A[Pe]===S)return!0;A[Pe]>S?le=Pe-1:k=Pe+1}return!1}function $a(S){return{type:S}}hu.register(Lo,{error:[Ec,[bn],(S,[A])=>{throw new fi(A.evaluate(S))}],typeof:[bn,[Tn],(S,[A])=>Pi(ki(A.evaluate(S)))],"to-rgba":[es(wr,4),[Xa],(S,[A])=>A.evaluate(S).toArray()],rgb:[Xa,[wr,wr,wr],Ll],rgba:[Xa,[wr,wr,wr,wr],Ll],has:{type:Rn,overloads:[[[bn],(S,[A])=>md(A.evaluate(S),S.properties())],[[bn,Hi],(S,[A,k])=>md(A.evaluate(S),k.evaluate(S))]]},get:{type:Tn,overloads:[[[bn],(S,[A])=>Nc(A.evaluate(S),S.properties())],[[bn,Hi],(S,[A,k])=>Nc(A.evaluate(S),k.evaluate(S))]]},"feature-state":[Tn,[bn],(S,[A])=>Nc(A.evaluate(S),S.featureState||{})],properties:[Hi,[],S=>S.properties()],"geometry-type":[bn,[],S=>S.geometryType()],id:[Tn,[],S=>S.id()],zoom:[wr,[],S=>S.globals.zoom],pitch:[wr,[],S=>S.globals.pitch||0],"distance-from-center":[wr,[],S=>S.distanceFromCenter()],"heatmap-density":[wr,[],S=>S.globals.heatmapDensity||0],"line-progress":[wr,[],S=>S.globals.lineProgress||0],"sky-radial-progress":[wr,[],S=>S.globals.skyRadialProgress||0],accumulated:[Tn,[],S=>S.globals.accumulated===void 0?null:S.globals.accumulated],"+":[wr,$a(wr),(S,A)=>{let k=0;for(const le of A)k+=le.evaluate(S);return k}],"*":[wr,$a(wr),(S,A)=>{let k=1;for(const le of A)k*=le.evaluate(S);return k}],"-":{type:wr,overloads:[[[wr,wr],(S,[A,k])=>A.evaluate(S)-k.evaluate(S)],[[wr],(S,[A])=>-A.evaluate(S)]]},"/":[wr,[wr,wr],(S,[A,k])=>A.evaluate(S)/k.evaluate(S)],"%":[wr,[wr,wr],(S,[A,k])=>A.evaluate(S)%k.evaluate(S)],ln2:[wr,[],()=>Math.LN2],pi:[wr,[],()=>Math.PI],e:[wr,[],()=>Math.E],"^":[wr,[wr,wr],(S,[A,k])=>Math.pow(A.evaluate(S),k.evaluate(S))],sqrt:[wr,[wr],(S,[A])=>Math.sqrt(A.evaluate(S))],log10:[wr,[wr],(S,[A])=>Math.log(A.evaluate(S))/Math.LN10],ln:[wr,[wr],(S,[A])=>Math.log(A.evaluate(S))],log2:[wr,[wr],(S,[A])=>Math.log(A.evaluate(S))/Math.LN2],sin:[wr,[wr],(S,[A])=>Math.sin(A.evaluate(S))],cos:[wr,[wr],(S,[A])=>Math.cos(A.evaluate(S))],tan:[wr,[wr],(S,[A])=>Math.tan(A.evaluate(S))],asin:[wr,[wr],(S,[A])=>Math.asin(A.evaluate(S))],acos:[wr,[wr],(S,[A])=>Math.acos(A.evaluate(S))],atan:[wr,[wr],(S,[A])=>Math.atan(A.evaluate(S))],min:[wr,$a(wr),(S,A)=>Math.min(...A.map(k=>k.evaluate(S)))],max:[wr,$a(wr),(S,A)=>Math.max(...A.map(k=>k.evaluate(S)))],abs:[wr,[wr],(S,[A])=>Math.abs(A.evaluate(S))],round:[wr,[wr],(S,[A])=>{const k=A.evaluate(S);return k<0?-Math.round(-k):Math.round(k)}],floor:[wr,[wr],(S,[A])=>Math.floor(A.evaluate(S))],ceil:[wr,[wr],(S,[A])=>Math.ceil(A.evaluate(S))],"filter-==":[Rn,[bn,Tn],(S,[A,k])=>S.properties()[A.value]===k.value],"filter-id-==":[Rn,[Tn],(S,[A])=>S.id()===A.value],"filter-type-==":[Rn,[bn],(S,[A])=>S.geometryType()===A.value],"filter-<":[Rn,[bn,Tn],(S,[A,k])=>{const le=S.properties()[A.value],Pe=k.value;return typeof le==typeof Pe&&le<Pe}],"filter-id-<":[Rn,[Tn],(S,[A])=>{const k=S.id(),le=A.value;return typeof k==typeof le&&k<le}],"filter->":[Rn,[bn,Tn],(S,[A,k])=>{const le=S.properties()[A.value],Pe=k.value;return typeof le==typeof Pe&&le>Pe}],"filter-id->":[Rn,[Tn],(S,[A])=>{const k=S.id(),le=A.value;return typeof k==typeof le&&k>le}],"filter-<=":[Rn,[bn,Tn],(S,[A,k])=>{const le=S.properties()[A.value],Pe=k.value;return typeof le==typeof Pe&&le<=Pe}],"filter-id-<=":[Rn,[Tn],(S,[A])=>{const k=S.id(),le=A.value;return typeof k==typeof le&&k<=le}],"filter->=":[Rn,[bn,Tn],(S,[A,k])=>{const le=S.properties()[A.value],Pe=k.value;return typeof le==typeof Pe&&le>=Pe}],"filter-id->=":[Rn,[Tn],(S,[A])=>{const k=S.id(),le=A.value;return typeof k==typeof le&&k>=le}],"filter-has":[Rn,[Tn],(S,[A])=>A.value in S.properties()],"filter-has-id":[Rn,[],S=>S.id()!==null&&S.id()!==void 0],"filter-type-in":[Rn,[es(bn)],(S,[A])=>A.value.indexOf(S.geometryType())>=0],"filter-id-in":[Rn,[es(Tn)],(S,[A])=>A.value.indexOf(S.id())>=0],"filter-in-small":[Rn,[bn,es(Tn)],(S,[A,k])=>k.value.indexOf(S.properties()[A.value])>=0],"filter-in-large":[Rn,[bn,es(Tn)],(S,[A,k])=>In(S.properties()[A.value],k.value,0,k.value.length-1)],all:{type:Rn,overloads:[[[Rn,Rn],(S,[A,k])=>A.evaluate(S)&&k.evaluate(S)],[$a(Rn),(S,A)=>{for(const k of A)if(!k.evaluate(S))return!1;return!0}]]},any:{type:Rn,overloads:[[[Rn,Rn],(S,[A,k])=>A.evaluate(S)||k.evaluate(S)],[$a(Rn),(S,A)=>{for(const k of A)if(k.evaluate(S))return!0;return!1}]]},"!":[Rn,[Rn],(S,[A])=>!A.evaluate(S)],"is-supported-script":[Rn,[bn],(S,[A])=>{const k=S.globals&&S.globals.isSupportedScript;return k?k(A.evaluate(S)):!0}],upcase:[bn,[bn],(S,[A])=>A.evaluate(S).toUpperCase()],downcase:[bn,[bn],(S,[A])=>A.evaluate(S).toLowerCase()],concat:[bn,$a(Tn),(S,A)=>A.map(k=>fu(k.evaluate(S))).join("")],"resolved-locale":[bn,[Iu],(S,[A])=>A.evaluate(S).resolvedLocale()]});var Ol=Lo;function so(S){return{result:"success",value:S}}function Wu(S){return{result:"error",value:S}}function Bc(S){return S["property-type"]==="data-driven"||S["property-type"]==="cross-faded-data-driven"}function Jf(S){return!!S.expression&&S.expression.parameters.indexOf("zoom")>-1}function Uc(S){return!!S.expression&&S.expression.interpolated}function Yn(S){return S instanceof Number?"number":S instanceof String?"string":S instanceof Boolean?"boolean":Array.isArray(S)?"array":S===null?"null":typeof S}function Fl(S){return typeof S=="object"&&S!==null&&!Array.isArray(S)}function Il(S){return S}function Gn(S,A){const k=A.type==="color",le=S.stops&&typeof S.stops[0][0]=="object",Pe=le||S.property!==void 0,De=le||!Pe,He=S.type||(Uc(A)?"exponential":"interval");if(k&&(S=vs({},S),S.stops&&(S.stops=S.stops.map(Ht=>[Ht[0],ca.parse(Ht[1])])),S.default?S.default=ca.parse(S.default):S.default=ca.parse(A.default)),S.colorSpace&&S.colorSpace!=="rgb"&&!El[S.colorSpace])throw new Error(`Unknown color space: ${S.colorSpace}`);let nt,Tt,At;if(He==="exponential")nt=Xs;else if(He==="interval")nt=zc;else if(He==="categorical"){nt=oo,Tt=Object.create(null);for(const Ht of S.stops)Tt[Ht[0]]=Ht[1];At=typeof S.stops[0][0]}else if(He==="identity")nt=Hu;else throw new Error(`Unknown function type "${He}"`);if(le){const Ht={},Wt=[];for(let Wr=0;Wr<S.stops.length;Wr++){const vr=S.stops[Wr],rn=vr[0].zoom;Ht[rn]===void 0&&(Ht[rn]={zoom:rn,type:S.type,property:S.property,default:S.default,stops:[]},Wt.push(rn)),Ht[rn].stops.push([vr[0].value,vr[1]])}const yr=[];for(const Wr of Wt)yr.push([Ht[Wr].zoom,Gn(Ht[Wr],A)]);const br={name:"linear"};return{kind:"composite",interpolationType:br,interpolationFactor:Hs.interpolationFactor.bind(void 0,br),zoomStops:yr.map(Wr=>Wr[0]),evaluate({zoom:Wr},vr){return Xs({stops:yr,base:S.base},A,Wr).evaluate(Wr,vr)}}}else if(De){const Ht=He==="exponential"?{name:"exponential",base:S.base!==void 0?S.base:1}:null;return{kind:"camera",interpolationType:Ht,interpolationFactor:Hs.interpolationFactor.bind(void 0,Ht),zoomStops:S.stops.map(Wt=>Wt[0]),evaluate:({zoom:Wt})=>nt(S,A,Wt,Tt,At)}}else return{kind:"source",evaluate(Ht,Wt){const yr=Wt&&Wt.properties?Wt.properties[S.property]:void 0;return yr===void 0?Da(S.default,A.default):nt(S,A,yr,Tt,At)}}}function Da(S,A,k){if(S!==void 0)return S;if(A!==void 0)return A;if(k!==void 0)return k}function oo(S,A,k,le,Pe){const De=typeof k===Pe?le[k]:void 0;return Da(De,S.default,A.default)}function zc(S,A,k){if(Yn(k)!=="number")return Da(S.default,A.default);const le=S.stops.length;if(le===1||k<=S.stops[0][0])return S.stops[0][1];if(k>=S.stops[le-1][0])return S.stops[le-1][1];const Pe=bl(S.stops.map(De=>De[0]),k);return S.stops[Pe][1]}function Xs(S,A,k){const le=S.base!==void 0?S.base:1;if(Yn(k)!=="number")return Da(S.default,A.default);const Pe=S.stops.length;if(Pe===1||k<=S.stops[0][0])return S.stops[0][1];if(k>=S.stops[Pe-1][0])return S.stops[Pe-1][1];const De=bl(S.stops.map(Ht=>Ht[0]),k),He=uo(k,le,S.stops[De][0],S.stops[De+1][0]),nt=S.stops[De][1],Tt=S.stops[De+1][1];let At=zt[A.type]||Il;if(S.colorSpace&&S.colorSpace!=="rgb"){const Ht=El[S.colorSpace];At=(Wt,yr)=>Ht.reverse(Ht.interpolate(Ht.forward(Wt),Ht.forward(yr),He))}return typeof nt.evaluate=="function"?{evaluate(...Ht){const Wt=nt.evaluate.apply(void 0,Ht),yr=Tt.evaluate.apply(void 0,Ht);if(!(Wt===void 0||yr===void 0))return At(Wt,yr,He)}}:At(nt,Tt,He)}function Hu(S,A,k){return A.type==="color"?k=ca.parse(k):A.type==="formatted"?k=ts.fromString(k.toString()):A.type==="resolvedImage"?k=fa.fromString(k.toString()):Yn(k)!==A.type&&(A.type!=="enum"||!A.values[k])&&(k=void 0),Da(k,S.default,A.default)}function uo(S,A,k,le){const Pe=le-k,De=S-k;return Pe===0?0:A===1?De/Pe:(Math.pow(A,De)-1)/(Math.pow(A,Pe)-1)}class Gc{constructor(A,k){this.expression=A,this._warningHistory={},this._evaluator=new Rc,this._defaultValue=k?ti(k):null,this._enumValues=k&&k.type==="enum"?k.values:null}evaluateWithoutErrorHandling(A,k,le,Pe,De,He,nt,Tt){return this._evaluator.globals=A,this._evaluator.feature=k,this._evaluator.featureState=le,this._evaluator.canonical=Pe||null,this._evaluator.availableImages=De||null,this._evaluator.formattedSection=He,this._evaluator.featureTileCoord=nt||null,this._evaluator.featureDistanceData=Tt||null,this.expression.evaluate(this._evaluator)}evaluate(A,k,le,Pe,De,He,nt,Tt){this._evaluator.globals=A,this._evaluator.feature=k||null,this._evaluator.featureState=le||null,this._evaluator.canonical=Pe||null,this._evaluator.availableImages=De||null,this._evaluator.formattedSection=He||null,this._evaluator.featureTileCoord=nt||null,this._evaluator.featureDistanceData=Tt||null;try{const At=this.expression.evaluate(this._evaluator);if(At==null||typeof At=="number"&&At!==At)return this._defaultValue;if(this._enumValues&&!(At in this._enumValues))throw new fi(`Expected value to be one of ${Object.keys(this._enumValues).map(Ht=>JSON.stringify(Ht)).join(", ")}, but found ${JSON.stringify(At)} instead.`);return At}catch(At){return this._warningHistory[At.message]||(this._warningHistory[At.message]=!0,typeof console<"u"&&console.warn(At.message)),this._defaultValue}}}function vu(S){return Array.isArray(S)&&S.length>0&&typeof S[0]=="string"&&S[0]in Ol}function Oo(S,A){const k=new Hf(Ol,[],A?Vc(A):void 0),le=k.parse(S,void 0,void 0,void 0,A&&A.type==="string"?{typeAnnotation:"coerce"}:void 0);return le?so(new Gc(le,A)):Wu(k.errors)}class kl{constructor(A,k){this.kind=A,this._styleExpression=k,this.isStateDependent=A!=="constant"&&!Ps(k.expression)}evaluateWithoutErrorHandling(A,k,le,Pe,De,He){return this._styleExpression.evaluateWithoutErrorHandling(A,k,le,Pe,De,He)}evaluate(A,k,le,Pe,De,He){return this._styleExpression.evaluate(A,k,le,Pe,De,He)}}class zi{constructor(A,k,le,Pe){this.kind=A,this.zoomStops=le,this._styleExpression=k,this.isStateDependent=A!=="camera"&&!Ps(k.expression),this.interpolationType=Pe}evaluateWithoutErrorHandling(A,k,le,Pe,De,He){return this._styleExpression.evaluateWithoutErrorHandling(A,k,le,Pe,De,He)}evaluate(A,k,le,Pe,De,He){return this._styleExpression.evaluate(A,k,le,Pe,De,He)}interpolationFactor(A,k,le){return this.interpolationType?Hs.interpolationFactor(this.interpolationType,A,k,le):0}}function lo(S,A){if(S=Oo(S,A),S.result==="error")return S;const k=S.value.expression,le=wl(k);if(!le&&!Bc(A))return Wu([new la("","data expressions not supported")]);const Pe=Ws(k,["zoom","pitch","distance-from-center"]);if(!Pe&&!Jf(A))return Wu([new la("","zoom expressions not supported")]);const De=ii(k);if(!De&&!Pe)return Wu([new la("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(De instanceof la)return Wu([De]);if(De instanceof Hs&&!Uc(A))return Wu([new la("",'"interpolate" expressions cannot be used with this property')]);if(!De)return so(le?new kl("constant",S.value):new kl("source",S.value));const He=De instanceof Hs?De.interpolation:void 0;return so(le?new zi("camera",S.value,De.labels,He):new zi("composite",S.value,De.labels,He))}class Ti{constructor(A,k){this._parameters=A,this._specification=k,vs(this,Gn(this._parameters,this._specification))}static deserialize(A){return new Ti(A._parameters,A._specification)}static serialize(A){return{_parameters:A._parameters,_specification:A._specification}}}function co(S,A){if(Fl(S))return new Ti(S,A);if(vu(S)){const k=lo(S,A);if(k.result==="error")throw new Error(k.value.map(le=>`${le.key}: ${le.message}`).join(", "));return k.value}else{let k=S;return typeof S=="string"&&A.type==="color"&&(k=ca.parse(S)),{kind:"constant",evaluate:()=>k}}}function ii(S){let A=null;if(S instanceof us)A=ii(S.result);else if(S instanceof Ja){for(const k of S.args)if(A=ii(k),A)break}else(S instanceof hd||S instanceof Hs)&&S.input instanceof hu&&S.input.name==="zoom"&&(A=S);return A instanceof la||S.eachChild(k=>{const le=ii(k);le instanceof la?A=le:!A&&le?A=new la("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):A&&le&&A!==le&&(A=new la("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),A}function Vc(S){const A={color:Xa,string:bn,number:wr,enum:bn,boolean:Rn,formatted:ku,resolvedImage:ro};return S.type==="array"?es(A[S.value]||Tn,S.length):A[S.type]}function ti(S){return S.type==="color"&&(Fl(S.default)||Array.isArray(S.default))?new ca(0,0,0,0):S.type==="color"?ca.parse(S.default)||null:S.default===void 0?null:S.default}function qu(S){return typeof S=="object"?["literal",S]:S}function $f(S,A){let k=S.stops;if(!k)return Wc(S,A);const le=k&&typeof k[0][0]=="object",Pe=le||S.property!==void 0,De=le||!Pe;return k=k.map(He=>!Pe&&A.tokens&&typeof He[1]=="string"?[He[0],Xc(He[1])]:[He[0],qu(He[1])]),le?qc(S,A,k):De?Qr(S,A,k):fo(S,A,k)}function Wc(S,A){const k=["get",S.property];if(S.default===void 0)return A.type==="string"?["string",k]:k;if(A.type==="enum")return["match",k,Object.keys(A.values),k,S.default];{const le=[A.type==="color"?"to-color":A.type,k,qu(S.default)];return A.type==="array"&&le.splice(1,0,A.value,A.length||null),le}}function Hc(S){switch(S.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function qc(S,A,k){const le={},Pe={},De=[];for(let nt=0;nt<k.length;nt++){const Tt=k[nt],At=Tt[0].zoom;le[At]===void 0&&(le[At]={zoom:At,type:S.type,property:S.property,default:S.default},Pe[At]=[],De.push(At)),Pe[At].push([Tt[0].value,Tt[1]])}if(rs({},A)==="exponential"){const nt=[Hc(S),["linear"],["zoom"]];for(const Tt of De){const At=fo(le[Tt],A,Pe[Tt]);Xu(nt,Tt,At,!1)}return nt}else{const nt=["step",["zoom"]];for(const Tt of De){const At=fo(le[Tt],A,Pe[Tt]);Xu(nt,Tt,At,!0)}return Fo(nt),nt}}function vd(S,A){if(S!==void 0)return S;if(A!==void 0)return A}function Dl(S,A){const k=qu(vd(S.default,A.default));return k===void 0&&A.type==="resolvedImage"?"":k}function fo(S,A,k){const le=rs(S,A),Pe=["get",S.property];if(le==="categorical"&&typeof k[0][0]=="boolean"){const De=["case"];for(const He of k)De.push(["==",Pe,He[0]],He[1]);return De.push(Dl(S,A)),De}else if(le==="categorical"){const De=["match",Pe];for(const He of k)Xu(De,He[0],He[1],!1);return De.push(Dl(S,A)),De}else if(le==="interval"){const De=["step",["number",Pe]];for(const He of k)Xu(De,He[0],He[1],!0);return Fo(De),S.default===void 0?De:["case",["==",["typeof",Pe],"number"],De,qu(S.default)]}else if(le==="exponential"){const De=S.base!==void 0?S.base:1,He=[Hc(S),De===1?["linear"]:["exponential",De],["number",Pe]];for(const nt of k)Xu(He,nt[0],nt[1],!1);return S.default===void 0?He:["case",["==",["typeof",Pe],"number"],He,qu(S.default)]}else throw new Error(`Unknown property function type ${le}`)}function Qr(S,A,k,le=["zoom"]){const Pe=rs(S,A);let De,He=!1;if(Pe==="interval")De=["step",le],He=!0;else if(Pe==="exponential"){const nt=S.base!==void 0?S.base:1;De=[Hc(S),nt===1?["linear"]:["exponential",nt],le]}else throw new Error(`Unknown zoom function type "${Pe}"`);for(const nt of k)Xu(De,nt[0],nt[1],He);return Fo(De),De}function Fo(S){S[0]==="step"&&S.length===3&&(S.push(0),S.push(S[3]))}function Xu(S,A,k,le){S.length>3&&A===S[S.length-2]||(le&&S.length===2||S.push(A),S.push(k))}function rs(S,A){return S.type?S.type:A.expression.interpolated?"exponential":"interval"}function Xc(S){const A=["concat"],k=/{([^{}]+)}/g;let le=0;for(let Pe=k.exec(S);Pe!==null;Pe=k.exec(S)){const De=S.slice(le,k.lastIndex-Pe[0].length);le=k.lastIndex,De.length>0&&A.push(De),A.push(["get",Pe[1]])}if(A.length===1)return S;if(le<S.length)A.push(S.slice(le));else if(A.length===2)return["to-string",A[1]];return A}function Di(S){return S instanceof Number||S instanceof String||S instanceof Boolean?S.valueOf():S}function Xi(S){if(Array.isArray(S))return S.map(Xi);if(S instanceof Object&&!(S instanceof Number||S instanceof String||S instanceof Boolean)){const A={};for(const k in S)A[k]=Xi(S[k]);return A}return Di(S)}function Zs(S){if(S===!0||S===!1)return!0;if(!Array.isArray(S)||S.length===0)return!1;switch(S[0]){case"has":return S.length>=2&&S[1]!=="$id"&&S[1]!=="$type";case"in":return S.length>=3&&(typeof S[1]!="string"||Array.isArray(S[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return S.length!==3||Array.isArray(S[1])||Array.isArray(S[2]);case"any":case"all":for(const A of S.slice(1))if(!Zs(A)&&typeof A!="boolean")return!1;return!0;default:return!0}}function Aa(S,A="fill"){if(S==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zs(S)||(S=Zu(S));const k=S;let le=!0;try{le=An(k)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(k,null,2)}
        `)}const Pe=Ze[`filter_${A}`],De=Oo(le,Pe);let He=null;if(De.result==="error")throw new Error(De.value.map(Ht=>`${Ht.key}: ${Ht.message}`).join(", "));He=(Ht,Wt,yr)=>De.value.evaluate(Ht,Wt,{},yr);let nt=null,Tt=null;if(le!==k){const Ht=Oo(k,Pe);if(Ht.result==="error")throw new Error(Ht.value.map(Wt=>`${Wt.key}: ${Wt.message}`).join(", "));nt=(Wt,yr,br,Wr,vr)=>Ht.value.evaluate(Wt,yr,{},br,void 0,void 0,Wr,vr),Tt=!wl(Ht.value.expression)}He=He;const At=Zc(le);return{filter:He,dynamicFilter:nt||void 0,needGeometry:At,needFeature:!!Tt}}function An(S){if(!Io(S))return S;let A=Xi(S);return gu(A),A=Qf(A),A}function Qf(S){if(!Array.isArray(S))return S;const A=No(S);return A===!0?A:A.map(k=>Qf(k))}function gu(S){let A=!1;const k=[];if(S[0]==="case"){for(let le=1;le<S.length-1;le+=2)A=A||Io(S[le]),k.push(S[le+1]);k.push(S[S.length-1])}else if(S[0]==="match"){A=A||Io(S[1]);for(let le=2;le<S.length-1;le+=2)k.push(S[le+1]);k.push(S[S.length-1])}else if(S[0]==="step"){A=A||Io(S[1]);for(let le=1;le<S.length-1;le+=2)k.push(S[le+1])}A&&(S.length=0,S.push("any",...k));for(let le=1;le<S.length;le++)gu(S[le])}function Io(S){if(!Array.isArray(S))return!1;if(ko(S[0]))return!0;for(let A=1;A<S.length;A++){const k=S[A];if(Io(k))return!0}return!1}function ko(S){return S==="pitch"||S==="distance-from-center"}const Do=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function No(S){if(Do.has(S[0]))for(let A=1;A<S.length;A++){const k=S[A];if(Io(k))return!0}return S}function Kf(S,A){return S<A?-1:S>A?1:0}function Zc(S){if(!Array.isArray(S))return!1;if(S[0]==="within")return!0;for(let A=1;A<S.length;A++)if(Zc(S[A]))return!0;return!1}function Zu(S){if(!S)return!0;const A=S[0];return S.length<=1?A!=="any":A==="=="?ju(S[1],S[2],"=="):A==="!="?yu(ju(S[1],S[2],"==")):A==="<"||A===">"||A==="<="||A===">="?ju(S[1],S[2],A):A==="any"?jc(S.slice(1)):A==="all"?["all"].concat(S.slice(1).map(Zu)):A==="none"?["all"].concat(S.slice(1).map(Zu).map(yu)):A==="in"?Nl(S[1],S.slice(2)):A==="!in"?yu(Nl(S[1],S.slice(2))):A==="has"?Bl(S[1]):A==="!has"?yu(Bl(S[1])):A==="within"?S:!0}function ju(S,A,k){switch(S){case"$type":return[`filter-type-${k}`,A];case"$id":return[`filter-id-${k}`,A];default:return[`filter-${k}`,S,A]}}function jc(S){return["any"].concat(S.map(Zu))}function Nl(S,A){if(A.length===0)return!1;switch(S){case"$type":return["filter-type-in",["literal",A]];case"$id":return["filter-id-in",["literal",A]];default:return A.length>200&&!A.some(k=>typeof k!=typeof A[0])?["filter-in-large",S,["literal",A.sort(Kf)]]:["filter-in-small",S,["literal",A]]}}function Bl(S){switch(S){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",S]}}function yu(S){return["!",S]}function Ul(S){return Yu(S,{})}function Yu(S,A){if(Zs(S))return S;if(!S)return!0;const k=S[0];if(S.length<=1)return k!=="any";let le;if(k==="=="||k==="!="||k==="<"||k===">"||k==="<="||k===">="){const[,Pe,De]=S;le=ra(Pe,De,k,A)}else if(k==="any"){const Pe=S.slice(1).map(De=>{const He={},nt=Yu(De,He),Tt=Yc(He);return Tt===!0?nt:["case",Tt,nt,!1]});return["any"].concat(Pe)}else if(k==="all"){const Pe=S.slice(1).map(De=>Yu(De,A));return Pe.length>1?["all"].concat(Pe):[].concat(...Pe)}else{if(k==="none")return["!",Yu(["any"].concat(S.slice(1)),{})];k==="in"?le=zl(S[1],S.slice(2)):k==="!in"?le=zl(S[1],S.slice(2),!0):k==="has"?le=Gl(S[1]):k==="!has"?le=["!",Gl(S[1])]:le=!0}return le}function Yc(S){const A=[];for(const k in S){const le=k==="$id"?["id"]:["get",k];A.push(["==",["typeof",le],S[k]])}return A.length===0?!0:A.length===1?A[0]:["all"].concat(A)}function ra(S,A,k,le){let Pe;if(S==="$type")return[k,["geometry-type"],A];if(S==="$id"?Pe=["id"]:Pe=["get",S],le&&A!==null){const De=typeof A;le[S]=De}return k==="=="&&S!=="$id"&&A===null?["all",["has",S],["==",Pe,null]]:k==="!="&&S!=="$id"&&A===null?["any",["!",["has",S]],["!=",Pe,null]]:[k,Pe,A]}function zl(S,A,k=!1){if(A.length===0)return k;let le;S==="$type"?le=["geometry-type"]:S==="$id"?le=["id"]:le=["get",S];let Pe=!0;const De=typeof A[0];for(const He of A)if(typeof He!==De){Pe=!1;break}if(Pe&&(De==="string"||De==="number")){const He=A.sort().filter((nt,Tt)=>Tt===0||A[Tt-1]!==nt);return["match",le,He,!k,k]}return[k?"all":"any"].concat(A.map(He=>[k?"!=":"==",le,He]))}function Gl(S){return S==="$type"?!0:S==="$id"?["!=",["id"],null]:["has",S]}function ho(S){const A=[];return Ii(S,k=>{k.filter&&(k.filter=Ul(k.filter))}),Ha(S,{paint:!0,layout:!0},({path:k,value:le,reference:Pe,set:De})=>{vu(le)||(typeof le=="object"&&!Array.isArray(le)?(De($f(le,Pe)),A.push(k.join("."))):Pe.tokens&&typeof le=="string"&&De(Xc(le)))}),S}function Ju(S){let A=!1;if(S.version===7&&(S=Fu(S),A=!0),S.version===8&&(A=ho(S),A=!0),!A)throw new Error("cannot migrate from",S.version);return S}function Na(S){const A=[],k=[],le=[];for(const De in S.sources){const He=S.sources[De];if(He.type!=="vector")continue;const nt=/^mapbox:\/\/(.*)/.exec(He.url);!nt||(A.push(De),k.push(nt[1]))}if(A.length<2)return S;A.forEach(De=>{delete S.sources[De]});const Pe=k.join(",");return S.sources[Pe]={type:"vector",url:`mapbox://${Pe}`},S.layers.forEach(De=>{if(A.indexOf(De.source)>=0&&(De.source=Pe,"source-layer"in De)){if(le.indexOf(De["source-layer"])>=0)throw new Error("Conflicting source layer names");le.push(De["source-layer"])}}),S}var gd=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function J0(S,A){const k={};for(const le in S)le!=="ref"&&(k[le]=S[le]);return gd.forEach(le=>{le in A&&(k[le]=A[le])}),k}function $0(S){S=S.slice();const A=Object.create(null);for(let k=0;k<S.length;k++)A[S[k].id]=S[k];for(let k=0;k<S.length;k++)"ref"in S[k]&&(S[k]=J0(S[k],A[S[k].ref]));return S}function Jn(S,A){if(Array.isArray(S)){if(!Array.isArray(A)||S.length!==A.length)return!1;for(let k=0;k<S.length;k++)if(!Jn(S[k],A[k]))return!1;return!0}if(typeof S=="object"&&S!==null&&A!==null){if(typeof A!="object"||Object.keys(S).length!==Object.keys(A).length)return!1;for(const le in S)if(!Jn(S[le],A[le]))return!1;return!0}return S===A}const Qn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function da(S,A,k){k.push({command:Qn.addSource,args:[S,A[S]]})}function Bo(S,A,k){A.push({command:Qn.removeSource,args:[S]}),k[S]=!0}function js(S,A,k,le){Bo(S,k,le),da(S,A,k)}function Jc(S,A,k){let le;for(le in S[k])if(!!S[k].hasOwnProperty(le)&&le!=="data"&&!Jn(S[k][le],A[k][le]))return!1;for(le in A[k])if(!!A[k].hasOwnProperty(le)&&le!=="data"&&!Jn(S[k][le],A[k][le]))return!1;return!0}function $u(S,A,k,le){S=S||{},A=A||{};let Pe;for(Pe in S)!S.hasOwnProperty(Pe)||A.hasOwnProperty(Pe)||Bo(Pe,k,le);for(Pe in A)!A.hasOwnProperty(Pe)||(S.hasOwnProperty(Pe)?Jn(S[Pe],A[Pe])||(S[Pe].type==="geojson"&&A[Pe].type==="geojson"&&Jc(S,A,Pe)?k.push({command:Qn.setGeoJSONSourceData,args:[Pe,A[Pe].data]}):js(Pe,A,k,le)):da(Pe,A,k))}function _u(S,A,k,le,Pe,De){S=S||{},A=A||{};let He;for(He in S)!S.hasOwnProperty(He)||Jn(S[He],A[He])||k.push({command:De,args:[le,He,A[He],Pe]});for(He in A)!A.hasOwnProperty(He)||S.hasOwnProperty(He)||Jn(S[He],A[He])||k.push({command:De,args:[le,He,A[He],Pe]})}function $c(S){return S.id}function yd(S,A){return S[A.id]=A,S}function Q0(S,A,k){S=S||[],A=A||[];const le=S.map($c),Pe=A.map($c),De=S.reduce(yd,{}),He=A.reduce(yd,{}),nt=le.slice(),Tt=Object.create(null);let At,Ht,Wt,yr,br,Wr,vr;for(At=0,Ht=0;At<le.length;At++)Wt=le[At],He.hasOwnProperty(Wt)?Ht++:(k.push({command:Qn.removeLayer,args:[Wt]}),nt.splice(nt.indexOf(Wt,Ht),1));for(At=0,Ht=0;At<Pe.length;At++)Wt=Pe[Pe.length-1-At],nt[nt.length-1-At]!==Wt&&(De.hasOwnProperty(Wt)?(k.push({command:Qn.removeLayer,args:[Wt]}),nt.splice(nt.lastIndexOf(Wt,nt.length-Ht),1)):Ht++,Wr=nt[nt.length-At],k.push({command:Qn.addLayer,args:[He[Wt],Wr]}),nt.splice(nt.length-At,0,Wt),Tt[Wt]=!0);for(At=0;At<Pe.length;At++)if(Wt=Pe[At],yr=De[Wt],br=He[Wt],!(Tt[Wt]||Jn(yr,br))){if(!Jn(yr.source,br.source)||!Jn(yr["source-layer"],br["source-layer"])||!Jn(yr.type,br.type)){k.push({command:Qn.removeLayer,args:[Wt]}),Wr=nt[nt.lastIndexOf(Wt)+1],k.push({command:Qn.addLayer,args:[br,Wr]});continue}_u(yr.layout,br.layout,k,Wt,null,Qn.setLayoutProperty),_u(yr.paint,br.paint,k,Wt,null,Qn.setPaintProperty),Jn(yr.filter,br.filter)||k.push({command:Qn.setFilter,args:[Wt,br.filter]}),(!Jn(yr.minzoom,br.minzoom)||!Jn(yr.maxzoom,br.maxzoom))&&k.push({command:Qn.setLayerZoomRange,args:[Wt,br.minzoom,br.maxzoom]});for(vr in yr)!yr.hasOwnProperty(vr)||vr==="layout"||vr==="paint"||vr==="filter"||vr==="metadata"||vr==="minzoom"||vr==="maxzoom"||(vr.indexOf("paint.")===0?_u(yr[vr],br[vr],k,Wt,vr.slice(6),Qn.setPaintProperty):Jn(yr[vr],br[vr])||k.push({command:Qn.setLayerProperty,args:[Wt,vr,br[vr]]}));for(vr in br)!br.hasOwnProperty(vr)||yr.hasOwnProperty(vr)||vr==="layout"||vr==="paint"||vr==="filter"||vr==="metadata"||vr==="minzoom"||vr==="maxzoom"||(vr.indexOf("paint.")===0?_u(yr[vr],br[vr],k,Wt,vr.slice(6),Qn.setPaintProperty):Jn(yr[vr],br[vr])||k.push({command:Qn.setLayerProperty,args:[Wt,vr,br[vr]]}))}}function Ys(S,A){if(!S)return[{command:Qn.setStyle,args:[A]}];let k=[];try{if(!Jn(S.version,A.version))return[{command:Qn.setStyle,args:[A]}];Jn(S.center,A.center)||k.push({command:Qn.setCenter,args:[A.center]}),Jn(S.zoom,A.zoom)||k.push({command:Qn.setZoom,args:[A.zoom]}),Jn(S.bearing,A.bearing)||k.push({command:Qn.setBearing,args:[A.bearing]}),Jn(S.pitch,A.pitch)||k.push({command:Qn.setPitch,args:[A.pitch]}),Jn(S.sprite,A.sprite)||k.push({command:Qn.setSprite,args:[A.sprite]}),Jn(S.glyphs,A.glyphs)||k.push({command:Qn.setGlyphs,args:[A.glyphs]}),Jn(S.transition,A.transition)||k.push({command:Qn.setTransition,args:[A.transition]}),Jn(S.light,A.light)||k.push({command:Qn.setLight,args:[A.light]}),Jn(S.fog,A.fog)||k.push({command:Qn.setFog,args:[A.fog]}),Jn(S.projection,A.projection)||k.push({command:Qn.setProjection,args:[A.projection]});const le={},Pe=[];$u(S.sources,A.sources,Pe,le);const De=[];S.layers&&S.layers.forEach(nt=>{nt.source&&le[nt.source]?k.push({command:Qn.removeLayer,args:[nt.id]}):De.push(nt)});let He=S.terrain;He&&le[He.source]&&(k.push({command:Qn.setTerrain,args:[void 0]}),He=void 0),k=k.concat(Pe),Jn(He,A.terrain)||k.push({command:Qn.setTerrain,args:[A.terrain]}),Q0(De,A.layers,k)}catch(le){console.warn("Unable to compute style diff:",le),k=[{command:Qn.setStyle,args:[A]}]}return k}class _r{constructor(A,k,le,Pe){this.message=(A?`${A}: `:"")+le,Pe&&(this.identifier=Pe),k!=null&&k.__line__&&(this.line=k.__line__)}}class xu{constructor(A){this.error=A,this.message=A.message;const k=A.message.match(/line (\d+)/);this.line=k?parseInt(k[1],10):0}}function Ba(S){const A=S.key,k=S.value,le=S.valueSpec||{},Pe=S.objectElementValidators||{},De=S.style,He=S.styleSpec;let nt=[];const Tt=Yn(k);if(Tt!=="object")return[new _r(A,k,`object expected, ${Tt} found`)];for(const At in k){const Ht=At.split(".")[0],Wt=le[Ht]||le["*"];let yr;if(Pe[Ht]?yr=Pe[Ht]:le[Ht]?yr=Xn:Pe["*"]?yr=Pe["*"]:le["*"]&&(yr=Xn),!yr){nt.push(new _r(A,k[At],`unknown property "${At}"`));continue}nt=nt.concat(yr({key:(A&&`${A}.`)+At,value:k[At],valueSpec:Wt,style:De,styleSpec:He,object:k,objectKey:At},k))}for(const At in le)Pe[At]||le[At].required&&le[At].default===void 0&&k[At]===void 0&&nt.push(new _r(A,k,`missing required property "${At}"`));return nt}function eh(S){const A=S.value,k=S.valueSpec,le=S.style,Pe=S.styleSpec,De=S.key,He=S.arrayElementValidator||Xn;if(Yn(A)!=="array")return[new _r(De,A,`array expected, ${Yn(A)} found`)];if(k.length&&A.length!==k.length)return[new _r(De,A,`array length ${k.length} expected, length ${A.length} found`)];if(k["min-length"]&&A.length<k["min-length"])return[new _r(De,A,`array length at least ${k["min-length"]} expected, length ${A.length} found`)];let nt={type:k.value,values:k.values,minimum:k.minimum,maximum:k.maximum,function:void 0};Pe.$version<7&&(nt.function=k.function),Yn(k.value)==="object"&&(nt=k.value);let Tt=[];for(let At=0;At<A.length;At++)Tt=Tt.concat(He({array:A,arrayIndex:At,value:A[At],valueSpec:nt,style:le,styleSpec:Pe,key:`${De}[${At}]`}));return Tt}function _d(S){const A=S.key,k=S.value,le=S.valueSpec;let Pe=Yn(k);if(Pe==="number"&&k!==k&&(Pe="NaN"),Pe!=="number")return[new _r(A,k,`number expected, ${Pe} found`)];if("minimum"in le){let De=le.minimum;if(Yn(le.minimum)==="array"){const He=S.arrayIndex;De=le.minimum[He]}if(k<De)return[new _r(A,k,`${k} is less than the minimum value ${De}`)]}if("maximum"in le){let De=le.maximum;if(Yn(le.maximum)==="array"){const He=S.arrayIndex;De=le.maximum[He]}if(k>De)return[new _r(A,k,`${k} is greater than the maximum value ${De}`)]}return[]}function po(S){const A=S.valueSpec,k=Di(S.value.type);let le,Pe={},De,He;const nt=k!=="categorical"&&S.value.property===void 0,Tt=!nt,At=Yn(S.value.stops)==="array"&&Yn(S.value.stops[0])==="array"&&Yn(S.value.stops[0][0])==="object",Ht=Ba({key:S.key,value:S.value,valueSpec:S.styleSpec.function,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{stops:Wt,default:Wr}});return k==="identity"&&nt&&Ht.push(new _r(S.key,S.value,'missing required property "property"')),k!=="identity"&&!S.value.stops&&Ht.push(new _r(S.key,S.value,'missing required property "stops"')),k==="exponential"&&S.valueSpec.expression&&!Uc(S.valueSpec)&&Ht.push(new _r(S.key,S.value,"exponential functions not supported")),S.styleSpec.$version>=8&&(Tt&&!Bc(S.valueSpec)?Ht.push(new _r(S.key,S.value,"property functions not supported")):nt&&!Jf(S.valueSpec)&&Ht.push(new _r(S.key,S.value,"zoom functions not supported"))),(k==="categorical"||At)&&S.value.property===void 0&&Ht.push(new _r(S.key,S.value,'"property" property is required')),Ht;function Wt(vr){if(k==="identity")return[new _r(vr.key,vr.value,'identity function may not have a "stops" property')];let rn=[];const Yr=vr.value;return rn=rn.concat(eh({key:vr.key,value:Yr,valueSpec:vr.valueSpec,style:vr.style,styleSpec:vr.styleSpec,arrayElementValidator:yr})),Yn(Yr)==="array"&&Yr.length===0&&rn.push(new _r(vr.key,Yr,"array must have at least one stop")),rn}function yr(vr){let rn=[];const Yr=vr.value,$t=vr.key;if(Yn(Yr)!=="array")return[new _r($t,Yr,`array expected, ${Yn(Yr)} found`)];if(Yr.length!==2)return[new _r($t,Yr,`array length 2 expected, length ${Yr.length} found`)];if(At){if(Yn(Yr[0])!=="object")return[new _r($t,Yr,`object expected, ${Yn(Yr[0])} found`)];if(Yr[0].zoom===void 0)return[new _r($t,Yr,"object stop key must have zoom")];if(Yr[0].value===void 0)return[new _r($t,Yr,"object stop key must have value")];const Mr=Di(Yr[0].zoom);if(typeof Mr!="number")return[new _r($t,Yr[0].zoom,"stop zoom values must be numbers")];if(He&&He>Mr)return[new _r($t,Yr[0].zoom,"stop zoom values must appear in ascending order")];Mr!==He&&(He=Mr,De=void 0,Pe={}),rn=rn.concat(Ba({key:`${$t}[0]`,value:Yr[0],valueSpec:{zoom:{}},style:vr.style,styleSpec:vr.styleSpec,objectElementValidators:{zoom:_d,value:br}}))}else rn=rn.concat(br({key:`${$t}[0]`,value:Yr[0],valueSpec:{},style:vr.style,styleSpec:vr.styleSpec},Yr));return vu(Xi(Yr[1]))?rn.concat([new _r(`${$t}[1]`,Yr[1],"expressions are not allowed in function stops.")]):rn.concat(Xn({key:`${$t}[1]`,value:Yr[1],valueSpec:A,style:vr.style,styleSpec:vr.styleSpec}))}function br(vr,rn){const Yr=Yn(vr.value),$t=Di(vr.value),Mr=vr.value!==null?vr.value:rn;if(!le)le=Yr;else if(Yr!==le)return[new _r(vr.key,Mr,`${Yr} stop domain type must match previous stop domain type ${le}`)];if(Yr!=="number"&&Yr!=="string"&&Yr!=="boolean"&&typeof $t!="number"&&typeof $t!="string"&&typeof $t!="boolean")return[new _r(vr.key,Mr,"stop domain value must be a number, string, or boolean")];if(Yr!=="number"&&k!=="categorical"){let Nr=`number expected, ${Yr} found`;return Bc(A)&&k===void 0&&(Nr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new _r(vr.key,Mr,Nr)]}return k==="categorical"&&Yr==="number"&&(typeof $t!="number"||!isFinite($t)||Math.floor($t)!==$t)?[new _r(vr.key,Mr,`integer expected, found ${String($t)}`)]:k!=="categorical"&&Yr==="number"&&typeof $t=="number"&&typeof De=="number"&&De!==void 0&&$t<De?[new _r(vr.key,Mr,"stop domain values must appear in ascending order")]:(De=$t,k==="categorical"&&$t in Pe?[new _r(vr.key,Mr,"stop domain values must be unique")]:(Pe[$t]=!0,[]))}function Wr(vr){return Xn({key:vr.key,value:vr.value,valueSpec:A,style:vr.style,styleSpec:vr.styleSpec})}}function wa(S){const A=(S.expressionContext==="property"?lo:Oo)(Xi(S.value),S.valueSpec);if(A.result==="error")return A.value.map(le=>new _r(`${S.key}${le.key}`,S.value,le.message));const k=A.value.expression||A.value._styleExpression.expression;if(S.expressionContext==="property"&&S.propertyKey==="text-font"&&!k.outputDefined())return[new _r(S.key,S.value,`Invalid data expression for "${S.propertyKey}". Output values must be contained as literals within the expression.`)];if(S.expressionContext==="property"&&S.propertyType==="layout"&&!Ps(k))return[new _r(S.key,S.value,'"feature-state" data expressions are not supported with layout properties.')];if(S.expressionContext==="filter")return Qc(k,S);if(S.expressionContext&&S.expressionContext.indexOf("cluster")===0){if(!Ws(k,["zoom","feature-state"]))return[new _r(S.key,S.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(S.expressionContext==="cluster-initial"&&!wl(k))return[new _r(S.key,S.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Qc(S,A){const k=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(A.valueSpec&&A.valueSpec.expression)for(const Pe of A.valueSpec.expression.parameters)k.delete(Pe);if(k.size===0)return[];const le=[];return S instanceof hu&&k.has(S.name)?[new _r(A.key,A.value,`["${S.name}"] expression is not supported in a filter for a ${A.object.type} layer with id: ${A.object.id}`)]:(S.eachChild(Pe=>{le.push(...Qc(Pe,A))}),le)}function ls(S){const A=S.value,k=S.key,le=Yn(A);return le!=="boolean"?[new _r(k,A,`boolean expected, ${le} found`)]:[]}function Ua(S){const A=S.key,k=S.value,le=Yn(k);return le!=="string"?[new _r(A,k,`color expected, ${le} found`)]:Gf.parseCSSColor(k)===null?[new _r(A,k,`color expected, "${k}" found`)]:[]}function za(S){const A=S.key,k=S.value,le=S.valueSpec,Pe=[];return Array.isArray(le.values)?le.values.indexOf(Di(k))===-1&&Pe.push(new _r(A,k,`expected one of [${le.values.join(", ")}], ${JSON.stringify(k)} found`)):Object.keys(le.values).indexOf(Di(k))===-1&&Pe.push(new _r(A,k,`expected one of [${Object.keys(le.values).join(", ")}], ${JSON.stringify(k)} found`)),Pe}function th(S){if(Zs(Xi(S.value))){const A=S.layerType||"fill";return wa(vs({},S,{expressionContext:"filter",valueSpec:S.styleSpec[`filter_${A}`]}))}else return xd(S)}function xd(S){const A=S.value,k=S.key;if(Yn(A)!=="array")return[new _r(k,A,`array expected, ${Yn(A)} found`)];const le=S.styleSpec;let Pe,De=[];if(A.length<1)return[new _r(k,A,"filter array must have at least 1 element")];switch(De=De.concat(za({key:`${k}[0]`,value:A[0],valueSpec:le.filter_operator,style:S.style,styleSpec:S.styleSpec})),Di(A[0])){case"<":case"<=":case">":case">=":A.length>=2&&Di(A[1])==="$type"&&De.push(new _r(k,A,`"$type" cannot be use with operator "${A[0]}"`));case"==":case"!=":A.length!==3&&De.push(new _r(k,A,`filter array for operator "${A[0]}" must have 3 elements`));case"in":case"!in":A.length>=2&&(Pe=Yn(A[1]),Pe!=="string"&&De.push(new _r(`${k}[1]`,A[1],`string expected, ${Pe} found`)));for(let He=2;He<A.length;He++)Pe=Yn(A[He]),Di(A[1])==="$type"?De=De.concat(za({key:`${k}[${He}]`,value:A[He],valueSpec:le.geometry_type,style:S.style,styleSpec:S.styleSpec})):Pe!=="string"&&Pe!=="number"&&Pe!=="boolean"&&De.push(new _r(`${k}[${He}]`,A[He],`string, number, or boolean expected, ${Pe} found`));break;case"any":case"all":case"none":for(let He=1;He<A.length;He++)De=De.concat(xd({key:`${k}[${He}]`,value:A[He],style:S.style,styleSpec:S.styleSpec}));break;case"has":case"!has":Pe=Yn(A[1]),A.length!==2?De.push(new _r(k,A,`filter array for "${A[0]}" operator must have 2 elements`)):Pe!=="string"&&De.push(new _r(`${k}[1]`,A[1],`string expected, ${Pe} found`));break;case"within":Pe=Yn(A[1]),A.length!==2?De.push(new _r(k,A,`filter array for "${A[0]}" operator must have 2 elements`)):Pe!=="object"&&De.push(new _r(`${k}[1]`,A[1],`object expected, ${Pe} found`));break}return De}function Ad(S,A){const k=S.key,le=S.style,Pe=S.styleSpec,De=S.value,He=S.objectKey,nt=Pe[`${A}_${S.layerType}`];if(!nt)return[];const Tt=He.match(/^(.*)-transition$/);if(A==="paint"&&Tt&&nt[Tt[1]]&&nt[Tt[1]].transition)return Xn({key:k,value:De,valueSpec:Pe.transition,style:le,styleSpec:Pe});const At=S.valueSpec||nt[He];if(!At)return[new _r(k,De,`unknown property "${He}"`)];let Ht;if(Yn(De)==="string"&&Bc(At)&&!At.tokens&&(Ht=/^{([^}]+)}$/.exec(De)))return[new _r(k,De,`"${He}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ht[1])} }\`.`)];const Wt=[];return S.layerType==="symbol"&&(He==="text-field"&&le&&!le.glyphs&&Wt.push(new _r(k,De,'use of "text-field" requires a style "glyphs" property')),He==="text-font"&&Fl(Xi(De))&&Di(De.type)==="identity"&&Wt.push(new _r(k,De,'"text-font" does not support identity functions'))),Wt.concat(Xn({key:S.key,value:De,valueSpec:At,style:le,styleSpec:Pe,expressionContext:"property",propertyType:A,propertyKey:He}))}function K0(S){return Ad(S,"paint")}function ep(S){return Ad(S,"layout")}function tp(S){let A=[];const k=S.value,le=S.key,Pe=S.style,De=S.styleSpec;!k.type&&!k.ref&&A.push(new _r(le,k,'either "type" or "ref" is required'));let He=Di(k.type);const nt=Di(k.ref);if(k.id){const Tt=Di(k.id);for(let At=0;At<S.arrayIndex;At++){const Ht=Pe.layers[At];Di(Ht.id)===Tt&&A.push(new _r(le,k.id,`duplicate layer id "${k.id}", previously used at line ${Ht.id.__line__}`))}}if("ref"in k){["type","source","source-layer","filter","layout"].forEach(At=>{At in k&&A.push(new _r(le,k[At],`"${At}" is prohibited for ref layers`))});let Tt;Pe.layers.forEach(At=>{Di(At.id)===nt&&(Tt=At)}),Tt?Tt.ref?A.push(new _r(le,k.ref,"ref cannot reference another ref layer")):He=Di(Tt.type):typeof nt=="string"&&A.push(new _r(le,k.ref,`ref layer "${nt}" not found`))}else if(!(He==="background"||He==="sky"))if(!k.source)A.push(new _r(le,k,'missing required property "source"'));else{const Tt=Pe.sources&&Pe.sources[k.source],At=Tt&&Di(Tt.type);Tt?At==="vector"&&He==="raster"?A.push(new _r(le,k.source,`layer "${k.id}" requires a raster source`)):At==="raster"&&He!=="raster"?A.push(new _r(le,k.source,`layer "${k.id}" requires a vector source`)):At==="vector"&&!k["source-layer"]?A.push(new _r(le,k,`layer "${k.id}" must specify a "source-layer"`)):At==="raster-dem"&&He!=="hillshade"?A.push(new _r(le,k.source,"raster-dem source can only be used with layer type 'hillshade'.")):He==="line"&&k.paint&&(k.paint["line-gradient"]||k.paint["line-trim-offset"])&&(At!=="geojson"||!Tt.lineMetrics)&&A.push(new _r(le,k,`layer "${k.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):A.push(new _r(le,k.source,`source "${k.source}" not found`))}return A=A.concat(Ba({key:le,value:k,valueSpec:De.layer,style:S.style,styleSpec:S.styleSpec,objectElementValidators:{"*"(){return[]},type(){return Xn({key:`${le}.type`,value:k.type,valueSpec:De.layer.type,style:S.style,styleSpec:S.styleSpec,object:k,objectKey:"type"})},filter(Tt){return th(vs({layerType:He},Tt))},layout(Tt){return Ba({layer:k,key:Tt.key,value:Tt.value,valueSpec:{},style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*"(At){return ep(vs({layerType:He},At))}}})},paint(Tt){return Ba({layer:k,key:Tt.key,value:Tt.value,valueSpec:{},style:Tt.style,styleSpec:Tt.styleSpec,objectElementValidators:{"*"(At){return K0(vs({layerType:He},At))}}})}}})),A}function Qu(S){const A=S.value,k=S.key,le=Yn(A);return le!=="string"?[new _r(k,A,`string expected, ${le} found`)]:[]}const wd={promoteId:np};function rp(S){const A=S.value,k=S.key,le=S.styleSpec,Pe=S.style;if(!A.type)return[new _r(k,A,'"type" is required')];const De=Di(A.type);let He;switch(De){case"vector":case"raster":case"raster-dem":return He=Ba({key:k,value:A,valueSpec:le[`source_${De.replace("-","_")}`],style:S.style,styleSpec:le,objectElementValidators:wd}),He;case"geojson":if(He=Ba({key:k,value:A,valueSpec:le.source_geojson,style:Pe,styleSpec:le,objectElementValidators:wd}),A.cluster)for(const nt in A.clusterProperties){const[Tt,At]=A.clusterProperties[nt],Ht=typeof Tt=="string"?[Tt,["accumulated"],["get",nt]]:Tt;He.push(...wa({key:`${k}.${nt}.map`,value:At,expressionContext:"cluster-map"})),He.push(...wa({key:`${k}.${nt}.reduce`,value:Ht,expressionContext:"cluster-reduce"}))}return He;case"video":return Ba({key:k,value:A,valueSpec:le.source_video,style:Pe,styleSpec:le});case"image":return Ba({key:k,value:A,valueSpec:le.source_image,style:Pe,styleSpec:le});case"canvas":return[new _r(k,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return za({key:`${k}.type`,value:A.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:Pe,styleSpec:le})}}function np({key:S,value:A}){if(Yn(A)==="string")return Qu({key:S,value:A});{const k=[];for(const le in A)k.push(...Qu({key:`${S}.${le}`,value:A[le]}));return k}}function ip(S){const A=S.value,k=S.styleSpec,le=k.light,Pe=S.style;let De=[];const He=Yn(A);if(A===void 0)return De;if(He!=="object")return De=De.concat([new _r("light",A,`object expected, ${He} found`)]),De;for(const nt in A){const Tt=nt.match(/^(.*)-transition$/);Tt&&le[Tt[1]]&&le[Tt[1]].transition?De=De.concat(Xn({key:nt,value:A[nt],valueSpec:k.transition,style:Pe,styleSpec:k})):le[nt]?De=De.concat(Xn({key:nt,value:A[nt],valueSpec:le[nt],style:Pe,styleSpec:k})):De=De.concat([new _r(nt,A[nt],`unknown property "${nt}"`)])}return De}function ap(S){const A=S.value,k=S.key,le=S.style,Pe=S.styleSpec,De=Pe.terrain;let He=[];const nt=Yn(A);if(A===void 0)return He;if(nt!=="object")return He=He.concat([new _r("terrain",A,`object expected, ${nt} found`)]),He;for(const Tt in A){const At=Tt.match(/^(.*)-transition$/);At&&De[At[1]]&&De[At[1]].transition?He=He.concat(Xn({key:Tt,value:A[Tt],valueSpec:Pe.transition,style:le,styleSpec:Pe})):De[Tt]?He=He.concat(Xn({key:Tt,value:A[Tt],valueSpec:De[Tt],style:le,styleSpec:Pe})):He=He.concat([new _r(Tt,A[Tt],`unknown property "${Tt}"`)])}if(!A.source)He.push(new _r(k,A,'terrain is missing required property "source"'));else{const Tt=le.sources&&le.sources[A.source],At=Tt&&Di(Tt.type);Tt?At!=="raster-dem"&&He.push(new _r(k,A.source,`terrain cannot be used with a source of type ${String(At)}, it only be used with a "raster-dem" source type`)):He.push(new _r(k,A.source,`source "${A.source}" not found`))}return He}function sp(S){const A=S.value,k=S.style,le=S.styleSpec,Pe=le.fog;let De=[];const He=Yn(A);if(A===void 0)return De;if(He!=="object")return De=De.concat([new _r("fog",A,`object expected, ${He} found`)]),De;for(const nt in A){const Tt=nt.match(/^(.*)-transition$/);Tt&&Pe[Tt[1]]&&Pe[Tt[1]].transition?De=De.concat(Xn({key:nt,value:A[nt],valueSpec:le.transition,style:k,styleSpec:le})):Pe[nt]?De=De.concat(Xn({key:nt,value:A[nt],valueSpec:Pe[nt],style:k,styleSpec:le})):De=De.concat([new _r(nt,A[nt],`unknown property "${nt}"`)])}return De}function op(S){return Qu(S).length===0?[]:wa(S)}function up(S){return Qu(S).length===0?[]:wa(S)}function Md(S){const A=S.value,k=S.styleSpec,le=k.projection,Pe=S.style;let De=[];const He=Yn(A);if(He==="object")for(const nt in A)De=De.concat(Xn({key:nt,value:A[nt],valueSpec:le[nt],style:Pe,styleSpec:k}));else He!=="string"&&(De=De.concat([new _r("projection",A,`object or string expected, ${He} found`)]));return De}const Vl={"*"(){return[]},array:eh,boolean:ls,number:_d,color:Ua,enum:za,filter:th,function:po,layer:tp,object:Ba,source:rp,light:ip,terrain:ap,fog:sp,string:Qu,formatted:op,resolvedImage:up,projection:Md};function Xn(S){const A=S.value,k=S.valueSpec,le=S.styleSpec;return k.expression&&Fl(Di(A))?po(S):k.expression&&vu(Xi(A))?wa(S):k.type&&Vl[k.type]?Vl[k.type](S):Ba(vs({},S,{valueSpec:k.type?le[k.type]:k}))}function Wl(S){const A=S.value,k=S.key,le=Qu(S);return le.length||(A.indexOf("{fontstack}")===-1&&le.push(new _r(k,A,'"glyphs" url must include a "{fontstack}" token')),A.indexOf("{range}")===-1&&le.push(new _r(k,A,'"glyphs" url must include a "{range}" token'))),le}function rh(S,A=Ze){const k=Xn({key:"",value:S,valueSpec:A.$root,styleSpec:A,style:S,objectElementValidators:{glyphs:Wl,"*":()=>[]}});return lp(k)}function lp(S){return S.slice().sort((A,k)=>A.line&&k.line?A.line-k.line:0)}var cp=we(function(S,A){var k=function(){var le=function(Yr,$t,Mr,Nr){for(Mr=Mr||{},Nr=Yr.length;Nr--;Mr[Yr[Nr]]=$t);return Mr},Pe=[1,12],De=[1,13],He=[1,9],nt=[1,10],Tt=[1,11],At=[1,14],Ht=[1,15],Wt=[14,18,22,24],yr=[18,22],br=[22,24],Wr={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function($t,Mr,Nr,an,fn,Hn,na){var ai=Hn.length-1;switch(fn){case 1:this.$=new String($t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b")),this.$.__line__=this._$.first_line;break;case 2:this.$=new Number($t),this.$.__line__=this._$.first_line;break;case 3:this.$=null;break;case 4:this.$=new Boolean(!0),this.$.__line__=this._$.first_line;break;case 5:this.$=new Boolean(!1),this.$.__line__=this._$.first_line;break;case 6:return this.$=Hn[ai-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=Hn[ai-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[Hn[ai-2],Hn[ai]];break;case 16:this.$={},this.$[Hn[ai][0]]=Hn[ai][1];break;case 17:this.$=Hn[ai-2],Hn[ai-2][Hn[ai][0]]=Hn[ai][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[Hn[ai]];break;case 21:this.$=Hn[ai-2],Hn[ai-2].push(Hn[ai]);break}},table:[{3:5,4:Pe,5:6,6:De,7:3,8:He,9:4,10:nt,11:Tt,12:1,13:2,15:7,16:8,17:At,23:Ht},{1:[3]},{14:[1,16]},le(Wt,[2,7]),le(Wt,[2,8]),le(Wt,[2,9]),le(Wt,[2,10]),le(Wt,[2,11]),le(Wt,[2,12]),le(Wt,[2,3]),le(Wt,[2,4]),le(Wt,[2,5]),le([14,18,21,22,24],[2,1]),le(Wt,[2,2]),{3:20,4:Pe,18:[1,17],19:18,20:19},{3:5,4:Pe,5:6,6:De,7:3,8:He,9:4,10:nt,11:Tt,13:23,15:7,16:8,17:At,23:Ht,24:[1,21],25:22},{1:[2,6]},le(Wt,[2,13]),{18:[1,24],22:[1,25]},le(yr,[2,16]),{21:[1,26]},le(Wt,[2,18]),{22:[1,28],24:[1,27]},le(br,[2,20]),le(Wt,[2,14]),{3:20,4:Pe,20:29},{3:5,4:Pe,5:6,6:De,7:3,8:He,9:4,10:nt,11:Tt,13:30,15:7,16:8,17:At,23:Ht},le(Wt,[2,19]),{3:5,4:Pe,5:6,6:De,7:3,8:He,9:4,10:nt,11:Tt,13:31,15:7,16:8,17:At,23:Ht},le(yr,[2,17]),le(yr,[2,15]),le(br,[2,21])],defaultActions:{16:[2,6]},parseError:function($t,Mr){if(Mr.recoverable)this.trace($t);else throw new Error($t)},parse:function($t){var Mr=this,Nr=[0],an=[null],fn=[],Hn=this.table,na="",ai=0,ws=0,Uo=2,Au=1,mo=fn.slice.call(arguments,1),Ni=Object.create(this.lexer),ba={yy:{}};for(var Ms in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Ms)&&(ba.yy[Ms]=this.yy[Ms]);Ni.setInput($t,ba.yy),ba.yy.lexer=Ni,ba.yy.parser=this,typeof Ni.yylloc>"u"&&(Ni.yylloc={});var vo=Ni.yylloc;fn.push(vo);var oh=Ni.options&&Ni.options.ranges;typeof ba.yy.parseError=="function"?this.parseError=ba.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function uh(){var Ga;return Ga=Ni.lex()||Au,typeof Ga!="number"&&(Ga=Mr.symbols_[Ga]||Ga),Ga}for(var Gr,mn,kn,wi,Mi={},Li,Si,pi,Ca;;){if(mn=Nr[Nr.length-1],this.defaultActions[mn]?kn=this.defaultActions[mn]:((Gr===null||typeof Gr>"u")&&(Gr=uh()),kn=Hn[mn]&&Hn[mn][Gr]),typeof kn>"u"||!kn.length||!kn[0]){var ns="";Ca=[];for(Li in Hn[mn])this.terminals_[Li]&&Li>Uo&&Ca.push("'"+this.terminals_[Li]+"'");Ni.showPosition?ns="Parse error on line "+(ai+1)+`:
`+Ni.showPosition()+`
Expecting `+Ca.join(", ")+", got '"+(this.terminals_[Gr]||Gr)+"'":ns="Parse error on line "+(ai+1)+": Unexpected "+(Gr==Au?"end of input":"'"+(this.terminals_[Gr]||Gr)+"'"),this.parseError(ns,{text:Ni.match,token:this.terminals_[Gr]||Gr,line:Ni.yylineno,loc:vo,expected:Ca})}if(kn[0]instanceof Array&&kn.length>1)throw new Error("Parse Error: multiple actions possible at state: "+mn+", token: "+Gr);switch(kn[0]){case 1:Nr.push(Gr),an.push(Ni.yytext),fn.push(Ni.yylloc),Nr.push(kn[1]),Gr=null,ws=Ni.yyleng,na=Ni.yytext,ai=Ni.yylineno,vo=Ni.yylloc;break;case 2:if(Si=this.productions_[kn[1]][1],Mi.$=an[an.length-Si],Mi._$={first_line:fn[fn.length-(Si||1)].first_line,last_line:fn[fn.length-1].last_line,first_column:fn[fn.length-(Si||1)].first_column,last_column:fn[fn.length-1].last_column},oh&&(Mi._$.range=[fn[fn.length-(Si||1)].range[0],fn[fn.length-1].range[1]]),wi=this.performAction.apply(Mi,[na,ws,ai,ba.yy,kn[1],an,fn].concat(mo)),typeof wi<"u")return wi;Si&&(Nr=Nr.slice(0,-1*Si*2),an=an.slice(0,-1*Si),fn=fn.slice(0,-1*Si)),Nr.push(this.productions_[kn[1]][0]),an.push(Mi.$),fn.push(Mi._$),pi=Hn[Nr[Nr.length-2]][Nr[Nr.length-1]],Nr.push(pi);break;case 3:return!0}}return!0}},vr=function(){var Yr={EOF:1,parseError:function(Mr,Nr){if(this.yy.parser)this.yy.parser.parseError(Mr,Nr);else throw new Error(Mr)},setInput:function($t,Mr){return this.yy=Mr||this.yy||{},this._input=$t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var $t=this._input[0];this.yytext+=$t,this.yyleng++,this.offset++,this.match+=$t,this.matched+=$t;var Mr=$t.match(/(?:\r\n?|\n).*/g);return Mr?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),$t},unput:function($t){var Mr=$t.length,Nr=$t.split(/(?:\r\n?|\n)/g);this._input=$t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Mr),this.offset-=Mr;var an=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Nr.length-1&&(this.yylineno-=Nr.length-1);var fn=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Nr?(Nr.length===an.length?this.yylloc.first_column:0)+an[an.length-Nr.length].length-Nr[0].length:this.yylloc.first_column-Mr},this.options.ranges&&(this.yylloc.range=[fn[0],fn[0]+this.yyleng-Mr]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function($t){this.unput(this.match.slice($t))},pastInput:function(){var $t=this.matched.substr(0,this.matched.length-this.match.length);return($t.length>20?"...":"")+$t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var $t=this.match;return $t.length<20&&($t+=this._input.substr(0,20-$t.length)),($t.substr(0,20)+($t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var $t=this.pastInput(),Mr=new Array($t.length+1).join("-");return $t+this.upcomingInput()+`
`+Mr+"^"},test_match:function($t,Mr){var Nr,an,fn;if(this.options.backtrack_lexer&&(fn={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(fn.yylloc.range=this.yylloc.range.slice(0))),an=$t[0].match(/(?:\r\n?|\n).*/g),an&&(this.yylineno+=an.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:an?an[an.length-1].length-an[an.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+$t[0].length},this.yytext+=$t[0],this.match+=$t[0],this.matches=$t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice($t[0].length),this.matched+=$t[0],Nr=this.performAction.call(this,this.yy,this,Mr,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Nr)return Nr;if(this._backtrack){for(var Hn in fn)this[Hn]=fn[Hn];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var $t,Mr,Nr,an;this._more||(this.yytext="",this.match="");for(var fn=this._currentRules(),Hn=0;Hn<fn.length;Hn++)if(Nr=this._input.match(this.rules[fn[Hn]]),Nr&&(!Mr||Nr[0].length>Mr[0].length)){if(Mr=Nr,an=Hn,this.options.backtrack_lexer){if($t=this.test_match(Nr,fn[Hn]),$t!==!1)return $t;if(this._backtrack){Mr=!1;continue}else return!1}else if(!this.options.flex)break}return Mr?($t=this.test_match(Mr,fn[an]),$t!==!1?$t:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Mr=this.next();return Mr||this.lex()},begin:function(Mr){this.conditionStack.push(Mr)},popState:function(){var Mr=this.conditionStack.length-1;return Mr>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Mr){return Mr=this.conditionStack.length-1-Math.abs(Mr||0),Mr>=0?this.conditionStack[Mr]:"INITIAL"},pushState:function(Mr){this.begin(Mr)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Mr,Nr,an,fn){switch(an){case 0:break;case 1:return 6;case 2:return Nr.yytext=Nr.yytext.substr(1,Nr.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return Yr}();Wr.lexer=vr;function rn(){this.yy={}}return rn.prototype=Wr,Wr.Parser=rn,new rn}();typeof je<"u"&&(A.parser=k,A.Parser=k.Parser,A.parse=function(){return k.parse.apply(k,arguments)})}),fp=cp;function pa(S){if(S instanceof String||typeof S=="string"||S instanceof Buffer)try{return fp.parse(S.toString())}catch(A){throw new xu(A)}return S}function bd(S,A=Ze){let k=S;try{k=pa(k)}catch(le){return[le]}return rh(k,A)}const Kc=8,Hl=15;function ql(S,A){return!S||Yn(S)!=="string"?!0:!!S.match(A)}function Ed(S){return S.url?S.url.split(",").length:0}function nh(S,A,k){const le=new Set(A),Pe=[];return Object.keys(S).forEach(De=>{if(!le.has(De)){const He=k?`${k}.${De}`:null;Pe.push(new _r(He,S[De],`Unsupported property "${De}"`))}}),Pe}const ih=new Set(["vector","raster","raster-dem"]);function ah(S,A){const k=[],le=["type","url","tileSize"];k.push(...nh(S,le,"source")),ih.has(String(S.type))||k.push(new _r(`sources[${A}].type`,S.type,`Expected one of [${Array.from(ih).join(", ")}]`));const Pe=/^mapbox:\/\/([^/]*)$/;return(!S.url||!ql(S.url,Pe))&&k.push(new _r(`sources[${A}].url`,S.url,"Expected a valid Mapbox tileset url")),k}function sh(S){const A=[];let k=0;return Object.keys(S).forEach((le,Pe)=>{const De=ah(S[le],Pe);De.length||(k=k+Ed(S[le])),A.push(...De)}),k>Hl&&A.push(new _r("sources",null,`Styles must contain ${Hl} or fewer sources`)),A}function hp(S,A){const k=[],le=["owner","id","cacheControl","draft","created","modified","visibility","protected"],Pe=nh(S,[...A,...le]);k.push(...Pe),(S.version>Kc||S.version<Kc)&&k.push(new _r("version",S.version,`Style version must be ${Kc}`));const De=/^mapbox:\/\/fonts\/([^/]*)\/{fontstack}\/{range}.pbf$/;ql(S.glyphs,De)||k.push(new _r("glyphs",S.glyphs,"Styles must reference glyphs hosted by Mapbox"));const He=/^mapbox:\/\/sprites\/([^/]*)\/([^/]*)\/?([^/]*)?$/;ql(S.sprite,He)||k.push(new _r("sprite",S.sprite,"Styles must reference sprites hosted by Mapbox"));const nt=/^(public|private)$/;return ql(S.visibility,nt)||k.push(new _r("visibility",S.visibility,"Style visibility must be public or private")),S.protected!==void 0&&Yn(S.protected)!=="boolean"&&k.push(new _r("protected",S.protected,"Style protection must be true or false")),k}function Ma(S){let A=S;try{A=pa(A)}catch(le){return[le]}let k=rh(A,Ze).concat(hp(A,Object.keys(Ze.$root)));return A.sources&&(k=k.concat(sh(A.sources))),k}const Td={StyleExpression:Gc,isExpression:vu,isExpressionFilter:Zs,createExpression:Oo,createPropertyExpression:lo,normalizePropertyExpression:co,ZoomConstantExpression:kl,ZoomDependentExpression:zi,StylePropertyFunction:Ti},dp={convertFunction:$f,createFunction:Gn,isFunction:Fl},ef={eachSource:ss,eachLayer:Ii,eachProperty:Ha};h.Color=ca,h.ParsingError=xu,h.ValidationError=_r,h.composite=Na,h.convertFilter=Ul,h.derefLayers=$0,h.diff=Ys,h.expression=Td,h.featureFilter=Aa,h.format=me,h.function=dp,h.latest=Ze,h.migrate=Ju,h.v8=Ze,h.validate=bd,h.validateMapboxApiSupported=Ma,h.visit=ef,Object.defineProperty(h,"__esModule",{value:!0})})}(ky,ky.exports)),ky.exports}var WE;function I0(){return WE||(WE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.cacheStyle=void 0,a.readExpression=H;var R=u(Ir()),M=u(kr()),v=Uf(),y=u(Bf()),p=u(dl()),g=D($R());function C(G){if(typeof WeakMap!="function")return null;var j=new WeakMap,K=new WeakMap;return(C=function(se){return se?K:j})(G)}function D(G,j){if(!j&&G&&G.__esModule)return G;if(G===null||h(G)!=="object"&&typeof G!="function")return{default:G};var K=C(j);if(K&&K.has(G))return K.get(G);var ce={},se=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in G)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(G,ue)){var Y=se?Object.getOwnPropertyDescriptor(G,ue):null;Y&&(Y.get||Y.set)?Object.defineProperty(ce,ue,Y):ce[ue]=G[ue]}return ce.default=G,K&&K.set(G,ce),ce}function B(G,j){var K=typeof Symbol<"u"&&G[Symbol.iterator]||G["@@iterator"];if(!K){if(Array.isArray(G)||(K=V(G))||j&&G&&typeof G.length=="number"){K&&(G=K);var ce=0,se=function(){};return{s:se,n:function(){return ce>=G.length?{done:!0}:{done:!1,value:G[ce++]}},e:function(Fe){throw Fe},f:se}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ue=!0,Y=!1,pe;return{s:function(){K=K.call(G)},n:function(){var Fe=K.next();return ue=Fe.done,Fe},e:function(Fe){Y=!0,pe=Fe},f:function(){try{!ue&&K.return!=null&&K.return()}finally{if(Y)throw pe}}}}function V(G,j){if(!!G){if(typeof G=="string")return P(G,j);var K=Object.prototype.toString.call(G).slice(8,-1);if(K==="Object"&&G.constructor&&(K=G.constructor.name),K==="Map"||K==="Set")return Array.from(G);if(K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K))return P(G,j)}}function P(G,j){(j==null||j>G.length)&&(j=G.length);for(var K=0,ce=new Array(j);K<j;K++)ce[K]=G[K];return ce}var L=`.itowns-stroke-single:before {
    display: var(--text_stroke_display);
    content: attr(data-before);
    opacity: 1;
    position: absolute;
    -webkit-text-stroke-width: var(--text_stroke_width);
    -webkit-text-stroke-color: var(--text_stroke_color);
    left: 0;
    right: 0;
    bottom: 0;
    top: 0;
    z-index: -1;
    white-space: inherit;
    overflow-wrap: inherit;
    letter-spacing: inherit;
    text-align: inherit;
    padding: inherit;
    font-family: inherit;
    text-transform: inherit;
    max-width: inherit;
    font-size: inherit;
}
`,E=new y.default;a.cacheStyle=E;var b=1/255,_=document.createElement("canvas"),x={};function T(){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{z:0};return G.z}function N(G,j,K,ce){K[G]=K[G]||{};var se=B(x[G]),ue;try{for(se.s();!(ue=se.n()).done;){var Y=ue.value,pe=H(j[G][Y],ce);pe!==void 0&&(K[G][Y]=pe)}}catch(Ee){se.e(Ee)}finally{se.f()}}function U(G){if(G){if(G.stops||G.expression)return{color:G};if(typeof G=="string"){var j=G.match(/(?:((hsl|rgb)a? *\(([\d.%]+(?:deg|g?rad|turn)?)[ ,]*([\d.%]+)[ ,]*([\d.%]+)[ ,/]*([\d.%]*)\))|(#((?:[\d\w]{3}){1,2})([\d\w]{1,2})?))/i);if(j){if(j[7]){var K=1;return j[9]&&(K=parseInt(j[9].length==1?"".concat(j[9]).concat(j[9]):j[9],16)*b),{color:"#".concat(j[8]),opacity:K}}else if(j[0])return{color:"".concat(j[2],"(").concat(j[3],",").concat(j[4],",").concat(j[5],")"),opacity:Number(j[6])||1}}else return{color:G,opacity:1}}}else return{}}function H(G,j){if(G!=null){if(G.expression)return G.expression.evaluate(j);if(G.stops){for(var K=G.stops.length-1;K>=0;K--){var ce=G.stops[K];if(j.globals.zoom>=ce[0])return ce[1]}return G.stops[0][1]}else return G instanceof Function?G(j.properties()):G}}function q(G,j){if(G!=null)return g.expression.isExpression(G)?g.expression.createExpression(G,j).value:G.base||G}function te(G,j){var K=document.createElement("img");if(typeof G=="string")K.src=G;else if(G&&G[j]){var ce=G[j];_.width=ce.width,_.height=ce.height,_.getContext("2d").drawImage(G.img,ce.x,ce.y,ce.width,ce.height,0,0,ce.width,ce.height),K.src=_.toDataURL("image/png")}return K}var Q={left:[0,-.5],right:[-1,-.5],top:[-.5,0],bottom:[-.5,-1],"top-right":[-1,0],"bottom-left":[0,-1],"bottom-right":[-1,-1],center:[-.5,-.5],"top-left":[0,0]};function Z(G,j,K,ce,se){var ue;Object.defineProperty(G[j],K,{enumerable:!0,get:function(){return ue===void 0?G.parent[j][K]||se:ue},set:function(pe){ue=pe}}),G[j][K]=ce}var ae=function(){function G(){var j=this,K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ce=arguments.length>1?arguments[1]:void 0;(0,R.default)(this,G),this.isStyle=!0,this.order=0,this.parent=ce||{zoom:{},fill:{},stroke:{},point:{},text:{},icon:{}},K.zoom=K.zoom||{},K.fill=K.fill||{},K.stroke=K.stroke||{},K.point=K.point||{},K.text=K.text||{},K.icon=K.icon||{},this.zoom={},Z(this,"zoom","min",K.zoom.min),Z(this,"zoom","max",K.zoom.max),this.fill={},Z(this,"fill","color",K.fill.color),Z(this,"fill","opacity",K.fill.opacity,1),Z(this,"fill","pattern",K.fill.pattern),Z(this,"fill","base_altitude",K.fill.base_altitude,T),Z(this,"fill","extrusion_height",K.fill.extrusion_height),typeof this.fill.pattern=="string"&&p.default.texture(this.fill.pattern).then(function(se){j.fill.pattern=se.image}),this.stroke={},Z(this,"stroke","color",K.stroke.color),Z(this,"stroke","opacity",K.stroke.opacity,1),Z(this,"stroke","width",K.stroke.width,1),Z(this,"stroke","dasharray",K.stroke.dasharray,[]),Z(this,"stroke","base_altitude",K.stroke.base_altitude,T),this.point={},Z(this,"point","color",K.point.color),Z(this,"point","line",K.point.line),Z(this,"point","opacity",K.point.opacity,1),Z(this,"point","radius",K.point.radius,2),Z(this,"point","width",K.point.width,0),Z(this,"point","base_altitude",K.point.base_altitude,T),this.text={},Z(this,"text","field",K.text.field),Z(this,"text","zOrder",K.text.zOrder,"auto"),Z(this,"text","color",K.text.color,"#000000"),Z(this,"text","anchor",K.text.anchor,"center"),Z(this,"text","offset",K.text.offset,[0,0]),Z(this,"text","padding",K.text.padding,2),Z(this,"text","size",K.text.size,16),Z(this,"text","placement",K.text.placement,"point"),Z(this,"text","rotation",K.text.rotation,"auto"),Z(this,"text","wrap",K.text.wrap,10),Z(this,"text","spacing",K.text.spacing,0),Z(this,"text","transform",K.text.transform,"none"),Z(this,"text","justify",K.text.justify,"center"),Z(this,"text","opacity",K.text.opacity,1),Z(this,"text","font",K.text.font,["Open Sans Regular","Arial Unicode MS Regular","sans-serif"]),Z(this,"text","haloColor",K.text.haloColor,"#000000"),Z(this,"text","haloWidth",K.text.haloWidth,0),Z(this,"text","haloBlur",K.text.haloBlur,0),this.icon={},Z(this,"icon","source",K.icon.source),Z(this,"icon","key",K.icon.key),Z(this,"icon","anchor",K.icon.anchor,"center"),Z(this,"icon","size",K.icon.size,1)}return(0,M.default)(G,[{key:"drawingStylefromContext",value:function(K){var ce={};if((this.fill.color||this.fill.pattern||K.globals.fill)&&N("fill",this,ce,K),(this.stroke.color||K.globals.stroke)&&N("stroke",this,ce,K),(this.point.color||K.globals.point)&&N("point",this,ce,K),Object.keys(ce).length)return ce}},{key:"symbolStylefromContext",value:function(K){var ce=new G;return N("text",this,ce,K),this.icon&&N("icon",this,ce,K),ce.order=this.order,ce}},{key:"copy",value:function(K){return Object.assign(this.fill,K.fill),Object.assign(this.stroke,K.stroke),Object.assign(this.point,K.point),Object.assign(this.text,K.text),Object.assign(this.icon,K.icon),this}},{key:"clone",value:function(){var j=new G;return j.copy(this)}},{key:"setFromGeojsonProperties",value:function(K,ce){return ce===v.FEATURE_TYPES.POINT?(this.point.color=K.fill,this.point.opacity=K["fill-opacity"],this.point.line=K.stroke,this.point.radius=K.radius,this.text.color=K["label-color"],this.text.opacity=K["label-opacity"],this.text.size=K["label-size"],K.icon&&(this.icon.source=K.icon)):(this.stroke.color=K.stroke,this.stroke.width=K["stroke-width"],this.stroke.opacity=K["stroke-opacity"],ce!==v.FEATURE_TYPES.LINE&&(this.fill.color=K.fill,this.fill.opacity=K["fill-opacity"])),this}},{key:"setFromVectorTileLayer",value:function(K,ce){var se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ue=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(K.layout=K.layout||{},K.paint=K.paint||{},this.order=se,K.type==="fill"&&!this.fill.color){var Y=U(q(K.paint["fill-color"]||K.paint["fill-pattern"],{type:"color"})),pe=Y.color,Ee=Y.opacity;if(this.fill.color=pe,this.fill.opacity=q(K.paint["fill-opacity"])||Ee,K.paint["fill-pattern"]&&ce&&(this.fill.pattern=te(ce,K.paint["fill-pattern"])),K.paint["fill-outline-color"]){var Fe=U(q(K.paint["fill-outline-color"],{type:"color"})),$e=Fe.color,pt=Fe.opacity;this.stroke.color=$e,this.stroke.opacity=pt,this.stroke.width=1,this.stroke.dasharray=[]}}else if(K.type==="line"&&!this.stroke.color){var Ue=q(K.paint["line-color"],{type:"color"}),Je=U(Ue),et=Je.color,ze=Je.opacity;this.stroke.dasharray=q(K.paint["line-dasharray"]),this.stroke.color=et,this.stroke.lineCap=K.layout["line-cap"],this.stroke.width=q(K.paint["line-width"]),this.stroke.opacity=q(K.paint["line-opacity"])||ze}else if(K.type==="circle"||ue){var Xe=U(q(K.paint["circle-color"],{type:"color"})),tt=Xe.color,ye=Xe.opacity;this.point.color=tt,this.point.opacity=ye,this.point.radius=q(K.paint["circle-radius"])}else if(K.type==="symbol"){this.text.zOrder=q(K.layout["symbol-z-order"]),this.text.zOrder=="auto"?this.text.zOrder=q(K.layout["symbol-sort-key"])||"Y":this.text.zOrder=="viewport-y"?this.text.zOrder="Y":this.text.zOrder=="source"&&(this.text.zOrder=0),this.text.anchor=q(K.layout["text-anchor"]),this.text.offset=q(K.layout["text-offset"]),this.text.padding=q(K.layout["text-padding"]),this.text.size=q(K.layout["text-size"]),this.text.placement=q(K.layout["symbol-placement"]),this.text.rotation=q(K.layout["text-rotation-alignment"]),this.text.field=q(K.layout["text-field"]),this.text.wrap=q(K.layout["text-max-width"]),this.text.spacing=q(K.layout["text-letter-spacing"]),this.text.transform=q(K.layout["text-transform"]),this.text.justify=q(K.layout["text-justify"]);var Ze=U(q(K.paint["text-color"],{type:"color"})),Ge=Ze.color,Ae=Ze.opacity;this.text.color=Ge,this.text.opacity=q(K.paint["text-opacity"])||Ae!==void 0&&Ae,this.text.font=q(K.layout["text-font"]);var Se=q(K.paint["text-halo-color"],{type:"color"});Se&&(this.text.haloColor=Se.color||Se,this.text.haloWidth=q(K.paint["text-halo-width"]),this.text.haloBlur=q(K.paint["text-halo-blur"]));var Te=q(K.layout["icon-image"]);Te&&(this.icon.key=Te,this.icon.size=q(K.layout["icon-size"])||1)}return this}},{key:"applyToHTML",value:function(K,ce){var se=this;if(K.style.padding="".concat(this.text.padding,"px"),K.style.maxWidth="".concat(this.text.wrap,"em"),K.style.color=this.text.color,this.text.size>0&&(K.style.fontSize="".concat(this.text.size,"px")),K.style.fontFamily=this.text.font.join(","),K.style.textTransform=this.text.transform,K.style.letterSpacing="".concat(this.text.spacing,"em"),K.style.textAlign=this.text.justify,K.style["white-space"]="pre-line",this.text.haloWidth>0&&(K.style.setProperty("--text_stroke_display","block"),K.style.setProperty("--text_stroke_width","".concat(this.text.haloWidth,"px")),K.style.setProperty("--text_stroke_color",this.text.haloColor),K.setAttribute("data-before",K.textContent)),!(!this.icon.source&&!this.icon.key)){var ue=this.icon.source,Y=this.icon.size,pe=this.icon.key,Ee=E.get(ue||pe,Y);Ee||(pe&&ce?Ee=te(ce,pe):Ee=te(ue),E.set(Ee,ue||pe,Y));var Fe=function(){var $e=Ee.cloneNode();switch($e.setAttribute("class","itowns-icon"),$e.width=Ee.width*se.icon.size,$e.height=Ee.height*se.icon.size,$e.style.position="absolute",$e.style.top="0",$e.style.left="0",se.icon.anchor){case"left":$e.style.top="".concat(-.5*$e.height,"px");break;case"right":$e.style.top="".concat(-.5*$e.height,"px"),$e.style.left="".concat(-$e.width,"px");break;case"top":$e.style.left="".concat(-.5*$e.width,"px");break;case"bottom":$e.style.top="".concat(-$e.height,"px"),$e.style.left="".concat(-.5*$e.width,"px");break;case"bottom-left":$e.style.top="".concat(-$e.height,"px");break;case"bottom-right":$e.style.top="".concat(-$e.height,"px"),$e.style.left="".concat(-$e.width,"px");break;case"top-left":break;case"top-right":$e.style.left="".concat(-$e.width,"px");break;case"center":default:$e.style.top="".concat(-.5*$e.height,"px"),$e.style.left="".concat(-.5*$e.width,"px");break}$e.style["z-index"]=-1,K.appendChild($e),Ee.removeEventListener("load",Fe)};Ee.complete?Fe():Ee.addEventListener("load",Fe)}}},{key:"getTextAnchorPosition",value:function(){return typeof this.text.anchor=="string"?Object.keys(Q).includes(this.text.anchor)?Q[this.text.anchor]:(console.error("".concat(this.text.anchor," is not a valid input for Style.text.anchor parameter.")),Q.center):this.text.anchor}},{key:"getTextFromProperties",value:function(K){if(!!this.text.field)return this.text.field.expression?H(this.text.field,K):this.text.field.replace(/\{(.+?)\}/g,function(ce,se){return K.properties()[se]||""}).trim()}}]),G}(),F={itowns_stroke_single_before:L},W=document.createElement("style");W.type="text/css",Object.keys(F).forEach(function(G){W.innerHTML+="".concat(F[G],`

`)}),document.getElementsByTagName("head")[0].appendChild(W);var O=new ae;x.fill=Object.keys(O.fill),x.stroke=Object.keys(O.stroke),x.point=Object.keys(O.point),x.text=Object.keys(O.text),x.icon=Object.keys(O.icon);var X=ae;a.default=X}(yA)),yA}var HE;function Uf(){return HE||(HE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.FeatureGeometry=a.FeatureCollection=a.FeatureBuildingOptions=a.FEATURE_TYPES=void 0;var R=u(Wi()),M=u(Cs()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(Kh()),C=u(O0()),D=u(kr()),B=u(Ir()),V=x(Dr()),P=u(ya()),L=u(Zi()),E=u(ps()),b=u(I0());function _(ze){if(typeof WeakMap!="function")return null;var Xe=new WeakMap,tt=new WeakMap;return(_=function(Ze){return Ze?tt:Xe})(ze)}function x(ze,Xe){if(!Xe&&ze&&ze.__esModule)return ze;if(ze===null||h(ze)!=="object"&&typeof ze!="function")return{default:ze};var tt=_(Xe);if(tt&&tt.has(ze))return tt.get(ze);var ye={},Ze=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ge in ze)if(Ge!=="default"&&Object.prototype.hasOwnProperty.call(ze,Ge)){var Ae=Ze?Object.getOwnPropertyDescriptor(ze,Ge):null;Ae&&(Ae.get||Ae.set)?Object.defineProperty(ye,Ge,Ae):ye[Ge]=ze[Ge]}return ye.default=ze,tt&&tt.set(ze,ye),ye}function T(ze,Xe){var tt=typeof Symbol<"u"&&ze[Symbol.iterator]||ze["@@iterator"];if(!tt){if(Array.isArray(ze)||(tt=N(ze))||Xe&&ze&&typeof ze.length=="number"){tt&&(ze=tt);var ye=0,Ze=function(){};return{s:Ze,n:function(){return ye>=ze.length?{done:!0}:{done:!1,value:ze[ye++]}},e:function(me){throw me},f:Ze}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ge=!0,Ae=!1,Se;return{s:function(){tt=tt.call(ze)},n:function(){var me=tt.next();return Ge=me.done,me},e:function(me){Ae=!0,Se=me},f:function(){try{!Ge&&tt.return!=null&&tt.return()}finally{if(Ae)throw Se}}}}function N(ze,Xe){if(!!ze){if(typeof ze=="string")return U(ze,Xe);var tt=Object.prototype.toString.call(ze).slice(8,-1);if(tt==="Object"&&ze.constructor&&(tt=ze.constructor.name),tt==="Map"||tt==="Set")return Array.from(ze);if(tt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(tt))return U(ze,Xe)}}function U(ze,Xe){(Xe==null||Xe>ze.length)&&(Xe=ze.length);for(var tt=0,ye=new Array(Xe);tt<Xe;tt++)ye[tt]=ze[tt];return ye}function H(ze){var Xe=q();return function(){var tt=(0,p.default)(ze),ye;if(Xe){var Ze=(0,p.default)(this).constructor;ye=Reflect.construct(tt,arguments,Ze)}else ye=tt.apply(this,arguments);return(0,y.default)(this,ye)}}function q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function te(ze,Xe,tt){Q(ze,Xe),Xe.set(ze,tt)}function Q(ze,Xe){if(Xe.has(ze))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z(ze){return new P.default(ze,1/0,-1/0,1/0,-1/0)}function ae(ze,Xe){ze.vertices.length+=Xe*ze.size,ze.normals&&(ze.normals.length=ze.vertices.length)}function F(ze,Xe,tt,ye,Ze,Ge){Xe.normals&&Ge.toArray(Xe.normals,Xe._pos),Xe._pushValues(tt,ye,Ze),ze.size==3&&(ze.altitude.min=Math.min(ze.altitude.min,Ze),ze.altitude.max=Math.max(ze.altitude.max,Ze))}var W=new L.default("EPSG:4326",0,0,0),O={POINT:0,LINE:1,POLYGON:2};a.FEATURE_TYPES=O;var X=["point","stroke","fill"],G=(0,D.default)(function ze(){(0,B.default)(this,ze)});a.FeatureBuildingOptions=G;var j=new WeakMap,K=function(){function ze(Xe){(0,B.default)(this,ze),te(this,j,{writable:!0,value:void 0}),this.indices=[],this.properties={},this.size=Xe.size,Xe.extent&&(this.extent=Z(Xe.extent.crs),(0,C.default)(this,j,Z(Xe.extent.crs))),this.altitude={min:1/0,max:-1/0}}return(0,D.default)(ze,[{key:"startSubGeometry",value:function(tt,ye){var Ze=this.indices.length-1,Ge=this.extent?Z(this.extent.crs):void 0,Ae=Ze>-1?this.indices[Ze].offset+this.indices[Ze].count:ye.vertices.length/this.size;this.indices.push({offset:Ae,count:tt,extent:Ge}),(0,C.default)(this,j,Ge),ae(ye,tt)}},{key:"closeSubGeometry",value:function(tt,ye){var Ze=this.indices.length-1,Ge=Ze>-1?this.indices[Ze].offset+this.indices[Ze].count:ye.vertices.length/this.size-tt;this.indices.push({offset:Ge,count:tt,extent:(0,g.default)(this,j)}),this.extent&&(this.extent.union((0,g.default)(this,j)),(0,C.default)(this,j,Z(this.extent.crs)))}},{key:"getLastSubGeometry",value:function(){var tt=this.indices.length-1;return this.indices[tt]}},{key:"baseAltitude",value:function(tt,ye){var Ze=tt.style[X[tt.type]].base_altitude||0;return isNaN(Ze)?Ze(this.properties,ye):Ze}},{key:"pushCoordinates",value:function(tt,ye){tt.z=this.baseAltitude(ye,tt),tt.as(ye.crs,W),ye.transformToLocalSystem(W),F(this,ye,W.x,W.y,W.z,W.geodesicNormal),(0,g.default)(this,j)&&(0,g.default)(this,j).expandByCoordinates(ye.useCrsOut?W:tt)}},{key:"pushCoordinatesValues",value:function(tt,ye,Ze,Ge){var Ae=this.baseAltitude(tt);F(this,tt,ye,Ze,Ae,Ge),(0,g.default)(this,j)&&(0,g.default)(this,j).expandByValuesCoordinates(ye,Ze)}},{key:"updateExtent",value:function(){if(this.extent){var tt=this.indices[this.indices.length-1];tt&&this.extent.union(tt.extent)}}}]),ze}();a.FeatureGeometry=K;function ce(ze,Xe){this.vertices[this._pos++]=ze,this.vertices[this._pos++]=Xe}function se(ze,Xe){var tt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;this.vertices[this._pos++]=ze,this.vertices[this._pos++]=Xe,this.vertices[this._pos++]=tt}var ue=function(){function ze(Xe,tt){if((0,B.default)(this,ze),Object.keys(O).find(function(ye){return O[ye]===Xe}))this.type=Xe;else throw new Error("Unsupported Feature type: ".concat(Xe));this.geometries=[],this.vertices=[],this.crs=tt.crs,this.size=tt.size,this.normals=tt.crs=="EPSG:4978"?[]:void 0,this.transformToLocalSystem=tt.transformToLocalSystem.bind(tt),tt.extent&&(this.extent=Z(tt.extent.crs),this.useCrsOut=this.extent.crs==this.crs),this._pos=0,this._pushValues=(this.size===3?se:ce).bind(this),this.style=new b.default({},tt.style),this.altitude={min:1/0,max:-1/0}}return(0,D.default)(ze,[{key:"bindNewGeometry",value:function(){var tt=new K(this);return this.geometries.push(tt),tt}},{key:"updateExtent",value:function(tt){this.extent&&this.extent.union(tt.extent),this.size==3&&(this.altitude.min=Math.min(this.altitude.min,tt.altitude.min),this.altitude.max=Math.max(this.altitude.max,tt.altitude.max))}},{key:"geometryCount",get:function(){return this.geometries.length}}]),ze}(),Y=ue;a.default=Y;var pe=function(){},Ee=function(ze,Xe){return ze.geodesicNormal.applyNormalMatrix(Xe.normalMatrixInverse),ze.applyMatrix4(Xe.matrixWorldInverse)},Fe=function(ze,Xe){return ze.applyMatrix4(Xe.matrixWorldInverse)},$e=new V.Vector3(0,0,1),pt=new V.Quaternion,Ue=new WeakMap,Je=new WeakMap,et=function(ze){(0,v.default)(tt,ze);var Xe=H(tt);function tt(ye){var Ze,Ge;return(0,B.default)(this,tt),Ge=Xe.call(this),te((0,R.default)(Ge),Ue,{writable:!0,value:Fe}),te((0,R.default)(Ge),Je,{writable:!0,value:pe}),Ge.isFeatureCollection=!0,Ge.crs=E.default.formatToEPSG(ye.accurate||!((Ze=ye.source)!==null&&Ze!==void 0&&Ze.crs)?ye.crs:ye.source.crs),Ge.features=[],Ge.mergeFeatures=ye.mergeFeatures===void 0?!0:ye.mergeFeatures,Ge.size=ye.structure=="3d"?3:2,Ge.filterExtent=ye.filterExtent,Ge.style=ye.style,Ge.isInverted=!1,Ge.matrixWorldInverse=new V.Matrix4,Ge.center=new L.default("EPSG:4326",0,0),Ge.size==2?(Ge.extent=ye.buildExtent===!1?void 0:Z(ye.forcedExtentCrs||Ge.crs),(0,C.default)((0,R.default)(Ge),Je,function(Ae){Ae.as("EPSG:4326",Ge.center),Ge.position.copy(Ae),Ge.updateMatrixWorld(),(0,C.default)((0,R.default)(Ge),Je,pe)})):(Ge.extent=ye.buildExtent?Z(ye.forcedExtentCrs||Ge.crs):void 0,(0,C.default)((0,R.default)(Ge),Je,function(Ae){Ae.as("EPSG:4326",Ge.center),Ge.crs=="EPSG:4978"&&(Ge.quaternion.setFromUnitVectors($e,Ae.geodesicNormal),pt.setFromAxisAngle($e,V.MathUtils.degToRad(90+Ge.center.longitude)),Ge.quaternion.multiply(pt)),Ge.position.copy(Ae),Ge.updateMatrixWorld(),Ge.normalMatrix.getNormalMatrix(Ge.matrix),Ge.normalMatrixInverse=new V.Matrix3().copy(Ge.normalMatrix).invert(),(0,C.default)((0,R.default)(Ge),Je,pe)}),(0,C.default)((0,R.default)(Ge),Ue,Ee)),Ge.altitude={min:1/0,max:-1/0},Ge}return(0,D.default)(tt,[{key:"transformToLocalSystem",value:function(Ze){return(0,g.default)(this,Je).call(this,Ze),(0,g.default)(this,Ue).call(this,Ze,this)}},{key:"updateExtent",value:function(Ze){if(this.extent){var Ge=Ze?[Ze]:this.features.map(function(je){return je.extent}),Ae=T(Ge),Se;try{for(Ae.s();!(Se=Ae.n()).done;){var Te=Se.value;this.extent.union(Te)}}catch(je){Ae.e(je)}finally{Ae.f()}}if(this.size==3){var me=T(this.features),be;try{for(me.s();!(be=me.n()).done;){var we=be.value;this.altitude.min=Math.min(this.altitude.min,we.altitude.min),this.altitude.max=Math.max(this.altitude.max,we.altitude.max)}}catch(je){me.e(je)}finally{me.f()}}this.altitude.min=this.altitude.min==1/0?0:this.altitude.min,this.altitude.max=this.altitude.max==-1/0?0:this.altitude.max}},{key:"updateMatrixWorld",value:function(Ze){(0,M.default)((0,p.default)(tt.prototype),"updateMatrixWorld",this).call(this,Ze),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"removeEmptyFeature",value:function(){this.features=this.features.filter(function(Ze){return Ze.geometries.length})}},{key:"pushFeature",value:function(Ze){this.features.push(Ze),this.updateExtent(Ze.extent)}},{key:"requestFeature",value:function(Ze,Ge){var Ae=this.features.find(Ge);if(Ae&&this.mergeFeatures)return Ae;var Se=new ue(Ze,this);return this.features.push(Se),Se}},{key:"requestFeatureByType",value:function(Ze){return this.requestFeature(Ze,function(Ge){return Ge.type===Ze})}},{key:"requestFeatureById",value:function(Ze,Ge){return this.requestFeature(Ge,function(Ae){return Ae.id===Ze})}},{key:"newFeatureByReference",value:function(Ze){var Ge=new ue(Ze.type,this);return Ge.extent=Ze.extent,Ge.geometries=Ze.geometries,Ge.normals=Ze.normals,Ge.size=Ze.size,Ge.vertices=Ze.vertices,Ge.altitude.min=Ze.altitude.min,Ge.altitude.max=Ze.altitude.max,Ge._pos=Ze._pos,this.features.push(Ge),Ge}},{key:"setParentStyle",value:function(Ze){Ze&&this.features.forEach(function(Ge){Ge.style.parent=Ze})}}]),tt}(V.Object3D);a.FeatureCollection=et}(gA)),gA}var AA={},qE;function nd(){return qE||(qE=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.deprecatedParsingOptionsToNewOne=a.deprecatedFeature2MeshOptions=a.deprecatedColorLayerOptions=a.default=void 0;var u=rd(),h=function(y){return y.fx&&(console.warn("ColorLayer fx is deprecated, use ColorLayer.effect_type and ColorLayer.effect_parameter instead."),y.fx>2?(y.effect_parameter=y.fx,y.effect_type=u.colorLayerEffects.removeLightColor):y.fx>0&&(y.effect_parameter=y.fx,y.effect_type=u.colorLayerEffects.removeWhiteColor)),y};a.deprecatedColorLayerOptions=h;var R=function(y){if(y.crsOut||y.crsIn){console.warn("Parsing options with crsIn and crsOut are deprecated, use { in, out } structure.");var p={in:{},out:{}};return p.in.crs=y.crsIn,p.in.isInverted=y.isInverted,p.in.styles=y.styles,p.in.layers=y.layers,p.in.filter=y.filter,p.out.crs=y.crsOut,p.out.mergeFeatures=y.mergeFeatures,y.withAltitude&&y.withNormal?(console.warn("Parsing options withAltitude and withNormal is deprecated, use out.structure: 2d or 3d."),p.out.structure="3d"):p.out.structure="2d",p.out.filteringExtent=y.filteringExtent,p.out.style=y.style,y.crsOut.overrideAltitudeInToZero!==void 0&&console.error("Parsing options out.overrideAltitudeInToZero is removed, use Style.xxx.base_altitude instead"),p.out.filter=y.filter,p}return y.out&&((y.out.withAltitude!==void 0||y.out.withNormal!==void 0)&&(console.warn("Parsing options out.withAltitude and out.withNormal is deprecated, use out.structure: 2d or 3d."),y.out.withAltitude&&y.out.withNormal?y.out.structure="3d":y.out.structure="2d"),y.out.overrideAltitudeInToZero!==void 0&&console.error("Parsing options out.overrideAltitudeInToZero is removed, use Style.xxx.base_altitude instead")),y};a.deprecatedParsingOptionsToNewOne=R;var M=function(y){y.color&&console.error("Color convert option is removed, use Style.xxx.color"),y.extrude&&console.error("extrude convert option is removed, use Style.fill.extrusion_height instead"),y.altitude&&console.error("altitude convert option is removed, use Style.xxx.base_altitude instead")};a.deprecatedFeature2MeshOptions=M;var v={};a.default=v}(AA)),AA}var XE;function k0(){return XE||(XE=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Zi()),R=Uf(),M=u(I0()),v=nd();function y(U,H){var q=typeof Symbol<"u"&&U[Symbol.iterator]||U["@@iterator"];if(!q){if(Array.isArray(U)||(q=p(U))||H&&U&&typeof U.length=="number"){q&&(U=q);var te=0,Q=function(){};return{s:Q,n:function(){return te>=U.length?{done:!0}:{done:!1,value:U[te++]}},e:function(O){throw O},f:Q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Z=!0,ae=!1,F;return{s:function(){q=q.call(U)},n:function(){var O=q.next();return Z=O.done,O},e:function(O){ae=!0,F=O},f:function(){try{!Z&&q.return!=null&&q.return()}finally{if(ae)throw F}}}}function p(U,H){if(!!U){if(typeof U=="string")return g(U,H);var q=Object.prototype.toString.call(U).slice(8,-1);if(q==="Object"&&U.constructor&&(q=U.constructor.name),q==="Map"||q==="Set")return Array.from(U);if(q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(q))return g(U,H)}}function g(U,H){(H==null||H>U.length)&&(H=U.length);for(var q=0,te=new Array(H);q<H;q++)te[q]=U[q];return te}function C(U){if(U.crs){if(U.crs.type.toLowerCase()=="epsg")return"EPSG:".concat(U.crs.properties.code);if(U.crs.type.toLowerCase()=="name"){if(U.crs.properties.name.toLowerCase().includes("epsg:")){var H=U.crs.properties.name.lastIndexOf(":");if(H>0)return"EPSG:".concat(U.crs.properties.name.substr(H+1))}throw new Error("Unsupported CRS authority '".concat(U.crs.properties.name,"'"))}throw new Error("Unsupported CRS type '".concat(U.crs,"'"))}return"EPSG:4326"}var D=new h.default("EPSG:4978",0,0,0),B=new h.default("EPSG:4978",0,0,0),V=new h.default("EPSG:4978",0,0,0),P=function(U,H,q){return D.crs=q,D.setFromArray(H[0]),!U.isPointInside(D)},L={populateGeometry:function(H,q,te,Q){te.startSubGeometry(q.length,Q),D.crs=H;var Z=y(q),ae;try{for(Z.s();!(ae=Z.n()).done;){var F=ae.value;D.setFromValues(F[0],F[1],F[2]),te.pushCoordinates(D,Q)}}catch(W){Z.e(W)}finally{Z.f()}te.updateExtent()},populateGeometryWithCCW:function(H,q,te,Q){te.startSubGeometry(q.length,Q),D.crs=H;var Z=0;V.setFromValues(q[0][0],q[0][1],q[0][2]),B.copy(V);for(var ae=0;ae<q.length;ae++)D.setFromValues(q[ae][0],q[ae][1],q[ae][2]),Z+=(B.x-D.x)*(B.y+D.y),B.copy(D),te.pushCoordinates(D,Q);Z+=(B.x-V.x)*(B.y+V.y),te.getLastSubGeometry().ccw=Z<0,te.updateExtent()},point:function(H,q,te,Q,Z){this.default(H,q,[te],Q,Z)},default:function(H,q,te,Q,Z){if(!(Q.filterExtent&&P(Q.filterExtent,te,q))){var ae=H.bindNewGeometry();ae.properties=Z,ae.properties.style=new M.default({},H.style).setFromGeojsonProperties(Z,H.type),this.populateGeometry(q,te,ae,H),H.updateExtent(ae)}},polygon:function(H,q,te,Q,Z){if(!(Q.filterExtent&&P(Q.filterExtent,te[0],q))){var ae=H.bindNewGeometry();ae.properties=Z,ae.properties.style=new M.default({},H.style).setFromGeojsonProperties(Z,H.type);for(var F=0;F<te.length;F++)this.populateGeometryWithCCW(q,te[F],ae,H);H.updateExtent(ae)}},multi:function(H,q,te,Q,Z,ae){var F=y(Q),W;try{for(F.s();!(W=F.n()).done;){var O=W.value;this[H](q,te,O,Z,ae)}}catch(X){F.e(X)}finally{F.f()}}};function E(U,H,q,te,Q,Z){if(te.length!=0)switch(U){case"point":case"linestring":return L.default(H,q,te,Q,Z);case"multipoint":return L.multi("point",H,q,te,Q,Z);case"multilinestring":return L.multi("default",H,q,te,Q,Z);case"polygon":return L.polygon(H,q,te,Q,Z);case"multipolygon":return L.multi("polygon",H,q,te,Q,Z);case"geometrycollection":default:throw new Error("Unhandled geojson type ".concat(H.type))}}function b(U){switch(U){case"point":case"multipoint":return R.FEATURE_TYPES.POINT;case"linestring":case"multilinestring":return R.FEATURE_TYPES.LINE;case"polygon":case"multipolygon":return R.FEATURE_TYPES.POLYGON;case"geometrycollection":default:throw new Error("Unhandled geometry type ".concat(U))}}var _=["type","geometry","properties"];function x(U,H,q){for(var te=H.geometry.type.toLowerCase(),Q=b(te),Z=q.requestFeatureByType(Q),ae=te!="point"?H.geometry.coordinates:[H.geometry.coordinates],F=H.properties||{},W=0,O=Object.keys(H);W<O.length;W++){var X=O[W];_.includes(X.toLowerCase())||(F.geojson=F.geojson||{},F.geojson[X]=H[X])}return E(te,Z,U,ae,q,F),Z}function T(U,H,q){var te=new R.FeatureCollection(q),Q=q.filter||function(){return!0},Z=y(H),ae;try{for(Z.s();!(ae=Z.n()).done;){var F=ae.value;Q(F.properties,F.geometry)&&x(U,F,te)}}catch(W){Z.e(W)}finally{Z.f()}return te.removeEmptyFeature(),te.updateExtent(),te}var N={parse:function(H){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};q=(0,v.deprecatedParsingOptionsToNewOne)(q),q.in=q.in||{};var te=q.out,Q=q.in;switch(typeof H=="string"&&(H=JSON.parse(H)),Q.crs=Q.crs||C(H),te.filteringExtent&&(typeof te.filteringExtent=="boolean"?te.filterExtent=H.extent.as(Q.crs):te.filteringExtent.isExtent&&(te.filterExtent=te.filteringExtent)),H.type.toLowerCase()){case"featurecollection":return Promise.resolve(T(Q.crs,H.features,te));case"feature":return Promise.resolve(T(Q.crs,[H],te));default:throw new Error("Unsupported GeoJSON type: '".concat(H.type))}}};a.default=N}(vA)),vA}var wA={},Ac={},ZE;function QR(){if(ZE)return Ac;ZE=1,Object.defineProperty(Ac,"__esModule",{value:!0});function a(Y){return Y&&Y.normalize&&Y.normalize(),Y&&Y.textContent||""}function u(Y,pe){const Ee=Y.getElementsByTagName(pe);return Ee.length?Ee[0]:null}function h(Y){const pe={};if(Y){const Ee=u(Y,"line");if(Ee){const Fe=a(u(Ee,"color")),$e=parseFloat(a(u(Ee,"opacity"))),pt=parseFloat(a(u(Ee,"width")));Fe&&(pe.stroke=Fe),isNaN($e)||(pe["stroke-opacity"]=$e),isNaN(pt)||(pe["stroke-width"]=pt*96/25.4)}}return pe}function R(Y){let pe=[];if(Y!==null)for(let Ee=0;Ee<Y.childNodes.length;Ee++){const Fe=Y.childNodes[Ee];if(Fe.nodeType!==1)continue;const $e=["heart","gpxtpx:hr","hr"].includes(Fe.nodeName)?"heart":Fe.nodeName;if($e==="gpxtpx:TrackPointExtension")pe=pe.concat(R(Fe));else{const pt=a(Fe);pe.push([$e,isNaN(pt)?pt:parseFloat(pt)])}}return pe}function M(Y,pe){const Ee={};let Fe,$e;for($e=0;$e<pe.length;$e++)Fe=u(Y,pe[$e]),Fe&&(Ee[pe[$e]]=a(Fe));return Ee}function v(Y){const pe=M(Y,["name","cmt","desc","type","time","keywords"]),Ee=Y.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*");for(let $e=0;$e<Ee.length;$e++){const pt=Ee[$e];pt.parentNode.parentNode===Y&&(pe[pt.tagName.replace(":","_")]=a(pt))}const Fe=Y.getElementsByTagName("link");Fe.length&&(pe.links=[]);for(let $e=0;$e<Fe.length;$e++)pe.links.push(Object.assign({href:Fe[$e].getAttribute("href")},M(Fe[$e],["text","type"])));return pe}function y(Y){const pe=[parseFloat(Y.getAttribute("lon")),parseFloat(Y.getAttribute("lat"))],Ee=u(Y,"ele"),Fe=u(Y,"time");if(Ee){const $e=parseFloat(a(Ee));isNaN($e)||pe.push($e)}return{coordinates:pe,time:Fe?a(Fe):null,extendedValues:R(u(Y,"extensions"))}}function p(Y){const pe=g(Y,"rtept");if(!!pe)return{type:"Feature",properties:Object.assign(v(Y),h(u(Y,"extensions")),{_gpxType:"rte"}),geometry:{type:"LineString",coordinates:pe.line}}}function g(Y,pe){const Ee=Y.getElementsByTagName(pe);if(Ee.length<2)return;const Fe=[],$e=[],pt={};for(let Ue=0;Ue<Ee.length;Ue++){const Je=y(Ee[Ue]);Fe.push(Je.coordinates),Je.time&&$e.push(Je.time);for(let et=0;et<Je.extendedValues.length;et++){const[ze,Xe]=Je.extendedValues[et],tt=ze==="heart"?ze:ze.replace("gpxtpx:","")+"s";pt[tt]||(pt[tt]=Array(Ee.length).fill(null)),pt[tt][Ue]=Xe}}return{line:Fe,times:$e,extendedValues:pt}}function C(Y){const pe=Y.getElementsByTagName("trkseg"),Ee=[],Fe=[],$e=[];for(let Je=0;Je<pe.length;Je++){const et=g(pe[Je],"trkpt");et&&($e.push(et),et.times&&et.times.length&&Fe.push(et.times))}if($e.length===0)return;const pt=$e.length>1,Ue=Object.assign(v(Y),h(u(Y,"extensions")),{_gpxType:"trk"},Fe.length?{coordinateProperties:{times:pt?Fe:Fe[0]}}:{});for(let Je=0;Je<$e.length;Je++){const et=$e[Je];Ee.push(et.line);for(const[ze,Xe]of Object.entries(et.extendedValues)){Ue.coordinateProperties||(Ue.coordinateProperties={});const tt=Ue.coordinateProperties;pt?(tt[ze]||(tt[ze]=$e.map(ye=>new Array(ye.line.length).fill(null))),tt[ze][Je]=Xe):tt[ze]=Xe}}return{type:"Feature",properties:Ue,geometry:pt?{type:"MultiLineString",coordinates:Ee}:{type:"LineString",coordinates:Ee[0]}}}function D(Y){return{type:"Feature",properties:Object.assign(v(Y),M(Y,["sym"])),geometry:{type:"Point",coordinates:y(Y).coordinates}}}function*B(Y){const pe=Y.getElementsByTagName("trk"),Ee=Y.getElementsByTagName("rte"),Fe=Y.getElementsByTagName("wpt");for(let $e=0;$e<pe.length;$e++){const pt=C(pe[$e]);pt&&(yield pt)}for(let $e=0;$e<Ee.length;$e++){const pt=p(Ee[$e]);pt&&(yield pt)}for(let $e=0;$e<Fe.length;$e++)yield D(Fe[$e])}function V(Y){return{type:"FeatureCollection",features:Array.from(B(Y))}}const P="http://www.garmin.com/xmlschemas/ActivityExtension/v2",L=[["heartRate","heartRates"],["Cadence","cadences"],["Speed","speeds"],["Watts","watts"]],E=[["TotalTimeSeconds","totalTimeSeconds"],["DistanceMeters","distanceMeters"],["MaximumSpeed","maxSpeed"],["AverageHeartRateBpm","avgHeartRate"],["MaximumHeartRateBpm","maxHeartRate"],["AvgSpeed","avgSpeed"],["AvgWatts","avgWatts"],["MaxWatts","maxWatts"]];function b(Y){const pe={};for(const[Ee,Fe]of Y)pe[Ee]=Fe;return pe}function _(Y,pe){const Ee=[];for(const[Fe,$e]of pe){let pt=u(Y,Fe);if(!pt){const Je=Y.getElementsByTagNameNS(P,Fe);Je.length&&(pt=Je[0])}const Ue=parseFloat(a(pt));isNaN(Ue)||Ee.push([$e,Ue])}return Ee}function x(Y){const pe=a(u(Y,"LongitudeDegrees")),Ee=a(u(Y,"LatitudeDegrees"));if(!pe.length||!Ee.length)return null;const Fe=[parseFloat(pe),parseFloat(Ee)],$e=u(Y,"AltitudeMeters"),pt=u(Y,"HeartRateBpm"),Ue=u(Y,"Time");let Je;return $e&&(Je=parseFloat(a($e)),isNaN(Je)||Fe.push(Je)),{coordinates:Fe,time:Ue?a(Ue):null,heartRate:pt?parseFloat(a(pt)):null,extensions:_(Y,L)}}function T(Y,pe){const Ee=Y.getElementsByTagName(pe),Fe=[],$e=[],pt=[];if(Ee.length<2)return null;const Ue={extendedProperties:{}};for(let Je=0;Je<Ee.length;Je++){const et=x(Ee[Je]);if(et!==null){Fe.push(et.coordinates),et.time&&$e.push(et.time),et.heartRate&&pt.push(et.heartRate);for(const[ze,Xe]of et.extensions)Ue.extendedProperties[ze]||(Ue.extendedProperties[ze]=Array(Ee.length).fill(null)),Ue.extendedProperties[ze][Je]=Xe}}return Object.assign(Ue,{line:Fe,times:$e,heartRates:pt})}function N(Y){const pe=Y.getElementsByTagName("Track"),Ee=[],Fe=[],$e=[],pt=[];let Ue;const Je=b(_(Y,E)),et=u(Y,"Name");et&&(Je.name=a(et));for(let ze=0;ze<pe.length;ze++)Ue=T(pe[ze],"Trackpoint"),Ue&&(Ee.push(Ue.line),Ue.times.length&&Fe.push(Ue.times),Ue.heartRates.length&&$e.push(Ue.heartRates),pt.push(Ue.extendedProperties));for(let ze=0;ze<pt.length;ze++){const Xe=pt[ze];for(const tt in Xe)pe.length===1?Je[tt]=Ue.extendedProperties[tt]:(Je[tt]||(Je[tt]=Ee.map(ye=>Array(ye.length).fill(null))),Je[tt][ze]=Xe[tt])}if(Ee.length!==0)return(Fe.length||$e.length)&&(Je.coordinateProperties=Object.assign(Fe.length?{times:Ee.length===1?Fe[0]:Fe}:{},$e.length?{heart:Ee.length===1?$e[0]:$e}:{})),{type:"Feature",properties:Je,geometry:{type:Ee.length===1?"LineString":"MultiLineString",coordinates:Ee.length===1?Ee[0]:Ee}}}function*U(Y){const pe=Y.getElementsByTagName("Lap");for(let Fe=0;Fe<pe.length;Fe++){const $e=N(pe[Fe]);$e&&(yield $e)}const Ee=Y.getElementsByTagName("Courses");for(let Fe=0;Fe<Ee.length;Fe++){const $e=N(Ee[Fe]);$e&&(yield $e)}}function H(Y){return{type:"FeatureCollection",features:Array.from(U(Y))}}const q=/\s*/g,te=/^\s*|\s*$/g,Q=/\s+/;function Z(Y){if(!Y||!Y.length)return 0;let pe=0;for(let Ee=0;Ee<Y.length;Ee++)pe=(pe<<5)-pe+Y.charCodeAt(Ee)|0;return pe}function ae(Y){return Y.replace(q,"").split(",").map(parseFloat)}function F(Y){return Y.replace(te,"").split(Q).map(ae)}function W(Y){if(Y.xml!==void 0)return Y.xml;if(Y.tagName){let pe=Y.tagName;for(let Ee=0;Ee<Y.attributes.length;Ee++)pe+=Y.attributes[Ee].name+Y.attributes[Ee].value;for(let Ee=0;Ee<Y.childNodes.length;Ee++)pe+=W(Y.childNodes[Ee]);return pe}return Y.nodeName==="#text"?(Y.nodeValue||Y.value||"").trim():Y.nodeName==="#cdata-section"?Y.nodeValue:""}const O=["Polygon","LineString","Point","Track","gx:Track"];function X(Y,pe,Ee){let Fe=a(u(pe,"color"))||"";const $e=Ee=="stroke"||Ee==="fill"?Ee:Ee+"-color";Fe.substr(0,1)==="#"&&(Fe=Fe.substr(1)),Fe.length===6||Fe.length===3?Y[$e]=Fe:Fe.length===8&&(Y[Ee+"-opacity"]=parseInt(Fe.substr(0,2),16)/255,Y[$e]="#"+Fe.substr(6,2)+Fe.substr(4,2)+Fe.substr(2,2))}function G(Y,pe,Ee,Fe){const $e=parseFloat(a(u(pe,Ee)));isNaN($e)||(Y[Fe]=$e)}function j(Y){let pe=Y.getElementsByTagName("coord");const Ee=[],Fe=[];pe.length===0&&(pe=Y.getElementsByTagName("gx:coord"));for(let pt=0;pt<pe.length;pt++)Ee.push(a(pe[pt]).split(" ").map(parseFloat));const $e=Y.getElementsByTagName("when");for(let pt=0;pt<$e.length;pt++)Fe.push(a($e[pt]));return{coords:Ee,times:Fe}}function K(Y){let pe,Ee,Fe,$e,pt;const Ue=[],Je=[];if(u(Y,"MultiGeometry"))return K(u(Y,"MultiGeometry"));if(u(Y,"MultiTrack"))return K(u(Y,"MultiTrack"));if(u(Y,"gx:MultiTrack"))return K(u(Y,"gx:MultiTrack"));for(Fe=0;Fe<O.length;Fe++)if(Ee=Y.getElementsByTagName(O[Fe]),Ee){for($e=0;$e<Ee.length;$e++)if(pe=Ee[$e],O[Fe]==="Point")Ue.push({type:"Point",coordinates:ae(a(u(pe,"coordinates")))});else if(O[Fe]==="LineString")Ue.push({type:"LineString",coordinates:F(a(u(pe,"coordinates")))});else if(O[Fe]==="Polygon"){const et=pe.getElementsByTagName("LinearRing"),ze=[];for(pt=0;pt<et.length;pt++)ze.push(F(a(u(et[pt],"coordinates"))));Ue.push({type:"Polygon",coordinates:ze})}else if(O[Fe]==="Track"||O[Fe]==="gx:Track"){const et=j(pe);Ue.push({type:"LineString",coordinates:et.coords}),et.times.length&&Je.push(et.times)}}return{geoms:Ue,coordTimes:Je}}function ce(Y,pe,Ee,Fe){const $e=K(Y);let pt;const Ue={},Je=a(u(Y,"name")),et=a(u(Y,"address"));let ze=a(u(Y,"styleUrl"));const Xe=a(u(Y,"description")),tt=u(Y,"TimeSpan"),ye=u(Y,"TimeStamp"),Ze=u(Y,"ExtendedData");let Ge=u(Y,"IconStyle"),Ae=u(Y,"LabelStyle"),Se=u(Y,"LineStyle"),Te=u(Y,"PolyStyle");const me=u(Y,"visibility");if(Je&&(Ue.name=Je),et&&(Ue.address=et),ze){ze[0]!=="#"&&(ze="#"+ze),Ue.styleUrl=ze,pe[ze]&&(Ue.styleHash=pe[ze]),Ee[ze]&&(Ue.styleMapHash=Ee[ze],Ue.styleHash=pe[Ee[ze].normal]);const we=Fe[Ue.styleHash];we&&(Ge||(Ge=u(we,"IconStyle")),Ae||(Ae=u(we,"LabelStyle")),Se||(Se=u(we,"LineStyle")),Te||(Te=u(we,"PolyStyle")))}if(Xe&&(Ue.description=Xe),tt){const we=a(u(tt,"begin")),je=a(u(tt,"end"));Ue.timespan={begin:we,end:je}}if(ye&&(Ue.timestamp=a(u(ye,"when"))),Ge){X(Ue,Ge,"icon"),G(Ue,Ge,"scale","icon-scale"),G(Ue,Ge,"heading","icon-heading");const we=u(Ge,"hotSpot");if(we){const lt=parseFloat(we.getAttribute("x")),ot=parseFloat(we.getAttribute("y"));!isNaN(lt)&&!isNaN(ot)&&(Ue["icon-offset"]=[lt,ot])}const je=u(Ge,"Icon");if(je){const lt=a(u(je,"href"));lt&&(Ue.icon=lt)}}if(Ae&&(X(Ue,Ae,"label"),G(Ue,Ae,"scale","label-scale")),Se&&(X(Ue,Se,"stroke"),G(Ue,Se,"width","stroke-width")),Te){X(Ue,Te,"fill");const we=a(u(Te,"fill")),je=a(u(Te,"outline"));we&&(Ue["fill-opacity"]=we==="1"?Ue["fill-opacity"]||1:0),je&&(Ue["stroke-opacity"]=je==="1"?Ue["stroke-opacity"]||1:0)}if(Ze){const we=Ze.getElementsByTagName("Data"),je=Ze.getElementsByTagName("SimpleData");for(pt=0;pt<we.length;pt++)Ue[we[pt].getAttribute("name")]=a(u(we[pt],"value"));for(pt=0;pt<je.length;pt++)Ue[je[pt].getAttribute("name")]=a(je[pt])}me&&(Ue.visibility=a(me)),$e.coordTimes.length&&(Ue.coordinateProperties={times:$e.coordTimes.length===1?$e.coordTimes[0]:$e.coordTimes});const be={type:"Feature",geometry:$e.geoms.length===0?null:$e.geoms.length===1?$e.geoms[0]:{type:"GeometryCollection",geometries:$e.geoms},properties:Ue};return Y.getAttribute("id")&&(be.id=Y.getAttribute("id")),be}function*se(Y){const pe={},Ee={},Fe={},$e=Y.getElementsByTagName("Placemark"),pt=Y.getElementsByTagName("Style"),Ue=Y.getElementsByTagName("StyleMap");for(let Je=0;Je<pt.length;Je++){const et=pt[Je],ze=Z(W(et)).toString(16);let Xe=et.getAttribute("id");!Xe&&et.parentNode.tagName.replace("gx:","")==="CascadingStyle"&&(Xe=et.parentNode.getAttribute("kml:id")||et.parentNode.getAttribute("id")),pe["#"+Xe]=ze,Ee[ze]=et}for(let Je=0;Je<Ue.length;Je++){pe["#"+Ue[Je].getAttribute("id")]=Z(W(Ue[Je])).toString(16);const et=Ue[Je].getElementsByTagName("Pair"),ze={};for(let Xe=0;Xe<et.length;Xe++)ze[a(u(et[Xe],"key"))]=a(u(et[Xe],"styleUrl"));Fe["#"+Ue[Je].getAttribute("id")]=ze}for(let Je=0;Je<$e.length;Je++){const et=ce($e[Je],pe,Fe,Ee);et&&(yield et)}}function ue(Y){return{type:"FeatureCollection",features:Array.from(se(Y))}}return Ac.gpx=V,Ac.gpxGen=B,Ac.kml=ue,Ac.kmlGen=se,Ac.tcx=H,Ac.tcxGen=U,Ac}var jE;function KR(){return jE||(jE=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=QR(),R=u(k0()),M=nd(),v={parse:function(p,g){return g=(0,M.deprecatedParsingOptionsToNewOne)(g),R.default.parse((0,h.kml)(p),g)}};a.default=v}(wA)),wA}var MA={},bA={},YE;function i2(){return YE||(YE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.BYTES_PER_FLOAT=a.BYTES_PER_DOUBLE=void 0;var R=p(Dr()),M=u(r2()),v=u(ya());function y(B){if(typeof WeakMap!="function")return null;var V=new WeakMap,P=new WeakMap;return(y=function(E){return E?P:V})(B)}function p(B,V){if(!V&&B&&B.__esModule)return B;if(B===null||h(B)!=="object"&&typeof B!="function")return{default:B};var P=y(V);if(P&&P.has(B))return P.get(B);var L={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in B)if(b!=="default"&&Object.prototype.hasOwnProperty.call(B,b)){var _=E?Object.getOwnPropertyDescriptor(B,b):null;_&&(_.get||_.set)?Object.defineProperty(L,b,_):L[b]=B[b]}return L.default=B,P&&P.set(B,L),L}var g=8;a.BYTES_PER_DOUBLE=g;var C=4;a.BYTES_PER_FLOAT=C;var D={parse:function(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{in:{}},L=P.in.dataType||"float";if(!["float","double"].includes(L))throw new Error("`dataType` parameter is incorrect for GTXParser.parse method. This parameter must be either `double` or `float`.");var E=new DataView(V,0,40),b={minX:E.getFloat64(8),minY:E.getFloat64(0),stepX:E.getFloat64(24),stepY:E.getFloat64(16),nColumns:E.getInt32(36),nRows:E.getInt32(32)},_=new DataView(V,40),x=b.minX+b.stepX*(b.nColumns-1),T=b.minY+b.stepY*(b.nRows-1),N=new v.default(P.in.crs||"EPSG:4326",b.minX,x,b.minY,T),U=new R.Vector2(b.stepX,b.stepY);return Promise.resolve(new M.default(N,U,function(q,te){if(L==="float")return _.getFloat32((b.nColumns*q+te)*C);if(L==="double")return _.getFloat64((b.nColumns*q+te)*g)}))}};a.default=D}(bA)),bA}var JE;function XM(){return JE||(JE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.getHeaderAttribute=V;var R=g(Dr()),M=u(r2()),v=u(ya()),y=i2();function p(L){if(typeof WeakMap!="function")return null;var E=new WeakMap,b=new WeakMap;return(p=function(x){return x?b:E})(L)}function g(L,E){if(!E&&L&&L.__esModule)return L;if(L===null||h(L)!=="object"&&typeof L!="function")return{default:L};var b=p(E);if(b&&b.has(L))return b.get(L);var _={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in L)if(T!=="default"&&Object.prototype.hasOwnProperty.call(L,T)){var N=x?Object.getOwnPropertyDescriptor(L,T):null;N&&(N.get||N.set)?Object.defineProperty(_,T,N):_[T]=L[T]}return _.default=L,b&&b.set(L,_),_}function C(L,E){var b=typeof Symbol<"u"&&L[Symbol.iterator]||L["@@iterator"];if(!b){if(Array.isArray(L)||(b=D(L))||E&&L&&typeof L.length=="number"){b&&(L=b);var _=0,x=function(){};return{s:x,n:function(){return _>=L.length?{done:!0}:{done:!1,value:L[_++]}},e:function(q){throw q},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T=!0,N=!1,U;return{s:function(){b=b.call(L)},n:function(){var q=b.next();return T=q.done,q},e:function(q){N=!0,U=q},f:function(){try{!T&&b.return!=null&&b.return()}finally{if(N)throw U}}}}function D(L,E){if(!!L){if(typeof L=="string")return B(L,E);var b=Object.prototype.toString.call(L).slice(8,-1);if(b==="Object"&&L.constructor&&(b=L.constructor.name),b==="Map"||b==="Set")return Array.from(L);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return B(L,E)}}function B(L,E){(E==null||E>L.length)&&(E=L.length);for(var b=0,_=new Array(E);b<E;b++)_[b]=L[b];return _}function V(L,E){var b=L[L.indexOf(L.find(function(_){return _.includes(E)}))].split(" ").filter(function(_){return _!==""});return parseFloat(b[b.length-1])}var P={parse:function(E){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{in:{}},_=E.split(`
`),x=_.indexOf(_.find(function(F){return F.includes("end_of_head")}))+1,T=_.slice(0,x),N={minX:V(T,"longlimit_west"),maxX:V(T,"longlimit_east"),minY:V(T,"latlimit_south"),maxY:V(T,"latlimit_north"),stepX:V(T,"gridstep"),stepY:V(T,"gridstep"),nRows:V(T,"latitude_parallels"),nColumns:V(T,"longitude_parallels")},U=new DataView(new ArrayBuffer(y.BYTES_PER_DOUBLE*N.nRows*N.nColumns)),H=0,q=C(_.slice(x,_.length)),te;try{for(q.s();!(te=q.n()).done;){var Q=te.value;Q=Q.split(" ").filter(function(F){return F!==""}),Q.length&&(U.setFloat64(H*y.BYTES_PER_DOUBLE,parseFloat(Q[2])),H++)}}catch(F){q.e(F)}finally{q.f()}var Z=new v.default(b.in.crs||"EPSG:4326",N.minX,N.maxX,N.minY,N.maxY),ae=new R.Vector2(N.stepX,N.stepY);return Promise.resolve(new M.default(Z,ae,function(W,O){return U.getFloat64((N.nColumns*(N.nRows-W-1)+O)*y.BYTES_PER_DOUBLE)}))}};a.default=P}(MA)),MA}var EA={},$E;function eC(){return $E||($E=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=QR(),R=u(k0()),M=nd(),v={parse:function(p,g){return g=(0,M.deprecatedParsingOptionsToNewOne)(g),R.default.parse((0,h.gpx)(p),g)}};a.default=v}(EA)),EA}var TA={},QE;function tC(){return QE||(QE=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=C(Dr()),M=u(r2()),v=u(ya()),y=XM(),p=i2();function g(L){if(typeof WeakMap!="function")return null;var E=new WeakMap,b=new WeakMap;return(g=function(x){return x?b:E})(L)}function C(L,E){if(!E&&L&&L.__esModule)return L;if(L===null||h(L)!=="object"&&typeof L!="function")return{default:L};var b=g(E);if(b&&b.has(L))return b.get(L);var _={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in L)if(T!=="default"&&Object.prototype.hasOwnProperty.call(L,T)){var N=x?Object.getOwnPropertyDescriptor(L,T):null;N&&(N.get||N.set)?Object.defineProperty(_,T,N):_[T]=L[T]}return _.default=L,b&&b.set(L,_),_}function D(L,E){var b=typeof Symbol<"u"&&L[Symbol.iterator]||L["@@iterator"];if(!b){if(Array.isArray(L)||(b=B(L))||E&&L&&typeof L.length=="number"){b&&(L=b);var _=0,x=function(){};return{s:x,n:function(){return _>=L.length?{done:!0}:{done:!1,value:L[_++]}},e:function(q){throw q},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T=!0,N=!1,U;return{s:function(){b=b.call(L)},n:function(){var q=b.next();return T=q.done,q},e:function(q){N=!0,U=q},f:function(){try{!T&&b.return!=null&&b.return()}finally{if(N)throw U}}}}function B(L,E){if(!!L){if(typeof L=="string")return V(L,E);var b=Object.prototype.toString.call(L).slice(8,-1);if(b==="Object"&&L.constructor&&(b=L.constructor.name),b==="Map"||b==="Set")return Array.from(L);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return V(L,E)}}function V(L,E){(E==null||E>L.length)&&(E=L.length);for(var b=0,_=new Array(E);b<E;b++)_[b]=L[b];return _}var P={parse:function(E){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{in:{}},_=E.split(`
`),x=_.indexOf(_.find(function(X){return X.includes("end_of_head")}))+1,T=_.slice(0,x),N={minX:(0,y.getHeaderAttribute)(T,"lon min"),maxX:(0,y.getHeaderAttribute)(T,"lon max"),minY:(0,y.getHeaderAttribute)(T,"lat min"),maxY:(0,y.getHeaderAttribute)(T,"lat max"),stepX:(0,y.getHeaderAttribute)(T,"delta lon"),stepY:(0,y.getHeaderAttribute)(T,"delta lat"),nRows:(0,y.getHeaderAttribute)(T,"nrows"),nColumns:(0,y.getHeaderAttribute)(T,"ncols")},U=new DataView(new ArrayBuffer(p.BYTES_PER_DOUBLE*N.nRows*N.nColumns)),H=0,q=D(_.slice(x,_.length)),te;try{for(q.s();!(te=q.n()).done;){var Q=te.value;if(Q=Q.split(" ").filter(function(X){return X!==""}),!!Q.length){var Z=D(Q),ae;try{for(Z.s();!(ae=Z.n()).done;){var F=ae.value;U.setFloat64(H*p.BYTES_PER_DOUBLE,parseFloat(F)),H++}}catch(X){Z.e(X)}finally{Z.f()}}}}catch(X){q.e(X)}finally{q.f()}var W=new v.default(b.in.crs||"EPSG:4326",N.minX+N.stepX/2,N.maxX-N.stepX/2,N.minY+N.stepY/2,N.maxY-N.stepY/2),O=new R.Vector2(N.stepX,N.stepY);return Promise.resolve(new M.default(W,O,function(G,j){return U.getFloat64((N.nColumns*G+j)*p.BYTES_PER_DOUBLE)}))}};a.default=P}(TA)),TA}var SA={},Dy={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var KE;function rC(){return KE||(KE=1,Dy.read=function(a,u,h,R,M){var v,y,p=M*8-R-1,g=(1<<p)-1,C=g>>1,D=-7,B=h?M-1:0,V=h?-1:1,P=a[u+B];for(B+=V,v=P&(1<<-D)-1,P>>=-D,D+=p;D>0;v=v*256+a[u+B],B+=V,D-=8);for(y=v&(1<<-D)-1,v>>=-D,D+=R;D>0;y=y*256+a[u+B],B+=V,D-=8);if(v===0)v=1-C;else{if(v===g)return y?NaN:(P?-1:1)*(1/0);y=y+Math.pow(2,R),v=v-C}return(P?-1:1)*y*Math.pow(2,v-R)},Dy.write=function(a,u,h,R,M,v){var y,p,g,C=v*8-M-1,D=(1<<C)-1,B=D>>1,V=M===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=R?0:v-1,L=R?1:-1,E=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(p=isNaN(u)?1:0,y=D):(y=Math.floor(Math.log(u)/Math.LN2),u*(g=Math.pow(2,-y))<1&&(y--,g*=2),y+B>=1?u+=V/g:u+=V*Math.pow(2,1-B),u*g>=2&&(y++,g/=2),y+B>=D?(p=0,y=D):y+B>=1?(p=(u*g-1)*Math.pow(2,M),y=y+B):(p=u*Math.pow(2,B-1)*Math.pow(2,M),y=0));M>=8;a[h+P]=p&255,P+=L,p/=256,M-=8);for(y=y<<M|p,C+=M;C>0;a[h+P]=y&255,P+=L,y/=256,C-=8);a[h+P-L]|=E*128}),Dy}var RA,eT;function NF(){if(eT)return RA;eT=1,RA=u;var a=rC();function u(F){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(F)?F:new Uint8Array(F||0),this.pos=0,this.type=0,this.length=this.buf.length}u.Varint=0,u.Fixed64=1,u.Bytes=2,u.Fixed32=5;var h=(1<<16)*(1<<16),R=1/h,M=12,v=typeof TextDecoder>"u"?null:new TextDecoder("utf8");u.prototype={destroy:function(){this.buf=null},readFields:function(F,W,O){for(O=O||this.length;this.pos<O;){var X=this.readVarint(),G=X>>3,j=this.pos;this.type=X&7,F(G,W,this),this.pos===j&&this.skip(X)}return W},readMessage:function(F,W){return this.readFields(F,W,this.readVarint()+this.pos)},readFixed32:function(){var F=H(this.buf,this.pos);return this.pos+=4,F},readSFixed32:function(){var F=te(this.buf,this.pos);return this.pos+=4,F},readFixed64:function(){var F=H(this.buf,this.pos)+H(this.buf,this.pos+4)*h;return this.pos+=8,F},readSFixed64:function(){var F=H(this.buf,this.pos)+te(this.buf,this.pos+4)*h;return this.pos+=8,F},readFloat:function(){var F=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,F},readDouble:function(){var F=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,F},readVarint:function(F){var W=this.buf,O,X;return X=W[this.pos++],O=X&127,X<128||(X=W[this.pos++],O|=(X&127)<<7,X<128)||(X=W[this.pos++],O|=(X&127)<<14,X<128)||(X=W[this.pos++],O|=(X&127)<<21,X<128)?O:(X=W[this.pos],O|=(X&15)<<28,y(O,F,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var F=this.readVarint();return F%2===1?(F+1)/-2:F/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var F=this.readVarint()+this.pos,W=this.pos;return this.pos=F,F-W>=M&&v?Z(this.buf,W,F):Q(this.buf,W,F)},readBytes:function(){var F=this.readVarint()+this.pos,W=this.buf.subarray(this.pos,F);return this.pos=F,W},readPackedVarint:function(F,W){if(this.type!==u.Bytes)return F.push(this.readVarint(W));var O=p(this);for(F=F||[];this.pos<O;)F.push(this.readVarint(W));return F},readPackedSVarint:function(F){if(this.type!==u.Bytes)return F.push(this.readSVarint());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readSVarint());return F},readPackedBoolean:function(F){if(this.type!==u.Bytes)return F.push(this.readBoolean());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readBoolean());return F},readPackedFloat:function(F){if(this.type!==u.Bytes)return F.push(this.readFloat());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readFloat());return F},readPackedDouble:function(F){if(this.type!==u.Bytes)return F.push(this.readDouble());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readDouble());return F},readPackedFixed32:function(F){if(this.type!==u.Bytes)return F.push(this.readFixed32());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readFixed32());return F},readPackedSFixed32:function(F){if(this.type!==u.Bytes)return F.push(this.readSFixed32());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readSFixed32());return F},readPackedFixed64:function(F){if(this.type!==u.Bytes)return F.push(this.readFixed64());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readFixed64());return F},readPackedSFixed64:function(F){if(this.type!==u.Bytes)return F.push(this.readSFixed64());var W=p(this);for(F=F||[];this.pos<W;)F.push(this.readSFixed64());return F},skip:function(F){var W=F&7;if(W===u.Varint)for(;this.buf[this.pos++]>127;);else if(W===u.Bytes)this.pos=this.readVarint()+this.pos;else if(W===u.Fixed32)this.pos+=4;else if(W===u.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+W)},writeTag:function(F,W){this.writeVarint(F<<3|W)},realloc:function(F){for(var W=this.length||16;W<this.pos+F;)W*=2;if(W!==this.length){var O=new Uint8Array(W);O.set(this.buf),this.buf=O,this.length=W}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(F){this.realloc(4),q(this.buf,F,this.pos),this.pos+=4},writeSFixed32:function(F){this.realloc(4),q(this.buf,F,this.pos),this.pos+=4},writeFixed64:function(F){this.realloc(8),q(this.buf,F&-1,this.pos),q(this.buf,Math.floor(F*R),this.pos+4),this.pos+=8},writeSFixed64:function(F){this.realloc(8),q(this.buf,F&-1,this.pos),q(this.buf,Math.floor(F*R),this.pos+4),this.pos+=8},writeVarint:function(F){if(F=+F||0,F>268435455||F<0){C(F,this);return}this.realloc(4),this.buf[this.pos++]=F&127|(F>127?128:0),!(F<=127)&&(this.buf[this.pos++]=(F>>>=7)&127|(F>127?128:0),!(F<=127)&&(this.buf[this.pos++]=(F>>>=7)&127|(F>127?128:0),!(F<=127)&&(this.buf[this.pos++]=F>>>7&127)))},writeSVarint:function(F){this.writeVarint(F<0?-F*2-1:F*2)},writeBoolean:function(F){this.writeVarint(Boolean(F))},writeString:function(F){F=String(F),this.realloc(F.length*4),this.pos++;var W=this.pos;this.pos=ae(this.buf,F,this.pos);var O=this.pos-W;O>=128&&V(W,O,this),this.pos=W-1,this.writeVarint(O),this.pos+=O},writeFloat:function(F){this.realloc(4),a.write(this.buf,F,this.pos,!0,23,4),this.pos+=4},writeDouble:function(F){this.realloc(8),a.write(this.buf,F,this.pos,!0,52,8),this.pos+=8},writeBytes:function(F){var W=F.length;this.writeVarint(W),this.realloc(W);for(var O=0;O<W;O++)this.buf[this.pos++]=F[O]},writeRawMessage:function(F,W){this.pos++;var O=this.pos;F(W,this);var X=this.pos-O;X>=128&&V(O,X,this),this.pos=O-1,this.writeVarint(X),this.pos+=X},writeMessage:function(F,W,O){this.writeTag(F,u.Bytes),this.writeRawMessage(W,O)},writePackedVarint:function(F,W){W.length&&this.writeMessage(F,P,W)},writePackedSVarint:function(F,W){W.length&&this.writeMessage(F,L,W)},writePackedBoolean:function(F,W){W.length&&this.writeMessage(F,_,W)},writePackedFloat:function(F,W){W.length&&this.writeMessage(F,E,W)},writePackedDouble:function(F,W){W.length&&this.writeMessage(F,b,W)},writePackedFixed32:function(F,W){W.length&&this.writeMessage(F,x,W)},writePackedSFixed32:function(F,W){W.length&&this.writeMessage(F,T,W)},writePackedFixed64:function(F,W){W.length&&this.writeMessage(F,N,W)},writePackedSFixed64:function(F,W){W.length&&this.writeMessage(F,U,W)},writeBytesField:function(F,W){this.writeTag(F,u.Bytes),this.writeBytes(W)},writeFixed32Field:function(F,W){this.writeTag(F,u.Fixed32),this.writeFixed32(W)},writeSFixed32Field:function(F,W){this.writeTag(F,u.Fixed32),this.writeSFixed32(W)},writeFixed64Field:function(F,W){this.writeTag(F,u.Fixed64),this.writeFixed64(W)},writeSFixed64Field:function(F,W){this.writeTag(F,u.Fixed64),this.writeSFixed64(W)},writeVarintField:function(F,W){this.writeTag(F,u.Varint),this.writeVarint(W)},writeSVarintField:function(F,W){this.writeTag(F,u.Varint),this.writeSVarint(W)},writeStringField:function(F,W){this.writeTag(F,u.Bytes),this.writeString(W)},writeFloatField:function(F,W){this.writeTag(F,u.Fixed32),this.writeFloat(W)},writeDoubleField:function(F,W){this.writeTag(F,u.Fixed64),this.writeDouble(W)},writeBooleanField:function(F,W){this.writeVarintField(F,Boolean(W))}};function y(F,W,O){var X=O.buf,G,j;if(j=X[O.pos++],G=(j&112)>>4,j<128||(j=X[O.pos++],G|=(j&127)<<3,j<128)||(j=X[O.pos++],G|=(j&127)<<10,j<128)||(j=X[O.pos++],G|=(j&127)<<17,j<128)||(j=X[O.pos++],G|=(j&127)<<24,j<128)||(j=X[O.pos++],G|=(j&1)<<31,j<128))return g(F,G,W);throw new Error("Expected varint not more than 10 bytes")}function p(F){return F.type===u.Bytes?F.readVarint()+F.pos:F.pos+1}function g(F,W,O){return O?W*4294967296+(F>>>0):(W>>>0)*4294967296+(F>>>0)}function C(F,W){var O,X;if(F>=0?(O=F%4294967296|0,X=F/4294967296|0):(O=~(-F%4294967296),X=~(-F/4294967296),O^4294967295?O=O+1|0:(O=0,X=X+1|0)),F>=18446744073709552e3||F<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");W.realloc(10),D(O,X,W),B(X,W)}function D(F,W,O){O.buf[O.pos++]=F&127|128,F>>>=7,O.buf[O.pos++]=F&127|128,F>>>=7,O.buf[O.pos++]=F&127|128,F>>>=7,O.buf[O.pos++]=F&127|128,F>>>=7,O.buf[O.pos]=F&127}function B(F,W){var O=(F&7)<<4;W.buf[W.pos++]|=O|((F>>>=3)?128:0),F&&(W.buf[W.pos++]=F&127|((F>>>=7)?128:0),F&&(W.buf[W.pos++]=F&127|((F>>>=7)?128:0),F&&(W.buf[W.pos++]=F&127|((F>>>=7)?128:0),F&&(W.buf[W.pos++]=F&127|((F>>>=7)?128:0),F&&(W.buf[W.pos++]=F&127)))))}function V(F,W,O){var X=W<=16383?1:W<=2097151?2:W<=268435455?3:Math.floor(Math.log(W)/(Math.LN2*7));O.realloc(X);for(var G=O.pos-1;G>=F;G--)O.buf[G+X]=O.buf[G]}function P(F,W){for(var O=0;O<F.length;O++)W.writeVarint(F[O])}function L(F,W){for(var O=0;O<F.length;O++)W.writeSVarint(F[O])}function E(F,W){for(var O=0;O<F.length;O++)W.writeFloat(F[O])}function b(F,W){for(var O=0;O<F.length;O++)W.writeDouble(F[O])}function _(F,W){for(var O=0;O<F.length;O++)W.writeBoolean(F[O])}function x(F,W){for(var O=0;O<F.length;O++)W.writeFixed32(F[O])}function T(F,W){for(var O=0;O<F.length;O++)W.writeSFixed32(F[O])}function N(F,W){for(var O=0;O<F.length;O++)W.writeFixed64(F[O])}function U(F,W){for(var O=0;O<F.length;O++)W.writeSFixed64(F[O])}function H(F,W){return(F[W]|F[W+1]<<8|F[W+2]<<16)+F[W+3]*16777216}function q(F,W,O){F[O]=W,F[O+1]=W>>>8,F[O+2]=W>>>16,F[O+3]=W>>>24}function te(F,W){return(F[W]|F[W+1]<<8|F[W+2]<<16)+(F[W+3]<<24)}function Q(F,W,O){for(var X="",G=W;G<O;){var j=F[G],K=null,ce=j>239?4:j>223?3:j>191?2:1;if(G+ce>O)break;var se,ue,Y;ce===1?j<128&&(K=j):ce===2?(se=F[G+1],(se&192)===128&&(K=(j&31)<<6|se&63,K<=127&&(K=null))):ce===3?(se=F[G+1],ue=F[G+2],(se&192)===128&&(ue&192)===128&&(K=(j&15)<<12|(se&63)<<6|ue&63,(K<=2047||K>=55296&&K<=57343)&&(K=null))):ce===4&&(se=F[G+1],ue=F[G+2],Y=F[G+3],(se&192)===128&&(ue&192)===128&&(Y&192)===128&&(K=(j&15)<<18|(se&63)<<12|(ue&63)<<6|Y&63,(K<=65535||K>=1114112)&&(K=null))),K===null?(K=65533,ce=1):K>65535&&(K-=65536,X+=String.fromCharCode(K>>>10&1023|55296),K=56320|K&1023),X+=String.fromCharCode(K),G+=ce}return X}function Z(F,W,O){return v.decode(F.subarray(W,O))}function ae(F,W,O){for(var X=0,G,j;X<W.length;X++){if(G=W.charCodeAt(X),G>55295&&G<57344)if(j)if(G<56320){F[O++]=239,F[O++]=191,F[O++]=189,j=G;continue}else G=j-55296<<10|G-56320|65536,j=null;else{G>56319||X+1===W.length?(F[O++]=239,F[O++]=191,F[O++]=189):j=G;continue}else j&&(F[O++]=239,F[O++]=191,F[O++]=189,j=null);G<128?F[O++]=G:(G<2048?F[O++]=G>>6|192:(G<65536?F[O++]=G>>12|224:(F[O++]=G>>18|240,F[O++]=G>>12&63|128),F[O++]=G>>6&63|128),F[O++]=G&63|128)}return O}return RA}var zm={},CA,tT;function BF(){if(tT)return CA;tT=1,CA=a;function a(u,h){this.x=u,this.y=h}return a.prototype={clone:function(){return new a(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,h){return this.clone()._rotateAround(u,h)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var h=u.x-this.x,R=u.y-this.y;return h*h+R*R},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,h){return Math.atan2(this.x*h-this.y*u,this.x*u+this.y*h)},_matMult:function(u){var h=u[0]*this.x+u[1]*this.y,R=u[2]*this.x+u[3]*this.y;return this.x=h,this.y=R,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var h=Math.cos(u),R=Math.sin(u),M=h*this.x-R*this.y,v=R*this.x+h*this.y;return this.x=M,this.y=v,this},_rotateAround:function(u,h){var R=Math.cos(u),M=Math.sin(u),v=h.x+R*(this.x-h.x)-M*(this.y-h.y),y=h.y+M*(this.x-h.x)+R*(this.y-h.y);return this.x=v,this.y=y,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(u){return u instanceof a?u:Array.isArray(u)?new a(u[0],u[1]):u},CA}var PA,rT;function nC(){if(rT)return PA;rT=1;var a=BF();PA=u;function u(y,p,g,C,D){this.properties={},this.extent=g,this.type=0,this._pbf=y,this._geometry=-1,this._keys=C,this._values=D,y.readFields(h,this,p)}function h(y,p,g){y==1?p.id=g.readVarint():y==2?R(g,p):y==3?p.type=g.readVarint():y==4&&(p._geometry=g.pos)}function R(y,p){for(var g=y.readVarint()+y.pos;y.pos<g;){var C=p._keys[y.readVarint()],D=p._values[y.readVarint()];p.properties[C]=D}}u.types=["Unknown","Point","LineString","Polygon"],u.prototype.loadGeometry=function(){var y=this._pbf;y.pos=this._geometry;for(var p=y.readVarint()+y.pos,g=1,C=0,D=0,B=0,V=[],P;y.pos<p;){if(C<=0){var L=y.readVarint();g=L&7,C=L>>3}if(C--,g===1||g===2)D+=y.readSVarint(),B+=y.readSVarint(),g===1&&(P&&V.push(P),P=[]),P.push(new a(D,B));else if(g===7)P&&P.push(P[0].clone());else throw new Error("unknown command "+g)}return P&&V.push(P),V},u.prototype.bbox=function(){var y=this._pbf;y.pos=this._geometry;for(var p=y.readVarint()+y.pos,g=1,C=0,D=0,B=0,V=1/0,P=-1/0,L=1/0,E=-1/0;y.pos<p;){if(C<=0){var b=y.readVarint();g=b&7,C=b>>3}if(C--,g===1||g===2)D+=y.readSVarint(),B+=y.readSVarint(),D<V&&(V=D),D>P&&(P=D),B<L&&(L=B),B>E&&(E=B);else if(g!==7)throw new Error("unknown command "+g)}return[V,L,P,E]},u.prototype.toGeoJSON=function(y,p,g){var C=this.extent*Math.pow(2,g),D=this.extent*y,B=this.extent*p,V=this.loadGeometry(),P=u.types[this.type],L,E;function b(T){for(var N=0;N<T.length;N++){var U=T[N],H=180-(U.y+B)*360/C;T[N]=[(U.x+D)*360/C-180,360/Math.PI*Math.atan(Math.exp(H*Math.PI/180))-90]}}switch(this.type){case 1:var _=[];for(L=0;L<V.length;L++)_[L]=V[L][0];V=_,b(V);break;case 2:for(L=0;L<V.length;L++)b(V[L]);break;case 3:for(V=M(V),L=0;L<V.length;L++)for(E=0;E<V[L].length;E++)b(V[L][E]);break}V.length===1?V=V[0]:P="Multi"+P;var x={type:"Feature",geometry:{type:P,coordinates:V},properties:this.properties};return"id"in this&&(x.id=this.id),x};function M(y){var p=y.length;if(p<=1)return[y];for(var g=[],C,D,B=0;B<p;B++){var V=v(y[B]);V!==0&&(D===void 0&&(D=V<0),D===V<0?(C&&g.push(C),C=[y[B]]):C.push(y[B]))}return C&&g.push(C),g}function v(y){for(var p=0,g=0,C=y.length,D=C-1,B,V;g<C;D=g++)B=y[g],V=y[D],p+=(V.x-B.x)*(B.y+V.y);return p}return PA}var LA,nT;function iC(){if(nT)return LA;nT=1;var a=nC();LA=u;function u(M,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=M,this._keys=[],this._values=[],this._features=[],M.readFields(h,this,v),this.length=this._features.length}function h(M,v,y){M===15?v.version=y.readVarint():M===1?v.name=y.readString():M===5?v.extent=y.readVarint():M===2?v._features.push(y.pos):M===3?v._keys.push(y.readString()):M===4&&v._values.push(R(y))}function R(M){for(var v=null,y=M.readVarint()+M.pos;M.pos<y;){var p=M.readVarint()>>3;v=p===1?M.readString():p===2?M.readFloat():p===3?M.readDouble():p===4?M.readVarint64():p===5?M.readVarint():p===6?M.readSVarint():p===7?M.readBoolean():null}return v}return u.prototype.feature=function(M){if(M<0||M>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[M];var v=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,v,this.extent,this._keys,this._values)},LA}var OA,iT;function UF(){if(iT)return OA;iT=1;var a=iC();OA=u;function u(R,M){this.layers=R.readFields(h,{},M)}function h(R,M,v){if(R===3){var y=new a(v,v.readVarint()+v.pos);y.length&&(M[y.name]=y)}}return OA}var aT;function zF(){return aT||(aT=1,zm.VectorTile=UF(),zm.VectorTileFeature=nC(),zm.VectorTileLayer=iC()),zm}var sT;function GF(){return sT||(sT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=Dr(),R=u(NF()),M=zF(),v=ya(),y=Uf(),p=nd();function g(x,T){var N=typeof Symbol<"u"&&x[Symbol.iterator]||x["@@iterator"];if(!N){if(Array.isArray(x)||(N=C(x))||T&&x&&typeof x.length=="number"){N&&(x=N);var U=0,H=function(){};return{s:H,n:function(){return U>=x.length?{done:!0}:{done:!1,value:x[U++]}},e:function(ae){throw ae},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,te=!1,Q;return{s:function(){N=N.call(x)},n:function(){var ae=N.next();return q=ae.done,ae},e:function(ae){te=!0,Q=ae},f:function(){try{!q&&N.return!=null&&N.return()}finally{if(te)throw Q}}}}function C(x,T){if(!!x){if(typeof x=="string")return D(x,T);var N=Object.prototype.toString.call(x).slice(8,-1);if(N==="Object"&&x.constructor&&(N=x.constructor.name),N==="Map"||N==="Set")return Array.from(x);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return D(x,T)}}function D(x,T){(T==null||T>x.length)&&(T=x.length);for(var N=0,U=new Array(T);N<T;N++)U[N]=x[N];return U}var B=v.globalExtentTMS.get("EPSG:3857").planarDimensions(),V=new h.Vector3(B.x,B.y,1),P=new h.Vector2,L=new h.Vector2;function E(x,T){var N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,U=T.bindNewGeometry(),H=T.type===y.FEATURE_TYPES.POLYGON;N=N&&H,U.properties=x.properties;var q=x._pbf;q.pos=x._geometry;for(var te=q.readVarint()+q.pos,Q=1,Z=0,ae=0,F=0,W=0,O=0;q.pos<te;){if(Z<=0){var X=q.readVarint();Q=X&7,Z=X>>3}if(Z--,Q===1||Q===2)ae+=q.readSVarint(),F+=q.readSVarint(),Q===1&&(W&&(N&&O>0&&U.indices.length>0&&(T.updateExtent(U),U=T.bindNewGeometry(),U.properties=x.properties),U.closeSubGeometry(W,T),U.getLastSubGeometry().ccw=O<0),W=0,O=0),W++,U.pushCoordinatesValues(T,ae,F),W==1?(L.set(ae,F),P.set(ae,F)):H&&W>1&&(O+=(P.x-ae)*(P.y+F),P.set(ae,F));else if(Q===7)W&&(W++,U.pushCoordinatesValues(T,L.x,L.y),H&&(O+=(P.x-L.x)*(P.y+L.y)));else throw new Error("unknown command ".concat(Q))}W&&(N&&O>0&&U.indices.length>0&&(T.updateExtent(U),U=T.bindNewGeometry(),U.properties=x.properties),U.closeSubGeometry(W,T),U.getLastSubGeometry().ccw=O<0),T.updateExtent(U)}function b(x,T){T.out=T.out||{};var N=new M.VectorTile(new R.default(x)),U=Object.keys(N.layers);if(!(U.length<1)){var H=x.extent.col,q=x.extent.zoom,te=T.in.isInverted?x.extent.row:(1<<q)-x.extent.row-1,Q=new y.FeatureCollection(T.out),Z=N.layers[U[0]],ae=Z.extent*Math.pow(2,q),F=-.5*ae;return Q.scale.set(V.x/ae,-V.y/ae,1),Q.position.set(Z.extent*H+F,Z.extent*te+F,0).multiply(Q.scale),Q.updateMatrixWorld(),U.forEach(function(W){if(!!T.in.layers[W])for(var O=N.layers[W],X=function(j){var K=O.feature(j),ce=T.in.layers[W].filter(function(Ee){return Ee.filterExpression.filter({zoom:q},K)&&q>=Ee.zoom.min&&q<Ee.zoom.max}),se=void 0,ue=g(ce),Y;try{var pe=function(){var Fe=Y.value;se?Q.features.find(function($e){return $e.id===Fe.id})||(se=Q.newFeatureByReference(se),se.id=Fe.id,se.order=Fe.order,se.style=T.in.styles[se.id]):(se=Q.requestFeatureById(Fe.id,K.type-1),se.id=Fe.id,se.order=Fe.order,se.style=T.in.styles[se.id],E(K,se))};for(ue.s();!(Y=ue.n()).done;)pe()}catch(Ee){ue.e(Ee)}finally{ue.f()}},G=O.length-1;G>=0;G--)X(G)}),Q.removeEmptyFeature(),Q.features.sort(function(W,O){return W.order-O.order}),Q.updateExtent(),Q.extent=x.extent,Q.isInverted=T.in.isInverted,Promise.resolve(Q)}}var _={parse:function(T,N){return N=(0,p.deprecatedParsingOptionsToNewOne)(N),Promise.resolve(b(T,N))}};a.default=_}(SA)),SA}var oT;function pl(){return oT||(oT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.supportedParsers=a.supportedFetchers=a.default=void 0;var h=u(dn()),R=u(pn()),M=u(ln()),v=u(kr()),y=u(Ir()),p=u(ya()),g=u(k0()),C=u(KR()),D=u(XM()),B=u(eC()),V=u(i2()),P=u(tC()),L=u(GF()),E=u(dl()),b=u(Bf());function _(ae){var F=x();return function(){var W=(0,M.default)(ae),O;if(F){var X=(0,M.default)(this).constructor;O=Reflect.construct(W,arguments,X)}else O=W.apply(this,arguments);return(0,R.default)(this,O)}}function x(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var T=new Map([["image/x-bil;bits=32",E.default.textureFloat],["geojson",E.default.json],["application/json",E.default.json],["application/kml",E.default.xml],["application/gpx",E.default.xml],["application/x-protobuf;type=mapbox-vector",E.default.arrayBuffer],["application/gtx",E.default.arrayBuffer],["application/isg",E.default.text],["application/gdf",E.default.text]]);a.supportedFetchers=T;var N=new Map([["geojson",g.default.parse],["application/json",g.default.parse],["application/kml",C.default.parse],["application/gpx",B.default.parse],["application/x-protobuf;type=mapbox-vector",L.default.parse],["application/gtx",V.default.parse],["application/isg",P.default.parse],["application/gdf",D.default.parse]]);a.supportedParsers=N;var U={getByArray:function(){},setByArray:function(F){return F},clear:function(){}},H=(0,v.default)(function ae(F){(0,y.default)(this,ae),F.projection&&(console.warn("Source projection parameter is deprecated, use crs instead."),F.crs=F.crs||F.projection),this.crs=F.crs});function q(ae,F){var W=ae.urlFromExtent(F);return ae.fetcher(W,ae.networkOptions).then(function(O){return O.extent=F,O},function(O){return ae.handlingError(O)})}var te=0,Q=function(ae){(0,h.default)(W,ae);var F=_(W);function W(O){var X;if((0,y.default)(this,W),X=F.call(this,O),X.isSource=!0,!O.url)throw new Error("New Source: url is required");return X.uid=te++,X.url=O.url,X.format=O.format,X.fetcher=O.fetcher||T.get(O.format)||E.default.texture,X.parser=O.parser||N.get(O.format)||function(G){return G},X.isVectorSource=(O.parser||N.get(O.format))!=null,X.networkOptions=O.networkOptions||{crossOrigin:"anonymous"},X.attribution=O.attribution,X.whenReady=Promise.resolve(),X._featuresCaches={},O.extent&&!O.extent.isExtent?X.extent=new p.default(X.crs,O.extent):X.extent=O.extent,X}return(0,v.default)(W,[{key:"handlingError",value:function(X){throw new Error(X)}},{key:"urlFromExtent",value:function(){throw new Error("In extended Source, you have to implement the method urlFromExtent!")}},{key:"requestToKey",value:function(X){return[X.zoom,X.row,X.col]}},{key:"loadData",value:function(X,G){var j=this,K=this._featuresCaches[G.crs],ce=this.requestToKey(X),se=K.getByArray(ce);return se||(se=K.setByArray(q(this,X).then(function(ue){return j.parser(ue,{out:G,in:j})},function(ue){return j.handlingError(ue)}),ce),this.onParsedFile&&se.then(function(ue){return j.onParsedFile(ue),console.warn("Source.onParsedFile was deprecated"),ue})),se}},{key:"onLayerAdded",value:function(X){this._featuresCaches[X.out.crs]||(this._featuresCaches[X.out.crs]=this.isVectorSource?new b.default:U)}},{key:"onLayerRemoved",value:function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},G=this._featuresCaches[X.unusedCrs];G&&(G.clear(),delete this._featuresCaches[X.unusedCrs])}},{key:"extentInsideLimit",value:function(){throw new Error("In extented Source, you have to implement the method extentInsideLimit!")}}]),W}(H),Z=Q;a.default=Z}(mA)),mA}var uT;function id(){return uT||(uT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.ImageryLayers=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=E(Dr()),D=qM(),B=u(YR()),V=u(pl()),P=u(Bf());function L(te){if(typeof WeakMap!="function")return null;var Q=new WeakMap,Z=new WeakMap;return(L=function(F){return F?Z:Q})(te)}function E(te,Q){if(!Q&&te&&te.__esModule)return te;if(te===null||h(te)!=="object"&&typeof te!="function")return{default:te};var Z=L(Q);if(Z&&Z.has(te))return Z.get(te);var ae={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var W in te)if(W!=="default"&&Object.prototype.hasOwnProperty.call(te,W)){var O=F?Object.getOwnPropertyDescriptor(te,W):null;O&&(O.get||O.set)?Object.defineProperty(ae,W,O):ae[W]=te[W]}return ae.default=te,Z&&Z.set(te,ae),ae}function b(te,Q){var Z=typeof Symbol<"u"&&te[Symbol.iterator]||te["@@iterator"];if(!Z){if(Array.isArray(te)||(Z=_(te))||Q&&te&&typeof te.length=="number"){Z&&(te=Z);var ae=0,F=function(){};return{s:F,n:function(){return ae>=te.length?{done:!0}:{done:!1,value:te[ae++]}},e:function(j){throw j},f:F}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var W=!0,O=!1,X;return{s:function(){Z=Z.call(te)},n:function(){var j=Z.next();return W=j.done,j},e:function(j){O=!0,X=j},f:function(){try{!W&&Z.return!=null&&Z.return()}finally{if(O)throw X}}}}function _(te,Q){if(!!te){if(typeof te=="string")return x(te,Q);var Z=Object.prototype.toString.call(te).slice(8,-1);if(Z==="Object"&&te.constructor&&(Z=te.constructor.name),Z==="Map"||Z==="Set")return Array.from(te);if(Z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Z))return x(te,Q)}}function x(te,Q){(Q==null||Q>te.length)&&(Q=te.length);for(var Z=0,ae=new Array(Q);Z<Q;Z++)ae[Z]=te[Z];return ae}function T(te){var Q=N();return function(){var Z=(0,g.default)(te),ae;if(Q){var F=(0,g.default)(this).constructor;ae=Reflect.construct(Z,arguments,F)}else ae=Z.apply(this,arguments);return(0,p.default)(this,ae)}}function N(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var U=function(te){(0,y.default)(Z,te);var Q=T(Z);function Z(ae){var F,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((0,R.default)(this,Z),W.projection&&(console.warn("Layer projection parameter is deprecated, use crs instead."),W.crs=W.crs||W.projection),W.source===void 0||W.source===!0)throw new Error("Layer ".concat(ae," needs Source"));return F=Q.call(this),F.isLayer=!0,Object.assign((0,v.default)(F),W),Object.defineProperty((0,v.default)(F),"id",{value:ae,writable:!1}),F.options=W.options||{},F.updateStrategy||(F.updateStrategy={type:D.STRATEGY_MIN_NETWORK_TRAFFIC,options:{}}),F.defineLayerProperty("frozen",!1),W.zoom?(F.zoom={max:W.zoom.max,min:W.zoom.min||0},F.zoom.max==null&&(F.zoom.max=1/0)):F.zoom={max:1/0,min:0},F.info=new B.default((0,v.default)(F)),F.source=F.source||new V.default({url:"none"}),F.ready=!1,F._promises=[],F.whenReady=new Promise(function(O,X){F._resolve=O,F._reject=X}).then(function(){return F.ready=!0,F.source.onLayerAdded({out:(0,v.default)(F)}),(0,v.default)(F)}),F._promises.push(F.source.whenReady),F.cache=new P.default(W.cacheLifeTime),F.mergeFeatures=F.mergeFeatures===void 0?!0:W.mergeFeatures,F.filter=F.filter||F.source.filter,F}return(0,M.default)(Z,[{key:"addInitializationStep",value:function(){var F;return this._promises.push(new Promise(function(W){F=W})),F}},{key:"defineLayerProperty",value:function(F,W,O){var X=this,G=Object.getOwnPropertyDescriptor(this,F);if(!G||!G.set){var j=this[F]==null?W:this[F];Object.defineProperty(this,F,{get:function(){return j},set:function(ce){if(j!==ce){var se={type:"".concat(F,"-property-changed"),previous:{},new:{}};se.previous[F]=j,se.new[F]=ce,j=ce,O&&O(X,F),X.dispatchEvent(se)}}})}}},{key:"convert",value:function(F){return F}},{key:"getData",value:function(F,W){var O=this,X=this.source.requestToKey(this.source.isVectorSource?W:F),G=this.cache.getByArray(X);return G||(G=this.source.loadData(F,this).then(function(j){return O.convert(j,W)},function(j){throw j}),this.cache.setByArray(G,X)),G}},{key:"isValidData",value:function(){}},{key:"delete",value:function(){console.warn("Function delete doesn't exist for this layer")}}]),Z}(C.EventDispatcher),H=U;a.default=H;var q={moveLayerToIndex:function(te,Q,Z){Q=Math.min(Q,Z.length-1),Q=Math.max(Q,0);var ae=te.sequence,F=b(Z),W;try{for(F.s();!(W=F.n()).done;){var O=W.value;O.id===te.id?O.sequence=Q:O.sequence>ae&&O.sequence<=Q?O.sequence--:O.sequence>=Q&&O.sequence<ae&&O.sequence++}}catch(X){F.e(X)}finally{F.f()}},moveLayerDown:function(te,Q){te.sequence>0&&this.moveLayerToIndex(te,te.sequence-1,Q)},moveLayerUp:function(te,Q){var Z=Q.length-1;te.sequence<Z&&this.moveLayerToIndex(te,te.sequence+1,Q)},getColorLayersIdOrderedBySequence:function(te){var Q=Array.from(te);return Q.sort(function(Z,ae){return Z.sequence-ae.sequence}),Q.map(function(Z){return Z.id})}};a.ImageryLayers=q}(uA)),uA}var lT;function aC(){return lT||(lT=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.COLOR_LAYERS_ORDER_CHANGED=void 0;var u=id();function h(g,C){var D=typeof Symbol<"u"&&g[Symbol.iterator]||g["@@iterator"];if(!D){if(Array.isArray(g)||(D=R(g))||C&&g&&typeof g.length=="number"){D&&(g=D);var B=0,V=function(){};return{s:V,n:function(){return B>=g.length?{done:!0}:{done:!1,value:g[B++]}},e:function(_){throw _},f:V}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P=!0,L=!1,E;return{s:function(){D=D.call(g)},n:function(){var _=D.next();return P=_.done,_},e:function(_){L=!0,E=_},f:function(){try{!P&&D.return!=null&&D.return()}finally{if(L)throw E}}}}function R(g,C){if(!!g){if(typeof g=="string")return M(g,C);var D=Object.prototype.toString.call(g).slice(8,-1);if(D==="Object"&&g.constructor&&(D=g.constructor.name),D==="Map"||D==="Set")return Array.from(g);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return M(g,C)}}function M(g,C){(C==null||C>g.length)&&(C=g.length);for(var D=0,B=new Array(C);D<C;D++)B[D]=g[D];return B}function v(g,C){var D=u.ImageryLayers.getColorLayersIdOrderedBySequence(C),B=function(E){var b;(b=E.material)!==null&&b!==void 0&&b.setSequence&&E.material.setSequence(D)},V=h(g.level0Nodes),P;try{for(V.s();!(P=V.n()).done;){var L=P.value;L.traverse(B)}}catch(E){V.e(E)}finally{V.f()}}var y="layers-order-changed";a.COLOR_LAYERS_ORDER_CHANGED=y;var p={moveLayerUp:function(C,D){var B=C.getLayers(function(L){return L.isColorLayer}),V=C.getLayerById(D);if(V){var P=u.ImageryLayers.getColorLayersIdOrderedBySequence(B);u.ImageryLayers.moveLayerUp(V,B),v(C.tileLayer,B),C.dispatchEvent({type:y,previous:{sequence:P},new:{sequence:u.ImageryLayers.getColorLayersIdOrderedBySequence(B)}}),C.notifyChange(C.tileLayer)}else throw new Error("".concat(D," isn't color layer"))},moveLayerDown:function(C,D){var B=C.getLayers(function(L){return L.isColorLayer}),V=C.getLayerById(D);if(V){var P=u.ImageryLayers.getColorLayersIdOrderedBySequence(B);u.ImageryLayers.moveLayerDown(V,B),v(C.tileLayer,B),C.dispatchEvent({type:y,previous:{sequence:P},new:{sequence:u.ImageryLayers.getColorLayersIdOrderedBySequence(B)}}),C.notifyChange(C.tileLayer)}else throw new Error("".concat(D," isn't color layer"))},moveLayerToIndex:function(C,D,B){var V=C.getLayers(function(E){return E.isColorLayer}),P=C.getLayerById(D);if(P){var L=u.ImageryLayers.getColorLayersIdOrderedBySequence(V);u.ImageryLayers.moveLayerToIndex(P,B,V),v(C.tileLayer,V),C.dispatchEvent({type:y,previous:{sequence:L},new:{sequence:u.ImageryLayers.getColorLayersIdOrderedBySequence(V)}}),C.notifyChange(C.tileLayer)}else throw new Error("".concat(D," isn't color layer"))}};a.default=p}(oA)),oA}var FA={},IA={},cT;function VF(){return cT||(cT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=function(){function y(){(0,h.default)(this,y)}return(0,R.default)(y,null,[{key:"isWebGLAvailable",value:function(){try{var g=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(g.getContext("webgl")||g.getContext("experimental-webgl")))}catch{return!1}}},{key:"isWebGL2Available",value:function(){try{var g=document.createElement("canvas");return!!(window.WebGL2RenderingContext&&g.getContext("webgl2"))}catch{return!1}}},{key:"getWebGLErrorMessage",value:function(){return this.getErrorMessage(1)}},{key:"getWebGL2ErrorMessage",value:function(){return this.getErrorMessage(2)}},{key:"getErrorMessage",value:function(g){var C={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},D='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',B=document.createElement("div");return B.id="webglmessage",B.style.fontFamily="monospace",B.style.fontSize="13px",B.style.fontWeight="normal",B.style.textAlign="center",B.style.background="#fff",B.style.color="#000",B.style.padding="1.5em",B.style.width="400px",B.style.margin="5em auto 0",C[g]?D=D.replace("$0","graphics card"):D=D.replace("$0","browser"),D=D.replace("$1",{1:"WebGL",2:"WebGL 2"}[g]),B.innerHTML=D,B}}]),y}(),v=M;a.default=v}(IA)),IA}var kA={},fT;function WF(){return fT||(fT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=p(Dr());function y(E){if(typeof WeakMap!="function")return null;var b=new WeakMap,_=new WeakMap;return(y=function(T){return T?_:b})(E)}function p(E,b){if(!b&&E&&E.__esModule)return E;if(E===null||h(E)!=="object"&&typeof E!="function")return{default:E};var _=y(b);if(_&&_.has(E))return _.get(E);var x={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in E)if(N!=="default"&&Object.prototype.hasOwnProperty.call(E,N)){var U=T?Object.getOwnPropertyDescriptor(E,N):null;U&&(U.get||U.set)?Object.defineProperty(x,N,U):x[N]=E[N]}return x.default=E,_&&_.set(E,x),x}function g(E,b){return!(E.left>b.right||E.right<b.left||E.top>b.bottom||E.bottom<b.top)}function C(E){var b=E.parent;return b.material&&!b.material.visible&&b.children.find(function(_){return _.isTileMesh&&_.children.find(function(x){return x.isLabel})})}var D=new v.Frustum,B=function(){function E(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:12,_=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,x=arguments.length>2?arguments[2]:void 0,T=arguments.length>3?arguments[3]:void 0;(0,R.default)(this,E),this.x=b,this.y=_,this.grid=[],this.hidden=[],this.visible=[],this.resize(),this.reset(),this.width=x,this.height=T}return(0,M.default)(E,[{key:"reset",value:function(){for(var _=0;_<this.x;_++)for(var x=0;x<this.y;x++)this.grid[_][x].splice(0,this.grid[_][x].length);this.hidden=[],this.visible=[]}},{key:"resize",value:function(){for(var _=0;_<this.x;_++){this.grid[_]||(this.grid[_]=[]);for(var x=0;x<this.y;x++)this.grid[_][x]||(this.grid[_][x]=[])}}},{key:"insert",value:function(_){for(var x=Math.max(0,Math.floor(_.boundaries.left/this.width*this.x)),T=Math.min(this.x-1,Math.floor(_.boundaries.right/this.width*this.x)),N=Math.max(0,Math.floor(_.boundaries.top/this.height*this.y)),U=Math.min(this.y-1,Math.floor(_.boundaries.bottom/this.height*this.y)),H=x;H<=T;H++)for(var q=N;q<=U;q++)if(this.grid[H][q].length>0&&this.grid[H][q].some(function(Z){return g(Z.boundaries,_.boundaries)}))return this.hidden.push(_),!1;for(var te=x;te<=T;te++)for(var Q=N;Q<=U;Q++)this.grid[te][Q].push(_);return!0}}]),E}(),V=new v.Vector3,P=function(){function E(){(0,R.default)(this,E),this.domElement=document.createElement("div"),this.domElement.style.overflow="hidden",this.domElement.style.position="absolute",this.domElement.style.top="0",this.domElement.style.height="100%",this.domElement.style.width="100%",this.domElement.style.zIndex=1,this.garbage=document.createElement("div"),this.garbage.style.display="none",this.domElement.appendChild(this.garbage),this.halfWidth=0,this.halfHeight=0,this.grid=new B,this.infoTileLayer=void 0}return(0,M.default)(E,[{key:"setSize",value:function(_,x){this.domElement.style.width="".concat(_),this.domElement.style.height="".concat(x),this.halfWidth=_/2,this.halfHeight=x/2,this.grid.width=_,this.grid.height=x,this.grid.x=Math.ceil(_/20),this.grid.y=Math.ceil(x/20),this.grid.resize()}},{key:"registerLayer",value:function(_){this.domElement.appendChild(_.domElement)}},{key:"render",value:function(_,x){var T=this;!this.infoTileLayer||!this.infoTileLayer.layer.attachedLayers.find(function(N){return N.isLabelLayer&&N.visible})||(this.grid.reset(),D.setFromProjectionMatrix(x.projectionMatrix),this.culling(_,this.infoTileLayer.displayed.extent,x),this.grid.visible.sort(function(N,U){var H=U.order-N.order;return H==0?!N.visible&&U.visible?1:-1:H}),this.grid.visible.forEach(function(N){T.grid.insert(N)&&(N.visible=!0,N.updateCSSPosition())}),this.grid.hidden.forEach(function(N){N.visible=!1}))}},{key:"culling",value:function(_,x,T){var N=this;if(_.isLabel)!x.isPointInside(_.coordinates)||C(_)?this.grid.hidden.push(_):D.containsPoint(_.getWorldPosition(V).applyMatrix4(T.matrixWorldInverse))?_.parent.level<4&&_.parent.layer.horizonCulling&&_.parent.layer.horizonCulling(_.horizonCullingPoint)?this.grid.hidden.push(_):(V.applyMatrix4(T.projectionMatrix),_.updateProjectedPosition(V.x*this.halfWidth+this.halfWidth,-V.y*this.halfHeight+this.halfHeight),this.grid.visible.some(function(U){return U.projectedPosition.x==_.projectedPosition.x&&U.projectedPosition.y==_.projectedPosition.y&&U.baseContent==_.baseContent})?(_.parent.remove(_),this.grid.hidden.push(_)):this.grid.visible.push(_)):this.grid.hidden.push(_);else{if(_.visible){if(_.extent&&!_.extent.intersectsExtent(x)){this.hideNodeDOM(_);return}}else{this.hideNodeDOM(_);return}this.showNodeDOM(_),_.children.forEach(function(U){return N.culling(U,x,T)})}}},{key:"removeLabelDOM",value:function(_){this.garbage.appendChild(_.content),this.garbage.innerHTML=""}},{key:"hideNodeDOM",value:function(_){var x=this;if(_.domElements){var T=Object.values(_.domElements);T.length>0?T.forEach(function(N){N.visible==!0&&(N.dom.style.display="none",N.visible=!1)}):_.children.filter(function(N){return N.isTileMesh}).forEach(function(N){return x.hideNodeDOM(N)})}}},{key:"showNodeDOM",value:function(_){_.domElements&&Object.values(_.domElements).forEach(function(x){x.visible==!1&&(x.dom.style.display="block",x.visible=!0)})}}]),E}(),L=P;a.default=L}(kA)),kA}var hT;function HF(){return hT||(hT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=B(Dr()),y=u(td()),p=rd(),g=u(VF()),C=u(WF());function D(E){if(typeof WeakMap!="function")return null;var b=new WeakMap,_=new WeakMap;return(D=function(T){return T?_:b})(E)}function B(E,b){if(!b&&E&&E.__esModule)return E;if(E===null||h(E)!=="object"&&typeof E!="function")return{default:E};var _=D(b);if(_&&_.has(E))return _.get(E);var x={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in E)if(N!=="default"&&Object.prototype.hasOwnProperty.call(E,N)){var U=T?Object.getOwnPropertyDescriptor(E,N):null;U&&(U.get||U.set)?Object.defineProperty(x,N,U):x[N]=E[N]}return x.default=E,_&&_.set(E,x),x}var V=new v.Vector4,P=function(){function E(b){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,R.default)(this,E);var x=!y.default.isInternetExplorer();_.antialias===void 0&&(_.antialias=!0),_.alpha===void 0&&(_.alpha=!0),_.logarithmicDepthBuffer===void 0&&(_.logarithmicDepthBuffer=this.gLDebug||x),_.isWebGL2===void 0&&(_.isWebGL2=!0);var T,N;b.domElement?(T=b,N=T.domElement instanceof HTMLDivElement?T.domElement:T.domElement.parentElement):N=b,this.width=N.clientWidth,this.height=N.clientHeight,this.positionBuffer=null,this._nextThreejsLayer=1,this.fullSizeRenderTarget=new v.WebGLRenderTarget(this.width,this.height),this.fullSizeRenderTarget.texture.minFilter=v.LinearFilter,this.fullSizeRenderTarget.texture.magFilter=v.NearestFilter,this.fullSizeRenderTarget.depthBuffer=!0,this.fullSizeRenderTarget.depthTexture=new v.DepthTexture,this.fullSizeRenderTarget.depthTexture.type=v.UnsignedShortType,this.renderView=function(H){this.renderer.clear(),this.renderer.render(H.scene,H.camera.camera3D),H.tileLayer&&this.label2dRenderer.render(H.tileLayer.object3d,H.camera.camera3D)}.bind(this),this.onWindowResize=function(H,q){this.width=H,this.height=q,this.fullSizeRenderTarget.setSize(this.width,this.height),this.renderer.setSize(this.width,this.height),this.label2dRenderer.setSize(this.width,this.height)}.bind(this);try{this.label2dRenderer=new C.default,this.label2dRenderer.setSize(this.width,this.height),N.appendChild(this.label2dRenderer.domElement),this.renderer=T||new(_.isWebGL2?v.WebGLRenderer:v.WebGL1Renderer)({canvas:document.createElement("canvas"),antialias:_.antialias,alpha:_.alpha,logarithmicDepthBuffer:_.logarithmicDepthBuffer}),this.renderer.domElement.style.position="relative",this.renderer.domElement.style.zIndex=0,this.renderer.domElement.style.top=0}catch{var U=_.isWebGL2?"2":"1";console.error("Failed to create WebGLRenderer webGL ".concat(U,".")),this.renderer=null}if(!this.renderer)throw g.default.isWebGLAvailable()?g.default.isWebGL2Available()||N.appendChild(g.default.getErrorMessage(2)):N.appendChild(g.default.getErrorMessage(1)),new Error("WebGL unsupported");!T&&_.logarithmicDepthBuffer&&!this.renderer.capabilities.isWebGL2&&!this.renderer.extensions.get("EXT_frag_depth")&&(this.renderer.dispose(),this.renderer=new(_.isWebGL2?v.WebGLRenderer:v.WebGL1Renderer)({canvas:document.createElement("canvas"),antialias:_.antialias,alpha:_.alpha,logarithmicDepthBuffer:!1})),this.renderer.domElement.tabIndex===-1&&(this.renderer.domElement.tabIndex=-1),y.default.updateCapabilities(this.renderer),this.renderer.setClearColor(197896),this.renderer.autoClear=!1,this.renderer.sortObjects=!0,this.renderer.debug.checkShaderErrors=!1,T||(this.renderer.setPixelRatio(N.devicePixelRatio),this.renderer.setSize(N.clientWidth,N.clientHeight),N.appendChild(this.renderer.domElement))}return(0,M.default)(E,[{key:"getWindowSize",value:function(){return new v.Vector2(this.width,this.height)}},{key:"getRenderer",value:function(){return this.renderer}},{key:"renderViewToBuffer",value:function(_,x){return x||(x={x:0,y:0,width:this.width,height:this.height}),x.buffer=x.buffer||new Uint8Array(4*x.width*x.height),this.renderViewToRenderTarget(_,this.fullSizeRenderTarget,x),this.renderer.readRenderTargetPixels(this.fullSizeRenderTarget,x.x,this.height-(x.y+x.height),x.width,x.height,x.buffer),x.buffer}},{key:"renderViewToRenderTarget",value:function(_,x,T){x||(x=this.fullSizeRenderTarget);var N=this.renderer.getRenderTarget();return T&&(this.fullSizeRenderTarget.scissor.set(T.x,x.height-(T.y+T.height),T.width,T.height),this.fullSizeRenderTarget.scissorTest=!0),this.renderer.setRenderTarget(x),this.renderer.clear(!0,!0,!1),this.renderer.render(_.scene,_.camera.camera3D),this.renderer.setRenderTarget(N),this.fullSizeRenderTarget.scissorTest=!1,x}},{key:"bufferToImage",value:function(_,x,T){var N=document.createElement("canvas"),U=N.getContext("2d");N.width=x,N.height=T;var H=U.getImageData(0,0,x,T);H.data.set(_),U.putImageData(H,0,0);var q=new Image;return q.src=N.toDataURL(),q}},{key:"getUniqueThreejsLayer",value:function(){this._nextThreejsLayer>31&&(console.warn("Too much three.js layers. Starting from now all of them will use layerMask = 31"),this._nextThreejsLayer=31);var _=this._nextThreejsLayer++;return _}},{key:"depthBufferRGBAValueToOrthoZ",value:function(_,x){if(V.fromArray(_).divideScalar(255),y.default.isLogDepthBufferSupported()&&x.type=="PerspectiveCamera"){var T=(0,p.unpack1K)(V),N=2/(Math.log(x.far+1)/Math.LN2);return Math.pow(2,2*T/N)}else{var U=(0,p.unpack1K)(V);return U=U*2-1,U}}}]),E}(),L=P;a.default=L}(FA)),FA}var DA={},dT;function sC(){return dT||(dT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=Uf(),R=u(Zi());function M(L,E){var b=typeof Symbol<"u"&&L[Symbol.iterator]||L["@@iterator"];if(!b){if(Array.isArray(L)||(b=v(L))||E&&L&&typeof L.length=="number"){b&&(L=b);var _=0,x=function(){};return{s:x,n:function(){return _>=L.length?{done:!0}:{done:!1,value:L[_++]}},e:function(q){throw q},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T=!0,N=!1,U;return{s:function(){b=b.call(L)},n:function(){var q=b.next();return T=q.done,q},e:function(q){N=!0,U=q},f:function(){try{!T&&b.return!=null&&b.return()}finally{if(N)throw U}}}}function v(L,E){if(!!L){if(typeof L=="string")return y(L,E);var b=Object.prototype.toString.call(L).slice(8,-1);if(b==="Object"&&L.constructor&&(b=L.constructor.name),b==="Map"||b==="Set")return Array.from(L);if(b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b))return y(L,E)}}function y(L,E){(E==null||E>L.length)&&(E=L.length);for(var b=0,_=new Array(E);b<E;b++)_[b]=L[b];return _}function p(L,E,b,_,x,T){for(var N=L.x,U=L.y,H=_+T,q=_;H<_+x;q=H,H+=T){var te=E[H],Q=E[H+1],Z=E[q],ae=E[q+1],F=Z-te,W=ae-Q,O=Math.sqrt(F*F+W*W),X=((N-te)*F+(U-Q)*W)/O;if(X>=-b&&X<=O+b){var G=Math.abs(W*N-F*U+Z*Q-ae*te)/O;if(G<=b)return!0}}return!1}function g(L,E,b,_,x,T){for(var N=L.x,U=L.y,H=b*b,q,te=_;te<_+x;te+=T){var Q=E[te],Z=E[te+1],ae=N-Q,F=U-Z,W=ae*ae+F*F;W<H&&(q=[E[te],E[te+1]],H=W)}return q}function C(L,E,b,_,x,T){for(var N=L.x,U=L.y,H=!1,q=_,te=_+x-T;q<_+x;te=q,q+=T){var Q=E[q],Z=E[q+1],ae=E[te],F=E[te+1];if(p(L,[Q,Z,ae,F],b,0,4,2))return!0;Z>U!=F>U&&N<(ae-Q)*(U-Z)/(F-Z)+Q&&(H=!H)}return H}function D(L,E,b,_,x,T,N){if(E==h.FEATURE_TYPES.LINE&&p(L,b,_,x,T,N))return!0;if(E==h.FEATURE_TYPES.POLYGON&&C(L,b,_,x,T,N))return!0;if(E==h.FEATURE_TYPES.POINT){var U=g(L,b,_,x,T,N);if(U)return{coordinates:U}}}function B(L,E,b,_){var x=L.as(E.crs),T=M(E.geometries),N;try{for(T.s();!(N=T.n()).done;){var U=N.value;if(U.extent==null||U.extent.isPointInside(x,b)){var H=U.indices[0].offset*E.size,q=U.indices[0].count*E.size,te=D(x,E.type,E.vertices,b,H,q,E.size);te&&_.push({type:E.type,geometry:U,coordinates:te.coordinates,style:E.style})}}}catch(Q){T.e(Q)}finally{T.f()}}var V=new R.default("EPSG:4326",0,0,0),P={filterFeaturesUnderCoordinate:function(E,b){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.1,x=[];if(E.as(b.crs,V),V.applyMatrix4(b.matrixWorldInverse),b.extent.isPointInside(V,_))if(b.isFeatureCollection){_*=Math.sqrt(Math.pow(b.scale.x,2)+Math.pow(b.scale.y,2));var T=M(b.features),N;try{for(T.s();!(N=T.n()).done;){var U=N.value;U.extent&&!U.extent.isPointInside(V,_)||B(V,U,_,x)}}catch(H){T.e(H)}finally{T.f()}}else b.geometries&&B(V,b,_,x);return x}};a.default=P}(DA)),DA}var NA={};function If(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var BA={exports:{}},pT;function qF(){return pT||(pT=1,function(a,u){(function(h){a.exports=h()})(function(){return function h(R,M,v){function y(C,D){if(!M[C]){if(!R[C]){var B=typeof If=="function"&&If;if(!D&&B)return B(C,!0);if(p)return p(C,!0);var V=new Error("Cannot find module '"+C+"'");throw V.code="MODULE_NOT_FOUND",V}var P=M[C]={exports:{}};R[C][0].call(P.exports,function(L){var E=R[C][1][L];return y(E||L)},P,P.exports,h,R,M,v)}return M[C].exports}for(var p=typeof If=="function"&&If,g=0;g<v.length;g++)y(v[g]);return y}({1:[function(h,R,M){var v,y,p,g,C,D=function(V,P){for(var L in P)B.call(P,L)&&(V[L]=P[L]);function E(){this.constructor=V}return E.prototype=P.prototype,V.prototype=new E,V.__super__=P.prototype,V},B={}.hasOwnProperty;v=h("./PriorityQueue/AbstractPriorityQueue"),y=h("./PriorityQueue/ArrayStrategy"),g=h("./PriorityQueue/BinaryHeapStrategy"),p=h("./PriorityQueue/BHeapStrategy"),C=function(V){D(P,V);function P(L){L||(L={}),L.strategy||(L.strategy=g),L.comparator||(L.comparator=function(E,b){return(E||0)-(b||0)}),P.__super__.constructor.call(this,L)}return P}(v),C.ArrayStrategy=y,C.BinaryHeapStrategy=g,C.BHeapStrategy=p,R.exports=C},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(h,R,M){R.exports=function(){function v(y){var p;if((y!=null?y.strategy:void 0)==null)throw"Must pass options.strategy, a strategy";if((y!=null?y.comparator:void 0)==null)throw"Must pass options.comparator, a comparator";this.priv=new y.strategy(y),this.length=(y!=null&&(p=y.initialValues)!=null?p.length:void 0)||0}return v.prototype.queue=function(y){this.length++,this.priv.queue(y)},v.prototype.dequeue=function(y){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},v.prototype.peek=function(y){if(!this.length)throw"Empty queue";return this.priv.peek()},v.prototype.clear=function(){return this.length=0,this.priv.clear()},v}()},{}],3:[function(h,R,M){var v;v=function(y,p,g){var C,D,B;for(D=0,C=y.length;D<C;)B=D+C>>>1,g(y[B],p)>=0?D=B+1:C=B;return D},R.exports=function(){function y(p){var g;this.options=p,this.comparator=this.options.comparator,this.data=((g=this.options.initialValues)!=null?g.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return y.prototype.queue=function(p){var g;g=v(this.data,p,this.comparator),this.data.splice(g,0,p)},y.prototype.dequeue=function(){return this.data.pop()},y.prototype.peek=function(){return this.data[this.data.length-1]},y.prototype.clear=function(){this.data.length=0},y}()},{}],4:[function(h,R,M){R.exports=function(){function v(y){var p,g,C,D,B,V,P,L;for(this.comparator=(y!=null?y.comparator:void 0)||function(E,b){return E-b},this.pageSize=(y!=null?y.pageSize:void 0)||512,this.length=0,P=0;1<<P<this.pageSize;)P+=1;if(1<<P!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=P,this._emptyMemoryPageTemplate=p=[],g=0,B=this.pageSize;0<=B?g<B:g>B;0<=B?++g:--g)p.push(null);if(this._memory=[],this._mask=this.pageSize-1,y.initialValues)for(V=y.initialValues,C=0,D=V.length;C<D;C++)L=V[C],this.queue(L)}return v.prototype.queue=function(y){this.length+=1,this._write(this.length,y),this._bubbleUp(this.length,y)},v.prototype.dequeue=function(){var y,p;return y=this._read(1),p=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,p),this._bubbleDown(1,p)),y},v.prototype.peek=function(){return this._read(1)},v.prototype.clear=function(){this.length=0,this._memory.length=0},v.prototype._write=function(y,p){var g;for(g=y>>this._shift;g>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[g][y&this._mask]=p},v.prototype._read=function(y){return this._memory[y>>this._shift][y&this._mask]},v.prototype._bubbleUp=function(y,p){var g,C,D,B;for(g=this.comparator;y>1&&(C=y&this._mask,y<this.pageSize||C>3?D=y&~this._mask|C>>1:C<2?(D=y-this.pageSize>>this._shift,D+=D&~(this._mask>>1),D|=this.pageSize>>1):D=y-2,B=this._read(D),!(g(B,p)<0));)this._write(D,p),this._write(y,B),y=D},v.prototype._bubbleDown=function(y,p){var g,C,D,B,V;for(V=this.comparator;y<this.length;)if(y>this._mask&&!(y&this._mask-1)?g=C=y+2:y&this.pageSize>>1?(g=(y&~this._mask)>>1,g|=y&this._mask>>1,g=g+1<<this._shift,C=g+1):(g=y+(y&this._mask),C=g+1),g!==C&&C<=this.length)if(D=this._read(g),B=this._read(C),V(D,p)<0&&V(D,B)<=0)this._write(g,p),this._write(y,D),y=g;else if(V(B,p)<0)this._write(C,p),this._write(y,B),y=C;else break;else if(g<=this.length)if(D=this._read(g),V(D,p)<0)this._write(g,p),this._write(y,D),y=g;else break;else break},v}()},{}],5:[function(h,R,M){R.exports=function(){function v(y){var p;this.comparator=(y!=null?y.comparator:void 0)||function(g,C){return g-C},this.length=0,this.data=((p=y.initialValues)!=null?p.slice(0):void 0)||[],this._heapify()}return v.prototype._heapify=function(){var y,p,g;if(this.data.length>0)for(y=p=1,g=this.data.length;1<=g?p<g:p>g;y=1<=g?++p:--p)this._bubbleUp(y)},v.prototype.queue=function(y){this.data.push(y),this._bubbleUp(this.data.length-1)},v.prototype.dequeue=function(){var y,p;return p=this.data[0],y=this.data.pop(),this.data.length>0&&(this.data[0]=y,this._bubbleDown(0)),p},v.prototype.peek=function(){return this.data[0]},v.prototype.clear=function(){this.length=0,this.data.length=0},v.prototype._bubbleUp=function(y){for(var p,g;y>0&&(p=y-1>>>1,this.comparator(this.data[y],this.data[p])<0);)g=this.data[p],this.data[p]=this.data[y],this.data[y]=g,y=p},v.prototype._bubbleDown=function(y){var p,g,C,D,B;for(p=this.data.length-1;g=(y<<1)+1,D=g+1,C=y,g<=p&&this.comparator(this.data[g],this.data[C])<0&&(C=g),D<=p&&this.comparator(this.data[D],this.data[C])<0&&(C=D),C!==y;)B=this.data[C],this.data[C]=this.data[y],this.data[y]=B,y=C},v}()},{}]},{},[1])(1)})}(BA)),BA.exports}var UA={},mT;function XF(){return mT||(mT=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u={executeCommand:function(R){var M=R.layer,v=R.extentsSource,y=R.extentsDestination||v;return Promise.all(v.map(function(p,g){return M.getData(p,y[g])}))}};a.default=u}(UA)),UA}var zA={},GA={},vT;function oC(){return vT||(vT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=function(){function y(p){(0,h.default)(this,y),this.command=p,this.isCancelledCommandException=!0}return(0,R.default)(y,[{key:"toString",value:function(){return"Cancelled command ".concat(this.command.requester.id,"/").concat(this.command.layer.id)}}]),y}(),v=M;a.default=v}(GA)),GA}var gT;function ZF(){return gT||(gT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(oC());function R(p,g){var C=typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(!C){if(Array.isArray(p)||(C=M(p))||g&&p&&typeof p.length=="number"){C&&(p=C);var D=0,B=function(){};return{s:B,n:function(){return D>=p.length?{done:!0}:{done:!1,value:p[D++]}},e:function(b){throw b},f:B}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var V=!0,P=!1,L;return{s:function(){C=C.call(p)},n:function(){var b=C.next();return V=b.done,b},e:function(b){P=!0,L=b},f:function(){try{!V&&C.return!=null&&C.return()}finally{if(P)throw L}}}}function M(p,g){if(!!p){if(typeof p=="string")return v(p,g);var C=Object.prototype.toString.call(p).slice(8,-1);if(C==="Object"&&p.constructor&&(C=p.constructor.name),C==="Map"||C==="Set")return Array.from(p);if(C==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return v(p,g)}}function v(p,g){(g==null||g>p.length)&&(g=p.length);for(var C=0,D=new Array(g);C<g;C++)D[C]=p[C];return D}var y={executeCommand:function(g){var C=[],D=g.layer,B=g.requester,V=g.extentsSource;if(B&&!B.material)return Promise.reject(new h.default(g));var P=R(V),L;try{for(P.s();!(L=P.n()).done;){var E=L.value;C.push(D.convert(B,E))}}catch(b){P.e(b)}finally{P.f()}return Promise.all(C)}};a.default=y}(zA)),zA}var VA={},WA={},Gm={},yT;function jF(){if(yT)return Gm;yT=1;var a=hr.exports;Object.defineProperty(Gm,"__esModule",{value:!0}),Gm.GLTFLoader=void 0;var u=a(XR()),h=a(Lr.exports),R=a(Wi()),M=a(Cs()),v=a(Ir()),y=a(kr()),p=a(dn()),g=a(pn()),C=a(ln()),D=Dr();function B(re,oe){var _e=typeof Symbol<"u"&&re[Symbol.iterator]||re["@@iterator"];if(!_e){if(Array.isArray(re)||(_e=V(re))||oe&&re&&typeof re.length=="number"){_e&&(re=_e);var Re=0,ke=function(){};return{s:ke,n:function(){return Re>=re.length?{done:!0}:{done:!1,value:re[Re++]}},e:function(_t){throw _t},f:ke}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Be=!0,at=!1,wt;return{s:function(){_e=_e.call(re)},n:function(){var _t=_e.next();return Be=_t.done,_t},e:function(_t){at=!0,wt=_t},f:function(){try{!Be&&_e.return!=null&&_e.return()}finally{if(at)throw wt}}}}function V(re,oe){if(!!re){if(typeof re=="string")return P(re,oe);var _e=Object.prototype.toString.call(re).slice(8,-1);if(_e==="Object"&&re.constructor&&(_e=re.constructor.name),_e==="Map"||_e==="Set")return Array.from(re);if(_e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_e))return P(re,oe)}}function P(re,oe){(oe==null||oe>re.length)&&(oe=re.length);for(var _e=0,Re=new Array(oe);_e<oe;_e++)Re[_e]=re[_e];return Re}function L(re){var oe=E();return function(){var _e=(0,C.default)(re),Re;if(oe){var ke=(0,C.default)(this).constructor;Re=Reflect.construct(_e,arguments,ke)}else Re=_e.apply(this,arguments);return(0,g.default)(this,Re)}}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var b=function(re){(0,p.default)(_e,re);var oe=L(_e);function _e(Re){var ke;return(0,v.default)(this,_e),ke=oe.call(this,Re),ke.dracoLoader=null,ke.ktx2Loader=null,ke.meshoptDecoder=null,ke.pluginCallbacks=[],ke.register(function(Be){return new U(Be)}),ke.register(function(Be){return new ae(Be)}),ke.register(function(Be){return new F(Be)}),ke.register(function(Be){return new H(Be)}),ke.register(function(Be){return new q(Be)}),ke.register(function(Be){return new te(Be)}),ke.register(function(Be){return new Q(Be)}),ke.register(function(Be){return new Z(Be)}),ke.register(function(Be){return new T(Be)}),ke.register(function(Be){return new W(Be)}),ke}return(0,y.default)(_e,[{key:"load",value:function(ke,Be,at,wt){var ht=this,_t;this.resourcePath!==""?_t=this.resourcePath:this.path!==""?_t=this.path:_t=D.LoaderUtils.extractUrlBase(ke),this.manager.itemStart(ke);var St=function(vt){wt?wt(vt):console.error(vt),ht.manager.itemError(ke),ht.manager.itemEnd(ke)},Ct=new D.FileLoader(this.manager);Ct.setPath(this.path),Ct.setResponseType("arraybuffer"),Ct.setRequestHeader(this.requestHeader),Ct.setWithCredentials(this.withCredentials),Ct.load(ke,function(vt){try{ht.parse(vt,_t,function(ct){Be(ct),ht.manager.itemEnd(ke)},St)}catch(ct){St(ct)}},at,St)}},{key:"setDRACOLoader",value:function(ke){return this.dracoLoader=ke,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(ke){return this.ktx2Loader=ke,this}},{key:"setMeshoptDecoder",value:function(ke){return this.meshoptDecoder=ke,this}},{key:"register",value:function(ke){return this.pluginCallbacks.indexOf(ke)===-1&&this.pluginCallbacks.push(ke),this}},{key:"unregister",value:function(ke){return this.pluginCallbacks.indexOf(ke)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ke),1),this}},{key:"parse",value:function(ke,Be,at,wt){var ht,_t={},St={};if(typeof ke=="string")ht=ke;else{var Ct=D.LoaderUtils.decodeText(new Uint8Array(ke,0,4));if(Ct===O){try{_t[x.KHR_BINARY_GLTF]=new j(ke)}catch(Ut){wt&&wt(Ut);return}ht=_t[x.KHR_BINARY_GLTF].content}else ht=D.LoaderUtils.decodeText(new Uint8Array(ke))}var vt=JSON.parse(ht);if(vt.asset===void 0||vt.asset.version[0]<2){wt&&wt(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var ct=new je(vt,{path:Be||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ct.fileLoader.setRequestHeader(this.requestHeader);for(var Dt=0;Dt<this.pluginCallbacks.length;Dt++){var fr=this.pluginCallbacks[Dt](ct);St[fr.name]=fr,_t[fr.name]=!0}if(vt.extensionsUsed)for(var er=0;er<vt.extensionsUsed.length;++er){var dr=vt.extensionsUsed[er],zr=vt.extensionsRequired||[];switch(dr){case x.KHR_MATERIALS_UNLIT:_t[dr]=new N;break;case x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:_t[dr]=new ue;break;case x.KHR_DRACO_MESH_COMPRESSION:_t[dr]=new K(vt,this.dracoLoader);break;case x.KHR_TEXTURE_TRANSFORM:_t[dr]=new ce;break;case x.KHR_MESH_QUANTIZATION:_t[dr]=new Y;break;default:zr.indexOf(dr)>=0&&St[dr]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+dr+'".')}}ct.setExtensions(_t),ct.setPlugins(St),ct.parse(at,wt)}},{key:"parseAsync",value:function(ke,Be){var at=this;return new Promise(function(wt,ht){at.parse(ke,Be,wt,ht)})}}]),_e}(D.Loader);Gm.GLTFLoader=b;function _(){var re={};return{get:function(_e){return re[_e]},add:function(_e,Re){re[_e]=Re},remove:function(_e){delete re[_e]},removeAll:function(){re={}}}}var x={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},T=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return(0,y.default)(re,[{key:"_markDefs",value:function(){for(var _e=this.parser,Re=this.parser.json.nodes||[],ke=0,Be=Re.length;ke<Be;ke++){var at=Re[ke];at.extensions&&at.extensions[this.name]&&at.extensions[this.name].light!==void 0&&_e._addNodeRef(this.cache,at.extensions[this.name].light)}}},{key:"_loadLight",value:function(_e){var Re=this.parser,ke="light:"+_e,Be=Re.cache.get(ke);if(Be)return Be;var at=Re.json,wt=at.extensions&&at.extensions[this.name]||{},ht=wt.lights||[],_t=ht[_e],St,Ct=new D.Color(16777215);_t.color!==void 0&&Ct.fromArray(_t.color);var vt=_t.range!==void 0?_t.range:0;switch(_t.type){case"directional":St=new D.DirectionalLight(Ct),St.target.position.set(0,0,-1),St.add(St.target);break;case"point":St=new D.PointLight(Ct),St.distance=vt;break;case"spot":St=new D.SpotLight(Ct),St.distance=vt,_t.spot=_t.spot||{},_t.spot.innerConeAngle=_t.spot.innerConeAngle!==void 0?_t.spot.innerConeAngle:0,_t.spot.outerConeAngle=_t.spot.outerConeAngle!==void 0?_t.spot.outerConeAngle:Math.PI/4,St.angle=_t.spot.outerConeAngle,St.penumbra=1-_t.spot.innerConeAngle/_t.spot.outerConeAngle,St.target.position.set(0,0,-1),St.add(St.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+_t.type)}return St.position.set(0,0,0),St.decay=2,_t.intensity!==void 0&&(St.intensity=_t.intensity),St.name=Re.createUniqueName(_t.name||"light_"+_e),Be=Promise.resolve(St),Re.cache.add(ke,Be),Be}},{key:"createNodeAttachment",value:function(_e){var Re=this,ke=this.parser,Be=ke.json,at=Be.nodes[_e],wt=at.extensions&&at.extensions[this.name]||{},ht=wt.light;return ht===void 0?null:this._loadLight(ht).then(function(_t){return ke._getNodeRef(Re.cache,ht,_t)})}}]),re}(),N=function(){function re(){(0,v.default)(this,re),this.name=x.KHR_MATERIALS_UNLIT}return(0,y.default)(re,[{key:"getMaterialType",value:function(){return D.MeshBasicMaterial}},{key:"extendParams",value:function(_e,Re,ke){var Be=[];_e.color=new D.Color(1,1,1),_e.opacity=1;var at=Re.pbrMetallicRoughness;if(at){if(Array.isArray(at.baseColorFactor)){var wt=at.baseColorFactor;_e.color.fromArray(wt),_e.opacity=wt[3]}at.baseColorTexture!==void 0&&Be.push(ke.assignTexture(_e,"map",at.baseColorTexture))}return Promise.all(Be)}}]),re}(),U=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_MATERIALS_CLEARCOAT}return(0,y.default)(re,[{key:"getMaterialType",value:function(_e){var Re=this.parser,ke=Re.json.materials[_e];return!ke.extensions||!ke.extensions[this.name]?null:D.MeshPhysicalMaterial}},{key:"extendMaterialParams",value:function(_e,Re){var ke=this.parser,Be=ke.json.materials[_e];if(!Be.extensions||!Be.extensions[this.name])return Promise.resolve();var at=[],wt=Be.extensions[this.name];if(wt.clearcoatFactor!==void 0&&(Re.clearcoat=wt.clearcoatFactor),wt.clearcoatTexture!==void 0&&at.push(ke.assignTexture(Re,"clearcoatMap",wt.clearcoatTexture)),wt.clearcoatRoughnessFactor!==void 0&&(Re.clearcoatRoughness=wt.clearcoatRoughnessFactor),wt.clearcoatRoughnessTexture!==void 0&&at.push(ke.assignTexture(Re,"clearcoatRoughnessMap",wt.clearcoatRoughnessTexture)),wt.clearcoatNormalTexture!==void 0&&(at.push(ke.assignTexture(Re,"clearcoatNormalMap",wt.clearcoatNormalTexture)),wt.clearcoatNormalTexture.scale!==void 0)){var ht=wt.clearcoatNormalTexture.scale;Re.clearcoatNormalScale=new D.Vector2(ht,ht)}return Promise.all(at)}}]),re}(),H=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_MATERIALS_SHEEN}return(0,y.default)(re,[{key:"getMaterialType",value:function(_e){var Re=this.parser,ke=Re.json.materials[_e];return!ke.extensions||!ke.extensions[this.name]?null:D.MeshPhysicalMaterial}},{key:"extendMaterialParams",value:function(_e,Re){var ke=this.parser,Be=ke.json.materials[_e];if(!Be.extensions||!Be.extensions[this.name])return Promise.resolve();var at=[];Re.sheenColor=new D.Color(0,0,0),Re.sheenRoughness=0,Re.sheen=1;var wt=Be.extensions[this.name];return wt.sheenColorFactor!==void 0&&Re.sheenColor.fromArray(wt.sheenColorFactor),wt.sheenRoughnessFactor!==void 0&&(Re.sheenRoughness=wt.sheenRoughnessFactor),wt.sheenColorTexture!==void 0&&at.push(ke.assignTexture(Re,"sheenColorMap",wt.sheenColorTexture)),wt.sheenRoughnessTexture!==void 0&&at.push(ke.assignTexture(Re,"sheenRoughnessMap",wt.sheenRoughnessTexture)),Promise.all(at)}}]),re}(),q=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_MATERIALS_TRANSMISSION}return(0,y.default)(re,[{key:"getMaterialType",value:function(_e){var Re=this.parser,ke=Re.json.materials[_e];return!ke.extensions||!ke.extensions[this.name]?null:D.MeshPhysicalMaterial}},{key:"extendMaterialParams",value:function(_e,Re){var ke=this.parser,Be=ke.json.materials[_e];if(!Be.extensions||!Be.extensions[this.name])return Promise.resolve();var at=[],wt=Be.extensions[this.name];return wt.transmissionFactor!==void 0&&(Re.transmission=wt.transmissionFactor),wt.transmissionTexture!==void 0&&at.push(ke.assignTexture(Re,"transmissionMap",wt.transmissionTexture)),Promise.all(at)}}]),re}(),te=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_MATERIALS_VOLUME}return(0,y.default)(re,[{key:"getMaterialType",value:function(_e){var Re=this.parser,ke=Re.json.materials[_e];return!ke.extensions||!ke.extensions[this.name]?null:D.MeshPhysicalMaterial}},{key:"extendMaterialParams",value:function(_e,Re){var ke=this.parser,Be=ke.json.materials[_e];if(!Be.extensions||!Be.extensions[this.name])return Promise.resolve();var at=[],wt=Be.extensions[this.name];Re.thickness=wt.thicknessFactor!==void 0?wt.thicknessFactor:0,wt.thicknessTexture!==void 0&&at.push(ke.assignTexture(Re,"thicknessMap",wt.thicknessTexture)),Re.attenuationDistance=wt.attenuationDistance||0;var ht=wt.attenuationColor||[1,1,1];return Re.attenuationColor=new D.Color(ht[0],ht[1],ht[2]),Promise.all(at)}}]),re}(),Q=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_MATERIALS_IOR}return(0,y.default)(re,[{key:"getMaterialType",value:function(_e){var Re=this.parser,ke=Re.json.materials[_e];return!ke.extensions||!ke.extensions[this.name]?null:D.MeshPhysicalMaterial}},{key:"extendMaterialParams",value:function(_e,Re){var ke=this.parser,Be=ke.json.materials[_e];if(!Be.extensions||!Be.extensions[this.name])return Promise.resolve();var at=Be.extensions[this.name];return Re.ior=at.ior!==void 0?at.ior:1.5,Promise.resolve()}}]),re}(),Z=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_MATERIALS_SPECULAR}return(0,y.default)(re,[{key:"getMaterialType",value:function(_e){var Re=this.parser,ke=Re.json.materials[_e];return!ke.extensions||!ke.extensions[this.name]?null:D.MeshPhysicalMaterial}},{key:"extendMaterialParams",value:function(_e,Re){var ke=this.parser,Be=ke.json.materials[_e];if(!Be.extensions||!Be.extensions[this.name])return Promise.resolve();var at=[],wt=Be.extensions[this.name];Re.specularIntensity=wt.specularFactor!==void 0?wt.specularFactor:1,wt.specularTexture!==void 0&&at.push(ke.assignTexture(Re,"specularIntensityMap",wt.specularTexture));var ht=wt.specularColorFactor||[1,1,1];return Re.specularColor=new D.Color(ht[0],ht[1],ht[2]),wt.specularColorTexture!==void 0&&at.push(ke.assignTexture(Re,"specularColorMap",wt.specularColorTexture).then(function(_t){_t.encoding=D.sRGBEncoding})),Promise.all(at)}}]),re}(),ae=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.KHR_TEXTURE_BASISU}return(0,y.default)(re,[{key:"loadTexture",value:function(_e){var Re=this.parser,ke=Re.json,Be=ke.textures[_e];if(!Be.extensions||!Be.extensions[this.name])return null;var at=Be.extensions[this.name],wt=ke.images[at.source],ht=Re.options.ktx2Loader;if(!ht){if(ke.extensionsRequired&&ke.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return Re.loadTextureImage(_e,wt,ht)}}]),re}(),F=function(){function re(oe){(0,v.default)(this,re),this.parser=oe,this.name=x.EXT_TEXTURE_WEBP,this.isSupported=null}return(0,y.default)(re,[{key:"loadTexture",value:function(_e){var Re=this.name,ke=this.parser,Be=ke.json,at=Be.textures[_e];if(!at.extensions||!at.extensions[Re])return null;var wt=at.extensions[Re],ht=Be.images[wt.source],_t=ke.textureLoader;if(ht.uri){var St=ke.options.manager.getHandler(ht.uri);St!==null&&(_t=St)}return this.detectSupport().then(function(Ct){if(Ct)return ke.loadTextureImage(_e,ht,_t);if(Be.extensionsRequired&&Be.extensionsRequired.indexOf(Re)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return ke.loadTexture(_e)})}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise(function(_e){var Re=new Image;Re.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",Re.onload=Re.onerror=function(){_e(Re.height===1)}})),this.isSupported}}]),re}(),W=function(){function re(oe){(0,v.default)(this,re),this.name=x.EXT_MESHOPT_COMPRESSION,this.parser=oe}return(0,y.default)(re,[{key:"loadBufferView",value:function(_e){var Re=this.parser.json,ke=Re.bufferViews[_e];if(ke.extensions&&ke.extensions[this.name]){var Be=ke.extensions[this.name],at=this.parser.getDependency("buffer",Be.buffer),wt=this.parser.options.meshoptDecoder;if(!wt||!wt.supported){if(Re.extensionsRequired&&Re.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([at,wt.ready]).then(function(ht){var _t=Be.byteOffset||0,St=Be.byteLength||0,Ct=Be.count,vt=Be.byteStride,ct=new ArrayBuffer(Ct*vt),Dt=new Uint8Array(ht[0],_t,St);return wt.decodeGltfBuffer(new Uint8Array(ct),Ct,vt,Dt,Be.mode,Be.filter),ct})}else return null}}]),re}(),O="glTF",X=12,G={JSON:1313821514,BIN:5130562},j=(0,y.default)(function re(oe){(0,v.default)(this,re),this.name=x.KHR_BINARY_GLTF,this.content=null,this.body=null;var _e=new DataView(oe,0,X);if(this.header={magic:D.LoaderUtils.decodeText(new Uint8Array(oe.slice(0,4))),version:_e.getUint32(4,!0),length:_e.getUint32(8,!0)},this.header.magic!==O)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var Re=this.header.length-X,ke=new DataView(oe,X),Be=0;Be<Re;){var at=ke.getUint32(Be,!0);Be+=4;var wt=ke.getUint32(Be,!0);if(Be+=4,wt===G.JSON){var ht=new Uint8Array(oe,X+Be,at);this.content=D.LoaderUtils.decodeText(ht)}else if(wt===G.BIN){var _t=X+Be;this.body=oe.slice(_t,_t+at)}Be+=at}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}),K=function(){function re(oe,_e){if((0,v.default)(this,re),!_e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=x.KHR_DRACO_MESH_COMPRESSION,this.json=oe,this.dracoLoader=_e,this.dracoLoader.preload()}return(0,y.default)(re,[{key:"decodePrimitive",value:function(_e,Re){var ke=this.json,Be=this.dracoLoader,at=_e.extensions[this.name].bufferView,wt=_e.extensions[this.name].attributes,ht={},_t={},St={};for(var Ct in wt){var vt=ze[Ct]||Ct.toLowerCase();ht[vt]=wt[Ct]}for(var ct in _e.attributes){var Dt=ze[ct]||ct.toLowerCase();if(wt[ct]!==void 0){var fr=ke.accessors[_e.attributes[ct]],er=pt[fr.componentType];St[Dt]=er,_t[Dt]=fr.normalized===!0}}return Re.getDependency("bufferView",at).then(function(dr){return new Promise(function(zr){Be.decodeDracoFile(dr,function(Ut){for(var on in Ut.attributes){var tn=Ut.attributes[on],Ln=_t[on];Ln!==void 0&&(tn.normalized=Ln)}zr(Ut)},ht,St)})})}}]),re}(),ce=function(){function re(){(0,v.default)(this,re),this.name=x.KHR_TEXTURE_TRANSFORM}return(0,y.default)(re,[{key:"extendTexture",value:function(_e,Re){return Re.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),Re.offset===void 0&&Re.rotation===void 0&&Re.scale===void 0||(_e=_e.clone(),Re.offset!==void 0&&_e.offset.fromArray(Re.offset),Re.rotation!==void 0&&(_e.rotation=Re.rotation),Re.scale!==void 0&&_e.repeat.fromArray(Re.scale),_e.needsUpdate=!0),_e}}]),re}(),se=function(re){(0,p.default)(_e,re);var oe=L(_e);function _e(Re){var ke;(0,v.default)(this,_e),ke=oe.call(this),ke.isGLTFSpecularGlossinessMaterial=!0;var Be=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),at=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),wt=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),ht=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),_t=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),St={specular:{value:new D.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return ke._extraUniforms=St,ke.onBeforeCompile=function(Ct){for(var vt in St)Ct.uniforms[vt]=St[vt];Ct.fragmentShader=Ct.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",Be).replace("#include <metalnessmap_pars_fragment>",at).replace("#include <roughnessmap_fragment>",wt).replace("#include <metalnessmap_fragment>",ht).replace("#include <lights_physical_fragment>",_t)},Object.defineProperties((0,R.default)(ke),{specular:{get:function(){return St.specular.value},set:function(vt){St.specular.value=vt}},specularMap:{get:function(){return St.specularMap.value},set:function(vt){St.specularMap.value=vt,vt?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return St.glossiness.value},set:function(vt){St.glossiness.value=vt}},glossinessMap:{get:function(){return St.glossinessMap.value},set:function(vt){St.glossinessMap.value=vt,vt?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete ke.metalness,delete ke.roughness,delete ke.metalnessMap,delete ke.roughnessMap,ke.setValues(Re),ke}return(0,y.default)(_e,[{key:"copy",value:function(ke){return(0,M.default)((0,C.default)(_e.prototype),"copy",this).call(this,ke),this.specularMap=ke.specularMap,this.specular.copy(ke.specular),this.glossinessMap=ke.glossinessMap,this.glossiness=ke.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),_e}(D.MeshStandardMaterial),ue=function(){function re(){(0,v.default)(this,re),this.name=x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return(0,y.default)(re,[{key:"getMaterialType",value:function(){return se}},{key:"extendParams",value:function(_e,Re,ke){var Be=Re.extensions[this.name];_e.color=new D.Color(1,1,1),_e.opacity=1;var at=[];if(Array.isArray(Be.diffuseFactor)){var wt=Be.diffuseFactor;_e.color.fromArray(wt),_e.opacity=wt[3]}if(Be.diffuseTexture!==void 0&&at.push(ke.assignTexture(_e,"map",Be.diffuseTexture)),_e.emissive=new D.Color(0,0,0),_e.glossiness=Be.glossinessFactor!==void 0?Be.glossinessFactor:1,_e.specular=new D.Color(1,1,1),Array.isArray(Be.specularFactor)&&_e.specular.fromArray(Be.specularFactor),Be.specularGlossinessTexture!==void 0){var ht=Be.specularGlossinessTexture;at.push(ke.assignTexture(_e,"glossinessMap",ht)),at.push(ke.assignTexture(_e,"specularMap",ht))}return Promise.all(at)}},{key:"createMaterial",value:function(_e){var Re=new se(_e);return Re.fog=!0,Re.color=_e.color,Re.map=_e.map===void 0?null:_e.map,Re.lightMap=null,Re.lightMapIntensity=1,Re.aoMap=_e.aoMap===void 0?null:_e.aoMap,Re.aoMapIntensity=1,Re.emissive=_e.emissive,Re.emissiveIntensity=1,Re.emissiveMap=_e.emissiveMap===void 0?null:_e.emissiveMap,Re.bumpMap=_e.bumpMap===void 0?null:_e.bumpMap,Re.bumpScale=1,Re.normalMap=_e.normalMap===void 0?null:_e.normalMap,Re.normalMapType=D.TangentSpaceNormalMap,_e.normalScale&&(Re.normalScale=_e.normalScale),Re.displacementMap=null,Re.displacementScale=1,Re.displacementBias=0,Re.specularMap=_e.specularMap===void 0?null:_e.specularMap,Re.specular=_e.specular,Re.glossinessMap=_e.glossinessMap===void 0?null:_e.glossinessMap,Re.glossiness=_e.glossiness,Re.alphaMap=null,Re.envMap=_e.envMap===void 0?null:_e.envMap,Re.envMapIntensity=1,Re.refractionRatio=.98,Re}}]),re}(),Y=(0,y.default)(function re(){(0,v.default)(this,re),this.name=x.KHR_MESH_QUANTIZATION}),pe=function(re){(0,p.default)(_e,re);var oe=L(_e);function _e(Re,ke,Be,at){return(0,v.default)(this,_e),oe.call(this,Re,ke,Be,at)}return(0,y.default)(_e,[{key:"copySampleValue_",value:function(ke){for(var Be=this.resultBuffer,at=this.sampleValues,wt=this.valueSize,ht=0;ht!==wt;ht++)Be[ht]=at[ke*wt*3+wt+ht];return Be}}]),_e}(D.Interpolant);pe.prototype.beforeStart_=pe.prototype.copySampleValue_,pe.prototype.afterEnd_=pe.prototype.copySampleValue_,pe.prototype.interpolate_=function(re,oe,_e,Re){for(var ke=this.resultBuffer,Be=this.sampleValues,at=this.valueSize,wt=at*3,ht=Re-oe,_t=(_e-oe)/ht,St=_t*_t,Ct=St*_t,vt=re*wt,ct=vt-wt,Dt=-2*Ct+3*St,fr=Ct-St,er=0;er!==at;er++){var dr=Be[ct+er+at],zr=Be[ct+er+at*2]*ht,Ut=Be[vt+er+at],on=Be[vt+er]*ht;ke[er]=(1-Dt)*dr+(fr-St+_t)*zr+Dt*Ut+fr*on}return ke};var Ee=new D.Quaternion,Fe=function(re){(0,p.default)(_e,re);var oe=L(_e);function _e(){return(0,v.default)(this,_e),oe.apply(this,arguments)}return(0,y.default)(_e,[{key:"interpolate_",value:function(ke,Be,at,wt){var ht=(0,M.default)((0,C.default)(_e.prototype),"interpolate_",this).call(this,ke,Be,at,wt);return Ee.fromArray(ht).normalize().toArray(ht),ht}}]),_e}(pe),$e={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},pt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ue={9728:D.NearestFilter,9729:D.LinearFilter,9984:D.NearestMipmapNearestFilter,9985:D.LinearMipmapNearestFilter,9986:D.NearestMipmapLinearFilter,9987:D.LinearMipmapLinearFilter},Je={33071:D.ClampToEdgeWrapping,33648:D.MirroredRepeatWrapping,10497:D.RepeatWrapping},et={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ze={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex",_BATCHID:"_BATCHID"},Xe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},tt={CUBICSPLINE:void 0,LINEAR:D.InterpolateLinear,STEP:D.InterpolateDiscrete},ye={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ze(re){return re.DefaultMaterial===void 0&&(re.DefaultMaterial=new D.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:D.FrontSide})),re.DefaultMaterial}function Ge(re,oe,_e){for(var Re in _e.extensions)re[Re]===void 0&&(oe.userData.gltfExtensions=oe.userData.gltfExtensions||{},oe.userData.gltfExtensions[Re]=_e.extensions[Re])}function Ae(re,oe){oe.extras!==void 0&&((0,h.default)(oe.extras)==="object"?Object.assign(re.userData,oe.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+oe.extras))}function Se(re,oe,_e){for(var Re=!1,ke=!1,Be=0,at=oe.length;Be<at;Be++){var wt=oe[Be];if(wt.POSITION!==void 0&&(Re=!0),wt.NORMAL!==void 0&&(ke=!0),Re&&ke)break}if(!Re&&!ke)return Promise.resolve(re);for(var ht=[],_t=[],St=0,Ct=oe.length;St<Ct;St++){var vt=oe[St];if(Re){var ct=vt.POSITION!==void 0?_e.getDependency("accessor",vt.POSITION):re.attributes.position;ht.push(ct)}if(ke){var Dt=vt.NORMAL!==void 0?_e.getDependency("accessor",vt.NORMAL):re.attributes.normal;_t.push(Dt)}}return Promise.all([Promise.all(ht),Promise.all(_t)]).then(function(fr){var er=fr[0],dr=fr[1];return Re&&(re.morphAttributes.position=er),ke&&(re.morphAttributes.normal=dr),re.morphTargetsRelative=!0,re})}function Te(re,oe){if(re.updateMorphTargets(),oe.weights!==void 0)for(var _e=0,Re=oe.weights.length;_e<Re;_e++)re.morphTargetInfluences[_e]=oe.weights[_e];if(oe.extras&&Array.isArray(oe.extras.targetNames)){var ke=oe.extras.targetNames;if(re.morphTargetInfluences.length===ke.length){re.morphTargetDictionary={};for(var Be=0,at=ke.length;Be<at;Be++)re.morphTargetDictionary[ke[Be]]=Be}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function me(re){var oe=re.extensions&&re.extensions[x.KHR_DRACO_MESH_COMPRESSION],_e;return oe?_e="draco:"+oe.bufferView+":"+oe.indices+":"+be(oe.attributes):_e=re.indices+":"+be(re.attributes)+":"+re.mode,_e}function be(re){for(var oe="",_e=Object.keys(re).sort(),Re=0,ke=_e.length;Re<ke;Re++)oe+=_e[Re]+":"+re[_e[Re]]+";";return oe}function we(re){switch(re){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var je=function(){function re(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,v.default)(this,re),this.json=oe,this.extensions={},this.plugins={},this.options=_e,this.cache=new _,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!1?this.textureLoader=new D.ImageBitmapLoader(this.options.manager):this.textureLoader=new D.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new D.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}return(0,y.default)(re,[{key:"setExtensions",value:function(_e){this.extensions=_e}},{key:"setPlugins",value:function(_e){this.plugins=_e}},{key:"parse",value:function(_e,Re){var ke=this,Be=this.json,at=this.extensions;this.cache.removeAll(),this._invokeAll(function(wt){return wt._markDefs&&wt._markDefs()}),Promise.all(this._invokeAll(function(wt){return wt.beforeRoot&&wt.beforeRoot()})).then(function(){return Promise.all([ke.getDependencies("scene"),ke.getDependencies("animation"),ke.getDependencies("camera")])}).then(function(wt){var ht={scene:wt[0][Be.scene||0],scenes:wt[0],animations:wt[1],cameras:wt[2],asset:Be.asset,parser:ke,userData:{}};Ge(at,ht,Be),Ae(ht,Be),Promise.all(ke._invokeAll(function(_t){return _t.afterRoot&&_t.afterRoot(ht)})).then(function(){_e(ht)})}).catch(Re)}},{key:"_markDefs",value:function(){for(var _e=this.json.nodes||[],Re=this.json.skins||[],ke=this.json.meshes||[],Be=0,at=Re.length;Be<at;Be++)for(var wt=Re[Be].joints,ht=0,_t=wt.length;ht<_t;ht++)_e[wt[ht]].isBone=!0;for(var St=0,Ct=_e.length;St<Ct;St++){var vt=_e[St];vt.mesh!==void 0&&(this._addNodeRef(this.meshCache,vt.mesh),vt.skin!==void 0&&(ke[vt.mesh].isSkinnedMesh=!0)),vt.camera!==void 0&&this._addNodeRef(this.cameraCache,vt.camera)}}},{key:"_addNodeRef",value:function(_e,Re){Re!==void 0&&(_e.refs[Re]===void 0&&(_e.refs[Re]=_e.uses[Re]=0),_e.refs[Re]++)}},{key:"_getNodeRef",value:function(_e,Re,ke){var Be=this;if(_e.refs[Re]<=1)return ke;var at=ke.clone(),wt=function(ht,_t){var St=Be.associations.get(ht);St!=null&&Be.associations.set(_t,St);var Ct=B(ht.children.entries()),vt;try{for(Ct.s();!(vt=Ct.n()).done;){var ct=(0,u.default)(vt.value,2),Dt=ct[0],fr=ct[1];wt(fr,_t.children[Dt])}}catch(er){Ct.e(er)}finally{Ct.f()}};return wt(ke,at),at.name+="_instance_"+_e.uses[Re]++,at}},{key:"_invokeOne",value:function(_e){var Re=Object.values(this.plugins);Re.push(this);for(var ke=0;ke<Re.length;ke++){var Be=_e(Re[ke]);if(Be)return Be}return null}},{key:"_invokeAll",value:function(_e){var Re=Object.values(this.plugins);Re.unshift(this);for(var ke=[],Be=0;Be<Re.length;Be++){var at=_e(Re[Be]);at&&ke.push(at)}return ke}},{key:"getDependency",value:function(_e,Re){var ke=_e+":"+Re,Be=this.cache.get(ke);if(!Be){switch(_e){case"scene":Be=this.loadScene(Re);break;case"node":Be=this.loadNode(Re);break;case"mesh":Be=this._invokeOne(function(at){return at.loadMesh&&at.loadMesh(Re)});break;case"accessor":Be=this.loadAccessor(Re);break;case"bufferView":Be=this._invokeOne(function(at){return at.loadBufferView&&at.loadBufferView(Re)});break;case"buffer":Be=this.loadBuffer(Re);break;case"material":Be=this._invokeOne(function(at){return at.loadMaterial&&at.loadMaterial(Re)});break;case"texture":Be=this._invokeOne(function(at){return at.loadTexture&&at.loadTexture(Re)});break;case"skin":Be=this.loadSkin(Re);break;case"animation":Be=this.loadAnimation(Re);break;case"camera":Be=this.loadCamera(Re);break;default:throw new Error("Unknown type: "+_e)}this.cache.add(ke,Be)}return Be}},{key:"getDependencies",value:function(_e){var Re=this.cache.get(_e);if(!Re){var ke=this,Be=this.json[_e+(_e==="mesh"?"es":"s")]||[];Re=Promise.all(Be.map(function(at,wt){return ke.getDependency(_e,wt)})),this.cache.add(_e,Re)}return Re}},{key:"loadBuffer",value:function(_e){var Re=this.json.buffers[_e],ke=this.fileLoader;if(Re.type&&Re.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+Re.type+" buffer type is not supported.");if(Re.uri===void 0&&_e===0)return Promise.resolve(this.extensions[x.KHR_BINARY_GLTF].body);var Be=this.options;return new Promise(function(at,wt){ke.load(D.LoaderUtils.resolveURL(Re.uri,Be.path),at,void 0,function(){wt(new Error('THREE.GLTFLoader: Failed to load buffer "'+Re.uri+'".'))})})}},{key:"loadBufferView",value:function(_e){var Re=this.json.bufferViews[_e];return this.getDependency("buffer",Re.buffer).then(function(ke){var Be=Re.byteLength||0,at=Re.byteOffset||0;return ke.slice(at,at+Be)})}},{key:"loadAccessor",value:function(_e){var Re=this,ke=this.json,Be=this.json.accessors[_e];if(Be.bufferView===void 0&&Be.sparse===void 0)return Promise.resolve(null);var at=[];return Be.bufferView!==void 0?at.push(this.getDependency("bufferView",Be.bufferView)):at.push(null),Be.sparse!==void 0&&(at.push(this.getDependency("bufferView",Be.sparse.indices.bufferView)),at.push(this.getDependency("bufferView",Be.sparse.values.bufferView))),Promise.all(at).then(function(wt){var ht=wt[0],_t=et[Be.type],St=pt[Be.componentType],Ct=St.BYTES_PER_ELEMENT,vt=Be.byteOffset||0,ct=Be.bufferView!==void 0?ke.bufferViews[Be.bufferView].byteStride:void 0,Dt=Be.normalized===!0,fr,er;if(ct&&ct!==Ct*_t){var dr=Math.floor(vt/ct),zr="InterleavedBuffer:"+Be.bufferView+":"+Be.componentType+":"+dr+":"+Be.count,Ut=Re.cache.get(zr);Ut||(fr=new St(ht,dr*ct,Be.count*ct/Ct),Ut=new D.InterleavedBuffer(fr,ct/Ct),Re.cache.add(zr,Ut)),er=new D.InterleavedBufferAttribute(Ut,_t,vt%ct/Ct,Dt)}else ht===null?fr=new St(Be.count*_t):fr=new St(ht,vt,Be.count*_t),er=new D.BufferAttribute(fr,_t,Dt);if(Be.sparse!==void 0){var on=et.SCALAR,tn=pt[Be.sparse.indices.componentType],Ln=Be.sparse.indices.byteOffset||0,_i=Be.sparse.values.byteOffset||0,xn=new tn(wt[1],Ln,Be.sparse.count*on),ri=new St(wt[2],_i,Be.sparse.count*_t);ht!==null&&(er=new D.BufferAttribute(er.array.slice(),er.itemSize,er.normalized));for(var _n=0,ta=xn.length;_n<ta;_n++){var ji=xn[_n];if(er.setX(ji,ri[_n*_t]),_t>=2&&er.setY(ji,ri[_n*_t+1]),_t>=3&&er.setZ(ji,ri[_n*_t+2]),_t>=4&&er.setW(ji,ri[_n*_t+3]),_t>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return er})}},{key:"loadTexture",value:function(_e){var Re=this.json,ke=this.options,Be=Re.textures[_e],at=Re.images[Be.source],wt=this.textureLoader;if(at.uri){var ht=ke.manager.getHandler(at.uri);ht!==null&&(wt=ht)}return this.loadTextureImage(_e,at,wt)}},{key:"loadTextureImage",value:function(_e,Re,ke){var Be=this,at=this.json,wt=this.options,ht=at.textures[_e],_t=(Re.uri||Re.bufferView)+":"+ht.sampler;if(this.textureCache[_t])return this.textureCache[_t];var St=self.URL||self.webkitURL,Ct=Re.uri||"",vt=!1;if(Re.bufferView!==void 0)Ct=Be.getDependency("bufferView",Re.bufferView).then(function(Dt){vt=!0;var fr=new Blob([Dt],{type:Re.mimeType});return Ct=St.createObjectURL(fr),Ct});else if(Re.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_e+" is missing URI and bufferView");var ct=Promise.resolve(Ct).then(function(Dt){return new Promise(function(fr,er){var dr=fr;ke.isImageBitmapLoader===!0&&(dr=function(zr){var Ut=new D.Texture(zr);Ut.needsUpdate=!0,fr(Ut)}),ke.load(D.LoaderUtils.resolveURL(Dt,wt.path),dr,void 0,er)})}).then(function(Dt){vt===!0&&St.revokeObjectURL(Ct),Dt.flipY=!1,ht.name&&(Dt.name=ht.name);var fr=at.samplers||{},er=fr[ht.sampler]||{};return Dt.magFilter=Ue[er.magFilter]||D.LinearFilter,Dt.minFilter=Ue[er.minFilter]||D.LinearMipmapLinearFilter,Dt.wrapS=Je[er.wrapS]||D.RepeatWrapping,Dt.wrapT=Je[er.wrapT]||D.RepeatWrapping,Be.associations.set(Dt,{textures:_e}),Dt}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",Ct),null});return this.textureCache[_t]=ct,ct}},{key:"assignTexture",value:function(_e,Re,ke){var Be=this;return this.getDependency("texture",ke.index).then(function(at){if(ke.texCoord!==void 0&&ke.texCoord!=0&&!(Re==="aoMap"&&ke.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+ke.texCoord+" for texture "+Re+" not yet supported."),Be.extensions[x.KHR_TEXTURE_TRANSFORM]){var wt=ke.extensions!==void 0?ke.extensions[x.KHR_TEXTURE_TRANSFORM]:void 0;if(wt){var ht=Be.associations.get(at);at=Be.extensions[x.KHR_TEXTURE_TRANSFORM].extendTexture(at,wt),Be.associations.set(at,ht)}}return _e[Re]=at,at})}},{key:"assignFinalMaterial",value:function(_e){var Re=_e.geometry,ke=_e.material,Be=Re.attributes.tangent===void 0,at=Re.attributes.color!==void 0,wt=Re.attributes.normal===void 0;if(_e.isPoints){var ht="PointsMaterial:"+ke.uuid,_t=this.cache.get(ht);_t||(_t=new D.PointsMaterial,D.Material.prototype.copy.call(_t,ke),_t.color.copy(ke.color),_t.map=ke.map,_t.sizeAttenuation=!1,this.cache.add(ht,_t)),ke=_t}else if(_e.isLine){var St="LineBasicMaterial:"+ke.uuid,Ct=this.cache.get(St);Ct||(Ct=new D.LineBasicMaterial,D.Material.prototype.copy.call(Ct,ke),Ct.color.copy(ke.color),this.cache.add(St,Ct)),ke=Ct}if(Be||at||wt){var vt="ClonedMaterial:"+ke.uuid+":";ke.isGLTFSpecularGlossinessMaterial&&(vt+="specular-glossiness:"),Be&&(vt+="derivative-tangents:"),at&&(vt+="vertex-colors:"),wt&&(vt+="flat-shading:");var ct=this.cache.get(vt);ct||(ct=ke.clone(),at&&(ct.vertexColors=!0),wt&&(ct.flatShading=!0),Be&&(ct.normalScale&&(ct.normalScale.y*=-1),ct.clearcoatNormalScale&&(ct.clearcoatNormalScale.y*=-1)),this.cache.add(vt,ct),this.associations.set(ct,this.associations.get(ke))),ke=ct}ke.aoMap&&Re.attributes.uv2===void 0&&Re.attributes.uv!==void 0&&Re.setAttribute("uv2",Re.attributes.uv),_e.material=ke}},{key:"getMaterialType",value:function(){return D.MeshStandardMaterial}},{key:"loadMaterial",value:function(_e){var Re=this,ke=this.json,Be=this.extensions,at=ke.materials[_e],wt,ht={},_t=at.extensions||{},St=[];if(_t[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var Ct=Be[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];wt=Ct.getMaterialType(),St.push(Ct.extendParams(ht,at,Re))}else if(_t[x.KHR_MATERIALS_UNLIT]){var vt=Be[x.KHR_MATERIALS_UNLIT];wt=vt.getMaterialType(),St.push(vt.extendParams(ht,at,Re))}else{var ct=at.pbrMetallicRoughness||{};if(ht.color=new D.Color(1,1,1),ht.opacity=1,Array.isArray(ct.baseColorFactor)){var Dt=ct.baseColorFactor;ht.color.fromArray(Dt),ht.opacity=Dt[3]}ct.baseColorTexture!==void 0&&St.push(Re.assignTexture(ht,"map",ct.baseColorTexture)),ht.metalness=ct.metallicFactor!==void 0?ct.metallicFactor:1,ht.roughness=ct.roughnessFactor!==void 0?ct.roughnessFactor:1,ct.metallicRoughnessTexture!==void 0&&(St.push(Re.assignTexture(ht,"metalnessMap",ct.metallicRoughnessTexture)),St.push(Re.assignTexture(ht,"roughnessMap",ct.metallicRoughnessTexture))),wt=this._invokeOne(function(dr){return dr.getMaterialType&&dr.getMaterialType(_e)}),St.push(Promise.all(this._invokeAll(function(dr){return dr.extendMaterialParams&&dr.extendMaterialParams(_e,ht)})))}at.doubleSided===!0&&(ht.side=D.DoubleSide);var fr=at.alphaMode||ye.OPAQUE;if(fr===ye.BLEND?(ht.transparent=!0,ht.depthWrite=!1):(ht.transparent=!1,fr===ye.MASK&&(ht.alphaTest=at.alphaCutoff!==void 0?at.alphaCutoff:.5)),at.normalTexture!==void 0&&wt!==D.MeshBasicMaterial&&(St.push(Re.assignTexture(ht,"normalMap",at.normalTexture)),ht.normalScale=new D.Vector2(1,1),at.normalTexture.scale!==void 0)){var er=at.normalTexture.scale;ht.normalScale.set(er,er)}return at.occlusionTexture!==void 0&&wt!==D.MeshBasicMaterial&&(St.push(Re.assignTexture(ht,"aoMap",at.occlusionTexture)),at.occlusionTexture.strength!==void 0&&(ht.aoMapIntensity=at.occlusionTexture.strength)),at.emissiveFactor!==void 0&&wt!==D.MeshBasicMaterial&&(ht.emissive=new D.Color().fromArray(at.emissiveFactor)),at.emissiveTexture!==void 0&&wt!==D.MeshBasicMaterial&&St.push(Re.assignTexture(ht,"emissiveMap",at.emissiveTexture)),Promise.all(St).then(function(){var dr;return wt===se?dr=Be[x.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(ht):dr=new wt(ht),at.name&&(dr.name=at.name),dr.map&&(dr.map.encoding=D.sRGBEncoding),dr.emissiveMap&&(dr.emissiveMap.encoding=D.sRGBEncoding),Ae(dr,at),Re.associations.set(dr,{materials:_e}),at.extensions&&Ge(Be,dr,at),dr})}},{key:"createUniqueName",value:function(_e){for(var Re=D.PropertyBinding.sanitizeNodeName(_e||""),ke=Re,Be=1;this.nodeNamesUsed[ke];++Be)ke=Re+"_"+Be;return this.nodeNamesUsed[ke]=!0,ke}},{key:"loadGeometries",value:function(_e){var Re=this,ke=this.extensions,Be=this.primitiveCache;function at(Dt){return ke[x.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Dt,Re).then(function(fr){return bt(fr,Dt,Re)})}for(var wt=[],ht=0,_t=_e.length;ht<_t;ht++){var St=_e[ht],Ct=me(St),vt=Be[Ct];if(vt)wt.push(vt.promise);else{var ct=void 0;St.extensions&&St.extensions[x.KHR_DRACO_MESH_COMPRESSION]?ct=at(St):ct=bt(new D.BufferGeometry,St,Re),Be[Ct]={primitive:St,promise:ct},wt.push(ct)}}return Promise.all(wt)}},{key:"loadMesh",value:function(_e){for(var Re=this,ke=this.json,Be=this.extensions,at=ke.meshes[_e],wt=at.primitives,ht=[],_t=0,St=wt.length;_t<St;_t++){var Ct=wt[_t].material===void 0?Ze(this.cache):this.getDependency("material",wt[_t].material);ht.push(Ct)}return ht.push(Re.loadGeometries(wt)),Promise.all(ht).then(function(vt){for(var ct=vt.slice(0,vt.length-1),Dt=vt[vt.length-1],fr=[],er=0,dr=Dt.length;er<dr;er++){var zr=Dt[er],Ut=wt[er],on=void 0,tn=ct[er];if(Ut.mode===$e.TRIANGLES||Ut.mode===$e.TRIANGLE_STRIP||Ut.mode===$e.TRIANGLE_FAN||Ut.mode===void 0)on=at.isSkinnedMesh===!0?new D.SkinnedMesh(zr,tn):new D.Mesh(zr,tn),on.isSkinnedMesh===!0&&!on.geometry.attributes.skinWeight.normalized&&on.normalizeSkinWeights(),Ut.mode===$e.TRIANGLE_STRIP?on.geometry=Ie(on.geometry,D.TriangleStripDrawMode):Ut.mode===$e.TRIANGLE_FAN&&(on.geometry=Ie(on.geometry,D.TriangleFanDrawMode));else if(Ut.mode===$e.LINES)on=new D.LineSegments(zr,tn);else if(Ut.mode===$e.LINE_STRIP)on=new D.Line(zr,tn);else if(Ut.mode===$e.LINE_LOOP)on=new D.LineLoop(zr,tn);else if(Ut.mode===$e.POINTS)on=new D.Points(zr,tn);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Ut.mode);Object.keys(on.geometry.morphAttributes).length>0&&Te(on,at),on.name=Re.createUniqueName(at.name||"mesh_"+_e),Ae(on,at),Ut.extensions&&Ge(Be,on,Ut),Re.assignFinalMaterial(on),fr.push(on)}for(var Ln=0,_i=fr.length;Ln<_i;Ln++)Re.associations.set(fr[Ln],{meshes:_e,primitives:Ln});if(fr.length===1)return fr[0];var xn=new D.Group;Re.associations.set(xn,{meshes:_e});for(var ri=0,_n=fr.length;ri<_n;ri++)xn.add(fr[ri]);return xn})}},{key:"loadCamera",value:function(_e){var Re,ke=this.json.cameras[_e],Be=ke[ke.type];if(!Be){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return ke.type==="perspective"?Re=new D.PerspectiveCamera(D.MathUtils.radToDeg(Be.yfov),Be.aspectRatio||1,Be.znear||1,Be.zfar||2e6):ke.type==="orthographic"&&(Re=new D.OrthographicCamera(-Be.xmag,Be.xmag,Be.ymag,-Be.ymag,Be.znear,Be.zfar)),ke.name&&(Re.name=this.createUniqueName(ke.name)),Ae(Re,ke),Promise.resolve(Re)}},{key:"loadSkin",value:function(_e){var Re=this.json.skins[_e],ke={joints:Re.joints};return Re.inverseBindMatrices===void 0?Promise.resolve(ke):this.getDependency("accessor",Re.inverseBindMatrices).then(function(Be){return ke.inverseBindMatrices=Be,ke})}},{key:"loadAnimation",value:function(_e){for(var Re=this.json,ke=Re.animations[_e],Be=[],at=[],wt=[],ht=[],_t=[],St=0,Ct=ke.channels.length;St<Ct;St++){var vt=ke.channels[St],ct=ke.samplers[vt.sampler],Dt=vt.target,fr=Dt.node!==void 0?Dt.node:Dt.id,er=ke.parameters!==void 0?ke.parameters[ct.input]:ct.input,dr=ke.parameters!==void 0?ke.parameters[ct.output]:ct.output;Be.push(this.getDependency("node",fr)),at.push(this.getDependency("accessor",er)),wt.push(this.getDependency("accessor",dr)),ht.push(ct),_t.push(Dt)}return Promise.all([Promise.all(Be),Promise.all(at),Promise.all(wt),Promise.all(ht),Promise.all(_t)]).then(function(zr){for(var Ut=zr[0],on=zr[1],tn=zr[2],Ln=zr[3],_i=zr[4],xn=[],ri=function(Ii){var Ha=Ut[Ii],to=on[Ii],Ou=tn[Ii],ms=Ln[Ii],Us=_i[Ii];if(Ha===void 0)return"continue";Ha.updateMatrix(),Ha.matrixAutoUpdate=!0;var Ka=void 0;switch(Xe[Us.path]){case Xe.weights:Ka=D.NumberKeyframeTrack;break;case Xe.rotation:Ka=D.QuaternionKeyframeTrack;break;case Xe.position:case Xe.scale:default:Ka=D.VectorKeyframeTrack;break}var Fu=Ha.name?Ha.name:Ha.uuid,vs=ms.interpolation!==void 0?tt[ms.interpolation]:D.InterpolateLinear,gs=[];Xe[Us.path]===Xe.weights?Ha.traverse(function(Hi){Hi.morphTargetInfluences&&gs.push(Hi.name?Hi.name:Hi.uuid)}):gs.push(Fu);var la=Ou.array;if(Ou.normalized){for(var ou=we(la.constructor),ml=new Float32Array(la.length),qa=0,wr=la.length;qa<wr;qa++)ml[qa]=la[qa]*ou;la=ml}for(var bn=0,Rn=gs.length;bn<Rn;bn++){var Xa=new Ka(gs[bn]+"."+Xe[Us.path],to.array,la,vs);ms.interpolation==="CUBICSPLINE"&&(Xa.createInterpolant=function(Hi){var Tn=this instanceof D.QuaternionKeyframeTrack?Fe:pe;return new Tn(this.times,this.values,this.getValueSize()/3,Hi)},Xa.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),xn.push(Xa)}},_n=0,ta=Ut.length;_n<ta;_n++)var ji=ri(_n);var ss=ke.name?ke.name:"animation_"+_e;return new D.AnimationClip(ss,void 0,xn)})}},{key:"createNodeMesh",value:function(_e){var Re=this.json,ke=this,Be=Re.nodes[_e];return Be.mesh===void 0?null:ke.getDependency("mesh",Be.mesh).then(function(at){var wt=ke._getNodeRef(ke.meshCache,Be.mesh,at);return Be.weights!==void 0&&wt.traverse(function(ht){if(!!ht.isMesh)for(var _t=0,St=Be.weights.length;_t<St;_t++)ht.morphTargetInfluences[_t]=Be.weights[_t]}),wt})}},{key:"loadNode",value:function(_e){var Re=this.json,ke=this.extensions,Be=this,at=Re.nodes[_e],wt=at.name?Be.createUniqueName(at.name):"";return function(){var ht=[],_t=Be._invokeOne(function(St){return St.createNodeMesh&&St.createNodeMesh(_e)});return _t&&ht.push(_t),at.camera!==void 0&&ht.push(Be.getDependency("camera",at.camera).then(function(St){return Be._getNodeRef(Be.cameraCache,at.camera,St)})),Be._invokeAll(function(St){return St.createNodeAttachment&&St.createNodeAttachment(_e)}).forEach(function(St){ht.push(St)}),Promise.all(ht)}().then(function(ht){var _t;if(at.isBone===!0?_t=new D.Bone:ht.length>1?_t=new D.Group:ht.length===1?_t=ht[0]:_t=new D.Object3D,_t!==ht[0])for(var St=0,Ct=ht.length;St<Ct;St++)_t.add(ht[St]);if(at.name&&(_t.userData.name=at.name,_t.name=wt),Ae(_t,at),at.extensions&&Ge(ke,_t,at),at.matrix!==void 0){var vt=new D.Matrix4;vt.fromArray(at.matrix),_t.applyMatrix4(vt)}else at.translation!==void 0&&_t.position.fromArray(at.translation),at.rotation!==void 0&&_t.quaternion.fromArray(at.rotation),at.scale!==void 0&&_t.scale.fromArray(at.scale);return Be.associations.has(_t)||Be.associations.set(_t,{}),Be.associations.get(_t).nodes=_e,_t})}},{key:"loadScene",value:function(_e){var Re=this.json,ke=this.extensions,Be=this.json.scenes[_e],at=this,wt=new D.Group;Be.name&&(wt.name=at.createUniqueName(Be.name)),Ae(wt,Be),Be.extensions&&Ge(ke,wt,Be);for(var ht=Be.nodes||[],_t=[],St=0,Ct=ht.length;St<Ct;St++)_t.push(lt(ht[St],wt,Re,at));return Promise.all(_t).then(function(){return at.associations=function(ct){var Dt=new Map,fr=B(at.associations),er;try{for(fr.s();!(er=fr.n()).done;){var dr=(0,u.default)(er.value,2),zr=dr[0],Ut=dr[1];(zr instanceof D.Material||zr instanceof D.Texture)&&Dt.set(zr,Ut)}}catch(on){fr.e(on)}finally{fr.f()}return ct.traverse(function(on){var tn=at.associations.get(on);tn!=null&&Dt.set(on,tn)}),Dt}(wt),wt})}}]),re}();function lt(re,oe,_e,Re){var ke=_e.nodes[re];return Re.getDependency("node",re).then(function(Be){if(ke.skin===void 0)return Be;var at;return Re.getDependency("skin",ke.skin).then(function(wt){at=wt;for(var ht=[],_t=0,St=at.joints.length;_t<St;_t++)ht.push(Re.getDependency("node",at.joints[_t]));return Promise.all(ht)}).then(function(wt){return Be.traverse(function(ht){if(!!ht.isMesh){for(var _t=[],St=[],Ct=0,vt=wt.length;Ct<vt;Ct++){var ct=wt[Ct];if(ct){_t.push(ct);var Dt=new D.Matrix4;at.inverseBindMatrices!==void 0&&Dt.fromArray(at.inverseBindMatrices.array,Ct*16),St.push(Dt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',at.joints[Ct])}ht.bind(new D.Skeleton(_t,St),ht.matrixWorld)}}),Be})}).then(function(Be){oe.add(Be);var at=[];if(ke.children)for(var wt=ke.children,ht=0,_t=wt.length;ht<_t;ht++){var St=wt[ht];at.push(lt(St,Be,_e,Re))}return Promise.all(at)})}function ot(re,oe,_e){var Re=oe.attributes,ke=new D.Box3;if(Re.POSITION!==void 0){var Be=_e.json.accessors[Re.POSITION],at=Be.min,wt=Be.max;if(at!==void 0&&wt!==void 0){if(ke.set(new D.Vector3(at[0],at[1],at[2]),new D.Vector3(wt[0],wt[1],wt[2])),Be.normalized){var ht=we(pt[Be.componentType]);ke.min.multiplyScalar(ht),ke.max.multiplyScalar(ht)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var _t=oe.targets;if(_t!==void 0){for(var St=new D.Vector3,Ct=new D.Vector3,vt=0,ct=_t.length;vt<ct;vt++){var Dt=_t[vt];if(Dt.POSITION!==void 0){var fr=_e.json.accessors[Dt.POSITION],er=fr.min,dr=fr.max;if(er!==void 0&&dr!==void 0){if(Ct.setX(Math.max(Math.abs(er[0]),Math.abs(dr[0]))),Ct.setY(Math.max(Math.abs(er[1]),Math.abs(dr[1]))),Ct.setZ(Math.max(Math.abs(er[2]),Math.abs(dr[2]))),fr.normalized){var zr=we(pt[fr.componentType]);Ct.multiplyScalar(zr)}St.max(Ct)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}ke.expandByVector(St)}re.boundingBox=ke;var Ut=new D.Sphere;ke.getCenter(Ut.center),Ut.radius=ke.min.distanceTo(ke.max)/2,re.boundingSphere=Ut}function bt(re,oe,_e){var Re=oe.attributes,ke=[];function Be(_t,St){return _e.getDependency("accessor",_t).then(function(Ct){re.setAttribute(St,Ct)})}for(var at in Re){var wt=ze[at]||at.toLowerCase();wt in re.attributes||ke.push(Be(Re[at],wt))}if(oe.indices!==void 0&&!re.index){var ht=_e.getDependency("accessor",oe.indices).then(function(_t){re.setIndex(_t)});ke.push(ht)}return Ae(re,oe),ot(re,oe,_e),Promise.all(ke).then(function(){return oe.targets!==void 0?Se(re,oe.targets,_e):re})}function Ie(re,oe){var _e=re.getIndex();if(_e===null){var Re=[],ke=re.getAttribute("position");if(ke!==void 0){for(var Be=0;Be<ke.count;Be++)Re.push(Be);re.setIndex(Re),_e=re.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),re}var at=_e.count-2,wt=[];if(oe===D.TriangleFanDrawMode)for(var ht=1;ht<=at;ht++)wt.push(_e.getX(0)),wt.push(_e.getX(ht)),wt.push(_e.getX(ht+1));else for(var _t=0;_t<at;_t++)_t%2===0?(wt.push(_e.getX(_t)),wt.push(_e.getX(_t+1)),wt.push(_e.getX(_t+2))):(wt.push(_e.getX(_t+2)),wt.push(_e.getX(_t+1)),wt.push(_e.getX(_t)));wt.length/3!==at&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var St=re.clone();return St.setIndex(wt),St}return Gm}var Vm={},_T;function YF(){if(_T)return Vm;_T=1;var a=hr.exports;Object.defineProperty(Vm,"__esModule",{value:!0}),Vm.DRACOLoader=void 0;var u=a(Lr.exports),h=a(Ir()),R=a(kr()),M=a(dn()),v=a(pn()),y=a(ln()),p=Dr();function g(P){var L=C();return function(){var E=(0,y.default)(P),b;if(L){var _=(0,y.default)(this).constructor;b=Reflect.construct(E,arguments,_)}else b=E.apply(this,arguments);return(0,v.default)(this,b)}}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var D=new WeakMap,B=function(P){(0,M.default)(E,P);var L=g(E);function E(b){var _;return(0,h.default)(this,E),_=L.call(this,b),_.decoderPath="",_.decoderConfig={},_.decoderBinary=null,_.decoderPending=null,_.workerLimit=4,_.workerPool=[],_.workerNextTaskID=1,_.workerSourceURL="",_.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},_.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},_}return(0,R.default)(E,[{key:"setDecoderPath",value:function(_){return this.decoderPath=_,this}},{key:"setDecoderConfig",value:function(_){return this.decoderConfig=_,this}},{key:"setWorkerLimit",value:function(_){return this.workerLimit=_,this}},{key:"load",value:function(_,x,T,N){var U=this,H=new p.FileLoader(this.manager);H.setPath(this.path),H.setResponseType("arraybuffer"),H.setRequestHeader(this.requestHeader),H.setWithCredentials(this.withCredentials),H.load(_,function(q){var te={attributeIDs:U.defaultAttributeIDs,attributeTypes:U.defaultAttributeTypes,useUniqueIDs:!1};U.decodeGeometry(q,te).then(x).catch(N)},T,N)}},{key:"decodeDracoFile",value:function(_,x,T,N){var U={attributeIDs:T||this.defaultAttributeIDs,attributeTypes:N||this.defaultAttributeTypes,useUniqueIDs:!!T};this.decodeGeometry(_,U).then(x)}},{key:"decodeGeometry",value:function(_,x){var T=this;for(var N in x.attributeTypes){var U=x.attributeTypes[N];U.BYTES_PER_ELEMENT!==void 0&&(x.attributeTypes[N]=U.name)}var H=JSON.stringify(x);if(D.has(_)){var q=D.get(_);if(q.key===H)return q.promise;if(_.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var te,Q=this.workerNextTaskID++,Z=_.byteLength,ae=this._getWorker(Q,Z).then(function(F){return te=F,new Promise(function(W,O){te._callbacks[Q]={resolve:W,reject:O},te.postMessage({type:"decode",id:Q,taskConfig:x,buffer:_},[_])})}).then(function(F){return T._createGeometry(F.geometry)});return ae.catch(function(){return!0}).then(function(){te&&Q&&T._releaseTask(te,Q)}),D.set(_,{key:H,promise:ae}),ae}},{key:"_createGeometry",value:function(_){var x=new p.BufferGeometry;_.index&&x.setIndex(new p.BufferAttribute(_.index.array,1));for(var T=0;T<_.attributes.length;T++){var N=_.attributes[T],U=N.name,H=N.array,q=N.itemSize;x.setAttribute(U,new p.BufferAttribute(H,q))}return x}},{key:"_loadLibrary",value:function(_,x){var T=new p.FileLoader(this.manager);return T.setPath(this.decoderPath),T.setResponseType(x),T.setWithCredentials(this.withCredentials),new Promise(function(N,U){T.load(_,N,void 0,U)})}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var _=this;if(this.decoderPending)return this.decoderPending;var x=(typeof WebAssembly>"u"?"undefined":(0,u.default)(WebAssembly))!=="object"||this.decoderConfig.type==="js",T=[];return x?T.push(this._loadLibrary("draco_decoder.js","text")):(T.push(this._loadLibrary("draco_wasm_wrapper.js","text")),T.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(T).then(function(N){var U=N[0];x||(_.decoderConfig.wasmBinary=N[1]);var H=V.toString(),q=["/* draco decoder */",U,"","/* worker */",H.substring(H.indexOf("{")+1,H.lastIndexOf("}"))].join(`
`);_.workerSourceURL=URL.createObjectURL(new Blob([q]))}),this.decoderPending}},{key:"_getWorker",value:function(_,x){var T=this;return this._initDecoder().then(function(){if(T.workerPool.length<T.workerLimit){var N=new Worker(T.workerSourceURL);N._callbacks={},N._taskCosts={},N._taskLoad=0,N.postMessage({type:"init",decoderConfig:T.decoderConfig}),N.onmessage=function(H){var q=H.data;switch(q.type){case"decode":N._callbacks[q.id].resolve(q);break;case"error":N._callbacks[q.id].reject(q);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+q.type+'"')}},T.workerPool.push(N)}else T.workerPool.sort(function(H,q){return H._taskLoad>q._taskLoad?-1:1});var U=T.workerPool[T.workerPool.length-1];return U._taskCosts[_]=x,U._taskLoad+=x,U})}},{key:"_releaseTask",value:function(_,x){_._taskLoad-=_._taskCosts[x],delete _._callbacks[x],delete _._taskCosts[x]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map(function(_){return _._taskLoad}))}},{key:"dispose",value:function(){for(var _=0;_<this.workerPool.length;++_)this.workerPool[_].terminate();return this.workerPool.length=0,this}}]),E}(p.Loader);Vm.DRACOLoader=B;function V(){var P,L;onmessage=function(N){var U=N.data;switch(U.type){case"init":P=U.decoderConfig,L=new Promise(function(te){P.onModuleLoaded=function(Q){te({draco:Q})},DracoDecoderModule(P)});break;case"decode":var H=U.buffer,q=U.taskConfig;L.then(function(te){var Q=te.draco,Z=new Q.Decoder,ae=new Q.DecoderBuffer;ae.Init(new Int8Array(H),H.byteLength);try{var F=E(Q,Z,ae,q),W=F.attributes.map(function(O){return O.array.buffer});F.index&&W.push(F.index.array.buffer),self.postMessage({type:"decode",id:U.id,geometry:F},W)}catch(O){console.error(O),self.postMessage({type:"error",id:U.id,error:O.message})}finally{Q.destroy(ae),Q.destroy(Z)}});break}};function E(T,N,U,H){var q=H.attributeIDs,te=H.attributeTypes,Q,Z,ae=N.GetEncodedGeometryType(U);if(ae===T.TRIANGULAR_MESH)Q=new T.Mesh,Z=N.DecodeBufferToMesh(U,Q);else if(ae===T.POINT_CLOUD)Q=new T.PointCloud,Z=N.DecodeBufferToPointCloud(U,Q);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!Z.ok()||Q.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+Z.error_msg());var F={index:null,attributes:[]};for(var W in q){var O=self[te[W]],X=void 0,G=void 0;if(H.useUniqueIDs)G=q[W],X=N.GetAttributeByUniqueId(Q,G);else{if(G=N.GetAttributeId(Q,T[q[W]]),G===-1)continue;X=N.GetAttribute(Q,G)}F.attributes.push(_(T,N,Q,W,O,X))}return ae===T.TRIANGULAR_MESH&&(F.index=b(T,N,Q)),T.destroy(Q),F}function b(T,N,U){var H=U.num_faces(),q=H*3,te=q*4,Q=T._malloc(te);N.GetTrianglesUInt32Array(U,te,Q);var Z=new Uint32Array(T.HEAPF32.buffer,Q,q).slice();return T._free(Q),{array:Z,itemSize:1}}function _(T,N,U,H,q,te){var Q=te.num_components(),Z=U.num_points(),ae=Z*Q,F=ae*q.BYTES_PER_ELEMENT,W=x(T,q),O=T._malloc(F);N.GetAttributeDataArrayForAllPoints(U,te,W,F,O);var X=new q(T.HEAPF32.buffer,O,ae).slice();return T._free(O),{name:H,array:X,itemSize:Q}}function x(T,N){switch(N){case Float32Array:return T.DT_FLOAT32;case Int8Array:return T.DT_INT8;case Int16Array:return T.DT_INT16;case Int32Array:return T.DT_INT32;case Uint8Array:return T.DT_UINT8;case Uint16Array:return T.DT_UINT16;case Uint32Array:return T.DT_UINT32}}}return Vm}var HA={},xT;function JF(){return xT||(xT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=D(Dr());function C(E){if(typeof WeakMap!="function")return null;var b=new WeakMap,_=new WeakMap;return(C=function(T){return T?_:b})(E)}function D(E,b){if(!b&&E&&E.__esModule)return E;if(E===null||h(E)!=="object"&&typeof E!="function")return{default:E};var _=C(b);if(_&&_.has(E))return _.get(E);var x={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in E)if(N!=="default"&&Object.prototype.hasOwnProperty.call(E,N)){var U=T?Object.getOwnPropertyDescriptor(E,N):null;U&&(U.get||U.set)?Object.defineProperty(x,N,U):x[N]=E[N]}return x.default=E,_&&_.set(E,x),x}function B(E){var b=V();return function(){var _=(0,p.default)(E),x;if(b){var T=(0,p.default)(this).constructor;x=Reflect.construct(_,arguments,T)}else x=_.apply(this,arguments);return(0,y.default)(this,x)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P={};P.LegacyGLTFLoader=function(){var E=function(Ue){(0,v.default)(et,Ue);var Je=B(et);function et(ze){return(0,R.default)(this,et),Je.call(this,ze)}return(0,M.default)(et,[{key:"load",value:function(Xe,tt,ye,Ze){var Ge=this,Ae;this.resourcePath!==""?Ae=this.resourcePath:this.path!==""?Ae=this.path:Ae=g.LoaderUtils.extractUrlBase(Xe);var Se=new g.FileLoader(Ge.manager);Se.setPath(this.path),Se.setResponseType("arraybuffer"),Se.load(Xe,function(Te){Ge.parse(Te,Ae,tt)},ye,Ze)}},{key:"parse",value:function(Xe,tt,ye){var Ze,Ge={},Ae=g.LoaderUtils.decodeText(new Uint8Array(Xe,0,4));Ae===N.magic?(Ge[x.KHR_BINARY_GLTF]=new H(Xe),Ze=Ge[x.KHR_BINARY_GLTF].content):Ze=g.LoaderUtils.decodeText(new Uint8Array(Xe));var Se=JSON.parse(Ze);Se.extensionsUsed&&Se.extensionsUsed.indexOf(x.KHR_MATERIALS_COMMON)>=0&&(Ge[x.KHR_MATERIALS_COMMON]=new T(Se));var Te=new pt(Se,Ge,{crossOrigin:this.crossOrigin,manager:this.manager,path:tt||this.resourcePath||""});Te.parse(function(me,be,we,je){ye({scene:me,scenes:be,cameras:we,animations:je})})}}]),et}(g.Loader);function b(){var Ue={};return{get:function(et){return Ue[et]},add:function(et,ze){Ue[et]=ze},remove:function(et){delete Ue[et]},removeAll:function(){Ue={}},update:function(et,ze){for(var Xe in Ue){var tt=Ue[Xe];tt.update&&tt.update(et,ze)}}}}E.Shaders={update:function(){console.warn("threeExamples.LegacyGLTFLoader.Shaders has been deprecated, and now updates automatically.")}};function _(Ue,Je){var et={},ze=Ue.material.uniforms;for(var Xe in ze){var tt=ze[Xe];if(tt.semantic){var ye=tt.node,Ze=Ue;ye&&(Ze=Je[ye]),et[Xe]={semantic:tt.semantic,sourceNode:Ze,targetNode:Ue,uniform:tt}}}this.boundUniforms=et,this._m4=new g.Matrix4}_.prototype.update=function(Ue,Je){var et=this.boundUniforms;for(var ze in et){var Xe=et[ze];switch(Xe.semantic){case"MODELVIEW":var ye=Xe.uniform.value;ye.multiplyMatrices(Je.matrixWorldInverse,Xe.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var tt=Xe.uniform.value;this._m4.multiplyMatrices(Je.matrixWorldInverse,Xe.sourceNode.matrixWorld),tt.getNormalMatrix(this._m4);break;case"PROJECTION":var ye=Xe.uniform.value;ye.copy(Je.projectionMatrix);break;case"JOINTMATRIX":for(var Ze=Xe.uniform.value,Ge=0;Ge<Ze.length;Ge++)Ze[Ge].getInverse(Xe.sourceNode.matrixWorld).multiply(Xe.targetNode.skeleton.bones[Ge].matrixWorld).multiply(Xe.targetNode.skeleton.boneInverses[Ge]).multiply(Xe.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+Xe.semantic);break}}},E.Animations={update:function(){console.warn("threeExamples.LegacyGLTFLoader.Animation has been deprecated. Use THREE.AnimationMixer instead.")}};var x={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_MATERIALS_COMMON:"KHR_materials_common"};function T(Ue){this.name=x.KHR_MATERIALS_COMMON,this.lights={};var Je=Ue.extensions&&Ue.extensions[x.KHR_MATERIALS_COMMON]||{},et=Je.lights||{};for(var ze in et){var Xe=et[ze],tt,ye=Xe[Xe.type],Ze=new g.Color().fromArray(ye.color);switch(Xe.type){case"directional":tt=new g.DirectionalLight(Ze),tt.position.set(0,0,1);break;case"point":tt=new g.PointLight(Ze);break;case"spot":tt=new g.SpotLight(Ze),tt.position.set(0,0,1);break;case"ambient":tt=new g.AmbientLight(Ze);break}tt&&(this.lights[ze]=tt)}}var N={magic:"glTF",version:1,contentFormat:0},U=20;function H(Ue){this.name=x.KHR_BINARY_GLTF;var Je=new DataView(Ue,0,U),et={magic:g.LoaderUtils.decodeText(new Uint8Array(Ue.slice(0,4))),version:Je.getUint32(4,!0),length:Je.getUint32(8,!0),contentLength:Je.getUint32(12,!0),contentFormat:Je.getUint32(16,!0)};for(var ze in N){var Xe=N[ze];if(et[ze]!==Xe)throw new Error('Unsupported glTF-Binary header: Expected "%s" to be "%s".',ze,Xe)}var tt=new Uint8Array(Ue,U,et.contentLength);this.header=et,this.content=g.LoaderUtils.decodeText(tt),this.body=Ue.slice(U+et.contentLength,et.length)}H.prototype.loadShader=function(Ue,Je){var et=Je[Ue.extensions[x.KHR_BINARY_GLTF].bufferView],ze=new Uint8Array(et);return g.LoaderUtils.decodeText(ze)};var q={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},te={5126:Number,35675:g.Matrix3,35676:g.Matrix4,35664:g.Vector2,35665:g.Vector3,35666:g.Vector4,35678:g.Texture},Q={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Z={9728:g.NearestFilter,9729:g.LinearFilter,9984:g.NearestMipmapNearestFilter,9985:g.LinearMipmapNearestFilter,9986:g.NearestMipmapLinearFilter,9987:g.LinearMipmapLinearFilter},ae={33071:g.ClampToEdgeWrapping,33648:g.MirroredRepeatWrapping,10497:g.RepeatWrapping},F={6406:g.AlphaFormat,6407:g.RGBFormat,6408:g.RGBAFormat,6409:g.LuminanceFormat,6410:g.LuminanceAlphaFormat},W={5121:g.UnsignedByteType,32819:g.UnsignedShort4444Type,32820:g.UnsignedShort5551Type,33635:g.UnsignedShort5551Type},O={1028:g.BackSide,1029:g.FrontSide},X={512:g.NeverDepth,513:g.LessDepth,514:g.EqualDepth,515:g.LessEqualDepth,516:g.GreaterEqualDepth,517:g.NotEqualDepth,518:g.GreaterEqualDepth,519:g.AlwaysDepth},G={32774:g.AddEquation,32778:g.SubtractEquation,32779:g.ReverseSubtractEquation},j={0:g.ZeroFactor,1:g.OneFactor,768:g.SrcColorFactor,769:g.OneMinusSrcColorFactor,770:g.SrcAlphaFactor,771:g.OneMinusSrcAlphaFactor,772:g.DstAlphaFactor,773:g.OneMinusDstAlphaFactor,774:g.DstColorFactor,775:g.OneMinusDstColorFactor,776:g.SrcAlphaSaturateFactor},K={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ce={scale:"scale",translation:"position",rotation:"quaternion"},se={LINEAR:g.InterpolateLinear,STEP:g.InterpolateDiscrete},ue={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"};function Y(Ue,Je,et){if(!Ue)return Promise.resolve();var ze,Xe=[];if(Object.prototype.toString.call(Ue)==="[object Array]"){ze=[];for(var tt=Ue.length,ye=0;ye<tt;ye++){var Ze=Je.call(et||this,Ue[ye],ye);Ze&&(Xe.push(Ze),Ze instanceof Promise?Ze.then(function(Ae,Se){ze[Ae]=Se}.bind(this,ye)):ze[ye]=Ze)}}else{ze={};for(var Ge in Ue)if(Ue.hasOwnProperty(Ge)){var Ze=Je.call(et||this,Ue[Ge],Ge);Ze&&(Xe.push(Ze),Ze instanceof Promise?Ze.then(function(Se,Te){ze[Se]=Te}.bind(this,Ge)):ze[Ge]=Ze)}}return Promise.all(Xe).then(function(){return ze})}function pe(Ue,Je){return typeof Ue!="string"||Ue===""?"":/^(https?:)?\/\//i.test(Ue)||/^data:.*,.*$/i.test(Ue)||/^blob:.*$/i.test(Ue)?Ue:(Je||"")+Ue}function Ee(Ue,Je){var et={};for(var ze in Je.attributes){var Xe=Je.attributes[ze],tt=Je.parameters[Xe],ye=tt.type,Ze=tt.semantic;et[ze]={type:ye,semantic:Ze}}var Ge=Je.parameters,Ae=Je.attributes,Se={};for(var ze in et){var Xe=Ae[ze],Te=Ge[Xe],Ze=Te.semantic;Ze&&(Se[ze]=Te)}for(var Xe in Se){var tt=Se[Xe],Ze=tt.semantic,me=new RegExp("\\b"+Xe+"\\b","g");switch(Ze){case"POSITION":Ue=Ue.replace(me,"position");break;case"NORMAL":Ue=Ue.replace(me,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":Ue=Ue.replace(me,"uv");break;case"TEXCOORD_1":Ue=Ue.replace(me,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":Ue=Ue.replace(me,"color");break;case"WEIGHT":Ue=Ue.replace(me,"skinWeight");break;case"JOINT":Ue=Ue.replace(me,"skinIndex");break}}return Ue}function Fe(){return new g.MeshPhongMaterial({color:0,emissive:8947848,specular:0,shininess:0,transparent:!1,depthTest:!0,side:g.FrontSide})}function $e(Ue){this.isDeferredShaderMaterial=!0,this.params=Ue}$e.prototype.create=function(){var Ue=g.UniformsUtils.clone(this.params.uniforms);for(var Je in this.params.uniforms){var et=this.params.uniforms[Je];et.value instanceof g.Texture&&(Ue[Je].value=et.value,Ue[Je].value.needsUpdate=!0),Ue[Je].semantic=et.semantic,Ue[Je].node=et.node}return this.params.uniforms=Ue,new g.RawShaderMaterial(this.params)};function pt(Ue,Je,et){this.json=Ue||{},this.extensions=Je||{},this.options=et||{},this.cache=new b}return pt.prototype._withDependencies=function(Ue){for(var Je={},et=0;et<Ue.length;et++){var ze=Ue[et],Xe="load"+ze.charAt(0).toUpperCase()+ze.slice(1),tt=this.cache.get(ze);if(tt!==void 0)Je[ze]=tt;else if(this[Xe]){var ye=this[Xe]();this.cache.add(ze,ye),Je[ze]=ye}}return Y(Je,function(Ze){return Ze})},pt.prototype.parse=function(Ue){var Je=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(et){var ze=[];for(var Xe in et.scenes)ze.push(et.scenes[Xe]);var tt=Je.scene!==void 0?et.scenes[Je.scene]:ze[0],ye=[];for(var Xe in et.cameras){var Ze=et.cameras[Xe];ye.push(Ze)}var Ge=[];for(var Xe in et.animations)Ge.push(et.animations[Xe]);Ue(tt,ze,ye,Ge)})},pt.prototype.loadShaders=function(){var Ue=this.json,Je=this.extensions,et=this.options;return this._withDependencies(["bufferViews"]).then(function(ze){return Y(Ue.shaders,function(Xe){return Xe.extensions&&Xe.extensions[x.KHR_BINARY_GLTF]?Je[x.KHR_BINARY_GLTF].loadShader(Xe,ze.bufferViews):new Promise(function(tt){var ye=new g.FileLoader(et.manager);ye.setResponseType("text"),ye.load(pe(Xe.uri,et.path),function(Ze){tt(Ze)})})})})},pt.prototype.loadBuffers=function(){var Ue=this.json,Je=this.extensions,et=this.options;return Y(Ue.buffers,function(ze,Xe){if(Xe==="binary_glTF")return Je[x.KHR_BINARY_GLTF].body;if(ze.type==="arraybuffer"||ze.type===void 0)return new Promise(function(tt){var ye=new g.FileLoader(et.manager);ye.setResponseType("arraybuffer"),ye.load(pe(ze.uri,et.path),function(Ze){tt(Ze)})});console.warn("threeExamples.LegacyGLTFLoader: "+ze.type+" buffer type is not supported")})},pt.prototype.loadBufferViews=function(){var Ue=this.json;return this._withDependencies(["buffers"]).then(function(Je){return Y(Ue.bufferViews,function(et){var ze=Je.buffers[et.buffer],Xe=et.byteLength!==void 0?et.byteLength:0;return ze.slice(et.byteOffset,et.byteOffset+Xe)})})},pt.prototype.loadAccessors=function(){var Ue=this.json;return this._withDependencies(["bufferViews"]).then(function(Je){return Y(Ue.accessors,function(et){var ze=Je.bufferViews[et.bufferView],Xe=K[et.type],tt=Q[et.componentType],ye=tt.BYTES_PER_ELEMENT;if(et.byteStride&&et.byteStride!==ye*Xe){var Ze=new tt(ze),Ge=new g.InterleavedBuffer(Ze,et.byteStride/ye);return new g.InterleavedBufferAttribute(Ge,Xe,et.byteOffset/ye)}else return Ze=new tt(ze,et.byteOffset,et.count*Xe),new g.BufferAttribute(Ze,Xe)})})},pt.prototype.loadTextures=function(){var Ue=this.json,Je=this.options;return this._withDependencies(["bufferViews"]).then(function(et){return Y(Ue.textures,function(ze){if(ze.source)return new Promise(function(Xe){var tt=Ue.images[ze.source],ye=tt.uri,Ze=!1;if(tt.extensions&&tt.extensions[x.KHR_BINARY_GLTF]){var Ge=tt.extensions[x.KHR_BINARY_GLTF],Ae=et.bufferViews[Ge.bufferView],Se=new Blob([Ae],{type:Ge.mimeType});ye=URL.createObjectURL(Se),Ze=!0}var Te=Je.manager.getHandler(ye);Te===null&&(Te=new g.TextureLoader(Je.manager)),Te.setCrossOrigin(Je.crossOrigin),Te.load(pe(ye,Je.path),function(me){if(Ze&&URL.revokeObjectURL(ye),me.flipY=!1,ze.name!==void 0&&(me.name=ze.name),me.format=ze.format!==void 0?F[ze.format]:g.RGBAFormat,ze.internalFormat!==void 0&&me.format!==F[ze.internalFormat]&&console.warn("threeExamples.LegacyGLTFLoader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),me.type=ze.type!==void 0?W[ze.type]:g.UnsignedByteType,ze.sampler){var be=Ue.samplers[ze.sampler];me.magFilter=Z[be.magFilter]||g.LinearFilter,me.minFilter=Z[be.minFilter]||g.NearestMipmapLinearFilter,me.wrapS=ae[be.wrapS]||g.RepeatWrapping,me.wrapT=ae[be.wrapT]||g.RepeatWrapping}Xe(me)},void 0,function(){Ze&&URL.revokeObjectURL(ye),Xe()})})})})},pt.prototype.loadMaterials=function(){var Ue=this.json;return this._withDependencies(["shaders","textures"]).then(function(Je){return Y(Ue.materials,function(et){var ze,Xe={},tt={},ye;if(et.extensions&&et.extensions[x.KHR_MATERIALS_COMMON]&&(ye=et.extensions[x.KHR_MATERIALS_COMMON]),ye){var Ze=["ambient","emission","transparent","transparency","doubleSided"];switch(ye.technique){case"BLINN":case"PHONG":ze=g.MeshPhongMaterial,Ze.push("diffuse","specular","shininess");break;case"LAMBERT":ze=g.MeshLambertMaterial,Ze.push("diffuse");break;case"CONSTANT":default:ze=g.MeshBasicMaterial;break}Ze.forEach(function(er){ye.values[er]!==void 0&&(Xe[er]=ye.values[er])}),(ye.doubleSided||Xe.doubleSided)&&(tt.side=g.DoubleSide),(ye.transparent||Xe.transparent)&&(tt.transparent=!0,tt.opacity=Xe.transparency!==void 0?Xe.transparency:1)}else if(et.technique===void 0)ze=g.MeshPhongMaterial,Object.assign(Xe,et.values);else{ze=$e;var Ge=Ue.techniques[et.technique];tt.uniforms={};var Ae=Ue.programs[Ge.program];if(Ae){tt.fragmentShader=Je.shaders[Ae.fragmentShader],tt.fragmentShader||(console.warn("ERROR: Missing fragment shader definition:",Ae.fragmentShader),ze=g.MeshPhongMaterial);var Se=Je.shaders[Ae.vertexShader];Se||(console.warn("ERROR: Missing vertex shader definition:",Ae.vertexShader),ze=g.MeshPhongMaterial),tt.vertexShader=Ee(Se,Ge);var Te=Ge.uniforms;for(var me in Te){var be=Te[me],we=Ge.parameters[be],je=we.type;if(te[je]){var lt=we.count,ot;et.values!==void 0&&(ot=et.values[be]);var bt=new te[je],Ie=we.semantic,re=we.node;switch(je){case q.FLOAT:bt=we.value,be=="transparency"&&(tt.transparent=!0),ot!==void 0&&(bt=ot);break;case q.FLOAT_VEC2:case q.FLOAT_VEC3:case q.FLOAT_VEC4:case q.FLOAT_MAT3:we&&we.value&&bt.fromArray(we.value),ot&&bt.fromArray(ot);break;case q.FLOAT_MAT2:console.warn("FLOAT_MAT2 is not a supported uniform type");break;case q.FLOAT_MAT4:if(lt){bt=new Array(lt);for(var oe=0;oe<lt;oe++)bt[oe]=new te[je];if(we&&we.value){var _e=we.value;bt.fromArray(_e)}ot&&bt.fromArray(ot)}else{if(we&&we.value){var Re=we.value;bt.fromArray(Re)}ot&&bt.fromArray(ot)}break;case q.SAMPLER_2D:ot!==void 0?bt=Je.textures[ot]:we.value!==void 0?bt=Je.textures[we.value]:bt=null;break}tt.uniforms[me]={value:bt,semantic:Ie,node:re}}else throw new Error("Unknown shader uniform param type: "+je)}for(var ke=Ge.states||{},Be=ke.enable||[],at=ke.functions||{},wt=!1,ht=!1,_t=!1,St=0,Ct=Be.length;St<Ct;St++){var vt=Be[St];switch(ue[vt]){case"CULL_FACE":wt=!0;break;case"DEPTH_TEST":ht=!0;break;case"BLEND":_t=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+vt)}}wt?tt.side=at.cullFace!==void 0?O[at.cullFace]:g.FrontSide:tt.side=g.DoubleSide,tt.depthTest=ht,tt.depthFunc=at.depthFunc!==void 0?X[at.depthFunc]:g.LessDepth,tt.depthWrite=at.depthMask!==void 0?at.depthMask[0]:!0,tt.blending=_t?g.CustomBlending:g.NoBlending,tt.transparent=_t;var ct=at.blendEquationSeparate;ct!==void 0?(tt.blendEquation=G[ct[0]],tt.blendEquationAlpha=G[ct[1]]):(tt.blendEquation=g.AddEquation,tt.blendEquationAlpha=g.AddEquation);var Dt=at.blendFuncSeparate;Dt!==void 0?(tt.blendSrc=j[Dt[0]],tt.blendDst=j[Dt[1]],tt.blendSrcAlpha=j[Dt[2]],tt.blendDstAlpha=j[Dt[3]]):(tt.blendSrc=g.OneFactor,tt.blendDst=g.ZeroFactor,tt.blendSrcAlpha=g.OneFactor,tt.blendDstAlpha=g.ZeroFactor)}}Array.isArray(Xe.diffuse)?tt.color=new g.Color().fromArray(Xe.diffuse):typeof Xe.diffuse=="string"&&(tt.map=Je.textures[Xe.diffuse]),delete tt.diffuse,typeof Xe.reflective=="string"&&(tt.envMap=Je.textures[Xe.reflective]),typeof Xe.bump=="string"&&(tt.bumpMap=Je.textures[Xe.bump]),Array.isArray(Xe.emission)?ze===g.MeshBasicMaterial?tt.color=new g.Color().fromArray(Xe.emission):tt.emissive=new g.Color().fromArray(Xe.emission):typeof Xe.emission=="string"&&(ze===g.MeshBasicMaterial?tt.map=Je.textures[Xe.emission]:tt.emissiveMap=Je.textures[Xe.emission]),Array.isArray(Xe.specular)?tt.specular=new g.Color().fromArray(Xe.specular):typeof Xe.specular=="string"&&(tt.specularMap=Je.textures[Xe.specular]),Xe.shininess!==void 0&&(tt.shininess=Xe.shininess);var fr=new ze(tt);return et.name!==void 0&&(fr.name=et.name),fr})})},pt.prototype.loadMeshes=function(){var Ue=this.json;return this._withDependencies(["accessors","materials"]).then(function(Je){return Y(Ue.meshes,function(et){var ze=new g.Group;et.name!==void 0&&(ze.name=et.name),et.extras&&(ze.userData=et.extras);var Xe=et.primitives||[];for(var tt in Xe){var ye=Xe[tt];if(ye.mode===q.TRIANGLES||ye.mode===void 0){var Ze=new g.BufferGeometry,Ge=ye.attributes;for(var Ae in Ge){var Se=Ge[Ae];if(!Se)return;var Te=Je.accessors[Se];switch(Ae){case"POSITION":Ze.setAttribute("position",Te);break;case"NORMAL":Ze.setAttribute("normal",Te);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":Ze.setAttribute("uv",Te);break;case"TEXCOORD_1":Ze.setAttribute("uv2",Te);break;case"COLOR_0":case"COLOR0":case"COLOR":Ze.setAttribute("color",Te);break;case"WEIGHT":Ze.setAttribute("skinWeight",Te);break;case"JOINT":Ze.setAttribute("skinIndex",Te);break;default:if(!ye.material)break;var we=Ue.materials[ye.material];if(!we.technique)break;var me=Ue.techniques[we.technique].parameters||{};for(var be in me)me[be].semantic===Ae&&Ze.setAttribute(be,Te)}}ye.indices&&Ze.setIndex(Je.accessors[ye.indices]);var we=Je.materials!==void 0?Je.materials[ye.material]:Fe(),je=new g.Mesh(Ze,we);je.castShadow=!0,je.name=tt==="0"?ze.name:ze.name+tt,ye.extras&&(je.userData=ye.extras),ze.add(je)}else if(ye.mode===q.LINES){var Ze=new g.BufferGeometry,Ge=ye.attributes;for(var Ae in Ge){var Se=Ge[Ae];if(!Se)return;var Te=Je.accessors[Se];switch(Ae){case"POSITION":Ze.setAttribute("position",Te);break;case"COLOR_0":case"COLOR0":case"COLOR":Ze.setAttribute("color",Te);break}}var we=Je.materials[ye.material],je;ye.indices?(Ze.setIndex(Je.accessors[ye.indices]),je=new g.LineSegments(Ze,we)):je=new g.Line(Ze,we),je.name=tt==="0"?ze.name:ze.name+tt,ye.extras&&(je.userData=ye.extras),ze.add(je)}else console.warn("Only triangular and line primitives are supported")}return ze})})},pt.prototype.loadCameras=function(){var Ue=this.json;return Y(Ue.cameras,function(Je){if(Je.type=="perspective"&&Je.perspective){var et=Je.perspective.yfov,ze=Je.perspective.aspectRatio!==void 0?Je.perspective.aspectRatio:1,Xe=new g.PerspectiveCamera(g.MathUtils.radToDeg(et*ze),ze,Je.perspective.znear||1,Je.perspective.zfar||2e6);return Je.name!==void 0&&(Xe.name=Je.name),Je.extras&&(Xe.userData=Je.extras),Xe}else if(Je.type=="orthographic"&&Je.orthographic){var Xe=new g.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,Je.orthographic.znear,Je.orthographic.zfar);return Je.name!==void 0&&(Xe.name=Je.name),Je.extras&&(Xe.userData=Je.extras),Xe}})},pt.prototype.loadSkins=function(){var Ue=this.json;return this._withDependencies(["accessors"]).then(function(Je){return Y(Ue.skins,function(et){var ze=new g.Matrix4;et.bindShapeMatrix!==void 0&&ze.fromArray(et.bindShapeMatrix);var Xe={bindShapeMatrix:ze,jointNames:et.jointNames,inverseBindMatrices:Je.accessors[et.inverseBindMatrices]};return Xe})})},pt.prototype.loadAnimations=function(){var Ue=this.json;return this._withDependencies(["accessors","nodes"]).then(function(Je){return Y(Ue.animations,function(et,ze){var Xe=[];for(var tt in et.channels){var ye=et.channels[tt],Ze=et.samplers[ye.sampler];if(Ze){var Ge=ye.target,ot=Ge.id,Ae=et.parameters!==void 0?et.parameters[Ze.input]:Ze.input,Se=et.parameters!==void 0?et.parameters[Ze.output]:Ze.output,Te=Je.accessors[Ae],me=Je.accessors[Se],be=Je.nodes[ot];if(be){be.updateMatrix(),be.matrixAutoUpdate=!0;var we=ce[Ge.path]===ce.rotation?g.QuaternionKeyframeTrack:g.VectorKeyframeTrack,je=be.name?be.name:be.uuid,lt=Ze.interpolation!==void 0?se[Ze.interpolation]:g.InterpolateLinear;Xe.push(new we(je+"."+ce[Ge.path],g.AnimationUtils.arraySlice(Te.array,0),g.AnimationUtils.arraySlice(me.array,0),lt))}}}var ot=et.name!==void 0?et.name:"animation_"+ze;return new g.AnimationClip(ot,void 0,Xe)})})},pt.prototype.loadNodes=function(){var Ue=this.json,Je=this.extensions,et=this;return Y(Ue.nodes,function(ze){var Xe=new g.Matrix4,tt;return ze.jointName?(tt=new g.Bone,tt.name=ze.name!==void 0?ze.name:ze.jointName,tt.jointName=ze.jointName):(tt=new g.Object3D,ze.name!==void 0&&(tt.name=ze.name)),ze.extras&&(tt.userData=ze.extras),ze.matrix!==void 0?(Xe.fromArray(ze.matrix),tt.applyMatrix4(Xe)):(ze.translation!==void 0&&tt.position.fromArray(ze.translation),ze.rotation!==void 0&&tt.quaternion.fromArray(ze.rotation),ze.scale!==void 0&&tt.scale.fromArray(ze.scale)),tt}).then(function(ze){return et._withDependencies(["meshes","skins","cameras"]).then(function(Xe){return Y(ze,function(tt,ye){var Ze=Ue.nodes[ye];if(Ze.meshes!==void 0)for(var Ge in Ze.meshes){var Ae=Ze.meshes[Ge],Se=Xe.meshes[Ae];if(Se===void 0){console.warn(`LegacyGLTFLoader: Couldn't find node "`+Ae+'".');continue}for(var Te in Se.children){var me=Se.children[Te],be=me.material,we=me.geometry,je=me.userData,lt=me.name,ot;switch(be.isDeferredShaderMaterial?be=ot=be.create():ot=be,me.type){case"LineSegments":me=new g.LineSegments(we,ot);break;case"LineLoop":me=new g.LineLoop(we,ot);break;case"Line":me=new g.Line(we,ot);break;default:me=new g.Mesh(we,ot)}me.castShadow=!0,me.userData=je,me.name=lt;var bt;if(Ze.skin&&(bt=Xe.skins[Ze.skin]),bt){var Ie=function(Dt){for(var fr=Object.keys(ze),er=0,dr=fr.length;er<dr;er++){var zr=ze[fr[er]];if(zr.jointName===Dt)return zr}return null},ot=be;ot.skinning=!0,me=new g.SkinnedMesh(we,ot),me.castShadow=!0,me.userData=je,me.name=lt;for(var re=[],oe=[],_e=0,Re=bt.jointNames.length;_e<Re;_e++){var ke=bt.jointNames[_e],Be=Ie(ke);if(Be){re.push(Be);var at=bt.inverseBindMatrices.array,wt=new g.Matrix4().fromArray(at,_e*16);oe.push(wt)}else console.warn("WARNING: joint: '"+ke+"' could not be found")}me.bind(new g.Skeleton(re,oe),bt.bindShapeMatrix);var ht=function ct(Dt,fr,er){var dr=Dt[er];if(dr!==void 0)for(var zr=0,Ut=dr.length;zr<Ut;zr++){var on=dr[zr],tn=ze[on],Ln=Ue.nodes[on];tn!==void 0&&tn.isBone===!0&&Ln!==void 0&&(fr.add(tn),ct(Ln,tn,"children"))}};ht(Ze,me,"skeletons")}tt.add(me)}}if(Ze.camera!==void 0){var _t=Xe.cameras[Ze.camera];tt.add(_t)}if(Ze.extensions&&Ze.extensions[x.KHR_MATERIALS_COMMON]&&Ze.extensions[x.KHR_MATERIALS_COMMON].light){var St=Je[x.KHR_MATERIALS_COMMON].lights,Ct=St[Ze.extensions[x.KHR_MATERIALS_COMMON].light];tt.add(Ct)}return tt})})})},pt.prototype.loadScenes=function(){var Ue=this.json;function Je(et,ze,Xe){var tt=Xe[et];ze.add(tt);var ye=Ue.nodes[et];if(ye.children)for(var Ze=ye.children,Ge=0,Ae=Ze.length;Ge<Ae;Ge++){var Se=Ze[Ge];Je(Se,tt,Xe)}}return this._withDependencies(["nodes"]).then(function(et){return Y(Ue.scenes,function(ze){var Xe=new g.Scene;ze.name!==void 0&&(Xe.name=ze.name),ze.extras&&(Xe.userData=ze.extras);for(var tt=ze.nodes||[],ye=0,Ze=tt.length;ye<Ze;ye++){var Ge=tt[ye];Je(Ge,Xe,et.nodes)}return Xe.traverse(function(Ae){Ae.material&&Ae.material.isRawShaderMaterial&&(Ae.gltfShader=new _(Ae,et.nodes),Ae.onBeforeRender=function(Se,Te,me){this.gltfShader.update(Te,me)})}),Xe})})},E}();var L=P.LegacyGLTFLoader;a.default=L}(HA)),HA}var qA={};function Mc(a,u,h){return u<=a&&a<=h}function a2(a){if(a===void 0)return{};if(a===Object(a))return a;throw TypeError("Could not convert argument to dictionary")}function $F(a){for(var u=String(a),h=u.length,R=0,M=[];R<h;){var v=u.charCodeAt(R);if(v<55296||v>57343)M.push(v);else if(56320<=v&&v<=57343)M.push(65533);else if(55296<=v&&v<=56319)if(R===h-1)M.push(65533);else{var y=a.charCodeAt(R+1);if(56320<=y&&y<=57343){var p=v&1023,g=y&1023;M.push(65536+(p<<10)+g),R+=1}else M.push(65533)}R+=1}return M}function QF(a){for(var u="",h=0;h<a.length;++h){var R=a[h];R<=65535?u+=String.fromCharCode(R):(R-=65536,u+=String.fromCharCode((R>>10)+55296,(R&1023)+56320))}return u}var jy=-1;function ZM(a){this.tokens=[].slice.call(a)}ZM.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():jy},prepend:function(a){if(Array.isArray(a))for(var u=a;u.length;)this.tokens.unshift(u.pop());else this.tokens.unshift(a)},push:function(a){if(Array.isArray(a))for(var u=a;u.length;)this.tokens.push(u.shift());else this.tokens.push(a)}};var P0=-1;function XA(a,u){if(a)throw TypeError("Decoder error");return u||65533}var Yy="utf-8";function Jy(a,u){if(!(this instanceof Jy))return new Jy(a,u);if(a=a!==void 0?String(a).toLowerCase():Yy,a!==Yy)throw new Error("Encoding not supported. Only utf-8 is supported");u=a2(u),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(u.fatal),this._ignoreBOM=Boolean(u.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Jy.prototype={decode:function(u,h){var R;typeof u=="object"&&u instanceof ArrayBuffer?R=new Uint8Array(u):typeof u=="object"&&"buffer"in u&&u.buffer instanceof ArrayBuffer?R=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):R=new Uint8Array(0),h=a2(h),this._streaming||(this._decoder=new KF({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(h.stream);for(var M=new ZM(R),v=[],y;!M.endOfStream()&&(y=this._decoder.handler(M,M.read()),y!==P0);)y!==null&&(Array.isArray(y)?v.push.apply(v,y):v.push(y));if(!this._streaming){do{if(y=this._decoder.handler(M,M.read()),y===P0)break;y!==null&&(Array.isArray(y)?v.push.apply(v,y):v.push(y))}while(!M.endOfStream());this._decoder=null}return v.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(v[0]===65279?(this._BOMseen=!0,v.shift()):this._BOMseen=!0),QF(v)}};function $y(a,u){if(!(this instanceof $y))return new $y(a,u);if(a=a!==void 0?String(a).toLowerCase():Yy,a!==Yy)throw new Error("Encoding not supported. Only utf-8 is supported");u=a2(u),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(u.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}$y.prototype={encode:function(u,h){u=u?String(u):"",h=a2(h),this._streaming||(this._encoder=new eI(this._options)),this._streaming=Boolean(h.stream);for(var R=[],M=new ZM($F(u)),v;!M.endOfStream()&&(v=this._encoder.handler(M,M.read()),v!==P0);)Array.isArray(v)?R.push.apply(R,v):R.push(v);if(!this._streaming){for(;v=this._encoder.handler(M,M.read()),v!==P0;)Array.isArray(v)?R.push.apply(R,v):R.push(v);this._encoder=null}return new Uint8Array(R)}};function KF(a){var u=a.fatal,h=0,R=0,M=0,v=128,y=191;this.handler=function(p,g){if(g===jy&&M!==0)return M=0,XA(u);if(g===jy)return P0;if(M===0){if(Mc(g,0,127))return g;if(Mc(g,194,223))M=1,h=g-192;else if(Mc(g,224,239))g===224&&(v=160),g===237&&(y=159),M=2,h=g-224;else if(Mc(g,240,244))g===240&&(v=144),g===244&&(y=143),M=3,h=g-240;else return XA(u);return h=h<<6*M,null}if(!Mc(g,v,y))return h=M=R=0,v=128,y=191,p.prepend(g),XA(u);if(v=128,y=191,R+=1,h+=g-128<<6*(M-R),R!==M)return null;var C=h;return h=M=R=0,C}}function eI(a){a.fatal,this.handler=function(u,h){if(h===jy)return P0;if(Mc(h,0,127))return h;var R,M;Mc(h,128,2047)?(R=1,M=192):Mc(h,2048,65535)?(R=2,M=224):Mc(h,65536,1114111)&&(R=3,M=240);for(var v=[(h>>6*R)+M];R>0;){var y=h>>6*(R-1);v.push(128|y&63),R-=1}return v}}const tI=Object.freeze(Object.defineProperty({__proto__:null,TextEncoder:$y,TextDecoder:Jy},Symbol.toStringTag,{value:"Module"})),rI=Ky(tI);var AT;function s2(){return AT||(AT=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.TextDecoder=void 0;var u=rI,h=typeof ua.TextDecoder=="function"?ua.TextDecoder:u.TextDecoder;a.TextDecoder=h;var R=new h("utf-8");a.default=R}(qA)),qA}var ZA={},jA={},wT;function o2(){return wT||(wT=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u={tileset:"tileset",batchtable:"batchtable",boundingVolume:"boundingVolume"},h=u;a.default=h}(jA)),jA}var MT;function jM(){return MT||(MT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(s2()),v=u(o2()),y=function(){function g(C,D,B,V){(0,h.default)(this,g),this.type=v.default.batchtable,this.batchLength=B;var P=C;D>0&&(console.warn("Binary batch table content not supported yet."),P=C.slice(0,C.byteLength-D));var L=M.default.decode(new Uint8Array(P)),E=JSON.parse(L);E.extensions&&(this.extensions=V.parseExtensions(E.extensions,this.type),delete E.extensions),this.content=E}return(0,R.default)(g,[{key:"getInfoById",value:function(D){if(D<0&&D<this.batchLength)throw new Error("Batch Id (".concat(D,`) must be between 0 and
            `).concat(this.batchLength,` to access feature properties from the batch
            table.`));var B={};B.batchTable={};for(var V in this.content)Object.prototype.hasOwnProperty.call(this.content,V)&&(B.batchTable[V]=this.content[V][D]);if(this.extensions){B.extensions={};for(var P in this.extensions)Object.prototype.hasOwnProperty.call(this.extensions,P)&&(B.extensions[P]=this.extensions[P].getInfoById(D))}return B}}]),g}(),p=y;a.default=p}(ZA)),ZA}var YA={},bT;function YM(){return bT||(bT=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;function u(R,M){if(M&&M.isGeometryLayer){var v=R.transparent;R.layer=M,R.uniforms&&R.uniforms.opacity!=null?Object.defineProperty(R.uniforms.opacity,"value",{get:function(){return R.layer.opacity}}):R.opacity!=null&&Object.defineProperty(R,"opacity",{get:function(){return R.layer.opacity}}),Object.defineProperty(R,"wireframe",{get:function(){return R.layer.wireframe}}),Object.defineProperty(R,"transparent",{get:function(){return v!=R.layer.opacity<1&&(R.needsUpdate=!0,v=R.layer.opacity<1),v}})}return R}var h=u;a.default=h}(YA)),YA}var ET;function uC(){return ET||(ET=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.enableDracoLoader=q,a.legacyGLTFLoader=a.glTFLoader=void 0;var R=u(Lr.exports),M=L(Dr()),v=u(td()),y=jF(),p=YF(),g=u(JF()),C=u(n2()),D=u(s2()),B=u(jM()),V=u(YM());function P(Q){if(typeof WeakMap!="function")return null;var Z=new WeakMap,ae=new WeakMap;return(P=function(W){return W?ae:Z})(Q)}function L(Q,Z){if(!Z&&Q&&Q.__esModule)return Q;if(Q===null||h(Q)!=="object"&&typeof Q!="function")return{default:Q};var ae=P(Z);if(ae&&ae.has(Q))return ae.get(Q);var F={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in Q)if(O!=="default"&&Object.prototype.hasOwnProperty.call(Q,O)){var X=W?Object.getOwnPropertyDescriptor(Q,O):null;X&&(X.get||X.set)?Object.defineProperty(F,O,X):F[O]=Q[O]}return F.default=Q,ae&&ae.set(Q,F),F}function E(Q,Z){var ae=typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(!ae){if(Array.isArray(Q)||(ae=b(Q))||Z&&Q&&typeof Q.length=="number"){ae&&(Q=ae);var F=0,W=function(){};return{s:W,n:function(){return F>=Q.length?{done:!0}:{done:!1,value:Q[F++]}},e:function(K){throw K},f:W}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var O=!0,X=!1,G;return{s:function(){ae=ae.call(Q)},n:function(){var K=ae.next();return O=K.done,K},e:function(K){X=!0,G=K},f:function(){try{!O&&ae.return!=null&&ae.return()}finally{if(X)throw G}}}}function b(Q,Z){if(!!Q){if(typeof Q=="string")return _(Q,Z);var ae=Object.prototype.toString.call(Q).slice(8,-1);if(ae==="Object"&&Q.constructor&&(ae=Q.constructor.name),ae==="Map"||ae==="Set")return Array.from(Q);if(ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae))return _(Q,Z)}}function _(Q,Z){(Z==null||Z>Q.length)&&(Z=Q.length);for(var ae=0,F=new Array(Z);ae<Z;ae++)F[ae]=Q[ae];return F}var x=new M.Matrix4().makeRotationX(Math.PI/2),T=new M.Matrix4().makeRotationZ(-Math.PI/2),N=new y.GLTFLoader;a.glTFLoader=N;var U=new g.default;a.legacyGLTFLoader=U;function H(Q){var Z=["MODELVIEW","MODELVIEWINVERSETRANSPOSE","PROJECTION","JOINTMATRIX"];if(Q.gltfShader){var ae=[];for(var F in Q.gltfShader.boundUniforms)ae.push(F);for(var W=0,O=ae;W<O.length;W++){var X=O[W],G=Q.gltfShader.boundUniforms[X].semantic;Z.includes(G)||delete Q.gltfShader.boundUniforms[X]}}}function q(Q,Z){if(!Q)throw new Error("Path to draco folder is mandatory");var ae=new p.DRACOLoader;ae.setDecoderPath(Q),Z&&ae.setDecoderConfig(Z),N.setDRACOLoader(ae)}var te={parse:function(Z,ae){var F=ae.gltfUpAxis,W=ae.urlBase;if(!Z)throw new Error("No array buffer provided.");var O=new DataView(Z,4),X=0,G={},j=4;if(G.magic=D.default.decode(new Uint8Array(Z,0,j)),G.magic){G.version=O.getUint32(X,!0),X+=Uint32Array.BYTES_PER_ELEMENT,G.byteLength=O.getUint32(X,!0),X+=Uint32Array.BYTES_PER_ELEMENT,G.FTJSONLength=O.getUint32(X,!0),X+=Uint32Array.BYTES_PER_ELEMENT,G.FTBinaryLength=O.getUint32(X,!0),X+=Uint32Array.BYTES_PER_ELEMENT,G.BTJSONLength=O.getUint32(X,!0),X+=Uint32Array.BYTES_PER_ELEMENT,G.BTBinaryLength=O.getUint32(X,!0),X+=Uint32Array.BYTES_PER_ELEMENT;var K=X+j,ce=[],se={},ue=new M.Vector3;if(G.FTJSONLength>0){var Y=K,pe=Z.slice(Y,G.FTJSONLength+Y),Ee=D.default.decode(new Uint8Array(pe));se=JSON.parse(Ee),se.RTC_CENTER?ue.fromArray(se.RTC_CENTER):ue.set(0,0,0)}if(G.FTBinaryLength>0&&console.warn("3D Tiles feature table binary not supported yet."),G.BTJSONLength>0){var Fe=K+G.FTJSONLength+G.FTBinaryLength,$e=Z.slice(Fe,G.BTJSONLength+Fe);ce.push(new B.default($e,G.BTBinaryLength,se.BATCH_LENGTH,ae.registeredExtensions))}else ce.push(Promise.resolve({}));var pt=K+G.FTJSONLength+G.FTBinaryLength+G.BTJSONLength+G.BTBinaryLength,Ue=Z.slice(pt),Je=new DataView(Ue,0,20);return ce.push(new Promise(function(et){var ze=function(tt){var ye=E(tt.scenes),Ze;try{for(ye.s();!(Ze=ye.n()).done;){var Ge=Ze.value;Ge.traverse(H)}}catch(me){ye.e(me)}finally{ye.f()}F===void 0||F==="Y"?tt.scene.applyMatrix4(x):F==="X"&&tt.scene.applyMatrix4(T),tt.scene.position.copy(ue);var Ae=new Uint8Array(Ue,20,Je.getUint32(12,!0)),Se=D.default.decode(new Uint8Array(Ae)),Te=JSON.parse(Se);Te.extensions&&Te.extensions.CESIUM_RTC&&(tt.scene.position.fromArray(Te.extensions.CESIUM_RTC.center),tt.scene.updateMatrixWorld(!0)),tt.scene.traverse(function(me){if(me.frustumCulled=!1,me.material){if(ae.overrideMaterials){if(Array.isArray(me.material)){var be=E(me.material),we;try{for(be.s();!(we=be.n()).done;){var je=we.value;je.dispose()}}catch(lt){be.e(lt)}finally{be.f()}}else me.material.dispose();(0,R.default)(ae.overrideMaterials)==="object"&&ae.overrideMaterials.isMaterial?me.material=ae.overrideMaterials:me.material.depthWrite=!0}else v.default.isLogDepthBufferSupported()&&me.material.isRawShaderMaterial&&!ae.doNotPatchMaterial&&(C.default.patchMaterialForLogDepthSupport(me.material),console.warn("b3dm shader has been patched to add log depth buffer support"));(0,V.default)(me.material,ae.layer)}}),et(tt)},Xe=Je.getUint32(4,!0);Xe===1?U.parse(Ue,W,ze):N.parse(Ue,W,ze)})),Promise.all(ce).then(function(et){return{gltf:et[1],batchTable:et[0]}})}else throw new Error("Invalid b3dm file.")}};a.default=te}(WA)),WA}var JA={},TT;function nI(){return TT||(TT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=p(Dr()),M=u(s2()),v=u(jM());function y(D){if(typeof WeakMap!="function")return null;var B=new WeakMap,V=new WeakMap;return(y=function(L){return L?V:B})(D)}function p(D,B){if(!B&&D&&D.__esModule)return D;if(D===null||h(D)!=="object"&&typeof D!="function")return{default:D};var V=y(B);if(V&&V.has(D))return V.get(D);var P={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in D)if(E!=="default"&&Object.prototype.hasOwnProperty.call(D,E)){var b=L?Object.getOwnPropertyDescriptor(D,E):null;b&&(b.get||b.set)?Object.defineProperty(P,E,b):P[E]=D[E]}return P.default=D,V&&V.set(D,P),P}var g={parse:function(D,B){if(!D)throw new Error("No array buffer provided.");var V=new DataView(D),P=0,L={},E={},b={};if(L.magic=M.default.decode(new Uint8Array(D,P,4)),P+=4,L.magic){L.version=V.getUint32(P,!0),P+=Uint32Array.BYTES_PER_ELEMENT,L.byteLength=V.getUint32(P,!0),P+=Uint32Array.BYTES_PER_ELEMENT,L.FTJSONLength=V.getUint32(P,!0),P+=Uint32Array.BYTES_PER_ELEMENT,L.FTBinaryLength=V.getUint32(P,!0),P+=Uint32Array.BYTES_PER_ELEMENT,L.BTJSONLength=V.getUint32(P,!0),P+=Uint32Array.BYTES_PER_ELEMENT,L.BTBinaryLength=V.getUint32(P,!0),P+=Uint32Array.BYTES_PER_ELEMENT;var _={};if(L.FTJSONLength>0){var x=P,T=D.slice(x,L.FTJSONLength+x),N=M.default.decode(new Uint8Array(T));_=JSON.parse(N)}if(L.FTBinaryLength>0&&(b=C(D,P,L.FTJSONLength)),L.BTJSONLength>0){var U=P+L.FTJSONLength+L.FTBinaryLength,H=D.slice(U,L.BTJSONLength+U);E=new v.default(H,L.BTBinaryLength,_.BATCH_LENGTH,B)}var q={point:b,batchTable:E};return Promise.resolve(q)}else throw new Error("Invalid pnts file.")}};a.default=g;function C(D,B,V){var P=new R.BufferGeometry,L=M.default.decode(new Uint8Array(D,B,V)),E=JSON.parse(L),b;if(E.POINTS_LENGTH&&(b=E.POINTS_LENGTH),E.POSITION){var _=E.POSITION.byteOffset+L.length+B,x=new Float32Array(D,_,b*3);P.setAttribute("position",new R.BufferAttribute(x,3))}if(E.RGB){var T=E.RGB.byteOffset+L.length+B,N=new Uint8Array(D,T,b*3);P.setAttribute("color",new R.BufferAttribute(N,3,!0))}if(E.POSITION_QUANTIZED)throw new Error("For pnts loader, POSITION_QUANTIZED: not yet managed");if(E.RGBA)throw new Error("For pnts loader, RGBA: not yet managed");if(E.RGB565)throw new Error("For pnts loader, RGB565: not yet managed");if(E.NORMAL)throw new Error("For pnts loader, NORMAL: not yet managed");if(E.NORMAL_OCT16P)throw new Error("For pnts loader, NORMAL_OCT16P: not yet managed");if(E.BATCH_ID)throw new Error("For pnts loader, BATCH_ID: not yet managed");var U=E.RTC_CENTER?new R.Vector3().fromArray(E.RTC_CENTER):void 0;return{geometry:P,offset:U}}}(JA)),JA}var ST;function iI(){return ST||(ST=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.configureTile=V,a.default=void 0;var R=C(Dr()),M=u(uC()),v=u(nI()),y=u(dl()),p=u(s2());function g(E){if(typeof WeakMap!="function")return null;var b=new WeakMap,_=new WeakMap;return(g=function(T){return T?_:b})(E)}function C(E,b){if(!b&&E&&E.__esModule)return E;if(E===null||h(E)!=="object"&&typeof E!="function")return{default:E};var _=g(b);if(_&&_.has(E))return _.get(E);var x={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in E)if(N!=="default"&&Object.prototype.hasOwnProperty.call(E,N)){var U=T?Object.getOwnPropertyDescriptor(E,N):null;U&&(U.get||U.set)?Object.defineProperty(x,N,U):x[N]=E[N]}return x.default=E,_&&_.set(E,x),x}function D(E,b,_){var x=R.LoaderUtils.extractUrlBase(_),T={gltfUpAxis:b.tileset.asset.gltfUpAxis,urlBase:x,overrideMaterials:b.overrideMaterials,doNotPatchMaterial:b.doNotPatchMaterial,opacity:b.opacity,registeredExtensions:b.registeredExtensions,layer:b};return M.default.parse(E,T).then(function(N){var U=N.batchTable,H=N.gltf.scene;return{batchTable:U,object3d:H}})}function B(E,b){return v.default.parse(E,b.registeredExtensions).then(function(_){var x=b.material?b.material.clone():new R.PointsMaterial({size:.05,vertexColors:!0}),T=new R.Points(_.point.geometry,x);return _.point.offset&&T.position.copy(_.point.offset),{object3d:T}})}function V(E,b,_,x){E.frustumCulled=!1,E.layer=b,_.transform&&E.applyMatrix4(_.transform),E.geometricError=_.geometricError,E.tileId=_.tileId,_.refine?E.additiveRefinement=_.refine.toUpperCase()==="ADD":E.additiveRefinement=x?x.additiveRefinement:!1,E.viewerRequestVolume=_.viewerRequestVolume,E.boundingVolume=_.boundingVolume,E.boundingVolume.region&&E.add(E.boundingVolume.region),E.updateMatrixWorld()}function P(E){var b=E.layer,_=E.metadata,x=new R.Object3D;V(x,b,_,E.requester);var T=_.content&&(_.content.url||_.content.uri),N=function(q){q.layers.set(b.threejsLayer),q.userData.metadata=_,q.layer=b};if(T){var U=T.startsWith("http")?T:_.baseURL+T,H={b3dm:D,pnts:B};return y.default.arrayBuffer(U,b.source.networkOptions).then(function(q){if(q!==void 0){var te,Q=p.default.decode(new Uint8Array(q,0,4));if(Q[0]==="{"){q=JSON.parse(p.default.decode(new Uint8Array(q)));var Z=U.slice(0,U.lastIndexOf("/")+1);b.tileset.extendTileset(q,_.tileId,Z,b.registeredExtensions)}else if(Q=="b3dm")te=H.b3dm;else if(Q=="pnts")te=H.pnts;else return Promise.reject("Unsupported magic code ".concat(Q));if(te)return te(q,b,U).then(function(ae){return x.content=ae.object3d,ae.batchTable&&(x.batchTable=ae.batchTable),x.add(ae.object3d),x.traverse(N),x})}return x.traverse(N),x})}else return x.traverse(N),Promise.resolve(x)}var L={executeCommand:P};a.default=L}(VA)),VA}var $A={},RT;function aI(){return RT||(RT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=y(Dr()),M=u(ya());function v(D){if(typeof WeakMap!="function")return null;var B=new WeakMap,V=new WeakMap;return(v=function(L){return L?V:B})(D)}function y(D,B){if(!B&&D&&D.__esModule)return D;if(D===null||h(D)!=="object"&&typeof D!="function")return{default:D};var V=v(B);if(V&&V.has(D))return V.get(D);var P={},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in D)if(E!=="default"&&Object.prototype.hasOwnProperty.call(D,E)){var b=L?Object.getOwnPropertyDescriptor(D,E):null;b&&(b.get||b.set)?Object.defineProperty(P,E,b):P[E]=D[E]}return P.default=D,V&&V.set(D,P),P}var p=1;function g(D){var B=D.geometry.attributes.position.count,V=new Uint8Array(4*B),P=p++;if(B>65535||P>65535)return console.warn("Currently picking is limited to Points with less than 65535 elements and less than 65535 Points instances"),D;for(var L=0;L<B;L++){var E=P<<16|L;V[4*L+0]=(E&4278190080)>>24,V[4*L+1]=(E&16711680)>>16,V[4*L+2]=(E&65280)>>8,V[4*L+3]=(E&255)>>0}return D.baseId=P,D.geometry.setAttribute("unique_id",new R.BufferAttribute(V,4,!0)),D}var C={executeCommand:function(B){var V=B.layer,P=B.requester;return P.load().then(function(L){var E=new R.Points(L,V.material);return g(E),E.frustumCulled=!1,E.matrixAutoUpdate=!1,V.isEntwinePointTileLayer||(E.position.copy(P.bbox.min),E.scale.copy(V.scale)),E.updateMatrix(),E.tightbbox=L.boundingBox.applyMatrix4(E.matrix),E.layers.set(V.threejsLayer),E.layer=V,E.extent=M.default.fromBox3(B.view.referenceCrs,P.bbox),E.userData.node=P,E})}};a.default=C}($A)),$A}var CT;function sI(){return CT||(CT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(qF()),R=u(XF()),M=u(ZF()),v=u(iI()),y=u(aI()),p=u(oC());function g(b,_){var x=typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(!x){if(Array.isArray(b)||(x=C(b))||_&&b&&typeof b.length=="number"){x&&(b=x);var T=0,N=function(){};return{s:N,n:function(){return T>=b.length?{done:!0}:{done:!1,value:b[T++]}},e:function(Q){throw Q},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var U=!0,H=!1,q;return{s:function(){x=x.call(b)},n:function(){var Q=x.next();return U=Q.done,Q},e:function(Q){H=!0,q=Q},f:function(){try{!U&&x.return!=null&&x.return()}finally{if(H)throw q}}}}function C(b,_){if(!!b){if(typeof b=="string")return D(b,_);var x=Object.prototype.toString.call(b).slice(8,-1);if(x==="Object"&&b.constructor&&(x=b.constructor.name),x==="Map"||x==="Set")return Array.from(b);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return D(b,_)}}function D(b,_){(_==null||_>b.length)&&(_=b.length);for(var x=0,T=new Array(_);x<_;x++)T[x]=b[x];return T}function B(b,_){var x=_.priority-b.priority;return x===0?_.timestamp-b.timestamp:x}function V(b){var _=0,x,T,N=g(b),U;try{for(N.s();!(U=N.n()).done;){var H=U.value,q=H[1];q.q.length>0&&(_+=q.priority,q.accumulator+=q.priority,(!x||q.accumulator>T)&&(x=q,T=q.accumulator))}}catch(te){N.e(te)}finally{N.f()}if(x)return x.accumulator-=_,x.q}function P(){return{queue:function(_){var x=_.layer,T=this.storages.get(x.id);T||(T={q:new h.default({comparator:B}),priority:1,accumulator:0},this.storages.set(x.id,T)),T.priority=x.priority||1,T.q.queue(_),this.counters.pending++},storages:new Map,counters:{executing:0,executed:0,failed:0,cancelled:0,pending:0},execute:function(_,x){var T=this;return this.counters.pending--,this.counters.executing++,x.executeCommand(_).then(function(N){T.counters.executing--,_.resolve(N),T.counters.executed++},function(N){T.counters.executing--,_.reject(N),T.counters.failed++})}}}function L(){this.defaultQueue=P(),this.hostQueues=new Map,this.providers={},this.maxCommandsPerHost=6,this.initDefaultProviders()}L.prototype.constructor=L,L.prototype.initDefaultProviders=function(){this.addProtocolProvider("tile",M.default),this.addProtocolProvider("3d-tiles",v.default),this.addProtocolProvider("pointcloud",y.default)},L.prototype.runCommand=function(b,_,x){var T=this,N=this.getProtocolProvider(b.layer.protocol);if(!N)throw new Error("No known provider for layer ".concat(b.layer.id));_.execute(b,N,x).then(function(){if(b.view.notifyChange(b.requester,b.redraw),_.counters.executing<T.maxCommandsPerHost){var U=T.deQueue(_);U&&T.runCommand(U,_)}})},L.prototype.execute=function(b){var _=this,x=b.layer,T=x.source&&x.source.url?new URL(x.source.url,document.location).host:void 0;b.promise=new Promise(function(U,H){b.resolve=U,b.reject=H}),T&&!this.hostQueues.has(T)&&this.hostQueues.set(T,P());var N=T?this.hostQueues.get(T):this.defaultQueue;return b.timestamp=Date.now(),N.queue(b),N.counters.executing<this.maxCommandsPerHost&&Promise.resolve().then(function(){if(N.counters.executing<_.maxCommandsPerHost){var U=_.deQueue(N);U&&_.runCommand(U,N)}}),b.promise},L.prototype.addProtocolProvider=function(b,_){if(typeof _.executeCommand!="function")throw new Error("Can't add provider for ".concat(b,": missing a executeCommand function."));this.providers[b]=_},L.prototype.getProtocolProvider=function(b){return this.providers[b]||R.default},L.prototype.commandsWaitingExecutionCount=function(){var b=this.defaultQueue.counters.pending+this.defaultQueue.counters.executing,_=g(this.hostQueues),x;try{for(_.s();!(x=_.n()).done;){var T=x.value;b+=T[1].counters.pending+T[1].counters.executing}}catch(N){_.e(N)}finally{_.f()}return b},L.prototype.commandsRunningCount=function(){var b=this.defaultQueue.counters.executing,_=g(this.hostQueues),x;try{for(_.s();!(x=_.n()).done;){var T=x.value;b+=T[1].counters.executing}}catch(N){_.e(N)}finally{_.f()}return b},L.prototype.resetCommandsCount=function(b){var _=this.defaultQueue.counters[b];this.defaultQueue.counters[b]=0;var x=g(this.hostQueues),T;try{for(x.s();!(T=x.n()).done;){var N=T.value;_+=N[1].counters[b],N[1].counters[b]=0}}catch(U){x.e(U)}finally{x.f()}return _},L.prototype.deQueue=function(b){for(var _=V(b.storages);_&&_.length>0;){var x=_.dequeue();if(x.earlyDropFunction&&x.earlyDropFunction(x))b.counters.pending--,b.counters.cancelled++,x.reject(new p.default(x));else return x}};var E=L;a.default=E}(NA)),NA}var QA={},PT;function u2(){return PT||(PT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=p(Dr()),M=u(WM()),v=rd();function y(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,N=new WeakMap;return(y=function(H){return H?N:T})(x)}function p(x,T){if(!T&&x&&x.__esModule)return x;if(x===null||h(x)!=="object"&&typeof x!="function")return{default:x};var N=y(T);if(N&&N.has(x))return N.get(x);var U={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in x)if(q!=="default"&&Object.prototype.hasOwnProperty.call(x,q)){var te=H?Object.getOwnPropertyDescriptor(x,q):null;te&&(te.get||te.set)?Object.defineProperty(U,q,te):U[q]=x[q]}return U.default=x,N&&N.set(x,U),U}function g(x,T){var N=typeof Symbol<"u"&&x[Symbol.iterator]||x["@@iterator"];if(!N){if(Array.isArray(x)||(N=C(x))||T&&x&&typeof x.length=="number"){N&&(x=N);var U=0,H=function(){};return{s:H,n:function(){return U>=x.length?{done:!0}:{done:!1,value:x[U++]}},e:function(ae){throw ae},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,te=!1,Q;return{s:function(){N=N.call(x)},n:function(){var ae=N.next();return q=ae.done,ae},e:function(ae){te=!0,Q=ae},f:function(){try{!q&&N.return!=null&&N.return()}finally{if(te)throw Q}}}}function C(x,T){if(!!x){if(typeof x=="string")return D(x,T);var N=Object.prototype.toString.call(x).slice(8,-1);if(N==="Object"&&x.constructor&&(N=x.constructor.name),N==="Map"||N==="Set")return Array.from(x);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return D(x,T)}}function D(x,T){(T==null||T>x.length)&&(T=x.length);for(var N=0,U=new Array(T);N<T;N++)U[N]=x[N];return U}function B(x){var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,N=x.camera.camera3D.layers.mask;return x.camera.camera3D.layers.mask=1<<T,function(){x.camera.camera3D.layers.mask=N}}var V=new R.Vector4;function P(x,T,N){var U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,H=x.mainLoop.gfxEngine.getWindowSize();N=N||new R.Vector2(Math.floor(H.x/2),Math.floor(H.y/2));var q=T.level0Nodes.map(function(ae){return M.default.push(ae,M.default.MODES.ID)}),te=B(x,T.object3d,T.threejsLayer),Q=x.mainLoop.gfxEngine.renderViewToBuffer({camera:x.camera,scene:T.object3d},{x:N.x-U,y:N.y-U,width:1+U*2,height:1+U*2});te(),q.forEach(function(ae){return ae()});var Z=[];return L(U,function(ae,F){var W=(F*2*U+ae)*4,O=Q.slice(W,W+4||void 0);V.fromArray(O).divideScalar(255);var X=(0,v.unpack1K)(V,Math.pow(256,3)),G=Math.round(X);Z.includes(G)||Z.push(G)}),Z}function L(x,T){for(var N,U=0;U<=x;U++){for(var H=U*U,q=-U;q<=U;q++)for(var te=q*q,Q=-U;Q<=U;Q++){var Z=te+Q*Q;if(!(Z>H)&&!(Z<=N)&&T(q,Q)===!1)return}N=H}}function E(x){if(x.layer)return x.layer;if(x.parent)return E(x.parent)}var b=new R.Raycaster,_={pickTilesAt:function(T,N,U,H){var q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],te=P(T,H,N,U),Q=function(W){te.includes(W.id)&&W.isTileMesh&&q.push({object:W,layer:H})},Z=g(H.level0Nodes),ae;try{for(Z.s();!(ae=Z.n()).done;){var F=ae.value;F.traverse(Q)}}catch(W){Z.e(W)}finally{Z.f()}return q},pickPointsAt:function(T,N,U,H){var q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[];if(!!H.root){H.object3d.traverse(function(ae){ae.isPoints&&ae.baseId&&ae.material.enablePicking(!0)});var te=B(T,H.object3d,H.threejsLayer),Q=T.mainLoop.gfxEngine.renderViewToBuffer({camera:T.camera,scene:H.object3d},{x:N.x-U,y:N.y-U,width:1+U*2,height:1+U*2});te();var Z=[];return L(U,function(ae,F){for(var W=(F*2*U+ae)*4,O=Q.slice(W,W+4),X=O[0]<<8|O[1],G=O[2]<<8|O[3],j={objId:X,index:G},K=0;K<Z.length;K++)if(Z[K].objId==j.objId&&Z[K].index==j.index)return;Z.push(j)}),H.object3d.traverse(function(ae){if(ae.isPoints&&ae.baseId){ae.material.enablePicking(!1);for(var F=0;F<Z.length;F++)Z[F].objId==ae.baseId&&q.push({object:ae,index:Z[F].index,layer:H})}}),q}},pickObjectsAt:function(T,N,U,H){var q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],te=arguments.length>5?arguments[5]:void 0;if(te!==void 0?b.layers.set(te):b.layers.enableAll(),U<0){var Q=T.viewToNormalizedCoords(N);b.setFromCamera(Q,T.camera.camera3D);var Z=b.intersectObject(H,!0),ae=g(Z),F;try{for(ae.s();!(F=ae.n()).done;){var W=F.value;W.layer=E(W.object),q.push(W)}}catch(Y){ae.e(Y)}finally{ae.f()}return q}var O={x:N.x-U,y:N.y-U,width:1+U*2,height:1+U*2},X=T.mainLoop.gfxEngine.renderViewToBuffer({scene:H,camera:T.camera},O),G=new R.Color;T.mainLoop.gfxEngine.renderer.getClearColor(G);var j=Math.round(255*G.r),K=Math.round(255*G.g),ce=Math.round(255*G.b),se=T.viewToNormalizedCoords(N),ue=se.clone();return L(U,function(Y,pe){var Ee=((pe+U)*(U*2+1)+(Y+U))*4,Fe=X[Ee],$e=X[Ee+1],pt=X[Ee+2];if(!(Math.abs(j-Fe)<=1&&Math.abs(K-$e)<=1&&Math.abs(ce-pt)<=1)){ue.setX(se.x+Y/T.camera.width).setY(se.y+pe/T.camera.height),b.setFromCamera(ue,T.camera.camera3D);var Ue=b.intersectObject(H,!0),Je=g(Ue),et;try{for(Je.s();!(et=Je.n()).done;){var ze=et.value;ze.layer=E(ze.object),q.push(ze)}}catch(Xe){Je.e(Xe)}finally{Je.f()}return q.length==0}}),q}};a.default=_}(QA)),QA}var KA={},ew={},LT;function l2(){return LT||(LT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M={IDLE:0,PENDING:1,ERROR:2,DEFINITIVE_ERROR:3,FINISHED:4},v=[1,3,7,60],y=function(){function g(){(0,h.default)(this,g),this.state=M.IDLE,this.lastErrorTimestamp=0,this.errorCount=0,this.failureParams={lowestLevelError:1/0}}return(0,R.default)(g,[{key:"canTryUpdate",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Date.now();switch(this.state){case M.IDLE:return!0;case M.DEFINITIVE_ERROR:case M.PENDING:case M.FINISHED:return!1;case M.ERROR:default:{var B=this.secondsUntilNextTry()*1e3;return B<=D-this.lastErrorTimestamp}}}},{key:"secondsUntilNextTry",value:function(){if(this.state!==M.ERROR)return 0;var D=Math.max(0,Math.min(this.errorCount,v.length)-1);return v[D]}},{key:"newTry",value:function(){this.state=M.PENDING}},{key:"success",value:function(){this.lastErrorTimestamp=0,this.state=M.IDLE}},{key:"noMoreUpdatePossible",value:function(){this.state=M.FINISHED}},{key:"noData",value:function(D){this.state=M.IDLE,this.failureParams.lowestLevelError=Math.min(D.targetLevel,this.failureParams.lowestLevelError)}},{key:"failure",value:function(D,B,V){V&&V.targetLevel!=null&&(this.failureParams.lowestLevelError=Math.min(V.targetLevel,this.failureParams.lowestLevelError)),this.lastErrorTimestamp=D,this.state=B?M.DEFINITIVE_ERROR:M.ERROR,this.errorCount++}},{key:"inError",value:function(){return this.state==M.DEFINITIVE_ERROR||this.state==M.ERROR}}]),g}(),p=y;a.default=p}(ew)),ew}var tw={},OT;function JM(){return OT||(OT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Qh());function R(p,g){var C=typeof Symbol<"u"&&p[Symbol.iterator]||p["@@iterator"];if(!C){if(Array.isArray(p)||(C=M(p))||g&&p&&typeof p.length=="number"){C&&(p=C);var D=0,B=function(){};return{s:B,n:function(){return D>=p.length?{done:!0}:{done:!1,value:p[D++]}},e:function(b){throw b},f:B}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var V=!0,P=!1,L;return{s:function(){C=C.call(p)},n:function(){var b=C.next();return V=b.done,b},e:function(b){P=!0,L=b},f:function(){try{!V&&C.return!=null&&C.return()}finally{if(P)throw L}}}}function M(p,g){if(!!p){if(typeof p=="string")return v(p,g);var C=Object.prototype.toString.call(p).slice(8,-1);if(C==="Object"&&p.constructor&&(C=p.constructor.name),C==="Map"||C==="Set")return Array.from(p);if(C==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return v(p,g)}}function v(p,g){(g==null||g>p.length)&&(g=p.length);for(var C=0,D=new Array(g);C<g;C++)D[C]=p[C];return D}var y={cleanup:function(g){if(g.layer=null,typeof g.dispose=="function")g.dispose();else{if(g.geometry&&g.geometry.dispose(),g.material)if(Array.isArray(g.material)){var C=R(g.material),D;try{for(C.s();!(D=C.n()).done;){var B=D.value;B.dispose()}}catch(V){C.e(V)}finally{C.f()}}else g.material.dispose();g.dispatchEvent({type:"dispose"})}},removeChildren:function(g,C){var D=C.children.filter(function(B){return(B.layer&&B.layer.id)===g.id});return C.remove.apply(C,(0,h.default)(D)),D},removeChildrenAndCleanup:function(g,C){var D=C.children.filter(function(B){return(B.layer&&B.layer.id)===g.id});return C.remove.apply(C,(0,h.default)(D)),C.layer===g&&this.cleanup(C),D},removeChildrenAndCleanupRecursively:function(g,C){var D=C.children.filter(function(L){return(L.layer&&L.layer.id)===g.id});C.link&&(D=D.concat(C.link));var B=R(D),V;try{for(B.s();!(V=B.n()).done;){var P=V.value;this.removeChildrenAndCleanupRecursively(g,P)}}catch(L){B.e(L)}finally{B.f()}return C.remove.apply(C,(0,h.default)(D)),C.layer&&C.layer.id===g.id&&this.cleanup(C),D}};a.default=y}(tw)),tw}var rw={},FT;function lC(){return FT||(FT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=P(Dr()),D=u(F0()),B=u(Zi());function V(U){if(typeof WeakMap!="function")return null;var H=new WeakMap,q=new WeakMap;return(V=function(Q){return Q?q:H})(U)}function P(U,H){if(!H&&U&&U.__esModule)return U;if(U===null||h(U)!=="object"&&typeof U!="function")return{default:U};var q=V(H);if(q&&q.has(U))return q.get(U);var te={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in U)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(U,Z)){var ae=Q?Object.getOwnPropertyDescriptor(U,Z):null;ae&&(ae.get||ae.set)?Object.defineProperty(te,Z,ae):te[Z]=U[Z]}return te.default=U,q&&q.set(U,te),te}function L(U){var H=E();return function(){var q=(0,g.default)(U),te;if(H){var Q=(0,g.default)(this).constructor;te=Reflect.construct(q,arguments,Q)}else te=q.apply(this,arguments);return(0,p.default)(this,te)}}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var b=new B.default("EPSG:4326"),_,x="";document.documentElement.style.transform!==void 0?x="transform":document.documentElement.style.webkitTransform!==void 0?x="webkitTransform":document.documentElement.style.mozTransform!==void 0?x="mozTransform":document.documentElement.style.oTransform!==void 0?x="oTransform":x="transform";var T=function(U){(0,y.default)(q,U);var H=L(q);function q(){var te,Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Z=arguments.length>1?arguments[1]:void 0,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},F=arguments.length>3?arguments[3]:void 0;if((0,R.default)(this,q),Z==null)throw new Error("coordinates are mandatory to add a Label");te=H.call(this);var W=te.visible;return Object.defineProperty((0,v.default)(te),"visible",{set:function(X){X!=W&&(W=X,this.content.style.display=X?"block":"none")},get:function(){return W}}),te.isLabel=!0,te.coordinates=Z,te.projectedPosition={x:0,y:0},te.boundaries={left:0,right:0,top:0,bottom:0},typeof Q=="string"?(te.content=document.createElement("div"),te.content.textContent=Q):te.content=Q.cloneNode(!0),te.content.classList.add("itowns-label"),te.content.style.userSelect="none",te.content.style.position="absolute",te.baseContent=Q,ae.isStyle?(te.anchor=ae.getTextAnchorPosition(),te.styleOffset=ae.text.offset,typeof Q=="string"&&(ae.text.haloWidth>0&&te.content.classList.add("itowns-stroke-single"),ae.applyToHTML(te.content,F))):(te.anchor=[0,0],te.styleOffset=[0,0]),te.icon=te.content.getElementsByClassName("itowns-icon")[0],te.iconOffset={left:0,right:0,top:0,bottom:0},te.zoom={min:ae.zoom&&ae.zoom.min!=null?ae.zoom.min:2,max:ae.zoom&&ae.zoom.max!=null?ae.zoom.max:24},te.order=ae.order||0,te.padding=2,te}return(0,M.default)(q,[{key:"updateProjectedPosition",value:function(Q,Z){var ae=Math.round(Q),F=Math.round(Z);(ae!=this.projectedPosition.x||F!=this.projectedPosition.y)&&(this.projectedPosition.x=ae,this.projectedPosition.y=F,this.boundaries.left=Q+this.offset.left-this.padding,this.boundaries.right=Q+this.offset.right+this.padding,this.boundaries.top=Z+this.offset.top-this.padding,this.boundaries.bottom=Z+this.offset.bottom+this.padding,(this.iconOffset.left!==0||this.iconOffset.right!==0||this.iconOffset.top!==0||this.iconOffset.bottom!==0)&&(this.boundaries.left=Math.min(this.boundaries.left,Q+this.iconOffset.left),this.boundaries.right=Math.max(this.boundaries.right,Q+this.iconOffset.right),this.boundaries.top=Math.min(this.boundaries.top,Z+this.iconOffset.top),this.boundaries.bottom=Math.max(this.boundaries.bottom,Z+this.iconOffset.bottom)))}},{key:"updateCSSPosition",value:function(){this.content.style[x]="translate(".concat(this.projectedPosition.x+this.offset.left,"px, ").concat(this.projectedPosition.y+this.offset.top,"px)"),this.icon&&(this.icon.style[x]="translate(".concat(-this.offset.left,"px, ").concat(-this.offset.top,"px)"))}},{key:"initDimensions",value:function(){if(!this.offset){_=this.content.getBoundingClientRect();var Q=Math.round(_.width),Z=Math.round(_.height);this.offset={left:Q*this.anchor[0]+this.styleOffset[0],top:Z*this.anchor[1]+this.styleOffset[1]},this.offset.right=this.offset.left+Q,this.offset.bottom=this.offset.top+Z,this.icon&&(_=this.icon.getBoundingClientRect(),this.iconOffset={left:Math.floor(_.x),top:Math.floor(_.y),right:Math.ceil(_.x+_.width),bottom:Math.ceil(_.y+_.height)})}}},{key:"update3dPosition",value:function(Q){this.coordinates.as(Q,b),b.toVector3(this.position),this.parent.worldToLocal(this.position),this.updateMatrixWorld()}},{key:"updateElevationFromLayer",value:function(Q){var Z=Math.max(0,D.default.getElevationValueAt(Q,this.coordinates,D.default.FAST_READ_Z));if(Z&&Z!=this.coordinates.z)return this.coordinates.z=Z,this.updateHorizonCullingPoint(),!0}},{key:"updateHorizonCullingPoint",value:function(){this.horizonCullingPoint&&this.getWorldPosition(this.horizonCullingPoint)}}]),q}(C.Object3D),N=T;a.default=N}(rw)),rw}var IT;function cC(){return IT||(IT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=x(Dr()),C=u(l2()),D=u(JM()),B=u(id()),V=u(Zi()),P=u(ya()),L=u(lC()),E=Uf(),b=I0();function _(Q){if(typeof WeakMap!="function")return null;var Z=new WeakMap,ae=new WeakMap;return(_=function(W){return W?ae:Z})(Q)}function x(Q,Z){if(!Z&&Q&&Q.__esModule)return Q;if(Q===null||h(Q)!=="object"&&typeof Q!="function")return{default:Q};var ae=_(Z);if(ae&&ae.has(Q))return ae.get(Q);var F={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in Q)if(O!=="default"&&Object.prototype.hasOwnProperty.call(Q,O)){var X=W?Object.getOwnPropertyDescriptor(Q,O):null;X&&(X.get||X.set)?Object.defineProperty(F,O,X):F[O]=Q[O]}return F.default=Q,ae&&ae.set(Q,F),F}function T(Q){var Z=N();return function(){var ae=(0,p.default)(Q),F;if(Z){var W=(0,p.default)(this).constructor;F=Reflect.construct(ae,arguments,W)}else F=ae.apply(this,arguments);return(0,y.default)(this,F)}}function N(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var U=new V.default("EPSG:4326",0,0,0),H=new P.default("EPSG:4326",0,0,0,0),q=function(Q){(0,v.default)(ae,Q);var Z=T(ae);function ae(F){var W,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,R.default)(this,ae),W=Z.call(this,F,O),W.isLabelLayer=!0,W.domElement=document.createElement("div"),W.domElement.id="itowns-label-".concat(W.id),W.defineLayerProperty("visible",!0,function(){W.domElement.style.display=W.visible?"block":"none"}),W.buildExtent=!0,W.labelDomelement=O.domElement,W.margin=O.margin,W}return(0,M.default)(ae,[{key:"convert",value:function(W,O){var X=this,G=[],j=this.style&&this.style.text&&this.style.text.field;O.as(W.crs,H),U.crs=W.crs;var K={zoom:O.zoom};return W.features.forEach(function(ce){if(ce.type===E.FEATURE_TYPES.POINT){var se=ce.style&&ce.style.text.field;ce.geometries.forEach(function(ue){if(U.setFromArray(ce.vertices,ue.size*ue.indices[0].offset),U.applyMatrix4(W.matrixWorld),ce.size==2&&(U.z=0),!!H.isPointInside(U)){var Y=ue.properties.style&&ue.properties.style.text.field,pe,Ee={globals:K,properties:function(){return ue.properties}};if(X.labelDomelement)pe=(0,b.readExpression)(X.labelDomelement,Ee);else if(!Y&&!se&&!j){if(!(ue.properties.style&&(ue.properties.style.icon.source||ue.properties.style.icon.key))&&!(ce.style&&(ce.style.icon.source||ce.style.icon.key))&&!(X.style&&(X.style.icon.source||X.style.icon.key)))return}else Y?pe=ue.properties.style.getTextFromProperties(Ee):se?pe=ce.style.getTextFromProperties(Ee):j&&(pe=X.style.getTextFromProperties(Ee));var Fe=(ue.properties.style||ce.style||X.style).symbolStylefromContext(Ee),$e=new L.default(pe,U.clone(),Fe,X.source.sprites);$e.layerId=X.id,$e.padding=X.margin||$e.padding,ce.size==2&&($e.needsAltitude=!0),G.push($e)}})}}),G}},{key:"preUpdate",value:function(){}},{key:"update",value:function(W,O,X,G){var j=this;if(!G&&X.children.length){D.default.removeChildrenAndCleanupRecursively(this,X);return}if(!(this.frozen||!X.visible||!this.visible)){var K=X.getExtentsByProjection(this.source.crs)||[X.extent],ce=K[0].zoom;if(!(ce<O.zoom.min||ce>O.zoom.max)){X.layerUpdateState[this.id]===void 0&&(X.layerUpdateState[this.id]=new C.default);var se=X.material.getElevationLayer();if(se&&X.layerUpdateState[se.id].canTryUpdate()&&X.children.forEach(function(Y){Y.isLabel&&Y.needsAltitude&&Y.updateElevationFromLayer(j.parent)&&Y.update3dPosition(W.view.referenceCrs)}),X.layerUpdateState[this.id].canTryUpdate()){if(!this.source.extentInsideLimit(X.extent,ce)){X.layerUpdateState[this.id].noMoreUpdatePossible();return}}else return;X.layerUpdateState[this.id].newTry();var ue={layer:this,extentsSource:K,view:W.view,threejsLayer:this.threejsLayer,requester:X};return W.scheduler.execute(ue).then(function(Y){if(!!Y){var pe=W.view.mainLoop.gfxEngine.label2dRenderer,Ee=[];if(Y.forEach(function(Ue){if(!X.parent){Ue.forEach(function(Je){D.default.removeChildrenAndCleanupRecursively(j,Je),pe.removeLabelDOM(Je)});return}Ue.forEach(function(Je){Je.needsAltitude&&Je.updateElevationFromLayer(j.parent);var et=X.children.find(function(ze){return ze.isLabel&&ze.baseContent==Je.baseContent});et||(X.add(Je),Je.update3dPosition(W.view.referenceCrs),X.level<4&&(Je.horizonCullingPoint=new g.Vector3,Je.updateHorizonCullingPoint()),Ee.push(Je.content))})}),Ee.length>0){var Fe,$e=X.domElements[j.id];$e||($e={dom:document.createElement("div"),visible:!0},X.domElements[j.id]=$e),(Fe=$e.dom).append.apply(Fe,Ee);var pt=X.findClosestDomElement(j.id);(pt&&pt.dom||j.domElement).appendChild($e.dom),$e.visible=!0,Y.forEach(function(Ue){return Ue.forEach(function(Je){return Je.initDimensions()})}),Y.forEach(function(Ue){return Ue.forEach(function(Je){Je.visible=!1})}),X.children.sort(function(Ue){return Ue.isLabel?-Ue.order:1}),X.addEventListener("removed",function(){Y.forEach(function(Ue){return Ue.forEach(function(Je){return X.remove(Je)})}),j.removeNodeDomElement(X)})}X.layerUpdateState[j.id].noMoreUpdatePossible()}})}}}},{key:"removeLabelsFromNodeRecursive",value:function(W){var O=this;W.children.forEach(function(X){X.isLabel&&X.layerId===O.id?W.remove(X):X.isTileMesh&&O.removeLabelsFromNodeRecursive(X)}),this.removeNodeDomElement(W)}},{key:"removeNodeDomElement",value:function(W){if(W.domElements[this.id]){var O=W.domElements[this.id].dom;O.parentElement.removeChild(O),delete W.domElements[this.id]}}},{key:"delete",value:function(){var W=this;this.domElement.parentElement.removeChild(this.domElement),this.parent.level0Nodes.forEach(function(O){return W.removeLabelsFromNodeRecursive(O)})}}]),ae}(B.default),te=q;a.default=te}(KA)),KA}var kT;function iv(){return kT||(kT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.VIEW_EVENTS=void 0;var R=u(Qh()),M=u(Ir()),v=u(kr()),y=u(Wi()),p=u(dn()),g=u(pn()),C=u(ln()),D=u(Kh()),B=u(O0()),V=ae(Dr()),P=u(ZR()),L=ae(ed()),E=u(td()),b=aC(),_=u(HF()),x=u(WM()),T=u(ps()),N=u(Zi()),U=u(sC()),H=rd(),q=u(sI()),te=u(u2()),Q=u(cC());function Z(Ge){if(typeof WeakMap!="function")return null;var Ae=new WeakMap,Se=new WeakMap;return(Z=function(me){return me?Se:Ae})(Ge)}function ae(Ge,Ae){if(!Ae&&Ge&&Ge.__esModule)return Ge;if(Ge===null||h(Ge)!=="object"&&typeof Ge!="function")return{default:Ge};var Se=Z(Ae);if(Se&&Se.has(Ge))return Se.get(Ge);var Te={},me=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var be in Ge)if(be!=="default"&&Object.prototype.hasOwnProperty.call(Ge,be)){var we=me?Object.getOwnPropertyDescriptor(Ge,be):null;we&&(we.get||we.set)?Object.defineProperty(Te,be,we):Te[be]=Ge[be]}return Te.default=Ge,Se&&Se.set(Ge,Te),Te}function F(Ge,Ae){var Se=typeof Symbol<"u"&&Ge[Symbol.iterator]||Ge["@@iterator"];if(!Se){if(Array.isArray(Ge)||(Se=W(Ge))||Ae&&Ge&&typeof Ge.length=="number"){Se&&(Ge=Se);var Te=0,me=function(){};return{s:me,n:function(){return Te>=Ge.length?{done:!0}:{done:!1,value:Ge[Te++]}},e:function(ot){throw ot},f:me}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var be=!0,we=!1,je;return{s:function(){Se=Se.call(Ge)},n:function(){var ot=Se.next();return be=ot.done,ot},e:function(ot){we=!0,je=ot},f:function(){try{!be&&Se.return!=null&&Se.return()}finally{if(we)throw je}}}}function W(Ge,Ae){if(!!Ge){if(typeof Ge=="string")return O(Ge,Ae);var Se=Object.prototype.toString.call(Ge).slice(8,-1);if(Se==="Object"&&Ge.constructor&&(Se=Ge.constructor.name),Se==="Map"||Se==="Set")return Array.from(Ge);if(Se==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Se))return O(Ge,Ae)}}function O(Ge,Ae){(Ae==null||Ae>Ge.length)&&(Ae=Ge.length);for(var Se=0,Te=new Array(Ae);Se<Ae;Se++)Te[Se]=Ge[Se];return Te}function X(Ge){var Ae=G();return function(){var Se=(0,C.default)(Ge),Te;if(Ae){var me=(0,C.default)(this).constructor;Te=Reflect.construct(Se,arguments,me)}else Te=Se.apply(this,arguments);return(0,g.default)(this,Te)}}function G(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function j(Ge,Ae,Se){K(Ge,Ae),Ae.set(Ge,Se)}function K(Ge,Ae){if(Ae.has(Ge))throw new TypeError("Cannot initialize the same private elements twice on an object")}var ce={LAYERS_INITIALIZED:"layers-initialized",LAYER_REMOVED:"layer-removed",LAYER_ADDED:"layer-added",INITIALIZED:"initialized",COLOR_LAYERS_ORDER_CHANGED:b.COLOR_LAYERS_ORDER_CHANGED,CAMERA_MOVED:"camera-moved"};a.VIEW_EVENTS=ce;var se=function(Ge,Ae){Ge.object3d&&(Ge.object3d.visible=Ge.visible),Ge.threejsLayer&&(Ge.visible?Ae.camera.camera3D.layers.enable(Ge.threejsLayer):Ae.camera.camera3D.layers.disable(Ge.threejsLayer))};function ue(Ge,Ae,Se){var Te=Ae.source;if(Se&&!Ae.extent&&(Ae.extent=Se.extent,Te&&!Te.extent&&(Te.extent=Se.extent)),Ae.isGeometryLayer?(Se&&(Ae.threejsLayer=Ge.mainLoop.gfxEngine.getUniqueThreejsLayer()),Ae.defineLayerProperty("visible",!0,function(){return se(Ae,Ge)}),se(Ae,Ge),Ae.crs=Ge.referenceCrs):Ae.crs||(Se&&Se.tileMatrixSets&&Se.tileMatrixSets.includes(T.default.formatToTms(Te.crs))?Ae.crs=Te.crs:Ae.crs=Se&&Se.extent.crs),Ae.isLabelLayer)Ge.mainLoop.gfxEngine.label2dRenderer.registerLayer(Ae);else if(Ae.labelEnabled||Ae.addLabelLayer){Ae.labelEnabled&&console.info("layer.labelEnabled is deprecated use addLabelLayer, instead of"),Ae.buildExtent=!0;var me=new Q.default("".concat(Ae.id,"-label"),{source:Te,style:Ae.style,zoom:Ae.zoom,crs:Te.crs,visible:Ae.visible,margin:15});Ae.addEventListener("visible-property-changed",function(){me.visible=Ae.visible});var be=function(we){we.layerId===Ae.id&&Ge.removeLayer(me.id),Ge.removeEventListener(ce.LAYER_REMOVED,be)};Ge.addEventListener(ce.LAYER_REMOVED,be),Ae.whenReady=Ae.whenReady.then(function(){return Ge.addLayer(me),Ae})}return Ae}var Y=new V.Vector2,pe=new V.Matrix4,Ee=new V.Vector2,Fe=new V.Ray,$e=new V.Vector3,pt=new V.Vector3,Ue=new N.default("EPSG:4326"),Je=[],et,ze=new WeakMap,Xe=new WeakMap,tt=new WeakMap,ye=function(Ge){(0,p.default)(Se,Ge);var Ae=X(Se);function Se(Te,me){var be,we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if((0,M.default)(this,Se),!me)throw new Error("Invalid viewerDiv parameter (must non be null/undefined)");be=Ae.call(this),j((0,y.default)(be),ze,{writable:!0,value:[]}),j((0,y.default)(be),Xe,{writable:!0,value:new Uint8Array(4)}),j((0,y.default)(be),tt,{writable:!0,value:void 0}),be.domElement=me,be.referenceCrs=Te;var je;we.renderer&&we.renderer.domElement?je=new _.default(we.renderer):je=new _.default(me,we.renderer),be.mainLoop=we.mainLoop||new L.default(new q.default,je),be.scene=we.scene3D||new V.Scene,we.scene3D||(be.scene.autoUpdate=!1),be.camera=new P.default(be.referenceCrs,be.mainLoop.gfxEngine.getWindowSize().x,be.mainLoop.gfxEngine.getWindowSize().y,we.camera),be._frameRequesters={},window.addEventListener("resize",function(){return be.resize()},!1),be._changeSources=new Set,be._delayedFrameRequesterRemoval=[],be._allLayersAreReadyCallback=function(){var bt=be.getLayers().every(function(Ie){return Ie.ready});bt&&be.mainLoop.scheduler.commandsWaitingExecutionCount()==0&&be.mainLoop.renderingState==L.RENDERING_PAUSED&&(be.dispatchEvent({type:ce.LAYERS_INITIALIZED}),be.removeFrameRequester(L.MAIN_LOOP_EVENTS.UPDATE_END,be._allLayersAreReadyCallback))},be.camera.resize(be.domElement.clientWidth,be.domElement.clientHeight);var lt=function(){be.removeEventListener(ce.LAYERS_INITIALIZED,lt),be.dispatchEvent({type:ce.INITIALIZED})};be.addEventListener(ce.LAYERS_INITIALIZED,lt),(0,B.default)((0,y.default)(be),tt,new Uint8Array(4*be.camera.width*be.camera.height)),be.domElement.tabIndex=-1,we.disableFocusOnStart||be.domElement.focus();var ot;return be.domElement.addEventListener("mouseup",function(bt){bt.button===2&&(ot&&bt.timeStamp-ot<500&&be.domElement.dispatchEvent(new MouseEvent("dblclick-right",bt)),ot=bt.timeStamp)}),Je.push((0,y.default)(be)),be}return(0,v.default)(Se,[{key:"dispose",value:function(){var me=Je.indexOf(this);if(me==-1){console.warn("View already disposed");return}this.controls&&this.controls.dispose&&this.controls.dispose(),this.removeAllFrameRequesters(),this.removeAllEvents();var be=this.getLayers(function(Be){return!Be.isTiledGeometryLayer&&!Be.isAtmosphere}),we=F(be),je;try{for(we.s();!(je=we.n()).done;){var lt=je.value;this.removeLayer(lt.id)}}catch(Be){we.e(Be)}finally{we.f()}var ot=this.getLayers(function(Be){return Be.isAtmosphere}),bt=F(ot),Ie;try{for(bt.s();!(Ie=bt.n()).done;){var re=Ie.value;this.removeLayer(re.id)}}catch(Be){bt.e(Be)}finally{bt.f()}var oe=this.getLayers(function(Be){return Be.isTiledGeometryLayer}),_e=F(oe),Re;try{for(_e.s();!(Re=_e.n()).done;){var ke=Re.value;this.removeLayer(ke.id)}}catch(Be){_e.e(Be)}finally{_e.f()}Je.splice(me,1)}},{key:"addLayer",value:function(me,be){var we=this;if(!me||!me.isLayer)return Promise.reject(new Error("Add Layer type object"));var je=this.getLayerById(me.id);if(je)return me._reject(new Error("Invalid id '".concat(me.id,"': id already used")));if(me=ue(this,me,be),be)if(me.isColorLayer){var lt=this.getLayers(function(bt){return bt.isColorLayer});me.sequence=lt.length;var ot=be.countColorLayersTextures.apply(be,(0,R.default)(lt).concat([me]));if(ot<=(0,H.getMaxColorSamplerUnitsCount)())be.attach(me);else return me._reject(new Error("Cant add color layer ".concat(me.id,": the maximum layer is reached")))}else me.isElevationLayer&&me.source.format=="image/x-bil;bits=32"&&(me.source.networkOptions.isWebGL2=this.mainLoop.gfxEngine.renderer.capabilities.isWebGL2),be.attach(me);else{if(typeof me.update!="function")return me._reject(new Error("Cant add GeometryLayer: missing a update function"));if(typeof me.preUpdate!="function")return me._reject(new Error("Cant add GeometryLayer: missing a preUpdate function"));(0,D.default)(this,ze).push(me)}return me.object3d&&!me.object3d.parent&&me.object3d!==this.scene&&this.scene.add(me.object3d),Promise.all(me._promises).then(function(){me._resolve(),we.notifyChange(be||me,!1),(!we._frameRequesters[L.MAIN_LOOP_EVENTS.UPDATE_END]||!we._frameRequesters[L.MAIN_LOOP_EVENTS.UPDATE_END].includes(we._allLayersAreReadyCallback))&&we.addFrameRequester(L.MAIN_LOOP_EVENTS.UPDATE_END,we._allLayersAreReadyCallback),we.dispatchEvent({type:ce.LAYER_ADDED,layerId:me.id})},me._reject),me.whenReady}},{key:"removeLayer",value:function(me){var be=this.getLayerById(me);if(be){var we=be.parent;if(be.delete(),we&&!we.detach(be))throw new Error("Error to detach ".concat(me," from ").concat(we.id));if(we==null&&(0,D.default)(this,ze).splice((0,D.default)(this,ze).findIndex(function(Re){return Re.id==me}),1),be.isColorLayer){var je=this.getLayers(function(Re){return Re.isColorLayer}),lt=F(je),ot;try{for(lt.s();!(ot=lt.n()).done;){var bt=ot.value;bt.sequence>be.sequence&&bt.sequence--}}catch(Re){lt.e(Re)}finally{lt.f()}}var Ie=0,re=F(Je),oe;try{for(re.s();!(oe=re.n()).done;){var _e=oe.value;Ie+=_e.getLayers(function(Re){return Re.source.uid==be.source.uid&&Re.crs==be.crs}).length}}catch(Re){re.e(Re)}finally{re.f()}return be.source.onLayerRemoved({unusedCrs:Ie==0?be.crs:void 0}),this.notifyChange(this.camera),this.dispatchEvent({type:ce.LAYER_REMOVED,layerId:me}),!0}else throw new Error("".concat(me," doesn't exist"))}},{key:"notifyChange",value:function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;me&&(this._changeSources.add(me),(me.isTileMesh||me.isCamera)&&((0,D.default)(this,tt).needsUpdate=!0)),this.mainLoop.scheduleViewUpdate(this,be)}},{key:"getLayers",value:function(me){var be=[],we=F((0,D.default)(this,ze)),je;try{for(we.s();!(je=we.n()).done;){var lt=je.value;if((!me||me(lt))&&be.push(lt),lt.attachedLayers){var ot=F(lt.attachedLayers),bt;try{for(ot.s();!(bt=ot.n()).done;){var Ie=bt.value;(!me||me(Ie,lt))&&be.push(Ie)}}catch(re){ot.e(re)}finally{ot.f()}}}}catch(re){we.e(re)}finally{we.f()}return be}},{key:"getLayerById",value:function(me){return this.getLayers(function(be){return be.id===me})[0]}},{key:"addFrameRequester",value:function(me,be){if(typeof be!="function")throw new Error("frameRequester must be a function");this._frameRequesters[me]?this._frameRequesters[me].push(be):this._frameRequesters[me]=[be]}},{key:"removeFrameRequester",value:function(me,be){this._frameRequesters[me].includes(be)?this._delayedFrameRequesterRemoval.push({when:me,frameRequester:be}):console.error("Invalid call to removeFrameRequester: frameRequester isn't registered")}},{key:"removeAllFrameRequesters",value:function(){for(var me in this._frameRequesters)if(Object.prototype.hasOwnProperty.call(this._frameRequesters,me)){var be=this._frameRequesters[me],we=F(be),je;try{for(we.s();!(je=we.n()).done;){var lt=je.value;this.removeFrameRequester(me,lt)}}catch(ot){we.e(ot)}finally{we.f()}}this._executeFrameRequestersRemovals()}},{key:"removeAllEvents",value:function(){if(this._listeners!==void 0){for(var me in this._listeners)Object.prototype.hasOwnProperty.call(this._listeners,me)&&delete this._listeners[me];this._listeners=void 0}}},{key:"_executeFrameRequestersRemovals",value:function(){var me=F(this._delayedFrameRequesterRemoval),be;try{for(me.s();!(be=me.n()).done;){var we=be.value,je=this._frameRequesters[we.when].indexOf(we.frameRequester);je>=0?this._frameRequesters[we.when].splice(je,1):console.warn("FrameReq has already been removed")}}catch(lt){me.e(lt)}finally{me.f()}this._delayedFrameRequesterRemoval.length=0}},{key:"execFrameRequesters",value:function(me,be,we){if(!!this._frameRequesters[me]){this._delayedFrameRequesterRemoval.length>0&&this._executeFrameRequestersRemovals();for(var je=arguments.length,lt=new Array(je>3?je-3:0),ot=3;ot<je;ot++)lt[ot-3]=arguments[ot];var bt=F(this._frameRequesters[me]),Ie;try{for(bt.s();!(Ie=bt.n()).done;){var re=Ie.value;re.update?re.update(be,we,lt):re(be,we,lt)}}catch(oe){bt.e(oe)}finally{bt.f()}}}},{key:"eventToViewCoords",value:function(me){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y,we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,je=this.domElement.getBoundingClientRect();if(me.touches&&me.touches.length)return be.set(me.touches[we].clientX-je.x,me.touches[we].clientY-je.y);if(me.offsetX!==void 0&&me.offsetY!==void 0){var lt=me.target.getBoundingClientRect();return be.set(lt.x+me.offsetX-je.x,lt.y+me.offsetY-je.y)}}},{key:"eventToNormalizedCoords",value:function(me){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this.viewToNormalizedCoords(this.eventToViewCoords(me,Y,be))}},{key:"viewToNormalizedCoords",value:function(me){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y;return be.x=2*(me.x/this.camera.width)-1,be.y=-2*(me.y/this.camera.height)+1,be}},{key:"normalizedToViewCoords",value:function(me){return Y.x=(me.x+1)*.5*this.camera.width,Y.y=(me.y-1)*-.5*this.camera.height,Y}},{key:"pickObjectsAt",value:function(me){for(var be=this,we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,je=arguments.length,lt=new Array(je>2?je-2:0),ot=2;ot<je;ot++)lt[ot-2]=arguments[ot];var bt=[];if(lt=lt.length==0?this.getLayers(function(ke){return ke.isGeometryLayer}):lt,lt.forEach(function(ke){typeof ke=="string"&&(ke=be.getLayerById(ke)),ke&&(ke.isGeometryLayer||ke.isObject3D)&&bt.push(ke)}),bt.length==0)return[];for(var Ie=[],re=me instanceof Event?this.eventToViewCoords(me):me,oe=0,_e=bt;oe<_e.length;oe++){var Re=_e[oe];if(Re.isGeometryLayer){if(!Re.ready){console.warn("view.pickObjectAt : layer is not ready : ",Re);continue}Re.pickObjectsAt(this,re,we,Ie)}else te.default.pickObjectsAt(this,re,we,Re,Ie)}return Ie}},{key:"getScale",value:function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.28;return this.camera.camera3D.isOrthographicCamera?me*.001/this.getPixelsToMeters():this.getScaleFromDistance(me,this.getDistanceFromCamera())}},{key:"getScaleFromDistance",value:function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.28,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;me/=1e3;var we=V.MathUtils.degToRad(this.camera.camera3D.fov),je=this.camera.height/(2*be*Math.tan(we*.5));return me*je}},{key:"getDistanceFromCamera",value:function(me){return this.getPickingPositionFromDepth(me,pt),this.camera.camera3D.position.distanceTo(pt)}},{key:"getPixelsToMeters",value:function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,be=arguments.length>1?arguments[1]:void 0;return this.camera.camera3D.isOrthographicCamera?(et=(this.camera.camera3D.right-this.camera.camera3D.left)/this.camera.camera3D.zoom,me*et/this.camera.width):this.getPixelsToMetersFromDistance(me,this.getDistanceFromCamera(be))}},{key:"getPixelsToMetersFromDistance",value:function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return me*be/this.camera._preSSE}},{key:"getMetersToPixels",value:function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,be=arguments.length>1?arguments[1]:void 0;return this.camera.camera3D.isOrthographicCamera?(et=(this.camera.camera3D.right-this.camera.camera3D.left)/this.camera.camera3D.zoom,me*this.camera.width/et):this.getMetersToPixelsFromDistance(me,this.getDistanceFromCamera(be))}},{key:"getMetersToPixelsFromDistance",value:function(){var me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this.camera._preSSE*me/be}},{key:"pickFeaturesAt",value:function(me){for(var be=this,we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,je=arguments.length,lt=new Array(je>2?je-2:0),ot=2;ot<je;ot++)lt[ot-2]=arguments[ot];Array.isArray(lt[0])&&(console.warn("Deprecated: the ...where argument of View#pickFeaturesAt should not be an array anymore, but a list: use the spread operator if needed."),lt=lt[0]);var bt=[],Ie={};lt=lt.length==0?this.getLayers(function(Dt){return Dt.isColorLayer||Dt.isGeometryLayer}):lt,lt.forEach(function(Dt){typeof Dt=="string"&&(Dt=be.getLayerById(Dt)),Dt&&Dt.isLayer&&(Ie[Dt.id]=[],Dt.isColorLayer&&bt.push(Dt.id))});var re=me instanceof Event?this.eventToViewCoords(me,Y):me,oe=this.pickObjectsAt.apply(this,[re,we].concat((0,R.default)(lt)));if(oe.length>0&&oe.forEach(function(Dt){return Ie[Dt.layer.id].push(Dt)}),bt.length==0)return Ie;this.getPickingPositionFromDepth(re,pt),Ue.crs=this.referenceCrs,Ue.setFromVector3(pt);var _e,Re={M:this.getPixelsToMeters(we,re),D:.001*we};this.isPlanarView?Re.D=Re.M:this.getPixelsToDegrees&&(Re.D=this.getMetersToDegrees(Re.M));var ke=te.default.pickTilesAt(this,re,we,this.tileLayer),Be=F(ke),at;try{for(Be.s();!(at=Be.n()).done;){var wt=at.value;if(!!wt.object.material){var ht=F(wt.object.material.getLayers(bt)),_t;try{for(ht.s();!(_t=ht.n()).done;){var St=_t.value,Ct=F(St.textures),vt;try{for(Ct.s();!(vt=Ct.n()).done;){var ct=vt.value;!ct.features||(_e=T.default.isMetricUnit(ct.features.crs)?Re.M:Re.D,Ie[St.id]=Ie[St.id].concat(U.default.filterFeaturesUnderCoordinate(Ue,ct.features,_e)))}}catch(Dt){Ct.e(Dt)}finally{Ct.f()}}}catch(Dt){ht.e(Dt)}finally{ht.f()}}}}catch(Dt){Be.e(Dt)}finally{Be.f()}return Ie}},{key:"readDepthBuffer",value:function(me,be,we,je,lt){var ot=this.mainLoop.gfxEngine,bt=this.tileLayer.wireframe,Ie=this.tileLayer.opacity,re=this.tileLayer.visible;bt&&(this.tileLayer.wireframe=!1),Ie<1&&(this.tileLayer.opacity=1),re||(this.tileLayer.visible=!0);var oe=this.tileLayer.level0Nodes.map(function(_e){return x.default.push(_e,x.default.MODES.DEPTH)});return lt=ot.renderViewToBuffer({camera:this.camera,scene:this.tileLayer.object3d},{x:me,y:be,width:we,height:je,buffer:lt}),oe.forEach(function(_e){return _e()}),this.tileLayer.wireframe!==bt&&(this.tileLayer.wireframe=bt),this.tileLayer.opacity!==Ie&&(this.tileLayer.opacity=Ie),this.tileLayer.visible!==re&&(this.tileLayer.visible=re),lt}},{key:"getPickingPositionFromDepth",value:function(me){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new V.Vector3;if(!this.tileLayer||this.tileLayer.level0Nodes.length==0||!this.tileLayer.level0Nodes[0]){be=void 0;return}var we=this.mainLoop,je=we.scheduler.commandsWaitingExecutionCount()==0&&we.renderingState==L.RENDERING_PAUSED,lt=we.gfxEngine,ot=lt.getWindowSize(),bt=this.camera.camera3D;me=me||ot.clone().multiplyScalar(.5),me.x=Math.floor(me.x),me.y=Math.floor(me.y);var Ie=bt.layers.mask;bt.layers.mask=1<<this.tileLayer.threejsLayer;var re;if(je){(0,D.default)(this,tt).needsUpdate&&(this.readDepthBuffer(0,0,ot.x,ot.y,(0,D.default)(this,tt)),(0,D.default)(this,tt).needsUpdate=!1);var oe=((ot.y-me.y-1)*ot.x+me.x)*4;re=(0,D.default)(this,tt).slice(oe,oe+4)}else re=this.readDepthBuffer(me.x,me.y,1,1,(0,D.default)(this,Xe));if(Ee.x=me.x/ot.x*2-1,Ee.y=-(me.y/ot.y)*2+1,E.default.isLogDepthBufferSupported()&&bt.type=="PerspectiveCamera"){Fe.origin.copy(bt.position),Fe.direction.set(Ee.x,Ee.y,.5),pe.multiplyMatrices(bt.matrixWorld,pe.copy(bt.projectionMatrix).invert()),Fe.direction.applyMatrix4(pe),Fe.direction.sub(Fe.origin),$e.set(0,0,1),$e.applyMatrix4(pe),$e.sub(Fe.origin);var _e=$e.angleTo(Fe.direction),Re=lt.depthBufferRGBAValueToOrthoZ(re,bt),ke=Re/Math.cos(_e);be.addVectors(bt.position,Fe.direction.setLength(ke))}else{var Be=lt.depthBufferRGBAValueToOrthoZ(re,bt);be.set(Ee.x,Ee.y,Be),be.unproject(bt)}if(bt.layers.mask=Ie,!(be.length()>1e7))return be}},{key:"pickCoordinates",value:function(me){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new N.default(this.tileLayer.extent.crs);return me instanceof Event?this.eventToViewCoords(me):me&&me.x!==void 0&&me.y!==void 0?Y.copy(me):Y.set(this.mainLoop.gfxEngine.width/2,this.mainLoop.gfxEngine.height/2),this.getPickingPositionFromDepth(Y,pt),Ue.crs=this.referenceCrs,Ue.setFromVector3(pt),Ue.as(be.crs,be),be}},{key:"resize",value:function(me,be){me==null&&(me=this.domElement.clientWidth),be==null&&(be=this.domElement.clientHeight),(0,B.default)(this,tt,new Uint8Array(4*me*be)),this.mainLoop.gfxEngine.onWindowResize(me,be),this.camera.resize(me,be),this.notifyChange(this.camera.camera3D)}}]),Se}(V.EventDispatcher),Ze=ye;a.default=Ze}(zx)),zx}var nw={},iw={},DT;function oI(){return DT||(DT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=D(Dr());function C(N){if(typeof WeakMap!="function")return null;var U=new WeakMap,H=new WeakMap;return(C=function(te){return te?H:U})(N)}function D(N,U){if(!U&&N&&N.__esModule)return N;if(N===null||h(N)!=="object"&&typeof N!="function")return{default:N};var H=C(U);if(H&&H.has(N))return H.get(N);var q={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in N)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(N,Q)){var Z=te?Object.getOwnPropertyDescriptor(N,Q):null;Z&&(Z.get||Z.set)?Object.defineProperty(q,Q,Z):q[Q]=N[Q]}return q.default=N,H&&H.set(N,q),q}function B(N){var U=V();return function(){var H=(0,p.default)(N),q;if(U){var te=(0,p.default)(this).constructor;q=Reflect.construct(H,arguments,te)}else q=H.apply(this,arguments);return(0,y.default)(this,q)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P=60,L=1e3/P,E={STOP:0,PLAY:1,END:2,PAUSE:3},b=function(N){N.id&&(clearInterval(N.id),N.id=void 0),N.waitTimer&&(clearInterval(N.waitTimer),N.waitTimer=void 0),N.keyframe=0},_=function(N){b(N),N.isEnded()&&N.dispatchEvent({type:"animation-ended"}),N.dispatchEvent({type:"animation-stopped"}),N.duration=0},x=function(N){(0,v.default)(H,N);var U=B(H);function H(){var q;return(0,R.default)(this,H),q=U.call(this),q.id=null,q.keyframe=0,q.duration=0,q.state=E.STOP,q.waitTimer=null,q.callback=function(){},q}return(0,M.default)(H,[{key:"isPlaying",value:function(){return this.state===E.PLAY}},{key:"isStopped",value:function(){return this.state===E.STOP}},{key:"isEnded",value:function(){return this.state===E.END}},{key:"setCallback",value:function(te){this.callback=te}},{key:"play",value:function(te){this.duration=te,this.dispatchEvent({type:"animation-started"}),this.state=E.PLAY,b(this),this.id=setInterval(this.frame.bind(this),L)}},{key:"playLater",value:function(te,Q){var Z=Math.floor(L*Q);window.clearInterval(this.waitTimer);var ae=this;this.waitTimer=window.setTimeout(function(){ae.play(te)},Z)}},{key:"stop",value:function(){this.state=E.STOP,_(this)}},{key:"frame",value:function(){this.keyframe<this.duration?(this.keyframe++,this.dispatchEvent({type:"animation-frame"}),this.callback()):(this.state=E.END,_(this))}}]),H}(g.EventDispatcher),T=x;a.default=T}(iw)),iw}var aw={},S0={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return .5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return a===0?0:Math.pow(1024,a-1)},Out:function(a){return a===1?1:1-Math.pow(2,-10*a)},InOut:function(a){return a===0?0:a===1?1:(a*=2)<1?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return a===0?0:a===1?1:-Math.pow(2,10*(a-1))*Math.sin((a-1.1)*5*Math.PI)},Out:function(a){return a===0?0:a===1?1:Math.pow(2,-10*a)*Math.sin((a-.1)*5*Math.PI)+1},InOut:function(a){return a===0?0:a===1?1:(a*=2,a<1?-.5*Math.pow(2,10*(a-1))*Math.sin((a-1.1)*5*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin((a-1.1)*5*Math.PI)+1)}},Back:{In:function(a){var u=1.70158;return a*a*((u+1)*a-u)},Out:function(a){var u=1.70158;return--a*a*((u+1)*a+u)+1},InOut:function(a){var u=2.5949095;return(a*=2)<1?.5*(a*a*((u+1)*a-u)):.5*((a-=2)*a*((u+1)*a+u)+2)}},Bounce:{In:function(a){return 1-S0.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return a<.5?S0.Bounce.In(a*2)*.5:S0.Bounce.Out(a*2-1)*.5+.5}}},Zm;typeof self>"u"&&typeof process<"u"&&process.hrtime?Zm=function(){var a=process.hrtime();return a[0]*1e3+a[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Zm=self.performance.now.bind(self.performance):Date.now!==void 0?Zm=Date.now:Zm=function(){return new Date().getTime()};var Ff=Zm,$M=function(){function a(){this._tweens={},this._tweensAddedDuringUpdate={}}return a.prototype.getAll=function(){var u=this;return Object.keys(this._tweens).map(function(h){return u._tweens[h]})},a.prototype.removeAll=function(){this._tweens={}},a.prototype.add=function(u){this._tweens[u.getId()]=u,this._tweensAddedDuringUpdate[u.getId()]=u},a.prototype.remove=function(u){delete this._tweens[u.getId()],delete this._tweensAddedDuringUpdate[u.getId()]},a.prototype.update=function(u,h){u===void 0&&(u=Ff()),h===void 0&&(h=!1);var R=Object.keys(this._tweens);if(R.length===0)return!1;for(;R.length>0;){this._tweensAddedDuringUpdate={};for(var M=0;M<R.length;M++){var v=this._tweens[R[M]],y=!h;v&&v.update(u,y)===!1&&!h&&delete this._tweens[R[M]]}R=Object.keys(this._tweensAddedDuringUpdate)}return!0},a}(),Xh={Linear:function(a,u){var h=a.length-1,R=h*u,M=Math.floor(R),v=Xh.Utils.Linear;return u<0?v(a[0],a[1],R):u>1?v(a[h],a[h-1],h-R):v(a[M],a[M+1>h?h:M+1],R-M)},Bezier:function(a,u){for(var h=0,R=a.length-1,M=Math.pow,v=Xh.Utils.Bernstein,y=0;y<=R;y++)h+=M(1-u,R-y)*M(u,y)*a[y]*v(R,y);return h},CatmullRom:function(a,u){var h=a.length-1,R=h*u,M=Math.floor(R),v=Xh.Utils.CatmullRom;return a[0]===a[h]?(u<0&&(M=Math.floor(R=h*(1+u))),v(a[(M-1+h)%h],a[M],a[(M+1)%h],a[(M+2)%h],R-M)):u<0?a[0]-(v(a[0],a[0],a[1],a[1],-R)-a[0]):u>1?a[h]-(v(a[h],a[h],a[h-1],a[h-1],R-h)-a[h]):v(a[M?M-1:0],a[M],a[h<M+1?h:M+1],a[h<M+2?h:M+2],R-M)},Utils:{Linear:function(a,u,h){return(u-a)*h+a},Bernstein:function(a,u){var h=Xh.Utils.Factorial;return h(a)/h(u)/h(a-u)},Factorial:function(){var a=[1];return function(u){var h=1;if(a[u])return a[u];for(var R=u;R>1;R--)h*=R;return a[u]=h,h}}(),CatmullRom:function(a,u,h,R,M){var v=(h-a)*.5,y=(R-u)*.5,p=M*M,g=M*p;return(2*u-2*h+v+y)*g+(-3*u+3*h-2*v-y)*p+v*M+u}}},c2=function(){function a(){}return a.nextId=function(){return a._nextId++},a._nextId=0,a}(),fC=new $M,hC=function(){function a(u,h){h===void 0&&(h=fC),this._object=u,this._group=h,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=S0.Linear.None,this._interpolationFunction=Xh.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=c2.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return a.prototype.getId=function(){return this._id},a.prototype.isPlaying=function(){return this._isPlaying},a.prototype.isPaused=function(){return this._isPaused},a.prototype.to=function(u,h){return this._valuesEnd=Object.create(u),h!==void 0&&(this._duration=h),this},a.prototype.duration=function(u){return this._duration=u,this},a.prototype.start=function(u){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var h in this._valuesStartRepeat)this._swapEndStartRepeatValues(h),this._valuesStart[h]=this._valuesStartRepeat[h]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=u!==void 0?typeof u=="string"?Ff()+parseFloat(u):u:Ff(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},a.prototype._setupProperties=function(u,h,R,M){for(var v in R){var y=u[v],p=Array.isArray(y),g=p?"array":typeof y,C=!p&&Array.isArray(R[v]);if(!(g==="undefined"||g==="function")){if(C){var D=R[v];if(D.length===0)continue;D=D.map(this._handleRelativeValue.bind(this,y)),R[v]=[y].concat(D)}if((g==="object"||p)&&y&&!C){h[v]=p?[]:{};for(var B in y)h[v][B]=y[B];M[v]=p?[]:{},this._setupProperties(y,h[v],R[v],M[v])}else typeof h[v]>"u"&&(h[v]=y),p||(h[v]*=1),C?M[v]=R[v].slice().reverse():M[v]=h[v]||0}}},a.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},a.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},a.prototype.pause=function(u){return u===void 0&&(u=Ff()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=u,this._group&&this._group.remove(this),this)},a.prototype.resume=function(u){return u===void 0&&(u=Ff()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=u-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},a.prototype.stopChainedTweens=function(){for(var u=0,h=this._chainedTweens.length;u<h;u++)this._chainedTweens[u].stop();return this},a.prototype.group=function(u){return this._group=u,this},a.prototype.delay=function(u){return this._delayTime=u,this},a.prototype.repeat=function(u){return this._initialRepeat=u,this._repeat=u,this},a.prototype.repeatDelay=function(u){return this._repeatDelayTime=u,this},a.prototype.yoyo=function(u){return this._yoyo=u,this},a.prototype.easing=function(u){return this._easingFunction=u,this},a.prototype.interpolation=function(u){return this._interpolationFunction=u,this},a.prototype.chain=function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return this._chainedTweens=u,this},a.prototype.onStart=function(u){return this._onStartCallback=u,this},a.prototype.onUpdate=function(u){return this._onUpdateCallback=u,this},a.prototype.onRepeat=function(u){return this._onRepeatCallback=u,this},a.prototype.onComplete=function(u){return this._onCompleteCallback=u,this},a.prototype.onStop=function(u){return this._onStopCallback=u,this},a.prototype.update=function(u,h){if(u===void 0&&(u=Ff()),h===void 0&&(h=!0),this._isPaused)return!0;var R,M,v=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(u>v)return!1;h&&this.start(u)}if(this._goToEnd=!1,u<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),M=(u-this._startTime)/this._duration,M=this._duration===0||M>1?1:M;var y=this._easingFunction(M);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,y),this._onUpdateCallback&&this._onUpdateCallback(this._object,M),M===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(R in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[R]=="string"&&(this._valuesStartRepeat[R]=this._valuesStartRepeat[R]+parseFloat(this._valuesEnd[R])),this._yoyo&&this._swapEndStartRepeatValues(R),this._valuesStart[R]=this._valuesStartRepeat[R];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=u+this._repeatDelayTime:this._startTime=u+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,g=this._chainedTweens.length;p<g;p++)this._chainedTweens[p].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},a.prototype._updateProperties=function(u,h,R,M){for(var v in R)if(h[v]!==void 0){var y=h[v]||0,p=R[v],g=Array.isArray(u[v]),C=Array.isArray(p),D=!g&&C;D?u[v]=this._interpolationFunction(p,M):typeof p=="object"&&p?this._updateProperties(u[v],y,p,M):(p=this._handleRelativeValue(y,p),typeof p=="number"&&(u[v]=y+(p-y)*M))}},a.prototype._handleRelativeValue=function(u,h){return typeof h!="string"?h:h.charAt(0)==="+"||h.charAt(0)==="-"?u+parseFloat(h):parseFloat(h)},a.prototype._swapEndStartRepeatValues=function(u){var h=this._valuesStartRepeat[u],R=this._valuesEnd[u];typeof R=="string"?this._valuesStartRepeat[u]=this._valuesStartRepeat[u]+parseFloat(R):this._valuesStartRepeat[u]=this._valuesEnd[u],this._valuesEnd[u]=h},a}(),dC="18.6.4",pC=c2.nextId,hl=fC,mC=hl.getAll.bind(hl),vC=hl.removeAll.bind(hl),gC=hl.add.bind(hl),yC=hl.remove.bind(hl),_C=hl.update.bind(hl),QM={Easing:S0,Group:$M,Interpolation:Xh,now:Ff,Sequence:c2,nextId:pC,Tween:hC,VERSION:dC,getAll:mC,removeAll:vC,add:gC,remove:yC,update:_C};const uI=Object.freeze(Object.defineProperty({__proto__:null,default:QM,Easing:S0,Group:$M,Interpolation:Xh,Sequence:c2,Tween:hC,VERSION:dC,add:gC,getAll:mC,nextId:pC,now:Ff,remove:yC,removeAll:vC,update:_C},Symbol.toStringTag,{value:"Module"})),xC=Ky(uI);var sw={},ow={},uw={},NT;function AC(){return NT||(NT=1,function(a){var u=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=g;var h=M(Dr());function R(C){if(typeof WeakMap!="function")return null;var D=new WeakMap,B=new WeakMap;return(R=function(P){return P?B:D})(C)}function M(C,D){if(!D&&C&&C.__esModule)return C;if(C===null||u(C)!=="object"&&typeof C!="function")return{default:C};var B=R(D);if(B&&B.has(C))return B.get(C);var V={},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var L in C)if(L!=="default"&&Object.prototype.hasOwnProperty.call(C,L)){var E=P?Object.getOwnPropertyDescriptor(C,L):null;E&&(E.get||E.set)?Object.defineProperty(V,L,E):V[L]=C[L]}return V.default=C,B&&B.set(C,V),V}function v(C,D){var B=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!B){if(Array.isArray(C)||(B=y(C))||D&&C&&typeof C.length=="number"){B&&(C=B);var V=0,P=function(){};return{s:P,n:function(){return V>=C.length?{done:!0}:{done:!1,value:C[V++]}},e:function(x){throw x},f:P}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,E=!1,b;return{s:function(){B=B.call(C)},n:function(){var x=B.next();return L=x.done,x},e:function(x){E=!0,b=x},f:function(){try{!L&&B.return!=null&&B.return()}finally{if(E)throw b}}}}function y(C,D){if(!!C){if(typeof C=="string")return p(C,D);var B=Object.prototype.toString.call(C).slice(8,-1);if(B==="Object"&&C.constructor&&(B=C.constructor.name),B==="Map"||B==="Set")return Array.from(C);if(B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B))return p(C,D)}}function p(C,D){(D==null||D>C.length)&&(D=C.length);for(var B=0,V=new Array(D);B<D;B++)V[B]=C[B];return V}function g(C){var D={index:null,position:null,normal:null,uvs:[]},B=[],V=C.builder,P=C.segment||8,L=(P+1)*(P+1)+(C.disableSkirt?0:4*P);if(L>Math.pow(2,32))throw new Error("Tile segments count is too big");var E=P*P*2+(C.disableSkirt?0:4*P*2);D.position=new Float32Array(L*3),D.normal=new Float32Array(L*3);var b=C.builder.uvCount;b>1&&(D.uvs[1]=new Float32Array(L)),B[0]=function(){},C.buildIndexAndUv_0&&(L<Math.pow(2,8)?D.index=new Uint8Array(E*3):L<Math.pow(2,16)?D.index=new Uint16Array(E*3):L<Math.pow(2,32)&&(D.index=new Uint32Array(E*3)),D.uvs[0]=new Float32Array(L*2),B[0]=function(Se,Te,me){D.uvs[0][Se*2+0]=Te,D.uvs[0][Se*2+1]=me});var _=Math.max(2,Math.floor(P)||2),x=Math.max(2,Math.floor(P)||2),T=0,N=[],U=[],H=[];V.prepare(C);for(var q=0;q<=x;q++){var te=[],Q=q/x;V.vProjecte(Q,C),b>1&&function(){var Se=V.computeUvs[1](C);B[1]=function(Te){D.uvs[1][Te]=Se}}();for(var Z=0;Z<=_;Z++){var ae=Z/_,F=T*3;V.uProjecte(ae,C);var W=V.vertexPosition(C,C.projected),O=V.vertexNormal(C);W.sub(C.center),C.quatNormalToZ&&(W.applyQuaternion(C.quatNormalToZ),O.applyQuaternion(C.quatNormalToZ)),W.toArray(D.position,F),O.toArray(D.normal,F);var X=v(B),G;try{for(X.s();!(G=X.n()).done;){var j=G.value;j(T,ae,Q)}}catch(Se){X.e(Se)}finally{X.f()}C.disableSkirt||q!==0&&q!==x&&(Z===_?U.push(T):Z===0&&H.push(T)),te.push(T),T++}N.push(te),q===0?U=U.concat(te):q===x&&(U=U.concat(te.slice().reverse()))}C.disableSkirt||(U=U.concat(H.reverse()));function K(Se,Te,me,be){return D.index[be+0]=Se,D.index[be+1]=Te,D.index[be+2]=me,be+3}var ce=0;if(C.buildIndexAndUv_0)for(var se=0;se<x;se++)for(var ue=0;ue<_;ue++){var Y=N[se][ue+1],pe=N[se][ue],Ee=N[se+1][ue],Fe=N[se+1][ue+1];ce=K(Fe,pe,Y,ce),ce=K(Fe,Ee,pe,ce)}var $e=T;if(!C.disableSkirt){var pt=new h.Vector3().fromArray(D.position).distanceTo(new h.Vector3().fromArray(D.position,3)),Ue=function(){},Je=function(){};C.buildIndexAndUv_0&&(Ue=function(Se,Te,me,be,we){return Se=K(Te,me,be,Se),Se=K(Te,be,we,Se),Se},Je=function(Se){D.uvs[0][T*2+0]=D.uvs[0][Se*2+0],D.uvs[0][T*2+1]=D.uvs[0][Se*2+1]});for(var et=0;et<U.length;et++){var ze=U[et],Xe=T*3,tt=ze*3;D.position[Xe+0]=D.position[tt+0]-D.normal[tt+0]*pt,D.position[Xe+1]=D.position[tt+1]-D.normal[tt+1]*pt,D.position[Xe+2]=D.position[tt+2]-D.normal[tt+2]*pt,D.normal[Xe+0]=D.normal[tt+0],D.normal[Xe+1]=D.normal[tt+1],D.normal[Xe+2]=D.normal[tt+2],Je(ze),b>1&&(D.uvs[1][T]=D.uvs[1][ze]);var ye=(et+1)%U.length,Ze=T,Ge=ye===0?$e:T+1,Ae=U[ye];ce=Ue(ce,ze,Ze,Ge,Ae),T++}}return D}}(uw)),uw}var BT;function wC(){return BT||(BT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(kr()),M=u(Ir()),v=u(dn()),y=u(pn()),p=u(ln()),g=B(Dr()),C=u(AC());function D(_){if(typeof WeakMap!="function")return null;var x=new WeakMap,T=new WeakMap;return(D=function(U){return U?T:x})(_)}function B(_,x){if(!x&&_&&_.__esModule)return _;if(_===null||h(_)!=="object"&&typeof _!="function")return{default:_};var T=D(x);if(T&&T.has(_))return T.get(_);var N={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in _)if(H!=="default"&&Object.prototype.hasOwnProperty.call(_,H)){var q=U?Object.getOwnPropertyDescriptor(_,H):null;q&&(q.get||q.set)?Object.defineProperty(N,H,q):N[H]=_[H]}return N.default=_,T&&T.set(_,N),N}function V(_){var x=P();return function(){var T=(0,p.default)(_),N;if(x){var U=(0,p.default)(this).constructor;N=Reflect.construct(T,arguments,U)}else N=T.apply(this,arguments);return(0,y.default)(this,N)}}function P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function L(_){_.buildIndexAndUv_0=!0,_.center=_.builder.center(_.extent).clone();var x=(0,C.default)(_);x.index=new g.BufferAttribute(x.index,1),x.uvs[0]=new g.BufferAttribute(x.uvs[0],2),x.position=new g.BufferAttribute(x.position,3),x.normal=new g.BufferAttribute(x.normal,3);for(var T=1;T<_.builder.uvCount;T++)x.uvs[1]=new g.BufferAttribute(x.uvs[1],1);return x}var E=function(_){(0,v.default)(T,_);var x=V(T);function T(N){var U,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:L(N);(0,M.default)(this,T),U=x.call(this),U.center=N.center,U.extent=N.extent,U.setIndex(H.index),U.setAttribute("position",H.position),U.setAttribute("normal",H.normal);for(var q=0;q<H.uvs.length;q++)U.setAttribute("uv_".concat(q),H.uvs[q]);return U.computeBoundingBox(),U.OBB={},U}return(0,R.default)(T)}(g.BufferGeometry),b=E;a.default=b}(ow)),ow}var lw={},UT;function MC(){return UT||(UT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=C(Dr()),y=u(Zi()),p=u(ya());function g(N){if(typeof WeakMap!="function")return null;var U=new WeakMap,H=new WeakMap;return(g=function(te){return te?H:U})(N)}function C(N,U){if(!U&&N&&N.__esModule)return N;if(N===null||h(N)!=="object"&&typeof N!="function")return{default:N};var H=g(U);if(H&&H.has(N))return H.get(N);var q={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in N)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(N,Q)){var Z=te?Object.getOwnPropertyDescriptor(N,Q):null;Z&&(Z.get||Z.set)?Object.defineProperty(q,Q,Z):q[Q]=N[Q]}return q.default=N,H&&H.set(N,q),q}var D=Math.PI/4,B=1/(Math.PI*2),V=new v.Vector3(0,0,1),P=new v.Vector3(0,1,0),L=new v.Quaternion,E=new v.Quaternion,b=new v.Quaternion;function _(N){return 1-(.5-Math.log(Math.tan(D+v.MathUtils.degToRad(N)*.5))*B)}var x=function(){function N(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,R.default)(this,N),this.tmp={coords:[new y.default("EPSG:4326",0,0),new y.default("EPSG:4326",0,0)],position:new v.Vector3,dimension:new v.Vector2},this.crs=U.crs,this.uvCount=U.uvCount,this.computeUvs=[function(){},function(H){var q=_(H.projected.latitude)*H.nbRow;return(isFinite(q)?q:0)-H.deltaUV1}]}return(0,M.default)(N,[{key:"prepare",value:function(H){H.nbRow=Math.pow(2,H.level+1);var q=_(H.extent.south);isFinite(q)||(q=0);var te=1/H.nbRow,Q=q%te;H.deltaUV1=(q-Q)*H.nbRow,H.quatNormalToZ=b.setFromAxisAngle(P,-(Math.PI*.5-v.MathUtils.degToRad(H.extent.center().latitude))),H.projected={longitude:0,latitude:0},H.extent.planarDimensions(this.tmp.dimension)}},{key:"center",value:function(H){return H.center(this.tmp.coords[0]).as(this.crs,this.tmp.coords[1]).toVector3()}},{key:"vertexPosition",value:function(H){return this.tmp.coords[0].setFromValues(H.projected.longitude,H.projected.latitude),this.tmp.coords[0].as(this.crs,this.tmp.coords[1]).toVector3(this.tmp.position),this.tmp.position}},{key:"vertexNormal",value:function(){return this.tmp.coords[1].geodesicNormal}},{key:"uProjecte",value:function(H,q){q.projected.longitude=q.extent.west+H*this.tmp.dimension.x}},{key:"vProjecte",value:function(H,q){q.projected.latitude=q.extent.south+H*this.tmp.dimension.y}},{key:"computeSharableExtent",value:function(H){var q=Math.abs(H.west-H.east)/2,te=new p.default(H.crs,-q,q,H.south,H.north),Q=v.MathUtils.degToRad(H.west-te.west),Z=v.MathUtils.degToRad(90-H.center(this.tmp.coords[0]).latitude);return L.setFromAxisAngle(V,Q),E.setFromAxisAngle(P,Z),L.multiply(E),{sharableExtent:te,quaternion:L.clone(),position:this.center(H)}}}]),N}(),T=x;a.default=T}(lw)),lw}var zT;function KM(){return zT||(zT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Cs()),y=u(dn()),p=u(pn()),g=u(ln()),C=E(Dr()),D=u(wC()),B=u(MC()),V=u(Zi()),P=u(ps());function L(Z){if(typeof WeakMap!="function")return null;var ae=new WeakMap,F=new WeakMap;return(L=function(O){return O?F:ae})(Z)}function E(Z,ae){if(!ae&&Z&&Z.__esModule)return Z;if(Z===null||h(Z)!=="object"&&typeof Z!="function")return{default:Z};var F=L(ae);if(F&&F.has(Z))return F.get(Z);var W={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in Z)if(X!=="default"&&Object.prototype.hasOwnProperty.call(Z,X)){var G=O?Object.getOwnPropertyDescriptor(Z,X):null;G&&(G.get||G.set)?Object.defineProperty(W,X,G):W[X]=Z[X]}return W.default=Z,F&&F.set(Z,W),W}function b(Z){var ae=_();return function(){var F=(0,g.default)(Z),W;if(ae){var O=(0,g.default)(this).constructor;W=Reflect.construct(F,arguments,O)}else W=F.apply(this,arguments);return(0,p.default)(this,W)}}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var x=new B.default({crs:"EPSG:4978",uvCount:1}),T=new C.Vector3,N=new C.Vector2,U=new C.Vector3,H=new V.default("EPSG:4326",0,0,0),q,te=function(Z){(0,y.default)(F,Z);var ae=b(F);function F(){var W,O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new C.Vector3(1/0,1/0,1/0),X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new C.Vector3(-1/0,-1/0,-1/0);return(0,R.default)(this,F),W=ae.call(this),W.box3D=new C.Box3(O.clone(),X.clone()),W.natBox=W.box3D.clone(),W.z={min:0,max:0,scale:1},W}return(0,M.default)(F,[{key:"clone",value:function(){return new F().copy(this)}},{key:"copy",value:function(O){return(0,v.default)((0,g.default)(F.prototype),"copy",this).call(this,O),this.box3D.copy(O.box3D),this.natBox.copy(O.natBox),this.z.min=O.z.min,this.z.max=O.z.max,this.z.scale=O.z.scale,this}},{key:"update",value:function(){this.updateMatrixWorld(!0)}},{key:"updateZ",value:function(){var O,X,G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.z.min=(O=G.min)!==null&&O!==void 0?O:this.z.min,this.z.max=(X=G.max)!==null&&X!==void 0?X:this.z.max,this.z.scale=G.scale>0?G.scale:this.z.scale,this.z.delta=Math.abs(this.z.max-this.z.min)*this.z.scale;var j=G.geoidHeight||0;this.box3D.min.z=this.natBox.min.z+this.z.min*this.z.scale+j,this.box3D.max.z=this.natBox.max.z+this.z.max*this.z.scale+j}},{key:"isSphereAboveXYBox",value:function(O){var X=this.worldToLocal(O.center),G=Math.max(this.box3D.min.x,Math.min(X.x,this.box3D.max.x)),j=Math.max(this.box3D.min.y,Math.min(X.y,this.box3D.max.y)),K=Math.sqrt((G-X.x)*(G-X.x)+(j-X.y)*(j-X.y));return K<O.radius}},{key:"setFromExtent",value:function(O){var X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:O.min||0,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:O.max||0;if(O.crs=="EPSG:4326"){var j=x.computeSharableExtent(O),K=j.sharableExtent,ce=j.quaternion,se=j.position,ue=Math.max(Math.floor(K.planarDimensions(N).x/90+1),2),Y=new D.default({extent:K,level:0,segment:ue,disableSkirt:!0,builder:x});q.box3D.copy(Y.boundingBox),q.natBox.copy(Y.boundingBox),this.copy(q),this.updateZ({min:X,max:G}),this.position.copy(se),this.quaternion.copy(ce),this.updateMatrixWorld(!0)}else if(!P.default.isTms(O.crs)&&P.default.isMetricUnit(O.crs))O.center(H).toVector3(this.position),O.planarDimensions(N),T.set(N.x,N.y,Math.abs(G-X)),this.box3D.setFromCenterAndSize(U,T),this.updateMatrixWorld(!0);else throw new Error("Unsupported extent crs");return this}}]),F}(C.Object3D);q=new te;var Q=te;a.default=Q}(sw)),sw}var GT;function f2(){return GT||(GT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.getLookAtFromMath=W,a.getRig=G;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=_(Dr()),C=u(xC),D=u(F0()),B=ed(),V=u(Zi()),P=u($h()),L=u(KM()),E=iv();function b(K){if(typeof WeakMap!="function")return null;var ce=new WeakMap,se=new WeakMap;return(b=function(Y){return Y?se:ce})(K)}function _(K,ce){if(!ce&&K&&K.__esModule)return K;if(K===null||h(K)!=="object"&&typeof K!="function")return{default:K};var se=b(ce);if(se&&se.has(K))return se.get(K);var ue={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var pe in K)if(pe!=="default"&&Object.prototype.hasOwnProperty.call(K,pe)){var Ee=Y?Object.getOwnPropertyDescriptor(K,pe):null;Ee&&(Ee.get||Ee.set)?Object.defineProperty(ue,pe,Ee):ue[pe]=K[pe]}return ue.default=K,se&&se.set(K,ue),ue}function x(K){var ce=T();return function(){var se=(0,p.default)(K),ue;if(ce){var Y=(0,p.default)(this).constructor;ue=Reflect.construct(se,arguments,Y)}else ue=se.apply(this,arguments);return(0,y.default)(this,ue)}}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}g.Object3D.DefaultUp.set(0,0,1);var N=new g.Vector3,U=new V.default("EPSG:4326",0,0,0),H=new P.default,q=[],te=new L.default,Q=new g.Vector3,Z=function(){var K,ce;return{promise:new Promise(function(se,ue){K=se,ce=ue}),resolve:K,reject:ce}};function ae(K){return K-Math.floor((K+180)/360)*360}function F(K){return K.getLayers(function(ce){return ce.isTiledGeometryLayer})[0]}function W(K,ce){var se=new g.Vector3(0,0,.5);if(se.unproject(ce),se.sub(ce.position).normalize(),K.referenceCrs=="EPSG:4978")return H.intersection({direction:se,origin:ce.position});var ue=ce.position.z/se.z;return se.multiplyScalar(ue).add(ce.position)}function O(K,ce,se,ue){se.proxy.position[ue]=ce.position[ue],Object.defineProperty(ce.position,ue,{get:function(){return se.proxy.position[ue]},set:function(pe){se.removeProxy(K,ce),ce.position[ue]=pe}})}var X=function(K){(0,v.default)(se,K);var ce=x(se);function se(){var ue;return(0,R.default)(this,se),ue=ce.call(this),ue.seaLevel=new g.Object3D,ue.target=new g.Object3D,ue.target.rotation.order="ZXY",ue.camera=new g.Camera,ue.add(ue.seaLevel),ue.seaLevel.add(ue.target),ue.target.add(ue.camera),ue.coord=new V.default("EPSG:4978",0,0),ue.targetWorldPosition=new g.Vector3,ue.removeAll=function(){},ue._onChangeCallback=null,ue}return(0,M.default)(se,[{key:"applyTransformToCamera",value:function(Y,pe){var Ee=this;this.proxy?(pe.quaternion._onChange(this._onChangeCallback),this.camera.matrixWorld.decompose(this.proxy.position,pe.quaternion,pe.scale),pe.quaternion._onChange(function(){return Ee.removeProxy(Y,pe)})):this.camera.matrixWorld.decompose(pe.position,pe.quaternion,pe.scale),Y.dispatchEvent({type:E.VIEW_EVENTS.CAMERA_MOVED,coord:this.coord,range:this.range,heading:this.heading,tilt:this.tilt})}},{key:"setProxy",value:function(Y,pe){var Ee=this;!this.proxy&&Y&&pe&&(this.proxy={position:new g.Vector3},Object.keys(pe.position).forEach(function(Fe){return O(Y,pe,Ee,Fe)}),this._onChangeCallback=pe.quaternion._onChangeCallback,pe.quaternion._onChange(function(){return Ee.removeProxy(Y,pe)}))}},{key:"removeProxy",value:function(Y,pe){var Ee=this;this.stop(Y),this.proxy&&Y&&pe&&(Object.keys(pe.position).forEach(function(Fe){return Object.defineProperty(pe.position,Fe,{value:Ee.proxy.position[Fe],writable:!0})}),pe.quaternion._onChange(this._onChangeCallback),this.proxy=null)}},{key:"setTargetFromCoordinate",value:function(Y,pe){pe.as(F(Y).extent.crs,this.coord);var Ee=Math.max(0,D.default.getElevationValueAt(F(Y),this.coord,D.default.PRECISE_READ_Z)||this.coord.z);this.coord.z=Ee,this.coord.as(Y.referenceCrs).toVector3(N),Y.referenceCrs=="EPSG:4978"?(this.lookAt(N),this.seaLevel.position.set(0,0,N.length()-Ee)):(this.position.set(N.x,N.y,0),this.seaLevel.position.set(0,0,0)),this.target.position.set(0,0,Ee)}},{key:"setFromPositions",value:function(Y,pe){this.setTargetFromCoordinate(Y,new V.default(Y.referenceCrs,N)),this.target.rotation.set(0,0,0),this.updateMatrixWorld(!0),this.camera.position.copy(pe),this.target.worldToLocal(this.camera.position);var Ee=this.camera.position.length();this.target.rotation.x=Math.asin(this.camera.position.z/Ee);var Fe=g.MathUtils.clamp(this.camera.position.y/(Math.cos(this.target.rotation.x)*Ee),-1,1);this.target.rotation.z=Math.sign(-this.camera.position.x||1)*Math.acos(Fe),this.camera.position.set(0,Ee,0)}},{key:"applyParams",value:function(Y,pe){pe.coord&&this.setTargetFromCoordinate(Y,pe.coord),pe.tilt!=null&&(this.target.rotation.x=g.MathUtils.degToRad(pe.tilt)),pe.heading!=null&&(this.target.rotation.z=g.MathUtils.degToRad(-ae(pe.heading+180))),pe.range&&this.camera.position.set(0,pe.range,0),this.camera.rotation.set(-Math.PI*.5,0,Math.PI),this.updateMatrixWorld(!0),this.targetWorldPosition.setFromMatrixPosition(this.seaLevel.matrixWorld)}},{key:"getParams",value:function(){return{coord:this.coord.clone(),tilt:this.tilt,heading:this.heading,range:this.range,targetWorldPosition:this.targetWorldPosition}}},{key:"setfromCamera",value:function(Y,pe,Ee){pe.updateMatrixWorld(!0),Ee==null&&(Ee=Y.getPickingPositionFromDepth()||W(Y,pe));var Fe=Ee&&!isNaN(Ee.x)?pe.position.distanceTo(Ee):100;pe.localToWorld(N.set(0,0,-Fe)),this.setFromPositions(Y,pe.position)}},{key:"copyObject3D",value:function(Y){return this.copy(Y,!1),this.seaLevel.copy(Y.seaLevel,!1),this.target.copy(Y.target,!1),this.camera.copy(Y.camera),this}},{key:"animateCameraToLookAtTarget",value:function(Y,pe,Ee){var Fe=this;Ee.easing=Ee.easing||C.default.Easing.Quartic.InOut,this.setfromCamera(Y,pe);var $e=new C.default.Group;this.start=(this.start||new se).copyObject3D(this),this.end=(this.end||new se).copyObject3D(this);var pt=Ee.time||2500,Ue={t:0},Je=[],et=Z();this.addPlaceTargetOnGround(Y,pe,Ee.coord,Ue),this.end.applyParams(Y,Ee);var ze=this.end.target.rotation.z-this.start.target.rotation.z;return Math.abs(ze)>Math.PI&&(this.end.target.rotation.z=this.start.target.rotation.z+ze-Math.sign(ze)*2*Math.PI),Je.push(new C.default.Tween(Ue,$e).to({t:1},pt).easing(Ee.easing).onUpdate(function(Xe){Y.referenceCrs=="EPSG:4978"&&Fe.quaternion.slerpQuaternions(Fe.start.quaternion,Fe.end.quaternion,Xe.t),Fe.camera.quaternion.slerpQuaternions(Fe.start.camera.quaternion,Fe.end.camera.quaternion,Xe.t),Fe.target.rotation.set(0,0,0),Fe.target.rotateZ(g.MathUtils.lerp(Fe.start.target.rotation.z,Fe.end.target.rotation.z,Xe.t)),Fe.target.rotateX(g.MathUtils.lerp(Fe.start.target.rotation.x,Fe.end.target.rotation.x,Xe.t))})),Y.referenceCrs!="EPSG:4978"&&Je.push(new C.default.Tween(this.position,$e).to(this.end.position,pt).easing(Ee.easing)),Je.push(new C.default.Tween(this.seaLevel.position,$e).to(this.end.seaLevel.position,pt).easing(Ee.easing)),Je.push(new C.default.Tween(this.camera.position,$e).to(this.end.camera.position,pt).easing(Ee.easing)),this.animationFrameRequester=function(){$e.update(),Fe.updateMatrixWorld(!0),Fe.applyTransformToCamera(Y,pe),Fe.targetWorldPosition.setFromMatrixPosition(Fe.seaLevel.matrixWorld),Ee.callback&&Ee.callback(Fe),U.crs=Y.referenceCrs,U.setFromVector3(Fe.targetWorldPosition).as(F(Y).extent.crs,Fe.coord),Y.notifyChange(pe)},this.removeAll=function(Xe){this.removeAll=function(){},$e.removeAll(),this.animationFrameRequester&&Y.removeFrameRequester(B.MAIN_LOOP_EVENTS.BEFORE_RENDER,this.animationFrameRequester),et.resolve(Xe!==void 0),this.animationFrameRequester=null},Je[Je.length-1].onComplete(this.removeAll),Je.forEach(function(Xe){return Xe.start()}),Y.addFrameRequester(B.MAIN_LOOP_EVENTS.BEFORE_RENDER,this.animationFrameRequester),Y.notifyChange(pe),et}},{key:"stop",value:function(Y){this.removePlaceTargetOnGround(Y),this.removeAll()}},{key:"addPlaceTargetOnGround",value:function(Y,pe,Ee){var Fe=this,$e=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{t:1};if(this.removePlaceTargetOnGround(Y),Y&&pe){var pt=this.target.position.z;this.placeTargetOnGround=function(){var Ue=Math.max(0,D.default.getElevationValueAt(F(Y),Ee||Fe.coord,D.default.PRECISE_READ_Z)||0);Fe.target.position.z=pt*(1-$e.t)+Ue*$e.t,Fe.target.updateMatrixWorld(!0),Fe.applyTransformToCamera(Y,pe)},this.placeTargetOnGround(),Y.addFrameRequester(B.MAIN_LOOP_EVENTS.BEFORE_RENDER,this.placeTargetOnGround)}}},{key:"removePlaceTargetOnGround",value:function(Y){Y&&this.placeTargetOnGround&&(Y.removeFrameRequester(B.MAIN_LOOP_EVENTS.BEFORE_RENDER,this.placeTargetOnGround),this.placeTargetOnGround=null)}},{key:"tilt",get:function(){return g.MathUtils.radToDeg(this.target.rotation.x)}},{key:"heading",get:function(){return-ae(g.MathUtils.radToDeg(this.target.rotation.z)+180)}},{key:"range",get:function(){return this.camera.position.y}}]),se}(g.Object3D);function G(K){return q[K.uuid]=q[K.uuid]||new X(K),q[K.uuid]}var j={defaultStopPlaceOnGroundAtEnd:!1,Easing:C.default.Easing,stop:function(ce,se){G(se).stop(ce)},getTransformCameraLookingAtTarget:function(ce,se,ue){var Y=G(se);return Y.setfromCamera(ce,se,ue),Y.getParams()},transformCameraToLookAtTarget:function(ce,se){var ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ue.isExtent&&(ue=this.getCameraTransformOptionsFromExtent(ce,se,ue)),ue.proxy=ue.proxy===void 0||ue.proxy;var Y=G(se);return Y.stop(ce),Y.setfromCamera(ce,se),ue.proxy&&Y.setProxy(ce,se),Y.applyParams(ce,ue),Y.addPlaceTargetOnGround(ce,se,ue.coord),Y.applyTransformToCamera(ce,se),ce.notifyChange(se),Promise.resolve(Y.getParams())},getCameraTransformOptionsFromExtent:function(ce,se,ue){var Y={coord:new V.default(ue.crs,0,0,0),heading:0,tilt:ce.isPlanarView?90:89.9},pe;if(ce.isGlobeView?(ue=ue.as("EPSG:4326"),te.setFromExtent(ue),te.box3D.getSize(Q),pe={x:Q.y,y:Q.x}):(ue=ue.as(ce.referenceCrs),pe=ue.planarDimensions()),ue.center(Y.coord),se.isOrthographicCamera)pe.x/pe.y>se.aspect?se.zoom=(se.right-se.left)/pe.x:se.zoom=(se.top-se.bottom)/pe.y,se.updateProjectionMatrix(),Y.range=1e3;else if(se.isPerspectiveCamera){var Ee=g.Math.degToRad(se.fov);if(pe.x/pe.y>se.aspect){var Fe=ce.domElement.clientHeight*.5/Math.tan(Ee*.5),$e=2*Math.atan(ce.domElement.clientWidth*.5/Fe);Y.range=pe.x/(2*Math.tan($e*.5))}else Y.range=pe.y/(2*Math.tan(Ee*.5))}return Y},animateCameraToLookAtTarget:function(ce,se){var ue=this,Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Y.proxy=Y.proxy===void 0||Y.proxy;var pe=G(se);return pe.stop(ce),Y.proxy&&pe.setProxy(ce,se),pe.animateCameraToLookAtTarget(ce,se,Y).promise.then(function(Ee){var Fe=Y.stopPlaceOnGroundAtEnd===void 0?ue.defaultStopPlaceOnGroundAtEnd:Y.stopPlaceOnGroundAtEnd,$e=pe.getParams();return Fe&&pe.stop(ce),$e.finished=Ee,$e})},sequenceAnimationsToLookAtTarget:function(ce,se){var ue=this,Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[{}],pe=Y.map(function(Ee){return function(){return ue.animateCameraToLookAtTarget(ce,se,Ee)}});return function(Fe){return Fe.reduce(function($e,pt){return $e.then(function(Ue){var Je=Ue.length?Ue[Ue.length-1].finished:!0;return Je?pt().then(Array.prototype.concat.bind(Ue)):Promise.resolve([{finished:!1}])})},Promise.resolve([]))}(pe)},getDiffParams:function(ce,se){if(!(!ce||!se)){var ue;return Math.abs(ce.range-se.range)/ce.range>.001&&(ue=ue||{},ue.range={previous:ce.range,new:se.range}),Math.abs(ce.tilt-se.tilt)>.1&&(ue=ue||{},ue.tilt={previous:ce.tilt,new:se.tilt}),Math.abs(ce.heading-se.heading)>.1&&(ue=ue||{},ue.heading={previous:ce.heading,new:se.heading}),(Math.abs(ce.coord.x-se.coord.x)>1e-6||Math.abs(ce.coord.y-se.coord.y)>1e-6)&&(ue=ue||{},ue.coord={previous:ce.coord,new:se.coord}),ue}}};a.default=j}(aw)),aw}var cw={},VT;function lI(){return VT||(VT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=B(Dr());function D(T){if(typeof WeakMap!="function")return null;var N=new WeakMap,U=new WeakMap;return(D=function(q){return q?U:N})(T)}function B(T,N){if(!N&&T&&T.__esModule)return T;if(T===null||h(T)!=="object"&&typeof T!="function")return{default:T};var U=D(N);if(U&&U.has(T))return U.get(T);var H={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in T)if(te!=="default"&&Object.prototype.hasOwnProperty.call(T,te)){var Q=q?Object.getOwnPropertyDescriptor(T,te):null;Q&&(Q.get||Q.set)?Object.defineProperty(H,te,Q):H[te]=T[te]}return H.default=T,U&&U.set(T,H),H}function V(T){var N=P();return function(){var U=(0,g.default)(T),H;if(N){var q=(0,g.default)(this).constructor;H=Reflect.construct(U,arguments,q)}else H=U.apply(this,arguments);return(0,p.default)(this,H)}}function P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var L={LEFT:37,UP:38,RIGHT:39,BOTTOM:40,SPACE:32,SHIFT:16,CTRL:17,S:83},E={ORBIT:{enable:!0,mouseButton:C.MOUSE.LEFT,double:!1,keyboard:L.CTRL,finger:2,_event:"rotate"},MOVE_GLOBE:{enable:!0,mouseButton:C.MOUSE.LEFT,double:!1,finger:1,_event:"drag"},DOLLY:{enable:!0,mouseButton:C.MOUSE.MIDDLE,double:!1,finger:2,_event:"dolly"},PAN:{enable:!0,mouseButton:C.MOUSE.RIGHT,double:!1,finger:3,_event:"pan"},PANORAMIC:{enable:!0,mouseButton:C.MOUSE.LEFT,double:!1,keyboard:L.SHIFT,_event:"panoramic"},TRAVEL_IN:{enable:!0,mouseButton:C.MOUSE.LEFT,double:!0,_event:"travel_in",_trigger:!0,_direction:"in"},TRAVEL_OUT:{enable:!1,double:!1,_event:"travel_out",_trigger:!0,_direction:"out"},ZOOM:{enable:!0,_event:"zoom",_trigger:!0},PAN_UP:{enable:!0,keyboard:L.UP,double:!1,_event:"pan",_trigger:!0,_direction:"up"},PAN_BOTTOM:{enable:!0,keyboard:L.BOTTOM,double:!1,_event:"pan",_trigger:!0,_direction:"bottom"},PAN_LEFT:{enable:!0,keyboard:L.LEFT,double:!1,_event:"pan",_trigger:!0,_direction:"left"},PAN_RIGHT:{enable:!0,keyboard:L.RIGHT,double:!1,_event:"pan",_trigger:!0,_direction:"right"}},b=new C.Vector2,_=function(T){(0,y.default)(U,T);var N=V(U);function U(H){var q,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,R.default)(this,U),q=N.call(this),q._view=H,q._domElement=H.domElement;var Q=!0;Object.defineProperty((0,v.default)(q),"enabled",{get:function(){return Q},set:function(W){W||(q.onKeyUp(),q.onPointerUp()),Q=W}});var Z=!0;Object.defineProperty((0,v.default)(q),"enableKeys",{get:function(){return Z},set:function(W){W||q.onKeyUp(),Z=W}}),q.NONE={};var ae=q.NONE;return Object.defineProperty((0,v.default)(q),"currentState",{get:function(){return ae},set:function(W){if(ae!==W){var O=ae;ae=W,q.dispatchEvent({type:"state-changed",viewCoords:b,previous:O})}}}),q._clickTimeStamp=0,q._lastMousePressed={viewCoords:new C.Vector2},q._currentMousePressed=void 0,q._currentKeyPressed=void 0,q._onPointerDown=q.onPointerDown.bind((0,v.default)(q)),q._onPointerMove=q.onPointerMove.bind((0,v.default)(q)),q._onPointerUp=q.onPointerUp.bind((0,v.default)(q)),q._onMouseWheel=q.onMouseWheel.bind((0,v.default)(q)),q._onKeyDown=q.onKeyDown.bind((0,v.default)(q)),q._onKeyUp=q.onKeyUp.bind((0,v.default)(q)),q._onBlur=q.onBlur.bind((0,v.default)(q)),q._onContextMenu=q.onContextMenu.bind((0,v.default)(q)),q._domElement.addEventListener("pointerdown",q._onPointerDown,!1),q._domElement.addEventListener("wheel",q._onMouseWheel,!1),window.addEventListener("keydown",q._onKeyDown,!1),window.addEventListener("keyup",q._onKeyUp,!1),window.addEventListener("blur",q._onBlur),q._domElement.addEventListener("contextmenu",q._onContextMenu,!1),q.setFromOptions(te),q}return(0,M.default)(U,[{key:"inputToState",value:function(q,te){for(var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,Z=0,ae=Object.keys(E);Z<ae.length;Z++){var F=ae[Z],W=this[F];if(W.enable&&W.mouseButton===q&&W.keyboard===te&&W.double===Q){if(!W._trigger)return W;this.dispatchEvent({type:W._event,viewCoords:q!==void 0&&b,direction:W._direction})}}return this.NONE}},{key:"touchToState",value:function(q){for(var te=0,Q=Object.keys(E);te<Q.length;te++){var Z=Q[te],ae=this[Z];if(ae.enable&&q==ae.finger)return ae}return this.NONE}},{key:"setFromOptions",value:function(q){for(var te in E)if({}.hasOwnProperty.call(E,te)){var Q={};Q=q[te]||this[te]||Object.assign(Q,E[te]),q[te]&&q[te].enable===void 0&&(Q.enable=this[te].enable),Q.double=!!Q.double,Q._event=E[te]._event,Q._trigger=E[te]._trigger,Q._direction=E[te]._direction,this[te]=Q}}},{key:"onPointerDown",value:function(q){if(!!this.enabled){switch(b.copy(this._view.eventToViewCoords(q)),q.pointerType){case"mouse":this._currentMousePressed=q.button,this.currentState=this.inputToState(this._currentMousePressed,this._currentKeyPressed,q.timeStamp-this._clickTimeStamp<500&&this._lastMousePressed.button===this._currentMousePressed&&this._lastMousePressed.viewCoords.distanceTo(b)<5),this._clickTimeStamp=q.timeStamp,this._lastMousePressed.button=this._currentMousePressed,this._lastMousePressed.viewCoords.copy(b);break}this._domElement.addEventListener("pointermove",this._onPointerMove,!1),this._domElement.addEventListener("pointerup",this._onPointerUp,!1),this._domElement.addEventListener("mouseleave",this._onPointerUp,!1)}}},{key:"onPointerMove",value:function(q){if(q.preventDefault(),!!this.enabled)switch(b.copy(this._view.eventToViewCoords(q)),q.pointerType){case"mouse":this.dispatchEvent({type:this.currentState._event,viewCoords:b});break}}},{key:"onPointerUp",value:function(){!this.enabled||(this._currentMousePressed=void 0,this._domElement.removeEventListener("pointermove",this._onPointerMove,!1),this._domElement.removeEventListener("pointerup",this._onPointerUp,!1),this._domElement.removeEventListener("mouseleave",this._onPointerUp,!1),this.currentState=this.NONE)}},{key:"onMouseWheel",value:function(q){q.preventDefault(),this.enabled&&this.ZOOM.enable&&this.dispatchEvent({type:this.ZOOM._event,delta:q.deltaY})}},{key:"onKeyDown",value:function(q){!this.enabled||!this.enableKeys||(this._currentKeyPressed=q.keyCode,this.inputToState(this._currentMousePressed,this._currentKeyPressed))}},{key:"onKeyUp",value:function(){!this.enabled||!this.enableKeys||(this._currentKeyPressed=void 0,this._currentMousePressed===void 0&&(this.currentState=this.NONE))}},{key:"onBlur",value:function(){this.onKeyUp(),this.onPointerUp()}},{key:"onContextMenu",value:function(q){q.preventDefault()}},{key:"dispose",value:function(){this._clickTimeStamp=0,this._lastMousePressed=void 0,this._currentKeyPressed=void 0,this._domElement.removeEventListener("pointerdown",this._onPointerDown,!1),this._domElement.removeEventListener("pointermove",this._onPointerMove,!1),this._domElement.removeEventListener("pointerup",this._onPointerUp,!1),this._domElement.removeEventListener("wheel",this._onMouseWheel,!1),this._domElement.removeEventListener("keydown",this._onKeyDown,!1),this._domElement.removeEventListener("keyup",this._onKeyUp,!1),window.removeEventListener("blur",this._onBlur),this._domElement.removeEventListener("contextmenu",this._onContextMenu,!1)}}]),U}(C.EventDispatcher),x=_;a.default=x}(cw)),cw}var WT;function bC(){return WT||(WT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.CONTROL_EVENTS=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=_(Dr()),D=u(oI()),B=u(Zi()),V=$h(),P=u(f2()),L=u(lI()),E=iv();function b(ht){if(typeof WeakMap!="function")return null;var _t=new WeakMap,St=new WeakMap;return(b=function(vt){return vt?St:_t})(ht)}function _(ht,_t){if(!_t&&ht&&ht.__esModule)return ht;if(ht===null||h(ht)!=="object"&&typeof ht!="function")return{default:ht};var St=b(_t);if(St&&St.has(ht))return St.get(ht);var Ct={},vt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ct in ht)if(ct!=="default"&&Object.prototype.hasOwnProperty.call(ht,ct)){var Dt=vt?Object.getOwnPropertyDescriptor(ht,ct):null;Dt&&(Dt.get||Dt.set)?Object.defineProperty(Ct,ct,Dt):Ct[ct]=ht[ct]}return Ct.default=ht,St&&St.set(ht,Ct),Ct}function x(ht,_t){var St=typeof Symbol<"u"&&ht[Symbol.iterator]||ht["@@iterator"];if(!St){if(Array.isArray(ht)||(St=T(ht))||_t&&ht&&typeof ht.length=="number"){St&&(ht=St);var Ct=0,vt=function(){};return{s:vt,n:function(){return Ct>=ht.length?{done:!0}:{done:!1,value:ht[Ct++]}},e:function(dr){throw dr},f:vt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ct=!0,Dt=!1,fr;return{s:function(){St=St.call(ht)},n:function(){var dr=St.next();return ct=dr.done,dr},e:function(dr){Dt=!0,fr=dr},f:function(){try{!ct&&St.return!=null&&St.return()}finally{if(Dt)throw fr}}}}function T(ht,_t){if(!!ht){if(typeof ht=="string")return N(ht,_t);var St=Object.prototype.toString.call(ht).slice(8,-1);if(St==="Object"&&ht.constructor&&(St=ht.constructor.name),St==="Map"||St==="Set")return Array.from(ht);if(St==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(St))return N(ht,_t)}}function N(ht,_t){(_t==null||_t>ht.length)&&(_t=ht.length);for(var St=0,Ct=new Array(_t);St<_t;St++)Ct[St]=ht[St];return Ct}function U(ht){var _t=H();return function(){var St=(0,g.default)(ht),Ct;if(_t){var vt=(0,g.default)(this).constructor;Ct=Reflect.construct(St,arguments,vt)}else Ct=St.apply(this,arguments);return(0,p.default)(this,Ct)}}function H(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q=1e-6,te={up:new C.Vector2(0,1),bottom:new C.Vector2(0,-1),left:new C.Vector2(1,0),right:new C.Vector2(-1,0)},Q=new C.Vector2,Z=new C.Vector2,ae=new C.Vector2,F=new C.Spherical(1,.01,0),W=new C.Spherical(1,0,0),O=1,X=new C.Vector2,G=new C.Vector2,j=new C.Vector2,K=new C.Vector3,ce=new C.Vector2,se=new C.Vector2,ue=new C.Vector2,Y,pe=new C.Quaternion,Ee=new C.Object3D,Fe=new B.default("EPSG:4978");Ee.matrixWorldInverse=new C.Matrix4;var $e=new B.default("EPSG:4978",0,0,0),pt=new B.default("EPSG:4326",0,0,0);function Ue(ht,_t){$e.setFromVector3(ht).as("EPSG:4326",pt),_t.position.copy(ht),_t.lookAt(pt.geodesicNormal.add(ht)),_t.rotateX(Math.PI*.5),_t.updateMatrixWorld(!0)}var Je=0,et=!0,ze=.25,Xe=new C.Quaternion(0,0,0,1),tt=120,ye=60,Ze=new C.Vector3,Ge=new C.Vector3,Ae=new C.Quaternion,Se=new C.Sphere,Te=new C.Vector3,me=new C.Vector3,be={},we={PAN_CHANGED:"pan-changed",ORIENTATION_CHANGED:"orientation-changed",RANGE_CHANGED:"range-changed",CAMERA_TARGET_CHANGED:"camera-target-changed"};a.CONTROL_EVENTS=we;var je=new C.Quaternion,lt=new C.Quaternion,ot=new C.Vector3(1,0,0),bt=1/0,Ie=new C.Vector3,re=new C.Vector3,oe=new C.Raycaster,_e=new C.Vector3,Re=new C.Vector3,ke=new C.Sphere,Be,at=function(ht){(0,y.default)(St,ht);var _t=U(St);function St(Ct,vt){var ct,Dt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(0,R.default)(this,St),ct=_t.call(this),ct.player=new D.default,ct.view=Ct,ct.camera=Ct.camera.camera3D,ct.states=new L.default(ct.view),Object.defineProperty((0,v.default)(ct),"enabled",{get:function(){return ct.states.enabled},set:function(er){console.warn("GlobeControls.enabled property is deprecated. Use StateControl.enabled instead - which you can access with GlobeControls.states.enabled."),ct.states.enabled=er}}),Dt.zoomSpeed&&(console.warn("Controls zoomSpeed parameter is deprecated. Use zoomInFactor and zoomOutFactor instead."),Dt.zoomFactor=Dt.zoomFactor||Dt.zoomSpeed),ct.zoomFactor=Dt.zoomFactor||1.25,ct.minDistance=Dt.minDistance||250,ct.maxDistance=Dt.maxDistance||V.ellipsoidSizes.x*8,ct.minZoom=0,ct.maxZoom=1/0,ct.rotateSpeed=Dt.rotateSpeed||.25,ct.keyPanSpeed=7,ct.minPolarAngle=C.MathUtils.degToRad(.5),ct.maxPolarAngle=C.MathUtils.degToRad(86),ct.minAzimuthAngle=-1/0,ct.maxAzimuthAngle=1/0,ct.handleCollision=typeof Dt.handleCollision<"u"?Dt.handleCollision:!0,ct.minDistanceCollision=60,Object.defineProperty((0,v.default)(ct),"enableKeys",{get:function(){return ct.states.enableKeys},set:function(er){console.warn("GlobeControls.enableKeys property is deprecated. Use StateControl.enableKeys instead - which you can access with GlobeControls.states.enableKeys."),ct.states.enableKeys=er}}),ct.enableDamping=!0,ct.dampingMoveFactor=Dt.dampingMoveFactor!=null?Dt.dampingMoveFactor:ze,ct.startEvent={type:"start"},ct.endEvent={type:"end"},ct.updateHelper=function(){},ct._onEndingMove=null,ct._onTravel=ct.travel.bind((0,v.default)(ct)),ct._onTouchStart=ct.onTouchStart.bind((0,v.default)(ct)),ct._onTouchEnd=ct.onTouchEnd.bind((0,v.default)(ct)),ct._onTouchMove=ct.onTouchMove.bind((0,v.default)(ct)),ct._onStateChange=ct.onStateChange.bind((0,v.default)(ct)),ct._onRotation=ct.handleRotation.bind((0,v.default)(ct)),ct._onDrag=ct.handleDrag.bind((0,v.default)(ct)),ct._onDolly=ct.handleDolly.bind((0,v.default)(ct)),ct._onPan=ct.handlePan.bind((0,v.default)(ct)),ct._onPanoramic=ct.handlePanoramic.bind((0,v.default)(ct)),ct._onZoom=ct.handleZoom.bind((0,v.default)(ct)),ct.states.addEventListener("state-changed",ct._onStateChange,!1),ct.states.addEventListener(ct.states.ORBIT._event,ct._onRotation,!1),ct.states.addEventListener(ct.states.MOVE_GLOBE._event,ct._onDrag,!1),ct.states.addEventListener(ct.states.DOLLY._event,ct._onDolly,!1),ct.states.addEventListener(ct.states.PAN._event,ct._onPan,!1),ct.states.addEventListener(ct.states.PANORAMIC._event,ct._onPanoramic,!1),ct.states.addEventListener("zoom",ct._onZoom,!1),ct.view.domElement.addEventListener("touchstart",ct._onTouchStart,!1),ct.view.domElement.addEventListener("touchend",ct._onTouchEnd,!1),ct.view.domElement.addEventListener("touchmove",ct._onTouchMove,!1),ct.states.addEventListener(ct.states.TRAVEL_IN._event,ct._onTravel,!1),ct.states.addEventListener(ct.states.TRAVEL_OUT._event,ct._onTravel,!1),Ct.scene.add(Ee),vt.isExtent?vt.center().as("EPSG:4978",$e):(vt.coord.as("EPSG:4978",$e),vt.tilt=vt.tilt||89.5,vt.heading=vt.heading||0),Ue($e,Ee),ct.lookAtCoordinate(vt,!1),Fe.crs=ct.view.referenceCrs,ct}return(0,M.default)(St,[{key:"dollyInScale",get:function(){return this.zoomFactor}},{key:"dollyOutScale",get:function(){return 1/this.zoomFactor}},{key:"isPaused",get:function(){return this.states.currentState===this.states.NONE&&!this.player.isPlaying()}},{key:"onEndingMove",value:function(vt){this._onEndingMove&&(this.player.removeEventListener("animation-stopped",this._onEndingMove),this._onEndingMove=null),this.handlingEvent(vt)}},{key:"rotateLeft",value:function(){var vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;W.theta-=vt}},{key:"rotateUp",value:function(){var vt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;W.phi-=vt}},{key:"panLeft",value:function(vt){var ct=this.camera.matrix.elements;K.fromArray(ct),K.multiplyScalar(-vt),Ze.add(K)}},{key:"panUp",value:function(vt){var ct=this.camera.matrix.elements;K.fromArray(ct,4),K.multiplyScalar(vt),Ze.add(K)}},{key:"mouseToPan",value:function(vt,ct){var Dt=this.view.mainLoop.gfxEngine;if(this.camera.isPerspectiveCamera){var fr=this.camera.position.distanceTo(this.getCameraTargetPosition());fr*=2*Math.tan(C.MathUtils.degToRad(this.camera.fov*.5)),this.panLeft(vt*fr/Dt.width*this.camera.aspect),this.panUp(ct*fr/Dt.height)}else this.camera.isOrthographicCamera&&(this.panLeft(vt*(this.camera.right-this.camera.left)/Dt.width),this.panUp(ct*(this.camera.top-this.camera.bottom)/Dt.height))}},{key:"dolly",value:function(vt){vt!==0&&(Y=vt>0?this.dollyInScale:this.dollyOutScale,this.camera.isPerspectiveCamera?O/=Y:this.camera.isOrthographicCamera&&(this.camera.zoom=C.MathUtils.clamp(this.camera.zoom*Y,this.minZoom,this.maxZoom),this.camera.updateProjectionMatrix(),this.view.notifyChange(this.camera)))}},{key:"getMinDistanceCameraBoundingSphereObbsUp",value:function(vt){if(vt.level>10&&vt.children.length==1&&vt.geometry){var ct=vt.obb;ke.center.copy(this.camera.position),ke.radius=this.minDistanceCollision,ct.isSphereAboveXYBox(ke)&&(bt=Math.min(ke.center.z-ct.box3D.max.z,bt))}}},{key:"update",value:function(){var vt=this,ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.states.currentState;if(bt=1/0,this.handleCollision&&this.view.tileLayer){var Dt=x(this.view.tileLayer.level0Nodes),fr;try{for(Dt.s();!(fr=Dt.n()).done;){var er=fr.value;er.traverse(this.getMinDistanceCameraBoundingSphereObbsUp.bind(this))}}catch(ta){Dt.e(ta)}finally{Dt.f()}}switch(ct){case this.states.MOVE_GLOBE:if(bt<0)Ee.translateY(-bt),this.camera.position.setLength(this.camera.position.length()-bt);else if(bt<this.minDistanceCollision){var dr=this.minDistanceCollision*(1-bt/this.minDistanceCollision);Ee.translateY(dr),this.camera.position.setLength(this.camera.position.length()+dr)}Ie.copy(re).applyQuaternion(pe),Ee.position.applyQuaternion(pe),this.camera.position.applyQuaternion(pe);break;case this.states.PAN:this.camera.position.add(Ze),Ee.position.add(Ze);break;case this.states.PANORAMIC:{this.camera.worldToLocal(Ee.position);var zr=this.camera.position.clone().normalize().applyQuaternion(this.camera.quaternion.clone().invert());je.setFromAxisAngle(zr,W.theta).multiply(lt.setFromAxisAngle(ot,W.phi)),Ee.position.applyQuaternion(je),this.camera.localToWorld(Ee.position);break}default:{this.camera.position.applyMatrix4(Ee.matrixWorldInverse),(W.theta||W.phi)&&F.setFromVector3(this.camera.position);var Ut=F.radius*Math.sin(this.minPolarAngle),on=Ut*8,tn=Ut*2,Ln=-.01;if(this.handleCollision){if(bt<on&&bt>tn&&W.phi>0){var _i=on-tn,xn=1-(_i-(bt-tn))/_i;W.phi*=xn*xn}else if(bt<tn&&bt>-tn&&W.phi>Ln){var ri=-Math.asin((tn-bt)*.25/F.radius);ri=C.MathUtils.clamp(ri,Ln,0);var _n=1-(tn-bt)/(2*tn);W.phi=C.MathUtils.lerp(W.phi,ri,_n),bt-=Math.sin(W.phi)*F.radius}}F.theta+=W.theta,F.phi+=W.phi,F.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,F.theta)),F.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,F.phi)),F.radius=this.camera.position.length()*O,F.makeSafe(),F.radius=Math.max(this.minDistance,Math.min(this.maxDistance,F.radius)),this.camera.position.setFromSpherical(F),bt<0&&(this.camera.position.y-=bt,F.setFromVector3(this.camera.position),W.phi=0),Ee.localToWorld(this.camera.position)}}this.camera.up.copy(Ee.position).normalize(),this.camera.lookAt(Ee.position),this.enableDamping?(W.theta*=1-ze,W.phi*=1-ze,pe.slerp(Xe,this.dampingMoveFactor*.2)):(W.theta=0,W.phi=0,pe.set(0,0,0,1)),O=1,Ze.set(0,0,0),(Ge.distanceToSquared(this.camera.position)>q||8*(1-Ae.dot(this.camera.quaternion))>q)&&(this.view.notifyChange(this.camera),Ge.copy(this.camera.position),Ae.copy(this.camera.quaternion)),this.enableDamping&&ct===this.states.ORBIT&&this.player.isStopped()&&(W.theta>q||W.phi>q)&&(this.player.setCallback(function(){vt.update(vt.states.ORBIT)}),this.player.playLater(ye,2)),this.view.dispatchEvent({type:E.VIEW_EVENTS.CAMERA_MOVED,coord:Fe.setFromVector3(Ee.position),range:F.radius,heading:-C.MathUtils.radToDeg(F.theta),tilt:90-C.MathUtils.radToDeg(F.phi)})}},{key:"onStateChange",value:function(vt){if(this.states.currentState===this.states.NONE){this.handleEndMovement(vt);return}P.default.stop(this.view,this.camera),this.onEndingMove(),this.player.stop(),this.updateTarget(),Be=P.default.getTransformCameraLookingAtTarget(this.view,this.camera,Re),Q.copy(vt.viewCoords),this.view.getPickingPositionFromDepth(vt.viewCoords,Te)&&(Se.radius=Te.length(),Ie.copy(Te).normalize(),this.updateHelper(Te,be.picking)),ce.copy(vt.viewCoords),X.copy(vt.viewCoords)}},{key:"handleRotation",value:function(vt){this.player.stop(),this.handlePanoramic(vt)}},{key:"handleDrag",value:function(vt){var ct=this.view.viewToNormalizedCoords(vt.viewCoords);this.camera.updateMatrixWorld(),oe.setFromCamera(ct,this.camera),oe.ray.intersectSphere(Se,me)?(re.copy(me).normalize(),pe.setFromUnitVectors(re,Ie),Je=Date.now(),this.update()):this.states.onPointerUp()}},{key:"handleDolly",value:function(vt){se.copy(vt.viewCoords),ue.subVectors(se,ce),this.dolly(-ue.y),ce.copy(se),this.update()}},{key:"handlePan",value:function(vt){vt.viewCoords?(G.copy(vt.viewCoords),j.subVectors(G,X),X.copy(G)):vt.direction&&j.copy(te[vt.direction]).multiplyScalar(this.keyPanSpeed),this.mouseToPan(j.x,j.y),this.update(this.states.PAN)}},{key:"handlePanoramic",value:function(vt){Z.copy(vt.viewCoords),ae.subVectors(Z,Q);var ct=this.view.mainLoop.gfxEngine;W.theta-=2*Math.PI*ae.x/ct.width*this.rotateSpeed,W.phi-=2*Math.PI*ae.y/ct.height*this.rotateSpeed,Q.copy(Z),this.update()}},{key:"handleEndMovement",value:function(){var vt=this,ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.dispatchEvent(this.endEvent),this.player.stop(),this.enableDamping?ct.previous===this.states.ORBIT&&(W.theta>q||W.phi>q)?(this.player.setCallback(function(){vt.update(vt.states.ORBIT)}),this.player.play(ye),this._onEndingMove=function(){return vt.onEndingMove()},this.player.addEventListener("animation-stopped",this._onEndingMove)):ct.previous===this.states.MOVE_GLOBE&&Date.now()-Je<50?(this.player.setCallback(function(){vt.update(vt.states.MOVE_GLOBE)}),this.player.play(tt),this._onEndingMove=function(){return vt.onEndingMove()},this.player.addEventListener("animation-stopped",this._onEndingMove)):this.onEndingMove():this.onEndingMove()}},{key:"updateTarget",value:function(){if(this.view.getPickingPositionFromDepth(null,Re)){var vt=isNaN(Re.x)?100:this.camera.position.distanceTo(Re);_e.set(0,0,-vt),this.camera.localToWorld(_e),Ue(_e,Ee),Ee.matrixWorldInverse.copy(Ee.matrixWorld).invert(),_e.copy(this.camera.position),_e.applyMatrix4(Ee.matrixWorldInverse),F.setFromVector3(_e)}}},{key:"handlingEvent",value:function(vt){vt=vt||P.default.getTransformCameraLookingAtTarget(this.view,this.camera);var ct=P.default.getDiffParams(Be,vt);if(ct&&(ct.range&&this.dispatchEvent({type:we.RANGE_CHANGED,previous:ct.range.previous,new:ct.range.new}),ct.coord&&this.dispatchEvent({type:we.CAMERA_TARGET_CHANGED,previous:ct.coord.previous,new:ct.coord.new}),ct.tilt||ct.heading)){var Dt={type:we.ORIENTATION_CHANGED};ct.tilt&&(Dt.previous={tilt:ct.tilt.previous},Dt.new={tilt:ct.tilt.new}),ct.heading&&(Dt.previous=Dt.previous||{},Dt.new=Dt.new||{},Dt.new.heading=ct.heading.new,Dt.previous.heading=ct.heading.previous),this.dispatchEvent(Dt)}}},{key:"travel",value:function(vt){this.player.stop();var ct=this.view.getPickingPositionFromDepth(vt.viewCoords),Dt=this.getRange(ct);if(ct&&Dt>this.minDistance)return this.lookAtCoordinate({coord:new B.default("EPSG:4978",ct),range:Dt*(vt.direction==="out"?1/.6:.6),time:1500})}},{key:"handleZoom",value:function(vt){this.player.stop(),P.default.stop(this.view,this.camera),this.updateTarget();var ct=-vt.delta;this.dolly(ct);var Dt=this.getRange(Re);this.update();var fr=this.getRange(Re);Math.abs(fr-Dt)/Dt>.001&&this.dispatchEvent({type:we.RANGE_CHANGED,previous:Dt,new:fr}),this.dispatchEvent(this.startEvent),this.dispatchEvent(this.endEvent)}},{key:"onTouchStart",value:function(vt){if(this.player.stop(),this.states.enabled!==!1&&(this.state=this.states.touchToState(vt.touches.length),this.updateTarget(),this.state!==this.states.NONE)){switch(this.state){case this.states.MOVE_GLOBE:{var ct=this.view.eventToViewCoords(vt);this.view.getPickingPositionFromDepth(ct,Te)?(Se.radius=Te.length(),Ie.copy(Te).normalize(),this.updateHelper(Te,be.picking)):this.state=this.states.NONE;break}case this.states.ORBIT:case this.states.DOLLY:{var Dt=vt.touches[0].pageX,fr=vt.touches[0].pageY,er=Dt-vt.touches[1].pageX,dr=fr-vt.touches[1].pageY,zr=Math.sqrt(er*er+dr*dr);ce.set(0,zr),Q.set(Dt,fr);break}case this.states.PAN:X.set(vt.touches[0].pageX,vt.touches[0].pageY);break}this.dispatchEvent(this.startEvent)}}},{key:"onTouchMove",value:function(vt){if(this.player.isPlaying()&&this.player.stop(),this.states.enabled!==!1){switch(vt.preventDefault(),vt.stopPropagation(),vt.touches.length){case this.states.MOVE_GLOBE.finger:{var ct=this.view.eventToViewCoords(vt),Dt=this.view.viewToNormalizedCoords(ct);this.camera.updateMatrixWorld(),oe.setFromCamera(Dt,this.camera),oe.ray.intersectSphere(Se,me)?(re.copy(me).normalize(),pe.setFromUnitVectors(re,Ie),Je=Date.now()):this.onTouchEnd();break}case this.states.ORBIT.finger:case this.states.DOLLY.finger:{var fr=this.view.mainLoop.gfxEngine;Z.set(vt.touches[0].pageX,vt.touches[0].pageY),ae.subVectors(Z,Q),this.rotateLeft(2*Math.PI*ae.x/fr.width*this.rotateSpeed),this.rotateUp(2*Math.PI*ae.y/fr.height*this.rotateSpeed),Q.copy(Z);var er=vt.touches[0].pageX-vt.touches[1].pageX,dr=vt.touches[0].pageY-vt.touches[1].pageY,zr=Math.sqrt(er*er+dr*dr);se.set(0,zr),ue.subVectors(se,ce),this.dolly(ue.y),ce.copy(se);break}case this.states.PAN.finger:G.set(vt.touches[0].pageX,vt.touches[0].pageY),j.subVectors(G,X),this.mouseToPan(j.x,j.y),X.copy(G);break;default:this.state=this.states.NONE}this.state!==this.states.NONE&&this.update(this.state)}}},{key:"onTouchEnd",value:function(){this.handleEndMovement({previous:this.state}),this.state=this.states.NONE}},{key:"dispose",value:function(){this.view.domElement.removeEventListener("touchstart",this._onTouchStart,!1),this.view.domElement.removeEventListener("touchend",this._onTouchEnd,!1),this.view.domElement.removeEventListener("touchmove",this._onTouchMove,!1),this.states.dispose(),this.states.removeEventListener("state-changed",this._onStateChange,!1),this.states.removeEventListener(this.states.ORBIT._event,this._onRotation,!1),this.states.removeEventListener(this.states.MOVE_GLOBE._event,this._onDrag,!1),this.states.removeEventListener(this.states.DOLLY._event,this._onDolly,!1),this.states.removeEventListener(this.states.PAN._event,this._onPan,!1),this.states.removeEventListener(this.states.PANORAMIC._event,this._onPanoramic,!1),this.states.removeEventListener("zoom",this._onZoom,!1),this.states.removeEventListener(this.states.TRAVEL_IN._event,this._onTravel,!1),this.states.removeEventListener(this.states.TRAVEL_OUT._event,this._onTravel,!1),this.dispatchEvent({type:"dispose"})}},{key:"setTilt",value:function(vt,ct){return this.lookAtCoordinate({tilt:vt},ct)}},{key:"setHeading",value:function(vt,ct){return this.lookAtCoordinate({heading:vt},ct)}},{key:"setRange",value:function(vt,ct){return this.lookAtCoordinate({range:vt},ct)}},{key:"getCameraTargetPosition",value:function(){return Ee.position}},{key:"getRange",value:function(vt){return P.default.getTransformCameraLookingAtTarget(this.view,this.camera,vt).range}},{key:"getTilt",value:function(vt){return P.default.getTransformCameraLookingAtTarget(this.view,this.camera,vt).tilt}},{key:"getHeading",value:function(vt){return P.default.getTransformCameraLookingAtTarget(this.view,this.camera,vt).heading}},{key:"pan",value:function(vt){return this.mouseToPan(vt.x,vt.y),this.update(this.states.PAN),Promise.resolve()}},{key:"getCameraOrientation",value:function(){return this.view.getPickingPositionFromDepth(null,Re),[this.getTilt(Re),this.getHeading(Re)]}},{key:"getCameraCoordinate",value:function(){return new B.default("EPSG:4978",this.camera.position).as("EPSG:4326")}},{key:"getLookAtCoordinate",value:function(){return P.default.getTransformCameraLookingAtTarget(this.view,this.camera).coord}},{key:"setAnimationEnabled",value:function(vt){et=vt}},{key:"isAnimationEnabled",value:function(){return et}},{key:"getZoom",value:function(){return this.view.tileLayer.computeTileZoomFromDistanceCamera(this.getRange(),this.view.camera)}},{key:"setZoom",value:function(vt,ct){return this.lookAtCoordinate({zoom:vt},ct)}},{key:"getScale",value:function(vt){return console.warn("Deprecated, use View#getScale instead."),this.view.getScale(vt)}},{key:"pixelsToMeters",value:function(vt){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.28;console.warn("Deprecated use View#getPixelsToMeters instead.");var Dt=this.getScale(ct);return vt*ct/Dt/1e3}},{key:"pixelsToDegrees",value:function(vt){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.28;console.warn("Deprecated, use View#getPixelsToMeters and GlobeControls#getMetersToDegrees instead.");var Dt=this.pixelsToMeters(vt,ct);return C.MathUtils.radToDeg(2*Math.asin(Dt/(2*V.ellipsoidSizes.x)))}},{key:"metersToPixels",value:function(vt){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.28;console.warn("Deprecated, use View#getMetersToPixels instead.");var Dt=this.getScale(ct);return ct/=1e3,vt*Dt/ct}},{key:"setScale",value:function(vt,ct,Dt){return this.lookAtCoordinate({scale:vt,pitch:ct},Dt)}},{key:"lookAtCoordinate",value:function(){var vt=this,ct=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.isAnimationEnabled();if(this.player.stop(),!ct.isExtent&&(ct.zoom?ct.range=this.view.tileLayer.computeDistanceCameraFromTileZoom(ct.zoom,this.view.camera):ct.scale&&(ct.range=this.view.getScaleFromDistance(ct.pitch,ct.scale),(ct.range<this.minDistance||ct.range>this.maxDistance)&&(console.warn("This scale ".concat(ct.scale," can not be reached")),ct.range=C.MathUtils.clamp(ct.range,this.minDistance,this.maxDistance))),ct.tilt!==void 0)){var fr=90-C.MathUtils.radToDeg(this.maxPolarAngle),er=90-C.MathUtils.radToDeg(this.minPolarAngle);(ct.tilt<fr||ct.tilt>er)&&(ct.tilt=C.MathUtils.clamp(ct.tilt,fr,er),console.warn("Tilt was clamped to ",ct.tilt," the interval is between ".concat(fr," and ").concat(er," degree")))}return Be=P.default.getTransformCameraLookingAtTarget(this.view,this.camera),Dt?(ct.callback=function(dr){return Ee.position.copy(dr.targetWorldPosition)},this.dispatchEvent({type:"animation-started"}),P.default.animateCameraToLookAtTarget(this.view,this.camera,ct).then(function(dr){return vt.dispatchEvent({type:"animation-ended"}),vt.handlingEvent(dr),dr})):P.default.transformCameraToLookAtTarget(this.view,this.camera,ct).then(function(dr){return Ee.position.copy(dr.targetWorldPosition),vt.handlingEvent(dr),dr})}},{key:"pickGeoPosition",value:function(vt){var ct=this.view.getPickingPositionFromDepth(vt);if(!!ct)return new B.default("EPSG:4978",ct).as("EPSG:4326")}}]),St}(C.EventDispatcher),wt=at;a.default=wt}(nw)),nw}var fw={},hw={},dw={},HT;function ad(){return HT||(HT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(Wi()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(id()),C=u(u2()),D=Bf();function B(N){var U=V();return function(){var H=(0,p.default)(N),q;if(U){var te=(0,p.default)(this).constructor;q=Reflect.construct(H,arguments,te)}else q=H.apply(this,arguments);return(0,y.default)(this,q)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function P(N,U){var H=typeof Symbol<"u"&&N[Symbol.iterator]||N["@@iterator"];if(!H){if(Array.isArray(N)||(H=L(N))||U&&N&&typeof N.length=="number"){H&&(N=H);var q=0,te=function(){};return{s:te,n:function(){return q>=N.length?{done:!0}:{done:!1,value:N[q++]}},e:function(W){throw W},f:te}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q=!0,Z=!1,ae;return{s:function(){H=H.call(N)},n:function(){var W=H.next();return Q=W.done,W},e:function(W){Z=!0,ae=W},f:function(){try{!Q&&H.return!=null&&H.return()}finally{if(Z)throw ae}}}}function L(N,U){if(!!N){if(typeof N=="string")return E(N,U);var H=Object.prototype.toString.call(N).slice(8,-1);if(H==="Object"&&N.constructor&&(H=N.constructor.name),H==="Map"||H==="Set")return Array.from(N);if(H==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(H))return E(N,U)}}function E(N,U){(U==null||U>N.length)&&(U=N.length);for(var H=0,q=new Array(U);H<U;H++)q[H]=N[H];return q}function b(N){if(N.dispose)N.dispose();else if(N.geometry&&N.geometry.dispose(),N.material)if(Array.isArray(N.material)){var U=P(N.material),H;try{for(U.s();!(H=U.n()).done;){var q=H.value;q.dispose()}}catch(te){U.e(te)}finally{U.f()}}else N.material.dispose()}function _(N,U){var H=P(N.children),q;try{for(H.s();!(q=H.n()).done;){var te=q.value;_(te,U)}}catch(Q){H.e(Q)}finally{H.f()}U(N)}var x=function(N){(0,v.default)(H,N);var U=B(H);function H(q,te){var Q,Z,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if((0,h.default)(this,H),ae.cacheLifeTime=(Q=ae.cacheLifeTime)!==null&&Q!==void 0?Q:D.CACHE_POLICIES.GEOMETRY,Z=U.call(this,q,ae),Z.isGeometryLayer=!0,!te||!te.isObject3D)throw new Error(`Missing/Invalid object3d parameter (must be a
                three.js Object3D instance)`);return te.type==="Group"&&te.name===""&&(te.name=q),Object.defineProperty((0,M.default)(Z),"object3d",{value:te,writable:!1,configurable:!0}),Z.opacity=1,Z.wireframe=!1,Z.attachedLayers=[],Z.visible=ae.visible==null?!0:ae.visible,Object.defineProperty(Z.zoom,"max",{value:1/0,writable:!1}),Z.filteringExtent=!Z.source.isFileSource,Z.structure="3d",Z}return(0,R.default)(H,[{key:"getObjectToUpdateForAttachedLayers",value:function(te){if(te.parent&&te.material)return{element:te,parent:te.parent}}},{key:"postUpdate",value:function(){}},{key:"culling",value:function(){return!0}},{key:"attach",value:function(te){if(!te.update)throw new Error(`Missing 'update' function -> can't attach layer
                `.concat(te.id));this.attachedLayers.push(te),te.parent=this}},{key:"detach",value:function(te){var Q=this.attachedLayers.length;return this.attachedLayers=this.attachedLayers.filter(function(Z){return Z.id!=te.id}),te.parent=void 0,this.attachedLayers.length<Q}},{key:"delete",value:function(){var te=this;this.parent&&_(this.parent.object3d,function(Q){Q.layer&&Q.layer.id==te.id&&(Q.parent.remove(Q),b(Q))}),this.object3d.parent&&this.object3d.parent.remove(this.object3d),this.object3d.traverse(b)}},{key:"pickObjectsAt",value:function(te,Q){var Z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.options.defaultPickingRadius,ae=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];return C.default.pickObjectsAt(te,Q,Z,this.object3d,ae,this.threejsLayer)}}]),H}(g.default),T=x;a.default=T}(dw)),dw}var pw={},mw={},vw={},qT;function h2(){return qT||(qT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.geoidLayerIsVisible=B;var h=u(Ir()),R=u(kr()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(id()),g=u(l2());function C(L){var E=D();return function(){var b=(0,y.default)(L),_;if(E){var x=(0,y.default)(this).constructor;_=Reflect.construct(b,arguments,x)}else _=b.apply(this,arguments);return(0,v.default)(this,_)}}function D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function B(L){var E;return L==null||(E=L.attachedLayers.filter(function(b){return b.isGeoidLayer})[0])===null||E===void 0?void 0:E.visible}var V=function(L){(0,M.default)(b,L);var E=C(b);function b(_){var x,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,h.default)(this,b),x=E.call(this,_,T),x.isGeoidLayer=!0,x.defineLayerProperty("visible",!0),x}return(0,R.default)(b,[{key:"updateNodeZ",value:function(x){x.material.geoidHeight=this.visible?x.geoidHeight:0,x.obb.updateZ({geoidHeight:x.material.geoidHeight})}},{key:"update",value:function(x,T,N,U){var H=this;if(!(!U||!N.material)){var q=N.getExtentsByProjection(T.crs),te=q[0].zoom;if(!(te>T.zoom.max||te<T.zoom.min)){if(N.layerUpdateState[T.id]===void 0){N.layerUpdateState[T.id]=new g.default;var Q=function(){return H.updateNodeZ(N)};T.addEventListener("visible-property-changed",Q),N.addEventListener("dispose",function(){T.removeEventListener("visible-property-changed",Q)})}if(!(T.frozen||!T.visible||!N.material.visible||!N.layerUpdateState[T.id].canTryUpdate()))return N.layerUpdateState[T.id].newTry(),this.getData(N.extent,q).then(function(Z){N.geoidHeight=Z.getHeightAtCoordinates(N.extent.center()),H.updateNodeZ(N),N.layerUpdateState[T.id].noMoreUpdatePossible()})}}}}]),b}(p.default),P=V;a.default=P}(vw)),vw}var XT;function cI(){return XT||(XT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=u(Kh()),D=L(Dr()),B=u(ps()),V=h2();function P(Q){if(typeof WeakMap!="function")return null;var Z=new WeakMap,ae=new WeakMap;return(P=function(W){return W?ae:Z})(Q)}function L(Q,Z){if(!Z&&Q&&Q.__esModule)return Q;if(Q===null||h(Q)!=="object"&&typeof Q!="function")return{default:Q};var ae=P(Z);if(ae&&ae.has(Q))return ae.get(Q);var F={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in Q)if(O!=="default"&&Object.prototype.hasOwnProperty.call(Q,O)){var X=W?Object.getOwnPropertyDescriptor(Q,O):null;X&&(X.get||X.set)?Object.defineProperty(F,O,X):F[O]=Q[O]}return F.default=Q,ae&&ae.set(Q,F),F}function E(Q,Z){var ae=typeof Symbol<"u"&&Q[Symbol.iterator]||Q["@@iterator"];if(!ae){if(Array.isArray(Q)||(ae=b(Q))||Z&&Q&&typeof Q.length=="number"){ae&&(Q=ae);var F=0,W=function(){};return{s:W,n:function(){return F>=Q.length?{done:!0}:{done:!1,value:Q[F++]}},e:function(K){throw K},f:W}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var O=!0,X=!1,G;return{s:function(){ae=ae.call(Q)},n:function(){var K=ae.next();return O=K.done,K},e:function(K){X=!0,G=K},f:function(){try{!O&&ae.return!=null&&ae.return()}finally{if(X)throw G}}}}function b(Q,Z){if(!!Q){if(typeof Q=="string")return _(Q,Z);var ae=Object.prototype.toString.call(Q).slice(8,-1);if(ae==="Object"&&Q.constructor&&(ae=Q.constructor.name),ae==="Map"||ae==="Set")return Array.from(Q);if(ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae))return _(Q,Z)}}function _(Q,Z){(Z==null||Z>Q.length)&&(Z=Q.length);for(var ae=0,F=new Array(Z);ae<Z;ae++)F[ae]=Q[ae];return F}function x(Q){var Z=T();return function(){var ae=(0,g.default)(Q),F;if(Z){var W=(0,g.default)(this).constructor;F=Reflect.construct(ae,arguments,W)}else F=ae.apply(this,arguments);return(0,p.default)(this,F)}}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function N(Q,Z,ae){U(Q,Z),Z.set(Q,ae)}function U(Q,Z){if(Z.has(Q))throw new TypeError("Cannot initialize the same private elements twice on an object")}var H=new WeakMap,q=function(Q){(0,y.default)(ae,Q);var Z=x(ae);function ae(F,W,O,X){var G,j=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if((0,R.default)(this,ae),G=Z.call(this,F,W),N((0,v.default)(G),H,{writable:!0,value:new Map}),!X)throw new Error("extent is mandatory to build a TileMesh");G.layer=O,G.extent=X,G.extent.zoom=j,G.level=j,G.material.objectId=G.id,G.obb=G.geometry.OBB.clone(),G.boundingSphere=new D.Sphere,G.obb.box3D.getBoundingSphere(G.boundingSphere);var K=E(O.tileMatrixSets),ce;try{for(K.s();!(ce=K.n()).done;){var se=ce.value;(0,C.default)((0,v.default)(G),H).set(se,G.extent.tiledCovering(se))}}catch(ue){K.e(ue)}finally{K.f()}return G.frustumCulled=!1,G.matrixAutoUpdate=!1,G.rotationAutoUpdate=!1,G.layerUpdateState={},G.isTileMesh=!0,G.domElements={},G.geoidHeight=0,G.link=[],G}return(0,M.default)(ae,[{key:"setBBoxZ",value:function(W){W.geoidHeight=(0,V.geoidLayerIsVisible)(this.layer)?this.geoidHeight:0,this.obb.updateZ(W),this.horizonCullingPointElevationScaled&&this.horizonCullingPointElevationScaled.setLength(this.obb.z.delta+this.horizonCullingPoint.length()),this.obb.box3D.getBoundingSphere(this.boundingSphere)}},{key:"getExtentsByProjection",value:function(W){return(0,C.default)(this,H).get(B.default.formatToTms(W))}},{key:"findCommonAncestor",value:function(W){if(!!W)return W.level==this.level?W.id==this.id?W:W.level!=0?this.parent.findCommonAncestor(W.parent):void 0:W.level<this.level?this.parent.findCommonAncestor(W):this.findCommonAncestor(W.parent)}},{key:"onBeforeRender",value:function(){this.material.layersNeedUpdate&&this.material.updateLayersUniforms()}},{key:"findClosestDomElement",value:function(W){if(this.parent.isTileMesh)return this.parent.domElements[W]||this.parent.findClosestDomElement(W)}}]),ae}(D.Mesh),te=q;a.default=te}(mw)),mw}var gw={},ZT;function fI(){return ZT||(ZT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=V;var R=C(Dr()),M=u(wC()),v=u(Bf()),y=u(AC()),p=u(KM());function g(P){if(typeof WeakMap!="function")return null;var L=new WeakMap,E=new WeakMap;return(g=function(_){return _?E:L})(P)}function C(P,L){if(!L&&P&&P.__esModule)return P;if(P===null||h(P)!=="object"&&typeof P!="function")return{default:P};var E=g(L);if(E&&E.has(P))return E.get(P);var b={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in P)if(x!=="default"&&Object.prototype.hasOwnProperty.call(P,x)){var T=_?Object.getOwnPropertyDescriptor(P,x):null;T&&(T.get||T.set)?Object.defineProperty(b,x,T):b[x]=P[x]}return b.default=P,E&&E.set(P,b),b}var D=new Map,B=new v.default;function V(P,L){var E=P.computeSharableExtent(L.extent),b=E.sharableExtent,_=E.quaternion,x=E.position,T=b.south.toFixed(6),N="".concat(P.crs,"_").concat(L.disableSkirt?0:1,"_").concat(L.segment),U=B.get(T,L.level,N);if(!U){var H;U=new Promise(function(Z){H=Z}),B.set(U,T,L.level,N),L.extent=b,L.center=P.center(L.extent).clone();var q=D.get(N);L.buildIndexAndUv_0=!q,L.builder=P;var te;try{te=(0,y.default)(L)}catch(Z){return Promise.reject(Z)}q||(q={},q.index=new R.BufferAttribute(te.index,1),q.uv=new R.BufferAttribute(te.uvs[0],2),D.set(N,q)),te.index=q.index,te.uvs[0]=q.uv,te.position=new R.BufferAttribute(te.position,3),te.normal=new R.BufferAttribute(te.normal,3),L.builder.uvCount>1&&(te.uvs[1]=new R.BufferAttribute(te.uvs[1],1));var Q=new M.default(L,te);return Q.OBB=new p.default(Q.boundingBox.min,Q.boundingBox.max),Q._count=0,Q.dispose=function(){Q._count--,Q._count<=0&&(Q.index=null,delete Q.attributes.uv_0,R.BufferGeometry.prototype.dispose.call(Q),B.delete(T,L.level,N))},H(Q),Promise.resolve({geometry:Q,quaternion:_,position:x})}return U.then(function(Z){return{geometry:Z,quaternion:_,position:x}})}}(gw)),gw}var jT;function hI(){return jT||(jT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=D(Dr()),M=u(cI()),v=u(rd()),y=u(fI()),p=u(YM()),g=h2();function C(L){if(typeof WeakMap!="function")return null;var E=new WeakMap,b=new WeakMap;return(C=function(x){return x?b:E})(L)}function D(L,E){if(!E&&L&&L.__esModule)return L;if(L===null||h(L)!=="object"&&typeof L!="function")return{default:L};var b=C(E);if(b&&b.has(L))return b.get(L);var _={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in L)if(T!=="default"&&Object.prototype.hasOwnProperty.call(L,T)){var N=x?Object.getOwnPropertyDescriptor(L,T):null;N&&(N.get||N.set)?Object.defineProperty(_,T,N):_[T]=L[T]}return _.default=L,b&&b.set(L,_),_}var B=new R.Vector2;function V(L,E){if(E.diffuse&&(L.material.diffuse=E.diffuse),E.isGlobeLayer){L.horizonCullingPoint=L.extent.center().as("EPSG:4978").toVector3(),L.extent.planarDimensions(B).multiplyScalar(R.MathUtils.DEG2RAD);var b=B.length(),_=Math.abs(1/Math.cos(b*.5));L.horizonCullingPoint.setLength(_*L.horizonCullingPoint.length()),L.horizonCullingPointElevationScaled=L.horizonCullingPoint.clone()}}var P={convert:function(E,b,_){var x=_.builder,T=E,N=T!==void 0?T.level+1:0,U={extent:b,level:N,segment:_.segments||16,disableSkirt:_.disableSkirt};return(0,y.default)(x,U).then(function(H){H.geometry._count++;var q=_.tileMatrixSets.length,te=new v.default(_.materialOptions,q);(0,p.default)(te,_);var Q=new M.default(H.geometry,te,_,b,N);if(T&&T.isTileMesh){var Z=x.computeSharableExtent(T.extent);H.position.sub(Z.position).applyQuaternion(Z.quaternion.invert()),H.quaternion.premultiply(Z.quaternion)}if(Q.position.copy(H.position),Q.quaternion.copy(H.quaternion),Q.visible=!1,Q.updateMatrix(),Q.add(Q.obb),V(Q,_),T){Q.geoidHeight=T.geoidHeight;var ae=(0,g.geoidLayerIsVisible)(_)?Q.geoidHeight:0;Q.setBBoxZ({min:T.obb.z.min,max:T.obb.z.max,geoidHeight:ae}),Q.material.geoidHeight=ae}return Q})}};a.default=P}(pw)),pw}var ul={},yw={},YT;function EC(){return YT||(YT=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=h;var u=4;function h(R,M,v,y,p){if(!!M.layerUpdateState[v.id])if(R.isCancelledCommandException)M.layerUpdateState[v.id].success();else if(R instanceof SyntaxError)M.layerUpdateState[v.id].failure(0,!0);else{var g=M.layerUpdateState[v.id].errorCount>u;M.layerUpdateState[v.id].failure(Date.now(),g,{targetLevel:y}),g||window.setTimeout(function(){p.notifyChange(M,!1)},M.layerUpdateState[v.id].secondsUntilNextTry()*1e3)}}}(yw)),yw}var JT;function D0(){if(JT)return ul;JT=1;var a=hr.exports;Object.defineProperty(ul,"__esModule",{value:!0}),ul.SIZE_TEXTURE_TILE=ul.SIZE_DIAGONAL_TEXTURE=void 0,ul.removeLayeredMaterialNodeLayer=B,ul.updateLayeredMaterialNodeElevation=D,ul.updateLayeredMaterialNodeImagery=C;var u=qM(),h=a(l2()),R=a(EC()),M=256;ul.SIZE_TEXTURE_TILE=M;var v=Math.pow(2*(M*M),.5);ul.SIZE_DIAGONAL_TEXTURE=v;function y(V){return V.visible?100:10}function p(V){return!V.requester.parent||!V.requester.material||V.layer.isElevationLayer&&V.requester.material.getElevationLayer()&&V.targetLevel<=V.requester.material.getElevationLayer().level||!V.requester.layerUpdateState[V.layer.id]||!V.layer.source._featuresCaches[V.layer.crs]?!0:!V.requester.material.visible}function g(V,P,L,E,b){return{view:V,layer:P,extentsSource:L,extentsDestination:E,requester:b,priority:y(b.material),earlyDropFunction:p}}function C(V,P,L,E){var b=L.material;if(!(!E||!b)){var _=L.getExtentsByProjection(P.crs),x=_[0].zoom;if(!(x>P.zoom.max||x<P.zoom.min)){var T=b.getLayer(P.id);if(L.layerUpdateState[P.id]===void 0){if(L.layerUpdateState[P.id]=new h.default,!P.source.extentInsideLimit(L.extent,x)&&!(!P.noTextureParentOutsideLimit&&E.material&&E.material.getLayer&&E.material.getLayer(P.id))){L.layerUpdateState[P.id].noMoreUpdatePossible();return}if(!T){var N;T=P.setupRasterNode(L);var U=(N=E.material)===null||N===void 0?void 0:N.getLayer(P.id);T.initFromParent(U,_)}if(T.level>=P.source.zoom.min){V.view.notifyChange(L,!1);return}}if(!!b.visible&&!(!P.visible||!L.layerUpdateState[P.id].canTryUpdate())){if(T.level>=_[0].zoom){L.layerUpdateState[P.id].noMoreUpdatePossible();return}if(!P.frozen){var H=L.layerUpdateState[P.id].failureParams,q=_[0].zoom||L.level,te=(0,u.chooseNextLevelToFetch)(P.updateStrategy.type,L,q,T.level,P,H);if(!P.source.isVectorSource&&te<=T.level||te>q){H.lowestLevelError!=1/0&&L.layerUpdateState[P.id].noMoreUpdatePossible();return}else if(!P.source.extentInsideLimit(L.extent,te)){L.layerUpdateState[P.id].noData({targetLevel:te}),V.view.notifyChange(L,!1);return}var Q=_.map(function(ae){return ae.tiledExtentParent(te)});L.layerUpdateState[P.id].newTry();var Z=g(V.view,P,Q,_,L);return V.scheduler.execute(Z).then(function(ae){if(!!L.layerUpdateState[P.id]){var F=_.map(function(W,O){return W.offsetToParent(ae[O].extent,T.offsetScales[O])});T.setTextures(ae,F),L.layerUpdateState[P.id].success()}},function(ae){return(0,R.default)(ae,L,P,te,V.view)})}}}}}function D(V,P,L,E){var b=L.material;if(!(!E||!b)){var _=L.getExtentsByProjection(P.crs),x=_[0].zoom;if(!(x>P.zoom.max||x<P.zoom.min)){var T=b.getElevationLayer();if(T||(T=P.setupRasterNode(L)),L.layerUpdateState[P.id]===void 0){var N;L.layerUpdateState[P.id]=new h.default;var U=(N=E.material)===null||N===void 0?void 0:N.getLayer(P.id);if(T.initFromParent(U,_),T.level>=P.source.zoom.min){V.view.notifyChange(L,!1);return}}if(!(P.frozen||!b.visible||!L.layerUpdateState[P.id].canTryUpdate())){var H=L.layerUpdateState[P.id].failureParams,q=(0,u.chooseNextLevelToFetch)(P.updateStrategy.type,L,_[0].zoom,T.level,P,H);if(q<=T.level||q>_[0].zoom){L.layerUpdateState[P.id].noMoreUpdatePossible();return}else if(!P.source.extentInsideLimit(L.extent,q)){L.layerUpdateState[P.id].noData({targetLevel:q}),V.view.notifyChange(L,!1);return}var te=_.map(function(Z){return Z.tiledExtentParent(q)});L.layerUpdateState[P.id].newTry();var Q=g(V.view,P,te,_,L);return V.scheduler.execute(Q).then(function(Z){if(!!L.layerUpdateState[P.id]){if(q<=T.level){L.layerUpdateState[P.id].noMoreUpdatePossible();return}var ae=_.map(function(F,W){return F.offsetToParent(Z[W].extent,T.offsetScales[W])});T.setTextures(Z,ae),L.layerUpdateState[P.id].success()}},function(Z){return(0,R.default)(Z,L,P,q,V.view)})}}}}function B(V){return function(P){var L;(L=P.material)!==null&&L!==void 0&&L.removeLayer&&(P.material.removeLayer(V),P.material.elevationLayerIds[0]==V&&P.setBBoxZ({min:0,max:0})),P.layerUpdateState&&P.layerUpdateState[V]&&delete P.layerUpdateState[V]}}return ul}var $T;function eb(){return $T||($T=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Qh()),M=u(Ir()),v=u(kr()),y=u(Wi()),p=u(dn()),g=u(pn()),C=u(ln()),D=N(Dr()),B=u(ad()),V=YR(),P=u(u2()),L=u(hI()),E=u(JM()),b=D0(),_=id(),x=Bf();function T(O){if(typeof WeakMap!="function")return null;var X=new WeakMap,G=new WeakMap;return(T=function(K){return K?G:X})(O)}function N(O,X){if(!X&&O&&O.__esModule)return O;if(O===null||h(O)!=="object"&&typeof O!="function")return{default:O};var G=T(X);if(G&&G.has(O))return G.get(O);var j={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in O)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(O,ce)){var se=K?Object.getOwnPropertyDescriptor(O,ce):null;se&&(se.get||se.set)?Object.defineProperty(j,ce,se):j[ce]=O[ce]}return j.default=O,G&&G.set(O,j),j}function U(O,X){var G=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(!G){if(Array.isArray(O)||(G=H(O))||X&&O&&typeof O.length=="number"){G&&(O=G);var j=0,K=function(){};return{s:K,n:function(){return j>=O.length?{done:!0}:{done:!1,value:O[j++]}},e:function(pe){throw pe},f:K}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ce=!0,se=!1,ue;return{s:function(){G=G.call(O)},n:function(){var pe=G.next();return ce=pe.done,pe},e:function(pe){se=!0,ue=pe},f:function(){try{!ce&&G.return!=null&&G.return()}finally{if(se)throw ue}}}}function H(O,X){if(!!O){if(typeof O=="string")return q(O,X);var G=Object.prototype.toString.call(O).slice(8,-1);if(G==="Object"&&O.constructor&&(G=O.constructor.name),G==="Map"||G==="Set")return Array.from(O);if(G==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(G))return q(O,X)}}function q(O,X){(X==null||X>O.length)&&(X=O.length);for(var G=0,j=new Array(X);G<X;G++)j[G]=O[G];return j}function te(O){var X=Q();return function(){var G=(0,C.default)(O),j;if(X){var K=(0,C.default)(this).constructor;j=Reflect.construct(G,arguments,K)}else j=G.apply(this,arguments);return(0,g.default)(this,j)}}function Q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Z=new D.Vector3,ae=new D.Vector3,F=function(O){(0,p.default)(G,O);var X=te(G);function G(j,K,ce,se,ue){var Y;if((0,M.default)(this,G),ue.cacheLifeTime=x.CACHE_POLICIES.INFINITE,ue.source=!1,Y=X.call(this,j,K,ue),Y.isTiledGeometryLayer=!0,Y.object3d.geoidHeight=0,Y.protocol="tile",Y.sseSubdivisionThreshold=Y.sseSubdivisionThreshold||1,Y.schemeTile=ce,Y.builder=se,Y.info=new V.InfoTiledGeometryLayer((0,y.default)(Y)),!Y.schemeTile)throw new Error("Cannot init tiled layer without schemeTile for layer ".concat(Y.id));if(!Y.builder)throw new Error("Cannot init tiled layer without builder for layer ".concat(Y.id));Y.level0Nodes=[];var pe=[],Ee=U(Y.schemeTile),Fe;try{for(Ee.s();!(Fe=Ee.n()).done;){var $e=Fe.value;pe.push(Y.convert(void 0,$e))}}catch(pt){Ee.e(pt)}finally{Ee.f()}return Y._promises.push(Promise.all(pe).then(function(pt){var Ue;Y.level0Nodes=pt,(Ue=Y.object3d).add.apply(Ue,(0,R.default)(pt)),Y.object3d.updateMatrixWorld()})),Y}return(0,v.default)(G,[{key:"pickObjectsAt",value:function(K,ce){var se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.options.defaultPickingRadius,ue=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];return P.default.pickTilesAt(K,ce,se,this,ue)}},{key:"preUpdate",value:function(K,ce){var se=this;if(ce.has(void 0)||ce.size==0)return this.level0Nodes;K.colorLayers=K.view.getLayers(function(Ue,Je){return Je&&Je.id==se.id&&Ue.isColorLayer}),K.elevationLayers=K.view.getLayers(function(Ue,Je){return Je&&Je.id==se.id&&Ue.isElevationLayer}),K.maxElevationLevel=-1;var ue=U(K.elevationLayers),Y;try{for(ue.s();!(Y=ue.n()).done;){var pe=Y.value;K.maxElevationLevel=Math.max(pe.source.zoom.max,K.maxElevationLevel)}}catch(Ue){ue.e(Ue)}finally{ue.f()}K.maxElevationLevel==-1&&(K.maxElevationLevel=1/0),this.colorLayersOrder=_.ImageryLayers.getColorLayersIdOrderedBySequence(K.colorLayers);var Ee,Fe=U(ce.values()),$e;try{for(Fe.s();!($e=Fe.n()).done;){var pt=$e.value;if(pt.isCamera)return this.level0Nodes;if(pt.layer===this){if(!Ee)Ee=pt;else if(Ee=pt.findCommonAncestor(Ee),!Ee)return this.level0Nodes;Ee.material==null&&(Ee=void 0)}}}catch(Ue){Fe.e(Ue)}finally{Fe.f()}return Ee?[Ee]:this.level0Nodes}},{key:"update",value:function(K,ce,se){var ue=this;if(!se.parent)return E.default.removeChildrenAndCleanup(this,se);if(se.parent.pendingSubdivision){se.visible=!1,se.material.visible=!1,this.info.update(se);return}if(se.visible=!this.culling(se,K.camera),se.visible){var Y=!1;return se.material.visible=!0,this.info.update(se),(se.pendingSubdivision||G.hasEnoughTexturesToSubdivide(K,se)&&this.subdivision(K,this,se))&&(this.subdivideNode(K,se),se.material.visible=se.pendingSubdivision,this.info.update(se),Y=!0),se.material.visible&&!Y?E.default.removeChildren(this,se):Y?se.children.filter(function(pe){return pe.layer==ue}):void 0}return se.material.visible=!1,this.info.update(se),E.default.removeChildren(this,se)}},{key:"convert",value:function(K,ce){return L.default.convert(K,ce,this)}},{key:"countColorLayersTextures",value:function(){return arguments.length}},{key:"culling",value:function(K,ce){return!ce.isBox3Visible(K.obb.box3D,K.obb.matrixWorld)}},{key:"subdivideNode",value:function(K,ce){var se=this;if(!ce.pendingSubdivision&&!ce.children.some(function(pe){return pe.layer==se})){var ue=ce.extent.subdivision();ce.pendingSubdivision=!0;var Y={view:K.view,requester:ce,layer:this,priority:1e4,extentsSource:ue,redraw:!1};return K.scheduler.execute(Y).then(function(pe){var Ee=U(pe),Fe;try{for(Ee.s();!(Fe=Ee.n()).done;){var $e=Fe.value;ce.add($e),$e.updateMatrixWorld(!0)}}catch(pt){Ee.e(pt)}finally{Ee.f()}ce.pendingSubdivision=!1,K.view.notifyChange(ce,!1)},function(pe){if(ce.pendingSubdivision=!1,!pe.isCancelledCommandException)throw new Error(pe)})}}},{key:"subdivision",value:function(K,ce,se){if(se.level<this.minSubdivisionLevel)return!0;if(this.maxSubdivisionLevel<=se.level)return!1;var ue=se.material.getElevationLayer();if(ue){var Y=ue.textures[0];if(Y&&Y.extent){var pe=ue.offsetScales[0],Ee=pe.z;if(Ee<1/Math.pow(2,this.maxDeltaElevationLevel))return!1}}Z.setFromMatrixScale(se.matrixWorld),ae.copy(se.boundingSphere.center).applyMatrix4(se.matrixWorld);var Fe=Math.max(0,K.camera.camera3D.position.distanceTo(ae)-se.boundingSphere.radius*Z.x);if(K.camera.camera3D.isOrthographicCamera){var $e=K.camera.camera3D,pt=K.camera._preSSE*2*$e.zoom/($e.top-$e.bottom);se.screenSize=pt*se.boundingSphere.radius*Z.x}else se.screenSize=K.camera._preSSE*(2*se.boundingSphere.radius*Z.x)/Fe;var Ue=se.screenSize/(b.SIZE_DIAGONAL_TEXTURE*2);return this.sseSubdivisionThreshold<Ue}}],[{key:"hasEnoughTexturesToSubdivide",value:function(K,ce){var se=ce.layerUpdateState||{},ue=ce.material.getElevationLayer(),Y=U(K.elevationLayers),pe;try{for(Y.s();!(pe=Y.n()).done;){var Ee=pe.value,Fe=ce.getExtentsByProjection(Ee.crs),$e=Fe[0].zoom;if(!($e>Ee.zoom.max||$e<Ee.zoom.min)&&!Ee.frozen&&Ee.ready&&Ee.source.extentInsideLimit(ce.extent,$e)&&(!ue||ue.level<0)){if(se[Ee.id]&&se[Ee.id].inError())continue;return!1}}}catch(Xe){Y.e(Xe)}finally{Y.f()}var pt=U(K.colorLayers),Ue;try{for(pt.s();!(Ue=pt.n()).done;){var Je=Ue.value;if(!(Je.frozen||!Je.visible||!Je.ready)){var et=ce.getExtentsByProjection(Je.crs),ze=et[0].zoom;if(!(ze>Je.zoom.max||ze<Je.zoom.min)&&!(se[Je.id]&&se[Je.id].inError())&&(ue=ce.material.getLayer(Je.id),Je.source.extentInsideLimit(ce.extent,ze)&&(!ue||ue.level<0)))return!1}}}catch(Xe){pt.e(Xe)}finally{pt.f()}return!0}}]),G}(B.default),W=F;a.default=W}(hw)),hw}var QT;function TC(){return QT||(QT=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Cs()),y=u(dn()),p=u(pn()),g=u(ln()),C=_(Dr()),D=u(eb()),B=$h(),V=ya(),P=u(MC()),L=D0(),E=u(ps());function b(Z){if(typeof WeakMap!="function")return null;var ae=new WeakMap,F=new WeakMap;return(b=function(O){return O?F:ae})(Z)}function _(Z,ae){if(!ae&&Z&&Z.__esModule)return Z;if(Z===null||h(Z)!=="object"&&typeof Z!="function")return{default:Z};var F=b(ae);if(F&&F.has(Z))return F.get(Z);var W={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in Z)if(X!=="default"&&Object.prototype.hasOwnProperty.call(Z,X)){var G=O?Object.getOwnPropertyDescriptor(Z,X):null;G&&(G.get||G.set)?Object.defineProperty(W,X,G):W[X]=Z[X]}return W.default=Z,F&&F.set(Z,W),W}function x(Z){var ae=T();return function(){var F=(0,g.default)(Z),W;if(ae){var O=(0,g.default)(this).constructor;W=Reflect.construct(F,arguments,O)}else W=F.apply(this,arguments);return(0,p.default)(this,W)}}function T(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var N=new C.Matrix4,U=new C.Vector3,H=0,q=new C.Vector3,te=function(Z){(0,y.default)(F,Z);var ae=x(F);function F(W,O){var X,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};(0,R.default)(this,F);var j=V.schemeTiles.get(E.default.tms_4326),K=V.globalExtentTMS.get("EPSG:4326").subdivisionByScheme(j);G.tileMatrixSets=[E.default.tms_4326,E.default.tms_3857];var ce=G.tileMatrixSets.length,se=new P.default({crs:"EPSG:4978",uvCount:ce});X=ae.call(this,W,O||new C.Group,K,se,G),X.isGlobeLayer=!0,X.options.defaultPickingRadius=5,X.minSubdivisionLevel=X.minSubdivisionLevel==null?2:X.minSubdivisionLevel,X.maxSubdivisionLevel=X.maxSubdivisionLevel==null?19:X.maxSubdivisionLevel,X.maxDeltaElevation=X.maxDeltaElevation||4,X.extent=X.schemeTile[0].clone();for(var ue=1;ue<X.schemeTile.length;ue++)X.extent.union(X.schemeTile[ue]);return N.copy(X.object3d.matrixWorld).invert(),N.premultiply(new C.Matrix4().makeScale(1/B.ellipsoidSizes.x,1/B.ellipsoidSizes.y,1/B.ellipsoidSizes.z)),X}return(0,M.default)(F,[{key:"preUpdate",value:function(O,X){return U.copy(O.camera.camera3D.position).applyMatrix4(N),H=U.lengthSq()-1,(0,v.default)((0,g.default)(F.prototype),"preUpdate",this).call(this,O,X)}},{key:"countColorLayersTextures",value:function(){for(var O=0,X=arguments.length,G=new Array(X),j=0;j<X;j++)G[j]=arguments[j];for(var K=0,ce=G;K<ce.length;K++){var se=ce[K],ue=se.crs||se.source.crs;O+=ue=="EPSG:3857"?3:1}return O}},{key:"subdivision",value:function(O,X,G){if(G.level==5){var j=G.getExtentsByProjection(E.default.tms_4326)[0].row;if(j==31||j==0)return!1}return(0,v.default)((0,g.default)(F.prototype),"subdivision",this).call(this,O,X,G)}},{key:"culling",value:function(O,X){return(0,v.default)((0,g.default)(F.prototype),"culling",this).call(this,O,X)?!0:O.level<this.minSubdivisionLevel?!1:this.horizonCulling(O.horizonCullingPointElevationScaled)}},{key:"horizonCulling",value:function(O){q.copy(O).applyMatrix4(N),q.sub(U);var X=q.lengthSq(),G=-q.dot(U),j=H<0?G>0:H<G&&H<G*G/X;return j}},{key:"computeTileZoomFromDistanceCamera",value:function(O,X){var G=L.SIZE_DIAGONAL_TEXTURE*(this.sseSubdivisionThreshold*.5)/X._preSSE/B.ellipsoidSizes.x,j=O*G,K=Math.log(Math.PI/(2*Math.asin(j)))/Math.log(2),ce=Math.PI/Math.pow(2,K),se=2*B.ellipsoidSizes.x*Math.sin(ce*.5);return j=(O-se*.5)*G,K=Math.log(Math.PI/(2*Math.asin(j)))/Math.log(2),isNaN(K)?0:Math.round(K)}},{key:"computeDistanceCameraFromTileZoom",value:function(O,X){var G=Math.PI/Math.pow(2,O),j=2*B.ellipsoidSizes.x*Math.sin(G*.5),K=j*.5;return X._preSSE*(K/L.SIZE_DIAGONAL_TEXTURE)/(this.sseSubdivisionThreshold*.5)+K}}]),F}(D.default),Q=te;a.default=Q}(fw)),fw}var _w={},xw={},KT;function dI(){return KT||(KT=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Zi()),R={getSunPosition:function(){var y=Math,p=y.PI,g=y.sin,C=y.cos,D=y.tan,B=y.asin,V=y.atan2,P=p/180,L=P*23.4397;function E(Q){return Q.valueOf()/(1e3*60*60*24)-.5+2440588}function b(Q){return E(Q)-2451545}function _(Q,Z){return V(g(Q)*C(L)-D(Z)*g(L),C(Q))}function x(Q,Z){return B(g(Z)*C(L)+C(Z)*g(L)*g(Q))}function T(Q,Z,ae){return V(g(Q),C(Q)*g(Z)-D(ae)*C(Z))}function N(Q,Z,ae){return B(g(Z)*g(ae)+C(Z)*C(ae)*C(Q))}function U(Q,Z){return P*(280.16+360.9856235*Q)-Z}function H(Q){return P*(357.5291+.98560028*Q)}function q(Q){return P*(1.9148*g(Q)+.02*g(2*Q)+3e-4*g(3*Q))}function te(Q,Z){return Q+Z+P*102.9372+p}return function(Q,Z,ae){var F=P*Z,W=b(Q),O=H(W),X=q(O),G=te(O,X),j=x(G,0),K=_(G,0),ce=U(W,P*-ae),se=ce-K;return{EclipticLongitude:G,declinaison:j,ascension:K,H:se,SiderealTime:ce,altitude:N(se,F,j),azimuth:T(se,F,j)+p/2}}},getSunPositionInScene:function(y,p,g){var C=R.getSunPosition()(y,p,g),D=24*36e5,B=C.ascension+y%D/D*-360+180,V=new h.default("EPSG:4326",B,p,5e7).as("EPSG:4978").toVector3();return V}},M=R;a.default=M}(xw)),xw}var Aw={},eS;function pI(){return eS||(eS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(kr()),M=u(Ir()),v=u(dn()),y=u(pn()),p=u(ln()),g=D(Dr());function C(b){if(typeof WeakMap!="function")return null;var _=new WeakMap,x=new WeakMap;return(C=function(N){return N?x:_})(b)}function D(b,_){if(!_&&b&&b.__esModule)return b;if(b===null||h(b)!=="object"&&typeof b!="function")return{default:b};var x=C(_);if(x&&x.has(b))return x.get(b);var T={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in b)if(U!=="default"&&Object.prototype.hasOwnProperty.call(b,U)){var H=N?Object.getOwnPropertyDescriptor(b,U):null;H&&(H.get||H.set)?Object.defineProperty(T,U,H):T[U]=b[U]}return T.default=b,x&&x.set(b,T),T}function B(b){var _=V();return function(){var x=(0,p.default)(b),T;if(_){var N=(0,p.default)(this).constructor;T=Reflect.construct(x,arguments,N)}else T=x.apply(this,arguments);return(0,y.default)(this,T)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P={uniforms:{luminance:{type:"f",value:1},turbidity:{type:"f",value:2},reileigh:{type:"f",value:1},mieCoefficient:{type:"f",value:.005},mieDirectionalG:{type:"f",value:.8},v3LightPosition:{type:"v3",value:new g.Vector3},up:{type:"v3",value:new g.Vector3(0,1,0)}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix *  vec4( cameraPosition + position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( cameraPosition + position, 1.0 );","}"].join(`
`),fragmentShader:["uniform sampler2D skySampler;","uniform vec3 v3LightPosition;","uniform vec3 up;","varying vec3 vWorldPosition;","// uniform sampler2D sDiffuse;","// const float turbidity = 10.0; //","// const float reileigh = 2.; //","// const float luminance = 1.0; //","// const float mieCoefficient = 0.005;","// const float mieDirectionalG = 0.8;","uniform float luminance;","uniform float turbidity;","uniform float reileigh;","uniform float mieCoefficient;","uniform float mieDirectionalG;","// constants for atmospheric scattering","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003; // refractive index of air","const float N = 2.545E25; // number of molecules per unit volume for air at","// 288.15K and 1013mb (sea level -45 celsius)","const float pn = 0.035; // depolatization factor for standard air","// wavelength of used primaries, according to preetham","const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);","// mie stuff","// K coefficient for the primaries","const vec3 K = vec3(0.686, 0.678, 0.666);","const float v = 4.0;","// optical length at zenith for molecules","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float EE = 1000.0;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","// 66 arc seconds -> degrees, and the cosine of that","// earth shadow hack","const float cutoffAngle = pi/1.95;","const float steepness = 1.5;","vec3 totalRayleigh(vec3 lambda)","{","return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));","}","// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE","vec3 simplifiedRayleigh()","{","return 0.0005 / vec3(94, 40, 18);","}","float rayleighPhase(float cosTheta)","{ ","return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));","// return (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));","// return (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));","}","vec3 totalMie(vec3 lambda, vec3 K, float T)","{","float c = (0.2 * T ) * 10E-18;","return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;","}","float hgPhase(float cosTheta, float g)","{","return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));","}","float sunIntensity(float zenithAngleCos)","{","return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));","}","// float logLuminance(vec3 c)","// {","//     return log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);","// }","// Filmic ToneMapping http://filmicgames.com/archives/75","float A = 0.15;","float B = 0.50;","float C = 0.10;","float D = 0.20;","float E = 0.02;","float F = 0.30;","float W = 1000.0;","vec3 Uncharted2Tonemap(vec3 x)","{","return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;","}","void main() ","{","vec3 up2 = normalize(cameraPosition.xyz);","float sunfade = 1.0-clamp(1.0-exp((v3LightPosition.y/450000.0)),0.0,1.0);","float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));","vec3 sunDirection = normalize(v3LightPosition);","float sunE = sunIntensity(dot(sunDirection, up2));","// extinction (absorbtion + out scattering) ","// rayleigh coefficients","vec3 betaR = simplifiedRayleigh() * reileighCoefficient;","// mie coefficients","vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;","// optical length","// cutoff angle at 90 to avoid singularity in next formula.","float zenithAngle = acos(max(0.0, dot(up2, normalize(vWorldPosition - cameraPosition))));","float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","// combined extinction factor","vec3 Fex = exp(-(betaR * sR + betaM * sM));","// in scattering","float cosTheta = dot(normalize(vWorldPosition - cameraPosition), sunDirection);","float rPhase = rayleighPhase(cosTheta*0.5+0.5);","vec3 betaRTheta = betaR * rPhase;","float mPhase = hgPhase(cosTheta, mieDirectionalG);","vec3 betaMTheta = betaM * mPhase;","vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));","Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up2, sunDirection),5.0),0.0,1.0));","//nightsky","vec3 direction = normalize(vWorldPosition - cameraPosition);","float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]","float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]","vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);","// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;","vec3 L0 = vec3(0.1) * Fex;","// composition + solar disc","//if (cosTheta > sunAngularDiameterCos)","float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);","// if (normalize(vWorldPosition - cameraPosition).y>0.0)","L0 += (sunE * 19000.0 * Fex)*sundisk;","vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));","vec3 texColor = (Lin+L0);   ","texColor *= 0.04 ;","texColor += vec3(0.0,0.001,0.0025)*0.3;","float g_fMaxLuminance = 1.0;","float fLumScaled = 0.1 / luminance;     ","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); ","float ExposureBias = fLumCompressed;","vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);","vec3 color = curr*whiteScale;","vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));","gl_FragColor.rgb = retColor;","gl_FragColor.a = 1. - ( (length(cameraPosition) - 6400000.) / 1000.);","}"].join(`
`)},L=function(b){(0,v.default)(x,b);var _=B(x);function x(){(0,M.default)(this,x);var T=g.UniformsUtils.clone(P.uniforms),N=new g.ShaderMaterial({fragmentShader:P.fragmentShader,vertexShader:P.vertexShader,uniforms:T,side:g.BackSide,transparent:!0,depthWrite:!1}),U=new g.SphereBufferGeometry(4e4,32,15);return _.call(this,U,N)}return(0,R.default)(x)}(g.Mesh),E=L;a.default=E}(Aw)),Aw}var tS;function mI(){return tS||(tS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=E(Dr()),C=u(ad()),D=u(Zi()),B=$h(),V=u(dI()),P=u(pI());function L(ce){if(typeof WeakMap!="function")return null;var se=new WeakMap,ue=new WeakMap;return(L=function(pe){return pe?ue:se})(ce)}function E(ce,se){if(!se&&ce&&ce.__esModule)return ce;if(ce===null||h(ce)!=="object"&&typeof ce!="function")return{default:ce};var ue=L(se);if(ue&&ue.has(ce))return ue.get(ce);var Y={},pe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ee in ce)if(Ee!=="default"&&Object.prototype.hasOwnProperty.call(ce,Ee)){var Fe=pe?Object.getOwnPropertyDescriptor(ce,Ee):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(Y,Ee,Fe):Y[Ee]=ce[Ee]}return Y.default=ce,ue&&ue.set(ce,Y),Y}function b(ce){var se=_();return function(){var ue=(0,p.default)(ce),Y;if(se){var pe=(0,p.default)(this).constructor;Y=Reflect.construct(ue,arguments,pe)}else Y=ue.apply(this,arguments);return(0,y.default)(this,Y)}}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var x=`uniform vec3 v3LightPos;
uniform float g;
uniform float g2;

varying vec3 v3Direction;
varying vec3 c0;
varying vec3 c1;

// Calculates the Mie phase function
float getMiePhase(float fCos, float fCos2, float g, float g2) {
    return 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + fCos2) / pow(1.0 + g2 - 2.0 * g * fCos, 1.5);
}

// Calculates the Rayleigh phase function
float getRayleighPhase(float fCos2) {
    return 0.75 + 0.75 * fCos2;
}

void main (void) {
    float fCos = dot(v3LightPos, v3Direction) / length(v3Direction);
    float fCos2 = fCos * fCos;

    vec3 color = getRayleighPhase(fCos2) * c0 + getMiePhase(fCos, fCos2, g, g2) * c1;

    gl_FragColor = vec4(color, 1.0);
    gl_FragColor.a = gl_FragColor.b;
}`,T=`uniform vec3 v3LightPosition;   // The direction vector to the light source
uniform vec3 v3InvWavelength;   // 1 / pow(wavelength, 4) for the red, green, and blue channels
uniform float fCameraHeight;    // The camera's current height
uniform float fCameraHeight2;   // fCameraHeight^2
uniform float fOuterRadius;     // The outer (atmosphere) radius
uniform float fOuterRadius2;    // fOuterRadius^2
uniform float fInnerRadius;     // The inner (planetary) radius
uniform float fInnerRadius2;    // fInnerRadius^2
uniform float fKrESun;          // Kr * ESun
uniform float fKmESun;          // Km * ESun
uniform float fKr4PI;           // Kr * 4 * PI
uniform float fKm4PI;           // Km * 4 * PI
uniform float fScale;           // 1 / (fOuterRadius - fInnerRadius)
uniform float fScaleDepth;      // The scale depth (i.e. the altitude at which the atmosphere's average density is found)
uniform float fScaleOverScaleDepth; // fScale / fScaleDepth

const int nSamples = 3;
const float fSamples = 3.0;

varying vec3 v3Direction;
varying vec3 c0;
varying vec3 c1;

float scale(float fCos) {
    float x = 1.0 - fCos;
    return fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));
}

void main(void) {
    float lengthCamera = length(cameraPosition);
    float cameraHeight2 = lengthCamera * lengthCamera;

    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)
    vec3 v3Ray = position - cameraPosition;
    float fFar = length(v3Ray);
    v3Ray /= fFar;

    // Calculate the closest intersection of the ray with the outer atmosphere (which is the near point of the ray passing through the atmosphere)
    float B = 2.0 * dot(cameraPosition, v3Ray);
    float C = cameraHeight2 - fOuterRadius2;
    float fDet = max(0.0, B*B - 4.0 * C);
    float fNear = 0.5 * (-B - sqrt(fDet));

    // Calculate the ray's starting position, then calculate its scattering offset
    vec3 v3Start = cameraPosition + v3Ray * fNear;
    fFar -= fNear;
    float fStartAngle = dot(v3Ray, v3Start) / fOuterRadius;
    float fStartDepth = exp(-1.0 / fScaleDepth);
    float fStartOffset = fStartDepth * scale(fStartAngle);

    // Initialize the scattering loop variables
    float fSampleLength = fFar / fSamples;
    float fScaledLength = fSampleLength * fScale;
    vec3 v3SampleRay = v3Ray * fSampleLength;
    vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;

    // Now loop through the sample rays
    vec3 v3FrontColor = vec3(0.0, 0.0, 0.0);
    for(int i=0; i<nSamples; i++)
    {
        float fHeight = length(v3SamplePoint);
        float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));
        float fLightAngle = dot(v3LightPosition, v3SamplePoint) / fHeight;
        float fCameraAngle = dot(v3Ray, v3SamplePoint) / fHeight;
        float fScatter = (fStartOffset + fDepth * (scale(fLightAngle) - scale(fCameraAngle)));
        vec3 v3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));

        v3FrontColor += v3Attenuate * (fDepth * fScaledLength);
        v3SamplePoint += v3SampleRay;
    }

    // Finally, scale the Mie and Rayleigh colors and set up the varying variables for the pixel shader
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    c0 = v3FrontColor * (v3InvWavelength * fKrESun);
    c1 = v3FrontColor * fKmESun;
    v3Direction = cameraPosition - position;
}`,N=`varying vec3 c0;
varying vec3 c1;

void main (void) {
	gl_FragColor = vec4(c1, 1.0 - c0/4.);
}`,U=`uniform vec3 v3LightPosition;   // The direction vector to the light source
uniform vec3 v3InvWavelength;   // 1 / pow(wavelength, 4) for the red, green, and blue channels
uniform float fCameraHeight;    // The camera's current height
uniform float fCameraHeight2;   // fCameraHeight^2
uniform float fOuterRadius;     // The outer (atmosphere) radius
uniform float fOuterRadius2;    // fOuterRadius^2
uniform float fInnerRadius;     // The inner (planetary) radius
uniform float fInnerRadius2;    // fInnerRadius^2
uniform float fKrESun;          // Kr * ESun
uniform float fKmESun;          // Km * ESun
uniform float fKr4PI;           // Kr * 4 * PI
uniform float fKm4PI;           // Km * 4 * PI
uniform float fScale;           // 1 / (fOuterRadius - fInnerRadius)
uniform float fScaleDepth;      // The scale depth (i.e. the altitude at which the atmosphere's average density is found)
uniform float fScaleOverScaleDepth; // fScale / fScaleDepth

varying vec3 c0;
varying vec3 c1;

const int nSamples = 3;
const float fSamples = 3.0;

float scale(float fCos)
{
    float x = 1.0 - fCos;
    return fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));
}

void main(void) {

     float cameraHeight2 = length(cameraPosition) * length(cameraPosition);

    // Get the ray from the camera to the vertex and its length (which is the far point of the ray passing through the atmosphere)
    vec3 v3Ray = position - cameraPosition;
    float fFar = length(v3Ray);
    v3Ray /= fFar;

    // Calculate the closest intersection of the ray with the outer atmosphere (which is the near point of the ray passing through the atmosphere)
    float B = 2.0 * dot(cameraPosition, v3Ray);
    float C = cameraHeight2 - fOuterRadius2;
    float fDet = max(0.0, B*B - 4.0 * C);
    float fNear = 0.5 * (-B - sqrt(fDet));

    // Calculate the ray's starting position, then calculate its scattering offset
    vec3 v3Start = cameraPosition + v3Ray * fNear;
    fFar -= fNear;
    float fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);
    float fCameraAngle = dot(-v3Ray, position) / length(position);
    float fLightAngle = dot(v3LightPosition, position) / length(position);
    float fCameraScale = scale(fCameraAngle);
    float fLightScale = scale(fLightAngle);
    float fCameraOffset = fDepth*fCameraScale;
    float fTemp = (fLightScale + fCameraScale);

    // Initialize the scattering loop variables
    float fSampleLength = fFar / fSamples;
    float fScaledLength = fSampleLength * fScale;
    vec3 v3SampleRay = v3Ray * fSampleLength;
    vec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;

    // Now loop through the sample rays
    vec3 v3FrontColor = vec3(0.0, 0.0, 0.0);
    vec3 v3Attenuate = vec3(0.0, 0.0, 0.0);
    for(int i=0; i<nSamples; i++)
    {
        float fHeight = length(v3SamplePoint);
        float fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));
        float fScatter = fDepth*fTemp - fCameraOffset;
        v3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));
        v3FrontColor += v3Attenuate * (fDepth * fScaledLength);
        v3SamplePoint += v3SampleRay;
    }

    // Calculate the attenuation factor for the ground
    c0 = v3Attenuate;
    c1 = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);

    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,H=`#include <logdepthbuf_pars_fragment>

uniform int atmoIN;
varying float intensity;

vec4 glowColor = vec4(0.45, 0.74, 1. ,1.0);

void main() {
    #include <logdepthbuf_fragment>
    gl_FragColor = glowColor * intensity;
}

`,q=`#include <common>
#include <logdepthbuf_pars_vertex>

uniform int atmoIN;
varying float intensity;

void main()
{
    vec3 normalES    = normalize( normalMatrix * normal );
    vec3 normalCAMES = normalize( normalMatrix * cameraPosition );

    if(atmoIN == 0) {
        intensity = pow(0.666 - dot(normalES, normalCAMES), 4. );
    } else {
        intensity = pow( 1.  - dot(normalES, normalCAMES), 0.8 );
    }

    gl_Position = projectionMatrix * modelViewMatrix * vec4( position,  1.0 );

    #include <logdepthbuf_vertex>
}


`,te=new g.Vector3(1,0,0),Q=new g.Vector3,Z=new D.default("EPSG:4326"),ae=new D.default("EPSG:4326"),F=new g.Color(9688568),W=new g.Color,O=new g.Color(197896),X=6e5,G=B.ellipsoidSizes.x*160,j=function(ce){(0,v.default)(ue,ce);var se=b(ue);function ue(){var Y,pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"atmosphere",Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,R.default)(this,ue),Ee.source=!1,Y=se.call(this,pe,new g.Object3D,Ee),Y.isAtmosphere=!0;var Fe=new g.ShaderMaterial({uniforms:{atmoIN:{type:"i",value:0},screenSize:{type:"v2",value:new g.Vector2(window.innerWidth,window.innerHeight)}},vertexShader:q,fragmentShader:H,side:g.BackSide,blending:g.AdditiveBlending,transparent:!0,wireframe:!1}),$e=new g.SphereGeometry(1,64,64),pt=new g.Mesh($e,Fe);pt.scale.copy(B.ellipsoidSizes).multiplyScalar(1.14),Y.basicAtmosphere=new g.Object3D,Y.realisticAtmosphere=new g.Object3D,Y.realisticAtmosphere.visible=!1,Y.object3d.add(Y.basicAtmosphere),Y.object3d.add(Y.realisticAtmosphere),Y.basicAtmosphere.add(pt);var Ue=new g.ShaderMaterial({uniforms:{atmoIN:{type:"i",value:1},screenSize:{type:"v2",value:new g.Vector2(window.innerWidth,window.innerHeight)}},vertexShader:q,fragmentShader:H,side:g.FrontSide,blending:g.AdditiveBlending,transparent:!0,depthWrite:!1}),Je=new g.Mesh($e,Ue);return Je.scale.copy(B.ellipsoidSizes).multiplyScalar(1.002),Y.basicAtmosphere.add(Je),Y.realisticLightingPosition={x:-.5,y:0,z:1},Y.fog={enable:!0,distance:G},Y.realisticAtmosphereInitParams=Ee.Kr?Ee:{Kr:.0025,Km:.0015,ESun:20,g:-.95,innerRadius:64e5,outerRadius:67e5,wavelength:[.65,.57,.475],scaleDepth:.25},Y.object3d.updateMatrixWorld(),Y}return(0,M.default)(ue,[{key:"update",value:function(pe,Ee,Fe){Fe.material.fogDistance=this.fog.distance,Fe.material.lightingEnabled=this.realisticAtmosphere.visible,Fe.material.lightPosition=this.realisticLightingPosition}},{key:"preUpdate",value:function(pe){var Ee=pe.view.camera.camera3D.position;if(this.fog.enable){Q.setFromMatrixPosition(pe.view.tileLayer.object3d.matrixWorld);var Fe=Q.distanceTo(Ee);this.fog.distance=G*Math.pow((Fe-B.ellipsoidSizes.x*.99)*.25/B.ellipsoidSizes.x,1.5)}else this.fog.distance=1e11;var $e=pe.view.mainLoop.gfxEngine.renderer;Z.crs=pe.view.referenceCrs,Z.setFromVector3(Ee).as("EPSG:4326",ae);var pt=ae.altitude;pt<X?(W.copy(O).lerp(F,(X-pt)/X),$e.setClearColor(W,$e.getClearAlpha())):$e.setClearColor(O,$e.getClearAlpha())}},{key:"_initRealisticLighning",value:function(){var pe=this.realisticAtmosphereInitParams,Ee={v3LightPosition:{value:te.clone().normalize()},v3InvWavelength:{value:new g.Vector3(1/Math.pow(pe.wavelength[0],4),1/Math.pow(pe.wavelength[1],4),1/Math.pow(pe.wavelength[2],4))},fCameraHeight:{value:0},fCameraHeight2:{value:0},fInnerRadius:{value:pe.innerRadius},fInnerRadius2:{value:pe.innerRadius*pe.innerRadius},fOuterRadius:{value:pe.outerRadius},fOuterRadius2:{value:pe.outerRadius*pe.outerRadius},fKrESun:{value:pe.Kr*pe.ESun},fKmESun:{value:pe.Km*pe.ESun},fKr4PI:{value:pe.Kr*4*Math.PI},fKm4PI:{value:pe.Km*4*Math.PI},fScale:{value:1/(pe.outerRadius-pe.innerRadius)},fScaleDepth:{value:pe.scaleDepth},fScaleOverScaleDepth:{value:1/(pe.outerRadius-pe.innerRadius)/pe.scaleDepth},g:{value:pe.g},g2:{value:pe.g*pe.g},nSamples:{value:3},fSamples:{value:3},tDisplacement:{value:new g.Texture},tSkyboxDiffuse:{value:new g.Texture},fNightScale:{value:1}},Fe=new g.SphereGeometry(pe.innerRadius,50,50),$e=new g.ShaderMaterial({uniforms:Ee,vertexShader:U,fragmentShader:N,blending:g.AdditiveBlending,transparent:!0,depthTest:!1,depthWrite:!1}),pt=new g.Mesh(Fe,$e),Ue=new g.SphereGeometry(pe.outerRadius,196,196),Je=new g.ShaderMaterial({uniforms:Ee,vertexShader:T,fragmentShader:x,transparent:!0,side:g.BackSide}),et=new g.Mesh(Ue,Je),ze=new P.default;ze.frustumCulled=!1,pt.layers.mask=this.object3d.layers.mask,et.layers.mask=this.object3d.layers.mask,ze.layers.mask=this.object3d.layers.mask,this.realisticAtmosphere.add(pt),this.realisticAtmosphere.add(et),this.realisticAtmosphere.add(ze);var Xe={turbidity:10,reileigh:2,mieCoefficient:.005,mieDirectionalG:.8,luminance:1,inclination:.49,azimuth:.25,sun:!1};ze.material.uniforms.turbidity.value=Xe.turbidity,ze.material.uniforms.reileigh.value=Xe.reileigh,ze.material.uniforms.luminance.value=Xe.luminance,ze.material.uniforms.mieCoefficient.value=Xe.mieCoefficient,ze.material.uniforms.mieDirectionalG.value=Xe.mieDirectionalG,ze.material.uniforms.up.value=new g.Vector3}},{key:"setRealisticOn",value:function(pe){var Ee=this;pe&&(this.realisticAtmosphere.children.length||this._initRealisticLighning(),this.realisticLightingPosition=V.default.getSunPositionInScene(new Date().getTime(),48.85,2.35).normalize(),this.realisticAtmosphere.children.forEach(function(Fe){return Fe.material.uniforms.v3LightPosition.value.copy(Ee.realisticLightingPosition)})),this.basicAtmosphere.visible=!pe,this.realisticAtmosphere.visible=pe}}]),ue}(C.default),K=j;a.default=K}(_w)),_w}var rS;function vI(){return rS||(rS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.GLOBE_VIEW_EVENTS=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(Cs()),p=u(dn()),g=u(pn()),C=u(ln()),D=N(Dr()),B=N(iv()),V=u(bC()),P=u(Zi()),L=u(TC()),E=u(mI()),b=u(f2()),_=u(ps()),x=$h();function T(Z){if(typeof WeakMap!="function")return null;var ae=new WeakMap,F=new WeakMap;return(T=function(O){return O?F:ae})(Z)}function N(Z,ae){if(!ae&&Z&&Z.__esModule)return Z;if(Z===null||h(Z)!=="object"&&typeof Z!="function")return{default:Z};var F=T(ae);if(F&&F.has(Z))return F.get(Z);var W={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var X in Z)if(X!=="default"&&Object.prototype.hasOwnProperty.call(Z,X)){var G=O?Object.getOwnPropertyDescriptor(Z,X):null;G&&(G.get||G.set)?Object.defineProperty(W,X,G):W[X]=Z[X]}return W.default=Z,F&&F.set(Z,W),W}function U(Z){var ae=H();return function(){var F=(0,C.default)(Z),W;if(ae){var O=(0,C.default)(this).constructor;W=Reflect.construct(F,arguments,O)}else W=F.apply(this,arguments);return(0,g.default)(this,W)}}function H(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q={GLOBE_INITIALIZED:B.VIEW_EVENTS.INITIALIZED,LAYER_ADDED:B.VIEW_EVENTS.LAYER_ADDED,LAYER_REMOVED:B.VIEW_EVENTS.LAYER_REMOVED,COLOR_LAYERS_ORDER_CHANGED:B.VIEW_EVENTS.COLOR_LAYERS_ORDER_CHANGED};a.GLOBE_VIEW_EVENTS=q;var te=function(Z){(0,p.default)(F,Z);var ae=U(F);function F(W){var O,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};(0,R.default)(this,F),D.Object3D.DefaultUp.set(0,0,1),O=ae.call(this,"EPSG:4978",W,G),O.isGlobeView=!0,O.camera.camera3D.near=Math.max(15,2352e-9*x.ellipsoidSizes.x),O.camera.camera3D.far=x.ellipsoidSizes.x*10;var j=new L.default("globe",G.object3d,G);O.mainLoop.gfxEngine.label2dRenderer.infoTileLayer=j.info;var K=new D.DirectionalLight;return K.position.set(-.5,0,1),K.updateMatrixWorld(!0),j.object3d.add(K),O.addLayer(j),O.tileLayer=j,X.isExtent||(X.coord=X.coord||new P.default("EPSG:4326",0,0),X.tilt=X.tilt||89.5,X.heading=X.heading||0,X.range=X.range||x.ellipsoidSizes.x*2),G.noControls?b.default.transformCameraToLookAtTarget((0,v.default)(O),O.camera.camera3D,X):(O.controls=new V.default((0,v.default)(O),X),O.controls.handleCollision=typeof G.handleCollision<"u"?G.handleCollision:!0),O.addLayer(new E.default("atmosphere",G.atmosphere)),O.camera.resize(W.clientWidth,W.clientHeight),O}return(0,M.default)(F,[{key:"addLayer",value:function(O){if(!O||!O.isLayer)return Promise.reject(new Error("Add Layer type object"));if(O.isColorLayer){if(!this.tileLayer.tileMatrixSets.includes(_.default.formatToTms(O.source.crs)))return O._reject("Only ".concat(this.tileLayer.tileMatrixSets," tileMatrixSet are currently supported for color layers"))}else if(O.isElevationLayer&&_.default.formatToTms(O.source.crs)!==this.tileLayer.tileMatrixSets[0])return O._reject("Only ".concat(this.tileLayer.tileMatrixSets[0]," tileMatrixSet is currently supported for elevation layers"));return(0,y.default)((0,C.default)(F.prototype),"addLayer",this).call(this,O,this.tileLayer)}},{key:"getPixelsToDegrees",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,X=arguments.length>1?arguments[1]:void 0;return this.getMetersToDegrees(this.getPixelsToMeters(O,X))}},{key:"getPixelsToDegreesFromDistance",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this.getMetersToDegrees(this.getPixelsToMetersFromDistance(O,X))}},{key:"getMetersToDegrees",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;return D.MathUtils.radToDeg(2*Math.asin(O/(2*x.ellipsoidSizes.x)))}}]),F}(B.default),Q=te;a.default=Q}(Ox)),Ox}var ww={},Mw={},nS;function SC(){return nS||(nS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.keys=a.default=a.STATE=a.PLANAR_CONTROL_EVENT=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=V(Dr()),D=ed();function B(Ge){if(typeof WeakMap!="function")return null;var Ae=new WeakMap,Se=new WeakMap;return(B=function(me){return me?Se:Ae})(Ge)}function V(Ge,Ae){if(!Ae&&Ge&&Ge.__esModule)return Ge;if(Ge===null||h(Ge)!=="object"&&typeof Ge!="function")return{default:Ge};var Se=B(Ae);if(Se&&Se.has(Ge))return Se.get(Ge);var Te={},me=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var be in Ge)if(be!=="default"&&Object.prototype.hasOwnProperty.call(Ge,be)){var we=me?Object.getOwnPropertyDescriptor(Ge,be):null;we&&(we.get||we.set)?Object.defineProperty(Te,be,we):Te[be]=Ge[be]}return Te.default=Ge,Se&&Se.set(Ge,Te),Te}function P(Ge){var Ae=L();return function(){var Se=(0,g.default)(Ge),Te;if(Ae){var me=(0,g.default)(this).constructor;Te=Reflect.construct(Se,arguments,me)}else Te=Se.apply(this,arguments);return(0,p.default)(this,Te)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E={CTRL:17,SPACE:32,T:84,Y:89};a.keys=E;var b={LEFTCLICK:C.MOUSE.LEFT,MIDDLECLICK:C.MOUSE.MIDDLE,RIGHTCLICK:C.MOUSE.RIGHT},_,x=new C.Vector3,T=new C.Quaternion,N=0,U=new C.Vector3,H={NONE:-1,DRAG:0,PAN:1,ROTATE:2,TRAVEL:3,ORTHO_ZOOM:4};a.STATE=H;var q={default:"auto",drag:"move",pan:"cell",travel:"wait",rotate:"move",ortho_zoom:"wait"},te=new C.Vector3,Q=new C.Vector2,Z=new C.Vector2,ae=new C.Vector2(0,0),F=new C.Vector3,W=new C.Vector3,O=new C.Vector3,X=new C.Vector3(0,0,0),G=0,j=new C.Vector3,K=new C.Quaternion,ce=new C.Vector2,se=new C.Vector3,ue=new C.Vector3,Y=new C.Quaternion,pe=new C.Quaternion,Ee=0,Fe=0,$e=!1,pt=!1,Ue=0,Je=0,et=new C.Raycaster,ze=new C.Plane(new C.Vector3(0,0,-1)),Xe={enableRotation:!0,rotateSpeed:2,minPanSpeed:.05,maxPanSpeed:15,zoomTravelTime:.2,zoomFactor:2,maxResolution:1/(1/0),minResolution:1/0,maxAltitude:5e7,groundLevel:200,autoTravelTimeMin:1.5,autoTravelTimeMax:4,autoTravelTimeDist:5e4,smartTravelHeightMin:75,smartTravelHeightMax:500,instantTravel:!1,minZenithAngle:0,maxZenithAngle:82.5,handleCollision:!0,minDistanceCollision:30,enableSmartTravel:!0,enablePan:!0},tt={MOVED:"moved"};a.PLANAR_CONTROL_EVENT=tt;var ye=function(Ge){(0,y.default)(Se,Ge);var Ae=P(Se);function Se(Te){var me,be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,R.default)(this,Se),me=Ae.call(this),me.view=Te,me.camera=Te.camera.camera3D,me.camera.isOrthographicCamera?(N=me.camera.zoom,me.enableRotation=!1,me.enablePan=!1,me.maxAltitude=1/0,me.zoomTravelTime=typeof be.zoomTravelTime=="number"?be.zoomTravelTime:Xe.zoomTravelTime):(me.enableRotation=be.enableRotation===void 0?Xe.enableRotation:be.enableRotation,me.rotateSpeed=be.rotateSpeed||Xe.rotateSpeed,me.enablePan=be.enablePan===void 0?Xe.enablePan:be.enablePan,me.minPanSpeed=be.minPanSpeed||Xe.minPanSpeed,me.maxPanSpeed=be.maxPanSpeed||Xe.maxPanSpeed,me.maxAltitude=be.maxAltitude||Xe.maxAltitude,me.zoomTravelTime=be.zoomTravelTime||Xe.zoomTravelTime),be.zoomInFactor&&(console.warn("Controls zoomInFactor parameter is deprecated. Use zoomFactor instead."),be.zoomFactor=be.zoomFactor||be.zoomInFactor),be.zoomOutFactor&&(console.warn("Controls zoomOutFactor parameter is deprecated. Use zoomFactor instead."),be.zoomFactor=be.zoomFactor||be.zoomInFactor||1/be.zoomOutFactor),be.zoomFactor===0&&(console.warn("Controls zoomFactor parameter can not be equal to 0. Its value will be set to default."),be.zoomFactor=Xe.zoomFactor),me.zoomInFactor=be.zoomFactor||Xe.zoomFactor,me.zoomOutFactor=1/(be.zoomFactor||Xe.zoomFactor),me.maxResolution=be.maxResolution||Xe.maxResolution,me.minResolution=be.minResolution||Xe.minResolution,me.groundLevel=be.groundLevel||Xe.groundLevel,me.autoTravelTimeMin=be.autoTravelTimeMin||Xe.autoTravelTimeMin,me.autoTravelTimeMax=be.autoTravelTimeMax||Xe.autoTravelTimeMax,me.autoTravelTimeDist=be.autoTravelTimeDist||Xe.autoTravelTimeDist,be.smartZoomHeightMin&&(console.warn("Controls smartZoomHeightMin parameter is deprecated. Use smartTravelHeightMin instead."),be.smartTravelHeightMin=be.smartTravelHeightMin||be.smartZoomHeightMin),be.smartZoomHeightMax&&(console.warn("Controls smartZoomHeightMax parameter is deprecated. Use smartTravelHeightMax instead."),be.smartTravelHeightMax=be.smartTravelHeightMax||be.smartZoomHeightMax),me.smartTravelHeightMin=be.smartTravelHeightMin||Xe.smartTravelHeightMin,me.smartTravelHeightMax=be.smartTravelHeightMax||Xe.smartTravelHeightMax,me.instantTravel=be.instantTravel||Xe.instantTravel,me.minZenithAngle=(be.minZenithAngle||Xe.minZenithAngle)*Math.PI/180,me.maxZenithAngle=(be.maxZenithAngle||Xe.maxZenithAngle)*Math.PI/180,be.focusOnMouseOver&&console.warn("Planar controls 'focusOnMouseOver' optional parameter has been removed."),be.focusOnMouseClick&&console.warn("Planar controls 'focusOnMouseClick' optional parameter has been removed."),me.handleCollision=be.handleCollision===void 0?Xe.handleCollision:be.handleCollision,me.minDistanceCollision=Xe.minDistanceCollision,me.enableSmartTravel=be.enableSmartTravel===void 0?Xe.enableSmartTravel:be.enableSmartTravel,x.copy(me.camera.position),T.copy(me.camera.quaternion),me.state=H.NONE,me.cursor=q,me.view.controls&&(console.warn("Deprecated use of PlanarControls. See examples to correct PlanarControls implementation."),me.view.controls.dispose()),me.view.controls=(0,v.default)(me),me._handlerOnKeyDown=me.onKeyDown.bind((0,v.default)(me)),me._handlerOnMouseDown=me.onMouseDown.bind((0,v.default)(me)),me._handlerOnMouseUp=me.onMouseUp.bind((0,v.default)(me)),me._handlerOnMouseMove=me.onMouseMove.bind((0,v.default)(me)),me._handlerOnMouseWheel=me.onMouseWheel.bind((0,v.default)(me)),me._handlerContextMenu=me.onContextMenu.bind((0,v.default)(me)),me._handlerUpdate=me.update.bind((0,v.default)(me)),me.view.addFrameRequester(D.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE,me._handlerUpdate),me.addInputListeners(),me}return(0,M.default)(Se,[{key:"dispose",value:function(){this.removeInputListeners(),this.view.removeFrameRequester(D.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE,this._handlerUpdate)}},{key:"update",value:function(me,be){be&&(me=16);var we=this.state!==H.NONE;switch(this.state){case H.TRAVEL:this.handleTravel(me),this.view.notifyChange(this.camera);break;case H.ORTHO_ZOOM:this.handleZoomOrtho(me),this.view.notifyChange(this.camera);break;case H.DRAG:this.handleDragMovement(),this.view.notifyChange(this.camera);break;case H.ROTATE:this.handleRotation(),this.view.notifyChange(this.camera);break;case H.PAN:this.handlePanMovement(),this.view.notifyChange(this.camera);break;case H.NONE:}this.handleCollision&&this.view.camera.adjustAltitudeToAvoidCollisionWithLayer(this.view,this.view.tileLayer,this.minDistanceCollision),we&&this.view.dispatchEvent({type:tt.MOVED}),ae.set(0,0)}},{key:"initiateDrag",value:function(){this.state=H.DRAG,F.copy(this.getWorldPointAtScreenXY(Q)),O.set(0,0,0)}},{key:"handleDragMovement",value:function(){this.getWorldPointFromMathPlaneAtScreenXY(Q,F.z,W),O.subVectors(F,W),this.camera.position.add(O),O.set(0,0,0)}},{key:"initiatePan",value:function(){this.state=H.PAN}},{key:"handlePanMovement",value:function(){j.set(-ae.x,ae.y,0),this.camera.localToWorld(j),this.camera.position.copy(j)}},{key:"initiateRotation",value:function(){this.state=H.ROTATE,X.copy(this.getWorldPointAtScreenXY(new C.Vector2(.5*this.view.mainLoop.gfxEngine.width,.5*this.view.mainLoop.gfxEngine.height)));var me=this.camera.position.distanceTo(X);G=Math.acos((this.camera.position.z-X.z)/me)}},{key:"handleRotation",value:function(){var me=-this.rotateSpeed*ae.x/this.view.mainLoop.gfxEngine.width,be=-this.rotateSpeed*ae.y/this.view.mainLoop.gfxEngine.height,we=this.camera.position.clone().sub(X);(me!==0||be!==0)&&(G+be>=this.minZenithAngle&&G+be<=this.maxZenithAngle&&be!==0&&(G+=be,j.set(0,0,1),K.setFromUnitVectors(this.camera.up,j),we.applyQuaternion(K),j.setFromMatrixColumn(this.camera.matrix,0),K.setFromAxisAngle(j,be),we.applyQuaternion(K),j.set(0,0,1),K.setFromUnitVectors(this.camera.up,j).invert(),we.applyQuaternion(K)),me!==0&&(j.set(0,0,1),K.setFromAxisAngle(j,me),we.applyQuaternion(K))),this.camera.position.copy(we),this.camera.lookAt(te),this.camera.position.add(X),this.camera.updateMatrixWorld()}},{key:"initiateZoom",value:function(me){var be=-me.deltaY;U.copy(this.getWorldPointAtScreenXY(Q));var we=new C.Vector3;if(be>0||be<0&&this.maxAltitude>this.camera.position.z){var je=be>0?this.zoomInFactor:this.zoomOutFactor,lt=this.view.getPixelsToMeters()/je;if(this.maxResolution>lt||lt>this.minResolution)return;this.camera.isOrthographicCamera?(this.state=H.ORTHO_ZOOM,this.view.notifyChange(this.camera),Ue=this.camera.zoom,Je=Ue*je,U.z=this.camera.position.z,Ee=0,Fe=this.zoomTravelTime,this.updateMouseCursorType()):(we.lerpVectors(this.camera.position,U,1-1/je),this.initiateTravel(we,this.zoomTravelTime,null,!1))}}},{key:"handleZoomOrtho",value:function(me){Ee=Math.min(Ee+me/1e3/Fe,1);var be=Ue+Ee*(Je-Ue);this.camera.zoom!==be&&(this.camera.zoom=be,this.camera.updateProjectionMatrix(),this.view.viewToNormalizedCoords(Q,j),j.z=0,j.unproject(this.camera),this.camera.position.x+=U.x-j.x,this.camera.position.y+=U.y-j.y,this.camera.updateMatrixWorld(!0)),this.testAnimationEnd()}},{key:"initiateSmartTravel",value:function(){var me=this.getWorldPointAtScreenXY(Q),be=new C.Vector3;be.copy(me).sub(this.camera.position),be.z=0,be.normalize();var we=this.camera.position.distanceTo(me),je=C.MathUtils.lerp(this.smartTravelHeightMin,this.smartTravelHeightMax,Math.min(we/5e3,1)),lt=new C.Vector3;lt.copy(me),this.enableRotation&&lt.add(be.multiplyScalar(-je*2)),lt.z=me.z+je,this.camera.isOrthographicCamera&&(Ue=this.camera.zoom,Je=Ue*(1+Math.min(we/5e3,1)),lt.z=this.camera.position.z),this.initiateTravel(lt,"auto",me,!0)}},{key:"initiateTravel",value:function(me,be,we,je){if(this.state=H.TRAVEL,this.view.notifyChange(this.camera),Ee=0,this.updateMouseCursorType(),$e=this.enableRotation&&we&&(we.isQuaternion||we.isVector3),pt=je,ue.copy(this.camera.position),Y.copy(this.camera.quaternion),$e&&(we.isQuaternion?pe.copy(we):we.isVector3&&(me===we?(this.camera.lookAt(we),pe.copy(this.camera.quaternion),this.camera.quaternion.copy(Y)):(this.camera.position.copy(me),this.camera.lookAt(we),pe.copy(this.camera.quaternion),this.camera.quaternion.copy(Y),this.camera.position.copy(ue)))),se.copy(me),this.instantTravel)Fe=0;else if(be==="auto"){var lt=Math.min(1,me.distanceTo(this.camera.position)/this.autoTravelTimeDist);if(Fe=C.MathUtils.lerp(this.autoTravelTimeMin,this.autoTravelTimeMax,lt),$e){var ot=.5-.5*pe.normalize().dot(this.camera.quaternion.normalize());Fe*=1+2*ot,Fe=Math.min(Fe,this.autoTravelTimeMax)}}else Fe=be}},{key:"handleTravel",value:function(me){Ee=Math.min(Ee+me/1e3/Fe,1);var be=pt?this.smooth(Ee):Ee;this.camera.position.lerpVectors(ue,se,be);var we=Ue+be*(Je-Ue);this.camera.isOrthographicCamera&&this.camera.zoom!==we&&(this.camera.zoom=we,this.camera.updateProjectionMatrix()),$e===!0&&this.camera.quaternion.slerpQuaternions(Y,pe,be),this.testAnimationEnd()}},{key:"testAnimationEnd",value:function(){Ee===1&&(this.state=H.NONE,this.updateMouseCursorType())}},{key:"goToTopView",value:function(){var me=new C.Vector3,be=new C.Quaternion;me.copy(this.getWorldPointAtScreenXY(new C.Vector2(.5*this.view.mainLoop.gfxEngine.width,.5*this.view.mainLoop.gfxEngine.height))),me.z+=Math.min(this.maxAltitude,this.camera.position.distanceTo(me)),be.setFromAxisAngle(new C.Vector3(1,0,0),0),this.initiateTravel(me,"auto",be,!0)}},{key:"goToStartView",value:function(){this.camera.isOrthographicCamera&&(Ue=this.camera.zoom,Je=N),this.initiateTravel(x,"auto",T,!0)}},{key:"getWorldPointFromMathPlaneAtScreenXY",value:function(me,be){var we=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new C.Vector3;return ce.copy(this.view.viewToNormalizedCoords(me)),et.setFromCamera(ce,this.camera),ze.constant=be,et.ray.intersectPlane(ze,we),we}},{key:"getWorldPointAtScreenXY",value:function(me){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new C.Vector3;return this.view.getPickingPositionFromDepth(me,be)||this.getWorldPointFromMathPlaneAtScreenXY(me,this.groundLevel,be),be}},{key:"addInputListeners",value:function(){this.view.domElement.addEventListener("keydown",this._handlerOnKeyDown,!1),this.view.domElement.addEventListener("mousedown",this._handlerOnMouseDown,!1),this.view.domElement.addEventListener("mouseup",this._handlerOnMouseUp,!1),this.view.domElement.addEventListener("mouseleave",this._handlerOnMouseUp,!1),this.view.domElement.addEventListener("mousemove",this._handlerOnMouseMove,!1),this.view.domElement.addEventListener("wheel",this._handlerOnMouseWheel,!1),this.view.domElement.addEventListener("contextmenu",this._handlerContextMenu,!1)}},{key:"removeInputListeners",value:function(){this.view.domElement.removeEventListener("keydown",this._handlerOnKeyDown,!0),this.view.domElement.removeEventListener("mousedown",this._handlerOnMouseDown,!1),this.view.domElement.removeEventListener("mouseup",this._handlerOnMouseUp,!1),this.view.domElement.removeEventListener("mouseleave",this._handlerOnMouseUp,!1),this.view.domElement.removeEventListener("mousemove",this._handlerOnMouseMove,!1),this.view.domElement.removeEventListener("wheel",this._handlerOnMouseWheel,!1),this.view.domElement.removeEventListener("contextmenu",this._handlerContextMenu,!1)}},{key:"updateMouseCursorType",value:function(){switch(this.state){case H.NONE:this.view.domElement.style.cursor=this.cursor.default;break;case H.DRAG:this.view.domElement.style.cursor=this.cursor.drag;break;case H.PAN:this.view.domElement.style.cursor=this.cursor.pan;break;case H.TRAVEL:this.view.domElement.style.cursor=this.cursor.travel;break;case H.ORTHO_ZOOM:this.view.domElement.style.cursor=this.cursor.ortho_zoom;break;case H.ROTATE:this.view.domElement.style.cursor=this.cursor.rotate;break}}},{key:"updateMousePositionAndDelta",value:function(me){this.view.eventToViewCoords(me,Q),ae.copy(Q).sub(Z),Z.copy(Q)}},{key:"setCursor",value:function(me,be){this.cursor[me]=be,this.updateMouseCursorType()}},{key:"onMouseDown",value:function(me){if(me.preventDefault(),this.view.domElement.focus(),H.NONE===this.state){if(_=me.button,this.updateMousePositionAndDelta(me),b.LEFTCLICK===me.button)if(me.ctrlKey)if(this.enableRotation)this.initiateRotation();else return;else this.initiateDrag();else if(b.MIDDLECLICK===me.button)if(this.enableSmartTravel)this.initiateSmartTravel();else return;else if(b.RIGHTCLICK===me.button)if(this.enablePan)this.initiatePan();else return;this.updateMouseCursorType()}}},{key:"onMouseUp",value:function(me){me.preventDefault(),H.TRAVEL!==this.state&&H.ORTHO_ZOOM!==this.state&&_===me.button&&(this.state=H.NONE),this.updateMouseCursorType()}},{key:"onMouseMove",value:function(me){me.preventDefault(),this.updateMousePositionAndDelta(me),H.NONE!==this.state&&this.view.notifyChange()}},{key:"onKeyDown",value:function(me){if(H.NONE===this.state)switch(me.keyCode){case E.T:this.camera.isOrthographicCamera||this.goToTopView();break;case E.Y:this.goToStartView();break;case E.SPACE:this.enableSmartTravel&&this.initiateSmartTravel(me);break}}},{key:"onMouseWheel",value:function(me){me.preventDefault(),me.stopPropagation(),H.NONE===this.state&&this.initiateZoom(me)}},{key:"onContextMenu",value:function(me){me.preventDefault()}},{key:"smooth",value:function(me){return Math.pow(Math.pow(me,2)*(3-2*me),1.2)}}]),Se}(C.EventDispatcher),Ze=ye;a.default=Ze}(Mw)),Mw}var bw={},Ew={},iS;function gI(){return iS||(iS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=C(Dr()),y=u(Zi()),p=u(ya());function g(L){if(typeof WeakMap!="function")return null;var E=new WeakMap,b=new WeakMap;return(g=function(x){return x?b:E})(L)}function C(L,E){if(!E&&L&&L.__esModule)return L;if(L===null||h(L)!=="object"&&typeof L!="function")return{default:L};var b=g(E);if(b&&b.has(L))return b.get(L);var _={},x=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in L)if(T!=="default"&&Object.prototype.hasOwnProperty.call(L,T)){var N=x?Object.getOwnPropertyDescriptor(L,T):null;N&&(N.get||N.set)?Object.defineProperty(_,T,N):_[T]=L[T]}return _.default=L,b&&b.set(L,_),_}var D=new v.Quaternion,B=new v.Vector3,V=function(){function L(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if((0,R.default)(this,L),E.projection&&(console.warn("PlanarTileBuilder projection parameter is deprecated, use crs instead."),E.crs=E.crs||E.projection),E.crs)this.crs=E.crs;else throw new Error("options.crs is mandatory for PlanarTileBuilder");this.tmp={coords:new y.default("EPSG:4326",0,0),position:new v.Vector3,normal:new v.Vector3(0,0,1)},this.uvCount=E.uvCount||1}return(0,M.default)(L,[{key:"prepare",value:function(b){b.nbRow=Math.pow(2,b.zoom+1),b.projected=new v.Vector3}},{key:"center",value:function(b){return b.center(this.tmp.coords),B.set(this.tmp.coords.x,this.tmp.coords.y,0),B}},{key:"vertexPosition",value:function(b){return this.tmp.position.set(b.projected.x,b.projected.y,0),this.tmp.position}},{key:"vertexNormal",value:function(){return this.tmp.normal}},{key:"uProjecte",value:function(b,_){_.projected.x=_.extent.west+b*(_.extent.east-_.extent.west)}},{key:"vProjecte",value:function(b,_){_.projected.y=_.extent.south+b*(_.extent.north-_.extent.south)}},{key:"computeSharableExtent",value:function(b){var _=new p.default(b.crs,0,Math.abs(b.west-b.east),0,Math.abs(b.north-b.south));return{sharableExtent:_,quaternion:D,position:this.center(b).clone()}}}]),L}(),P=V;a.default=P}(Ew)),Ew}var aS;function RC(){return aS||(aS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(kr()),M=u(Ir()),v=u(dn()),y=u(pn()),p=u(ln()),g=L(Dr()),C=u(eb()),D=ya(),B=u(ps()),V=u(gI());function P(T){if(typeof WeakMap!="function")return null;var N=new WeakMap,U=new WeakMap;return(P=function(q){return q?U:N})(T)}function L(T,N){if(!N&&T&&T.__esModule)return T;if(T===null||h(T)!=="object"&&typeof T!="function")return{default:T};var U=P(N);if(U&&U.has(T))return U.get(T);var H={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in T)if(te!=="default"&&Object.prototype.hasOwnProperty.call(T,te)){var Q=q?Object.getOwnPropertyDescriptor(T,te):null;Q&&(Q.get||Q.set)?Object.defineProperty(H,te,Q):H[te]=T[te]}return H.default=T,U&&U.set(T,H),H}function E(T){var N=b();return function(){var U=(0,p.default)(T),H;if(N){var q=(0,p.default)(this).constructor;H=Reflect.construct(U,arguments,q)}else H=U.apply(this,arguments);return(0,y.default)(this,H)}}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _=function(T){(0,v.default)(U,T);var N=E(U);function U(H,q,te){var Q,Z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};(0,M.default)(this,U);var ae=B.default.formatToTms(q.crs);return D.globalExtentTMS.get(q.crs)||D.globalExtentTMS.set(q.crs,q),Z.tileMatrixSets=[ae],Q=N.call(this,H,te||new g.Group,[q],new V.default({crs:q.crs}),Z),Q.isPlanarLayer=!0,Q.extent=q,Q.minSubdivisionLevel=Q.minSubdivisionLevel==null?0:Q.minSubdivisionLevel,Q.maxSubdivisionLevel=Q.maxSubdivisionLevel==null?5:Q.maxSubdivisionLevel,Q.maxDeltaElevation=Q.maxDeltaElevation||4,Q}return(0,R.default)(U)}(C.default),x=_;a.default=x}(bw)),bw}var sS;function yI(){return sS||(sS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(Cs()),p=u(dn()),g=u(pn()),C=u(ln()),D=b(Dr()),B=u(iv()),V=u(f2()),P=u(SC()),L=u(RC());function E(U){if(typeof WeakMap!="function")return null;var H=new WeakMap,q=new WeakMap;return(E=function(Q){return Q?q:H})(U)}function b(U,H){if(!H&&U&&U.__esModule)return U;if(U===null||h(U)!=="object"&&typeof U!="function")return{default:U};var q=E(H);if(q&&q.has(U))return q.get(U);var te={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in U)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(U,Z)){var ae=Q?Object.getOwnPropertyDescriptor(U,Z):null;ae&&(ae.get||ae.set)?Object.defineProperty(te,Z,ae):te[Z]=U[Z]}return te.default=U,q&&q.set(U,te),te}function _(U){var H=x();return function(){var q=(0,C.default)(U),te;if(H){var Q=(0,C.default)(this).constructor;te=Reflect.construct(q,arguments,Q)}else te=q.apply(this,arguments);return(0,g.default)(this,te)}}function x(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var T=function(U){(0,p.default)(q,U);var H=_(q);function q(te,Q){var Z,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};(0,R.default)(this,q),D.Object3D.DefaultUp.set(0,0,1),Z=H.call(this,Q.crs,te,ae),Z.isPlanarView=!0;var F=Q.planarDimensions(),W=Math.max(F.x,F.y),O=Z.camera.camera3D;O.near=.1,O.far=O.isOrthographicCamera?2e3:2*W,O.updateProjectionMatrix();var X=new L.default("planar",Q,ae.object3d,ae);Z.mainLoop.gfxEngine.label2dRenderer.infoTileLayer=X.info,Z.addLayer(X);var G=ae.placement||{};return G.isExtent||(G.coord=G.coord||Q.center(),G.tilt=G.tilt||90,G.heading=G.heading||0,G.range=G.range||W),V.default.transformCameraToLookAtTarget((0,v.default)(Z),O,G),ae.noControls||(Z.controls=new P.default((0,v.default)(Z),ae.controls)),Z.tileLayer=X,Z}return(0,M.default)(q,[{key:"addLayer",value:function(Q){return(0,y.default)((0,C.default)(q.prototype),"addLayer",this).call(this,Q,this.tileLayer)}}]),q}(B.default),N=T;a.default=N}(ww)),ww}var Tw={},oS;function CC(){return oS||(oS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(l2()),R=u(JM()),M=u(EC()),v=u(Zi()),y=h2(),p=new v.default("EPSG:4326",0,0,0),g={update:function(D,B,V){if(!V.parent&&V.children.length){R.default.removeChildrenAndCleanupRecursively(B,V);return}if(!!V.visible){if(V.layerUpdateState[B.id]===void 0)V.layerUpdateState[B.id]=new h.default;else if(!V.layerUpdateState[B.id].canTryUpdate()){V.link.forEach(function(b){var _;((_=b.layer)===null||_===void 0?void 0:_.id)==B.id&&(b.layer.object3d.add(b),b.meshes.position.z=(0,y.geoidLayerIsVisible)(B.parent)?V.geoidHeight:0,b.meshes.updateMatrixWorld())});return}var P=V.getExtentsByProjection(B.source.crs)||[V.extent],L=P[0].zoom;if(L!=B.zoom.min||!this.source.extentInsideLimit(V.extent,L)||B.source.isFileSource&&!V.extent.isPointInside(B.source.extent.center(p))){V.layerUpdateState[B.id].noMoreUpdatePossible();return}V.layerUpdateState[B.id].newTry();var E={layer:B,extentsSource:P,view:D.view,threejsLayer:B.threejsLayer,requester:V};return D.scheduler.execute(E).then(function(b){V.layerUpdateState[B.id].noMoreUpdatePossible(),b.forEach(function(_){_?(_.as(D.view.referenceCrs),_.meshes.position.z=(0,y.geoidLayerIsVisible)(B.parent)?V.geoidHeight:0,_.updateMatrixWorld(),B.onMeshCreated&&B.onMeshCreated(_,D),V.parent?(B.object3d.add(_),V.link.push(_)):R.default.removeChildrenAndCleanupRecursively(B,_),_.layer=B):V.layerUpdateState[B.id].failure(1,!0)})},function(b){return(0,M.default)(b,V,B,V.level,D.view)})}}};a.default=g}(Tw)),Tw}var Sw={},uS;function PC(){return uS||(uS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Wi()),M=u(Cs()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(Ir()),C=u(kr()),D=V(Dr());function B(T){if(typeof WeakMap!="function")return null;var N=new WeakMap,U=new WeakMap;return(B=function(q){return q?U:N})(T)}function V(T,N){if(!N&&T&&T.__esModule)return T;if(T===null||h(T)!=="object"&&typeof T!="function")return{default:T};var U=B(N);if(U&&U.has(T))return U.get(T);var H={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in T)if(te!=="default"&&Object.prototype.hasOwnProperty.call(T,te)){var Q=q?Object.getOwnPropertyDescriptor(T,te):null;Q&&(Q.get||Q.set)?Object.defineProperty(H,te,Q):H[te]=T[te]}return H.default=T,U&&U.set(T,H),H}function P(T){var N=L();return function(){var U=(0,p.default)(T),H;if(N){var q=(0,p.default)(this).constructor;H=Reflect.construct(U,arguments,q)}else H=U.apply(this,arguments);return(0,y.default)(this,H)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E=function(){function T(N){(0,g.default)(this,T),this.size=N,this.pps=null,this.polynom=null,this.l1l2=null}return(0,C.default)(T,[{key:"setFromMicmacCalibration",value:function(U){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.pps=new D.Vector2().fromArray(U.pps),this.polynom=new D.Vector4().fromArray(U.poly357),this.l1l2=new D.Vector3,this.pps.y=H?this.size.y-this.pps.y:this.pps.y,this.polynom.w=Math.pow(U.limit,2),U.l1l2&&(this.l1l2.fromArray(U.l1l2),this.l1l2.z=U.etats)}},{key:"clone",value:function(){var U=new T(this.size.clone());return U.pps=this.pps.clone(),U.polynom=this.polynom.clone(),U.l1l2=this.l1l2.clone(),U}}]),T}(),b=new D.Vector3,_=function(T){(0,v.default)(U,T);var N=P(U);function U(){var H,q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1024,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1024,Q=arguments.length>2?arguments[2]:void 0,Z=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.1,ae=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4,F=arguments.length>5?arguments[5]:void 0,W=arguments.length>6?arguments[6]:void 0;return(0,g.default)(this,U),q=q.isVector2?q:new D.Vector2(q,q),W=W||q.x/q.y,H=N.call(this,void 0,W,Z,ae),H.size=q,H.focal=te.isVector2?te:new D.Vector2(te,te),H.center=Q||q.clone().multiplyScalar(.5),H.skew=F||0,H.textureMatrixWorldInverse=new D.Matrix4,Object.defineProperty((0,R.default)(H),"fov",{get:function(){return 2*D.MathUtils.radToDeg(Math.atan2(H.size.y,2*H.focal.y))},set:function(X){var G=.5*H.size.y/Math.tan(D.MathUtils.degToRad(X*.5));H.focal.x=G,H.focal.y=G}}),H.distortion=new E(H.size),H.maskPath=void 0,H.mask=void 0,H.updateProjectionMatrix(),H}return(0,C.default)(U,[{key:"updateProjectionMatrix",value:function(){if(!!this.focal){var q=this.near,te=q/this.focal.x,Q=q/this.focal.y,Z=-te*this.center.x,ae=-Q*this.center.y,F=Z+te*this.size.x,W=ae+Q*this.size.y;this.projectionMatrix.makePerspective(Z,F,W,ae,q,this.far),this.projectionMatrix.elements[4]=2*this.skew/this.size.x;var O=this.size.x/this.size.y,X=this.aspect/O;b.set(this.zoom,this.zoom,1),X>1?b.x/=X:b.y*=X,this.projectionMatrix.scale(b)}}},{key:"copy",value:function(q,te){return(0,M.default)((0,p.default)(U.prototype),"copy",this).call(this,q,te),this.size=q.size.clone(),this.focal=q.focal.clone(),this.center=q.center.clone(),this.distortion=q.distortion.clone(),this.textureMatrixWorldInverse=q.textureMatrixWorldInverse.clone(),this.skew=q.skew,this.maskPath=q.maskPath,this.mask=q.mask,this}}]),U}(D.PerspectiveCamera),x=_;a.default=x}(Sw)),Sw}var Rw={},lS;function LC(){return lS||(lS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.MODE=a.ClassificationScheme=void 0;var R=u(Wi()),M=u(Cs()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(kr()),C=u(Ir()),D=E(Dr()),B=u(td()),V=u(n2()),P=u(jR());function L(Q){if(typeof WeakMap!="function")return null;var Z=new WeakMap,ae=new WeakMap;return(L=function(W){return W?ae:Z})(Q)}function E(Q,Z){if(!Z&&Q&&Q.__esModule)return Q;if(Q===null||h(Q)!=="object"&&typeof Q!="function")return{default:Q};var ae=L(Z);if(ae&&ae.has(Q))return ae.get(Q);var F={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in Q)if(O!=="default"&&Object.prototype.hasOwnProperty.call(Q,O)){var X=W?Object.getOwnPropertyDescriptor(Q,O):null;X&&(X.get||X.set)?Object.defineProperty(F,O,X):F[O]=Q[O]}return F.default=Q,ae&&ae.set(Q,F),F}function b(Q){var Z=_();return function(){var ae=(0,p.default)(Q),F;if(Z){var W=(0,p.default)(this).constructor;F=Reflect.construct(ae,arguments,W)}else F=ae.apply(this,arguments);return(0,y.default)(this,F)}}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var x=`#include <itowns/WebGL2_pars_vertex>
#include <itowns/precision_qualifier>
#include <itowns/project_pars_vertex>
#if defined(USE_TEXTURES_PROJECTIVE)
#include <itowns/projective_texturing_pars_vertex>
#endif
#include <common>
#include <logdepthbuf_pars_vertex>

uniform float size;

uniform bool picking;
uniform int mode;
uniform float opacity;
uniform vec4 overlayColor;
uniform vec2 intensityRange;
uniform bool applyOpacityClassication;
attribute vec3 color;
attribute vec4 unique_id;
attribute float intensity;
attribute float classification;
uniform sampler2D classificationLUT;

#if defined(NORMAL_OCT16)
attribute vec2 oct16Normal;
#elif defined(NORMAL_SPHEREMAPPED)
attribute vec2 sphereMappedNormal;
#else
attribute vec3 normal;
#endif

varying vec4 vColor;

// see https://web.archive.org/web/20150303053317/http://lgdv.cs.fau.de/get/1602
// and implementation in PotreeConverter (BINPointReader.cpp) and potree (BinaryDecoderWorker.js)
#if defined(NORMAL_OCT16)
vec3 decodeOct16Normal(vec2 encodedNormal) {
    vec2 nNorm = 2. * (encodedNormal / 255.) - 1.;
    vec3 n;
    n.z = 1. - abs(nNorm.x) - abs(nNorm.y);
    if (n.z >= 0.) {
        n.x = nNorm.x;
        n.y = nNorm.y;
    } else {
        n.x = sign(nNorm.x) - sign(nNorm.x) * sign(nNorm.y) * nNorm.y;
        n.y = sign(nNorm.y) - sign(nNorm.y) * sign(nNorm.x) * nNorm.x;
    }
    return normalize(n);
}
#elif defined(NORMAL_SPHEREMAPPED)
// see http://aras-p.info/texts/CompactNormalStorage.html method #4
// or see potree's implementation in BINPointReader.cpp
vec3 decodeSphereMappedNormal(vec2 encodedNormal) {
    vec2 fenc = 2. * encodedNormal / 255. - 1.;
    float f = dot(fenc,fenc);
    float g = 2. * sqrt(1. - f);
    vec3 n;
    n.xy = fenc * g;
    n.z = 1. - 2. * f;
    return n;
}
#endif

void main() {

#if defined(NORMAL_OCT16)
    vec3  normal = decodeOct16Normal(oct16Normal);
#elif defined(NORMAL_SPHEREMAPPED)
    vec3 normal = decodeSphereMappedNormal(sphereMappedNormal);
#elif defined(NORMAL)
    // nothing to do
#else
    // default to color
    vec3 normal = color;
#endif

    if (picking) {
        vColor = unique_id;
    } else {
        vColor.a = opacity;
        if (applyOpacityClassication || mode == MODE_CLASSIFICATION) {
            vec2 uv = vec2(classification, 0.5);
            vColor = texture2D(classificationLUT, uv);
            vColor.a *= opacity;
        }

        if (mode == MODE_INTENSITY) {
            // adapt the grayscale knowing the range
            float i = (intensity - intensityRange.x) / (intensityRange.y - intensityRange.x);
            vColor.rgb = vec3(i, i, i);
        } else if (mode == MODE_NORMAL) {
            vColor.rgb = abs(normal);
        } else if (mode == MODE_COLOR) {
            // default to color mode
            vColor.rgb = mix(color, overlayColor.rgb, overlayColor.a);
        }
    }

    #include <begin_vertex>
    #include <project_vertex>

    if (size > 0.) {
        gl_PointSize = size;
    } else {
        gl_PointSize = clamp(-size / gl_Position.w, 3.0, 10.0);
    }

#if defined(USE_TEXTURES_PROJECTIVE)
    #include <itowns/projective_texturing_vertex>
#endif
    #include <logdepthbuf_vertex>
}
`,T=`#include <itowns/WebGL2_pars_fragment>
#include <itowns/precision_qualifier>
#include <logdepthbuf_pars_fragment>
#if defined(USE_TEXTURES_PROJECTIVE)
#include <itowns/projective_texturing_pars_fragment>
#endif

varying vec4 vColor;
uniform bool picking;
void main() {
    #include <logdepthbuf_fragment>
    // circular point rendering
    if((length(gl_PointCoord - 0.5) > 0.5) || (vColor.a == 0.0)) {
        discard;
    }
#if defined(USE_TEXTURES_PROJECTIVE)
    vec4 color = vColor;
    if (!picking) {
        #pragma unroll_loop
        for (int i = 0; i < ORIENTED_IMAGES_COUNT; i++) {
            color = projectiveTextureColor(projectiveTextureCoords[ ORIENTED_IMAGES_COUNT - 1 - i ], projectiveTextureDistortion[ ORIENTED_IMAGES_COUNT - 1 - i ], projectiveTexture[ ORIENTED_IMAGES_COUNT - 1 - i ], mask[ORIENTED_IMAGES_COUNT - 1 - i], color);
        }
        gl_FragColor = vec4(color.rgb, color.a * opacity);
    } else {
        gl_FragColor = color;
    }
#else
    gl_FragColor = vColor;
#endif
}
`,N={COLOR:0,INTENSITY:1,CLASSIFICATION:2,NORMAL:3};a.MODE=N;var U=new D.Color(1,1,1),H={DEFAULT:{0:{visible:!0,name:"never classified",color:new D.Color(.5,.5,.5),opacity:1},1:{visible:!0,name:"unclassified",color:new D.Color(.5,.5,.5),opacity:1},2:{visible:!0,name:"ground",color:new D.Color(.63,.32,.18),opacity:1},3:{visible:!0,name:"low vegetation",color:new D.Color(0,1,0),opacity:1},4:{visible:!0,name:"medium vegetation",color:new D.Color(0,.8,0),opacity:1},5:{visible:!0,name:"high vegetation",color:new D.Color(0,.6,0),opacity:1},6:{visible:!0,name:"building",color:new D.Color(1,.66,0),opacity:1},7:{visible:!0,name:"low point(noise)",color:new D.Color(1,0,1),opacity:1},8:{visible:!0,name:"key-point",color:new D.Color(1,0,0),opacity:1},9:{visible:!0,name:"water",color:new D.Color(0,0,1),opacity:1},10:{visible:!0,name:"rail",color:new D.Color(.8,.8,1),opacity:1},11:{visible:!0,name:"road Surface",color:new D.Color(.4,.4,.7),opacity:1},12:{visible:!0,name:"overlap",color:new D.Color(1,1,0),opacity:1},DEFAULT:{visible:!0,name:"default",color:new D.Color(.3,.6,.6),opacity:.5}}};a.ClassificationScheme=H;var q=function(Q){(0,v.default)(ae,Q);var Z=b(ae);function ae(){var F,W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,C.default)(this,ae);var O=W.intensityRange||new D.Vector2(0,1),X=W.orientedImageMaterial,G=W.classification||H.DEFAULT,j=W.applyOpacityClassication==null?!1:W.applyOpacityClassication;delete W.orientedImageMaterial,delete W.intensityRange,delete W.classification,delete W.applyOpacityClassication,F=Z.call(this,W),F.vertexShader=x,F.scale=W.scale||.05*.5/Math.tan(1/2),P.default.setDefineMapping((0,R.default)(F),"MODE",N),P.default.setUniformProperty((0,R.default)(F),"size",W.size||0),P.default.setUniformProperty((0,R.default)(F),"mode",W.mode||N.COLOR),P.default.setUniformProperty((0,R.default)(F),"picking",!1),P.default.setUniformProperty((0,R.default)(F),"opacity",F.opacity),P.default.setUniformProperty((0,R.default)(F),"overlayColor",W.overlayColor||new D.Vector4(0,0,0,0)),P.default.setUniformProperty((0,R.default)(F),"intensityRange",O),P.default.setUniformProperty((0,R.default)(F),"applyOpacityClassication",j);var K=new Uint8Array(256*4),ce=new D.DataTexture(K,256,1,D.RGBAFormat);return ce.needsUpdate=!0,ce.magFilter=D.NearestFilter,P.default.setUniformProperty((0,R.default)(F),"classificationLUT",ce),F.classification=G,F.recomputeClassification(),X?(F.uniforms.projectiveTextureAlphaBorder=X.uniforms.projectiveTextureAlphaBorder,F.uniforms.projectiveTextureDistortion=X.uniforms.projectiveTextureDistortion,F.uniforms.projectiveTextureMatrix=X.uniforms.projectiveTextureMatrix,F.uniforms.projectiveTexture=X.uniforms.projectiveTexture,F.uniforms.mask=X.uniforms.mask,F.uniforms.boostLight=X.uniforms.boostLight,F.defines.ORIENTED_IMAGES_COUNT=X.defines.ORIENTED_IMAGES_COUNT,F.defines.USE_DISTORTION=X.defines.USE_DISTORTION,F.defines.DEBUG_ALPHA_BORDER=X.defines.DEBUG_ALPHA_BORDER,F.defines.USE_TEXTURES_PROJECTIVE=!0,F.defines.USE_BASE_MATERIAL=!0,F.fragmentShader=V.default.unrollLoops(T,F.defines)):F.fragmentShader=T,B.default.isLogDepthBufferSupported()&&(F.defines.USE_LOGDEPTHBUF=1,F.defines.USE_LOGDEPTHBUF_EXT=1),F}return(0,g.default)(ae,[{key:"recomputeClassification",value:function(){for(var W=this.classification,O=this.classificationLUT.image.data,X=this.classificationLUT.image.width,G=0;G<X;G++){var j=void 0,K=void 0,ce=!0;W[G]?(j=W[G].color,ce=W[G].visible,K=W[G].opacity):W[G%32]?(j=W[G%32].color,ce=W[G%32].visible,K=W[G%32].opacity):W.DEFAULT?(j=W.DEFAULT.color,ce=W.DEFAULT.visible,K=W.DEFAULT.opacity):(j=U,K=1);var se=4*G;O[se+0]=parseInt(255*j.r,10),O[se+1]=parseInt(255*j.g,10),O[se+2]=parseInt(255*j.b,10),O[se+3]=ce?parseInt(255*K,10):0}this.classificationLUT.needsUpdate=!0,this.dispatchEvent({type:"material_property_changed",target:this})}},{key:"onBeforeCompile",value:function(W,O){O.capabilities.isWebGL2&&(this.defines.WEBGL2=!0,W.glslVersion="300 es")}},{key:"copy",value:function(W){return(0,M.default)((0,p.default)(ae.prototype),"copy",this).call(this,W),W.uniforms.projectiveTextureAlphaBorder&&(this.uniforms.projectiveTextureAlphaBorder=W.uniforms.projectiveTextureAlphaBorder,this.uniforms.projectiveTextureDistortion=W.uniforms.projectiveTextureDistortion,this.uniforms.projectiveTextureMatrix=W.uniforms.projectiveTextureMatrix,this.uniforms.projectiveTexture=W.uniforms.projectiveTexture,this.uniforms.mask=W.uniforms.mask,this.uniforms.boostLight=W.uniforms.boostLight),this}},{key:"enablePicking",value:function(W){this.picking=W,this.blending=W?D.NoBlending:D.NormalBlending}},{key:"update",value:function(W){return this.visible=W.visible,this.opacity=W.opacity,this.transparent=W.transparent,this.size=W.size,this.mode=W.mode,this.picking=W.picking,this.scale=W.scale,this.overlayColor.copy(W.overlayColor),this.intensityRange.copy(W.intensityRange),Object.assign(this.defines,W.defines),this}}]),ae}(D.RawShaderMaterial),te=q;a.default=te}(Rw)),Rw}var Cw={},cS;function _I(){return cS||(cS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=V(Dr()),D=ed();function B(F){if(typeof WeakMap!="function")return null;var W=new WeakMap,O=new WeakMap;return(B=function(G){return G?O:W})(F)}function V(F,W){if(!W&&F&&F.__esModule)return F;if(F===null||h(F)!=="object"&&typeof F!="function")return{default:F};var O=B(W);if(O&&O.has(F))return O.get(F);var X={},G=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in F)if(j!=="default"&&Object.prototype.hasOwnProperty.call(F,j)){var K=G?Object.getOwnPropertyDescriptor(F,j):null;K&&(K.get||K.set)?Object.defineProperty(X,j,K):X[j]=F[j]}return X.default=F,O&&O.set(F,X),X}function P(F,W){var O=typeof Symbol<"u"&&F[Symbol.iterator]||F["@@iterator"];if(!O){if(Array.isArray(F)||(O=L(F))||W&&F&&typeof F.length=="number"){O&&(F=O);var X=0,G=function(){};return{s:G,n:function(){return X>=F.length?{done:!0}:{done:!1,value:F[X++]}},e:function(ue){throw ue},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=!0,K=!1,ce;return{s:function(){O=O.call(F)},n:function(){var ue=O.next();return j=ue.done,ue},e:function(ue){K=!0,ce=ue},f:function(){try{!j&&O.return!=null&&O.return()}finally{if(K)throw ce}}}}function L(F,W){if(!!F){if(typeof F=="string")return E(F,W);var O=Object.prototype.toString.call(F).slice(8,-1);if(O==="Object"&&F.constructor&&(O=F.constructor.name),O==="Map"||O==="Set")return Array.from(F);if(O==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(O))return E(F,W)}}function E(F,W){(W==null||W>F.length)&&(W=F.length);for(var O=0,X=new Array(W);O<W;O++)X[O]=F[O];return X}function b(F){var W=_();return function(){var O=(0,g.default)(F),X;if(W){var G=(0,g.default)(this).constructor;X=Reflect.construct(O,arguments,G)}else X=O.apply(this,arguments);return(0,p.default)(this,X)}}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var x={38:{method:"translateZ",sign:-1},40:{method:"translateZ",sign:1},37:{method:"translateX",sign:-1},39:{method:"translateX",sign:1},33:{method:"rotateZ",sign:1,noSpeed:!0},34:{method:"rotateZ",sign:-1,noSpeed:!0},wheelup:{method:"translateZ",sign:1,oneshot:!0},wheeldown:{method:"translateZ",sign:-1,oneshot:!0}};function T(F){F.preventDefault(),this._isMouseDown=!0;var W=this.view.eventToViewCoords(F);this._onMouseDownMouseX=W.x,this._onMouseDownMouseY=W.y}function N(F){F.preventDefault(),this._isMouseDown=!0,this._onMouseDownMouseX=F.touches[0].pageX,this._onMouseDownMouseY=F.touches[0].pageY}function U(F){if(this._isMouseDown===!0){var W=this.view.eventToViewCoords(F),O=C.MathUtils.degToRad(this._camera3D.fov)/this.view.mainLoop.gfxEngine.height;this._camera3D.rotateY((W.x-this._onMouseDownMouseX)*O),this._camera3D.rotateX((W.y-this._onMouseDownMouseY)*O),this._onMouseDownMouseX=W.x,this._onMouseDownMouseY=W.y,this.view.notifyChange(this._camera3D,!1)}}function H(){this._isMouseDown=!1}function q(F){var W=x[F.keyCode];W&&(this.moves.delete(W),F.preventDefault())}function te(F){var W=x[F.keyCode];W&&(this.moves.add(W),this.view.notifyChange(this._camera3D,!1),F.preventDefault())}function Q(F){var W=-F.deltaY;W<0?this.moves.add(x.wheelup):this.moves.add(x.wheeldown),this.view.notifyChange(this._camera3D,!1)}var Z=function(F){(0,y.default)(O,F);var W=b(O);function O(X){var G,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,R.default)(this,O),G=W.call(this),G.view=X,G.options=j,G._camera3D=X.camera.camera3D,G.moves=new Set,G.moveSpeed=10,G._onMouseDownMouseX=0,G._onMouseDownMouseY=0,G._isMouseDown=!1,X.domElement.addEventListener("mousedown",T.bind((0,v.default)(G)),!1),X.domElement.addEventListener("touchstart",N.bind((0,v.default)(G)),!1);var K=U.bind((0,v.default)(G));return X.domElement.addEventListener("mousemove",K,!1),X.domElement.addEventListener("touchmove",K,!1),X.domElement.addEventListener("mouseup",H.bind((0,v.default)(G)),!1),X.domElement.addEventListener("touchend",H.bind((0,v.default)(G)),!1),X.domElement.addEventListener("wheel",Q.bind((0,v.default)(G)),!1),X.domElement.addEventListener("keyup",q.bind((0,v.default)(G)),!0),X.domElement.addEventListener("keydown",te.bind((0,v.default)(G)),!0),G.view.addFrameRequester(D.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE,G.update.bind((0,v.default)(G))),j.focusOnMouseOver&&X.domElement.addEventListener("mouseover",function(){return X.domElement.focus()}),j.focusOnClick&&X.domElement.addEventListener("click",function(){return X.domElement.focus()}),G}return(0,M.default)(O,[{key:"isUserInteracting",value:function(){return this.moves.size!==0||this._isMouseDown}},{key:"update",value:function(G,j){j&&(G=16);var K=P(this.moves),ce;try{for(K.s();!(ce=K.n()).done;){var se=ce.value;this._camera3D[se.method](se.sign*(se.noSpeed?1:this.moveSpeed)*G/1e3)}}catch(Ee){K.e(Ee)}finally{K.f()}if(this.moves.size>0||this._isMouseDown){this.view.notifyChange(this._camera3D);var ue=P(this.moves),Y;try{for(ue.s();!(Y=ue.n()).done;){var pe=Y.value;pe.oneshot&&this.moves.delete(pe)}}catch(Ee){ue.e(Ee)}finally{ue.f()}}}}]),O}(C.EventDispatcher),ae=Z;a.default=ae}(Cw)),Cw}var Pw={},fS;function OC(){return fS||(fS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=V(Dr()),D=ed();function B(W){if(typeof WeakMap!="function")return null;var O=new WeakMap,X=new WeakMap;return(B=function(j){return j?X:O})(W)}function V(W,O){if(!O&&W&&W.__esModule)return W;if(W===null||h(W)!=="object"&&typeof W!="function")return{default:W};var X=B(O);if(X&&X.has(W))return X.get(W);var G={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in W)if(K!=="default"&&Object.prototype.hasOwnProperty.call(W,K)){var ce=j?Object.getOwnPropertyDescriptor(W,K):null;ce&&(ce.get||ce.set)?Object.defineProperty(G,K,ce):G[K]=W[K]}return G.default=W,X&&X.set(W,G),G}function P(W,O){var X=typeof Symbol<"u"&&W[Symbol.iterator]||W["@@iterator"];if(!X){if(Array.isArray(W)||(X=L(W))||O&&W&&typeof W.length=="number"){X&&(W=X);var G=0,j=function(){};return{s:j,n:function(){return G>=W.length?{done:!0}:{done:!1,value:W[G++]}},e:function(Y){throw Y},f:j}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var K=!0,ce=!1,se;return{s:function(){X=X.call(W)},n:function(){var Y=X.next();return K=Y.done,Y},e:function(Y){ce=!0,se=Y},f:function(){try{!K&&X.return!=null&&X.return()}finally{if(ce)throw se}}}}function L(W,O){if(!!W){if(typeof W=="string")return E(W,O);var X=Object.prototype.toString.call(W).slice(8,-1);if(X==="Object"&&W.constructor&&(X=W.constructor.name),X==="Map"||X==="Set")return Array.from(W);if(X==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(X))return E(W,O)}}function E(W,O){(O==null||O>W.length)&&(O=W.length);for(var X=0,G=new Array(O);X<O;X++)G[X]=W[X];return G}function b(W){var O=_();return function(){var X=(0,g.default)(W),G;if(O){var j=(0,g.default)(this).constructor;G=Reflect.construct(X,arguments,j)}else G=X.apply(this,arguments);return(0,p.default)(this,G)}}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function x(W,O,X){var G=C.MathUtils.degToRad(X-W.fov)*.5;return C.MathUtils.clamp(O,-G,G)}var T=new C.Vector3(0,1,0);function N(W,O,X){O.quaternion.setFromUnitVectors(T,O.up),O.rotateY(X.rotateY),O.rotateX(X.rotateX),W.notifyChange(W.camera.camera3D)}var U={38:{method:"translateZ",sign:-1},40:{method:"translateZ",sign:1},37:{method:"translateX",sign:-1},39:{method:"translateX",sign:1},33:{method:"translateY",sign:1},34:{method:"translateY",sign:-1}};function H(W){this.camera.position.z+=W}var q=new C.Vector3,te=new C.Quaternion,Q=new C.Euler(0,0,0,"YXZ");function Z(W){q.copy(this.camera.position),q.normalize(),this.camera.position.add(q.multiplyScalar(W))}var ae=function(W){(0,y.default)(X,W);var O=b(X);function X(G){var j,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((0,R.default)(this,X),j=O.call(this),j.isFirstPersonControls=!0,j.camera=G.camera.camera3D,j.view=G,j.moves=new Set,K.panoramaRatio){var ce=K.panoramaRatio*200/(2*Math.PI);K.verticalFOV=K.panoramaRatio==2?180:C.MathUtils.radToDeg(2*Math.atan(200/(2*ce)))}return K.verticalFOV=K.verticalFOV||180,K.moveSpeed=K.moveSpeed===void 0?10:K.moveSpeed,j.options=K,j._isMouseDown=!1,j._onMouseDownMouseX=0,j._onMouseDownMouseY=0,j._state={rotateX:0,rotateY:0,snapshot:function(){return{rotateX:this.rotateX,rotateY:this.rotateY}}},j.reset(),j.eventListeners=K.disableEventListeners,K.disableEventListeners||(j._onMouseDown=j.onMouseDown.bind((0,v.default)(j)),j._onMouseMove=j.onMouseMove.bind((0,v.default)(j)),j._onMouseUp=j.onMouseUp.bind((0,v.default)(j)),j._onMouseWheel=j.onMouseWheel.bind((0,v.default)(j)),j._onKeyUp=j.onKeyUp.bind((0,v.default)(j)),j._onKeyDown=j.onKeyDown.bind((0,v.default)(j)),j._onContextMenu=j.onContextMenu.bind((0,v.default)(j)),G.domElement.addEventListener("mousedown",j._onMouseDown,!1),G.domElement.addEventListener("touchstart",j._onMouseDown,!1),G.domElement.addEventListener("mousemove",j._onMouseMove,!1),G.domElement.addEventListener("touchmove",j._onMouseMove,!1),G.domElement.addEventListener("mouseup",j._onMouseUp,!1),G.domElement.addEventListener("touchend",j._onMouseUp,!1),G.domElement.addEventListener("wheel",j._onMouseWheel,!1),G.domElement.addEventListener("contextmenu",j._onContextMenu,!1),document.addEventListener("keydown",j._onKeyDown,!1),document.addEventListener("keyup",j._onKeyUp,!1)),j.view.addFrameRequester(D.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE,j.update.bind((0,v.default)(j))),j._onFocus=function(){return G.domElement.focus()},j.focusOnMouseOver=K.focusOnMouseOver,K.focusOnMouseOver&&G.domElement.addEventListener("mouseover",j._onFocus),j.focusOnClick=K.focusOnClick,K.focusOnClick&&G.domElement.addEventListener("click",j._onFocus),G.referenceCrs=="EPSG:4978"?j.moveCameraVertical=Z:j.moveCameraVertical=H,j}return(0,M.default)(X,[{key:"isUserInteracting",value:function(){return this.moves.size!==0&&!this._isMouseDown}},{key:"reset",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;te.setFromUnitVectors(T,this.camera.up),te.invert(),te.multiply(this.camera.quaternion),Q.setFromQuaternion(te),j||(this._state.rotateX=Q.x),this._state.rotateY=Q.y}},{key:"update",value:function(j,K,ce){if(this.enabled!=!1){K&&(j=16);var se=P(this.moves),ue;try{for(se.s();!(ue=se.n()).done;){var Y=ue.value;Y.method==="translateY"?this.moveCameraVertical(Y.sign*this.options.moveSpeed*j/1e3):this.camera[Y.method](Y.sign*this.options.moveSpeed*j/1e3)}}catch(pe){se.e(pe)}finally{se.f()}(this._isMouseDown===!0||ce===!0)&&N(this.view,this.camera,this._state),this.moves.size&&this.view.notifyChange(this.view.camera.camera3D)}}},{key:"onMouseDown",value:function(j){if(this.enabled!=!1){this._isMouseDown=!0;var K=this.view.eventToViewCoords(j);this._onMouseDownMouseX=K.x,this._onMouseDownMouseY=K.y,this._stateOnMouseDown=this._state.snapshot()}}},{key:"onMouseUp",value:function(){this.enabled!=!1&&(this._isMouseDown=!1)}},{key:"onMouseMove",value:function(j){if(this.enabled!=!1&&this._isMouseDown===!0){var K=C.MathUtils.degToRad(this.camera.fov)/this.view.mainLoop.gfxEngine.height,ce=this.view.eventToViewCoords(j);this._state.rotateY=(ce.x-this._onMouseDownMouseX)*K+this._stateOnMouseDown.rotateY,this._state.rotateX=x(this.camera,(ce.y-this._onMouseDownMouseY)*K+this._stateOnMouseDown.rotateX,this.options.verticalFOV),N(this.view,this.camera,this._state)}}},{key:"onMouseWheel",value:function(j){if(this.enabled!=!1){var K=j.deltaY;this.camera.fov=C.MathUtils.clamp(this.camera.fov+Math.sign(K),10,Math.min(100,this.options.verticalFOV)),this.camera.updateProjectionMatrix(),this._state.rotateX=x(this.camera,this._state.rotateX,this.options.verticalFOV),N(this.view,this.camera,this._state)}}},{key:"onKeyUp",value:function(j){if(this.enabled!=!1){var K=U[j.keyCode];K&&(this.moves.delete(K),this.view.notifyChange(void 0,!1),j.preventDefault())}}},{key:"onKeyDown",value:function(j){if(this.enabled!=!1){var K=U[j.keyCode];K&&(this.moves.add(K),this.view.notifyChange(void 0,!1),j.preventDefault())}}},{key:"onContextMenu",value:function(j){j.preventDefault()}},{key:"dispose",value:function(){this.eventListeners||(this.view.domElement.removeEventListener("mousedown",this._onMouseDown,!1),this.view.domElement.removeEventListener("touchstart",this._onMouseDown,!1),this.view.domElement.removeEventListener("mousemove",this._onMouseMove,!1),this.view.domElement.removeEventListener("touchmove",this._onMouseMove,!1),this.view.domElement.removeEventListener("mouseup",this._onMouseUp,!1),this.view.domElement.removeEventListener("touchend",this._onMouseUp,!1),this.view.domElement.removeEventListener("wheel",this._onMouseWheel,!1),this.view.domElement.removeEventListener("contextmenu",this._onContextMenu,!1),document.removeEventListener("keydown",this._onKeyDown,!1),document.removeEventListener("keyup",this._onKeyUp,!1)),this.focusOnMouseOver&&this.view.domElement.removeEventListener("mouseover",this._onFocus),this.focusOnClick&&this.view.domElement.removeEventListener("click",this._onFocus),this.dispatchEvent({type:"dispose"})}}]),X}(C.EventDispatcher),F=ae;a.default=F}(Pw)),Pw}var Lw={},hS;function xI(){return hS||(hS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(Cs()),C=u(ln()),D=u(xC),B=E(Dr()),V=ed(),P=u(OC());function L(X){if(typeof WeakMap!="function")return null;var G=new WeakMap,j=new WeakMap;return(L=function(ce){return ce?j:G})(X)}function E(X,G){if(!G&&X&&X.__esModule)return X;if(X===null||h(X)!=="object"&&typeof X!="function")return{default:X};var j=L(G);if(j&&j.has(X))return j.get(X);var K={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in X)if(se!=="default"&&Object.prototype.hasOwnProperty.call(X,se)){var ue=ce?Object.getOwnPropertyDescriptor(X,se):null;ue&&(ue.get||ue.set)?Object.defineProperty(K,se,ue):K[se]=X[se]}return K.default=X,j&&j.set(X,K),K}function b(X){var G=_();return function(){var j=(0,C.default)(X),K;if(G){var ce=(0,C.default)(this).constructor;K=Reflect.construct(j,arguments,ce)}else K=j.apply(this,arguments);return(0,p.default)(this,K)}}function _(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var x=new B.MeshBasicMaterial({color:16777215,depthTest:!1,transparent:!0,opacity:.5});function T(){var X=new B.CircleGeometry(1,32);return new B.Mesh(X,x)}function N(){var X=new B.PlaneGeometry(4,2,1),G=new B.Mesh(X,x);return G.rotateX(-Math.PI*.5),G}function U(X,G,j){X.position.copy(G),X.up.copy(G).normalize(),X.lookAt(j),X.updateMatrixWorld(!0)}var H=new B.Vector3,q=new B.Vector3,te=new B.Matrix3,Q=new B.Vector3,Z=new B.Quaternion;function ae(X,G,j){var K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:function(){},ce=arguments.length>4&&arguments[4]!==void 0?arguments[4]:function(){},se=arguments.length>5&&arguments[5]!==void 0?arguments[5]:function(){};G.getPickingPositionFromDepth(G.eventToViewCoords(X),H);var ue=G.camera.camera3D.position.distanceTo(H),Y=j?G.pickObjectsAt(X,-1,j):[];if(Y.length&&Y[0].distance<ue)te.getNormalMatrix(Y[0].object.matrixWorld),q.copy(Y[0].face.normal).applyNormalMatrix(te),ce(Y[0].point,q);else if(G.tileLayer){var pe=G.camera.camera3D.far*.95;ue<pe?(G.tileLayer.isGlobeLayer?Q.copy(H).multiplyScalar(1.1):Q.set(0,0,1),K(H,Q)):se()}else se()}function F(X){return 100+Math.sqrt(X)*30}var W=function(X){(0,y.default)(j,X);var G=b(j);function j(K){var ce,se,ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,R.default)(this,j),se=G.call(this,K,ue),se.isStreetControls=!0,se._onMouseOut=(0,g.default)((ce=(0,v.default)(se),(0,C.default)(j.prototype)),"onMouseUp",ce).bind((0,v.default)(se)),K.domElement.addEventListener("mouseout",se._onMouseOut),se.previousPosition=void 0,se.currentPosition=void 0,se.nextPosition=void 0,se.keyGoToNextPosition=90,se.keyGoToPreviousPosition=83,se.keySetCameraToCurrentPositionAndLookAtNext=65,se.keySetCameraToCurrentPositionAndLookAtPrevious=81,se.tweenGroup=new D.default.Group,se.surfaceGround=ue.surfaceGround||T(),se.surfaceWall=ue.surfaceWall||N(),se.surfaces=new B.Object3D,se.surfaces.add(se.surfaceGround),se.surfaces.add(se.surfaceWall),se.view.scene.add(se.surfaces),se.wallMaxDistance=ue.wallMaxDistance||1e3,se.animationDurationWall=ue.animationDurationWall||200,se.buildingsLayer=ue.buildingsLayer,se.computeTime=ue.computeTime||F,se.offset=ue.offset||4,se.transformationPositionPickOnTheGround=ue.transformationPositionPickOnTheGround||function(Y){return Y},se.end=se.camera.clone(),se}return(0,M.default)(j,[{key:"setCurrentPosition",value:function(ce){this.currentPosition=ce}},{key:"setNextPosition",value:function(ce){this.nextPosition=ce}},{key:"setPreviousPosition",value:function(ce){this.previousPosition=ce}},{key:"onMouseUp",value:function(ce){this.enabled!=!1&&((0,g.default)((0,C.default)(j.prototype),"onMouseUp",this).call(this),this._stateOnMouseDrag?this._stateOnMouseDrag=!1:ae(ce,this.view,this.buildingsLayer,this.onClickOnGround.bind(this),this.onClickOnWall.bind(this)))}},{key:"onMouseMove",value:function(ce){var se=this;this.enabled!=!1&&((0,g.default)((0,C.default)(j.prototype),"onMouseMove",this).call(this,ce),this._isMouseDown?(this._stateOnMouseDrag=!0,this.stopAnimations()):this.tween||(ae(ce,this.view,this.buildingsLayer,function(ue,Y){U(se.surfaces,ue,Y),se.surfaceGround.visible=!0,se.surfaceWall.visible=!1},function(ue,Y){U(se.surfaces,ue,Y),se.surfaceWall.visible=!0,se.surfaceGround.visible=!1}),this.view.notifyChange(this.surfaces)))}},{key:"setCameraToCurrentPosition",value:function(ce){ce?this.setCameraOnPosition(this.currentPosition,this.previousPosition):this.setCameraOnPosition(this.currentPosition,this.nextPosition)}},{key:"setCameraOnPosition",value:function(ce,se){!ce||!se||(this.camera.position.copy(ce),this.view.tileLayer&&this.view.tileLayer.isGlobeLayer?this.camera.up.copy(ce).normalize():this.camera.up.set(0,0,1),this.camera.lookAt(se),this.camera.updateMatrixWorld(),this.reset())}},{key:"onClickOnGround",value:function(ce){ce=this.transformationPositionPickOnTheGround(ce),this.view.tileLayer&&this.view.tileLayer.isGlobeLayer?Q.copy(ce).normalize():Q.set(0,0,1),ce.add(Q.multiplyScalar(this.offset));var se=this.camera.position.distanceTo(ce),ue=this.computeTime(se);this.moveCameraTo(ce,ue)}},{key:"onClickOnWall",value:function(ce){var se=this.camera.position.distanceTo(ce);se<this.wallMaxDistance&&this.animateCameraLookAt(ce,this.animationDurationWall)}},{key:"animateCameraLookAt",value:function(ce,se){var ue=this;this.stopAnimations(),Z.copy(this.camera.quaternion),this.end.copy(this.camera),this.end.lookAt(ce),this.tween=new D.default.Tween({t:0},this.tweenGroup).to({t:1},se).easing(D.default.Easing.Quadratic.Out).onComplete(function(){ue.stopAnimations()}).onUpdate(function(Y){ue.camera.quaternion.slerpQuaternions(Z,ue.end.quaternion,Y.t)}).start(),this.animationFrameRequester=function(){ue.tweenGroup.update(),ue.reset(),ue.view.notifyChange(ue.camera)},this.view.addFrameRequester(V.MAIN_LOOP_EVENTS.BEFORE_RENDER,this.animationFrameRequester),this.view.notifyChange(this.camera)}},{key:"moveCameraTo",value:function(ce){var se=this,ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:50;if(!ce)return Promise.resolve();var Y,pe=new Promise(function(Ee){Y=Ee});return this.stopAnimations(),this.tween=new D.default.Tween(this.camera.position,this.tweenGroup).to(ce.clone(),ue).easing(D.default.Easing.Quadratic.Out).onComplete(function(){se.stopAnimations(),Y()}).start(),this.animationFrameRequester=function(){se.tweenGroup.update(),se.view.notifyChange(se.camera)},this.view.addFrameRequester(V.MAIN_LOOP_EVENTS.BEFORE_RENDER,this.animationFrameRequester),this.view.notifyChange(this.camera),pe}},{key:"stopAnimations",value:function(){this.tween&&(this.tween.stop(),this.tween=void 0),this.animationFrameRequester&&(this.view.removeFrameRequester(V.MAIN_LOOP_EVENTS.BEFORE_RENDER,this.animationFrameRequester),this.animationFrameRequester=null)}},{key:"moveCameraToCurrentPosition",value:function(){this.moveCameraTo(this.currentPosition)}},{key:"onKeyDown",value:function(ce){this.enabled!=!1&&((0,g.default)((0,C.default)(j.prototype),"onKeyDown",this).call(this,ce),ce.keyCode==this.keyGoToNextPosition&&this.moveCameraTo(this.nextPosition),ce.keyCode==this.keyGoToPreviousPosition&&this.moveCameraTo(this.previousPosition),ce.keyCode==this.keySetCameraToCurrentPositionAndLookAtNext&&(this.setCameraToCurrentPosition(),this.view.notifyChange(this.view.camera.camera3D)),ce.keyCode==this.keySetCameraToCurrentPositionAndLookAtPrevious&&(this.setCameraToCurrentPosition(!0),this.view.notifyChange(this.view.camera.camera3D)))}},{key:"dispose",value:function(){this.view.domElement.removeEventListener("mouseout",this._onMouseOut,!1),(0,g.default)((0,C.default)(j.prototype),"dispose",this).call(this)}}]),j}(P.default),O=W;a.default=O}(Lw)),Lw}var Ow={},Ny={exports:{}},dS;function AI(){if(dS)return Ny.exports;dS=1,Ny.exports=a,Ny.exports.default=a;function a(G,j,K){K=K||2;var ce=j&&j.length,se=ce?j[0]*K:G.length,ue=u(G,0,se,K,!0),Y=[];if(!ue||ue.next===ue.prev)return Y;var pe,Ee,Fe,$e,pt,Ue,Je;if(ce&&(ue=g(G,j,ue,K)),G.length>80*K){pe=Fe=G[0],Ee=$e=G[1];for(var et=K;et<se;et+=K)pt=G[et],Ue=G[et+1],pt<pe&&(pe=pt),Ue<Ee&&(Ee=Ue),pt>Fe&&(Fe=pt),Ue>$e&&($e=Ue);Je=Math.max(Fe-pe,$e-Ee),Je=Je!==0?32767/Je:0}return R(ue,Y,K,pe,Ee,Je,0),Y}function u(G,j,K,ce,se){var ue,Y;if(se===X(G,j,K,ce)>0)for(ue=j;ue<K;ue+=ce)Y=F(ue,G[ue],G[ue+1],Y);else for(ue=K-ce;ue>=j;ue-=ce)Y=F(ue,G[ue],G[ue+1],Y);return Y&&N(Y,Y.next)&&(W(Y),Y=Y.next),Y}function h(G,j){if(!G)return G;j||(j=G);var K=G,ce;do if(ce=!1,!K.steiner&&(N(K,K.next)||T(K.prev,K,K.next)===0)){if(W(K),K=j=K.prev,K===K.next)break;ce=!0}else K=K.next;while(ce||K!==j);return j}function R(G,j,K,ce,se,ue,Y){if(!!G){!Y&&ue&&P(G,ce,se,ue);for(var pe=G,Ee,Fe;G.prev!==G.next;){if(Ee=G.prev,Fe=G.next,ue?v(G,ce,se,ue):M(G)){j.push(Ee.i/K|0),j.push(G.i/K|0),j.push(Fe.i/K|0),W(G),G=Fe.next,pe=Fe.next;continue}if(G=Fe,G===pe){Y?Y===1?(G=y(h(G),j,K),R(G,j,K,ce,se,ue,2)):Y===2&&p(G,j,K,ce,se,ue):R(h(G),j,K,ce,se,ue,1);break}}}}function M(G){var j=G.prev,K=G,ce=G.next;if(T(j,K,ce)>=0)return!1;for(var se=j.x,ue=K.x,Y=ce.x,pe=j.y,Ee=K.y,Fe=ce.y,$e=se<ue?se<Y?se:Y:ue<Y?ue:Y,pt=pe<Ee?pe<Fe?pe:Fe:Ee<Fe?Ee:Fe,Ue=se>ue?se>Y?se:Y:ue>Y?ue:Y,Je=pe>Ee?pe>Fe?pe:Fe:Ee>Fe?Ee:Fe,et=ce.next;et!==j;){if(et.x>=$e&&et.x<=Ue&&et.y>=pt&&et.y<=Je&&_(se,pe,ue,Ee,Y,Fe,et.x,et.y)&&T(et.prev,et,et.next)>=0)return!1;et=et.next}return!0}function v(G,j,K,ce){var se=G.prev,ue=G,Y=G.next;if(T(se,ue,Y)>=0)return!1;for(var pe=se.x,Ee=ue.x,Fe=Y.x,$e=se.y,pt=ue.y,Ue=Y.y,Je=pe<Ee?pe<Fe?pe:Fe:Ee<Fe?Ee:Fe,et=$e<pt?$e<Ue?$e:Ue:pt<Ue?pt:Ue,ze=pe>Ee?pe>Fe?pe:Fe:Ee>Fe?Ee:Fe,Xe=$e>pt?$e>Ue?$e:Ue:pt>Ue?pt:Ue,tt=E(Je,et,j,K,ce),ye=E(ze,Xe,j,K,ce),Ze=G.prevZ,Ge=G.nextZ;Ze&&Ze.z>=tt&&Ge&&Ge.z<=ye;){if(Ze.x>=Je&&Ze.x<=ze&&Ze.y>=et&&Ze.y<=Xe&&Ze!==se&&Ze!==Y&&_(pe,$e,Ee,pt,Fe,Ue,Ze.x,Ze.y)&&T(Ze.prev,Ze,Ze.next)>=0||(Ze=Ze.prevZ,Ge.x>=Je&&Ge.x<=ze&&Ge.y>=et&&Ge.y<=Xe&&Ge!==se&&Ge!==Y&&_(pe,$e,Ee,pt,Fe,Ue,Ge.x,Ge.y)&&T(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;Ze&&Ze.z>=tt;){if(Ze.x>=Je&&Ze.x<=ze&&Ze.y>=et&&Ze.y<=Xe&&Ze!==se&&Ze!==Y&&_(pe,$e,Ee,pt,Fe,Ue,Ze.x,Ze.y)&&T(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.prevZ}for(;Ge&&Ge.z<=ye;){if(Ge.x>=Je&&Ge.x<=ze&&Ge.y>=et&&Ge.y<=Xe&&Ge!==se&&Ge!==Y&&_(pe,$e,Ee,pt,Fe,Ue,Ge.x,Ge.y)&&T(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function y(G,j,K){var ce=G;do{var se=ce.prev,ue=ce.next.next;!N(se,ue)&&U(se,ce,ce.next,ue)&&Q(se,ue)&&Q(ue,se)&&(j.push(se.i/K|0),j.push(ce.i/K|0),j.push(ue.i/K|0),W(ce),W(ce.next),ce=G=ue),ce=ce.next}while(ce!==G);return h(ce)}function p(G,j,K,ce,se,ue){var Y=G;do{for(var pe=Y.next.next;pe!==Y.prev;){if(Y.i!==pe.i&&x(Y,pe)){var Ee=ae(Y,pe);Y=h(Y,Y.next),Ee=h(Ee,Ee.next),R(Y,j,K,ce,se,ue,0),R(Ee,j,K,ce,se,ue,0);return}pe=pe.next}Y=Y.next}while(Y!==G)}function g(G,j,K,ce){var se=[],ue,Y,pe,Ee,Fe;for(ue=0,Y=j.length;ue<Y;ue++)pe=j[ue]*ce,Ee=ue<Y-1?j[ue+1]*ce:G.length,Fe=u(G,pe,Ee,ce,!1),Fe===Fe.next&&(Fe.steiner=!0),se.push(b(Fe));for(se.sort(C),ue=0;ue<se.length;ue++)K=D(se[ue],K);return K}function C(G,j){return G.x-j.x}function D(G,j){var K=B(G,j);if(!K)return j;var ce=ae(K,G);return h(ce,ce.next),h(K,K.next)}function B(G,j){var K=j,ce=G.x,se=G.y,ue=-1/0,Y;do{if(se<=K.y&&se>=K.next.y&&K.next.y!==K.y){var pe=K.x+(se-K.y)*(K.next.x-K.x)/(K.next.y-K.y);if(pe<=ce&&pe>ue&&(ue=pe,Y=K.x<K.next.x?K:K.next,pe===ce))return Y}K=K.next}while(K!==j);if(!Y)return null;var Ee=Y,Fe=Y.x,$e=Y.y,pt=1/0,Ue;K=Y;do ce>=K.x&&K.x>=Fe&&ce!==K.x&&_(se<$e?ce:ue,se,Fe,$e,se<$e?ue:ce,se,K.x,K.y)&&(Ue=Math.abs(se-K.y)/(ce-K.x),Q(K,G)&&(Ue<pt||Ue===pt&&(K.x>Y.x||K.x===Y.x&&V(Y,K)))&&(Y=K,pt=Ue)),K=K.next;while(K!==Ee);return Y}function V(G,j){return T(G.prev,G,j.prev)<0&&T(j.next,G,G.next)<0}function P(G,j,K,ce){var se=G;do se.z===0&&(se.z=E(se.x,se.y,j,K,ce)),se.prevZ=se.prev,se.nextZ=se.next,se=se.next;while(se!==G);se.prevZ.nextZ=null,se.prevZ=null,L(se)}function L(G){var j,K,ce,se,ue,Y,pe,Ee,Fe=1;do{for(K=G,G=null,ue=null,Y=0;K;){for(Y++,ce=K,pe=0,j=0;j<Fe&&(pe++,ce=ce.nextZ,!!ce);j++);for(Ee=Fe;pe>0||Ee>0&&ce;)pe!==0&&(Ee===0||!ce||K.z<=ce.z)?(se=K,K=K.nextZ,pe--):(se=ce,ce=ce.nextZ,Ee--),ue?ue.nextZ=se:G=se,se.prevZ=ue,ue=se;K=ce}ue.nextZ=null,Fe*=2}while(Y>1);return G}function E(G,j,K,ce,se){return G=(G-K)*se|0,j=(j-ce)*se|0,G=(G|G<<8)&16711935,G=(G|G<<4)&252645135,G=(G|G<<2)&858993459,G=(G|G<<1)&1431655765,j=(j|j<<8)&16711935,j=(j|j<<4)&252645135,j=(j|j<<2)&858993459,j=(j|j<<1)&1431655765,G|j<<1}function b(G){var j=G,K=G;do(j.x<K.x||j.x===K.x&&j.y<K.y)&&(K=j),j=j.next;while(j!==G);return K}function _(G,j,K,ce,se,ue,Y,pe){return(se-Y)*(j-pe)>=(G-Y)*(ue-pe)&&(G-Y)*(ce-pe)>=(K-Y)*(j-pe)&&(K-Y)*(ue-pe)>=(se-Y)*(ce-pe)}function x(G,j){return G.next.i!==j.i&&G.prev.i!==j.i&&!te(G,j)&&(Q(G,j)&&Q(j,G)&&Z(G,j)&&(T(G.prev,G,j.prev)||T(G,j.prev,j))||N(G,j)&&T(G.prev,G,G.next)>0&&T(j.prev,j,j.next)>0)}function T(G,j,K){return(j.y-G.y)*(K.x-j.x)-(j.x-G.x)*(K.y-j.y)}function N(G,j){return G.x===j.x&&G.y===j.y}function U(G,j,K,ce){var se=q(T(G,j,K)),ue=q(T(G,j,ce)),Y=q(T(K,ce,G)),pe=q(T(K,ce,j));return!!(se!==ue&&Y!==pe||se===0&&H(G,K,j)||ue===0&&H(G,ce,j)||Y===0&&H(K,G,ce)||pe===0&&H(K,j,ce))}function H(G,j,K){return j.x<=Math.max(G.x,K.x)&&j.x>=Math.min(G.x,K.x)&&j.y<=Math.max(G.y,K.y)&&j.y>=Math.min(G.y,K.y)}function q(G){return G>0?1:G<0?-1:0}function te(G,j){var K=G;do{if(K.i!==G.i&&K.next.i!==G.i&&K.i!==j.i&&K.next.i!==j.i&&U(K,K.next,G,j))return!0;K=K.next}while(K!==G);return!1}function Q(G,j){return T(G.prev,G,G.next)<0?T(G,j,G.next)>=0&&T(G,G.prev,j)>=0:T(G,j,G.prev)<0||T(G,G.next,j)<0}function Z(G,j){var K=G,ce=!1,se=(G.x+j.x)/2,ue=(G.y+j.y)/2;do K.y>ue!=K.next.y>ue&&K.next.y!==K.y&&se<(K.next.x-K.x)*(ue-K.y)/(K.next.y-K.y)+K.x&&(ce=!ce),K=K.next;while(K!==G);return ce}function ae(G,j){var K=new O(G.i,G.x,G.y),ce=new O(j.i,j.x,j.y),se=G.next,ue=j.prev;return G.next=j,j.prev=G,K.next=se,se.prev=K,ce.next=K,K.prev=ce,ue.next=ce,ce.prev=ue,ce}function F(G,j,K,ce){var se=new O(G,j,K);return ce?(se.next=ce.next,se.prev=ce,ce.next.prev=se,ce.next=se):(se.prev=se,se.next=se),se}function W(G){G.next.prev=G.prev,G.prev.next=G.next,G.prevZ&&(G.prevZ.nextZ=G.nextZ),G.nextZ&&(G.nextZ.prevZ=G.prevZ)}function O(G,j,K){this.i=G,this.x=j,this.y=K,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}a.deviation=function(G,j,K,ce){var se=j&&j.length,ue=se?j[0]*K:G.length,Y=Math.abs(X(G,0,ue,K));if(se)for(var pe=0,Ee=j.length;pe<Ee;pe++){var Fe=j[pe]*K,$e=pe<Ee-1?j[pe+1]*K:G.length;Y-=Math.abs(X(G,Fe,$e,K))}var pt=0;for(pe=0;pe<ce.length;pe+=3){var Ue=ce[pe]*K,Je=ce[pe+1]*K,et=ce[pe+2]*K;pt+=Math.abs((G[Ue]-G[et])*(G[Je+1]-G[Ue+1])-(G[Ue]-G[Je])*(G[et+1]-G[Ue+1]))}return Y===0&&pt===0?0:Math.abs((pt-Y)/Y)};function X(G,j,K,ce){for(var se=0,ue=j,Y=K-ce;ue<K;ue+=ce)se+=(G[Y]-G[ue])*(G[ue+1]+G[Y+1]),Y=ue;return se}return a.flatten=function(G){for(var j=G[0][0].length,K={vertices:[],holes:[],dimensions:j},ce=0,se=0;se<G.length;se++){for(var ue=0;ue<G[se].length;ue++)for(var Y=0;Y<j;Y++)K.vertices.push(G[se][ue][Y]);se>0&&(ce+=G[se-1].length,K.holes.push(ce))}return K},Ny.exports}var Fw={},pS;function tb(){return pS||(pS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=p(Dr()),M=u(Jh),v=u(Zi());function y(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,N=new WeakMap;return(y=function(H){return H?N:T})(x)}function p(x,T){if(!T&&x&&x.__esModule)return x;if(x===null||h(x)!=="object"&&typeof x!="function")return{default:x};var N=y(T);if(N&&N.has(x))return N.get(x);var U={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in x)if(q!=="default"&&Object.prototype.hasOwnProperty.call(x,q)){var te=H?Object.getOwnPropertyDescriptor(x,q):null;te&&(te.get||te.set)?Object.defineProperty(U,q,te):U[q]=x[q]}return U.default=x,N&&N.set(x,U),U}var g=R.MathUtils.DEG2RAD,C=new R.Matrix4,D=new R.Vector3,B=new R.Vector3,V=new R.Vector3().set(0,0,1),P=new v.default("EPSG:4326",0,0,0),L=new R.Euler,E=new R.Quaternion;function b(x){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return x?T.set(0,0,0,1):b}var _={quaternionFromRollPitchHeading:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new R.Quaternion;return T*=g,N*=g,U*=g,H.setFromEuler(L.set(-N,-T,-U,"YXZ"))},quaternionFromOmegaPhiKappa:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new R.Quaternion;return T*=g,N*=g,U*=g,H.setFromEuler(L.set(T,N,U,"XYZ")),H.set(H.w,H.z,-H.y,-H.x),H},quaternionFromAttitude:function(T){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return T.roll!==void 0||T.pitch!==void 0||T.heading!==void 0?this.quaternionFromRollPitchHeading(T.roll,T.pitch,T.heading,N):T.omega!==void 0||T.phi!==void 0||T.kappa!==void 0?this.quaternionFromOmegaPhiKappa(T.omega,T.phi,T.kappa,N):N.set(0,0,0,1)},quaternionFromEnuToGeocent:function(T){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return T?this.quaternionFromEnuToGeocent()(T,N):function(U){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion,q=U.geodesicNormal;return q.x==0&&q.y==0?H.set(0,0,0,1):(B.set(-q.y,q.x,0).normalize(),D.crossVectors(q,B),C.makeBasis(B,D,q),H.setFromRotationMatrix(C))}},quaternionFromGeocentToEnu:function(T){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;if(T)return this.quaternionFromGeocentToEnu()(T,N);var U=this.quaternionFromEnuToGeocent();return function(H){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return U(H,q).conjugate()}},quaternionFromLCCToEnu:function(T,N){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new R.Quaternion;if(N)return this.quaternionFromLCCToEnu(T)(N,U);var H=Math.sin(T.lat0);return function(q){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion,Q=q.as(P.crs,P).longitude*g;return te.setFromAxisAngle(V,H*(T.long0-Q))}},quaternionFromEnuToLCC:function(T,N){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new R.Quaternion;if(N)return this.quaternionFromEnuToLCC(T)(N,U);var H=this.quaternionFromLCCToEnu(T);return function(q){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return H(q,te).conjugate()}},quaternionFromTMercToEnu:function(T,N){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new R.Quaternion;if(N)return this.quaternionFromTMercToEnu(T)(N,U);var H=T.a*T.a,q=T.b*T.b,te=T.e*T.e,Q=T.e?te/(1-te):H/q-1;return function(Z){var ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;Z.as(P.crs,P);var F=P.longitude*g,W=P.latitude*g,O=T.long0-F,X=Math.cos(W),G=Math.sin(W),j=X*X,K=O*O*j,ce=Q*j;return ae.setFromAxisAngle(V,O*G*(1+K/3*(1+3*ce+2*ce*ce)+K*K*(2-G/X)/15))}},quaternionFromEnuToTMerc:function(T,N){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new R.Quaternion;if(N)return this.quaternionFromEnuToTMerc(T)(N,U);var H=this.quaternionFromTMercToEnu(T);return function(q){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return H(q,te).conjugate()}},quaternionFromLongLatToEnu:function(T){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return b(T,N)},quaternionFromEnuToLongLat:function(T){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return b(T,N)},quaternionUnimplemented:function(T,N){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new R.Quaternion;return console.warn("This quaternion function is not implemented for projections of type",T.projName),b(N,U)},quaternionFromEnuToCRS:function(T,N){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new R.Quaternion;if(N)return this.quaternionFromEnuToCRS(T)(N,U);var H=T.projName?T:M.default.defs(T);switch(H.projName){case"geocent":return this.quaternionFromEnuToGeocent();case"lcc":return this.quaternionFromEnuToLCC(H);case"tmerc":return this.quaternionFromEnuToTMerc(H);case"longlat":return this.quaternionFromEnuToLongLat();default:return this.quaternionUnimplemented(H)}},quaternionFromCRSToEnu:function(T,N){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new R.Quaternion;if(N)return this.quaternionFromCRSToEnu(T)(N,U);var H=T.projName?T:M.default.defs(T);switch(H.projName){case"geocent":return this.quaternionFromGeocentToEnu();case"lcc":return this.quaternionFromLCCToEnu(H);case"tmerc":return this.quaternionFromTMercToEnu(H);case"longlat":return this.quaternionFromLongLatToEnu();default:return this.quaternionUnimplemented(H)}},quaternionFromCRSToCRS:function(T,N,U){var H=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new R.Quaternion;if(U)return this.quaternionFromCRSToCRS(T,N)(U,H);if(T==N)return function(){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return Q.set(0,0,0,1)};var q=this.quaternionFromCRSToEnu(T),te=this.quaternionFromEnuToCRS(N);return function(Q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new R.Quaternion;return te(Q,Z).multiply(q(Q,E))}}};a.default=_}(Fw)),Fw}var mS;function FC(){return mS||(mS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Qh()),M=u(Ir()),v=u(kr()),y=u(Wi()),p=u(dn()),g=u(pn()),C=u(ln()),D=u(Kh()),B=u(O0()),V=H(Dr()),P=u(AI()),L=Uf(),E=u(YM()),b=nd(),_=u(ya()),x=u(ps()),T=u(tb()),N=u(Zi());function U(we){if(typeof WeakMap!="function")return null;var je=new WeakMap,lt=new WeakMap;return(U=function(bt){return bt?lt:je})(we)}function H(we,je){if(!je&&we&&we.__esModule)return we;if(we===null||h(we)!=="object"&&typeof we!="function")return{default:we};var lt=U(je);if(lt&&lt.has(we))return lt.get(we);var ot={},bt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ie in we)if(Ie!=="default"&&Object.prototype.hasOwnProperty.call(we,Ie)){var re=bt?Object.getOwnPropertyDescriptor(we,Ie):null;re&&(re.get||re.set)?Object.defineProperty(ot,Ie,re):ot[Ie]=we[Ie]}return ot.default=we,lt&&lt.set(we,ot),ot}function q(we,je){var lt=typeof Symbol<"u"&&we[Symbol.iterator]||we["@@iterator"];if(!lt){if(Array.isArray(we)||(lt=te(we))||je&&we&&typeof we.length=="number"){lt&&(we=lt);var ot=0,bt=function(){};return{s:bt,n:function(){return ot>=we.length?{done:!0}:{done:!1,value:we[ot++]}},e:function(Re){throw Re},f:bt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ie=!0,re=!1,oe;return{s:function(){lt=lt.call(we)},n:function(){var Re=lt.next();return Ie=Re.done,Re},e:function(Re){re=!0,oe=Re},f:function(){try{!Ie&&lt.return!=null&&lt.return()}finally{if(re)throw oe}}}}function te(we,je){if(!!we){if(typeof we=="string")return Q(we,je);var lt=Object.prototype.toString.call(we).slice(8,-1);if(lt==="Object"&&we.constructor&&(lt=we.constructor.name),lt==="Map"||lt==="Set")return Array.from(we);if(lt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(lt))return Q(we,je)}}function Q(we,je){(je==null||je>we.length)&&(je=we.length);for(var lt=0,ot=new Array(je);lt<je;lt++)ot[lt]=we[lt];return ot}function Z(we){var je=ae();return function(){var lt=(0,C.default)(we),ot;if(je){var bt=(0,C.default)(this).constructor;ot=Reflect.construct(lt,arguments,bt)}else ot=lt.apply(this,arguments);return(0,g.default)(this,ot)}}function ae(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function F(we,je,lt){W(we,je),je.set(we,lt)}function W(we,je){if(je.has(we))throw new TypeError("Cannot initialize the same private elements twice on an object")}var O=new N.default("EPSG:4326",0,0,0),X=new V.Vector2,G=new V.Vector2,j=new _.default("EPSG:4326",0,0,0,0),K=new V.Color,ce=Math.pow(2,8)-1,se=Math.pow(2,16)-1,ue=Math.pow(2,32)-1,Y="EPSG:4326",pe=new WeakMap,Ee=new WeakMap,Fe=new WeakMap,$e=new WeakMap,pt=function(we){(0,p.default)(lt,we);var je=Z(lt);function lt(ot,bt){var Ie,re;return(0,M.default)(this,lt),re=je.call(this),F((0,y.default)(re),pe,{writable:!0,value:void 0}),F((0,y.default)(re),Ee,{writable:!0,value:void 0}),F((0,y.default)(re),Fe,{writable:!0,value:new V.Group}),F((0,y.default)(re),$e,{writable:!0,value:new V.Group}),re.meshes=(Ie=new V.Group).add.apply(Ie,(0,R.default)(ot)),(0,B.default)((0,y.default)(re),Fe,new V.Group().add(re.meshes)),(0,D.default)((0,y.default)(re),Fe).quaternion.copy(bt.quaternion),(0,D.default)((0,y.default)(re),Fe).position.copy(bt.position),(0,D.default)((0,y.default)(re),Fe).scale.copy(bt.scale),(0,D.default)((0,y.default)(re),Fe).updateMatrix(),(0,B.default)((0,y.default)(re),Ee,bt.crs),(0,B.default)((0,y.default)(re),pe,(0,D.default)((0,y.default)(re),Ee)),re.extent=bt.extent,re.add((0,D.default)((0,y.default)(re),$e).add((0,D.default)((0,y.default)(re),Fe))),re}return(0,v.default)(lt,[{key:"as",value:function(bt){if((0,D.default)(this,pe)!==bt)if((0,B.default)(this,pe,bt),bt==(0,D.default)(this,Ee))this.place.position.set(0,0,0),this.position.set(0,0,0),this.scale.set(1,1,1),this.quaternion.identity();else{O.crs=x.default.formatToEPSG((0,D.default)(this,Ee)),j.copy(this.extent).applyMatrix4((0,D.default)(this,Fe).matrix),j.as(O.crs,j),j.spatialEuclideanDimensions(X),j.planarDimensions(G),G.x&&G.y&&this.scale.copy(X).divide(G).setZ(1),(0,D.default)(this,$e).position.copy((0,D.default)(this,Fe).position).negate(),O.setFromVector3((0,D.default)(this,Fe).position);var Ie=(0,D.default)(this,Ee)=="EPSG:3857"?Y:(0,D.default)(this,Ee),re=T.default.quaternionFromCRSToCRS(Ie,bt);re(O.as(Y),this.quaternion),O.as(bt,O).toVector3(this.position)}return this}}]),lt}(V.Group);function Ue(we){return we?we.type=="Color"?we:K.set(we):K.set(Math.random()*16777215)}function Je(we,je,lt){var ot=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;ot*=3;for(var bt=ot+je*3,Ie=ot;Ie<bt;Ie+=3)we[Ie]=lt.r*255,we[Ie+1]=lt.g*255,we[Ie+2]=lt.b*255}function et(we,je,lt,ot){for(var bt=lt;bt<ot;bt++)je[bt]=we}function ze(we,je){return je<=ce?new Uint8Array(we):je<=se?new Uint16Array(we):new Uint32Array(we)}function Xe(we,je,lt,ot){var bt=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,Ie=arguments.length>5&&arguments[5]!==void 0?arguments[5]:we.length/3,re=arguments.length>6&&arguments[6]!==void 0?arguments[6]:bt;re*=3,Ie*=3,bt*=3;var oe=re+Ie;if(je)for(var _e=re,Re=bt;_e<oe;_e+=3,Re+=3)lt[Re]=we[_e]+je[_e]*ot,lt[Re+1]=we[_e+1]+je[_e+1]*ot,lt[Re+2]=we[_e+2]+je[_e+2]*ot;else for(var ke=re,Be=bt;ke<oe;ke+=3,Be+=3)lt[Be]=we[ke],lt[Be+1]=we[ke+1],lt[Be+2]=we[ke+2]+ot}function tt(we,je,lt,ot,bt){var Ie=we.length;we.length+=(ot-1)*6;for(var re=lt,oe=Ie;re<lt+ot-1;++re,++oe)bt?(we[oe]=re,we[++oe]=re+je,we[++oe]=re+1,we[++oe]=re+1,we[++oe]=re+je,we[++oe]=re+je+1):(we[oe]=re+je,we[++oe]=re,we[++oe]=re+je+1,we[++oe]=re+je+1,we[++oe]=re,we[++oe]=re+1)}function ye(we,je){var lt=we.vertices,ot=we.normals,bt=new Uint8Array(lt.length),Ie=je.batchId?new Uint32Array(lt.length/3):void 0,re=0,oe,_e=je.GlobalZTrans-we.altitude.min;_e!==0?(oe=new Float32Array(lt.length),Xe(lt,ot,oe,_e)):oe=new Float32Array(lt);var Re={point:!0},ke=q(we.geometries),Be;try{var at=function(){var _t=Be.value,St={globals:Re,properties:function(){return _t.properties}},Ct=we.style.drawingStylefromContext(St),vt=_t.indices[0].offset,ct=_t.indices[0].count;if(Je(bt,ct,Ue(Ct.point.color),vt),Ie){var Dt=je.batchId(_t.properties,re);et(Dt,Ie,vt,vt+ct),re++}};for(ke.s();!(Be=ke.n()).done;)at()}catch(ht){ke.e(ht)}finally{ke.f()}var wt=new V.BufferGeometry;return wt.setAttribute("position",new V.BufferAttribute(oe,3)),wt.setAttribute("color",new V.BufferAttribute(bt,3,!0)),Ie&&wt.setAttribute("batchId",new V.BufferAttribute(Ie,1)),je.pointMaterial.size=we.style.point.radius,new V.Points(wt,je.pointMaterial)}function Ze(we,je){var lt=we.vertices,ot=we.normals,bt=new Uint8Array(lt.length),Ie=lt.length/3,re=je.batchId?new Uint32Array(Ie):void 0,oe=0,_e,Re=je.GlobalZTrans-we.altitude.min;Re!=0?(_e=new Float32Array(lt.length),Xe(lt,ot,_e,Re)):_e=new Float32Array(lt);var ke=new V.BufferGeometry;ke.setAttribute("position",new V.BufferAttribute(_e,3));var Be;je.lineMaterial.linewidth=we.style.stroke.width;var at={stroke:!0};if(we.geometries.length>1){var wt=(Ie-we.geometries.length)*2,ht=ze(wt,Ie),_t=0,St=q(we.geometries),Ct;try{var vt=function(){var zr=Ct.value,Ut={globals:at,properties:function(){return zr.properties}},on=we.style.drawingStylefromContext(Ut),tn=zr.indices[0].offset;if(tn>65535)return console.warn("Feature to Line: integer overflow, too many points in lines"),"break";var Ln=zr.indices[0].count,_i=tn+Ln;Je(bt,Ln,Ue(on.stroke.color),tn);for(var xn=tn;xn<_i-1&&xn<65535;xn++)ht[_t++]=xn,ht[_t++]=xn+1;if(re){var ri=je.batchId(zr.properties,oe);et(ri,re,tn,_i),oe++}};for(St.s();!(Ct=St.n()).done;){var ct=vt();if(ct==="break")break}}catch(dr){St.e(dr)}finally{St.f()}ke.setAttribute("color",new V.BufferAttribute(bt,3,!0)),re&&ke.setAttribute("batchId",new V.BufferAttribute(re,1)),ke.setIndex(new V.BufferAttribute(ht,1)),Be=new V.LineSegments(ke,je.lineMaterial)}else{var Dt={globals:at,properties:function(){return we.geometries[0].properties}},fr=we.style.drawingStylefromContext(Dt);if(Je(bt,Ie,Ue(fr.stroke.color)),ke.setAttribute("color",new V.BufferAttribute(bt,3,!0)),re){var er=je.batchId(we.geometries[0].properties,oe);et(er,re,0,Ie),ke.setAttribute("batchId",new V.BufferAttribute(re,1))}Be=new V.Line(ke,je.lineMaterial)}return Be}function Ge(we,je){var lt=we.vertices,ot=we.normals,bt,Ie=je.GlobalZTrans-we.altitude.min;Ie!=0?(bt=new Float32Array(lt.length),Xe(lt,ot,bt,Ie)):bt=new Float32Array(lt);var re=new Uint8Array(lt.length),oe=[],_e=je.batchId?new Uint32Array(bt.length/3):void 0,Re={fill:!0},ke=0,Be=q(we.geometries),at;try{var wt=function(){var Ct=at.value,vt=Ct.indices[0].offset;if(vt>ue)return console.warn("Feature to Polygon: integer overflow, too many points in polygons"),"break";var ct={globals:Re,properties:function(){return Ct.properties}},Dt=we.style.drawingStylefromContext(ct),fr=Ct.indices.slice(-1)[0],er=fr.offset+fr.count,dr=er-vt;Je(re,dr,Ue(Dt.fill.color),vt);var zr=bt.slice(vt*3,er*3),Ut=Ct.indices.map(function(xn){return xn.offset-vt}).slice(1),on=(0,P.default)(zr,Ut,3),tn=oe.length;oe.length+=on.length;for(var Ln=0;Ln<on.length;Ln++)oe[tn+Ln]=on[Ln]+vt;if(_e){var _i=je.batchId(Ct.properties,ke);et(_i,_e,vt,er),ke++}};for(Be.s();!(at=Be.n()).done;){var ht=wt();if(ht==="break")break}}catch(St){Be.e(St)}finally{Be.f()}var _t=new V.BufferGeometry;return _t.setAttribute("position",new V.BufferAttribute(bt,3)),_t.setAttribute("color",new V.BufferAttribute(re,3,!0)),_e&&_t.setAttribute("batchId",new V.BufferAttribute(_e,1)),_t.setIndex(new V.BufferAttribute(ze(oe,bt.length/3),1)),new V.Mesh(_t,je.polygonMaterial)}function Ae(we,je,lt){je*=3;for(var ot=je+lt*3,bt=0,Ie=ot-3,re=je;re<ot;Ie=re,re+=3)bt+=we[Ie]*we[re+1]-we[re]*we[Ie+1];return bt*.5}var Se=new V.Color;function Te(we,je){var lt=we.vertices,ot=we.normals,bt=new Float32Array(lt.length*2),Ie=new Uint8Array(lt.length*2),re=[],oe=lt.length/3,_e=je.batchId?new Uint32Array(bt.length/3):void 0,Re=0,ke=je.GlobalZTrans-we.altitude.min,Be={fill:!0},at=q(we.geometries),wt;try{var ht=function(){var Ct,vt=wt.value,ct={globals:Be,properties:function(){return vt.properties}},Dt=we.style.drawingStylefromContext(ct),fr=Ue(Dt.fill.color);Se.copy(fr),Se.multiplyScalar(.5);var er=vt.indices[0].offset,dr=vt.indices.slice(-1)[0],zr=dr.offset+dr.count,Ut=zr-er,on=(Ct=vt.indices[0].ccw)!==null&&Ct!==void 0?Ct:Ae(lt,er,Ut)<0;Xe(lt,ot,bt,ke,er,Ut),Je(Ie,Ut,Se,er);var tn=er+oe,Ln=zr+oe;Xe(lt,ot,bt,ke+Dt.fill.extrusion_height,tn,Ut,er),Je(Ie,Ut,fr,tn);var _i=bt.slice(tn*3,Ln*3),xn=vt.indices.map(function(to){return to.offset-er}).slice(1),ri=(0,P.default)(_i,xn,3),_n=re.length;re.length+=ri.length;for(var ta=0;ta<ri.length;ta++)re[_n+ta]=ri[ta]+tn;tt(re,oe,vt.indices[0].offset,vt.indices[0].count,on);for(var ji=1;ji<vt.indices.length;ji++){var ss,Ii=vt.indices[ji];tt(re,oe,Ii.offset,Ii.count,!((ss=Ii.ccw)!==null&&ss!==void 0?ss:on))}if(_e){var Ha=je.batchId(vt.properties,Re);et(Ha,_e,er,zr),et(Ha,_e,tn,Ln),Re++}};for(at.s();!(wt=at.n()).done;)ht()}catch(St){at.e(St)}finally{at.f()}var _t=new V.BufferGeometry;return _t.setAttribute("position",new V.BufferAttribute(bt,3)),_t.setAttribute("color",new V.BufferAttribute(Ie,3,!0)),_e&&_t.setAttribute("batchId",new V.BufferAttribute(_e,1)),_t.setIndex(new V.BufferAttribute(ze(re,bt.length/3),1)),new V.Mesh(_t,je.polygonMaterial)}function me(we,je){if(!!we.vertices){var lt;switch(we.type){case L.FEATURE_TYPES.POINT:lt=ye(we,je);break;case L.FEATURE_TYPES.LINE:lt=Ze(we,je);break;case L.FEATURE_TYPES.POLYGON:we.style.fill.extrusion_height?lt=Te(we,je):lt=Ge(we,je);break}return lt.material.vertexColors=!0,lt.material.color=new V.Color(16777215),lt.feature=we,lt.position.z=we.altitude.min-je.GlobalZTrans,je.layer&&(lt.layer=je.layer,lt.layers.set(je.layer.threejsLayer)),lt}}var be={convert:function(){var je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,b.deprecatedFeature2MeshOptions)(je),function(ot){if(!!ot){je.pointMaterial||(je.pointMaterial=(0,E.default)(new V.PointsMaterial,this),je.lineMaterial=(0,E.default)(new V.LineBasicMaterial,this),je.polygonMaterial=(0,E.default)(new V.MeshBasicMaterial,this),je.layer=this);var bt=ot.features;if(!(!bt||bt.length==0)){je.GlobalZTrans=ot.center.z;var Ie=bt.map(function(oe){return me(oe,je)}),re=new pt(Ie,ot);return re}}}}};a.default=be}(Ow)),Ow}var Iw={},vS;function wI(){return vS||(vS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=p(Dr());function y(ce){if(typeof WeakMap!="function")return null;var se=new WeakMap,ue=new WeakMap;return(y=function(pe){return pe?ue:se})(ce)}function p(ce,se){if(!se&&ce&&ce.__esModule)return ce;if(ce===null||h(ce)!=="object"&&typeof ce!="function")return{default:ce};var ue=y(se);if(ue&&ue.has(ce))return ue.get(ce);var Y={},pe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ee in ce)if(Ee!=="default"&&Object.prototype.hasOwnProperty.call(ce,Ee)){var Fe=pe?Object.getOwnPropertyDescriptor(ce,Ee):null;Fe&&(Fe.get||Fe.set)?Object.defineProperty(Y,Ee,Fe):Y[Ee]=ce[Ee]}return Y.default=ce,ue&&ue.set(ce,Y),Y}var g=`struct Layer {
    int textureOffset;
    int crs;
    int effect_type;
    float effect_parameter;
    float opacity;
    bool transparent;
};

#include <itowns/custom_header_colorLayer>

uniform sampler2D   colorTextures[NUM_FS_TEXTURES];
uniform vec4        colorOffsetScales[NUM_FS_TEXTURES];
uniform Layer       colorLayers[NUM_FS_TEXTURES];
uniform int         colorTextureCount;

vec3 uvs[NUM_CRS];

float getBorderDistance(vec2 uv) {
    vec2 p2 = min(uv, 1. -uv);
    return min(p2.x, p2.y);
}

float tolerance = 0.99;

vec4 applyWhiteToInvisibleEffect(vec4 color, float intensity) {
    float a = dot(color.rgb, vec3(0.333333333));
    if (a >= tolerance) {
        color.a *= 1.0 - pow(abs(a), intensity);
    }
    return color;
}

vec4 applyLightColorToInvisibleEffect(vec4 color, float intensity) {
    float a = max(0.05,1. - length(color.xyz - 1.));
    color.a *= 1.0 - pow(abs(a), intensity);
    color.rgb *= color.rgb * color.rgb;
    return color;
}

#if defined(DEBUG)
uniform bool showOutline;
uniform vec3 outlineColors[NUM_CRS];
uniform float outlineWidth;

vec4 getOutlineColor(vec3 outlineColor, vec2 uv) {
    float alpha = 1. - clamp(getBorderDistance(uv) / outlineWidth, 0., 1.);
    return vec4(outlineColor, alpha);
}
#endif

uniform float minBorderDistance;
vec4 getLayerColor(int textureOffset, sampler2D tex, vec4 offsetScale, Layer layer) {
    if ( textureOffset >= colorTextureCount ) return vec4(0);

    vec3 uv;
    // #pragma unroll_loop
    for ( int i = 0; i < NUM_CRS; i ++ ) {
        if ( i == layer.crs ) uv = uvs[ i ];
    }

    float borderDistance = getBorderDistance(uv.xy);
    if (textureOffset != layer.textureOffset + int(uv.z) || borderDistance < minBorderDistance ) return vec4(0);
    vec4 color = texture2D(tex, pitUV(uv.xy, offsetScale));
    if (layer.effect_type == 3) {
        #include <itowns/custom_body_colorLayer>
    } else {
        if (layer.transparent && color.a != 0.0) {
            color.rgb /= color.a;
        }

        if (layer.effect_type == 1) {
            color = applyLightColorToInvisibleEffect(color, layer.effect_parameter);
        } else if (layer.effect_type == 2) {
            color = applyWhiteToInvisibleEffect(color, layer.effect_parameter);
        }
    }
    color.a *= layer.opacity;
    return color;
}
`,C=`#if NUM_VS_TEXTURES > 0
    struct Layer {
        float scale;
        float bias;
        int mode;
        float zmin;
        float zmax;
    };

    uniform Layer       elevationLayers[NUM_VS_TEXTURES];
    uniform sampler2D   elevationTextures[NUM_VS_TEXTURES];
    uniform vec4        elevationOffsetScales[NUM_VS_TEXTURES];
    uniform int         elevationTextureCount;
    uniform float       geoidHeight;

    highp float decode32(highp vec4 rgba) {
        highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
        highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
        highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
        highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
        return Result;
    }

    float getElevationMode(vec2 uv, sampler2D tex, int mode) {
        if (mode == ELEVATION_RGBA)
            return decode32(texture2D( tex, uv ).abgr * 255.0);
        if (mode == ELEVATION_DATA || mode == ELEVATION_COLOR)
        #if defined(WEBGL2)
            return texture2D( tex, uv ).r;
        #else
            return texture2D( tex, uv ).w;
        #endif
        return 0.;
    }

    float getElevation(vec2 uv, sampler2D tex, vec4 offsetScale, Layer layer) {
        uv = uv * offsetScale.zw + offsetScale.xy;
        float d = getElevationMode(uv, tex, layer.mode);
        if (d < layer.zmin || d > layer.zmax) d = 0.;
        return d * layer.scale + layer.bias;
    }
#endif
`,D=`#if NUM_VS_TEXTURES > 0
    if(elevationTextureCount > 0) {
        float elevation = getElevation(uv, elevationTextures[0], elevationOffsetScales[0], elevationLayers[0]);
        transformed += elevation * normal;
    }
#endif
`,B=`transformed += geoidHeight * normal;
`,V=`#if defined(USE_FOG)
    float fogFactor = 1. - min( exp(-vFogDepth / fogDistance), 1.);
    gl_FragColor.rgb = mix(gl_FragColor.rgb, fogColor, fogFactor);
#endif
`,P=`#if defined(USE_FOG)
uniform vec3  fogColor;
uniform float fogDistance;
varying float vFogDepth;
#endif
`,L=`if (lightingEnabled) {
    float light = min(2. * dot(vNormal, lightPosition), 1.);
    gl_FragColor.rgb *= light;
}
`,E=`uniform bool lightingEnabled;
uniform vec3 lightPosition;
varying vec3 vNormal;
`,b=`#if MODE == MODE_ID || MODE == MODE_DEPTH
#include <packing>
#endif

#if MODE == MODE_ID
uniform int objectId;
#endif
`,_=`#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)
gl_FragColor = packDepthToRGBA(gl_FragDepthEXT);
#else
float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
gl_FragColor = packDepthToRGBA(fragCoordZ);
#endif`,x=`// 16777216.0 == 256.0 * 256.0 * 256.0
gl_FragColor = packDepthToRGBA(float(objectId) / 16777216.0);
`,T=`gl_FragColor.rgb = mix(gl_FragColor.rgb, overlayColor, overlayAlpha);
`,N=`uniform vec3  overlayColor;
uniform float overlayAlpha;
`,U=`vec2 pitUV(vec2 uv, vec4 pit)
{
    return uv * pit.zw + vec2(pit.x, 1.0 - pit.w - pit.y);
}

`,H=`precision highp float;
precision highp int;
`,q=`attribute vec3 position;
uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
`,te=`for(int i = 0; i < ORIENTED_IMAGES_COUNT; ++i)
    projectiveTextureCoords[i] = projectiveTextureMatrix[i] * mvPosition;
`,Q=`uniform mat4 projectiveTextureMatrix[ORIENTED_IMAGES_COUNT];
varying vec4 projectiveTextureCoords[ORIENTED_IMAGES_COUNT];
`,Z=`uniform sampler2D projectiveTexture[ORIENTED_IMAGES_COUNT];
uniform sampler2D mask[ORIENTED_IMAGES_COUNT];
varying vec4      projectiveTextureCoords[ORIENTED_IMAGES_COUNT];
uniform float     projectiveTextureAlphaBorder;
uniform float     opacity;
uniform bool      boostLight;

struct Distortion {
    vec2 size;
#if USE_DISTORTION
    vec2 pps;
    vec4 polynom;
    vec3 l1l2;
#endif
};

uniform Distortion projectiveTextureDistortion[ORIENTED_IMAGES_COUNT];

float getAlphaBorder(vec2 p)
{
    vec2 d = clamp(projectiveTextureAlphaBorder * min(p, 1. - p), 0., 1.);
    return min(d.x, d.y);
}

#if USE_DISTORTION
void distort(inout vec2 p, vec4 polynom, vec2 pps)
{
    vec2 v = p - pps;
    float v2 = dot(v, v);
    if (v2 > polynom.w) {
        p = vec2(-1.);
    }
    else {
        p += (v2 * (polynom.x + v2 * (polynom.y + v2 * polynom.z) ) ) * v;
    }
}

void distort(inout vec2 p, vec4 polynom, vec3 l1l2, vec2 pps)
{
    if ((l1l2.x == 0.) && (l1l2.y == 0.)) {
        distort(p, polynom, pps);
    } else {
        vec2 AB = (p - pps) / l1l2.z;
        float R = length(AB);
        float lambda = atan(R) / R;
        vec2 ab = lambda * AB;
        float rho2 = dot(ab, ab);
        float r357 = 1. + rho2* (polynom.x + rho2* (polynom.y + rho2 * polynom.z));
        p = pps + l1l2.z * (r357 * ab + vec2(dot(l1l2.xy, ab), l1l2.y * ab.x));
    }
}
#endif

vec4 mixBaseColor(vec4 aColor, vec4 baseColor) {
    #ifdef USE_BASE_MATERIAL
        baseColor.rgb = aColor.a == 1.0 ? aColor.rgb : mix(baseColor, aColor, aColor.a).rgb;
        baseColor.a = min(1.0, aColor.a + baseColor.a);
    #else
        baseColor.rgb += aColor.rgb * aColor.a;
        baseColor.a += aColor.a;
    #endif
    return baseColor;
}

vec4 projectiveTextureColor(vec4 coords, Distortion distortion, sampler2D tex, sampler2D mask, vec4 baseColor) {
    vec3 p = coords.xyz / coords.w;
    if(p.z * p.z < 1.) {
#if USE_DISTORTION
        p.xy *= distortion.size;
        distort(p.xy, distortion.polynom, distortion.l1l2, distortion.pps);
        p.xy /= distortion.size;
#endif

        float d = getAlphaBorder(p.xy) * texture2D(mask, p.xy).r;

        if(d > 0.) {

#if DEBUG_ALPHA_BORDER
        vec3 r = texture2D(tex, p.xy).rgb;
        return mixBaseColor(vec4( r.r * d, r.g, r.b, 1.0), baseColor);
#else
        vec4 color = texture2D(tex, p.xy);
        color.a *= d;
        if (boostLight) {
            return mixBaseColor(vec4(sqrt(color.rgb), color.a), baseColor);
        } else {
            return mixBaseColor(color, baseColor);
        }
#endif

        }
    }
    return mixBaseColor(vec4(0.), baseColor);
}
`,ae=`// Copy from GLSL 3.0 conversion for built-in materials and ShaderMaterial in THREE.WebGLProgram
// https://github.com/mrdoob/three.js/blob/696d7836d1fc56c4702a475e6991c4adef7357f4/src/renderers/webgl/WebGLProgram.js#L682
#if defined(WEBGL2)
#define attribute in
#define varying out
#define texture2D texture
#endif
`,F=`// Copy from GLSL 3.0 conversion for built-in materials and ShaderMaterial in THREE.WebGLProgram
// https://github.com/mrdoob/three.js/blob/696d7836d1fc56c4702a475e6991c4adef7357f4/src/renderers/webgl/WebGLProgram.js#L682
#if defined(WEBGL2)
#define varying in
out highp vec4 pc_fragColor;
#define gl_FragColor pc_fragColor
#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad
#endif
`,W="// no custom header",O="// no custom body",X={color_layers_pars_fragment:g,custom_body_colorLayer:O,custom_header_colorLayer:W,elevation_pars_vertex:C,elevation_vertex:D,geoid_vertex:B,fog_fragment:V,fog_pars_fragment:P,lighting_fragment:L,lighting_pars_fragment:E,mode_depth_fragment:_,mode_id_fragment:x,mode_pars_fragment:b,overlay_fragment:T,overlay_pars_fragment:N,pitUV:U,precision_qualifier:H,projective_texturing_vertex:te,projective_texturing_pars_vertex:Q,projective_texturing_pars_fragment:Z,project_pars_vertex:q,WebGL2_pars_vertex:ae,WebGL2_pars_fragment:F},G=function(){function ce(se,ue){(0,R.default)(this,ce),this.path=ue,this.target=se,this.install()}return(0,M.default)(ce,[{key:"customHeaderColorLayer",value:function(ue){X.custom_header_colorLayer=ue,this.target["".concat(this.path,"custom_header_colorLayer")]=ue}},{key:"customBodyColorLayer",value:function(ue){X.custom_body_colorLayer=ue,this.target["".concat(this.path,"custom_body_colorLayer")]=ue}},{key:"install",value:function(){var ue=this,Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.target,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:X,Ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.path;return Object.keys(pe).forEach(function(Fe){Object.defineProperty(ue,Fe,{get:function(){return pe[Fe]}}),Y[Ee+Fe]=pe[Fe]}),Y}}]),ce}(),j=new G(v.ShaderChunk,"itowns/"),K=j;a.default=K}(Iw)),Iw}var kw={},Dw={},Nw={},Bw={},gS;function MI(){return gS||(gS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=g(Dr()),M=Uf(),v=u(ya()),y=u(Zi());function p(O){if(typeof WeakMap!="function")return null;var X=new WeakMap,G=new WeakMap;return(p=function(K){return K?G:X})(O)}function g(O,X){if(!X&&O&&O.__esModule)return O;if(O===null||h(O)!=="object"&&typeof O!="function")return{default:O};var G=p(X);if(G&&G.has(O))return G.get(O);var j={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in O)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(O,ce)){var se=K?Object.getOwnPropertyDescriptor(O,ce):null;se&&(se.get||se.set)?Object.defineProperty(j,ce,se):j[ce]=O[ce]}return j.default=O,G&&G.set(O,j),j}function C(O,X){var G=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(!G){if(Array.isArray(O)||(G=D(O))||X&&O&&typeof O.length=="number"){G&&(O=G);var j=0,K=function(){};return{s:K,n:function(){return j>=O.length?{done:!0}:{done:!1,value:O[j++]}},e:function(pe){throw pe},f:K}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ce=!0,se=!1,ue;return{s:function(){G=G.call(O)},n:function(){var pe=G.next();return ce=pe.done,pe},e:function(pe){se=!0,ue=pe},f:function(){try{!ce&&G.return!=null&&G.return()}finally{if(se)throw ue}}}}function D(O,X){if(!!O){if(typeof O=="string")return B(O,X);var G=Object.prototype.toString.call(O).slice(8,-1);if(G==="Object"&&O.constructor&&(G=O.constructor.name),G==="Map"||G==="Set")return Array.from(O);if(G==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(G))return B(O,X)}}function B(O,X){(X==null||X>O.length)&&(X=O.length);for(var G=0,j=new Array(X);G<X;G++)j[G]=O[G];return j}var V=document.createElementNS("http://www.w3.org/2000/svg","svg"),P=V.createSVGMatrix();function L(O,X){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[{offset:0,count:1}],j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},K=arguments.length>4?arguments[4]:void 0,ce=arguments.length>5?arguments[5]:void 0,se=arguments.length>6?arguments[6]:void 0,ue=arguments.length>7?arguments[7]:void 0;if(X.length!==0)if(j.length){var Y=C(j),pe;try{for(Y.s();!(pe=Y.n()).done;){var Ee=pe.value;E(O,X,G,Ee,K,ce,se,ue)}}catch(Fe){Y.e(Fe)}finally{Y.f()}}else E(O,X,G,j,K,ce,se,ue)}function E(O,X,G,j,K,ce,se,ue){O.beginPath();var Y=C(G),pe;try{for(Y.s();!(pe=Y.n()).done;){var Ee=pe.value;if(Ee.extent&&Ee.extent.intersectsExtent(ce)){var Fe=Ee.offset*K,$e=Fe+Ee.count*K;O.moveTo(X[Fe],X[Fe+1]);for(var pt=Fe+K;pt<$e;pt+=K)O.lineTo(X[pt],X[pt+1])}}}catch(Ue){Y.e(Ue)}finally{Y.f()}j.stroke&&(_(j,O,se),O.stroke()),ue&&j.fill&&(b(j,O,se),O.fill())}function b(O,X,G){O.fill.pattern&&X.fillStyle.src!==O.fill.pattern.src?(X.fillStyle=X.createPattern(O.fill.pattern,"repeat"),X.fillStyle.setTransform?X.fillStyle.setTransform(P.scale(G)):console.warn("Raster pattern isn't completely supported on Ie and edge")):X.fillStyle!==O.fill.color&&(X.fillStyle=O.fill.color),O.fill.opacity!==X.globalAlpha&&(X.globalAlpha=O.fill.opacity)}function _(O,X,G){X.strokeStyle!==O.stroke.color&&(X.strokeStyle=O.stroke.color);var j=(O.stroke.width||2)*G;X.lineWidth!==j&&(X.lineWidth=j);var K=O.stroke.opacity==null?1:O.stroke.opacity;K!==X.globalAlpha&&typeof K=="number"&&(X.globalAlpha=K),X.lineCap!==O.stroke.lineCap&&(X.lineCap=O.stroke.lineCap),X.setLineDash(O.stroke.dasharray.map(function(ce){return ce*G*2}))}function x(O,X,G){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},K=arguments.length>4?arguments[4]:void 0;O.beginPath();var ce=j.point.opacity==null?1:j.point.opacity;ce!==O.globalAlpha&&(O.globalAlpha=ce),O.arc(X,G,(j.point.radius||3)*K,0,2*Math.PI,!1),j.point.color&&(O.fillStyle=j.point.color,O.fill()),j.point.line&&(O.lineWidth=(j.point.width||1)*K,O.strokeStyle=j.point.line,O.stroke())}var T=new y.default("EPSG:4326",0,0,0);function N(O,X,G,j,K){var ce=G.planarDimensions(),se=ce.x/O.canvas.width,ue={zoom:G.zoom},Y=C(X.geometries),pe;try{var Ee=function(){var $e=pe.value;if($e.extent.intersectsExtent(G)){var pt={globals:ue,properties:function(){return $e.properties}},Ue=($e.properties.style||j).drawingStylefromContext(pt);if(Ue)if(X.type===M.FEATURE_TYPES.POINT){var Je=(Math.round(Ue.point.radius*K)||3*K)*se,et=C($e.indices),ze;try{for(et.s();!(ze=et.n()).done;)for(var Xe=ze.value,tt=Xe.offset*X.size,ye=tt+Xe.count*X.size,Ze=tt;Ze<ye;Ze+=X.size)T.setFromArray(X.vertices,Ze),G.isPointInside(T,Je)&&x(O,X.vertices[Ze],X.vertices[Ze+1],Ue,K)}catch(Ge){et.e(Ge)}finally{et.f()}}else L(O,X.vertices,$e.indices,Ue,X.size,G,K,X.type==M.FEATURE_TYPES.POLYGON)}};for(Y.s();!(pe=Y.n()).done;)Ee()}catch(Fe){Y.e(Fe)}finally{Y.f()}}var U=new R.Vector3,H=new R.Vector3(0,0,1),q=new R.Vector3,te=new R.Quaternion,Q=new R.Matrix4,Z=new R.Matrix4,ae=new R.Vector3,F=new v.default("EPSG:4326",0,0,0,0),W={createTextureFromFeature:function(X,G,j,K,ce){var se;if(X){G.planarDimensions(H);var ue=document.createElement("canvas");T.crs=G.crs,ue.width=j,ue.height=j;var Y=ue.getContext("2d");ce&&(Y.fillStyle=ce.getStyle(),Y.fillRect(0,0,j,j)),Y.globalCompositeOperation=K.globalCompositeOperation||"source-over",Y.imageSmoothingEnabled=!1,Y.lineJoin="round",G.as(X.crs,F),F.applyMatrix4(X.matrixWorldInverse),X.isInverted?(ae.set(G.west,G.north,0),q.set(Y.canvas.width,-Y.canvas.height,1).divide(H)):(ae.set(G.west,G.south,0),q.set(Y.canvas.width,Y.canvas.height,1).divide(H)),Q.compose(ae.multiply(q).negate(),te,q),Z.multiplyMatrices(Q,X.matrixWorld),Z.decompose(U,te,q),Y.setTransform(q.x,0,0,q.y,U.x,U.y);var pe=Math.abs(1/q.x),Ee=C(X.features),Fe;try{for(Ee.s();!(Fe=Ee.n()).done;){var $e=Fe.value;N(Y,$e,F,$e.style||K,pe)}}catch(Ue){Ee.e(Ue)}finally{Ee.f()}se=new R.CanvasTexture(ue),se.flipY=X.isInverted}else if(ce){var pt=new Uint8Array(3);pt[0]=ce.r*255,pt[1]=ce.g*255,pt[2]=ce.b*255,se=new R.DataTexture(pt,1,1,R.RGBFormat)}else se=new R.Texture;return se}};a.default=W}(Bw)),Bw}var yS;function bI(){return yS||(yS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=g(Dr()),M=u(MI()),v=u(ya()),y=u(ps());function p(P){if(typeof WeakMap!="function")return null;var L=new WeakMap,E=new WeakMap;return(p=function(_){return _?E:L})(P)}function g(P,L){if(!L&&P&&P.__esModule)return P;if(P===null||h(P)!=="object"&&typeof P!="function")return{default:P};var E=p(L);if(E&&E.has(P))return E.get(P);var b={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in P)if(x!=="default"&&Object.prototype.hasOwnProperty.call(P,x)){var T=_?Object.getOwnPropertyDescriptor(P,x):null;T&&(T.get||T.set)?Object.defineProperty(b,x,T):b[x]=P[x]}return b.default=P,E&&E.set(P,b),b}var C=new v.default("EPSG:4326",[0,0,0,0]),D=function(P,L){return P.generateMipmaps=!1,P.magFilter=L.magFilter||R.LinearFilter,P.minFilter=L.minFilter||R.LinearFilter,P};function B(P,L){return P.anisotropy=16,P.premultiplyAlpha=L.transparent,D(P,L)}var V={convert:function(L,E,b){var _;if(L.isFeatureCollection){var x=b.source.backgroundLayer,T=x&&x.paint?new R.Color(x.paint["background-color"]):void 0;E.as(y.default.formatToEPSG(b.crs),C),_=M.default.createTextureFromFeature(L,C,256,b.style,T),_.features=L,_.extent=E}else if(L.isTexture)_=L;else throw new Error("Data type is not supported to convert into texture");if(b.isColorLayer)return B(_,b);if(b.isElevationLayer)return _.flipY&&(_.flipY=!1),D(_,b)}};a.default=V}(Nw)),Nw}var _S;function IC(){return _S||(_S=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(id()),g=D0(),C=u(bI()),D=Bf();function B(x,T){var N=typeof Symbol<"u"&&x[Symbol.iterator]||x["@@iterator"];if(!N){if(Array.isArray(x)||(N=V(x))||T&&x&&typeof x.length=="number"){N&&(x=N);var U=0,H=function(){};return{s:H,n:function(){return U>=x.length?{done:!0}:{done:!1,value:x[U++]}},e:function(ae){throw ae},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var q=!0,te=!1,Q;return{s:function(){N=N.call(x)},n:function(){var ae=N.next();return q=ae.done,ae},e:function(ae){te=!0,Q=ae},f:function(){try{!q&&N.return!=null&&N.return()}finally{if(te)throw Q}}}}function V(x,T){if(!!x){if(typeof x=="string")return P(x,T);var N=Object.prototype.toString.call(x).slice(8,-1);if(N==="Object"&&x.constructor&&(N=x.constructor.name),N==="Map"||N==="Set")return Array.from(x);if(N==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return P(x,T)}}function P(x,T){(T==null||T>x.length)&&(T=x.length);for(var N=0,U=new Array(T);N<T;N++)U[N]=x[N];return U}function L(x){var T=E();return function(){var N=(0,y.default)(x),U;if(T){var H=(0,y.default)(this).constructor;U=Reflect.construct(N,arguments,H)}else U=N.apply(this,arguments);return(0,v.default)(this,U)}}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var b=function(x){(0,M.default)(N,x);var T=L(N);function N(U,H){var q;return(0,h.default)(this,N),H.cacheLifeTime=(q=H.cacheLifeTime)!==null&&q!==void 0?q:D.CACHE_POLICIES.TEXTURE,T.call(this,U,H)}return(0,R.default)(N,[{key:"convert",value:function(H,q){return C.default.convert(H,q,this)}},{key:"delete",value:function(){var H=B(this.parent.level0Nodes),q;try{for(H.s();!(q=H.n()).done;){var te=q.value;te.traverse((0,g.removeLayeredMaterialNodeLayer)(this.id))}}catch(Q){H.e(Q)}finally{H.f()}}}]),N}(p.default),_=b;a.default=_}(Dw)),Dw}var xS;function EI(){return xS||(xS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(IC()),g=D0(),C=HM(),D=u(I0()),B=nd();function V(b){var _=P();return function(){var x=(0,y.default)(b),T;if(_){var N=(0,y.default)(this).constructor;T=Reflect.construct(x,arguments,N)}else T=x.apply(this,arguments);return(0,v.default)(this,T)}}function P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var L=function(b){(0,M.default)(x,b);var _=V(x);function x(T){var N,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,h.default)(this,x),(0,B.deprecatedColorLayerOptions)(U),N=_.call(this,T,U),N.isColorLayer=!0,N.style=new D.default(U.style),N.defineLayerProperty("visible",!0),N.defineLayerProperty("opacity",1),N.defineLayerProperty("sequence",0),N.transparent=U.transparent||N.opacity<1,N.noTextureParentOutsideLimit=U.source?U.source.isFileSource:!1,N.buildExtent=!0,N.structure="2d",N}return(0,R.default)(x,[{key:"setupRasterNode",value:function(N){var U=new C.RasterColorTile(N.material,this);return N.material.addLayer(U),N.material.setSequence(this.parent.colorLayersOrder),U}},{key:"update",value:function(N,U,H,q){return(0,g.updateLayeredMaterialNodeImagery)(N,this,H,q)}}]),x}(p.default),E=L;a.default=E}(kw)),kw}var Uw={},AS;function TI(){return AS||(AS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(IC()),g=D0(),C=HM();function D(L){var E=B();return function(){var b=(0,y.default)(L),_;if(E){var x=(0,y.default)(this).constructor;_=Reflect.construct(b,arguments,x)}else _=b.apply(this,arguments);return(0,v.default)(this,_)}}function B(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var V=function(L){(0,M.default)(b,L);var E=D(b);function b(_){var x,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,h.default)(this,b),x=E.call(this,_,T),x.isElevationLayer=!0,x.defineLayerProperty("scale",x.scale||1),x}return(0,R.default)(b,[{key:"setupRasterNode",value:function(x){var T=this,N=new C.RasterElevationTile(x.material,this);x.material.addLayer(N),x.material.setSequenceElevation(this.id);var U=function(){return x.setBBoxZ({min:N.min,max:N.max,scale:T.scale})};return U(),N.addEventListener("updatedElevation",U),this.addEventListener("scale-property-changed",U),x.addEventListener("dispose",function(){T.removeEventListener("scale-property-changed",U)}),N}},{key:"update",value:function(x,T,N,U){return(0,g.updateLayeredMaterialNodeElevation)(x,this,N,U)}}]),b}(p.default),P=V;a.default=P}(Uw)),Uw}var zw={},wS;function SI(){return wS||(wS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(dn()),v=u(pn()),y=u(ln()),p=Dr(),g=u(ad()),C=u(CC()),D=u(FC());function B(E){var b=V();return function(){var _=(0,y.default)(E),x;if(b){var T=(0,y.default)(this).constructor;x=Reflect.construct(_,arguments,T)}else x=_.apply(this,arguments);return(0,v.default)(this,x)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P=function(E){(0,M.default)(_,E);var b=B(_);function _(x){var T,N,U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,h.default)(this,_),U.update=C.default.update,U.convert=D.default.convert({batchId:U.batchId}),N=b.call(this,x,U.object3d||new p.Group,U),N.isFeatureGeometryLayer=!0,N.accurate=(T=U.accurate)!==null&&T!==void 0?T:!0,N.buildExtent=!N.accurate,N}return(0,R.default)(_,[{key:"preUpdate",value:function(T,N){N.has(this.parent)&&this.object3d.clear()}}]),_}(g.default),L=P;a.default=L}(zw)),zw}var Gw={},MS;function rb(){return MS||(MS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=P(Dr()),C=u(ad()),D=P(LC()),B=u(u2());function V(ae){if(typeof WeakMap!="function")return null;var F=new WeakMap,W=new WeakMap;return(V=function(X){return X?W:F})(ae)}function P(ae,F){if(!F&&ae&&ae.__esModule)return ae;if(ae===null||h(ae)!=="object"&&typeof ae!="function")return{default:ae};var W=V(F);if(W&&W.has(ae))return W.get(ae);var O={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var G in ae)if(G!=="default"&&Object.prototype.hasOwnProperty.call(ae,G)){var j=X?Object.getOwnPropertyDescriptor(ae,G):null;j&&(j.get||j.set)?Object.defineProperty(O,G,j):O[G]=ae[G]}return O.default=ae,W&&W.set(ae,O),O}function L(ae){var F=E();return function(){var W=(0,p.default)(ae),O;if(F){var X=(0,p.default)(this).constructor;O=Reflect.construct(W,arguments,X)}else O=W.apply(this,arguments);return(0,y.default)(this,O)}}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function b(ae,F){var W=typeof Symbol<"u"&&ae[Symbol.iterator]||ae["@@iterator"];if(!W){if(Array.isArray(ae)||(W=_(ae))||F&&ae&&typeof ae.length=="number"){W&&(ae=W);var O=0,X=function(){};return{s:X,n:function(){return O>=ae.length?{done:!0}:{done:!1,value:ae[O++]}},e:function(se){throw se},f:X}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G=!0,j=!1,K;return{s:function(){W=W.call(ae)},n:function(){var se=W.next();return G=se.done,se},e:function(se){j=!0,K=se},f:function(){try{!G&&W.return!=null&&W.return()}finally{if(j)throw K}}}}function _(ae,F){if(!!ae){if(typeof ae=="string")return x(ae,F);var W=Object.prototype.toString.call(ae).slice(8,-1);if(W==="Object"&&ae.constructor&&(W=ae.constructor.name),W==="Map"||W==="Set")return Array.from(ae);if(W==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(W))return x(ae,F)}}function x(ae,F){(F==null||F>ae.length)&&(F=ae.length);for(var W=0,O=new Array(F);W<F;W++)O[W]=ae[W];return O}var T=new g.Vector3,N=new g.Mesh,U=new g.Box3;N.geometry.boundingBox=U;function H(ae,F,W,O,X){if(X<=0)return 1/0;var G=W/Math.pow(2,O.depth),j=ae.camera.preSSE*G/X;return Math.max(0,j-F)}function q(ae){ae.obj&&(ae.obj.visible=!1),ae.notVisibleSince||(ae.notVisibleSince=Date.now(),ae.sse=-1);var F=b(ae.children),W;try{for(F.s();!(W=F.n()).done;){var O=W.value;q(O)}}catch(X){F.e(X)}finally{F.f()}}function te(ae){ae.material.intensityRange&&ae.material.intensityRange.set(ae.minIntensityRange,ae.maxIntensityRange)}var Q=function(ae){(0,v.default)(W,ae);var F=L(W);function W(O){var X,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,R.default)(this,W),X=F.call(this,O,new g.Group,G),X.isPointCloudLayer=!0,X.protocol="pointcloud",X.group=G.group||new g.Group,X.object3d.add(X.group),X.bboxes=G.bboxes||new g.Group,X.bboxes.visible=!1,X.object3d.add(X.bboxes),X.group.updateMatrixWorld(),X.octreeDepthLimit=G.octreeDepthLimit||-1,X.pointBudget=G.pointBudget||2e6,X.pointSize=G.pointSize===0||!isNaN(G.pointSize)?G.pointSize:4,X.sseThreshold=G.sseThreshold||2,X.defineLayerProperty("minIntensityRange",G.minIntensityRange||0,te),X.defineLayerProperty("maxIntensityRange",G.maxIntensityRange||1,te),X.material=G.material||{},X.material.isMaterial||(G.material=G.material||{},G.material.intensityRange=new g.Vector2(X.minIntensityRange,X.maxIntensityRange),X.material=new D.default(G.material)),X.material.defines=X.material.defines||{},X.mode=G.mode||D.MODE.COLOR,X}return(0,M.default)(W,[{key:"preUpdate",value:function(X,G){X.camera.preSSE=X.camera.height/(2*Math.tan(g.MathUtils.degToRad(X.camera.camera3D.fov)*.5)),this.material&&(this.material.visible=this.visible,this.material.opacity=this.opacity,this.material.transparent=this.opacity<1,this.material.size=this.pointSize,this.material.updateUniforms&&this.material.updateUniforms());var j,K=b(G.values()),ce;try{for(K.s();!(ce=K.n()).done;){var se=ce.value;if(se.isCamera||se==this)return[this.root];if(se.obj!==void 0&&se.obj.isPoints&&se.obj.layer==this){if(!j)j=se;else if(j=se.findCommonAncestor(j),!j)return[this.root]}}}catch(ue){K.e(ue)}finally{K.f()}return j?[j]:[this.root]}},{key:"update",value:function(X,G,j){var K=this;if(j.visible=!1,this.octreeDepthLimit>=0&&this.octreeDepthLimit<j.depth){q(j);return}var ce=j.tightbbox?j.tightbbox:j.bbox;if(j.visible=X.camera.isBox3Visible(ce,this.object3d.matrixWorld),!j.visible){q(j);return}if(j.notVisibleSince=void 0,T.copy(X.camera.camera3D.position).sub(this.object3d.position),j.numPoints!==0){if(j.obj)j.obj.visible=!0;else if(!j.promise){var se=Math.max(.001,ce.distanceToPoint(T)),ue=H(X,G.pointSize,G.spacing,j,se)/se;j.promise=X.scheduler.execute({layer:G,requester:j,view:X.view,priority:ue,redraw:!0,earlyDropFunction:function(pt){return!pt.requester.visible||!K.visible}}).then(function($e){K.onPointsCreated&&K.onPointsCreated(G,$e),j.obj=$e,j.tightbbox=$e.tightbbox,K.group.add(j.obj),j.obj.updateMatrixWorld(!0),j.promise=null},function($e){$e.isCancelledCommandException&&(j.promise=null)})}}if(j.children&&j.children.length){var Y=ce.distanceToPoint(T);if(j.sse=H(X,G.pointSize,G.spacing,j,Y)/this.sseThreshold,j.sse>=1)return j.children;var pe=b(j.children),Ee;try{for(pe.s();!(Ee=pe.n()).done;){var Fe=Ee.value;q(Fe)}}catch($e){pe.e($e)}finally{pe.f()}}}},{key:"postUpdate",value:function(){this.displayedCount=0;var X=b(this.group.children),G;try{for(X.s();!(G=X.n()).done;){var j=G.value;if(j.visible){var K=j.geometry.attributes.position.count;j.geometry.setDrawRange(0,K),this.displayedCount+=K}}}catch(Xe){X.e(Xe)}finally{X.f()}if(this.displayedCount>this.pointBudget)if(this.supportsProgressiveDisplay){var ce=this.pointBudget/this.displayedCount,se=b(this.group.children),ue;try{for(se.s();!(ue=se.n()).done;){var Y=ue.value;if(Y.visible){var pe=Math.floor(Y.geometry.drawRange.count*ce);pe>0?Y.geometry.setDrawRange(0,pe):Y.visible=!1}}}catch(Xe){se.e(Xe)}finally{se.f()}this.displayedCount*=ce}else{this.group.children.sort(function(Xe,tt){return tt.userData.node.sse-Xe.userData.node.sse});var Ee=!1;this.displayedCount=0;var Fe=b(this.group.children),$e;try{for(Fe.s();!($e=Fe.n()).done;){var pt=$e.value,Ue=pt.geometry.attributes.position.count;Ee||this.displayedCount+Ue>this.pointBudget?(pt.visible=!1,Ee=!0):this.displayedCount+=Ue}}catch(Xe){Fe.e(Xe)}finally{Fe.f()}}for(var Je=Date.now(),et=this.group.children.length-1;et>=0;et--){var ze=this.group.children[et];!ze.visible&&Je-ze.userData.node.notVisibleSince>1e4&&(this.group.children.splice(et,1),ze.geometry.dispose(),ze.material=null,ze.geometry=null,ze.userData.node.obj=null)}}},{key:"pickObjectsAt",value:function(X,G,j){var K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];return B.default.pickPointsAt(X,G,j,this,K)}},{key:"getObjectToUpdateForAttachedLayers",value:function(X){if(X.obj){var G=X.parent;return G&&G.obj?{element:X.obj,parent:G.obj}:{element:X.obj}}}}]),W}(C.default),Z=Q;a.default=Z}(Gw)),Gw}var Vw={},Ww={},Hw={},bS;function kC(){return bS||(bS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=D(Dr());function C(E){if(typeof WeakMap!="function")return null;var b=new WeakMap,_=new WeakMap;return(C=function(T){return T?_:b})(E)}function D(E,b){if(!b&&E&&E.__esModule)return E;if(E===null||h(E)!=="object"&&typeof E!="function")return{default:E};var _=C(b);if(_&&_.has(E))return _.get(E);var x={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var N in E)if(N!=="default"&&Object.prototype.hasOwnProperty.call(E,N)){var U=T?Object.getOwnPropertyDescriptor(E,N):null;U&&(U.get||U.set)?Object.defineProperty(x,N,U):x[N]=E[N]}return x.default=E,_&&_.set(E,x),x}function B(E){var b=V();return function(){var _=(0,p.default)(E),x;if(b){var T=(0,p.default)(this).constructor;x=Reflect.construct(_,arguments,T)}else x=_.apply(this,arguments);return(0,y.default)(this,x)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P=function(E){(0,v.default)(_,E);var b=B(_);function _(){var x,T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,N=arguments.length>1?arguments[1]:void 0;return(0,R.default)(this,_),x=b.call(this),x.numPoints=T,x.layer=N,x.children=[],x.bbox=new g.Box3,x.sse=-1,x}return(0,M.default)(_,[{key:"add",value:function(T,N){this.children.push(T),T.parent=this,this.createChildAABB(T,N)}},{key:"load",value:function(){var T=this;return this.octreeIsLoaded||this.loadOctree(),this.layer.source.fetcher(this.url,this.layer.source.networkOptions).then(function(N){return T.layer.source.parse(N,{out:T.layer,in:T.layer.source})})}},{key:"findCommonAncestor",value:function(T){if(T.depth==this.depth){if(T.id==this.id)return T;if(T.depth!=0)return this.parent.findCommonAncestor(T.parent)}else return T.depth<this.depth?this.parent.findCommonAncestor(T):this.findCommonAncestor(T.parent)}}]),_}(g.EventDispatcher),L=P;a.default=L}(Hw)),Hw}var ES;function RI(){return ES||(ES=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Cs()),y=u(dn()),p=u(pn()),g=u(ln()),C=V(Dr()),D=u(kC());function B(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,N=new WeakMap;return(B=function(H){return H?N:T})(x)}function V(x,T){if(!T&&x&&x.__esModule)return x;if(x===null||h(x)!=="object"&&typeof x!="function")return{default:x};var N=B(T);if(N&&N.has(x))return N.get(x);var U={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in x)if(q!=="default"&&Object.prototype.hasOwnProperty.call(x,q)){var te=H?Object.getOwnPropertyDescriptor(x,q):null;te&&(te.get||te.set)?Object.defineProperty(U,q,te):U[q]=x[q]}return U.default=x,N&&N.set(x,U),U}function P(x){var T=L();return function(){var N=(0,g.default)(x),U;if(T){var H=(0,g.default)(this).constructor;U=Reflect.construct(N,arguments,H)}else U=N.apply(this,arguments);return(0,p.default)(this,U)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E=new C.Vector3,b=function(x){(0,y.default)(N,x);var T=P(N);function N(){var U,H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,te=arguments.length>2?arguments[2]:void 0;return(0,R.default)(this,N),U=T.call(this,H,te),U.childrenBitField=q,U.id="",U.depth=0,U.baseurl=te.source.baseurl,U}return(0,M.default)(N,[{key:"add",value:function(H,q,te){(0,v.default)((0,g.default)(N.prototype),"add",this).call(this,H,q),H.id=this.id+q,H.depth=H.id.length,H.id.length%this.layer.hierarchyStepSize==0?H.baseurl="".concat(te.baseurl,"/").concat(H.id.substr(te.id.length)):H.baseurl=te.baseurl}},{key:"createChildAABB",value:function(H,q){H.bbox.copy(this.bbox),this.bbox.getCenter(H.bbox.max),E.copy(H.bbox.max).sub(this.bbox.min),q===1?(H.bbox.min.z+=E.z,H.bbox.max.z+=E.z):q===3?(H.bbox.min.z+=E.z,H.bbox.max.z+=E.z,H.bbox.min.y+=E.y,H.bbox.max.y+=E.y):q===0||(q===2?(H.bbox.min.y+=E.y,H.bbox.max.y+=E.y):q===5?(H.bbox.min.z+=E.z,H.bbox.max.z+=E.z,H.bbox.min.x+=E.x,H.bbox.max.x+=E.x):q===7?(H.bbox.min.add(E),H.bbox.max.add(E)):q===4?(H.bbox.min.x+=E.x,H.bbox.max.x+=E.x):q===6&&(H.bbox.min.y+=E.y,H.bbox.max.y+=E.y,H.bbox.min.x+=E.x,H.bbox.max.x+=E.x))}},{key:"octreeIsLoaded",get:function(){return!(this.childrenBitField&&this.children.length===0)}},{key:"url",get:function(){return"".concat(this.baseurl,"/r").concat(this.id,".").concat(this.layer.source.extension)}},{key:"loadOctree",value:function(){var H=this,q="".concat(this.baseurl,"/r").concat(this.id,".").concat(this.layer.source.extensionOctree);return this.layer.source.fetcher(q,this.layer.source.networkOptions).then(function(te){var Q=new DataView(te),Z=[],ae=0;for(H.childrenBitField=Q.getUint8(0),ae+=1,H.numPoints=Q.getUint32(1,!0),ae+=4,Z.push(H);Z.length&&ae<te.byteLength;)for(var F=Z.shift(),W=0;W<8;W++)if(F.childrenBitField&1<<W&&ae+5<=te.byteLength){var O=Q.getUint8(ae);ae+=1;var X=Q.getUint32(ae,!0)||H.numPoints;ae+=4;var G=new N(X,O,H.layer);F.add(G,W,H),Z.push(G)}})}}]),N}(D.default),_=b;a.default=_}(Ww)),Ww}var TS;function CI(){return TS||(TS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(kr()),M=u(Ir()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=L(Dr()),D=u(rb()),B=u(RI()),V=u(ya());function P(U){if(typeof WeakMap!="function")return null;var H=new WeakMap,q=new WeakMap;return(P=function(Q){return Q?q:H})(U)}function L(U,H){if(!H&&U&&U.__esModule)return U;if(U===null||h(U)!=="object"&&typeof U!="function")return{default:U};var q=P(H);if(q&&q.has(U))return q.get(U);var te={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in U)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(U,Z)){var ae=Q?Object.getOwnPropertyDescriptor(U,Z):null;ae&&(ae.get||ae.set)?Object.defineProperty(te,Z,ae):te[Z]=U[Z]}return te.default=U,q&&q.set(U,te),te}function E(U){var H=b();return function(){var q=(0,g.default)(U),te;if(H){var Q=(0,g.default)(this).constructor;te=Reflect.construct(q,arguments,Q)}else te=q.apply(this,arguments);return(0,p.default)(this,te)}}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _=new C.Mesh,x=new C.Box3;_.geometry.boundingBox=x;var T=function(U){(0,y.default)(q,U);var H=E(q);function q(te,Q){var Z;(0,M.default)(this,q),Z=H.call(this,te,Q),Z.isPotreeLayer=!0;var ae=Z.addInitializationStep();return Z.source.whenReady.then(function(F){Z.scale=new C.Vector3().addScalar(F.scale),Z.spacing=F.spacing,Z.hierarchyStepSize=F.hierarchyStepSize;var W=Array.isArray(F.pointAttributes)&&F.pointAttributes.find(function(O){return O.startsWith("NORMAL")});return W&&(Z.material.defines[W]=1),Z.supportsProgressiveDisplay=Z.source.extension==="cin",Z.root=new B.default(0,0,(0,v.default)(Z)),Z.root.bbox.min.set(F.boundingBox.lx,F.boundingBox.ly,F.boundingBox.lz),Z.root.bbox.max.set(F.boundingBox.ux,F.boundingBox.uy,F.boundingBox.uz),Z.extent=V.default.fromBox3(Z.source.crs||"EPSG:4326",Z.root.bbox),Z.root.loadOctree().then(ae)}),Z}return(0,R.default)(q)}(D.default),N=T;a.default=N}(Vw)),Vw}var qw={},wc={},SS;function DC(){if(SS)return wc;SS=1;var a=hr.exports,u=Lr.exports;Object.defineProperty(wc,"__esModule",{value:!0}),wc.$3dTilesCulling=N,wc.$3dTilesSubdivisionControl=X,wc.computeNodeSSE=Z,wc.init3dTilesLayer=ae,wc.pre3dTilesUpdate=q,wc.process3dTilesNode=O;var h=a(Qh()),R=a(Lr.exports),M=p(Dr()),v=a(ya());function y(G){if(typeof WeakMap!="function")return null;var j=new WeakMap,K=new WeakMap;return(y=function(se){return se?K:j})(G)}function p(G,j){if(!j&&G&&G.__esModule)return G;if(G===null||u(G)!=="object"&&typeof G!="function")return{default:G};var K=y(j);if(K&&K.has(G))return K.get(G);var ce={},se=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in G)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(G,ue)){var Y=se?Object.getOwnPropertyDescriptor(G,ue):null;Y&&(Y.get||Y.set)?Object.defineProperty(ce,ue,Y):ce[ue]=G[ue]}return ce.default=G,K&&K.set(G,ce),ce}function g(G,j){var K=typeof Symbol<"u"&&G[Symbol.iterator]||G["@@iterator"];if(!K){if(Array.isArray(G)||(K=C(G))||j&&G&&typeof G.length=="number"){K&&(G=K);var ce=0,se=function(){};return{s:se,n:function(){return ce>=G.length?{done:!0}:{done:!1,value:G[ce++]}},e:function(Fe){throw Fe},f:se}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ue=!0,Y=!1,pe;return{s:function(){K=K.call(G)},n:function(){var Fe=K.next();return ue=Fe.done,Fe},e:function(Fe){Y=!0,pe=Fe},f:function(){try{!ue&&K.return!=null&&K.return()}finally{if(Y)throw pe}}}}function C(G,j){if(!!G){if(typeof G=="string")return D(G,j);var K=Object.prototype.toString.call(G).slice(8,-1);if(K==="Object"&&G.constructor&&(K=G.constructor.name),K==="Map"||K==="Set")return Array.from(G);if(K==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(K))return D(G,j)}}function D(G,j){(j==null||j>G.length)&&(j=G.length);for(var K=0,ce=new Array(j);K<j;K++)ce[K]=G[K];return ce}function B(G,j,K,ce,se,ue){var Y={view:G,requester:se,layer:K,priority:se?1/(se.distance+1):100,metadata:ce,redraw:ue};return j.execute(Y)}function V(G){return G.children.filter(function(j){return j.layer==G.layer&&j.tileId})}function P(G,j,K,ce){K.additiveRefinement?x(G,j,K,ce):T(G,j,K)}var L=new M.Box3,E=new M.Sphere;function b(G,j,K){if(j.region){var ce=L.copy(j.region.box3D).applyMatrix4(j.region.matrixWorld);return v.default.fromBox3(G,ce)}else if(j.box){var se=L.copy(j.box).applyMatrix4(K);return v.default.fromBox3(G,se)}else{var ue=E.copy(j.sphere).applyMatrix4(K),Y=ue.getBoundingBox(L);return v.default.fromBox3(G,Y)}}var _=new M.Matrix4;function x(G,j,K,ce){var se=g(j.tileset.tiles[K.tileId].children),ue;try{var Y=function(){var Fe=ue.value;if(Fe.promise||Fe.loaded)return"continue";var $e=K.matrixWorld;Fe.transform&&($e=_.multiplyMatrices(K.matrixWorld,Fe.transform));var pt=ce?!ce(j,G.camera,Fe,$e):!0;if(!pt)return"continue";Fe.promise=B(G.view,G.scheduler,j,Fe,K,!0).then(function(Ue){K.add(Ue),Ue.updateMatrixWorld();var Je=b(j.extent.crs,Ue.boundingVolume,Ue.matrixWorld);Ue.traverse(function(et){et.extent=Je}),j.onTileContentLoaded(Ue),G.view.notifyChange(Fe),Fe.loaded=!0,delete Fe.promise})};for(se.s();!(ue=se.n()).done;)var pe=Y()}catch(Ee){se.e(Ee)}finally{se.f()}}function T(G,j,K){if(!K.pendingSubdivision&&V(K).length==0){var ce=function(){var se=j.tileset.tiles[K.tileId].children;if(se===void 0||se.length===0)return{v:void 0};K.pendingSubdivision=!0;for(var ue=[],Y=function(Fe){ue.push(B(G.view,G.scheduler,j,se[Fe],K,!1).then(function($e){se[Fe].loaded=!0,K.add($e),$e.updateMatrixWorld(),K.additiveRefinement&&G.view.notifyChange(K),j.tileset.tiles[$e.tileId].loaded=!0,j.onTileContentLoaded($e)}))},pe=0;pe<se.length;pe++)Y(pe);Promise.all(ue).then(function(){K.pendingSubdivision=!1,G.view.notifyChange(K)})}();if((0,R.default)(ce)==="object")return ce.v}}function N(G,j,K,ce){return!!(K.viewerRequestVolume&&K.viewerRequestVolume.viewerRequestVolumeCulling(j,ce)||K.boundingVolume&&K.boundingVolume.boundingVolumeCulling(j,ce))}function U(G,j){for(var K=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,ce=j.additiveRefinement||K>0,se=0;se<j.children.length;se++)j.children[se].content?U(G,j.children[se],K+1):ce&&j.children[se].traverse(H);if(ce)j.dispose&&j.dispose(),delete j.content,G.tileset.tiles[j.tileId].loaded=!1,j.remove.apply(j,(0,h.default)(j.children)),K==0&&j.parent&&j.parent.remove(j);else{var ue=V(j);j.remove.apply(j,(0,h.default)(ue))}}function H(G){var j=g(G.children),K;try{for(j.s();!(K=j.n()).done;){var ce=K.value;H(ce)}}catch(pe){j.e(pe)}finally{j.f()}if(G.material)if(Array.isArray(G.material)){var se=g(G.material),ue;try{for(se.s();!(ue=se.n()).done;){var Y=ue.value;Y.dispose()}}catch(pe){se.e(pe)}finally{se.f()}}else G.material.dispose();G.geometry&&G.geometry.dispose(),G.remove.apply(G,(0,h.default)(G.children))}function q(){if(!this.visible)return[];var G=Date.now();if(this._cleanableTiles.length&&G-this._cleanableTiles[0].cleanableSince>this.cleanupDelay){this.root.cleanableSince=void 0;for(var j=0;j<this._cleanableTiles.length;j++){var K=this._cleanableTiles[j];if(G-K.cleanableSince>this.cleanupDelay)U(this,K);else break}this._cleanableTiles.splice(0,j)}return[this.root]}var te=new M.Box3,Q=new M.Sphere;function Z(G,j){if(j.distance=0,j.boundingVolume.region)te.copy(j.boundingVolume.region.box3D),te.applyMatrix4(j.boundingVolume.region.matrixWorld),j.distance=te.distanceToPoint(G.camera3D.position);else if(j.boundingVolume.box)te.copy(j.boundingVolume.box),te.applyMatrix4(j.matrixWorld),j.distance=te.distanceToPoint(G.camera3D.position);else if(j.boundingVolume.sphere)Q.copy(j.boundingVolume.sphere),Q.applyMatrix4(j.matrixWorld),j.distance=Math.max(0,Q.distanceToPoint(G.camera3D.position));else return 1/0;return j.distance===0?1/0:G._preSSE*(j.geometricError/j.distance)}function ae(G,j,K,ce){return B(G,j,K,ce,void 0,!0).then(function(se){K.object3d.add(se),se.updateMatrixWorld(),K.tileset.tiles[se.tileId].loaded=!0,K.root=se,K.extent=b(K.crs||G.referenceCrs,se.boundingVolume,se.matrixWorld),K.onTileContentLoaded(se)})}function F(G,j){G.content&&(G.content.visible=j)}function W(G,j){j.cleanableSince||(j.cleanableSince=Date.now(),G._cleanableTiles.push(j))}function O(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:X;return function(ce,se,ue){if(ue.parent.pendingSubdivision&&!ue.parent.additiveRefinement){ue.visible=!1;return}var Y=G?!G(se,ce.camera,ue,ue.matrixWorld):!0;if(ue.visible=Y,Y){ue.cleanableSince&&(se._cleanableTiles.splice(se._cleanableTiles.indexOf(ue),1),ue.cleanableSince=void 0);var pe;if(ue.pendingSubdivision||j(ce,se,ue))P(ce,se,ue,G),F(ue,ue.pendingSubdivision||ue.additiveRefinement),pe=V(ue);else{F(ue,!0);var Ee=g(V(ue)),Fe;try{for(Ee.s();!(Fe=Ee.n()).done;){var $e=Fe.value;$e.visible=!1,W(se,$e)}}catch(pt){Ee.e(pt)}finally{Ee.f()}}return pe}W(se,ue)}}function X(G,j,K){if(j.tileset.tiles[K.tileId].children===void 0)return!1;if(j.tileset.tiles[K.tileId].isTileset)return!0;var ce=Z(G.camera,K);return ce>j.sseThreshold}return wc}var Xw={},Zw={},RS;function NC(){return RS||(RS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=D(Dr()),y=u(ya()),p=u(KM()),g=u(o2());function C(T){if(typeof WeakMap!="function")return null;var N=new WeakMap,U=new WeakMap;return(C=function(q){return q?U:N})(T)}function D(T,N){if(!N&&T&&T.__esModule)return T;if(T===null||h(T)!=="object"&&typeof T!="function")return{default:T};var U=C(N);if(U&&U.has(T))return U.get(T);var H={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in T)if(te!=="default"&&Object.prototype.hasOwnProperty.call(T,te)){var Q=q?Object.getOwnPropertyDescriptor(T,te):null;Q&&(Q.get||Q.set)?Object.defineProperty(H,te,Q):H[te]=T[te]}return H.default=T,U&&U.set(T,H),H}var B=new v.Matrix4,V=new v.Vector3,P=new v.Vector3,L=new y.default("EPSG:4326",0,0,0,0),E=new v.Vector3,b=new v.Vector3,_=function(){function T(N,U,H){if((0,R.default)(this,T),this.type=g.default.boundingVolume,N.region)this.initBoundingRegion(N.region,U);else if(N.box)this.initBoundingBox(N.box);else if(N.sphere)this.initBoundingSphere(N.sphere);else throw new Error("3D Tiles nodes must have a bounding volume");N.extensions&&(this.extensions=H.parseExtensions(N.extensions,this.type))}return(0,M.default)(T,[{key:"initBoundingRegion",value:function(U,H){L.set(v.MathUtils.radToDeg(U[0]),v.MathUtils.radToDeg(U[2]),v.MathUtils.radToDeg(U[1]),v.MathUtils.radToDeg(U[3]));var q=new p.default;q.setFromExtent(L),q.updateZ({min:U[4],max:U[5]}),q.matrix.premultiply(H),q.matrix.decompose(q.position,q.quaternion,q.scale),this.region=q}},{key:"initBoundingBox",value:function(U){V.set(U[0],U[1],U[2]),P.set(U[3],U[7],U[11]).multiplyScalar(2),this.box=new v.Box3,this.box.setFromCenterAndSize(V,P)}},{key:"initBoundingSphere",value:function(U){E.set(U[0],U[1],U[2]),this.sphere=new v.Sphere(E,U[3])}},{key:"boundingVolumeCulling",value:function(U,H){return this.region&&!U.isBox3Visible(this.region.box3D,B.multiplyMatrices(H,this.region.matrix))||this.box&&!U.isBox3Visible(this.box,H)?!0:this.sphere&&!U.isSphereVisible(this.sphere,H)}},{key:"viewerRequestVolumeCulling",value:function(U,H){return this.region?(console.warn("Region viewerRequestVolume not yet supported"),!0):this.box?(console.warn("Bounding box viewerRequestVolume not yet supported"),!0):!!(this.sphere&&(b.copy(this.sphere.center),b.applyMatrix4(H),!(U.camera3D.position.distanceTo(b)<=this.sphere.radius)))}}]),T}(),x=_;a.default=x}(Zw)),Zw}var CS;function BC(){return CS||(CS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=C(Dr()),y=u(NC()),p=u(o2());function g(b){if(typeof WeakMap!="function")return null;var _=new WeakMap,x=new WeakMap;return(g=function(N){return N?x:_})(b)}function C(b,_){if(!_&&b&&b.__esModule)return b;if(b===null||h(b)!=="object"&&typeof b!="function")return{default:b};var x=g(_);if(x&&x.has(b))return x.get(b);var T={},N=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in b)if(U!=="default"&&Object.prototype.hasOwnProperty.call(b,U)){var H=N?Object.getOwnPropertyDescriptor(b,U):null;H&&(H.get||H.set)?Object.defineProperty(T,U,H):T[U]=b[U]}return T.default=b,x&&x.set(b,T),T}function D(b,_){var x=typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(!x){if(Array.isArray(b)||(x=B(b))||_&&b&&typeof b.length=="number"){x&&(b=x);var T=0,N=function(){};return{s:N,n:function(){return T>=b.length?{done:!0}:{done:!1,value:b[T++]}},e:function(Q){throw Q},f:N}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var U=!0,H=!1,q;return{s:function(){x=x.call(b)},n:function(){var Q=x.next();return U=Q.done,Q},e:function(Q){H=!0,q=Q},f:function(){try{!U&&x.return!=null&&x.return()}finally{if(H)throw q}}}}function B(b,_){if(!!b){if(typeof b=="string")return V(b,_);var x=Object.prototype.toString.call(b).slice(8,-1);if(x==="Object"&&b.constructor&&(x=b.constructor.name),x==="Map"||x==="Set")return Array.from(b);if(x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x))return V(b,_)}}function V(b,_){(_==null||_>b.length)&&(_=b.length);for(var x=0,T=new Array(_);x<_;x++)T[x]=b[x];return T}var P=new v.Matrix4,L=function(){function b(_,x,T){(0,R.default)(this,b),this.type=p.default.tileset,this.asset=_.asset,this.properties=_.properties,this.geometricError=_.geometricError,this.extensionsUsed=_.extensionsUsed,this.extensionsRequired=_.extensionsRequired,this.tiles=[],this.parseTiles(_.root,x,void 0,T),_.extensions&&(this.extensions=T.parseExtensions(_.extensions,this.type))}return(0,M.default)(b,[{key:"parseTiles",value:function(x,T,N,U){if(x.transform=x.transform?new v.Matrix4().fromArray(x.transform):void 0,x._worldFromLocalTransform=x.transform,N&&N._worldFromLocalTransform&&(x.transform?x._worldFromLocalTransform=new v.Matrix4().multiplyMatrices(N._worldFromLocalTransform,x.transform):x._worldFromLocalTransform=N._worldFromLocalTransform),(x.viewerRequestVolume&&x.viewerRequestVolume.region||x.boundingVolume&&x.boundingVolume.region)&&(x._worldFromLocalTransform?P.copy(x._worldFromLocalTransform).invert():P.identity()),x.viewerRequestVolume=x.viewerRequestVolume?new y.default(x.viewerRequestVolume,P,U):void 0,x.boundingVolume=x.boundingVolume?new y.default(x.boundingVolume,P,U):void 0,this.tiles.push(x),x.tileId=this.tiles.length-1,x.baseURL=T,x.children){var H=D(x.children),q;try{for(H.s();!(q=H.n()).done;){var te=q.value;this.parseTiles(te,T,x,U)}}catch(Q){H.e(Q)}finally{H.f()}}}},{key:"extendTileset",value:function(x,T,N,U){this.parseTiles(x.root,N,this.tiles[T],U),this.tiles[T].children=[x.root],this.tiles[T].isTileset=!0}}]),b}(),E=L;a.default=E}(Xw)),Xw}var jw={},PS;function UC(){return PS||(PS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=function(){function y(){(0,h.default)(this,y)}return(0,R.default)(y,[{key:"registerExtension",value:function(g,C){this[g]=C}},{key:"getExtension",value:function(g,C){if(this[g]&&this[g][C])return this[g][C];console.error("".concat("No extension manager registered for extension "," ").concat(g," and for class ").concat(C))}},{key:"isExtensionRegistered",value:function(g){return this[g]}},{key:"parseExtensions",value:function(g,C){var D={};for(var B in g)Object.prototype.hasOwnProperty.call(g,B)&&(D[B]=new(this.getExtension(B,C))(g[B]));return D}}]),y}(),v=M;a.default=v}(jw)),jw}var LS;function PI(){return LS||(LS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=E(Dr()),D=u(ad()),B=DC(),V=u(BC()),P=u(UC());function L(te){if(typeof WeakMap!="function")return null;var Q=new WeakMap,Z=new WeakMap;return(L=function(F){return F?Z:Q})(te)}function E(te,Q){if(!Q&&te&&te.__esModule)return te;if(te===null||h(te)!=="object"&&typeof te!="function")return{default:te};var Z=L(Q);if(Z&&Z.has(te))return Z.get(te);var ae={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var W in te)if(W!=="default"&&Object.prototype.hasOwnProperty.call(te,W)){var O=F?Object.getOwnPropertyDescriptor(te,W):null;O&&(O.get||O.set)?Object.defineProperty(ae,W,O):ae[W]=te[W]}return ae.default=te,Z&&Z.set(te,ae),ae}function b(te,Q){var Z=typeof Symbol<"u"&&te[Symbol.iterator]||te["@@iterator"];if(!Z){if(Array.isArray(te)||(Z=_(te))||Q&&te&&typeof te.length=="number"){Z&&(te=Z);var ae=0,F=function(){};return{s:F,n:function(){return ae>=te.length?{done:!0}:{done:!1,value:te[ae++]}},e:function(j){throw j},f:F}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var W=!0,O=!1,X;return{s:function(){Z=Z.call(te)},n:function(){var j=Z.next();return W=j.done,j},e:function(j){O=!0,X=j},f:function(){try{!W&&Z.return!=null&&Z.return()}finally{if(O)throw X}}}}function _(te,Q){if(!!te){if(typeof te=="string")return x(te,Q);var Z=Object.prototype.toString.call(te).slice(8,-1);if(Z==="Object"&&te.constructor&&(Z=te.constructor.name),Z==="Map"||Z==="Set")return Array.from(te);if(Z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Z))return x(te,Q)}}function x(te,Q){(Q==null||Q>te.length)&&(Q=te.length);for(var Z=0,ae=new Array(Q);Z<Q;Z++)ae[Z]=te[Z];return ae}function T(te){var Q=N();return function(){var Z=(0,g.default)(te),ae;if(Q){var F=(0,g.default)(this).constructor;ae=Reflect.construct(Z,arguments,F)}else ae=Z.apply(this,arguments);return(0,p.default)(this,ae)}}function N(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var U=(0,B.process3dTilesNode)(),H=function(te){(0,y.default)(Z,te);var Q=T(Z);function Z(ae,F,W){var O;(0,R.default)(this,Z),O=Q.call(this,ae,new C.Group,{source:F.source}),O.isC3DTilesLayer=!0,O.sseThreshold=F.sseThreshold||16,O.cleanupDelay=F.cleanupDelay||1e3,O.onTileContentLoaded=F.onTileContentLoaded||function(){},O.protocol="3d-tiles",O.overrideMaterials=F.overrideMaterials!==void 0?F.overrideMaterials:!0,O.name=F.name,O.registeredExtensions=F.registeredExtensions||new P.default,O._cleanableTiles=[];var X=O.addInitializationStep();return O.source.whenReady.then(function(G){if(O.tileset=new V.default(G,O.source.baseUrl,O.registeredExtensions),O.tileset.extensionsUsed){var j=b(O.tileset.extensionsUsed),K;try{for(j.s();!(K=j.n()).done;){var ce=K.value;O.registeredExtensions.isExtensionRegistered(ce)||(O.tileset.extensionsRequired&&O.tileset.extensionsRequired.includes(ce)?console.error('3D Tiles tileset required extension "'.concat(ce,'" must be registered to the 3D Tiles layer of iTowns to be parsed and used.')):console.warn('3D Tiles tileset used extension "'.concat(ce,'" must be registered to the 3D Tiles layer of iTowns to be parsed and used.')))}}catch(se){j.e(se)}finally{j.f()}}(0,B.init3dTilesLayer)(W,W.mainLoop.scheduler,(0,v.default)(O),G.root).then(X)}),O}return(0,M.default)(Z,[{key:"preUpdate",value:function(){return B.pre3dTilesUpdate.bind(this)()}},{key:"update",value:function(F,W,O){return U(F,W,O)}},{key:"getObjectToUpdateForAttachedLayers",value:function(F){if(F.content){var W=[];F.content.traverse(function(X){X.isObject3D&&X.material&&X.layer==F.layer&&W.push(X)});var O=F.parent;return O&&O.content?{elements:W,parent:O.content}:{elements:W}}}},{key:"findBatchTable",value:function(F){if(F.batchTable)return F.batchTable;if(F.parent)return this.findBatchTable(F.parent)}},{key:"getInfoFromIntersectObject",value:function(F){for(var W={},O=-1,X={},G=0;G<F.length;G++){var j=F[G].object.geometry.attributes;if(j&&j._BATCHID){var K=F[G].face.a;O=j._BATCHID.array[K],X=this.findBatchTable(F[G].object);break}}if(O!==-1)return W.batchID=O,Object.assign(W,X.getInfoById(O)),W}}]),Z}(D.default),q=H;a.default=q}(qw)),qw}var Yw={},Jw={},OS;function LI(){return OS||(OS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=V(Dr()),C=u(td()),D=u(n2());function B(q){if(typeof WeakMap!="function")return null;var te=new WeakMap,Q=new WeakMap;return(B=function(ae){return ae?Q:te})(q)}function V(q,te){if(!te&&q&&q.__esModule)return q;if(q===null||h(q)!=="object"&&typeof q!="function")return{default:q};var Q=B(te);if(Q&&Q.has(q))return Q.get(q);var Z={},ae=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var F in q)if(F!=="default"&&Object.prototype.hasOwnProperty.call(q,F)){var W=ae?Object.getOwnPropertyDescriptor(q,F):null;W&&(W.get||W.set)?Object.defineProperty(Z,F,W):Z[F]=q[F]}return Z.default=q,Q&&Q.set(q,Z),Z}function P(q){var te=L();return function(){var Q=(0,p.default)(q),Z;if(te){var ae=(0,p.default)(this).constructor;Z=Reflect.construct(Q,arguments,ae)}else Z=Q.apply(this,arguments);return(0,y.default)(this,Z)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E=`#include <itowns/WebGL2_pars_vertex>
#include <itowns/precision_qualifier>
#include <itowns/project_pars_vertex>
#include <itowns/projective_texturing_pars_vertex>
#include <common>
#include <logdepthbuf_pars_vertex>

varying vec3 vNormal;
attribute vec3 normal;

void main() {
    #include <begin_vertex>
    #include <project_vertex>
    vNormal = normal;
    #include <itowns/projective_texturing_vertex>
    #include <logdepthbuf_vertex>
}
`,b=`#include <itowns/WebGL2_pars_fragment>
#include <itowns/precision_qualifier>
#include <logdepthbuf_pars_fragment>
#include <itowns/projective_texturing_pars_fragment>
varying vec3 vNormal;

#ifdef USE_BASE_MATERIAL
struct noPT {
    vec3 lightDirection;
    vec3 ambient;
    float opacity;
};

uniform noPT noProjectiveMaterial;
#endif

void main(void)
{
    #include <logdepthbuf_fragment>
    #ifdef USE_BASE_MATERIAL
    float nDotVP = (max(0.1, dot(vNormal, normalize(noProjectiveMaterial.lightDirection))));
    vec4 color = vec4(noProjectiveMaterial.ambient + nDotVP, 0.0);
    #else
    vec4 color = vec4(0.0);
    #endif

    #pragma unroll_loop
    for (int i = 0; i < ORIENTED_IMAGES_COUNT; i++) {
        color = projectiveTextureColor(projectiveTextureCoords[ ORIENTED_IMAGES_COUNT - 1 - i ], projectiveTextureDistortion[ ORIENTED_IMAGES_COUNT - 1 - i ], projectiveTexture[ ORIENTED_IMAGES_COUNT - 1 - i ], mask[ORIENTED_IMAGES_COUNT - 1 - i], color);
    }

    #ifdef USE_BASE_MATERIAL
    color.a = color.a < 1.0 ? max(noProjectiveMaterial.opacity, color.a) : 1.0 ;
    gl_FragColor = vec4(color.rgb, color.a * opacity);
    #else
    gl_FragColor = vec4(color.rgb / color.a, opacity);
    #endif

}
`,_=new g.Matrix4().set(1,0,0,1,0,1,0,1,0,0,2,0,0,0,0,2),x=new g.DataTexture(new Uint8Array([255,255,255,255]),1,1,g.RGBAFormat,g.UnsignedByteType);x.needsUpdate=!0;var T=new g.Texture,N=new g.RawShaderMaterial,U=function(q){(0,v.default)(Q,q);var te=P(Q);function Q(Z){var ae,F,W,O,X,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,R.default)(this,Q),G.side=(ae=G.side)!==null&&ae!==void 0?ae:g.DoubleSide,G.transparent=(F=G.transparent)!==null&&F!==void 0?F:!0,G.opacity=(W=G.opacity)!==null&&W!==void 0?W:1;var j={};for(var K in G)if(Object.prototype.hasOwnProperty.call(G,K)){var ce=N[K];ce!==void 0&&(j[K]=G[K])}X=te.call(this,j),X.defines.ORIENTED_IMAGES_COUNT=(O=G.OrientedImagesCount)!==null&&O!==void 0?O:Z.length;var se=C.default.getMaxTextureUnitsCount();X.defines.ORIENTED_IMAGES_COUNT>se&&(console.warn("OrientedImageMaterial: Can't project ".concat(Z.length," textures, because it's more than GPU capabilities maximum texture units (").concat(se,")")),X.defines.ORIENTED_IMAGES_COUNT=se-1,console.warn("OrientedImageMaterial: We'll use only the first ".concat(X.defines.ORIENTED_IMAGES_COUNT," cameras."))),G.useBaseMaterial&&(X.defines.USE_BASE_MATERIAL=!0),X.defines.USE_DISTORTION=Number(Z.some(function($e){return $e.distortion.pps!==null})),X.alphaBorder=G.alphaBorder|20,X.defines.DEBUG_ALPHA_BORDER=G.debugAlphaBorder|0,X.cameras=Z;var ue=[],Y=[],pe=[],Ee=[];X.group=new g.Group;for(var Fe=0;Fe<X.defines.ORIENTED_IMAGES_COUNT;++Fe)Y[Fe]=T,pe[Fe]=x,ue[Fe]=new g.Matrix4,Z[Fe].needsUpdate=!0,Ee[Fe]=Z[Fe].distortion,X.group.add(Z[Fe]);return X.uniforms.opacity=new g.Uniform(X.opacity),X.uniforms.projectiveTextureAlphaBorder=new g.Uniform(X.alphaBorder),X.uniforms.projectiveTextureDistortion=new g.Uniform(Ee),X.uniforms.projectiveTextureMatrix=new g.Uniform(ue),X.uniforms.projectiveTexture=new g.Uniform(Y),X.uniforms.mask=new g.Uniform(pe),X.uniforms.boostLight=new g.Uniform(!1),X.uniforms.noProjectiveMaterial=new g.Uniform({lightDirection:new g.Vector3(.5,.5,-.5),ambient:new g.Color(.1,.1,.1),opacity:.75}),C.default.isLogDepthBufferSupported()&&(X.defines.USE_LOGDEPTHBUF=1,X.defines.USE_LOGDEPTHBUF_EXT=1),X.vertexShader=E,X.fragmentShader=D.default.unrollLoops(b,X.defines),X}return(0,M.default)(Q,[{key:"onBeforeCompile",value:function(ae,F){F.capabilities.isWebGL2&&(this.defines.WEBGL2=!0,ae.glslVersion="300 es")}},{key:"setTextures",value:function(ae,F,W){var O=this;if(!!ae){this.group.position.copy(F.position),this.group.quaternion.copy(F.quaternion);for(var X=function(j){if(O.uniforms.projectiveTexture.value[j].dispose(),O.uniforms.projectiveTexture.value[j]=ae[j],W){var K=O.group.children[j];if(W[j]!=K.name){var ce=O.cameras.find(function(se){return se.name===W[j]});O.uniforms.mask.value[j]=ce.maskTexture||x,O.uniforms.mask.value[j].needsUpdate=!0,O.uniforms.projectiveTextureDistortion.value[j]=ce.distortion,O.group.children[j]=ce,ce.parent=O.group}}O.group.children[j].needsUpdate=!0},G=0;G<ae.length&&G<this.defines.ORIENTED_IMAGES_COUNT;++G)X(G);this.group.updateMatrixWorld(!0)}}},{key:"updateUniforms",value:function(ae){for(var F=0;F<this.group.children.length;++F){var W=this.group.children[F];W.needsUpdate&&(W.textureMatrixWorldInverse.multiplyMatrices(_,W.projectionMatrix),W.textureMatrixWorldInverse.multiply(W.matrixWorldInverse),W.needsUpdate=!1),this.uniforms.projectiveTextureMatrix.value[F].multiplyMatrices(W.textureMatrixWorldInverse,ae.matrixWorld)}}}]),Q}(g.RawShaderMaterial),H=U;a.default=H}(Jw)),Jw}var $w={},FS;function zC(){return FS||(FS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=y(Dr()),M=u(PC());function v(B){if(typeof WeakMap!="function")return null;var V=new WeakMap,P=new WeakMap;return(v=function(E){return E?P:V})(B)}function y(B,V){if(!V&&B&&B.__esModule)return B;if(B===null||h(B)!=="object"&&typeof B!="function")return{default:B};var P=v(V);if(P&&P.has(B))return P.get(B);var L={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var b in B)if(b!=="default"&&Object.prototype.hasOwnProperty.call(B,b)){var _=E?Object.getOwnPropertyDescriptor(B,b):null;_&&(_.get||_.set)?Object.defineProperty(L,b,_):L[b]=B[b]}return L.default=B,P&&P.set(B,L),L}var p=new R.TextureLoader,g=new R.Matrix3;function C(B){var V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},P=V.useMask==null?!0:V.useMask,L=V.imageYDown==null?!0:V.imageYDown,E=B.projection,b=new R.Vector2().fromArray(B.size),_=new R.Vector2(E[0],E[4]),x=new R.Vector2(E[2],L?b.y-E[5]:E[5]),T=E[1],N=new M.default(b,_,x,V.near,V.far,T);N.position.fromArray(B.position);var U=g.fromArray(B.rotation);N.matrix.setFromMatrix3(U),N.quaternion.setFromRotationMatrix(N.matrix),N.rotateX(Math.PI),B.distortion&&N.distortion.setFromMicmacCalibration(B.distortion,L),N.maskPath=B.mask,N.name=B.id;var H,q=new Promise(function(te){H=te});return P&&N.maskPath?p.load(N.maskPath,function(te){N.maskTexture=te,H(N)}):H(N),q}var D={parse:function(V){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return typeof V=="string"&&(V=JSON.parse(V)),Promise.all(V.map(function(L){return C(L,P)}))}};a.default=D}($w)),$w}var IS;function OI(){return IS||(IS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(Cs()),p=u(dn()),g=u(pn()),C=u(ln()),D=x(Dr()),B=u(ad()),V=u(LI()),P=u(k0()),L=u(zC()),E=u(Zi()),b=u(tb());function _(X){if(typeof WeakMap!="function")return null;var G=new WeakMap,j=new WeakMap;return(_=function(ce){return ce?j:G})(X)}function x(X,G){if(!G&&X&&X.__esModule)return X;if(X===null||h(X)!=="object"&&typeof X!="function")return{default:X};var j=_(G);if(j&&j.has(X))return j.get(X);var K={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in X)if(se!=="default"&&Object.prototype.hasOwnProperty.call(X,se)){var ue=ce?Object.getOwnPropertyDescriptor(X,se):null;ue&&(ue.get||ue.set)?Object.defineProperty(K,se,ue):K[se]=X[se]}return K.default=X,j&&j.set(X,K),K}function T(X,G){var j=typeof Symbol<"u"&&X[Symbol.iterator]||X["@@iterator"];if(!j){if(Array.isArray(X)||(j=N(X))||G&&X&&typeof X.length=="number"){j&&(X=j);var K=0,ce=function(){};return{s:ce,n:function(){return K>=X.length?{done:!0}:{done:!1,value:X[K++]}},e:function(Ee){throw Ee},f:ce}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var se=!0,ue=!1,Y;return{s:function(){j=j.call(X)},n:function(){var Ee=j.next();return se=Ee.done,Ee},e:function(Ee){ue=!0,Y=Ee},f:function(){try{!se&&j.return!=null&&j.return()}finally{if(ue)throw Y}}}}function N(X,G){if(!!X){if(typeof X=="string")return U(X,G);var j=Object.prototype.toString.call(X).slice(8,-1);if(j==="Object"&&X.constructor&&(j=X.constructor.name),j==="Map"||j==="Set")return Array.from(X);if(j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j))return U(X,G)}}function U(X,G){(G==null||G>X.length)&&(G=X.length);for(var j=0,K=new Array(G);j<G;j++)K[j]=X[j];return K}function H(X){var G=q();return function(){var j=(0,C.default)(X),K;if(G){var ce=(0,C.default)(this).constructor;K=Reflect.construct(j,arguments,ce)}else K=j.apply(this,arguments);return(0,g.default)(this,K)}}function q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var te=new E.default("EPSG:4978",0,0,0),Q=function(X){return X.requester.id!==X.layer.currentPano.id};function Z(X,G,j){var K=j.mostNearPano(G.position),ce=j.currentPano?j.currentPano.id:void 0;if(K&&ce!=K.id){j.currentPano=K,j.onPanoChanged({previousPanoPosition:j.getPreviousPano()?j.getPreviousPano().position:void 0,currentPanoPosition:j.getCurrentPano().position,nextPanoPosition:j.getNextPano().position});var se=K.geometries[0].properties.idSensors,ue=j.cameras.map(function(pe){return{cameraId:pe.name,panoId:K.id,as:function(){}}}).filter(function(pe){return!se||se.includes(pe.cameraId)}),Y={layer:j,extentsSource:ue,view:X.view,threejsLayer:j.threejsLayer,requester:K,earlyDropFunction:Q};X.scheduler.execute(Y).then(function(pe){K.id===j.currentPano.id&&(j.material.setTextures(pe,K,j.getCamerasNameFromFeature(K)),j.material.updateUniforms(X.camera.camera3D),X.view.notifyChange(j,!0))},function(){})}}function ae(X){X.background&&X.currentPano&&(X.background.position.copy(X.currentPano.position),X.background.updateMatrixWorld(),X.background.material=X.material||X.background.material)}function F(X){if(!(!X||X<=0)){var G=new D.SphereGeometry(X,32,32),j=new D.MeshPhongMaterial({color:7829503,side:D.DoubleSide,transparent:!0,opacity:.5,wireframe:!0}),K=new D.Mesh(G,j);return K.visible=!0,K.name="OrientedImageBackground",K}}var W=function(X){(0,p.default)(j,X);var G=H(j);function j(K){var ce,se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};(0,R.default)(this,j),se.projection&&(console.warn("OrientedImageLayer projection parameter is deprecated, use crs instead."),se.crs=se.crs||se.projection),ce=G.call(this,K,new D.Group,se),ce.background=se.background||F(se.backgroundDistance),ce.isOrientedImageLayer=!0,ce.background&&ce.object3d.add(ce.background),ce.currentPano=void 0,ce.onPanoChanged=se.onPanoChanged||function(){},ce.getCamerasNameFromFeature=se.getCamerasNameFromFeature||function(){};var ue=ce.addInitializationStep();ce.mergeFeatures=!1,ce.filteringExtent=!1,ce.accurate=!0;var Y={out:(0,v.default)(ce)};return ce.source.whenReady.then(function(pe){return P.default.parse(se.orientation||pe.orientation,Y).then(function(Ee){ce.panos=Ee.features;var Fe=Y.in.crs,$e=se.crs,pt=b.default.quaternionFromCRSToCRS(Fe,$e),Ue=new D.Quaternion,Je=0,et=T(ce.panos),ze;try{for(et.s();!(ze=et.n()).done;){var Xe=ze.value;te.crs=Xe.crs,te.setFromArray(Xe.vertices).applyMatrix4(Ee.matrix),Xe.position=te.toVector3(),pt(te,Ue),Xe.quaternion=b.default.quaternionFromAttitude(Xe.geometries[0].properties).premultiply(Ue),Xe.id=Xe.geometries[0].properties.id,Xe.index=Je++}}catch(tt){et.e(tt)}finally{et.f()}}).then(function(){L.default.parse(se.calibration||pe.calibration,se).then(function(Ee){ce.cameras=Ee,ce.material=new V.default(ce.cameras,se),ue()})})}),ce}return(0,M.default)(j,[{key:"update",value:function(){}},{key:"boostLight",get:function(){return this.material.uniforms.boostLight.value},set:function(ce){this.material.uniforms.boostLight.value=ce}},{key:"preUpdate",value:function(ce){Z(ce,ce.camera.camera3D,this),this.material.updateUniforms(ce.camera.camera3D),ae(this)}},{key:"getNextPano",value:function(){var ce=(this.currentPano.index+1)%this.panos.length;return this.panos[ce]}},{key:"getCurrentPano",value:function(){return this.currentPano}},{key:"getPreviousPano",value:function(){var ce=(this.currentPano.index-1)%this.panos.length;return this.panos[ce]}},{key:"delete",value:function(){(0,y.default)((0,C.default)(j.prototype),"delete",this).call(this),this.material.visible=!1,console.warn("You need to replace OrientedImageLayer.material applied on each object. This issue will be fixed when OrientedImageLayer will be a ColorLayer. the material visibility is set to false. To follow issue see https://github.com/iTowns/itowns/issues/1018")}},{key:"mostNearPano",value:function(ce){var se=1/0,ue,Y=T(this.panos),pe;try{for(Y.s();!(pe=Y.n()).done;){var Ee=pe.value,Fe=ce.distanceTo(Ee.position);Fe<se&&(se=Fe,ue=Ee)}}catch($e){Y.e($e)}finally{Y.f()}return ue}}]),j}(B.default),O=W;a.default=O}(Yw)),Yw}var Qw={},Kw={},kS;function FI(){return kS||(kS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(dn()),y=u(pn()),p=u(ln()),g=V(Dr()),C=u(dl()),D=u(kC());function B(U){if(typeof WeakMap!="function")return null;var H=new WeakMap,q=new WeakMap;return(B=function(Q){return Q?q:H})(U)}function V(U,H){if(!H&&U&&U.__esModule)return U;if(U===null||h(U)!=="object"&&typeof U!="function")return{default:U};var q=B(H);if(q&&q.has(U))return q.get(U);var te={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in U)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(U,Z)){var ae=Q?Object.getOwnPropertyDescriptor(U,Z):null;ae&&(ae.get||ae.set)?Object.defineProperty(te,Z,ae):te[Z]=U[Z]}return te.default=U,q&&q.set(U,te),te}function P(U){var H=L();return function(){var q=(0,p.default)(U),te;if(H){var Q=(0,p.default)(this).constructor;te=Reflect.construct(q,arguments,Q)}else te=q.apply(this,arguments);return(0,y.default)(this,te)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E=new g.Vector3,b=new g.Vector3,_=new g.Vector3;function x(U,H,q,te){return"".concat(U,"-").concat(H,"-").concat(q,"-").concat(te)}var T=function(U){(0,v.default)(q,U);var H=P(q);function q(te,Q,Z,ae,F){var W,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;return(0,R.default)(this,q),W=H.call(this,O,F),W.isEntwinePointTileNode=!0,W.depth=te,W.x=Q,W.y=Z,W.z=ae,W.id=x(te,Q,Z,ae),W.url="".concat(W.layer.source.url,"/ept-data/").concat(W.id,".").concat(W.layer.source.extension),W}return(0,M.default)(q,[{key:"createChildAABB",value:function(Q){var Z=Math.pow(2,Q.depth-this.depth);this.bbox.getSize(E).divideScalar(Z),Q.bbox.min.copy(this.bbox.min),b.copy(this).multiplyScalar(Z),_.subVectors(Q,b).multiply(E),Q.bbox.min.add(_),Q.bbox.max.copy(Q.bbox.min).add(E)}},{key:"octreeIsLoaded",get:function(){return this.numPoints>=0}},{key:"loadOctree",value:function(){var Q=this;return C.default.json("".concat(this.layer.source.url,"/ept-hierarchy/").concat(this.id,".json"),this.layer.source.networkOptions).then(function(Z){Q.numPoints=Z[Q.id];var ae=[];for(ae.push(Q);ae.length;){var F=ae.shift(),W=F.depth+1,O=F.x*2,X=F.y*2,G=F.z*2;F.findAndCreateChild(W,O,X,G,Z,ae),F.findAndCreateChild(W,O+1,X,G,Z,ae),F.findAndCreateChild(W,O,X+1,G,Z,ae),F.findAndCreateChild(W,O+1,X+1,G,Z,ae),F.findAndCreateChild(W,O,X,G+1,Z,ae),F.findAndCreateChild(W,O+1,X,G+1,Z,ae),F.findAndCreateChild(W,O,X+1,G+1,Z,ae),F.findAndCreateChild(W,O+1,X+1,G+1,Z,ae)}})}},{key:"findAndCreateChild",value:function(Q,Z,ae,F,W,O){var X=x(Q,Z,ae,F),G=W[X];if(typeof G=="number"){var j=new q(Q,Z,ae,F,this.layer,G);this.add(j),O.push(j)}}}]),q}(D.default),N=T;a.default=N}(Kw)),Kw}var DS;function II(){return DS||(DS=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Wi()),y=u(dn()),p=u(pn()),g=u(ln()),C=L(Dr()),D=u(FI()),B=u(rb()),V=u(ya());function P(U){if(typeof WeakMap!="function")return null;var H=new WeakMap,q=new WeakMap;return(P=function(Q){return Q?q:H})(U)}function L(U,H){if(!H&&U&&U.__esModule)return U;if(U===null||h(U)!=="object"&&typeof U!="function")return{default:U};var q=P(H);if(q&&q.has(U))return q.get(U);var te={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in U)if(Z!=="default"&&Object.prototype.hasOwnProperty.call(U,Z)){var ae=Q?Object.getOwnPropertyDescriptor(U,Z):null;ae&&(ae.get||ae.set)?Object.defineProperty(te,Z,ae):te[Z]=U[Z]}return te.default=U,q&&q.set(U,te),te}function E(U){var H=b();return function(){var q=(0,g.default)(U),te;if(H){var Q=(0,g.default)(this).constructor;te=Reflect.construct(q,arguments,Q)}else te=q.apply(this,arguments);return(0,p.default)(this,te)}}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _=new C.Mesh,x=new C.Box3;_.geometry.boundingBox=x;var T=function(U){(0,y.default)(q,U);var H=E(q);function q(te,Q){var Z;(0,R.default)(this,q),Z=H.call(this,te,Q),Z.isEntwinePointTileLayer=!0;var ae=Z.addInitializationStep();return Z.whenReady=Z.source.whenReady.then(function(){return Z.root=new D.default(0,0,0,0,(0,v.default)(Z),-1),Z.root.bbox.min.fromArray(Z.source.boundsConforming,0),Z.root.bbox.max.fromArray(Z.source.boundsConforming,3),Z.extent=V.default.fromBox3(Q.crs||"EPSG:4326",Z.root.bbox),Z.root.loadOctree().then(ae)}),Z}return(0,M.default)(q,[{key:"spacing",get:function(){return this.source.spacing}}]),q}(B.default),N=T;a.default=N}(Qw)),Qw}var eM={},NS;function kI(){return NS||(NS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(Cs()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(pl()),C=u(Bf()),D=u(ps());function B(E){var b=V();return function(){var _=(0,p.default)(E),x;if(b){var T=(0,p.default)(this).constructor;x=Reflect.construct(_,arguments,T)}else x=_.apply(this,arguments);return(0,y.default)(this,x)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P=function(E){(0,v.default)(_,E);var b=B(_);function _(x){var T;if((0,h.default)(this,_),x.parsedData&&(console.warn("FileSource parsedData parameter is deprecated, use features instead of."),x.features=x.features||x.parsedData),x.projection&&(console.warn("FileSource projection parameter is deprecated, use crs instead."),x.crs=x.crs||x.projection),!x.crs)if(x.features&&x.features.crs)x.crs=x.features.crs;else throw new Error("source.crs is required in FileSource");if(!x.url&&!x.fetchedData&&!x.features)throw new Error(`url, fetchedData and features are not set in
                FileSource; at least one needs to be present`);return x.url=x.url||"fake-file-url",T=b.call(this,x),T.isFileSource=!0,T.fetchedData=x.fetchedData,!T.fetchedData&&!x.features?T.whenReady=T.fetcher(T.urlFromExtent(),T.networkOptions).then(function(N){T.fetchedData=N}):x.features&&(T._featuresCaches[x.features.crs]=new C.default,T._featuresCaches[x.features.crs].setByArray(Promise.resolve(x.features),[0])),T.whenReady.then(function(){return T.fetchedData}),T.zoom={min:0,max:1/0},T}return(0,R.default)(_,[{key:"urlFromExtent",value:function(){return this.url}},{key:"onLayerAdded",value:function(T){var N=this;T.in=this,(0,M.default)((0,p.default)(_.prototype),"onLayerAdded",this).call(this,T);var U=this._featuresCaches[T.out.crs].getByArray([0]);U||(T.out.buildExtent=this.crs!="EPSG:4978",T.out.buildExtent&&(T.out.forcedExtentCrs=T.out.crs!="EPSG:4978"?T.out.crs:D.default.formatToEPSG(this.crs)),U=this.parser(this.fetchedData,T),this._featuresCaches[T.out.crs].setByArray(U,[0])),U.then(function(H){H.extent&&(N.extent=H.extent.clone(),N.extent.crs==H.crs&&N.extent.applyMatrix4(H.matrixWorld)),H.isFeatureCollection&&H.setParentStyle(T.out.style)})}},{key:"loadData",value:function(T,N){return this._featuresCaches[N.crs].getByArray([0])}},{key:"extentInsideLimit",value:function(T){return this.extent.intersectsExtent(T)}}]),_}(g.default),L=P;a.default=L}(eM)),eM}var tM={},rM={},BS;function nb(){return BS||(BS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(ya()),R=new h.default("EPSG:4326",[0,0,0,0]),M=0;function v(p){var g=/\$\{u:([\w-_.|]+)\}/.exec(p);if(!g)return p;var C=g[1].split("|");return p.replace(g[0],C[M++%C.length])}var y={xyz:function(p,g){return v(g.url.replace(/(\$\{z\}|%TILEMATRIX)/,g.tileMatrixCallback(p.zoom)).replace(/(\$\{y\}|%ROW)/,p.row).replace(/(\$\{x\}|%COL)/,p.col))},bbox:function(p,g){var C=g.crs=="EPSG:4326"?9:2;p.as(g.crs,R);var D=R.west.toFixed(C),B=R.south.toFixed(C),V=R.east.toFixed(C),P=R.north.toFixed(C),L=g.axisOrder||"wsen";return L=L.replace("w","".concat(D,",")).replace("s","".concat(B,",")).replace("e","".concat(V,",")).replace("n","".concat(P,",")).slice(0,-1),v(g.url.replace("%bbox",L))}};a.default=y}(rM)),rM}var US;function ib(){return US||(US=1,function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var R=u(Ir()),M=u(kr()),v=u(Cs()),y=u(dn()),p=u(pn()),g=u(ln()),C=u(pl()),D=u(nb()),B=L(ya()),V=u(ps());function P(N){if(typeof WeakMap!="function")return null;var U=new WeakMap,H=new WeakMap;return(P=function(te){return te?H:U})(N)}function L(N,U){if(!U&&N&&N.__esModule)return N;if(N===null||h(N)!=="object"&&typeof N!="function")return{default:N};var H=P(U);if(H&&H.has(N))return H.get(N);var q={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in N)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(N,Q)){var Z=te?Object.getOwnPropertyDescriptor(N,Q):null;Z&&(Z.get||Z.set)?Object.defineProperty(q,Q,Z):q[Q]=N[Q]}return q.default=N,H&&H.set(N,q),q}function E(N){var U=b();return function(){var H=(0,g.default)(N),q;if(U){var te=(0,g.default)(this).constructor;q=Reflect.construct(H,arguments,te)}else q=H.apply(this,arguments);return(0,p.default)(this,q)}}function b(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _=new B.default(V.default.tms_4326,0,0,0),x=function(N){(0,y.default)(H,N);var U=E(H);function H(q){var te;if((0,R.default)(this,H),!q.crs&&!q.projection)throw new Error("New TMSSource/WMTSSource: crs projection is required");if(q.format=q.format||"image/png",te=U.call(this,q),te.isTMSSource=!0,q.extent||(te.extent=B.globalExtentTMS.get(q.crs)),te.zoom=q.zoom,te.isInverted=q.isInverted||!1,te.url=q.url,te.crs=V.default.formatToTms(q.crs),te.tileMatrixSetLimits=q.tileMatrixSetLimits,te.extentSetlimits={},te.tileMatrixCallback=q.tileMatrixCallback||function(F){return F},!te.zoom)if(te.tileMatrixSetLimits){var Q=Object.keys(te.tileMatrixSetLimits),Z=Q.length,ae=Number(Q[Z-1]);te.zoom={min:ae-Z+1,max:ae}}else te.zoom={min:0,max:1/0};return te}return(0,M.default)(H,[{key:"urlFromExtent",value:function(te){return D.default.xyz(te,this)}},{key:"onLayerAdded",value:function(te){(0,v.default)((0,g.default)(H.prototype),"onLayerAdded",this).call(this,te);var Q=te.out.parent,Z=Q?Q.extent.crs:te.out.crs;if(this.tileMatrixSetLimits&&!this.extentSetlimits[Z]){this.extentSetlimits[Z]={},_.crs=this.crs;for(var ae=this.zoom.max;ae>=this.zoom.min;ae--){var F=this.tileMatrixSetLimits[ae],W=_.set(ae,F.minTileRow,F.minTileCol).as(Z),O=W.west,X=W.north,G=_.set(ae,F.maxTileRow,F.maxTileCol).as(Z),j=G.east,K=G.south;this.extentSetlimits[Z][ae]=new B.default(Z,O,j,K,X)}}}},{key:"extentInsideLimit",value:function(te,Q){return Q>=this.zoom.min&&Q<=this.zoom.max&&(this.extentSetlimits[te.crs]==null||this.extentSetlimits[te.crs][Q].intersectsExtent(te))}}]),H}(C.default),T=x;a.default=T}(tM)),tM}var nM={},zS;function DI(){return zS||(zS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(Cs()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(pl()),C=u(nb()),D=u(ps());function B(E){var b=V();return function(){var _=(0,p.default)(E),x;if(b){var T=(0,p.default)(this).constructor;x=Reflect.construct(_,arguments,T)}else x=_.apply(this,arguments);return(0,y.default)(this,x)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P=function(E){(0,v.default)(_,E);var b=B(_);function _(x){var T;if((0,h.default)(this,_),x.projection&&(console.warn("WFSSource projection parameter is deprecated, use crs instead."),x.crs=x.crs||x.projection),!x.typeName)throw new Error("source.typeName is required in wfs source.");if(!x.crs)throw new Error("source.crs is required in wfs source");x.format=x.format||"application/json",T=b.call(this,x),T.isWFSSource=!0,T.typeName=x.typeName,T.version=x.version||"2.0.2",T.url="".concat(x.url,"SERVICE=WFS&REQUEST=GetFeature&typeName=").concat(T.typeName,"&VERSION=").concat(T.version,"&SRSNAME=").concat(T.crs,"&outputFormat=").concat(T.format,"&BBOX=%bbox,").concat(T.crs),T.zoom={min:0,max:1/0},T.vendorSpecific=x.vendorSpecific;for(var N in T.vendorSpecific)Object.prototype.hasOwnProperty.call(T.vendorSpecific,N)&&(T.url="".concat(T.url,"&").concat(N,"=").concat(T.vendorSpecific[N]));return T}return(0,R.default)(_,[{key:"handlingError",value:function(T){var N=this;return T.response&&T.response.status==400?T.response.text().then(function(U){var H="".concat(N.url,"SERVICE=WFS&REQUEST=GetCapabilities&VERSION=").concat(N.version),q=new DOMParser().parseFromString(U,"application/xml"),te=q.querySelector("Exception"),Q=te.getAttribute("exceptionCode"),Z=te.querySelector("ExceptionText").textContent;console.error("Source ".concat(N.typeName,': bad request when fetching data. Server says: "').concat(Q,": ").concat(Z,`". 
Reviewing `).concat(H," may help."),T)}):(0,M.default)((0,p.default)(_.prototype),"handlingError",this).call(this,T)}},{key:"requestToKey",value:function(T){return D.default.isTms(T.crs)?(0,M.default)((0,p.default)(_.prototype),"requestToKey",this).call(this,T):[T.zoom,T.south,T.west]}},{key:"urlFromExtent",value:function(T){return C.default.bbox(T,this)}},{key:"extentInsideLimit",value:function(T){return this.extent.intersectsExtent(T)}}]),_}(g.default),L=P;a.default=L}(nM)),nM}var iM={},GS;function NI(){return GS||(GS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(pl()),g=u(nb());function C(P){var L=D();return function(){var E=(0,y.default)(P),b;if(L){var _=(0,y.default)(this).constructor;b=Reflect.construct(E,arguments,_)}else b=E.apply(this,arguments);return(0,v.default)(this,b)}}function D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var B=function(P){(0,M.default)(E,P);var L=C(E);function E(b){var _;if((0,h.default)(this,E),!b.name)throw new Error("source.name is required.");if(!b.extent)throw new Error("source.extent is required");if(!b.crs&&!b.projection)throw new Error("source.crs is required");b.format=b.format||"image/png",_=L.call(this,b),_.isWMSSource=!0,_.name=b.name,_.zoom={min:0,max:1/0},_.style=b.style||"",_.width=b.width||b.height||256,_.height=b.height||b.width||256,_.version=b.version||"1.3.0",_.transparent=b.transparent||!1,b.axisOrder||(_.crs=="EPSG:4326"?_.axisOrder=_.version==="1.1.0"?"wsen":"swne":_.axisOrder="wsen");var x=_.version==="1.3.0"?"CRS":"SRS";_.url="".concat(b.url,"?SERVICE=WMS&REQUEST=GetMap&LAYERS=").concat(_.name,"&VERSION=").concat(_.version,"&STYLES=").concat(_.style,"&FORMAT=").concat(_.format,"&TRANSPARENT=").concat(_.transparent,"&BBOX=%bbox&").concat(x,"=").concat(_.crs,"&WIDTH=").concat(_.width,"&HEIGHT=").concat(_.height),_.vendorSpecific=b.vendorSpecific;for(var T in _.vendorSpecific)Object.prototype.hasOwnProperty.call(_.vendorSpecific,T)&&(_.url="".concat(_.url,"&").concat(T,"=").concat(_.vendorSpecific[T]));return _}return(0,R.default)(E,[{key:"urlFromExtent",value:function(_){return g.default.bbox(_,this)}},{key:"extentInsideLimit",value:function(_){return this.extent.intersectsExtent(_)}}]),E}(p.default),V=B;a.default=V}(iM)),iM}var aM={},VS;function BI(){return VS||(VS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(kr()),R=u(Ir()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(ib());function g(V){var P=C();return function(){var L=(0,y.default)(V),E;if(P){var b=(0,y.default)(this).constructor;E=Reflect.construct(L,arguments,b)}else E=L.apply(this,arguments);return(0,v.default)(this,E)}}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var D=function(V){(0,M.default)(L,V);var P=g(L);function L(E){var b;if((0,R.default)(this,L),!E.name)throw new Error("New WMTSSource: name is required");return b=P.call(this,E),b.isWMTSSource=!0,b.url="".concat(b.url)+"?LAYER=".concat(E.name)+"&FORMAT=".concat(b.format)+"&SERVICE=WMTS"+"&VERSION=".concat(E.version||"1.0.0")+"&REQUEST=GetTile"+"&STYLE=".concat(E.style||"normal")+"&TILEMATRIXSET=".concat(E.tileMatrixSet)+"&TILEMATRIX=%TILEMATRIX&TILEROW=%ROW&TILECOL=%COL",b}return(0,h.default)(L)}(p.default),B=D;a.default=B}(aM)),aM}var sM={},oM={},WS;function UI(){return WS||(WS=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var u=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/,h={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null};function R(B){var V=B.params.length?"?".concat(B.params.join("&")):"";return"".concat(B.protocol,"://").concat(B.authority).concat(B.path).concat(V)}function M(B,V){var P=y(h.API_URL);if(B.protocol=P.protocol,B.authority=P.authority,B.protocol==="http"){var L=B.params.indexOf("secure");L>=0&&B.params.splice(L,1)}if(P.path!=="/"&&(B.path="".concat(P.path).concat(B.path)),V=V||h.ACCESS_TOKEN,!V)throw new Error("An API access token is required");if(V[0]==="s")throw new Error("Use a public access token (pk.*), not a secret access token (sk.*).");return B.params=B.params.filter(function(E){return E.indexOf("access_token")===-1}),B.params.push("access_token=".concat(V)),R(B)}function v(B){return B.indexOf("mapbox:")===0}function y(B){var V=B.match(u);if(!V)throw new Error("Unable to parse URL object");return{protocol:V[1],authority:V[2],path:V[3]||"/",params:V[4]?V[4].split("&"):[]}}function p(B,V,P,L){var E=y(B);return v(B)?(E.path="/styles/v1".concat(E.path,"/sprite").concat(V).concat(P),M(E,L)):(E.path+="".concat(V).concat(P),R(E))}function g(B,V){if(!v(B))return B;var P=y(B);return P.path="/v4/".concat(P.authority,".json"),P.params.push("secure"),M(P,V)}function C(B,V){if(!v(B))return B;var P=y(B);return P.path="/styles/v1".concat(P.path),M(P,V)}var D={normalizeStyleURL:C,normalizeSourceURL:g,normalizeSpriteURL:p};a.default=D}(oM)),oM}var HS;function zI(){return HS||(HS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(Cs()),v=u(dn()),y=u(pn()),p=u(ln()),g=$R(),C=u(I0()),D=u(ib()),B=u(dl()),V=u(UI());function P(x){var T=L();return function(){var N=(0,p.default)(x),U;if(T){var H=(0,p.default)(this).constructor;U=Reflect.construct(N,arguments,H)}else U=N.apply(this,arguments);return(0,y.default)(this,U)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function E(x){return x.replace(/\{/g,"${")}var b=function(x){(0,v.default)(N,x);var T=P(N);function N(U){var H;(0,h.default)(this,N),U.format="application/x-protobuf;type=mapbox-vector",U.crs="EPSG:3857",U.isInverted=!0,U.url=U.url||".",H=T.call(this,U);var q=U.filter||function(){return!0};H.layers={},H.styles={};var te;if(H.accessToken=U.accessToken,U.style)if(typeof U.style=="string"){var Q=V.default.normalizeStyleURL(U.style,H.accessToken);te=B.default.json(Q,H.networkOptions)}else te=Promise.resolve(U.style);else throw new Error("New VectorTilesSource: style is required");return H.whenReady=te.then(function(Z){H.jsonStyle=Z;var ae=U.sprite||Z.sprite;if(ae){var F=V.default.normalizeSpriteURL(ae,"",".json",H.accessToken);return B.default.json(F,H.networkOptions).then(function(W){H.sprites=W;var O=V.default.normalizeSpriteURL(ae,"",".png",H.accessToken);return B.default.texture(O,H.networkOptions).then(function(X){return H.sprites.img=X.image,Z})})}return Z}).then(function(Z){var ae=Object.keys(Z.sources)[0],F=Z.sources[ae];if(Z.layers.forEach(function(O,X){if(O.sourceUid=H.uid,O.type==="background")H.backgroundLayer=O;else if(q(O)){var G=new C.default().setFromVectorTileLayer(O,H.sprites,X,H.symbolToCircle);G.zoom.min=O.minzoom||0,G.zoom.max=O.maxzoom||24,H.styles[O.id]=G,H.layers[O["source-layer"]]||(H.layers[O["source-layer"]]=[]),H.layers[O["source-layer"]].push({id:O.id,order:X,filterExpression:(0,g.featureFilter)(O.filter),zoom:G.zoom})}}),H.url==".")if(F.url){var W=V.default.normalizeSourceURL(F.url,H.accessToken);return B.default.json(W,H.networkOptions).then(function(O){O.tiles[0]&&(H.url=E(O.tiles[0]))})}else F.tiles[0]&&(H.url=E(F.tiles[0]))}),H}return(0,R.default)(N,[{key:"onLayerAdded",value:function(H){var q=this;if((0,M.default)((0,p.default)(N.prototype),"onLayerAdded",this).call(this,H),H.out.style){H.out.isFeatureGeometryLayer&&H.out.accurate&&(console.warn("With VectorTilesSource and FeatureGeometryLayer, the accurate option is always false"),H.out.accurate=!1);var te=Object.keys(this.styles);te.forEach(function(Q){q.styles[Q].parent=H.out.style})}}}]),N}(D.default),_=b;a.default=_}(sM)),sM}var uM={},qS;function GI(){return qS||(qS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(pl()),g=u(dl());function C(P){var L=D();return function(){var E=(0,y.default)(P),b;if(L){var _=(0,y.default)(this).constructor;b=Reflect.construct(E,arguments,_)}else b=E.apply(this,arguments);return(0,v.default)(this,b)}}function D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var B=function(P){(0,M.default)(E,P);var L=C(E);function E(b){var _;(0,h.default)(this,E),b.format=b.format||"json",_=L.call(this,b),_.isOrientedImageSource=!0;var x=[];return x.push(b.orientationsUrl?g.default.json(b.orientationsUrl,_.networkOptions):Promise.resolve()),x.push(b.calibrationUrl?g.default.json(b.calibrationUrl,_.networkOptions):Promise.resolve()),_.whenReady=Promise.all(x).then(function(T){return{orientation:T[0],calibration:T[1]}}),_}return(0,R.default)(E,[{key:"urlFromExtent",value:function(_){return this.imageUrl(_.cameraId,_.panoId)}},{key:"requestToKey",value:function(_){return[_.cameraId,_.panoId]}},{key:"imageUrl",value:function(_,x){return this.url.replace("{cameraId}",_).replace("{panoId}",x)}}]),E}(p.default),V=B;a.default=V}(uM)),uM}var lM={},cM={},XS;function GC(){return XS||(XS=1,function(a){var u=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=M(Dr());function R(P){if(typeof WeakMap!="function")return null;var L=new WeakMap,E=new WeakMap;return(R=function(_){return _?E:L})(P)}function M(P,L){if(!L&&P&&P.__esModule)return P;if(P===null||u(P)!=="object"&&typeof P!="function")return{default:P};var E=R(L);if(E&&E.has(P))return E.get(P);var b={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in P)if(x!=="default"&&Object.prototype.hasOwnProperty.call(P,x)){var T=_?Object.getOwnPropertyDescriptor(P,x):null;T&&(T.get||T.set)?Object.defineProperty(b,x,T):b[x]=P[x]}return b.default=P,E&&E.set(P,b),b}function v(P,L){var E=typeof Symbol<"u"&&P[Symbol.iterator]||P["@@iterator"];if(!E){if(Array.isArray(P)||(E=y(P))||L&&P&&typeof P.length=="number"){E&&(P=E);var b=0,_=function(){};return{s:_,n:function(){return b>=P.length?{done:!0}:{done:!1,value:P[b++]}},e:function(H){throw H},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var x=!0,T=!1,N;return{s:function(){E=E.call(P)},n:function(){var H=E.next();return x=H.done,H},e:function(H){T=!0,N=H},f:function(){try{!x&&E.return!=null&&E.return()}finally{if(T)throw N}}}}function y(P,L){if(!!P){if(typeof P=="string")return p(P,L);var E=Object.prototype.toString.call(P).slice(8,-1);if(E==="Object"&&P.constructor&&(E=P.constructor.name),E==="Map"||E==="Set")return Array.from(P);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return p(P,L)}}function p(P,L){(L==null||L>P.length)&&(L=P.length);for(var E=0,b=new Array(L);E<L;E++)b[E]=P[E];return b}for(var g={POSITION_CARTESIAN:{numElements:3,arrayType:Float32Array,attributeName:"position"},COLOR_PACKED:{numElements:4,arrayType:Uint8Array,attributeName:"color",normalized:!0},INTENSITY:{numElements:1,numByte:2,arrayType:Uint16Array,attributeName:"intensity",normalized:!0},CLASSIFICATION:{numElements:1,arrayType:Uint8Array,attributeName:"classification",normalized:!0},NORMAL_SPHEREMAPPED:{numElements:2,arrayType:Uint8Array,attributeName:"sphereMappedNormal"},NORMAL_OCT16:{numElements:2,arrayType:Uint8Array,attributeName:"oct16Normal"},NORMAL:{numElements:3,arrayType:Float32Array,attributeName:"normal"}},C=function(){var P=B[D],L=g[P];L.potreeName=P,L.numByte=L.numByte||L.arrayType.BYTES_PER_ELEMENT,L.byteSize=L.numElements*L.numByte,L.normalized=L.normalized||!1;var E="getUint".concat(L.numByte*8);L.getValue=L.numByte===1?function(b,_){return b[E](_)}:function(b,_){return b[E](_,!0)}},D=0,B=Object.keys(g);D<B.length;D++)C();var V={parse:function(P,L){if(!P)throw new Error("No array buffer provided.");var E=new DataView(P),b=0,_=v(L.in.pointAttributes),x;try{for(_.s();!(x=_.n()).done;){var T=x.value;b+=g[T].byteSize}}catch(G){_.e(G)}finally{_.f()}var N=Math.floor(P.byteLength/b),U=new h.BufferGeometry,H=0,q=0,te=v(L.in.pointAttributes),Q;try{for(te.s();!(Q=te.n()).done;){for(var Z=Q.value,ae=g[Z],F=ae.numElements*N,W=new ae.arrayType(F),O=0;O<F;O+=ae.numElements){for(var X=0;X<ae.numElements;X++)W[O+X]=ae.getValue(E,q+X*ae.numByte);q+=b}H+=ae.byteSize,q=H,U.setAttribute(ae.attributeName,new h.BufferAttribute(W,ae.numElements,ae.normalized))}}catch(G){te.e(G)}finally{te.f()}return U.computeBoundingBox(),Promise.resolve(U)}};a.default=V}(cM)),cM}var fM={},ZS;function VI(){return ZS||(ZS=1,function(a){var u=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=M(Dr());function R(y){if(typeof WeakMap!="function")return null;var p=new WeakMap,g=new WeakMap;return(R=function(D){return D?g:p})(y)}function M(y,p){if(!p&&y&&y.__esModule)return y;if(y===null||u(y)!=="object"&&typeof y!="function")return{default:y};var g=R(p);if(g&&g.has(y))return g.get(y);var C={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in y)if(B!=="default"&&Object.prototype.hasOwnProperty.call(y,B)){var V=D?Object.getOwnPropertyDescriptor(y,B):null;V&&(V.get||V.set)?Object.defineProperty(C,B,V):C[B]=y[B]}return C.default=y,g&&g.set(y,C),C}var v={parse:function(y){if(!y)throw new Error("No array buffer provided.");var p=new DataView(y,0,6*4),g=new h.Vector3(p.getFloat32(0,!0),p.getFloat32(4,!0),p.getFloat32(8,!0)),C=new h.Vector3(p.getFloat32(12,!0),p.getFloat32(16,!0),p.getFloat32(20,!0)),D=new h.Box3(g,C),B=Math.floor((y.byteLength-24)/16),V=new Float32Array(y,24,3*B),P=new Uint8Array(y,24+3*4*B,4*B),L=new h.BufferGeometry;return L.setAttribute("position",new h.BufferAttribute(V,3)),L.setAttribute("color",new h.BufferAttribute(P,4,!0)),L.boundingBox=D,Promise.resolve(L)}};a.default=v}(fM)),fM}var jS;function WI(){return jS||(jS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(kr()),R=u(Ir()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(pl()),g=u(dl()),C=u(GC()),D=u(VI());function B(E){var b=V();return function(){var _=(0,y.default)(E),x;if(b){var T=(0,y.default)(this).constructor;x=Reflect.construct(_,arguments,T)}else x=_.apply(this,arguments);return(0,v.default)(this,x)}}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var P=function(E){(0,M.default)(_,E);var b=B(_);function _(x){var T;if((0,R.default)(this,_),!x.file)throw new Error("New PotreeSource: file is required");return T=b.call(this,x),T.file=x.file,T.fetcher=g.default.arrayBuffer,T.extensionOctree="hrc",T.whenReady=(x.cloud?Promise.resolve(x.cloud):g.default.json("".concat(T.url,"/").concat(T.file),T.networkOptions)).then(function(N){return T.pointAttributes=N.pointAttributes,T.baseurl="".concat(T.url,"/").concat(N.octreeDir,"/r"),T.extension=N.pointAttributes==="CIN"?"cin":"bin",T.parse=T.extension==="cin"?D.default.parse:C.default.parse,N}),T}return(0,h.default)(_)}(p.default),L=P;a.default=L}(lM)),lM}var hM={},YS;function HI(){return YS||(YS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(kr()),R=u(Ir()),M=u(dn()),v=u(pn()),y=u(ln()),p=u(pl()),g=u(dl());function C(P){var L=D();return function(){var E=(0,y.default)(P),b;if(L){var _=(0,y.default)(this).constructor;b=Reflect.construct(E,arguments,_)}else b=E.apply(this,arguments);return(0,v.default)(this,b)}}function D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var B=function(P){(0,M.default)(E,P);var L=C(E);function E(b){var _;return(0,R.default)(this,E),_=L.call(this,b),_.baseUrl=_.url.slice(0,_.url.lastIndexOf("/")+1),_.whenReady=g.default.json(_.url,_.networkOptions),_}return(0,h.default)(E)}(p.default),V=B;a.default=V}(hM)),hM}var dM={},pM={};const qI="3.2.9",XI={las:{shape:"mesh",fp64:!1,skip:1,colorDepth:8}},VC={name:"LAS",id:"las",module:"las",version:qI,worker:!0,extensions:["las","laz"],mimeTypes:["application/octet-stream"],text:!0,binary:!0,tests:["LAS"],options:XI};function Ei(a,u,h){return u in a?Object.defineProperty(a,u,{value:h,enumerable:!0,configurable:!0,writable:!0}):a[u]=h,a}function ZI(a){let u=1/0,h=1/0,R=1/0,M=-1/0,v=-1/0,y=-1/0;const p=a.POSITION?a.POSITION.value:[],g=p&&p.length;for(let C=0;C<g;C+=3){const D=p[C],B=p[C+1],V=p[C+2];u=D<u?D:u,h=B<h?B:h,R=V<R?V:R,M=D>M?D:M,v=B>v?B:v,y=V>y?V:y}return[[u,h,R],[M,v,y]]}function jI(a,u){if(!a)throw new Error(u||"loader assertion failed.")}class Zh{constructor(u,h){Ei(this,"fields",void 0),Ei(this,"metadata",void 0),jI(Array.isArray(u)),YI(u),this.fields=u,this.metadata=h||new Map}compareTo(u){if(this.metadata!==u.metadata||this.fields.length!==u.fields.length)return!1;for(let h=0;h<this.fields.length;++h)if(!this.fields[h].compareTo(u.fields[h]))return!1;return!0}select(...u){const h=Object.create(null);for(const M of u)h[M]=!0;const R=this.fields.filter(M=>h[M.name]);return new Zh(R,this.metadata)}selectAt(...u){const h=u.map(R=>this.fields[R]).filter(Boolean);return new Zh(h,this.metadata)}assign(u){let h,R=this.metadata;if(u instanceof Zh){const y=u;h=y.fields,R=JS(JS(new Map,this.metadata),y.metadata)}else h=u;const M=Object.create(null);for(const y of this.fields)M[y.name]=y;for(const y of h)M[y.name]=y;const v=Object.values(M);return new Zh(v,R)}}function YI(a){const u={};for(const h of a)u[h.name]&&console.warn("Schema: duplicated field name",h.name,h),u[h.name]=!0}function JS(a,u){return new Map([...a||new Map,...u||new Map])}class Qy{constructor(u,h,R=!1,M=new Map){Ei(this,"name",void 0),Ei(this,"type",void 0),Ei(this,"nullable",void 0),Ei(this,"metadata",void 0),this.name=u,this.type=h,this.nullable=R,this.metadata=M}get typeId(){return this.type&&this.type.typeId}clone(){return new Qy(this.name,this.type,this.nullable,this.metadata)}compareTo(u){return this.name===u.name&&this.type===u.type&&this.nullable===u.nullable&&this.metadata===u.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let oa;(function(a){a[a.NONE=0]="NONE",a[a.Null=1]="Null",a[a.Int=2]="Int",a[a.Float=3]="Float",a[a.Binary=4]="Binary",a[a.Utf8=5]="Utf8",a[a.Bool=6]="Bool",a[a.Decimal=7]="Decimal",a[a.Date=8]="Date",a[a.Time=9]="Time",a[a.Timestamp=10]="Timestamp",a[a.Interval=11]="Interval",a[a.List=12]="List",a[a.Struct=13]="Struct",a[a.Union=14]="Union",a[a.FixedSizeBinary=15]="FixedSizeBinary",a[a.FixedSizeList=16]="FixedSizeList",a[a.Map=17]="Map",a[a.Dictionary=-1]="Dictionary",a[a.Int8=-2]="Int8",a[a.Int16=-3]="Int16",a[a.Int32=-4]="Int32",a[a.Int64=-5]="Int64",a[a.Uint8=-6]="Uint8",a[a.Uint16=-7]="Uint16",a[a.Uint32=-8]="Uint32",a[a.Uint64=-9]="Uint64",a[a.Float16=-10]="Float16",a[a.Float32=-11]="Float32",a[a.Float64=-12]="Float64",a[a.DateDay=-13]="DateDay",a[a.DateMillisecond=-14]="DateMillisecond",a[a.TimestampSecond=-15]="TimestampSecond",a[a.TimestampMillisecond=-16]="TimestampMillisecond",a[a.TimestampMicrosecond=-17]="TimestampMicrosecond",a[a.TimestampNanosecond=-18]="TimestampNanosecond",a[a.TimeSecond=-19]="TimeSecond",a[a.TimeMillisecond=-20]="TimeMillisecond",a[a.TimeMicrosecond=-21]="TimeMicrosecond",a[a.TimeNanosecond=-22]="TimeNanosecond",a[a.DenseUnion=-23]="DenseUnion",a[a.SparseUnion=-24]="SparseUnion",a[a.IntervalDayTime=-25]="IntervalDayTime",a[a.IntervalYearMonth=-26]="IntervalYearMonth"})(oa||(oa={}));let WC,HC,qC;class ab{static isNull(u){return u&&u.typeId===oa.Null}static isInt(u){return u&&u.typeId===oa.Int}static isFloat(u){return u&&u.typeId===oa.Float}static isBinary(u){return u&&u.typeId===oa.Binary}static isUtf8(u){return u&&u.typeId===oa.Utf8}static isBool(u){return u&&u.typeId===oa.Bool}static isDecimal(u){return u&&u.typeId===oa.Decimal}static isDate(u){return u&&u.typeId===oa.Date}static isTime(u){return u&&u.typeId===oa.Time}static isTimestamp(u){return u&&u.typeId===oa.Timestamp}static isInterval(u){return u&&u.typeId===oa.Interval}static isList(u){return u&&u.typeId===oa.List}static isStruct(u){return u&&u.typeId===oa.Struct}static isUnion(u){return u&&u.typeId===oa.Union}static isFixedSizeBinary(u){return u&&u.typeId===oa.FixedSizeBinary}static isFixedSizeList(u){return u&&u.typeId===oa.FixedSizeList}static isMap(u){return u&&u.typeId===oa.Map}static isDictionary(u){return u&&u.typeId===oa.Dictionary}get typeId(){return oa.NONE}compareTo(u){return this===u}}WC=Symbol.toStringTag;class N0 extends ab{constructor(u,h){super(),Ei(this,"isSigned",void 0),Ei(this,"bitWidth",void 0),this.isSigned=u,this.bitWidth=h}get typeId(){return oa.Int}get[WC](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class JI extends N0{constructor(){super(!0,8)}}class $I extends N0{constructor(){super(!0,16)}}class QI extends N0{constructor(){super(!0,32)}}class KI extends N0{constructor(){super(!1,8)}}class ek extends N0{constructor(){super(!1,16)}}class tk extends N0{constructor(){super(!1,32)}}const XC={HALF:16,SINGLE:32,DOUBLE:64};HC=Symbol.toStringTag;class ZC extends ab{constructor(u){super(),Ei(this,"precision",void 0),this.precision=u}get typeId(){return oa.Float}get[HC](){return"Float"}toString(){return"Float".concat(this.precision)}}class rk extends ZC{constructor(){super(XC.SINGLE)}}class nk extends ZC{constructor(){super(XC.DOUBLE)}}qC=Symbol.toStringTag;class ik extends ab{constructor(u,h){super(),Ei(this,"listSize",void 0),Ei(this,"children",void 0),this.listSize=u,this.children=[h]}get typeId(){return oa.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[qC](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function ak(a){switch(a.constructor){case Int8Array:return new JI;case Uint8Array:return new KI;case Int16Array:return new $I;case Uint16Array:return new ek;case Int32Array:return new QI;case Uint32Array:return new tk;case Float32Array:return new rk;case Float64Array:return new nk;default:throw new Error("array type not supported")}}function sk(a,u){const h=uk(a);return new Zh(h,u)}function ok(a,u,h){const R=ak(u.value),M=h||lk(u);return new Qy(a,new ik(u.size,new Qy("value",R)),!1,M)}function uk(a){const u=[];for(const h in a){const R=a[h];u.push(ok(h,R))}return u}function lk(a){const u=new Map;return"byteOffset"in a&&u.set("byteOffset",a.byteOffset.toString(10)),"byteStride"in a&&u.set("byteStride",a.byteStride.toString(10)),"normalized"in a&&u.set("normalized",a.normalized.toString()),u}function ck(){var a=typeof a<"u"?a:{},u={},h;for(h in a)a.hasOwnProperty(h)&&(u[h]=a[h]);var R=!1,M=!1,v=!1,y=!1;R=typeof window=="object",M=typeof importScripts=="function",v=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",y=!R&&!v&&!M;var p="";function g(Ye){return a.locateFile?a.locateFile(Ye,p):p+Ye}var C,D,B,V,P;v?(M?p=require("path").dirname(p)+"/":p=__dirname+"/",C=function(qe,yt){var ie=ja(qe);return ie?yt?ie:ie.toString():(V||(V=require("fs")),P||(P=require("path")),qe=P.normalize(qe),V.readFileSync(qe,yt?null:"utf8"))},B=function(qe){var yt=C(qe,!0);return yt.buffer||(yt=new Uint8Array(yt)),U(yt.buffer),yt},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),typeof NM<"u"&&(NM.exports=a),process.on("uncaughtException",function(Ye){if(!(Ye instanceof hd))throw Ye}),process.on("unhandledRejection",Ie),a.inspect=function(){return"[Emscripten Module object]"}):y?(typeof read<"u"&&(C=function(qe){var yt=ja(qe);return yt?Vs(yt):read(qe)}),B=function(qe){var yt;return yt=ja(qe),yt||(typeof readbuffer=="function"?new Uint8Array(readbuffer(qe)):(yt=read(qe,"binary"),U(typeof yt=="object"),yt))},typeof scriptArgs<"u"&&scriptArgs,typeof print<"u"&&(typeof console>"u"&&(console={}),console.log=print,console.warn=console.error=typeof printErr<"u"?printErr:print)):(R||M)&&(M?p=self.location.href:document.currentScript&&(p=document.currentScript.src),p.indexOf("blob:")!==0?p=p.substr(0,p.lastIndexOf("/")+1):p="",C=function(qe){try{var yt=new XMLHttpRequest;return yt.open("GET",qe,!1),yt.send(null),yt.responseText}catch(zt){var ie=ja(qe);if(ie)return Vs(ie);throw zt}},M&&(B=function(qe){try{var yt=new XMLHttpRequest;return yt.open("GET",qe,!1),yt.responseType="arraybuffer",yt.send(null),new Uint8Array(yt.response)}catch(zt){var ie=ja(qe);if(ie)return ie;throw zt}}),D=function(qe,yt,ie){var zt=new XMLHttpRequest;zt.open("GET",qe,!0),zt.responseType="arraybuffer",zt.onload=function(){if(zt.status==200||zt.status==0&&zt.response){yt(zt.response);return}var We=ja(qe);if(We){yt(We.buffer);return}ie()},zt.onerror=ie,zt.send(null)});var L=a.print||console.log.bind(console),E=a.printErr||console.warn.bind(console);for(h in u)u.hasOwnProperty(h)&&(a[h]=u[h]);u=null,a.arguments&&a.arguments,a.thisProgram&&a.thisProgram,a.quit&&a.quit,new Array(0);var b=0,_=function(Ye){b=Ye},x=function(){return b},T=8;a.wasmBinary&&a.wasmBinary,a.noExitRuntime&&a.noExitRuntime;var N=!1;function U(Ye,qe){Ye||Ie("Assertion failed: "+qe)}var H=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function q(Ye,qe,yt){for(var ie=qe+yt,zt=qe;Ye[zt]&&!(zt>=ie);)++zt;if(zt-qe>16&&Ye.subarray&&H)return H.decode(Ye.subarray(qe,zt));for(var r="";qe<zt;){var We=Ye[qe++];if(!(We&128)){r+=String.fromCharCode(We);continue}var Yt=Ye[qe++]&63;if((We&224)==192){r+=String.fromCharCode((We&31)<<6|Yt);continue}var Er=Ye[qe++]&63;if((We&240)==224?We=(We&15)<<12|Yt<<6|Er:We=(We&7)<<18|Yt<<12|Er<<6|Ye[qe++]&63,We<65536)r+=String.fromCharCode(We);else{var xr=We-65536;r+=String.fromCharCode(55296|xr>>10,56320|xr&1023)}}return r}function te(Ye,qe){return Ye?q(ue,Ye,qe):""}function Q(Ye,qe,yt,ie){if(!(ie>0))return 0;for(var zt=yt,r=yt+ie-1,We=0;We<Ye.length;++We){var Yt=Ye.charCodeAt(We);if(Yt>=55296&&Yt<=57343){var Er=Ye.charCodeAt(++We);Yt=65536+((Yt&1023)<<10)|Er&1023}if(Yt<=127){if(yt>=r)break;qe[yt++]=Yt}else if(Yt<=2047){if(yt+1>=r)break;qe[yt++]=192|Yt>>6,qe[yt++]=128|Yt&63}else if(Yt<=65535){if(yt+2>=r)break;qe[yt++]=224|Yt>>12,qe[yt++]=128|Yt>>6&63,qe[yt++]=128|Yt&63}else{if(yt+3>=r)break;qe[yt++]=240|Yt>>18,qe[yt++]=128|Yt>>12&63,qe[yt++]=128|Yt>>6&63,qe[yt++]=128|Yt&63}}return qe[yt]=0,yt-zt}function Z(Ye,qe,yt){return Q(Ye,ue,qe,yt)}function ae(Ye){for(var qe=0,yt=0;yt<Ye.length;++yt){var ie=Ye.charCodeAt(yt);ie>=55296&&ie<=57343&&(ie=65536+((ie&1023)<<10)|Ye.charCodeAt(++yt)&1023),ie<=127?++qe:ie<=2047?qe+=2:ie<=65535?qe+=3:qe+=4}return qe}var F=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function W(Ye,qe){for(var yt=Ye,ie=yt>>1,zt=ie+qe/2;!(ie>=zt)&&pe[ie];)++ie;if(yt=ie<<1,yt-Ye>32&&F)return F.decode(ue.subarray(Ye,yt));for(var r=0,We="";;){var Yt=Y[Ye+r*2>>1];if(Yt==0||r==qe/2)return We;++r,We+=String.fromCharCode(Yt)}}function O(Ye,qe,yt){if(yt===void 0&&(yt=2147483647),yt<2)return 0;yt-=2;for(var ie=qe,zt=yt<Ye.length*2?yt/2:Ye.length,r=0;r<zt;++r){var We=Ye.charCodeAt(r);Y[qe>>1]=We,qe+=2}return Y[qe>>1]=0,qe-ie}function X(Ye){return Ye.length*2}function G(Ye,qe){for(var yt=0,ie="";!(yt>=qe/4);){var zt=Ee[Ye+yt*4>>2];if(zt==0)break;if(++yt,zt>=65536){var r=zt-65536;ie+=String.fromCharCode(55296|r>>10,56320|r&1023)}else ie+=String.fromCharCode(zt)}return ie}function j(Ye,qe,yt){if(yt===void 0&&(yt=2147483647),yt<4)return 0;for(var ie=qe,zt=ie+yt-4,r=0;r<Ye.length;++r){var We=Ye.charCodeAt(r);if(We>=55296&&We<=57343){var Yt=Ye.charCodeAt(++r);We=65536+((We&1023)<<10)|Yt&1023}if(Ee[qe>>2]=We,qe+=4,qe+4>zt)break}return Ee[qe>>2]=0,qe-ie}function K(Ye){for(var qe=0,yt=0;yt<Ye.length;++yt){var ie=Ye.charCodeAt(yt);ie>=55296&&ie<=57343&&++yt,qe+=4}return qe}var ce,se,ue,Y,pe,Ee,Fe,$e,pt;function Ue(Ye){ce=Ye,a.HEAP8=se=new Int8Array(Ye),a.HEAP16=Y=new Int16Array(Ye),a.HEAP32=Ee=new Int32Array(Ye),a.HEAPU8=ue=new Uint8Array(Ye),a.HEAPU16=pe=new Uint16Array(Ye),a.HEAPU32=Fe=new Uint32Array(Ye),a.HEAPF32=$e=new Float32Array(Ye),a.HEAPF64=pt=new Float64Array(Ye)}var Je=5265264,et=22176,ze=a.INITIAL_MEMORY||167772160;a.buffer?ce=a.buffer:ce=new ArrayBuffer(ze),ze=ce.byteLength,Ue(ce),Ee[et>>2]=Je;function Xe(Ye){for(;Ye.length>0;){var qe=Ye.shift();if(typeof qe=="function"){qe(a);continue}var yt=qe.func;typeof yt=="number"?qe.arg===void 0?a.dynCall_v(yt):a.dynCall_vi(yt,qe.arg):yt(qe.arg===void 0?null:qe.arg)}}var tt=[],ye=[],Ze=[],Ge=[];function Ae(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)be(a.preRun.shift());Xe(tt)}function Se(){Xe(ye)}function Te(){Xe(Ze)}function me(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)we(a.postRun.shift());Xe(Ge)}function be(Ye){tt.unshift(Ye)}function we(Ye){Ge.unshift(Ye)}var je=0,lt=null;function ot(Ye){je++,a.monitorRunDependencies&&a.monitorRunDependencies(je)}function bt(Ye){if(je--,a.monitorRunDependencies&&a.monitorRunDependencies(je),je==0&&lt){var qe=lt;lt=null,qe()}}a.preloadedImages={},a.preloadedAudios={};function Ie(Ye){throw a.onAbort&&a.onAbort(Ye),Ye+="",L(Ye),E(Ye),N=!0,Ye="abort("+Ye+"). Build with -s ASSERTIONS=1 for more info.",Ye}var re=null;function oe(Ye,qe){return String.prototype.startsWith?Ye.startsWith(qe):Ye.indexOf(qe)===0}var _e="data:application/octet-stream;base64,";function Re(Ye){return oe(Ye,_e)}ye.push({func:function(){Wf()}}),re="data:application/octet-stream;base64,AAAAAAAAAAAPDg0MCwoJCA4AAQMGCgoJDQECBAcLCwoMAwQFCAwMCwsGBwgJDQ0MCgoLDA0ODg0JCgsMDQ4PDggJCgsMDQ4PAAECAwQFBgcBAAECAwQFBgIBAAECAwQFAwIBAAECAwQEAwIBAAECAwUEAwIBAAECBgUEAwIBAAEHBgUEAwIBAMgPAAAoDQAAEBAAACAQAADIDwAAUA0AABAQAAAgEAAAEQAKABEREQAAAAAFAAAAAAAACQAAAAALAAAAAAAAAAARAA8KERERAwoHAAEACQsLAAAJBgsAAAsABhEAAAAREREAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAEQAKChEREQAKAAACAAkLAAAACQALAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAADAAAAAAJDAAAAAAADAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAANAAAABA0AAAAACQ4AAAAAAA4AAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAADwAAAAAPAAAAAAkQAAAAAAAQAAAQAAASAAAAEhISAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAASEhIAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAKAAAAAAoAAAAACQsAAAAAAAsAAAsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAMAAAAAAkMAAAAAAAMAAAMAAAwMTIzNDU2Nzg5QUJDREVGGRJEOwI/LEcUPTMwChsGRktFNw9JDo4XA0AdPGkrNh9KLRwBICUpIQgMFRYiLhA4Pgs0MRhkdHV2L0EJfzkRI0MyQomKiwUEJignDSoeNYwHGkiTE5SVAAAAAAAAAAAASWxsZWdhbCBieXRlIHNlcXVlbmNlAERvbWFpbiBlcnJvcgBSZXN1bHQgbm90IHJlcHJlc2VudGFibGUATm90IGEgdHR5AFBlcm1pc3Npb24gZGVuaWVkAE9wZXJhdGlvbiBub3QgcGVybWl0dGVkAE5vIHN1Y2ggZmlsZSBvciBkaXJlY3RvcnkATm8gc3VjaCBwcm9jZXNzAEZpbGUgZXhpc3RzAFZhbHVlIHRvbyBsYXJnZSBmb3IgZGF0YSB0eXBlAE5vIHNwYWNlIGxlZnQgb24gZGV2aWNlAE91dCBvZiBtZW1vcnkAUmVzb3VyY2UgYnVzeQBJbnRlcnJ1cHRlZCBzeXN0ZW0gY2FsbABSZXNvdXJjZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZQBJbnZhbGlkIHNlZWsAQ3Jvc3MtZGV2aWNlIGxpbmsAUmVhZC1vbmx5IGZpbGUgc3lzdGVtAERpcmVjdG9yeSBub3QgZW1wdHkAQ29ubmVjdGlvbiByZXNldCBieSBwZWVyAE9wZXJhdGlvbiB0aW1lZCBvdXQAQ29ubmVjdGlvbiByZWZ1c2VkAEhvc3QgaXMgZG93bgBIb3N0IGlzIHVucmVhY2hhYmxlAEFkZHJlc3MgaW4gdXNlAEJyb2tlbiBwaXBlAEkvTyBlcnJvcgBObyBzdWNoIGRldmljZSBvciBhZGRyZXNzAEJsb2NrIGRldmljZSByZXF1aXJlZABObyBzdWNoIGRldmljZQBOb3QgYSBkaXJlY3RvcnkASXMgYSBkaXJlY3RvcnkAVGV4dCBmaWxlIGJ1c3kARXhlYyBmb3JtYXQgZXJyb3IASW52YWxpZCBhcmd1bWVudABBcmd1bWVudCBsaXN0IHRvbyBsb25nAFN5bWJvbGljIGxpbmsgbG9vcABGaWxlbmFtZSB0b28gbG9uZwBUb28gbWFueSBvcGVuIGZpbGVzIGluIHN5c3RlbQBObyBmaWxlIGRlc2NyaXB0b3JzIGF2YWlsYWJsZQBCYWQgZmlsZSBkZXNjcmlwdG9yAE5vIGNoaWxkIHByb2Nlc3MAQmFkIGFkZHJlc3MARmlsZSB0b28gbGFyZ2UAVG9vIG1hbnkgbGlua3MATm8gbG9ja3MgYXZhaWxhYmxlAFJlc291cmNlIGRlYWRsb2NrIHdvdWxkIG9jY3VyAFN0YXRlIG5vdCByZWNvdmVyYWJsZQBQcmV2aW91cyBvd25lciBkaWVkAE9wZXJhdGlvbiBjYW5jZWxlZABGdW5jdGlvbiBub3QgaW1wbGVtZW50ZWQATm8gbWVzc2FnZSBvZiBkZXNpcmVkIHR5cGUASWRlbnRpZmllciByZW1vdmVkAERldmljZSBub3QgYSBzdHJlYW0ATm8gZGF0YSBhdmFpbGFibGUARGV2aWNlIHRpbWVvdXQAT3V0IG9mIHN0cmVhbXMgcmVzb3VyY2VzAExpbmsgaGFzIGJlZW4gc2V2ZXJlZABQcm90b2NvbCBlcnJvcgBCYWQgbWVzc2FnZQBGaWxlIGRlc2NyaXB0b3IgaW4gYmFkIHN0YXRlAE5vdCBhIHNvY2tldABEZXN0aW5hdGlvbiBhZGRyZXNzIHJlcXVpcmVkAE1lc3NhZ2UgdG9vIGxhcmdlAFByb3RvY29sIHdyb25nIHR5cGUgZm9yIHNvY2tldABQcm90b2NvbCBub3QgYXZhaWxhYmxlAFByb3RvY29sIG5vdCBzdXBwb3J0ZWQAU29ja2V0IHR5cGUgbm90IHN1cHBvcnRlZABOb3Qgc3VwcG9ydGVkAFByb3RvY29sIGZhbWlseSBub3Qgc3VwcG9ydGVkAEFkZHJlc3MgZmFtaWx5IG5vdCBzdXBwb3J0ZWQgYnkgcHJvdG9jb2wAQWRkcmVzcyBub3QgYXZhaWxhYmxlAE5ldHdvcmsgaXMgZG93bgBOZXR3b3JrIHVucmVhY2hhYmxlAENvbm5lY3Rpb24gcmVzZXQgYnkgbmV0d29yawBDb25uZWN0aW9uIGFib3J0ZWQATm8gYnVmZmVyIHNwYWNlIGF2YWlsYWJsZQBTb2NrZXQgaXMgY29ubmVjdGVkAFNvY2tldCBub3QgY29ubmVjdGVkAENhbm5vdCBzZW5kIGFmdGVyIHNvY2tldCBzaHV0ZG93bgBPcGVyYXRpb24gYWxyZWFkeSBpbiBwcm9ncmVzcwBPcGVyYXRpb24gaW4gcHJvZ3Jlc3MAU3RhbGUgZmlsZSBoYW5kbGUAUmVtb3RlIEkvTyBlcnJvcgBRdW90YSBleGNlZWRlZABObyBtZWRpdW0gZm91bmQAV3JvbmcgbWVkaXVtIHR5cGUATm8gZXJyb3IgaW5mb3JtYXRpb24AAAAAAADgFgAAmRgAAGAQAAAAAAAA4BYAAEIZAABgEAAAAAAAAOAWAAAqGgAASA8AAAAAAAC4FgAANBsAAOAWAACfGgAAMAoAAAAAAADgFgAAaRsAAEgPAAAAAAAA4BYAAIobAABIDwAAAAAAALgWAAAPHAAA4BYAAHwcAABIDwAAAAAAAOAWAACVHAAASA8AAAAAAADgFgAAHh0AAEgPAAAAAAAA4BYAAHcdAABIDwAAAAAAAOAWAACQHQAASA8AAAAAAADgFgAAQh4AAEgPAAAAAAAA4BYAAIceAABgEAAAAAAAAOAWAACkHwAASA8AAAAAAAC4FgAAZyAAAOAWAADkHwAA8AoAAAAAAADgFgAAjyAAAGAQAAAAAAAAuBYAAMMiAADgFgAAAiIAABgLAAAAAAAA4BYAAOEiAABgEAAAAAAAAOAWAADQJAAAGAsAAAAAAADgFgAAkSUAAGAQAAAAAAAA4BYAAIAnAAAYCwAAAAAAAOAWAAA9KAAAYBAAAAAAAADgFgAAJCoAABgLAAAAAAAA4BYAAOkqAABgEAAAAAAAAOAWAADgLAAA8AoAAAAAAADgFgAAui0AAGAQAAAAAAAA4BYAANsvAADwCgAAAAAAAOAWAADTMAAAYBAAAAAAAADgFgAAMDMAAPAKAAAAAAAA4BYAACQ0AABgEAAAAAAAAOAWAAB5NgAA8AoAAAAAAADgFgAAizcAAGAQAAAAAAAA4BYAABw6AABgEAAAAAAAAOAWAACdOgAAYBAAAAAAAADgFgAAXjsAAPAKAAAAAAAA4BYAALU7AABgEAAAAAAAAOAWAADMPAAAGAsAAAAAAADgFgAATz0AAGAQAAAAAAAA4BYAAL4+AAAYCwAAAAAAAOAWAABBPwAAYBAAAAAAAADgFgAAsEAAABgLAAAAAAAA4BYAADNBAABgEAAAAAAAAOAWAACiQgAAGAsAAAAAAADgFgAAJUMAAGAQAAAAAAAA4BYAAJREAAAYCwAAAAAAAOAWAAAXRQAAYBAAAAAAAADgFgAAhkYAABgLAAAAAAAA4BYAAAlHAABgEAAAAAAAALgWAAB4SAAAiBcAAIBIAAAAAAAAIA0AAIgXAACJSAAAAQAAACANAAC4FgAAqkgAAIgXAAC6SAAAAAAAAEgNAACIFwAAy0gAAAEAAABIDQAAuBYAABhMAAC4FgAAN0wAALgWAABWTAAAuBYAAHVMAAC4FgAAlEwAALgWAACzTAAAuBYAANJMAAC4FgAA8UwAALgWAAAQTQAAuBYAAC9NAAC4FgAATk0AALgWAABtTQAAuBYAAIxNAACkFwAAn00AAAAAAAABAAAA8A0AAAAAAAC4FgAA4U0AAKQXAAAHTgAAAAAAAAEAAADwDQAAAAAAAKQXAABJTgAAAAAAAAEAAADwDQAAAAAAAKQXAACITgAAAAAAAAEAAADwDQAAAAAAAKQXAADHTgAAAAAAAAEAAADwDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALgWAADNTwAA4BYAAC1QAAAADwAAAAAAAOAWAADaTwAAEA8AAAAAAAC4FgAA+08AAOAWAAAIUAAA8A4AAAAAAADgFgAAhlAAAOgOAAAAAAAA4BYAAJNQAADoDgAAAAAAAOAWAACjUAAA6A4AAAAAAADgFgAAtVAAADgPAAAAAAAA4BYAAMZQAAA4DwAAAAAAAOAWAADXUAAAAA8AAAAAAADgFgAA+VAAAHgPAAAAAAAA4BYAAB1RAAAADwAAAAAAAOAWAABCUQAAeA8AAAAAAADgFgAAjlEAAAAPAAAAAAAAbBcAALZRAABsFwAAuFEAAGwXAAC7UQAAbBcAAL1RAABsFwAAv1EAAGwXAADBUQAAbBcAAMNRAABsFwAAxVEAAGwXAADHUQAAbBcAAMlRAABsFwAAy1EAAGwXAADNUQAAbBcAAM9RAABsFwAA0VEAAOAWAADTUQAA8A4AAAAAAADgFgAARlIAAOgOAAAAAAAAuBYAAGJSAACkFwAAe1IAAAAAAAABAAAAWBAAAAAAAADgFgAA9FIAAIgQAAAAAAAA4BYAABdTAACYEAAAAAAAALgWAAAuUwAA4BYAAHBTAACIEAAAAAAAAOAWAACSUwAASA8AAAAAAAAAAAAAAAoAAAEAAAACAAAAAwAAAAEAAAAEAAAAAAAAABAKAAABAAAABQAAAAYAAAACAAAABwAAAAAAAAAgCgAACAAAAAkAAAABAAAAAAAAADgKAAAKAAAACwAAAAIAAAABAAAADAAAAA0AAAACAAAAAwAAAAMAAAAAAAAASAoAAAgAAAAOAAAAAQAAAAAAAABYCgAACAAAAA8AAAABAAAAAAAAAIAKAAAIAAAAEAAAAAEAAAAAAAAAcAoAAAgAAAARAAAAAQAAAAAAAACQCgAACAAAABIAAAABAAAAAAAAAKAKAAAIAAAAEwAAAAEAAAAAAAAAsAoAAAgAAAAUAAAAAQAAAAAAAADACgAACAAAABUAAAABAAAAAAAAANAKAAABAAAAFgAAABcAAAAEAAAAGAAAAAAAAADgCgAACAAAABkAAAABAAAAAAAAAPgKAAAFAAAAGgAAABsAAAAAAAAA8AoAAAEAAAAcAAAAHQAAAAAAAAAICwAAAQAAAB4AAAAfAAAABgAAACAAAAAAAAAAIAsAACEAAAAiAAAABwAAAAgAAAAAAAAAGAsAACMAAAAkAAAABwAAAAkAAAAAAAAAMAsAAAEAAAAlAAAAJgAAAAoAAAAnAAAAAAAAAEALAAAoAAAAKQAAAAcAAAALAAAAAAAAAFALAAABAAAAKgAAACsAAAAMAAAALAAAAAAAAABgCwAALQAAAC4AAAAHAAAADQAAAAAAAABwCwAAAQAAAC8AAAAwAAAADgAAADEAAAAAAAAAgAsAADIAAAAzAAAABwAAAA8AAAAAAAAAkAsAAAEAAAA0AAAANQAAABAAAAA2AAAAAAAAAKALAAARAAAANwAAADgAAAAAAAAAsAsAAAEAAAA5AAAAOgAAABIAAAA7AAAAAAAAAMALAAATAAAAPAAAAD0AAAAAAAAA0AsAAAEAAAA+AAAAPwAAABQAAABAAAAAAAAAAOALAAAVAAAAQQAAAEIAAAAAAAAA8AsAAAEAAABDAAAARAAAABYAAABFAAAAAAAAAAAMAAAXAAAARgAAAEcAAAAAAAAAEAwAAAEAAABIAAAASQAAABgAAABKAAAAAAAAACAMAAABAAAASwAAAEwAAAAZAAAATQAAAAAAAAAwDAAAAQAAAE4AAABPAAAAGgAAAFAAAAAAAAAAQAwAABsAAABRAAAAUgAAAAAAAABQDAAAAQAAAFMAAABUAAAAHAAAAFUAAAAAAAAAYAwAAFYAAABXAAAABwAAAB0AAAAAAAAAcAwAAAEAAABYAAAAWQAAAB4AAABaAAAAAAAAAIAMAABbAAAAXAAAAAcAAAAfAAAAAAAAAJAMAAABAAAAXQAAAF4AAAAgAAAAXwAAAAAAAACgDAAAYAAAAGEAAAAHAAAAIQAAAAAAAACwDAAAAQAAAGIAAABjAAAAIgAAAGQAAAAAAAAAwAwAAGUAAABmAAAABwAAACMAAAAAAAAA0AwAAAEAAABnAAAAaAAAACQAAABpAAAAAAAAAOAMAABqAAAAawAAAAcAAAAlAAAAAAAAAPAMAAABAAAAbAAAAG0AAAAmAAAAbgAAAAAAAAAADQAAbwAAAHAAAAAHAAAAJwAAAAAAAAAQDQAAAQAAAHEAAAByAAAAKAAAAHMAAAAoDQAAyA8AACgNAAAIEAAAEBAAACgNAABQDQAAyA8AAFANAAAgEAAAyA8AAFANAAAIEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsVAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwDgAAdAAAAHUAAAB2AAAAdwAAAAIAAAABAAAAAQAAAAEAAAAAAAAAGA8AAHQAAAB4AAAAdgAAAHcAAAACAAAAAgAAAAIAAAACAAAAAAAAACgPAAB5AAAAegAAAAQAAAAAAAAAOA8AAHsAAAB8AAAABQAAAAAAAABIDwAACAAAAH0AAAABAAAAAAAAAFgPAAB7AAAAfgAAAAUAAAAAAAAAaA8AAHsAAAB/AAAABQAAAAAAAAC4DwAAdAAAAIAAAAB2AAAAdwAAAAMAAAAAAAAAiA8AAHQAAACBAAAAdgAAAHcAAAAEAAAAAAAAADgQAAB0AAAAggAAAHYAAAB3AAAAAgAAAAMAAAADAAAAAwAAAAAAAABIEAAAgwAAAIQAAAAGAAAAAAAAAHgQAACFAAAAhgAAAAcAAAABAAAABQAAAAYAAAACAAAAAAAAAKAQAACFAAAAhwAAAAgAAAADAAAABQAAAAYAAAAEAAAA4BcAAAQYAAAAAAAAsBAAAIgAAACJAAAAAQAAAExBU1ppcABvcGVuAGdldFBvaW50AGdldENvdW50AER5bmFtaWNMQVNaaXAAYWRkRmllbGRGbG9hdGluZwBhZGRGaWVsZFNpZ25lZABhZGRGaWVsZFVuc2lnbmVkAE5TdDNfXzIyMF9fc2hhcmVkX3B0cl9wb2ludGVySVBONmxhc3ppcDdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRU5TXzE0ZGVmYXVsdF9kZWxldGVJUzNfRUVOU185YWxsb2NhdG9ySVMzX0VFRUUATlN0M19fMjE0ZGVmYXVsdF9kZWxldGVJTjZsYXN6aXA3c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRQBOU3QzX18yMjBfX3NoYXJlZF9wdHJfcG9pbnRlcklQTjZsYXN6aXAyaW82cmVhZGVyMTBiYXNpY19maWxlSU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRU5TXzE0ZGVmYXVsdF9kZWxldGVJUzdfRUVOU185YWxsb2NhdG9ySVM3X0VFRUUATlN0M19fMjE0ZGVmYXVsdF9kZWxldGVJTjZsYXN6aXAyaW82cmVhZGVyMTBiYXNpY19maWxlSU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFAExBU0YATjZsYXN6aXAxM2ludmFsaWRfbWFnaWNFAGFsbG9jYXRvcjxUPjo6YWxsb2NhdGUoc2l6ZV90IG4pICduJyBleGNlZWRzIG1heGltdW0gc3VwcG9ydGVkIHNpemUARmlsZSBtYWdpYyBpcyBub3QgdmFsaWQATlN0M19fMjEwX19mdW5jdGlvbjZfX2Z1bmNJWk42bGFzemlwMmlvNnJlYWRlcjEwYmFzaWNfZmlsZUlOUzJfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRTExX3ZhbGlkYXRvcnNFdkVVbFJOUzNfNmhlYWRlckVFX05TXzlhbGxvY2F0b3JJU0JfRUVGdlNBX0VFRQBOU3QzX18yMTBfX2Z1bmN0aW9uNl9fYmFzZUlGdlJONmxhc3ppcDJpbzZoZWFkZXJFRUVFAE42bGFzemlwMjFvbGRfc3R5bGVfY29tcHJlc3Npb25FAE42bGFzemlwMTRub3RfY29tcHJlc3NlZEUAVGhlIGZpbGUgc2VlbXMgdG8gaGF2ZSBvbGQgc3R5bGUgY29tcHJlc3Npb24gd2hpY2ggaXMgbm90IHN1cHBvcnRlZABUaGUgZmlsZSBkb2Vzbid0IHNlZW0gdG8gYmUgY29tcHJlc3NlZABaTjZsYXN6aXAyaW82cmVhZGVyMTBiYXNpY19maWxlSU5TXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUUxMV92YWxpZGF0b3JzRXZFVWxSTlMwXzZoZWFkZXJFRV8AbGFzemlwIGVuY29kZWQATjZsYXN6aXAxM25vX2xhc3ppcF92bHJFAE42bGFzemlwMjVsYXN6aXBfZm9ybWF0X3Vuc3VwcG9ydGVkRQBPbmx5IExBU3ppcCBQT0lOVFdJU0UgQ0hVTktFRCBkZWNvbXByZXNzb3IgaXMgc3VwcG9ydGVkAE5vIExBU3ppcCBWTFIgd2FzIGZvdW5kIGluIHRoZSBWTFJzIHNlY3Rpb24ATjZsYXN6aXAyMmNodW5rX3RhYmxlX3JlYWRfZXJyb3JFAENodW5rIHRhYmxlIG9mZnNldCA9PSAtMSBpcyBub3Qgc3VwcG9ydGVkIGF0IHRoaXMgdGltZQBONmxhc3ppcDEzbm90X3N1cHBvcnRlZEUATjZsYXN6aXAyNnVua25vd25fY2h1bmtfdGFibGVfZm9ybWF0RQBjaHVua19zaXplID09IHVpbnQubWF4IGlzIG5vdCBzdXBwb3J0ZWQgYXQgdGhpcyB0aW1lLgBUaGVyZSB3YXMgYSBwcm9ibGVtIHJlYWRpbmcgdGhlIGNodW5rIHRhYmxlAFRoZSBjaHVuayB0YWJsZSB2ZXJzaW9uIG51bWJlciBpcyB1bmtub3duAE42bGFzemlwMTFlbmRfb2ZfZmlsZUUAUmVhY2hlZCBFbmQgb2YgZmlsZQBJbnZhbGlkIG51bWJlciBvZiBzeW1ib2xzAE5TdDNfXzIyMF9fc2hhcmVkX3B0cl9wb2ludGVySVBONmxhc3ppcDhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOU18xNGRlZmF1bHRfZGVsZXRlSVM5X0VFTlNfOWFsbG9jYXRvcklTOV9FRUVFAE5TdDNfXzIxNGRlZmF1bHRfZGVsZXRlSU42bGFzemlwOGRlY29kZXJzMTBhcml0aG1ldGljSU5TMV8yaW8xOF9faWZzdHJlYW1fd3JhcHBlcklOUzFfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRUVFRUVFAE42bGFzemlwMTl1bmtub3duX3NjaGVtYV90eXBlRQBUaGUgTEFaIHNjaGVtYSBpcyBub3QgcmVjb2duaXplZABONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2ZpZWxkX2RlY29tcHJlc3NvcklOU184ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlNfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlNfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyMGR5bmFtaWNfZGVjb21wcmVzc29yRQBOU3QzX18yMjBfX3NoYXJlZF9wdHJfcG9pbnRlcklQTjZsYXN6aXA3Zm9ybWF0czI2ZHluYW1pY19maWVsZF9kZWNvbXByZXNzb3JJTlMxXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVFRU5TXzE0ZGVmYXVsdF9kZWxldGVJU0NfRUVOU185YWxsb2NhdG9ySVNDX0VFRUUATlN0M19fMjE0ZGVmYXVsdF9kZWxldGVJTjZsYXN6aXA3Zm9ybWF0czI2ZHluYW1pY19maWVsZF9kZWNvbXByZXNzb3JJTlMxXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOU18yaW8xOF9faWZzdHJlYW1fd3JhcHBlcklOU183c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMwXzVmaWVsZElOUzBfM2xhczdwb2ludDEwRU5TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNDX0VFRUVFRQBONmxhc3ppcDdmb3JtYXRzMTBiYXNlX2ZpZWxkRQBOU3QzX18yMjBfX3NoYXJlZF9wdHJfcG9pbnRlcklQTjZsYXN6aXA3Zm9ybWF0czI2ZHluYW1pY19kZWNvbXByZXNzb3JfZmllbGRJTlMxXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzJfNWZpZWxkSU5TMl8zbGFzN3BvaW50MTBFTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0VfRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTSV9FRU5TXzlhbGxvY2F0b3JJU0lfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSU5TMV8yaW8xOF9faWZzdHJlYW1fd3JhcHBlcklOUzFfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRUVFRU5TMl81ZmllbGRJTlMyXzNsYXM3cG9pbnQxMEVOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTRV9FRUVFRUVFRQBONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOU184ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlNfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlNfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRUVFRU5TMF81ZmllbGRJTlMwXzNsYXM3Z3BzdGltZUVOUzBfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTQ19FRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzVmaWVsZElOUzJfM2xhczdncHN0aW1lRU5TMl8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNFX0VFRUVFRU5TXzE0ZGVmYXVsdF9kZWxldGVJU0lfRUVOU185YWxsb2NhdG9ySVNJX0VFRUUATlN0M19fMjE0ZGVmYXVsdF9kZWxldGVJTjZsYXN6aXA3Zm9ybWF0czI2ZHluYW1pY19kZWNvbXByZXNzb3JfZmllbGRJTlMxXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzJfNWZpZWxkSU5TMl8zbGFzN2dwc3RpbWVFTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0VfRUVFRUVFRUUATjZsYXN6aXA3Zm9ybWF0czI2ZHluYW1pY19kZWNvbXByZXNzb3JfZmllbGRJTlNfOGRlY29kZXJzMTBhcml0aG1ldGljSU5TXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzBfNWZpZWxkSU5TMF8zbGFzM3JnYkVOUzBfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTQ19FRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzVmaWVsZElOUzJfM2xhczNyZ2JFTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0VfRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTSV9FRU5TXzlhbGxvY2F0b3JJU0lfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSU5TMV8yaW8xOF9faWZzdHJlYW1fd3JhcHBlcklOUzFfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRUVFRU5TMl81ZmllbGRJTlMyXzNsYXMzcmdiRU5TMl8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNFX0VFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOU18yaW8xOF9faWZzdHJlYW1fd3JhcHBlcklOU183c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMwXzVmaWVsZElOUzBfM2xhczEwZXh0cmFieXRlc0VOUzBfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTQ19FRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzVmaWVsZElOUzJfM2xhczEwZXh0cmFieXRlc0VOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTRV9FRUVFRUVOU18xNGRlZmF1bHRfZGVsZXRlSVNJX0VFTlNfOWFsbG9jYXRvcklTSV9FRUVFAE5TdDNfXzIxNGRlZmF1bHRfZGVsZXRlSU42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzVmaWVsZElOUzJfM2xhczEwZXh0cmFieXRlc0VOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTRV9FRUVFRUVFRQBONmxhc3ppcDdmb3JtYXRzMjFkeW5hbWljX2RlY29tcHJlc3NvcjFJTlNfOGRlY29kZXJzMTBhcml0aG1ldGljSU5TXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzBfMTlyZWNvcmRfZGVjb21wcmVzc29ySUpOUzBfNWZpZWxkSU5TMF8zbGFzN3BvaW50MTBFTlMwXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0RfRUVFRUVFRUVFAE5TdDNfXzIyMF9fc2hhcmVkX3B0cl9wb2ludGVySVBONmxhc3ppcDdmb3JtYXRzMjFkeW5hbWljX2RlY29tcHJlc3NvcjFJTlMxXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzJfMTlyZWNvcmRfZGVjb21wcmVzc29ySUpOUzJfNWZpZWxkSU5TMl8zbGFzN3BvaW50MTBFTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0ZfRUVFRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTS19FRU5TXzlhbGxvY2F0b3JJU0tfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjFkeW5hbWljX2RlY29tcHJlc3NvcjFJTlMxXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzJfMTlyZWNvcmRfZGVjb21wcmVzc29ySUpOUzJfNWZpZWxkSU5TMl8zbGFzN3BvaW50MTBFTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0ZfRUVFRUVFRUVFRUUATjZsYXN6aXA3Zm9ybWF0czIxZHluYW1pY19kZWNvbXByZXNzb3IxSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOU18yaW8xOF9faWZzdHJlYW1fd3JhcHBlcklOU183c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMwXzE5cmVjb3JkX2RlY29tcHJlc3NvcklKTlMwXzVmaWVsZElOUzBfM2xhczdwb2ludDEwRU5TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNEX0VFRUVOU0JfSU5TQ183Z3BzdGltZUVOU0VfSVNIX0VFRUVFRUVFRQBOU3QzX18yMjBfX3NoYXJlZF9wdHJfcG9pbnRlcklQTjZsYXN6aXA3Zm9ybWF0czIxZHluYW1pY19kZWNvbXByZXNzb3IxSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzE5cmVjb3JkX2RlY29tcHJlc3NvcklKTlMyXzVmaWVsZElOUzJfM2xhczdwb2ludDEwRU5TMl8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNGX0VFRUVOU0RfSU5TRV83Z3BzdGltZUVOU0dfSVNKX0VFRUVFRUVFRU5TXzE0ZGVmYXVsdF9kZWxldGVJU05fRUVOU185YWxsb2NhdG9ySVNOX0VFRUUATlN0M19fMjE0ZGVmYXVsdF9kZWxldGVJTjZsYXN6aXA3Zm9ybWF0czIxZHluYW1pY19kZWNvbXByZXNzb3IxSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzE5cmVjb3JkX2RlY29tcHJlc3NvcklKTlMyXzVmaWVsZElOUzJfM2xhczdwb2ludDEwRU5TMl8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNGX0VFRUVOU0RfSU5TRV83Z3BzdGltZUVOU0dfSVNKX0VFRUVFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyMWR5bmFtaWNfZGVjb21wcmVzc29yMUlOU184ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlNfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlNfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRUVFRU5TMF8xOXJlY29yZF9kZWNvbXByZXNzb3JJSk5TMF81ZmllbGRJTlMwXzNsYXM3cG9pbnQxMEVOUzBfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTRF9FRUVFTlNCX0lOU0NfM3JnYkVOU0VfSVNIX0VFRUVFRUVFRQBOU3QzX18yMjBfX3NoYXJlZF9wdHJfcG9pbnRlcklQTjZsYXN6aXA3Zm9ybWF0czIxZHluYW1pY19kZWNvbXByZXNzb3IxSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzE5cmVjb3JkX2RlY29tcHJlc3NvcklKTlMyXzVmaWVsZElOUzJfM2xhczdwb2ludDEwRU5TMl8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNGX0VFRUVOU0RfSU5TRV8zcmdiRU5TR19JU0pfRUVFRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTTl9FRU5TXzlhbGxvY2F0b3JJU05fRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjFkeW5hbWljX2RlY29tcHJlc3NvcjFJTlMxXzhkZWNvZGVyczEwYXJpdGhtZXRpY0lOUzFfMmlvMThfX2lmc3RyZWFtX3dyYXBwZXJJTlMxXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzJfMTlyZWNvcmRfZGVjb21wcmVzc29ySUpOUzJfNWZpZWxkSU5TMl8zbGFzN3BvaW50MTBFTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0ZfRUVFRU5TRF9JTlNFXzNyZ2JFTlNHX0lTSl9FRUVFRUVFRUVFRQBONmxhc3ppcDdmb3JtYXRzMjFkeW5hbWljX2RlY29tcHJlc3NvcjFJTlNfOGRlY29kZXJzMTBhcml0aG1ldGljSU5TXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TXzdzdHJlYW1zMTNtZW1vcnlfc3RyZWFtRUVFRUVOUzBfMTlyZWNvcmRfZGVjb21wcmVzc29ySUpOUzBfNWZpZWxkSU5TMF8zbGFzN3BvaW50MTBFTlMwXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJU0RfRUVFRU5TQl9JTlNDXzdncHN0aW1lRU5TRV9JU0hfRUVFRU5TQl9JTlNDXzNyZ2JFTlNFX0lTS19FRUVFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyMWR5bmFtaWNfZGVjb21wcmVzc29yMUlOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSU5TMV8yaW8xOF9faWZzdHJlYW1fd3JhcHBlcklOUzFfN3N0cmVhbXMxM21lbW9yeV9zdHJlYW1FRUVFRU5TMl8xOXJlY29yZF9kZWNvbXByZXNzb3JJSk5TMl81ZmllbGRJTlMyXzNsYXM3cG9pbnQxMEVOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElTRl9FRUVFTlNEX0lOU0VfN2dwc3RpbWVFTlNHX0lTSl9FRUVFTlNEX0lOU0VfM3JnYkVOU0dfSVNNX0VFRUVFRUVFRU5TXzE0ZGVmYXVsdF9kZWxldGVJU1FfRUVOU185YWxsb2NhdG9ySVNRX0VFRUUATlN0M19fMjE0ZGVmYXVsdF9kZWxldGVJTjZsYXN6aXA3Zm9ybWF0czIxZHluYW1pY19kZWNvbXByZXNzb3IxSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJTlMxXzJpbzE4X19pZnN0cmVhbV93cmFwcGVySU5TMV83c3RyZWFtczEzbWVtb3J5X3N0cmVhbUVFRUVFTlMyXzE5cmVjb3JkX2RlY29tcHJlc3NvcklKTlMyXzVmaWVsZElOUzJfM2xhczdwb2ludDEwRU5TMl8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSVNGX0VFRUVOU0RfSU5TRV83Z3BzdGltZUVOU0dfSVNKX0VFRUVOU0RfSU5TRV8zcmdiRU5TR19JU01fRUVFRUVFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUDEwYnVmX3N0cmVhbU5TXzE0ZGVmYXVsdF9kZWxldGVJUzFfRUVOU185YWxsb2NhdG9ySVMxX0VFRUUATlN0M19fMjE0ZGVmYXVsdF9kZWxldGVJMTBidWZfc3RyZWFtRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTNV9FRU5TXzlhbGxvY2F0b3JJUzVfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZmllbGRfZGVjb21wcmVzc29ySU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRUVFAE5TdDNfXzIyMF9fc2hhcmVkX3B0cl9wb2ludGVySVBONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2ZpZWxkX2RlY29tcHJlc3NvcklOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFRUVOU18xNGRlZmF1bHRfZGVsZXRlSVM4X0VFTlNfOWFsbG9jYXRvcklTOF9FRUVFAE5TdDNfXzIxNGRlZmF1bHRfZGVsZXRlSU42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZmllbGRfZGVjb21wcmVzc29ySU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJMTBidWZfc3RyZWFtRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRU5TMF81ZmllbGRJaU5TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSWlFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJMTBidWZfc3RyZWFtRUVOUzJfNWZpZWxkSWlOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElpRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTQ19FRU5TXzlhbGxvY2F0b3JJU0NfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFTlMyXzVmaWVsZElpTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJaUVFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRU5TMF81ZmllbGRJak5TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSWpFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJMTBidWZfc3RyZWFtRUVOUzJfNWZpZWxkSWpOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElqRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTQ19FRU5TXzlhbGxvY2F0b3JJU0NfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFTlMyXzVmaWVsZElqTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJakVFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRU5TMF81ZmllbGRJYU5TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSWFFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJMTBidWZfc3RyZWFtRUVOUzJfNWZpZWxkSWFOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElhRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTQ19FRU5TXzlhbGxvY2F0b3JJU0NfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFTlMyXzVmaWVsZElhTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJYUVFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRU5TMF81ZmllbGRJc05TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSXNFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJMTBidWZfc3RyZWFtRUVOUzJfNWZpZWxkSXNOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZElzRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTQ19FRU5TXzlhbGxvY2F0b3JJU0NfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFTlMyXzVmaWVsZElzTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJc0VFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRU5TMF81ZmllbGRJaE5TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSWhFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJMTBidWZfc3RyZWFtRUVOUzJfNWZpZWxkSWhOUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZEloRUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTQ19FRU5TXzlhbGxvY2F0b3JJU0NfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFTlMyXzVmaWVsZEloTlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJaEVFRUVFRUVFAE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TXzhkZWNvZGVyczEwYXJpdGhtZXRpY0kxMGJ1Zl9zdHJlYW1FRU5TMF81ZmllbGRJdE5TMF8yMHN0YW5kYXJkX2RpZmZfbWV0aG9kSXRFRUVFRUUATlN0M19fMjIwX19zaGFyZWRfcHRyX3BvaW50ZXJJUE42bGFzemlwN2Zvcm1hdHMyNmR5bmFtaWNfZGVjb21wcmVzc29yX2ZpZWxkSU5TMV84ZGVjb2RlcnMxMGFyaXRobWV0aWNJMTBidWZfc3RyZWFtRUVOUzJfNWZpZWxkSXROUzJfMjBzdGFuZGFyZF9kaWZmX21ldGhvZEl0RUVFRUVFTlNfMTRkZWZhdWx0X2RlbGV0ZUlTQ19FRU5TXzlhbGxvY2F0b3JJU0NfRUVFRQBOU3QzX18yMTRkZWZhdWx0X2RlbGV0ZUlONmxhc3ppcDdmb3JtYXRzMjZkeW5hbWljX2RlY29tcHJlc3Nvcl9maWVsZElOUzFfOGRlY29kZXJzMTBhcml0aG1ldGljSTEwYnVmX3N0cmVhbUVFTlMyXzVmaWVsZEl0TlMyXzIwc3RhbmRhcmRfZGlmZl9tZXRob2RJdEVFRUVFRUVFADZMQVNaaXAAUDZMQVNaaXAAUEs2TEFTWmlwAGlpAHYAdmkAdmlpaWkAdmlpaQBpaWkAMTNEeW5hbWljTEFTWmlwAFAxM0R5bmFtaWNMQVNaaXAAUEsxM0R5bmFtaWNMQVNaaXAAdm9pZABib29sAGNoYXIAc2lnbmVkIGNoYXIAdW5zaWduZWQgY2hhcgBzaG9ydAB1bnNpZ25lZCBzaG9ydABpbnQAdW5zaWduZWQgaW50AGxvbmcAdW5zaWduZWQgbG9uZwBmbG9hdABkb3VibGUAc3RkOjpzdHJpbmcAc3RkOjpiYXNpY19zdHJpbmc8dW5zaWduZWQgY2hhcj4Ac3RkOjp3c3RyaW5nAHN0ZDo6dTE2c3RyaW5nAHN0ZDo6dTMyc3RyaW5nAGVtc2NyaXB0ZW46OnZhbABlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxjaGFyPgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxzaWduZWQgY2hhcj4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgY2hhcj4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8c2hvcnQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVuc2lnbmVkIHNob3J0PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVuc2lnbmVkIGludD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8bG9uZz4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgbG9uZz4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50OF90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50OF90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQxNl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50MTZfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8aW50MzJfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dWludDMyX3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGZsb2F0PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxkb3VibGU+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGxvbmcgZG91YmxlPgBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0llRUUATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJZEVFAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWZFRQBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0ltRUUATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJbEVFAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWpFRQBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lpRUUATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJdEVFAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SXNFRQBOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0loRUUATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJYUVFAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWNFRQBOMTBlbXNjcmlwdGVuM3ZhbEUATlN0M19fMjEyYmFzaWNfc3RyaW5nSURpTlNfMTFjaGFyX3RyYWl0c0lEaUVFTlNfOWFsbG9jYXRvcklEaUVFRUUATlN0M19fMjIxX19iYXNpY19zdHJpbmdfY29tbW9uSUxiMUVFRQBOU3QzX18yMTJiYXNpY19zdHJpbmdJRHNOU18xMWNoYXJfdHJhaXRzSURzRUVOU185YWxsb2NhdG9ySURzRUVFRQBOU3QzX18yMTJiYXNpY19zdHJpbmdJd05TXzExY2hhcl90cmFpdHNJd0VFTlNfOWFsbG9jYXRvckl3RUVFRQBOU3QzX18yMTJiYXNpY19zdHJpbmdJaE5TXzExY2hhcl90cmFpdHNJaEVFTlNfOWFsbG9jYXRvckloRUVFRQBOU3QzX18yMTJiYXNpY19zdHJpbmdJY05TXzExY2hhcl90cmFpdHNJY0VFTlNfOWFsbG9jYXRvckljRUVFRQAtKyAgIDBYMHgAKG51bGwpAC0wWCswWCAwWC0weCsweCAweABpbmYASU5GAG5hbgBOQU4ALgB0ZXJtaW5hdGluZyB3aXRoICVzIGV4Y2VwdGlvbiBvZiB0eXBlICVzOiAlcwB0ZXJtaW5hdGluZyB3aXRoICVzIGV4Y2VwdGlvbiBvZiB0eXBlICVzAHRlcm1pbmF0aW5nIHdpdGggJXMgZm9yZWlnbiBleGNlcHRpb24AdGVybWluYXRpbmcAdW5jYXVnaHQAU3Q5ZXhjZXB0aW9uAE4xMF9fY3h4YWJpdjExNl9fc2hpbV90eXBlX2luZm9FAFN0OXR5cGVfaW5mbwBOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAHRlcm1pbmF0ZV9oYW5kbGVyIHVuZXhwZWN0ZWRseSByZXR1cm5lZABzdGQ6OmJhZF9hbGxvYwBTdDliYWRfYWxsb2MAU3QxMWxvZ2ljX2Vycm9yAFN0MTNydW50aW1lX2Vycm9yAFN0MTJsZW5ndGhfZXJyb3IAU3QxMm91dF9vZl9yYW5nZQBOMTBfX2N4eGFiaXYxMTdfX3BiYXNlX3R5cGVfaW5mb0UATjEwX19jeHhhYml2MTE5X19wb2ludGVyX3R5cGVfaW5mb0UATjEwX19jeHhhYml2MTIwX19mdW5jdGlvbl90eXBlX2luZm9FAE4xMF9fY3h4YWJpdjEyOV9fcG9pbnRlcl90b19tZW1iZXJfdHlwZV9pbmZvRQBQdXJlIHZpcnR1YWwgZnVuY3Rpb24gY2FsbGVkIQBOMTBfX2N4eGFiaXYxMjNfX2Z1bmRhbWVudGFsX3R5cGVfaW5mb0UAdgBEbgBiAGMAaABhAHMAdABpAGoAbABtAGYAZABOMTBfX2N4eGFiaXYxMjFfX3ZtaV9jbGFzc190eXBlX2luZm9FAF9fY3hhX2d1YXJkX2FjcXVpcmUgZGV0ZWN0ZWQgcmVjdXJzaXZlIGluaXRpYWxpemF0aW9uAHN0ZDo6YmFkX2Z1bmN0aW9uX2NhbGwATlN0M19fMjE3YmFkX2Z1bmN0aW9uX2NhbGxFAE5TdDNfXzIxNF9fc2hhcmVkX2NvdW50RQBOU3QzX18yMTlfX3NoYXJlZF93ZWFrX2NvdW50RQBtdXRleCBsb2NrIGZhaWxlZABiYXNpY19zdHJpbmcAdW5zcGVjaWZpZWQgZ2VuZXJpY19jYXRlZ29yeSBlcnJvcgBVbmtub3duIGVycm9yICVkAGdlbmVyaWMATlN0M19fMjI0X19nZW5lcmljX2Vycm9yX2NhdGVnb3J5RQBOU3QzX18yMTJfX2RvX21lc3NhZ2VFAE5TdDNfXzIxNGVycm9yX2NhdGVnb3J5RQB1bnNwZWNpZmllZCBzeXN0ZW1fY2F0ZWdvcnkgZXJyb3IAc3lzdGVtAE5TdDNfXzIyM19fc3lzdGVtX2Vycm9yX2NhdGVnb3J5RQBOU3QzX18yMTJzeXN0ZW1fZXJyb3JFADogAHZlY3Rvcg==";var ke=22368;function Be(Ye){return Ws(Ye)}var at={};function wt(Ye){if(!!Ye){var qe=at[Ye];qe.refcount++}}function ht(Ye){if(!Ye||at[Ye])return Ye;for(var qe in at)for(var yt=+qe,ie=at[yt].adjusted,zt=ie.length,r=0;r<zt;r++)if(ie[r]===Ye)return yt;return Ye}function _t(Ye){var qe=at[Ye];return qe&&!qe.caught&&(qe.caught=!0,no.uncaught_exceptions--),qe&&(qe.rethrown=!1),wt(ht(Ye)),Ye}function St(Ye,qe,yt){throw at[Ye]={ptr:Ye,adjusted:[Ye],type:qe,destructor:yt,refcount:0,caught:!1,rethrown:!1},"uncaught_exception"in no?no.uncaught_exceptions++:no.uncaught_exceptions=1,Ye}function Ct(){return no.uncaught_exceptions}function vt(){}function ct(Ye){switch(Ye){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+Ye)}}function Dt(){for(var Ye=new Array(256),qe=0;qe<256;++qe)Ye[qe]=String.fromCharCode(qe);fr=Ye}var fr=void 0;function er(Ye){for(var qe="",yt=Ye;ue[yt];)qe+=fr[ue[yt++]];return qe}var dr={},zr={},Ut={},on=48,tn=57;function Ln(Ye){if(Ye===void 0)return"_unknown";Ye=Ye.replace(/[^a-zA-Z0-9_]/g,"$");var qe=Ye.charCodeAt(0);return qe>=on&&qe<=tn?"_"+Ye:Ye}function _i(Ye,qe){return Ye=Ln(Ye),new Function("body","return function "+Ye+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(qe)}function xn(Ye,qe){var yt=_i(qe,function(ie){this.name=qe,this.message=ie;var zt=new Error(ie).stack;zt!==void 0&&(this.stack=this.toString()+`
`+zt.replace(/^Error(:[^\n]*)?\n/,""))});return yt.prototype=Object.create(Ye.prototype),yt.prototype.constructor=yt,yt.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},yt}var ri=void 0;function _n(Ye){throw new ri(Ye)}var ta=void 0;function ji(Ye){throw new ta(Ye)}function ss(Ye,qe,yt){Ye.forEach(function(Yt){Ut[Yt]=qe});function ie(Yt){var Er=yt(Yt);Er.length!==Ye.length&&ji("Mismatched type converter count");for(var xr=0;xr<Ye.length;++xr)Ii(Ye[xr],Er[xr])}var zt=new Array(qe.length),r=[],We=0;qe.forEach(function(Yt,Er){zr.hasOwnProperty(Yt)?zt[Er]=zr[Yt]:(r.push(Yt),dr.hasOwnProperty(Yt)||(dr[Yt]=[]),dr[Yt].push(function(){zt[Er]=zr[Yt],++We,We===r.length&&ie(zt)}))}),r.length===0&&ie(zt)}function Ii(Ye,qe,yt){if(yt=yt||{},!("argPackAdvance"in qe))throw new TypeError("registerType registeredInstance requires argPackAdvance");var ie=qe.name;if(Ye||_n('type "'+ie+'" must have a positive integer typeid pointer'),zr.hasOwnProperty(Ye)){if(yt.ignoreDuplicateRegistrations)return;_n("Cannot register type '"+ie+"' twice")}if(zr[Ye]=qe,delete Ut[Ye],dr.hasOwnProperty(Ye)){var zt=dr[Ye];delete dr[Ye],zt.forEach(function(r){r()})}}function Ha(Ye,qe,yt,ie,zt){var r=ct(yt);qe=er(qe),Ii(Ye,{name:qe,fromWireType:function(We){return!!We},toWireType:function(We,Yt){return Yt?ie:zt},argPackAdvance:8,readValueFromPointer:function(We){var Yt;if(yt===1)Yt=se;else if(yt===2)Yt=Y;else if(yt===4)Yt=Ee;else throw new TypeError("Unknown boolean type size: "+qe);return this.fromWireType(Yt[We>>r])},destructorFunction:null})}function to(Ye){if(!(this instanceof Hi)||!(Ye instanceof Hi))return!1;for(var qe=this.$$.ptrType.registeredClass,yt=this.$$.ptr,ie=Ye.$$.ptrType.registeredClass,zt=Ye.$$.ptr;qe.baseClass;)yt=qe.upcast(yt),qe=qe.baseClass;for(;ie.baseClass;)zt=ie.upcast(zt),ie=ie.baseClass;return qe===ie&&yt===zt}function Ou(Ye){return{count:Ye.count,deleteScheduled:Ye.deleteScheduled,preservePointerOnDelete:Ye.preservePointerOnDelete,ptr:Ye.ptr,ptrType:Ye.ptrType,smartPtr:Ye.smartPtr,smartPtrType:Ye.smartPtrType}}function ms(Ye){function qe(yt){return yt.$$.ptrType.registeredClass.name}_n(qe(Ye)+" instance already deleted")}var Us=!1;function Ka(Ye){}function Fu(Ye){Ye.smartPtr?Ye.smartPtrType.rawDestructor(Ye.smartPtr):Ye.ptrType.registeredClass.rawDestructor(Ye.ptr)}function vs(Ye){Ye.count.value-=1;var qe=Ye.count.value===0;qe&&Fu(Ye)}function gs(Ye){return typeof FinalizationGroup>"u"?(gs=function(qe){return qe},Ye):(Us=new FinalizationGroup(function(qe){for(var yt=qe.next();!yt.done;yt=qe.next()){var ie=yt.value;ie.ptr?vs(ie):console.warn("object already deleted: "+ie.ptr)}}),gs=function(qe){return Us.register(qe,qe.$$,qe.$$),qe},Ka=function(qe){Us.unregister(qe.$$)},gs(Ye))}function la(){if(this.$$.ptr||ms(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var Ye=gs(Object.create(Object.getPrototypeOf(this),{$$:{value:Ou(this.$$)}}));return Ye.$$.count.value+=1,Ye.$$.deleteScheduled=!1,Ye}function ou(){this.$$.ptr||ms(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_n("Object already scheduled for deletion"),Ka(this),vs(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ml(){return!this.$$.ptr}var qa=void 0,wr=[];function bn(){for(;wr.length;){var Ye=wr.pop();Ye.$$.deleteScheduled=!1,Ye.delete()}}function Rn(){return this.$$.ptr||ms(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&_n("Object already scheduled for deletion"),wr.push(this),wr.length===1&&qa&&qa(bn),this.$$.deleteScheduled=!0,this}function Xa(){Hi.prototype.isAliasOf=to,Hi.prototype.clone=la,Hi.prototype.delete=ou,Hi.prototype.isDeleted=ml,Hi.prototype.deleteLater=Rn}function Hi(){}var Tn={};function Ec(Ye,qe,yt){if(Ye[qe].overloadTable===void 0){var ie=Ye[qe];Ye[qe]=function(){return Ye[qe].overloadTable.hasOwnProperty(arguments.length)||_n("Function '"+yt+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+Ye[qe].overloadTable+")!"),Ye[qe].overloadTable[arguments.length].apply(this,arguments)},Ye[qe].overloadTable=[],Ye[qe].overloadTable[ie.argCount]=ie}}function Iu(Ye,qe,yt){a.hasOwnProperty(Ye)?((yt===void 0||a[Ye].overloadTable!==void 0&&a[Ye].overloadTable[yt]!==void 0)&&_n("Cannot register public name '"+Ye+"' twice"),Ec(a,Ye,Ye),a.hasOwnProperty(yt)&&_n("Cannot register multiple overloads of a function with the same number of arguments ("+yt+")!"),a[Ye].overloadTable[yt]=qe):(a[Ye]=qe,yt!==void 0&&(a[Ye].numArguments=yt))}function ku(Ye,qe,yt,ie,zt,r,We,Yt){this.name=Ye,this.constructor=qe,this.instancePrototype=yt,this.rawDestructor=ie,this.baseClass=zt,this.getActualType=r,this.upcast=We,this.downcast=Yt,this.pureVirtualFunctions=[]}function ro(Ye,qe,yt){for(;qe!==yt;)qe.upcast||_n("Expected null or instance of "+yt.name+", got an instance of "+qe.name),Ye=qe.upcast(Ye),qe=qe.baseClass;return Ye}function es(Ye,qe){if(qe===null)return this.isReference&&_n("null is not a valid "+this.name),0;qe.$$||_n('Cannot pass "'+du(qe)+'" as a '+this.name),qe.$$.ptr||_n("Cannot pass deleted object as a pointer of type "+this.name);var yt=qe.$$.ptrType.registeredClass,ie=ro(qe.$$.ptr,yt,this.registeredClass);return ie}function Pi(Ye,qe){var yt;if(qe===null)return this.isReference&&_n("null is not a valid "+this.name),this.isSmartPointer?(yt=this.rawConstructor(),Ye!==null&&Ye.push(this.rawDestructor,yt),yt):0;qe.$$||_n('Cannot pass "'+du(qe)+'" as a '+this.name),qe.$$.ptr||_n("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&qe.$$.ptrType.isConst&&_n("Cannot convert argument of type "+(qe.$$.smartPtrType?qe.$$.smartPtrType.name:qe.$$.ptrType.name)+" to parameter type "+this.name);var ie=qe.$$.ptrType.registeredClass;if(yt=ro(qe.$$.ptr,ie,this.registeredClass),this.isSmartPointer)switch(qe.$$.smartPtr===void 0&&_n("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:qe.$$.smartPtrType===this?yt=qe.$$.smartPtr:_n("Cannot convert argument of type "+(qe.$$.smartPtrType?qe.$$.smartPtrType.name:qe.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:yt=qe.$$.smartPtr;break;case 2:if(qe.$$.smartPtrType===this)yt=qe.$$.smartPtr;else{var zt=qe.clone();yt=this.rawShare(yt,gl(function(){zt.delete()})),Ye!==null&&Ye.push(this.rawDestructor,yt)}break;default:_n("Unsupporting sharing policy")}return yt}function zf(Ye,qe){if(qe===null)return this.isReference&&_n("null is not a valid "+this.name),0;qe.$$||_n('Cannot pass "'+du(qe)+'" as a '+this.name),qe.$$.ptr||_n("Cannot pass deleted object as a pointer of type "+this.name),qe.$$.ptrType.isConst&&_n("Cannot convert argument of type "+qe.$$.ptrType.name+" to parameter type "+this.name);var yt=qe.$$.ptrType.registeredClass,ie=ro(qe.$$.ptr,yt,this.registeredClass);return ie}function zs(Ye){return this.fromWireType(Fe[Ye>>2])}function vl(Ye){return this.rawGetPointee&&(Ye=this.rawGetPointee(Ye)),Ye}function uu(Ye){this.rawDestructor&&this.rawDestructor(Ye)}function Gf(Ye){Ye!==null&&Ye.delete()}function Fa(Ye,qe,yt){if(qe===yt)return Ye;if(yt.baseClass===void 0)return null;var ie=Fa(Ye,qe,yt.baseClass);return ie===null?null:yt.downcast(ie)}function ca(){return Object.keys(fa).length}function lu(){var Ye=[];for(var qe in fa)fa.hasOwnProperty(qe)&&Ye.push(fa[qe]);return Ye}function cu(Ye){qa=Ye,wr.length&&qa&&qa(bn)}function ts(){a.getInheritedInstanceCount=ca,a.getLiveInheritedInstances=lu,a.flushPendingDeletes=bn,a.setDelayFunction=cu}var fa={};function bo(Ye,qe){for(qe===void 0&&_n("ptr should not be undefined");Ye.baseClass;)qe=Ye.upcast(qe),Ye=Ye.baseClass;return qe}function Eo(Ye,qe){return qe=bo(Ye,qe),fa[qe]}function ki(Ye,qe){(!qe.ptrType||!qe.ptr)&&ji("makeClassHandle requires ptr and ptrType");var yt=!!qe.smartPtrType,ie=!!qe.smartPtr;return yt!==ie&&ji("Both smartPtrType and smartPtr must be specified"),qe.count={value:1},gs(Object.create(Ye,{$$:{value:qe}}))}function fu(Ye){var qe=this.getPointee(Ye);if(!qe)return this.destructor(Ye),null;var yt=Eo(this.registeredClass,qe);if(yt!==void 0){if(yt.$$.count.value===0)return yt.$$.ptr=qe,yt.$$.smartPtr=Ye,yt.clone();var ie=yt.clone();return this.destructor(Ye),ie}function zt(){return this.isSmartPointer?ki(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:qe,smartPtrType:this,smartPtr:Ye}):ki(this.registeredClass.instancePrototype,{ptrType:this,ptr:Ye})}var r=this.registeredClass.getActualType(qe),We=Tn[r];if(!We)return zt.call(this);var Yt;this.isConst?Yt=We.constPointerType:Yt=We.pointerType;var Er=Fa(qe,this.registeredClass,Yt.registeredClass);return Er===null?zt.call(this):this.isSmartPointer?ki(Yt.registeredClass.instancePrototype,{ptrType:Yt,ptr:Er,smartPtrType:this,smartPtr:Ye}):ki(Yt.registeredClass.instancePrototype,{ptrType:Yt,ptr:Er})}function Tc(){ys.prototype.getPointee=vl,ys.prototype.destructor=uu,ys.prototype.argPackAdvance=8,ys.prototype.readValueFromPointer=zs,ys.prototype.deleteObject=Gf,ys.prototype.fromWireType=fu}function ys(Ye,qe,yt,ie,zt,r,We,Yt,Er,xr,Nt){this.name=Ye,this.registeredClass=qe,this.isReference=yt,this.isConst=ie,this.isSmartPointer=zt,this.pointeeType=r,this.sharingPolicy=We,this.rawGetPointee=Yt,this.rawConstructor=Er,this.rawShare=xr,this.rawDestructor=Nt,!zt&&qe.baseClass===void 0?ie?(this.toWireType=es,this.destructorFunction=null):(this.toWireType=zf,this.destructorFunction=null):this.toWireType=Pi}function B0(Ye,qe,yt){a.hasOwnProperty(Ye)||ji("Replacing nonexistant public symbol"),a[Ye].overloadTable!==void 0&&yt!==void 0?a[Ye].overloadTable[yt]=qe:(a[Ye]=qe,a[Ye].argCount=yt)}function fi(Ye,qe){Ye=er(Ye);function yt(r){for(var We=[],Yt=1;Yt<Ye.length;++Yt)We.push("a"+Yt);var Er="dynCall_"+Ye+"_"+qe,xr="return function "+Er+"("+We.join(", ")+`) {
`;return xr+="    return dynCall(rawFunction"+(We.length?", ":"")+We.join(", ")+`);
`,xr+=`};
`,new Function("dynCall","rawFunction",xr)(r,qe)}var ie=a["dynCall_"+Ye],zt=yt(ie);return typeof zt!="function"&&_n("unknown function pointer with signature "+Ye+": "+qe),zt}var xi=void 0;function Sc(Ye){var qe=wl(Ye),yt=er(qe);return Ps(qe),yt}function _s(Ye,qe){var yt=[],ie={};function zt(r){if(!ie[r]&&!zr[r]){if(Ut[r]){Ut[r].forEach(zt);return}yt.push(r),ie[r]=!0}}throw qe.forEach(zt),new xi(Ye+": "+yt.map(Sc).join([", "]))}function Gs(Ye,qe,yt,ie,zt,r,We,Yt,Er,xr,Nt,$n,Ai){Nt=er(Nt),r=fi(zt,r),Yt&&(Yt=fi(We,Yt)),xr&&(xr=fi(Er,xr)),Ai=fi($n,Ai);var ni=Ln(Nt);Iu(ni,function(){_s("Cannot construct "+Nt+" due to unbound types",[ie])}),ss([Ye,qe,yt],ie?[ie]:[],function(qi){qi=qi[0];var _a,xa;ie?(_a=qi.registeredClass,xa=_a.instancePrototype):xa=Hi.prototype;var Ls=_i(ni,function(){if(Object.getPrototypeOf(this)!==Or)throw new ri("Use 'new' to construct "+Nt);if(Nn.constructor_body===void 0)throw new ri(Nt+" has no accessible constructor");var ei=Nn.constructor_body[arguments.length];if(ei===void 0)throw new ri("Tried to invoke ctor of "+Nt+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Nn.constructor_body).toString()+") parameters instead!");return ei.apply(this,arguments)}),Or=Object.create(xa,{constructor:{value:Ls}});Ls.prototype=Or;var Nn=new ku(Nt,Ls,Or,Ai,_a,r,Yt,xr),Ia=new ys(Nt,Nn,!0,!1,!1),Ya=new ys(Nt+"*",Nn,!1,!1,!1),Cn=new ys(Nt+" const*",Nn,!1,!0,!1);return Tn[Ye]={pointerType:Ya,constPointerType:Cn},B0(ni,Ls),[Ia,Ya,Cn]})}function Du(Ye,qe){for(var yt=[],ie=0;ie<Ye;ie++)yt.push(Ee[(qe>>2)+ie]);return yt}function sd(Ye){for(;Ye.length;){var qe=Ye.pop(),yt=Ye.pop();yt(qe)}}function Nu(Ye,qe,yt,ie,zt,r){U(qe>0);var We=Du(qe,yt);zt=fi(ie,zt);var Yt=[r],Er=[];ss([],[Ye],function(xr){xr=xr[0];var Nt="constructor "+xr.name;if(xr.registeredClass.constructor_body===void 0&&(xr.registeredClass.constructor_body=[]),xr.registeredClass.constructor_body[qe-1]!==void 0)throw new ri("Cannot register multiple constructors with identical number of parameters ("+(qe-1)+") for class '"+xr.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return xr.registeredClass.constructor_body[qe-1]=function(){_s("Cannot construct "+xr.name+" due to unbound types",We)},ss([],We,function($n){return xr.registeredClass.constructor_body[qe-1]=function(){arguments.length!==qe-1&&_n(Nt+" called with "+arguments.length+" arguments, expected "+(qe-1)),Er.length=0,Yt.length=qe;for(var ni=1;ni<qe;++ni)Yt[ni]=$n[ni].toWireType(Er,arguments[ni-1]);var qi=zt.apply(null,Yt);return sd(Er),$n[0].fromWireType(qi)},[]}),[]})}function Bu(Ye,qe){if(!(Ye instanceof Function))throw new TypeError("new_ called with constructor type "+typeof Ye+" which is not a function");var yt=_i(Ye.name||"unknownFunctionName",function(){});yt.prototype=Ye.prototype;var ie=new yt,zt=Ye.apply(ie,qe);return zt instanceof Object?zt:ie}function U0(Ye,qe,yt,ie,zt){var r=qe.length;r<2&&_n("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var We=qe[1]!==null&&yt!==null,Yt=!1,Er=1;Er<qe.length;++Er)if(qe[Er]!==null&&qe[Er].destructorFunction===void 0){Yt=!0;break}for(var xr=qe[0].name!=="void",Nt="",$n="",Er=0;Er<r-2;++Er)Nt+=(Er!==0?", ":"")+"arg"+Er,$n+=(Er!==0?", ":"")+"arg"+Er+"Wired";var Ai="return function "+Ln(Ye)+"("+Nt+`) {
if (arguments.length !== `+(r-2)+`) {
throwBindingError('function `+Ye+" called with ' + arguments.length + ' arguments, expected "+(r-2)+` args!');
}
`;Yt&&(Ai+=`var destructors = [];
`);var ni=Yt?"destructors":"null",qi=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],_a=[_n,ie,zt,sd,qe[0],qe[1]];We&&(Ai+="var thisWired = classParam.toWireType("+ni+`, this);
`);for(var Er=0;Er<r-2;++Er)Ai+="var arg"+Er+"Wired = argType"+Er+".toWireType("+ni+", arg"+Er+"); // "+qe[Er+2].name+`
`,qi.push("argType"+Er),_a.push(qe[Er+2]);if(We&&($n="thisWired"+($n.length>0?", ":"")+$n),Ai+=(xr?"var rv = ":"")+"invoker(fn"+($n.length>0?", ":"")+$n+`);
`,Yt)Ai+=`runDestructors(destructors);
`;else for(var Er=We?1:2;Er<qe.length;++Er){var xa=Er===1?"thisWired":"arg"+(Er-2)+"Wired";qe[Er].destructorFunction!==null&&(Ai+=xa+"_dtor("+xa+"); // "+qe[Er].name+`
`,qi.push(xa+"_dtor"),_a.push(qe[Er].destructorFunction))}xr&&(Ai+=`var ret = retType.fromWireType(rv);
return ret;
`),Ai+=`}
`,qi.push(Ai);var Ls=Bu(Function,qi).apply(null,_a);return Ls}function z0(Ye,qe,yt,ie,zt,r,We,Yt){var Er=Du(yt,ie);qe=er(qe),r=fi(zt,r),ss([],[Ye],function(xr){xr=xr[0];var Nt=xr.name+"."+qe;Yt&&xr.registeredClass.pureVirtualFunctions.push(qe);function $n(){_s("Cannot call "+Nt+" due to unbound types",Er)}var Ai=xr.registeredClass.instancePrototype,ni=Ai[qe];return ni===void 0||ni.overloadTable===void 0&&ni.className!==xr.name&&ni.argCount===yt-2?($n.argCount=yt-2,$n.className=xr.name,Ai[qe]=$n):(Ec(Ai,qe,Nt),Ai[qe].overloadTable[yt-2]=$n),ss([],Er,function(qi){var _a=U0(Nt,qi,xr,r,We);return Ai[qe].overloadTable===void 0?(_a.argCount=yt-2,Ai[qe]=_a):Ai[qe].overloadTable[yt-2]=_a,[]}),[]})}var Rc=[],Za=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function od(Ye){Ye>4&&--Za[Ye].refcount===0&&(Za[Ye]=void 0,Rc.push(Ye))}function hu(){for(var Ye=0,qe=5;qe<Za.length;++qe)Za[qe]!==void 0&&++Ye;return Ye}function Cc(){for(var Ye=5;Ye<Za.length;++Ye)if(Za[Ye]!==void 0)return Za[Ye];return null}function To(){a.count_emval_handles=hu,a.get_first_emval=Cc}function gl(Ye){switch(Ye){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var qe=Rc.length?Rc.pop():Za.length;return Za[qe]={refcount:1,value:Ye},qe}}}function G0(Ye,qe){qe=er(qe),Ii(Ye,{name:qe,fromWireType:function(yt){var ie=Za[yt].value;return od(yt),ie},toWireType:function(yt,ie){return gl(ie)},argPackAdvance:8,readValueFromPointer:zs,destructorFunction:null})}function du(Ye){if(Ye===null)return"null";var qe=typeof Ye;return qe==="object"||qe==="array"||qe==="function"?Ye.toString():""+Ye}function Pc(Ye,qe){switch(qe){case 2:return function(yt){return this.fromWireType($e[yt>>2])};case 3:return function(yt){return this.fromWireType(pt[yt>>3])};default:throw new TypeError("Unknown float type: "+Ye)}}function ud(Ye,qe,yt){var ie=ct(yt);qe=er(qe),Ii(Ye,{name:qe,fromWireType:function(zt){return zt},toWireType:function(zt,r){if(typeof r!="number"&&typeof r!="boolean")throw new TypeError('Cannot convert "'+du(r)+'" to '+this.name);return r},argPackAdvance:8,readValueFromPointer:Pc(qe,ie),destructorFunction:null})}function Uu(Ye,qe,yt){switch(qe){case 0:return yt?function(zt){return se[zt]}:function(zt){return ue[zt]};case 1:return yt?function(zt){return Y[zt>>1]}:function(zt){return pe[zt>>1]};case 2:return yt?function(zt){return Ee[zt>>2]}:function(zt){return Fe[zt>>2]};default:throw new TypeError("Unknown integer type: "+Ye)}}function zu(Ye,qe,yt,ie,zt){qe=er(qe),zt===-1&&(zt=4294967295);var r=ct(yt),We=function(xr){return xr};if(ie===0){var Yt=32-8*yt;We=function(xr){return xr<<Yt>>>Yt}}var Er=qe.indexOf("unsigned")!=-1;Ii(Ye,{name:qe,fromWireType:We,toWireType:function(xr,Nt){if(typeof Nt!="number"&&typeof Nt!="boolean")throw new TypeError('Cannot convert "'+du(Nt)+'" to '+this.name);if(Nt<ie||Nt>zt)throw new TypeError('Passing a number "'+du(Nt)+'" from JS side to C/C++ side to an argument of type "'+qe+'", which is outside the valid range ['+ie+", "+zt+"]!");return Er?Nt>>>0:Nt|0},argPackAdvance:8,readValueFromPointer:Uu(qe,r,ie!==0),destructorFunction:null})}function Vf(Ye,qe,yt){var ie=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],zt=ie[qe];function r(We){We=We>>2;var Yt=Fe,Er=Yt[We],xr=Yt[We+1];return new zt(ce,xr,Er)}yt=er(yt),Ii(Ye,{name:yt,fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{ignoreDuplicateRegistrations:!0})}function V0(Ye,qe){qe=er(qe);var yt=qe==="std::string";Ii(Ye,{name:qe,fromWireType:function(ie){var zt=Fe[ie>>2],r;if(yt)for(var We=ie+4,Yt=0;Yt<=zt;++Yt){var Er=ie+4+Yt;if(ue[Er]==0||Yt==zt){var xr=Er-We,Nt=te(We,xr);r===void 0?r=Nt:(r+=String.fromCharCode(0),r+=Nt),We=Er+1}}else{for(var $n=new Array(zt),Yt=0;Yt<zt;++Yt)$n[Yt]=String.fromCharCode(ue[ie+4+Yt]);r=$n.join("")}return Ps(ie),r},toWireType:function(ie,zt){zt instanceof ArrayBuffer&&(zt=new Uint8Array(zt));var r,We=typeof zt=="string";We||zt instanceof Uint8Array||zt instanceof Uint8ClampedArray||zt instanceof Int8Array||_n("Cannot pass non-string to std::string"),yt&&We?r=function(){return ae(zt)}:r=function(){return zt.length};var Yt=r(),Er=Ws(4+Yt+1);if(Fe[Er>>2]=Yt,yt&&We)Z(zt,Er+4,Yt+1);else if(We)for(var xr=0;xr<Yt;++xr){var Nt=zt.charCodeAt(xr);Nt>255&&(Ps(Er),_n("String has UTF-16 code units that do not fit in 8 bits")),ue[Er+4+xr]=Nt}else for(var xr=0;xr<Yt;++xr)ue[Er+4+xr]=zt[xr];return ie!==null&&ie.push(Ps,Er),Er},argPackAdvance:8,readValueFromPointer:zs,destructorFunction:function(ie){Ps(ie)}})}function W0(Ye,qe,yt){yt=er(yt);var ie,zt,r,We,Yt;qe===2?(ie=W,zt=O,We=X,r=function(){return pe},Yt=1):qe===4&&(ie=G,zt=j,We=K,r=function(){return Fe},Yt=2),Ii(Ye,{name:yt,fromWireType:function(Er){for(var xr=Fe[Er>>2],Nt=r(),$n,Ai=Er+4,ni=0;ni<=xr;++ni){var qi=Er+4+ni*qe;if(Nt[qi>>Yt]==0||ni==xr){var _a=qi-Ai,xa=ie(Ai,_a);$n===void 0?$n=xa:($n+=String.fromCharCode(0),$n+=xa),Ai=qi+qe}}return Ps(Er),$n},toWireType:function(Er,xr){typeof xr!="string"&&_n("Cannot pass non-string to C++ string type "+yt);var Nt=We(xr),$n=Ws(4+Nt+qe);return Fe[$n>>2]=Nt>>Yt,zt(xr,$n+4,Nt+qe),Er!==null&&Er.push(Ps,$n),$n},argPackAdvance:8,readValueFromPointer:zs,destructorFunction:function(Er){Ps(Er)}})}function ld(Ye,qe){qe=er(qe),Ii(Ye,{isVoid:!0,name:qe,argPackAdvance:0,fromWireType:function(){},toWireType:function(yt,ie){}})}function H0(){Ie()}function q0(){return ue.length}function cd(Ye){Ie("OOM")}function X0(Ye){cd()}function yl(){Ie("trap!")}function _l(Ye,qe,yt){ue.copyWithin(Ye,qe,qe+yt)}Dt(),ri=a.BindingError=xn(Error,"BindingError"),ta=a.InternalError=xn(Error,"InternalError"),Xa(),Tc(),ts(),xi=a.UnboundTypeError=xn(Error,"UnboundTypeError"),To();function Vs(Ye){for(var qe=[],yt=0;yt<Ye.length;yt++){var ie=Ye[yt];ie>255&&(ie&=255),qe.push(String.fromCharCode(ie))}return qe.join("")}var Ea=typeof atob=="function"?atob:function(Ye){var qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",yt="",ie,zt,r,We,Yt,Er,xr,Nt=0;Ye=Ye.replace(/[^A-Za-z0-9\+\/\=]/g,"");do We=qe.indexOf(Ye.charAt(Nt++)),Yt=qe.indexOf(Ye.charAt(Nt++)),Er=qe.indexOf(Ye.charAt(Nt++)),xr=qe.indexOf(Ye.charAt(Nt++)),ie=We<<2|Yt>>4,zt=(Yt&15)<<4|Er>>2,r=(Er&3)<<6|xr,yt=yt+String.fromCharCode(ie),Er!==64&&(yt=yt+String.fromCharCode(zt)),xr!==64&&(yt=yt+String.fromCharCode(r));while(Nt<Ye.length);return yt};function xl(Ye){if(typeof v=="boolean"&&v){var qe;try{qe=Buffer.from(Ye,"base64")}catch{qe=new Buffer(Ye,"base64")}return new Uint8Array(qe.buffer,qe.byteOffset,qe.byteLength)}try{for(var yt=Ea(Ye),ie=new Uint8Array(yt.length),zt=0;zt<yt.length;++zt)ie[zt]=yt.charCodeAt(zt);return ie}catch{throw new Error("Converting base64 string to bytes failed.")}}function ja(Ye){if(!!Re(Ye))return xl(Ye.slice(_e.length))}var Al={Math,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Float32Array,Float64Array},os={A:_l,B:X0,C:yl,D:ke,a:Ie,b:_,c:x,d:Be,e:_t,f:St,g:Ct,h:wt,i:ht,j:vt,k:Ha,l:Gs,m:Nu,n:z0,o:G0,p:ud,q:zu,r:Vf,s:V0,t:W0,u:ld,v:od,w:gl,x:H0,y:du,z:q0},un=function(Ye,qe,yt){var ie=new Ye.Int8Array(yt),zt=new Ye.Int16Array(yt),r=new Ye.Int32Array(yt),We=new Ye.Uint8Array(yt),Yt=new Ye.Uint16Array(yt),Er=new Ye.Float32Array(yt),xr=new Ye.Float64Array(yt),Nt=qe.D|0,$n=0,Ai=0,ni=0,qi=0,_a=0,xa=0,Ls=0,Or=0,Nn=Ye.Math.imul,Ia=Ye.Math.clz32,Ya=qe.a,Cn=qe.b,ei=qe.c,cn=qe.d,Ta=qe.e,oi=qe.f,El=qe.g,ha=qe.h,dt=qe.i,Hs=qe.j,Tl=qe.k,Ja=qe.l,xs=qe.m,us=qe.n,Sl=qe.o,pu=qe.p,ka=qe.q,Sa=qe.r,As=qe.s,qs=qe.t,io=qe.u,Oc=qe.v,Rl=qe.w,Fc=qe.x,ao=qe.y,Xf=qe.z,dd=qe.A,pd=qe.B,Cl=qe.C,Me=22384,mu=5265264,So=0;function Zf(){s_(),$g()}function Pl(){Ro(0)}function Ro(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0;t=Me,Me=Me+16|0,n=t+8|0,s=t,st=e_()|0,z=yf()|0,m=xo()|0,$=xf()|0,ne=sc()|0,ge=Rg()|0,Le=Ef()|0,Qe=Fh()|0,c=Fh()|0,Ja(m|0,$|0,ne|0,ge|0,Le|0,9,Qe|0,st|0,c|0,z|0,6204,tm()|0,138),r0(1),r[s>>2]=5,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],lm(6211,n),r[s>>2]=3,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],kh(6216,n),r[s>>2]=10,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],cc(6225,n),z=Fg()|0,c=Ig()|0,st=fc()|0,Qe=kg()|0,Le=Dg()|0,ge=Rg()|0,ne=Ef()|0,$=Fh()|0,m=Fh()|0,Ja(st|0,Qe|0,Le|0,ge|0,ne|0,11,$|0,z|0,m|0,c|0,6234,tm()|0,139),mm(2),r[s>>2]=6,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],xm(6211,n),r[s>>2]=4,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],wm(6248,n),r[s>>2]=5,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],wm(6265,n),r[s>>2]=6,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],wm(6280,n),r[s>>2]=7,r[s+4>>2]=0,r[n>>2]=r[s>>2],r[n+4>>2]=r[s+4>>2],Xg(6216,n),Me=t}function jf(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0;c=Me,Me=Me+32|0,$=c+16|0,m=c+8|0,ne=c,z=cr(20)|0,j0(z,n,s),r[ne>>2]=0,r[$>>2]=r[ne>>2],kc(m,z,$),n=r[m>>2]|0,r[m>>2]=r[t>>2],r[t>>2]=n,n=m+4|0,s=t+4|0,z=r[n>>2]|0,r[n>>2]=r[s>>2],r[s>>2]=z,Ra(m),s=cr(352)|0,Po(s,r[t>>2]|0),z=t+8|0,r[ne>>2]=0,r[$>>2]=r[ne>>2],Ol(m,s,$),s=r[m>>2]|0,r[m>>2]=r[z>>2],r[z>>2]=s,z=m+4|0,s=t+12|0,n=r[z>>2]|0,r[z>>2]=r[s>>2],r[s>>2]=n,so(m),Me=c}function Ic(t,n){t=t|0,n=n|0,k(r[t+8>>2]|0,n)}function Yf(t){return t=t|0,t=(Ri(r[t+8>>2]|0)|0)+107|0,We[t>>0]|We[t+1>>0]<<8|We[t+2>>0]<<16|We[t+3>>0]<<24|0}function Co(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0;c=Me,Me=Me+32|0,z=c+16|0,m=c+8|0,$=c,ne=cr(12)|0,eg(ne,n,s),r[$>>2]=0,r[z>>2]=r[$>>2],$l(m,ne,z),ne=r[m>>2]|0,r[m>>2]=r[t>>2],r[t>>2]=ne,ne=m+4|0,s=t+4|0,n=r[ne>>2]|0,r[ne>>2]=r[s>>2],r[s>>2]=n,Yi(m),s=t+8|0,n=cr(12)|0,dh(n,r[t>>2]|0),r[$>>2]=0,r[z>>2]=r[$>>2],ff(m,n,z),n=r[m>>2]|0,r[m>>2]=r[s>>2],r[s>>2]=n,n=m+4|0,$=t+12|0,ne=r[n>>2]|0,r[n>>2]=r[$>>2],r[$>>2]=ne,Ql(m),ph(m,r[s>>2]|0),s=t+16|0,$=r[m>>2]|0,ne=m+4|0,n=r[ne>>2]|0,r[m>>2]=0,r[ne>>2]=0,r[z>>2]=r[s>>2],r[s>>2]=$,s=t+20|0,r[z+4>>2]=r[s>>2],r[s>>2]=n,nl(z),nl(m),Me=c}function jr(t,n){t=t|0,n=n|0;var s=0;t=t+16|0,s=r[t>>2]|0;e:do if(s|0)switch(n|0){case 4:{hf(s);break e}case 8:{ec(s),ec(r[t>>2]|0);break e}default:break e}while(0)}function Vu(t,n){t=t|0,n=n|0;var s=0;s=t+16|0,t=r[s>>2]|0;e:do if(t|0){switch(n|0){case 1:{Hp(t);break e}case 2:{jd(t);break e}case 8:{hf(t),t=r[s>>2]|0;break}case 4:break;default:break e}hf(t)}while(0)}function Os(t,n){t=t|0,n=n|0;var s=0;s=t+16|0,t=r[s>>2]|0;e:do if(t|0){switch(n|0){case 1:{Ch(t);break e}case 2:{B1(t);break e}case 8:{ec(t),t=r[s>>2]|0;break}case 4:break;default:break e}ec(t)}while(0)}function Z0(t,n){t=t|0,n=n|0,t=r[t+16>>2]|0,t|0&&km[r[r[t>>2]>>2]&63](t,n)|0}function j0(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,r[t+4>>2]=s,r[t+8>>2]=0,ie[t+12>>0]=0,ie[t+13>>0]=0,r[t+16>>2]=0}function Po(t,n){t=t|0,n=n|0,r[t>>2]=n,Gc(t+4|0,n),vu(t+247|0),r[t+288>>2]=0,r[t+292>>2]=0,r[t+296>>2]=0,Oo(t+300|0),n=t+312|0,r[n>>2]=0,r[n+4>>2]=0,r[n+8>>2]=0,r[n+12>>2]=0,kl(t+328|0),zi(t)}function kc(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4296,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,Dc(t,c),Me=s}function Ra(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function Dc(t,n){t=t|0,n=n|0}function Y0(t){t=t|0,Ta(t|0)|0,pr()}function Lo(t){t=t|0,vi(t),rr(t)}function Ll(t){t=t|0,t=r[t+12>>2]|0,t|0&&rr(t)}function md(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==6407?t+12|0:0)|0}function Nc(t){t=t|0,In(t,16)}function In(t,n){t=t|0,n=n|0,$a(t)}function $a(t){t=t|0,rr(t)}function Ol(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4324,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,Wu(t,c),Me=s}function so(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function Wu(t,n){t=t|0,n=n|0}function Bc(t){t=t|0,vi(t),rr(t)}function Jf(t){t=t|0,t=r[t+12>>2]|0,t|0&&(Fl(t),rr(t))}function Uc(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==6605?t+12|0:0)|0}function Yn(t){t=t|0,In(t,16)}function Fl(t){t=t|0,Il(t+320|0),Gn(t+312|0),Da(t+300|0),Hu(t+288|0),oo(t+247|0),zc(t+4|0)}function Il(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function Gn(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function Da(t){t=t|0,Xs(t)}function oo(t){t=t|0,t=t+34|0,t=We[t>>0]|We[t+1>>0]<<8|We[t+2>>0]<<16|We[t+3>>0]<<24,t|0&&bi(t)}function zc(t){t=t|0,uo(r[t+12>>2]|0)}function Xs(t){t=t|0;var n=0,s=0;n=r[t>>2]|0,s=n,n|0&&(r[t+4>>2]=s,In(n,(r[t+8>>2]|0)-s|0))}function Hu(t){t=t|0;var n=0,s=0;n=r[t>>2]|0,s=n,n|0&&(r[t+4>>2]=s,In(n,(r[t+8>>2]|0)-s|0))}function uo(t){t=t|0,vx(r[t+-4>>2]|0)}function Gc(t,n){t=t|0,n=n|0,r[t>>2]=n,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=lo(1048576)|0}function vu(t){t=t|0;var n=0;n=t+32|0,ie[n>>0]=0,ie[n+1>>0]=0,t=t+34|0,ie[t>>0]=0,ie[t+1>>0]=0,ie[t+2>>0]=0,ie[t+3>>0]=0}function Oo(t){t=t|0,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0}function kl(t){t=t|0,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0,t=t+16|0,r[t>>2]=-1,r[t+4>>2]=-1}function zi(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0;if($=Me,Me=Me+64|0,m=$+32|0,s=$+56|0,n=$+16|0,z=$,Ti(r[t>>2]|0,s,4),Qr(m,s,s+4|0),s=fo(6693)|0,c=ie[m+11>>0]|0,(s|0)==((c<<24>>24<0?r[m+4>>2]|0:c&255)|0)){if(c=(a3(m,0,-1,6693,s)|0)==0,Im(m),c){if(s=r[t>>2]|0,r[n>>2]=0,r[n+4>>2]=0,r[n+8>>2]=0,r[n+12>>2]=0,r[m>>2]=r[n>>2],r[m+4>>2]=r[n+4>>2],r[m+8>>2]=r[n+8>>2],r[m+12>>2]=r[n+12>>2],ii(s,m),s=t+20|0,Ti(r[t>>2]|0,s,227),Vc(t,s),c=ti()|0,n=r[c>>2]|0,c=r[c+4>>2]|0,(n|0)!=(c|0))do qu(m,n),$f(m,s),Wc(m),n=n+24|0;while((n|0)!=(c|0));Hc(t),qc(t),vd(r[t>>2]|0),c=r[t>>2]|0,n=(r[t+116>>2]|0)+8|0,s=z,r[s>>2]=0,r[s+4>>2]=0,s=z+8|0,r[s>>2]=n,r[s+4>>2]=0,r[m>>2]=r[z>>2],r[m+4>>2]=r[z+4>>2],r[m+8>>2]=r[z+8>>2],r[m+12>>2]=r[z+12>>2],ii(c,m),Dl(t+4|0),Me=$;return}}else Im(m);$=cn(8)|0,co($),oi($|0,2592,8)}function lo(t){t=t|0;var n=0;return n=Cy(t+68|0)|0,t=n+68&-64,r[t+-4>>2]=n,t|0}function Ti(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0;$=t+13|0,ie[$>>0]|0?ie[t+12>>0]=1:(z=t+4|0,c=r[z>>2]|0,ne=t+8|0,m=r[ne>>2]|0,ge=c-m|0,s=(ge|0)<(s|0)?ge:s,s&&(nu(n|0,(r[t>>2]|0)+m|0,s|0)|0,m=r[ne>>2]|0,c=r[z>>2]|0),ge=m+s|0,r[ne>>2]=ge,r[t+16>>2]=s,(ge|0)>=(c|0)&&(ie[$>>0]=1))}function co(t){t=t|0,Ru(t,6791),r[t>>2]=4352}function ii(t,n){t=t|0,n=n|0;var s=0,c=0,m=0;m=n+8|0,n=r[m>>2]|0,m=r[m+4>>2]|0,s=r[t+4>>2]|0,c=((s|0)<0)<<31>>31,(m|0)<(c|0)|(m|0)==(c|0)&n>>>0<s>>>0?r[t+8>>2]=n:ie[t+12>>0]=1}function Vc(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0;Qe=n+179|0,ie[Nt>>0]=ie[Qe>>0],ie[Nt+1>>0]=ie[Qe+1>>0],ie[Nt+2>>0]=ie[Qe+2>>0],ie[Nt+3>>0]=ie[Qe+3>>0],ie[Nt+4>>0]=ie[Qe+4>>0],ie[Nt+5>>0]=ie[Qe+5>>0],ie[Nt+6>>0]=ie[Qe+6>>0],ie[Nt+7>>0]=ie[Qe+7>>0],Le=+xr[Nt>>3],$=n+187|0,ie[Nt>>0]=ie[$>>0],ie[Nt+1>>0]=ie[$+1>>0],ie[Nt+2>>0]=ie[$+2>>0],ie[Nt+3>>0]=ie[$+3>>0],ie[Nt+4>>0]=ie[$+4>>0],ie[Nt+5>>0]=ie[$+5>>0],ie[Nt+6>>0]=ie[$+6>>0],ie[Nt+7>>0]=ie[$+7>>0],st=+xr[Nt>>3],t=n+195|0,ie[Nt>>0]=ie[t>>0],ie[Nt+1>>0]=ie[t+1>>0],ie[Nt+2>>0]=ie[t+2>>0],ie[Nt+3>>0]=ie[t+3>>0],ie[Nt+4>>0]=ie[t+4>>0],ie[Nt+5>>0]=ie[t+5>>0],ie[Nt+6>>0]=ie[t+6>>0],ie[Nt+7>>0]=ie[t+7>>0],z=+xr[Nt>>3],ge=n+203|0,ie[Nt>>0]=ie[ge>>0],ie[Nt+1>>0]=ie[ge+1>>0],ie[Nt+2>>0]=ie[ge+2>>0],ie[Nt+3>>0]=ie[ge+3>>0],ie[Nt+4>>0]=ie[ge+4>>0],ie[Nt+5>>0]=ie[ge+5>>0],ie[Nt+6>>0]=ie[ge+6>>0],ie[Nt+7>>0]=ie[ge+7>>0],ne=+xr[Nt>>3],m=n+211|0,ie[Nt>>0]=ie[m>>0],ie[Nt+1>>0]=ie[m+1>>0],ie[Nt+2>>0]=ie[m+2>>0],ie[Nt+3>>0]=ie[m+3>>0],ie[Nt+4>>0]=ie[m+4>>0],ie[Nt+5>>0]=ie[m+5>>0],ie[Nt+6>>0]=ie[m+6>>0],ie[Nt+7>>0]=ie[m+7>>0],s=+xr[Nt>>3],n=n+219|0,ie[Nt>>0]=ie[n>>0],ie[Nt+1>>0]=ie[n+1>>0],ie[Nt+2>>0]=ie[n+2>>0],ie[Nt+3>>0]=ie[n+3>>0],ie[Nt+4>>0]=ie[n+4>>0],ie[Nt+5>>0]=ie[n+5>>0],ie[Nt+6>>0]=ie[n+6>>0],ie[Nt+7>>0]=ie[n+7>>0],c=+xr[Nt>>3],xr[Nt>>3]=st,ie[Qe>>0]=ie[Nt>>0],ie[Qe+1>>0]=ie[Nt+1>>0],ie[Qe+2>>0]=ie[Nt+2>>0],ie[Qe+3>>0]=ie[Nt+3>>0],ie[Qe+4>>0]=ie[Nt+4>>0],ie[Qe+5>>0]=ie[Nt+5>>0],ie[Qe+6>>0]=ie[Nt+6>>0],ie[Qe+7>>0]=ie[Nt+7>>0],xr[Nt>>3]=Le,ie[ge>>0]=ie[Nt>>0],ie[ge+1>>0]=ie[Nt+1>>0],ie[ge+2>>0]=ie[Nt+2>>0],ie[ge+3>>0]=ie[Nt+3>>0],ie[ge+4>>0]=ie[Nt+4>>0],ie[ge+5>>0]=ie[Nt+5>>0],ie[ge+6>>0]=ie[Nt+6>>0],ie[ge+7>>0]=ie[Nt+7>>0],xr[Nt>>3]=ne,ie[$>>0]=ie[Nt>>0],ie[$+1>>0]=ie[Nt+1>>0],ie[$+2>>0]=ie[Nt+2>>0],ie[$+3>>0]=ie[Nt+3>>0],ie[$+4>>0]=ie[Nt+4>>0],ie[$+5>>0]=ie[Nt+5>>0],ie[$+6>>0]=ie[Nt+6>>0],ie[$+7>>0]=ie[Nt+7>>0],xr[Nt>>3]=z,ie[m>>0]=ie[Nt>>0],ie[m+1>>0]=ie[Nt+1>>0],ie[m+2>>0]=ie[Nt+2>>0],ie[m+3>>0]=ie[Nt+3>>0],ie[m+4>>0]=ie[Nt+4>>0],ie[m+5>>0]=ie[Nt+5>>0],ie[m+6>>0]=ie[Nt+6>>0],ie[m+7>>0]=ie[Nt+7>>0],xr[Nt>>3]=c,ie[t>>0]=ie[Nt>>0],ie[t+1>>0]=ie[Nt+1>>0],ie[t+2>>0]=ie[Nt+2>>0],ie[t+3>>0]=ie[Nt+3>>0],ie[t+4>>0]=ie[Nt+4>>0],ie[t+5>>0]=ie[Nt+5>>0],ie[t+6>>0]=ie[Nt+6>>0],ie[t+7>>0]=ie[Nt+7>>0],xr[Nt>>3]=s,ie[n>>0]=ie[Nt>>0],ie[n+1>>0]=ie[Nt+1>>0],ie[n+2>>0]=ie[Nt+2>>0],ie[n+3>>0]=ie[Nt+3>>0],ie[n+4>>0]=ie[Nt+4>>0],ie[n+5>>0]=ie[Nt+5>>0],ie[n+6>>0]=ie[Nt+6>>0],ie[n+7>>0]=ie[Nt+7>>0]}function ti(){var t=0,n=0,s=0,c=0,m=0,z=0,$=0,ne=0;if(m=Me,Me=Me+48|0,s=m+24|0,c=m,t=m+44|0,(ie[21440]|0)==0&&yc(21440)|0&&(r[5374]=0,r[5375]=0,r[5376]=0,Kt(21440)),(ie[21448]|0)==0&&yc(21448)|0&&Kt(21448),(r[5374]|0)==(r[5375]|0)){if(tu(21508),(r[5374]|0)==(r[5375]|0)){ie[s>>0]=ie[t>>0]|0,rs(c,s),t=r[5375]|0;do if(t>>>0>=(r[5376]|0)>>>0)if(t=((t-(r[5374]|0)|0)/24|0)+1|0,n=gu(21496)|0,n>>>0<t>>>0)Ss(21496);else{z=r[5374]|0,ne=((r[5376]|0)-z|0)/24|0,$=ne<<1,Aa(s,ne>>>0<n>>>1>>>0?$>>>0<t>>>0?t:$:n,((r[5375]|0)-z|0)/24|0,21504),n=s+8|0,Xi(r[n>>2]|0,c),r[n>>2]=(r[n>>2]|0)+24,An(21496,s),Qf(s);break}else Xc(s,21496,1),ne=s+4|0,Xi(r[ne>>2]|0,c),r[ne>>2]=(r[ne>>2]|0)+24,Di(s);while(0);Wc(c)}Su(21508)}return Me=m,21496}function qu(t,n){t=t|0,n=n|0;var s=0,c=0;s=n+16|0,c=r[s>>2]|0;do if(c)if((n|0)==(c|0)){c=Zs(t)|0,r[t+16>>2]=c,s=r[s>>2]|0,Lf[r[(r[s>>2]|0)+12>>2]&15](s,c);break}else{r[t+16>>2]=Ly[r[(r[c>>2]|0)+8>>2]&15](c)|0;break}else r[t+16>>2]=0;while(0)}function $f(t,n){if(t=t|0,n=n|0,t=r[t+16>>2]|0,!t)n=cn(4)|0,r[n>>2]=0,ra(n),oi(n|0,4168,131);else{Lf[r[(r[t>>2]|0)+24>>2]&15](t,n);return}}function Wc(t){t=t|0;var n=0;n=r[t+16>>2]|0,(t|0)!=(n|0)?n|0&&Bi[r[(r[n>>2]|0)+20>>2]&255](n):Bi[r[(r[n>>2]|0)+16>>2]&255](n)}function Hc(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0;gt=Me,Me=Me+96|0,m=gt+16|0,Qe=gt,ne=gt+72|0,z=r[t>>2]|0,ge=Yt[t+114>>1]|0,Le=Qe,r[Le>>2]=0,r[Le+4>>2]=0,Le=Qe+8|0,r[Le>>2]=ge,r[Le+4>>2]=0,r[m>>2]=r[Qe>>2],r[m+4>>2]=r[Qe+4>>2],r[m+8>>2]=r[Qe+8>>2],r[m+12>>2]=r[Qe+12>>2],ii(z,m),z=t+120|0;e:do if(r[z>>2]|0){for($=m+2|0,ge=m+16|0,Le=m+20|0,Qe=m+18|0,s=0;;){if(!(zl(r[t>>2]|0)|0)||Gl(r[t>>2]|0)|0)break e;for(Ti(r[t>>2]|0,m,54),n=7277,c=$;(ie[c>>0]|0)==(ie[n>>0]|0);)if(c=c+1|0,(c|0)==(ge|0)){st=8;break}else n=n+1|0;if((st|0)==8&&(st=0,(We[Qe>>0]|We[Qe+1>>0]<<8)<<16>>16==22204))break;if(Ju(r[t>>2]|0,(We[Le>>0]|We[Le+1>>0]<<8)&65535,0,1),s=s+1|0,s>>>0>=(r[z>>2]|0)>>>0)break e}Qe=(We[Le>>0]|We[Le+1>>0]<<8)&65535,st=Zn(Qe)|0,Ti(r[t>>2]|0,st,Qe),ho(t,st),rr(st),st=t+125|0,gd(ne,t+247|0,(We[st>>0]|We[st+1>>0]<<8)&65535),J0(t+300|0,ne)|0,Da(ne),Me=gt;return}while(0);gt=cn(8)|0,Na(gt),oi(gt|0,2672,8)}function qc(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0;if(st=Me,Me=Me+176|0,m=st+40|0,z=st+24|0,n=st+16|0,c=st,ge=st+152|0,Le=st+136|0,Qe=st+56|0,ne=r[t>>2]|0,$=t+116|0,gt=r[$>>2]|0,s=z,r[s>>2]=0,r[s+4>>2]=0,s=z+8|0,r[s>>2]=gt,r[s+4>>2]=0,r[m>>2]=r[z>>2],r[m+4>>2]=r[z+4>>2],r[m+8>>2]=r[z+8>>2],r[m+12>>2]=r[z+12>>2],ii(ne,m),ne=n,r[ne>>2]=0,r[ne+4>>2]=0,Ti(r[t>>2]|0,n,8),zl(r[t>>2]|0)|0||(gt=cn(8)|0,xu(gt),oi(gt|0,2704,8)),s=n,n=r[s>>2]|0,s=r[s+4>>2]|0,(n|0)==-1&(s|0)==-1&&(gt=cn(8)|0,Ba(gt,7488),oi(gt|0,2720,8)),gt=r[t>>2]|0,ne=c,r[ne>>2]=0,r[ne+4>>2]=0,ne=c+8|0,r[ne>>2]=n,r[ne+4>>2]=s,r[m>>2]=r[c>>2],r[m+4>>2]=r[c+4>>2],r[m+8>>2]=r[c+8>>2],r[m+12>>2]=r[c+12>>2],ii(gt,m),zl(r[t>>2]|0)|0||(gt=cn(8)|0,xu(gt),oi(gt|0,2704,8)),Ti(r[t>>2]|0,m,8),zl(r[t>>2]|0)|0||(gt=cn(8)|0,xu(gt),oi(gt|0,2704,8)),r[m>>2]|0&&(gt=cn(8)|0,eh(gt),oi(gt|0,2736,8)),z=t+288|0,ne=t+292|0,r[ne>>2]=r[z>>2],gt=t+259|0,(We[gt>>0]|We[gt+1>>0]<<8|We[gt+2>>0]<<16|We[gt+3>>0]<<24|0)==-1&&(gt=cn(8)|0,Ba(gt,7606),oi(gt|0,2720,8)),c=m+4|0,_d(z,(r[c>>2]|0)+1|0),gt=r[z>>2]|0,r[gt>>2]=(r[$>>2]|0)+8,r[gt+4>>2]=0,(r[c>>2]|0)>>>0>1){if(Gc(ge,r[t>>2]|0),po(Le,ge),wa(Qe,32,2,8,0),Qc(Le),ls(Qe),!(r[c>>2]|0))z=r[z>>2]|0,s=z;else{s=1;do s>>>0>1?n=r[(r[z>>2]|0)+(s+-1<<3)>>2]|0:n=0,$=Ua(Qe,Le,n,1)|0,n=r[z>>2]|0,gt=n+(s<<3)|0,r[gt>>2]=$,r[gt+4>>2]=(($|0)<0)<<31>>31,s=s+1|0;while(s>>>0<=(r[c>>2]|0)>>>0);s=n,z=n}if(n=r[ne>>2]|0,n-s>>3>>>0>1){m=n-z>>3,c=z,n=1,s=r[c>>2]|0,c=r[c+4>>2]|0;do gt=z+(n<<3)|0,ne=gt,s=ru(r[ne>>2]|0,r[ne+4>>2]|0,s|0,c|0)|0,c=ei()|0,r[gt>>2]=s,r[gt+4>>2]=c,n=n+1|0;while(n>>>0<m>>>0)}za(Qe),th(Le),zc(ge)}Me=st}function vd(t){t=t|0,ie[t+12>>0]=0,ie[t+13>>0]=0}function Dl(t){t=t|0,r[t+8>>2]=0,r[t+4>>2]=0}function fo(t){return t=t|0,m0(t)|0}function Qr(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0;if($=Me,Me=Me+16|0,m=n,z=$,c=s-m|0,c>>>0>4294967279&&mx(t),c>>>0<11?ie[t+11>>0]=c:(ge=c+16&-16,ne=cr(ge)|0,r[t>>2]=ne,r[t+8>>2]=ge|-2147483648,r[t+4>>2]=c,t=ne),(n|0)!=(s|0)){for(m=s-m|0,c=t;Fo(c,n),n=n+1|0,(n|0)!=(s|0);)c=c+1|0;t=t+m|0}ie[z>>0]=0,Fo(t,z),Me=$}function Fo(t,n){t=t|0,n=n|0,ie[t>>0]=ie[n>>0]|0}function Xu(t){t=t|0,Rr(t),rr(t)}function rs(t,n){t=t|0,n=n|0,r[t>>2]=4372,r[t+16>>2]=t}function Xc(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,n=r[n+4>>2]|0,r[t+4>>2]=n,r[t+8>>2]=n+(s*24|0)}function Di(t){t=t|0,r[(r[t>>2]|0)+4>>2]=r[t+4>>2]}function Xi(t,n){t=t|0,n=n|0;var s=0,c=0;s=n+16|0,c=r[s>>2]|0;do if(c)if((n|0)==(c|0)){c=Zs(t)|0,r[t+16>>2]=c,s=r[s>>2]|0,Lf[r[(r[s>>2]|0)+12>>2]&15](s,c);break}else{r[t+16>>2]=c,r[s>>2]=0;break}else r[t+16>>2]=0;while(0)}function Zs(t){return t=t|0,t|0}function Aa(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;m=t+12|0,r[m>>2]=0,r[t+16>>2]=c;do if(n)if(n>>>0>178956970)m=cn(8)|0,La(m,6723),r[m>>2]=5956,oi(m|0,3928,123);else{c=cr(n*24|0)|0;break}else c=0;while(0);r[t>>2]=c,s=c+(s*24|0)|0,r[t+8>>2]=s,r[t+4>>2]=s,r[m>>2]=c+(n*24|0)}function An(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;if(ne=r[t>>2]|0,ge=t+4|0,s=r[ge>>2]|0,$=n+4|0,(s|0)==(ne|0))m=$,z=t,c=r[$>>2]|0,s=ne;else{c=r[$>>2]|0;do s=s+-24|0,Xi(c+-24|0,s),c=(r[$>>2]|0)+-24|0,r[$>>2]=c;while((s|0)!=(ne|0));m=$,z=t,s=r[t>>2]|0}r[z>>2]=c,r[m>>2]=s,ne=n+8|0,$=r[ge>>2]|0,r[ge>>2]=r[ne>>2],r[ne>>2]=$,ne=t+8|0,ge=n+12|0,t=r[ne>>2]|0,r[ne>>2]=r[ge>>2],r[ge>>2]=t,r[n>>2]=r[m>>2]}function Qf(t){t=t|0;var n=0,s=0,c=0,m=0;if(s=r[t+4>>2]|0,c=t+8|0,n=r[c>>2]|0,(n|0)!=(s|0))do m=n+-24|0,r[c>>2]=m,Wc(m),n=r[c>>2]|0;while((n|0)!=(s|0));n=r[t>>2]|0,n|0&&In(n,(r[t+12>>2]|0)-n|0)}function gu(t){return t=t|0,178956970}function Io(t){t=t|0,rr(t)}function ko(t){return t=t|0,t=cr(8)|0,r[t>>2]=4372,t|0}function Do(t,n){t=t|0,n=n|0,r[n>>2]=4372}function No(t){t=t|0}function Kf(t){t=t|0,In(t,8)}function Zc(t,n){t=t|0,n=n|0,Nl(t+4|0,n)}function Zu(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==7183?t+4|0:0)|0}function ju(t){return t=t|0,2664}function jc(t){t=t|0}function Nl(t,n){t=t|0,n=n|0,Bl(t,n)}function Bl(t,n){t=t|0,n=n|0;var s=0,c=0;if(t=n+104|0,n=We[t>>0]|0,s=n>>>7,c=n>>>6&1,(s|0)==1&(c|0)!=0&&(c=cn(8)|0,yu(c),oi(c|0,2632,8)),(s|0)==(c|0))c=cn(8)|0,Ul(c),oi(c|0,2648,8);else{ie[t>>0]=n&63;return}}function yu(t){t=t|0,Ru(t,7076),r[t>>2]=4416}function Ul(t){t=t|0,Ru(t,7144),r[t>>2]=4436}function Yu(t){t=t|0,Rr(t),rr(t)}function Yc(t){t=t|0,Rr(t),rr(t)}function ra(t){t=t|0,r[t>>2]=6092}function zl(t){t=t|0;var n=0;return n=t+12|0,t=(ie[n>>0]|0)==0,ie[n>>0]=0,t|0}function Gl(t){return t=t|0,(ie[t+13>>0]|0)!=0|0}function ho(t,n){t=t|0,n=n|0,t=t+247|0,$0(t,n),(We[t>>0]|We[t+1>>0]<<8)<<16>>16!=2&&(n=cn(8)|0,Jn(n),oi(n|0,2688,8))}function Ju(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;switch(c|0){case 0:break;case 2:{c=r[t+4>>2]|0,n=ru(ru(n|0,s|0,-1,-1)|0,ei()|0,c|0,((c|0)<0)<<31>>31|0)|0,s=ei()|0;break}case 1:{c=r[t+8>>2]|0,n=ru(c|0,((c|0)<0)<<31>>31|0,n|0,s|0)|0,s=ei()|0;break}default:s=0,n=0}m=r[t+4>>2]|0,z=((m|0)<0)<<31>>31,c=t+12|0,(s|0)<0|((s|0)>(z|0)|(s|0)==(z|0)&n>>>0>=m>>>0)?ie[c>>0]=1:(ie[c>>0]=0,r[t+8>>2]=n)}function Na(t){t=t|0,Ru(t,7410),r[t>>2]=4476}function gd(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0;if($=Me,Me=Me+16|0,z=$,Oo(t),m=n+32|0,(We[m>>0]|We[m+1>>0]<<8)<<16>>16){c=n+34|0,n=0;do ge=We[c>>0]|We[c+1>>0]<<8|We[c+2>>0]<<16|We[c+3>>0]<<24,Le=ge+(n*6|0)|0,ne=ge+(n*6|0)+2|0,ge=ge+(n*6|0)+4|0,js(z,(We[Le>>0]|We[Le+1>>0]<<8)&65535,(We[ne>>0]|We[ne+1>>0]<<8)&65535,(We[ge>>0]|We[ge+1>>0]<<8)&65535),Bo(t,z),s=s-((We[ne>>0]|We[ne+1>>0]<<8)&65535)|0,n=n+1|0;while(n>>>0<((We[m>>0]|We[m+1>>0]<<8)&65535)>>>0)}(s|0)<0&&(Le=cn(8)|0,Jn(Le),oi(Le|0,2688,8)),s|0&&(js(z,0,s,2),Bo(t,z)),Me=$}function J0(t,n){t=t|0,n=n|0;var s=0,c=0;return s=Me,Me=Me+16|0,c=s+1|0,ie[c>>0]=ie[s>>0]|0,Ys(t,n,c),Me=s,t|0}function $0(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;if(c=n+2|0,z=We[n>>0]|We[n+1>>0]<<8,ie[t>>0]=z,ie[t+1>>0]=z>>8,z=t+2|0,c=We[c>>0]|We[c+1>>0]<<8,ie[z>>0]=c,ie[z+1>>0]=c>>8,ie[t+4>>0]=ie[n+4>>0]|0,z=n+6|0,ie[t+5>>0]=ie[n+5>>0]|0,c=n+8|0,s=t+6|0,z=We[z>>0]|We[z+1>>0]<<8,ie[s>>0]=z,ie[s+1>>0]=z>>8,s=n+12|0,z=t+8|0,c=We[c>>0]|We[c+1>>0]<<8|We[c+2>>0]<<16|We[c+3>>0]<<24,ie[z>>0]=c,ie[z+1>>0]=c>>8,ie[z+2>>0]=c>>16,ie[z+3>>0]=c>>24,z=t+12|0,s=We[s>>0]|We[s+1>>0]<<8|We[s+2>>0]<<16|We[s+3>>0]<<24,ie[z>>0]=s,ie[z+1>>0]=s>>8,ie[z+2>>0]=s>>16,ie[z+3>>0]=s>>24,z=n+16|0,s=z,s=We[s>>0]|We[s+1>>0]<<8|We[s+2>>0]<<16|We[s+3>>0]<<24,z=z+4|0,z=We[z>>0]|We[z+1>>0]<<8|We[z+2>>0]<<16|We[z+3>>0]<<24,c=t+16|0,$=c,ie[$>>0]=s,ie[$+1>>0]=s>>8,ie[$+2>>0]=s>>16,ie[$+3>>0]=s>>24,c=c+4|0,ie[c>>0]=z,ie[c+1>>0]=z>>8,ie[c+2>>0]=z>>16,ie[c+3>>0]=z>>24,c=n+32|0,z=n+24|0,$=z,$=We[$>>0]|We[$+1>>0]<<8|We[$+2>>0]<<16|We[$+3>>0]<<24,z=z+4|0,z=We[z>>0]|We[z+1>>0]<<8|We[z+2>>0]<<16|We[z+3>>0]<<24,s=t+24|0,m=s,ie[m>>0]=$,ie[m+1>>0]=$>>8,ie[m+2>>0]=$>>16,ie[m+3>>0]=$>>24,s=s+4|0,ie[s>>0]=z,ie[s+1>>0]=z>>8,ie[s+2>>0]=z>>16,ie[s+3>>0]=z>>24,s=n+34|0,z=t+32|0,c=We[c>>0]|We[c+1>>0]<<8,ie[z>>0]=c,ie[z+1>>0]=c>>8,m=t+34|0,t=We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24,t?(bi(t),t=We[z>>0]|We[z+1>>0]<<8):t=c,c=Zn((t&65535)*6|0)|0,ie[m>>0]=c,ie[m+1>>0]=c>>8,ie[m+2>>0]=c>>16,ie[m+3>>0]=c>>24,t<<16>>16&&(t=n+36|0,$=We[s>>0]|We[s+1>>0]<<8,ie[c>>0]=$,ie[c+1>>0]=$>>8,n=n+38|0,$=c+2|0,t=We[t>>0]|We[t+1>>0]<<8,ie[$>>0]=t,ie[$+1>>0]=t>>8,$=c+4|0,n=We[n>>0]|We[n+1>>0]<<8,ie[$>>0]=n,ie[$+1>>0]=n>>8,((We[z>>0]|We[z+1>>0]<<8)&65535)>1)){t=1;do n=s,s=s+6|0,$=We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24,ne=n+8|0,c=$+(t*6|0)|0,ge=We[s>>0]|We[s+1>>0]<<8,ie[c>>0]=ge,ie[c+1>>0]=ge>>8,n=n+10|0,c=$+(t*6|0)+2|0,ne=We[ne>>0]|We[ne+1>>0]<<8,ie[c>>0]=ne,ie[c+1>>0]=ne>>8,$=$+(t*6|0)+4|0,n=We[n>>0]|We[n+1>>0]<<8,ie[$>>0]=n,ie[$+1>>0]=n>>8,t=t+1|0;while(t>>>0<((We[z>>0]|We[z+1>>0]<<8)&65535)>>>0)}}function Jn(t){t=t|0,Ru(t,7354),r[t>>2]=4456}function Qn(t){t=t|0,Rr(t),rr(t)}function da(t){t=t|0,Rr(t),rr(t)}function Bo(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0;ne=Me,Me=Me+32|0,m=ne,z=t+4|0,s=r[z>>2]|0,$=t+8|0;do if((s|0)==(r[$>>2]|0))if(s=((s-(r[t>>2]|0)|0)/12|0)+1|0,c=Q0(t)|0,c>>>0<s>>>0)Ss(t);else{ge=r[t>>2]|0,Le=((r[$>>2]|0)-ge|0)/12|0,$=Le<<1,_u(m,Le>>>0<c>>>1>>>0?$>>>0<s>>>0?s:$:c,((r[z>>2]|0)-ge|0)/12|0,t+8|0),$=m+8|0,z=r[$>>2]|0,r[z>>2]=r[n>>2],r[z+4>>2]=r[n+4>>2],r[z+8>>2]=r[n+8>>2],r[$>>2]=(r[$>>2]|0)+12,$c(t,m),yd(m);break}else Jc(m,t,1),Le=m+4|0,ge=r[Le>>2]|0,r[ge>>2]=r[n>>2],r[ge+4>>2]=r[n+4>>2],r[ge+8>>2]=r[n+8>>2],r[Le>>2]=(r[Le>>2]|0)+12,$u(m);while(0);Me=ne}function js(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0,r[t>>2]=n,r[t+4>>2]=s,r[t+8>>2]=c}function Jc(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,n=r[n+4>>2]|0,r[t+4>>2]=n,r[t+8>>2]=n+(s*12|0)}function $u(t){t=t|0,r[(r[t>>2]|0)+4>>2]=r[t+4>>2]}function _u(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;m=t+12|0,r[m>>2]=0,r[t+16>>2]=c;do if(n)if(n>>>0>357913941)m=cn(8)|0,La(m,6723),r[m>>2]=5956,oi(m|0,3928,123);else{c=cr(n*12|0)|0;break}else c=0;while(0);r[t>>2]=c,s=c+(s*12|0)|0,r[t+8>>2]=s,r[t+4>>2]=s,r[m>>2]=c+(n*12|0)}function $c(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;c=r[t>>2]|0,$=t+4|0,z=n+4|0,m=(r[$>>2]|0)-c|0,s=(r[z>>2]|0)+(((m|0)/-12|0)*12|0)|0,r[z>>2]=s,(m|0)>0?(wo(s|0,c|0,m|0)|0,c=z,s=r[z>>2]|0):c=z,z=r[t>>2]|0,r[t>>2]=s,r[c>>2]=z,z=n+8|0,m=r[$>>2]|0,r[$>>2]=r[z>>2],r[z>>2]=m,z=t+8|0,$=n+12|0,t=r[z>>2]|0,r[z>>2]=r[$>>2],r[$>>2]=t,r[n>>2]=r[c>>2]}function yd(t){t=t|0;var n=0,s=0,c=0;n=r[t+4>>2]|0,s=t+8|0,c=r[s>>2]|0,(c|0)!=(n|0)&&(r[s>>2]=c+(~(((c+-12-n|0)>>>0)/12|0)*12|0)),n=r[t>>2]|0,n|0&&In(n,(r[t+12>>2]|0)-n|0)}function Q0(t){return t=t|0,357913941}function Ys(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;_r(t),r[t>>2]=r[n>>2],s=n+4|0,r[t+4>>2]=r[s>>2],c=n+8|0,r[t+8>>2]=r[c>>2],r[c>>2]=0,r[s>>2]=0,r[n>>2]=0}function _r(t){t=t|0;var n=0,s=0,c=0,m=0;n=r[t>>2]|0,s=n,n|0&&(c=t+4|0,r[c>>2]=s,m=t+8|0,In(n,(r[m>>2]|0)-s|0),r[m>>2]=0,r[c>>2]=0,r[t>>2]=0)}function xu(t){t=t|0,Ru(t,7660),r[t>>2]=4496}function Ba(t,n){t=t|0,n=n|0,Ru(t,n),r[t>>2]=4516}function eh(t){t=t|0,Ru(t,7704),r[t>>2]=4536}function _d(t,n){t=t|0,n=n|0;var s=0,c=0,m=0;s=t+4|0,m=r[t>>2]|0,c=(r[s>>2]|0)-m>>3,c>>>0>=n>>>0?c>>>0>n>>>0&&(r[s>>2]=m+(n<<3)):ep(t,n-c|0)}function po(t,n){t=t|0,n=n|0,r[t>>2]=n,r[t+4>>2]=0,r[t+8>>2]=-1}function wa(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0;r[t+4>>2]=n,r[t+8>>2]=s,r[t+12>>2]=c,r[t+16>>2]=m,r[t+36>>2]=0,r[t+40>>2]=0,r[t+44>>2]=0,Md(t+48|0),r[t+68>>2]=0,r[t+72>>2]=0,r[t+76>>2]=0;do if(m){for(c=t+20|0,r[c>>2]=0,r[t+24>>2]=m,s=m,z=0;s=s>>>1,n=z+1|0,s;)z=n;r[c>>2]=(1<<z|0)==(m|0)?z:n,s=m>>>1,r[t+28>>2]=0-s,s=m+-1-s|0}else if(s=t+20|0,(n+-1|0)>>>0<31){r[s>>2]=n,m=1<<n,r[t+24>>2]=m,s=m>>>1,r[t+28>>2]=0-s,s=m+-1-s|0;break}else{r[s>>2]=32,r[t+24>>2]=0,r[t+28>>2]=-2147483648,s=2147483647;break}while(0);r[t+32>>2]=s,r[t>>2]=0}function Qc(t){t=t|0;var n=0;n=((Wl(r[t>>2]|0)|0)&255)<<24,n=((Wl(r[t>>2]|0)|0)&255)<<16|n,n=n|((Wl(r[t>>2]|0)|0)&255)<<8,r[t+4>>2]=n|(Wl(r[t>>2]|0)|0)&255}function ls(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0,Mn=0,Ar=0,sr=0;Lt=Me,Me=Me+64|0,Ot=Lt+44|0,Bt=Lt,Le=t+36|0,Qe=t+40|0;e:do if((r[Le>>2]|0)==(r[Qe>>2]|0)){st=t+8|0;t:do if(!(r[st>>2]|0))gt=t+20|0;else{for(m=t+20|0,z=t+44|0,$=Ot+4|0,ne=t+44|0,ge=Ot+8|0,c=0;;){if(pa(Bt,(r[m>>2]|0)+1|0,0,0),n=r[Qe>>2]|0,n>>>0<(r[z>>2]|0)>>>0)bd(Ot,Le,1),Hl(r[$>>2]|0,Bt),r[$>>2]=(r[$>>2]|0)+44,Kc(Ot);else{if(n=((n-(r[Le>>2]|0)|0)/44|0)+1|0,s=ih(Le)|0,s>>>0<n>>>0)break;Mn=r[Le>>2]|0,sr=((r[z>>2]|0)-Mn|0)/44|0,Ar=sr<<1,ql(Ot,sr>>>0<s>>>1>>>0?Ar>>>0<n>>>0?n:Ar:s,((r[Qe>>2]|0)-Mn|0)/44|0,ne),Hl(r[ge>>2]|0,Bt),r[ge>>2]=(r[ge>>2]|0)+44,Ed(Le,Ot),nh(Ot)}if(Xn(Bt),c=c+1|0,c>>>0>=(r[st>>2]|0)>>>0){gt=m;break t}}Ss(Le)}while(0);if(r[gt>>2]|0){for($=t+12|0,ne=t+68|0,ge=t+72|0,Le=t+76|0,Qe=Ot+4|0,m=t+76|0,z=Ot+8|0,c=1;;){if(n=r[$>>2]|0,pa(Bt,1<<(c>>>0>n>>>0?n:c),0,0),n=r[ge>>2]|0,n>>>0<(r[Le>>2]|0)>>>0)bd(Ot,ne,1),Hl(r[Qe>>2]|0,Bt),r[Qe>>2]=(r[Qe>>2]|0)+44,Kc(Ot);else{if(n=((n-(r[ne>>2]|0)|0)/44|0)+1|0,s=ih(ne)|0,s>>>0<n>>>0)break;sr=r[ne>>2]|0,Mn=((r[Le>>2]|0)-sr|0)/44|0,Ar=Mn<<1,ql(Ot,Mn>>>0<s>>>1>>>0?Ar>>>0<n>>>0?n:Ar:s,((r[ge>>2]|0)-sr|0)/44|0,m),Hl(r[z>>2]|0,Bt),r[z>>2]=(r[z>>2]|0)+44,Ed(ne,Ot),nh(Ot)}if(Xn(Bt),c=c+1|0,c>>>0>(r[gt>>2]|0)>>>0)break e}Ss(ne)}}while(0);Me=Lt}function Ua(t,n,s,c){return t=t|0,n=n|0,s=s|0,c=c|0,s=(hp(t,n,(r[t+36>>2]|0)+(c*44|0)|0)|0)+s|0,n=r[t+24>>2]|0,(s|0)<0?s+n|0:s-(s>>>0<n>>>0?0:n)|0}function za(t){t=t|0,Vl(t+68|0),Vl(t+36|0)}function th(t){t=t|0}function xd(t){t=t|0,Rr(t),rr(t)}function Ad(t){t=t|0,Rr(t),rr(t)}function K0(t){t=t|0,Rr(t),rr(t)}function ep(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0;ne=Me,Me=Me+32|0,m=ne,z=t+8|0,$=t+4|0,s=r[$>>2]|0;do if((r[z>>2]|0)-s>>3>>>0<n>>>0)if(s=(s-(r[t>>2]|0)>>3)+n|0,c=sp(t)|0,c>>>0<s>>>0)Ss(t);else{ge=r[t>>2]|0,Le=(r[z>>2]|0)-ge|0,z=Le>>2,Qu(m,Le>>3>>>0<c>>>1>>>0?z>>>0<s>>>0?s:z:c,(r[$>>2]|0)-ge>>3,t+8|0),wd(m,n),rp(t,m),np(m);break}else tp(t,n);while(0);Me=ne}function tp(t,n){t=t|0,n=n|0;var s=0,c=0,m=0;m=Me,Me=Me+16|0,c=m,ip(c,t,n),t=c+4|0,n=r[t>>2]|0,s=r[c+8>>2]|0,(n|0)!=(s|0)&&(s=s+-8-n|0,Vh(n|0,0,s+8&-8|0)|0,r[t>>2]=n+((s>>>3)+1<<3)),ap(c),Me=m}function Qu(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;m=t+12|0,r[m>>2]=0,r[t+16>>2]=c;do if(n)if(n>>>0>536870911)m=cn(8)|0,La(m,6723),r[m>>2]=5956,oi(m|0,3928,123);else{c=cr(n<<3)|0;break}else c=0;while(0);r[t>>2]=c,s=c+(s<<3)|0,r[t+8>>2]=s,r[t+4>>2]=s,r[m>>2]=c+(n<<3)}function wd(t,n){t=t|0,n=n|0;var s=0,c=0;c=Me,Me=Me+16|0,s=c,op(s,t+8|0,n),t=r[s>>2]|0,n=r[s+4>>2]|0,(t|0)!=(n|0)&&(n=n+-8-t|0,Vh(t|0,0,n+8&-8|0)|0,r[s>>2]=t+((n>>>3)+1<<3)),up(s),Me=c}function rp(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;c=r[t>>2]|0,$=t+4|0,z=n+4|0,m=(r[$>>2]|0)-c|0,s=(r[z>>2]|0)+(0-(m>>3)<<3)|0,r[z>>2]=s,(m|0)>0?(wo(s|0,c|0,m|0)|0,c=z,s=r[z>>2]|0):c=z,z=r[t>>2]|0,r[t>>2]=s,r[c>>2]=z,z=n+8|0,m=r[$>>2]|0,r[$>>2]=r[z>>2],r[z>>2]=m,z=t+8|0,$=n+12|0,t=r[z>>2]|0,r[z>>2]=r[$>>2],r[$>>2]=t,r[n>>2]=r[c>>2]}function np(t){t=t|0;var n=0,s=0,c=0;n=r[t+4>>2]|0,s=t+8|0,c=r[s>>2]|0,(c|0)!=(n|0)&&(r[s>>2]=c+(~((c+-8-n|0)>>>3)<<3)),n=r[t>>2]|0,n|0&&In(n,(r[t+12>>2]|0)-n|0)}function ip(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,n=r[n+4>>2]|0,r[t+4>>2]=n,r[t+8>>2]=n+(s<<3)}function ap(t){t=t|0,r[(r[t>>2]|0)+4>>2]=r[t+4>>2]}function sp(t){return t=t|0,536870911}function op(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=r[n>>2],r[t+4>>2]=(r[n>>2]|0)+(s<<3),r[t+8>>2]=n}function up(t){t=t|0,r[r[t+8>>2]>>2]=r[t>>2]}function Md(t){t=t|0,r[t+12>>2]=1,r[t+16>>2]=2,r[t+8>>2]=4096,r[t+4>>2]=4,r[t>>2]=4}function Vl(t){t=t|0;var n=0,s=0,c=0;if(s=r[t>>2]|0,s|0){if(c=t+4|0,n=r[c>>2]|0,(n|0)==(s|0))n=s;else{do n=n+-44|0,Xn(n);while((n|0)!=(s|0));n=r[t>>2]|0}r[c>>2]=s,In(n,(r[t+8>>2]|0)-n|0)}}function Xn(t){t=t|0;var n=0;n=r[t+8>>2]|0,n|0&&uo(n),n=r[t+12>>2]|0,n|0&&uo(n),n=r[t+16>>2]|0,n|0&&uo(n)}function Wl(t){t=t|0;var n=0,s=0;return s=t+4|0,n=r[s>>2]|0,(n|0)>=(r[t+8>>2]|0)&&(rh(t),n=r[s>>2]|0),t=r[t+12>>2]|0,r[s>>2]=n+1,ie[t+n>>0]|0}function rh(t){t=t|0;var n=0;if(r[t+4>>2]=0,Ti(r[t>>2]|0,r[t+12>>2]|0,1048576),n=lp(r[t>>2]|0)|0,r[t+8>>2]=n,!n)n=cn(8)|0,cp(n),oi(n|0,2752,8);else return}function lp(t){return t=t|0,r[t+16>>2]|0}function cp(t){t=t|0,Ru(t,7769),r[t>>2]=4556}function fp(t){t=t|0,Rr(t),rr(t)}function pa(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0,$=0;if(r[t>>2]=n,ie[t+4>>0]=s&1,z=t+8|0,r[z>>2]=0,$=t+12|0,r[$>>2]=0,m=t+16|0,r[m>>2]=0,(n+-2|0)>>>0>2046&&(t=cn(8)|0,Ru(t,7789),oi(t|0,3912,8)),r[t+32>>2]=n+-1,n>>>0>16&(s^1)){for(s=3;1<<s+2>>>0<n>>>0;)s=s+1|0;n=1<<s,r[t+36>>2]=n,r[t+40>>2]=15-s,r[m>>2]=lo((n<<2)+8|0)|0,n=r[t>>2]|0}else r[m>>2]=0,r[t+40>>2]=0,r[t+36>>2]=0;if(r[z>>2]=lo(n<<2)|0,m=lo(r[t>>2]<<2)|0,r[$>>2]=m,r[t+20>>2]=0,n=r[t>>2]|0,s=t+24|0,r[s>>2]=n,n=(n|0)!=0,c){if(n){n=0;do r[m+(n<<2)>>2]=r[c+(n<<2)>>2],n=n+1|0;while(n>>>0<(r[t>>2]|0)>>>0)}}else if(n){n=0;do r[m+(n<<2)>>2]=1,n=n+1|0;while(n>>>0<(r[t>>2]|0)>>>0)}sh(t),c=((r[t>>2]|0)+6|0)>>>1,r[s>>2]=c,r[t+28>>2]=c}function bd(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,n=r[n+4>>2]|0,r[t+4>>2]=n,r[t+8>>2]=n+(s*44|0)}function Kc(t){t=t|0,r[(r[t>>2]|0)+4>>2]=r[t+4>>2]}function Hl(t,n){t=t|0,n=n|0;var s=0;r[t>>2]=r[n>>2],ie[t+4>>0]=ie[n+4>>0]|0,s=n+8|0,r[t+8>>2]=r[s>>2],r[t+12>>2]=r[n+12>>2],r[t+16>>2]=r[n+16>>2],r[t+20>>2]=r[n+20>>2],r[t+24>>2]=r[n+24>>2],r[t+28>>2]=r[n+28>>2],r[t+32>>2]=r[n+32>>2],r[t+36>>2]=r[n+36>>2],r[t+40>>2]=r[n+40>>2],r[s>>2]=0,r[s+4>>2]=0,r[s+8>>2]=0}function ql(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;m=t+12|0,r[m>>2]=0,r[t+16>>2]=c;do if(n)if(n>>>0>97612893)m=cn(8)|0,La(m,6723),r[m>>2]=5956,oi(m|0,3928,123);else{c=cr(n*44|0)|0;break}else c=0;while(0);r[t>>2]=c,s=c+(s*44|0)|0,r[t+8>>2]=s,r[t+4>>2]=s,r[m>>2]=c+(n*44|0)}function Ed(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;if(ne=r[t>>2]|0,ge=t+4|0,s=r[ge>>2]|0,$=n+4|0,(s|0)==(ne|0))m=$,z=t,c=r[$>>2]|0,s=ne;else{c=r[$>>2]|0;do s=s+-44|0,ah(c+-44|0,s),c=(r[$>>2]|0)+-44|0,r[$>>2]=c;while((s|0)!=(ne|0));m=$,z=t,s=r[t>>2]|0}r[z>>2]=c,r[m>>2]=s,ne=n+8|0,$=r[ge>>2]|0,r[ge>>2]=r[ne>>2],r[ne>>2]=$,ne=t+8|0,ge=n+12|0,t=r[ne>>2]|0,r[ne>>2]=r[ge>>2],r[ge>>2]=t,r[n>>2]=r[m>>2]}function nh(t){t=t|0;var n=0,s=0,c=0,m=0;if(s=r[t+4>>2]|0,c=t+8|0,n=r[c>>2]|0,(n|0)!=(s|0))do m=n+-44|0,r[c>>2]=m,Xn(m),n=r[c>>2]|0;while((n|0)!=(s|0));n=r[t>>2]|0,n|0&&In(n,(r[t+12>>2]|0)-n|0)}function ih(t){return t=t|0,97612893}function ah(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;s=r[n>>2]|0,r[t>>2]=s,ie[t+4>>0]=ie[n+4>>0]|0,r[t+20>>2]=r[n+20>>2],r[t+24>>2]=r[n+24>>2],r[t+28>>2]=r[n+28>>2],r[t+32>>2]=r[n+32>>2],z=t+36|0,r[z>>2]=r[n+36>>2],r[t+40>>2]=r[n+40>>2],s=s<<2,c=lo(s)|0,r[t+8>>2]=c,m=r[t>>2]|0,m|0&&nu(c|0,r[n+8>>2]|0,m<<2|0)|0,s=lo(s)|0,r[t+12>>2]=s,c=r[t>>2]|0,c|0&&nu(s|0,r[n+12>>2]|0,c<<2|0)|0,s=r[z>>2]|0,s?(c=lo((s<<2)+8|0)|0,r[t+16>>2]=c,s=(r[z>>2]<<2)+8|0,s|0&&nu(c|0,r[n+16>>2]|0,s|0)|0):r[t+16>>2]=0}function sh(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0;if(Bt=t+24|0,m=t+20|0,n=(r[m>>2]|0)+(r[Bt>>2]|0)|0,r[m>>2]=n,n>>>0>32768)if(r[m>>2]=0,!(r[t>>2]|0))n=0;else{c=r[t+12>>2]|0,s=0;do st=c+(s<<2)|0,n=((r[st>>2]|0)+1|0)>>>1,r[st>>2]=n,n=(r[m>>2]|0)+n|0,r[m>>2]=n,s=s+1|0;while(s>>>0<(r[t>>2]|0)>>>0)}st=2147483648/(n>>>0)|0;do if((ie[t+4>>0]|0)==0&&(gt=t+36|0,(r[gt>>2]|0)!=0)){if(r[t>>2]|0){ne=r[t+8>>2]|0,ge=r[t+12>>2]|0,Le=t+40|0,Qe=t+16|0,n=0,z=0,$=0;do{if(s=(Nn(z,st)|0)>>>16,r[ne+($<<2)>>2]=s,z=(r[ge+($<<2)>>2]|0)+z|0,s=s>>>(r[Le>>2]|0),n>>>0<s>>>0){c=$+-1|0,m=r[Qe>>2]|0;do n=n+1|0,r[m+(n<<2)>>2]=c;while((n|0)!=(s|0));n=s}$=$+1|0}while($>>>0<(r[t>>2]|0)>>>0);if(s=r[Qe>>2]|0,r[s>>2]=0,n>>>0>(r[gt>>2]|0)>>>0){n=t;break}}else s=r[t+16>>2]|0,r[s>>2]=0,n=0;do n=n+1|0,r[s+(n<<2)>>2]=(r[t>>2]|0)+-1;while(n>>>0<=(r[gt>>2]|0)>>>0);n=t}else Ot=7;while(0);if((Ot|0)==7)if(!(r[t>>2]|0))n=t;else{c=r[t+8>>2]|0,m=r[t+12>>2]|0,n=0,s=0;do r[c+(n<<2)>>2]=(Nn(s,st)|0)>>>16,s=(r[m+(n<<2)>>2]|0)+s|0,n=n+1|0;while(n>>>0<(r[t>>2]|0)>>>0);n=t}Ot=((r[Bt>>2]|0)*5|0)>>>2,gt=(r[n>>2]<<3)+48|0,Ot=Ot>>>0>gt>>>0?gt:Ot,r[Bt>>2]=Ot,r[t+28>>2]=Ot}function hp(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;s=Ma(n,s)|0,r[t>>2]=s;do if(s){if(s>>>0>=32){s=r[t+28>>2]|0;break}if(c=r[t+12>>2]|0,s>>>0>c>>>0?(c=s-c|0,s=Ma(n,(r[t+68>>2]|0)+((s+-1|0)*44|0)|0)|0,c=s<<c|(Td(n,c)|0)):c=Ma(n,(r[t+68>>2]|0)+((s+-1|0)*44|0)|0)|0,s=r[t>>2]|0,(c|0)<(1<<s+-1|0)){s=c+1+(-1<<s)|0;break}else{s=c+1|0;break}}else s=dp(n,t+48|0)|0;while(0);return s|0}function Ma(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0;if(gt=t+8|0,st=r[gt>>2]|0,m=r[n+16>>2]|0,m){if(c=t+4|0,s=r[c>>2]|0,Qe=st>>>15,r[gt>>2]=Qe,ge=(s>>>0)/(Qe>>>0)|0,ne=ge>>>(r[n+40>>2]|0),z=r[m+(ne<<2)>>2]|0,ne=(r[m+(ne+1<<2)>>2]|0)+1|0,$=z+1|0,Le=r[n+8>>2]|0,ne>>>0>$>>>0){m=z,z=ne;do $=(z+m|0)>>>1,ne=(r[Le+($<<2)>>2]|0)>>>0>ge>>>0,m=ne?m:$,z=ne?$:z,$=m+1|0;while(z>>>0>$>>>0);z=m}m=Nn(r[Le+(z<<2)>>2]|0,Qe)|0,(z|0)==(r[n+32>>2]|0)?$=st:$=Nn(r[Le+($<<2)>>2]|0,Qe)|0}else{Le=st>>>15,r[gt>>2]=Le,ne=r[n>>2]|0,Qe=r[n+8>>2]|0,c=t+4|0,s=r[c>>2]|0,ge=ne>>>1,m=0,$=st,z=0;do Ot=Nn(r[Qe+(ge<<2)>>2]|0,Le)|0,st=Ot>>>0>s>>>0,$=st?Ot:$,m=st?m:Ot,z=st?z:ge,ne=st?ge:ne,ge=(z+ne|0)>>>1;while((ge|0)!=(z|0))}return r[c>>2]=s-m,Ot=$-m|0,r[gt>>2]=Ot,Ot>>>0<16777216&&ef(t),gt=(r[n+12>>2]|0)+(z<<2)|0,r[gt>>2]=(r[gt>>2]|0)+1,gt=n+28|0,Ot=(r[gt>>2]|0)+-1|0,r[gt>>2]=Ot,Ot||sh(n),z|0}function Td(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;return n>>>0>19?(s=(S(t)|0)&65535,(Td(t,n+-16|0)|0)<<16|s|0):(c=t+4|0,m=r[c>>2]|0,z=t+8|0,s=(r[z>>2]|0)>>>n,r[z>>2]=s,n=(m>>>0)/(s>>>0)|0,r[c>>2]=m-(Nn(n,s)|0),s>>>0<16777216&&ef(t),n|0)}function dp(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0;return c=t+8|0,m=r[c>>2]|0,s=Nn(m>>>13,r[n+8>>2]|0)|0,z=t+4|0,$=r[z>>2]|0,ne=$>>>0>=s>>>0,ne?(r[z>>2]=$-s,s=m-s|0,r[c>>2]=s):(r[c>>2]=s,$=n+12|0,r[$>>2]=(r[$>>2]|0)+1),s>>>0<16777216&&ef(t),$=n+4|0,t=(r[$>>2]|0)+-1|0,r[$>>2]=t,t||A(n),ne&1|0}function ef(t){t=t|0;var n=0,s=0,c=0,m=0;n=t+4|0,s=t+8|0,c=r[n>>2]|0;do c=c<<8|(Wl(r[t>>2]|0)|0)&255,r[n>>2]=c,m=r[s>>2]<<8,r[s>>2]=m;while(m>>>0<16777216)}function S(t){t=t|0;var n=0,s=0,c=0,m=0;return s=t+4|0,m=r[s>>2]|0,n=t+8|0,c=(r[n>>2]|0)>>>16,r[n>>2]=c,n=(m>>>0)/(c>>>0)|0,r[s>>2]=m-(Nn(n,c)|0),ef(t),n&65535|0}function A(t){t=t|0;var n=0,s=0,c=0,m=0,z=0;m=r[t>>2]|0,s=t+16|0,n=(r[s>>2]|0)+m|0,r[s>>2]=n,n>>>0>8192?(c=(n+1|0)>>>1,r[s>>2]=c,z=t+12|0,n=((r[z>>2]|0)+1|0)>>>1,r[z>>2]=n,(n|0)==(c|0)?(n=c+1|0,r[s>>2]=n,s=n,n=c):s=c):(s=n,n=r[t+12>>2]|0),r[t+8>>2]=(Nn(n,2147483648/(s>>>0)|0)|0)>>>18,z=m*5|0,z=z>>>0>259?64:z>>>2,r[t>>2]=z,r[t+4>>2]=z}function k(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0;Qe=Me,Me=Me+32|0,z=Qe+16|0,$=Qe+8|0,ne=Qe,ge=t+336|0,c=ge,m=t+259|0,(r[c+4>>2]|0)==0&&(r[c>>2]|0)==(We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24|0)?(c=t+320|0,s=r[t+320>>2]|0,Le=5):(c=t+320|0,s=r[c>>2]|0,m=s,(s|0)!=0&&(r[t+312>>2]|0)!=0||(s=m,Le=5)),(Le|0)==5&&(Le=t+320|0,r[z>>2]=s,r[Le>>2]=0,s=t+324|0,r[z+4>>2]=r[s>>2],r[s>>2]=0,Il(z),m=t+312|0,r[z>>2]=r[m>>2],r[m>>2]=0,st=t+316|0,r[z+4>>2]=r[st>>2],r[st>>2]=0,Gn(z),gt=cr(12)|0,po(gt,t+4|0),r[ne>>2]=0,r[z>>2]=r[ne>>2],Pe($,gt,z),gt=r[$>>2]|0,r[$>>2]=r[m>>2],r[m>>2]=gt,gt=$+4|0,ne=r[gt>>2]|0,r[gt>>2]=r[st>>2],r[st>>2]=ne,Gn($),le($,r[m>>2]|0,t+300|0),m=r[$>>2]|0,st=$+4|0,ne=r[st>>2]|0,r[$>>2]=0,r[st>>2]=0,r[z>>2]=r[Le>>2],r[Le>>2]=m,r[z+4>>2]=r[s>>2],r[s>>2]=ne,Il(z),Il($),s=t+328|0,ne=s,ne=ru(r[ne>>2]|0,r[ne+4>>2]|0,1,0)|0,Le=ei()|0,r[s>>2]=ne,r[s+4>>2]=Le,s=ge,r[s>>2]=0,r[s+4>>2]=0,s=r[c>>2]|0),km[r[r[s>>2]>>2]&63](s,n)|0,Le=ge,Le=ru(r[Le>>2]|0,r[Le+4>>2]|0,1,0)|0,st=ei()|0,gt=ge,r[gt>>2]=Le,r[gt+4>>2]=st,Me=Qe}function le(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;$=Me,Me=Me+64|0,c=$+56|0,m=$,z=Ht(s)|0,(z|0)==-1&&($=cn(8)|0,Wt($),oi($|0,2784,8)),s=yr(s)|0;e:do if(s)br(c,n),Wr(r[c>>2]|0),(z|2|0)==3&&vr(r[c>>2]|0),(z|1|0)==3&&rn(r[c>>2]|0),z=r[c>>2]|0,$t(m,s),Yr(z,m),Mr(m),r[t>>2]=r[c>>2],z=c+4|0,r[t+4>>2]=r[z>>2],r[c>>2]=0,r[z>>2]=0,Nr(c);else switch(z|0){case 0:{z=cr(4788)|0,fn(z),an(t,n,z);break e}case 1:{z=cr(5116)|0,na(z),Hn(t,n,z);break e}case 2:{z=cr(5104)|0,ws(z),ai(t,n,z);break e}case 3:{z=cr(5432)|0,Au(z),Uo(t,n,z);break e}default:{r[t>>2]=0,r[t+4>>2]=0;break e}}while(0);Me=$}function Pe(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4576,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,De(t,c),Me=s}function De(t,n){t=t|0,n=n|0}function He(t){t=t|0,vi(t),rr(t)}function nt(t){t=t|0,t=r[t+12>>2]|0,t|0&&(th(t),rr(t))}function Tt(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==7983?t+12|0:0)|0}function At(t){t=t|0,In(t,16)}function Ht(t){t=t|0;var n=0,s=0;n=(r[t+4>>2]|0)-(r[t>>2]|0)|0;e:do if((n|0)!=0&&(s=((n|0)/12|0)+(((yr(t)|0)!=0)<<31>>31)|0,(s|0)!=0)&&(n=r[t>>2]|0,!(mo(n,Ni()|0)|0))){switch(s|0){case 1:{t=0;break e}case 2:{if(ba((r[t>>2]|0)+12|0,Ms()|0)|0){t=1;break e}if(ba((r[t>>2]|0)+12|0,vo()|0)|0){t=2;break e}break}case 3:{if(ba((r[t>>2]|0)+12|0,Ms()|0)|0&&(s=(r[t>>2]|0)+24|0,ba(s,vo()|0)|0)){t=3;break e}break}default:}t=-1}else t=-1;while(0);return t|0}function Wt(t){t=t|0,Ru(t,8131),r[t>>2]=4604}function yr(t){t=t|0;var n=0,s=0;return n=r[t+4>>2]|0,(n|0)!=(r[t>>2]|0)&&(s=n,(r[s+-12>>2]|0)==0)&&(r[s+-4>>2]|0)==2?t=r[s+-8>>2]|0:t=0,t|0}function br(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;s=Me,Me=Me+16|0,c=s+4|0,z=s,m=cr(24)|0,uh(m,n),r[z>>2]=0,r[c>>2]=r[z>>2],Gr(t,m,c),Me=s}function Wr(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(4792)|0,zo($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],wu(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function vr(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(336)|0,nf($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],yp(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function rn(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(324)|0,R2($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],dv(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function Yr(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,$=ge+12|0,ne=ge,c=ge+8|0,z=cr(64)|0,is(z,r[t+4>>2]|0,n),m=t+8|0,r[c>>2]=0,r[$>>2]=r[c>>2],Id(ne,z,$),z=t+12|0,n=r[z>>2]|0,c=t+16|0;do if(n>>>0>=(r[c>>2]|0)>>>0)if(n=(n-(r[m>>2]|0)>>3)+1|0,s=qo(m)|0,s>>>0<n>>>0)Ss(m);else{Le=r[m>>2]|0,Qe=(r[c>>2]|0)-Le|0,c=Qe>>2,Vo($,Qe>>3>>>0<s>>>1>>>0?c>>>0<n>>>0?n:c:s,(r[z>>2]|0)-Le>>3,t+16|0),t=$+8|0,z=r[t>>2]|0,r[z>>2]=r[ne>>2],c=ne+4|0,r[z+4>>2]=r[c>>2],r[ne>>2]=0,r[c>>2]=0,r[t>>2]=z+8,Wo(m,$),Ho($);break}else Es($,m,1),Qe=$+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[ne>>2],t=ne+4|0,r[Le+4>>2]=r[t>>2],r[ne>>2]=0,r[t>>2]=0,r[Qe>>2]=Le+8,Go($);while(0);pi(ne),Me=ge}function $t(t,n){t=t|0,n=n|0;var s=0,c=0;s=Me,Me=Me+48|0,c=s,r[t>>2]=n,ie[t+4>>0]=0,zv(t+8|0,n),zv(t+20|0,n),pa(c,256,0,0),rl(t+32|0,n,c),Xn(c),Me=s}function Mr(t){t=t|0,J2(t+32|0),Ev(t+20|0),Ev(t+8|0)}function Nr(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function an(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;c=Me,Me=Me+16|0,m=c+4|0,$=c,z=cr(12)|0,$2(z,n,s),r[$>>2]=0,r[m>>2]=r[$>>2],Vv(t,z,m),Me=c}function fn(t){t=t|0,Sd(t),Op(t+4784|0)}function Hn(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;c=Me,Me=Me+16|0,m=c+4|0,$=c,z=cr(12)|0,n1(z,n,s),r[$>>2]=0,r[m>>2]=r[$>>2],qv(t,z,m),Me=c}function na(t){t=t|0,Sd(t),d1(t+4784|0)}function ai(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;c=Me,Me=Me+16|0,m=c+4|0,$=c,z=cr(12)|0,p1(z,n,s),r[$>>2]=0,r[m>>2]=r[$>>2],m1(t,z,m),Me=c}function ws(t){t=t|0,Sd(t),hh(t+4784|0)}function Uo(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;c=Me,Me=Me+16|0,m=c+4|0,$=c,z=cr(12)|0,A1(z,n,s),r[$>>2]=0,r[m>>2]=r[$>>2],w1(t,z,m),Me=c}function Au(t){t=t|0,Sd(t),S1(t+4784|0)}function mo(t,n){return t=t|0,n=n|0,(ba(t,n)|0)^1|0}function Ni(){return(ie[21456]|0)==0&&yc(21456)|0&&(js(21536,6,20,2),Kt(21456)),21536}function ba(t,n){return t=t|0,n=n|0,(r[t>>2]|0)==(r[n>>2]|0)&&(r[t+8>>2]|0)==(r[n+8>>2]|0)?t=(r[t+4>>2]|0)==(r[n+4>>2]|0):t=0,t|0}function Ms(){return(ie[21464]|0)==0&&yc(21464)|0&&(js(21548,7,8,2),Kt(21464)),21548}function vo(){return(ie[21472]|0)==0&&yc(21472)|0&&(js(21560,8,6,2),Kt(21472)),21560}function oh(t){t=t|0,Rr(t),rr(t)}function uh(t,n){t=t|0,n=n|0,mn(t),r[t>>2]=4624,r[t+4>>2]=n,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,ie[t+20>>0]=1}function Gr(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4664,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,ns(t,c),Me=s}function mn(t){t=t|0,r[t>>2]=4644}function kn(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;if(ge=Me,Me=Me+16|0,z=ge,s=r[t+8>>2]|0,$=r[t+12>>2]|0,(s|0)!=($|0)){ne=z+4|0;do c=r[s>>2]|0,r[z>>2]=c,m=r[s+4>>2]|0,r[ne>>2]=m,m|0&&(m=m+4|0,r[m>>2]=(r[m>>2]|0)+1),n=km[r[(r[c>>2]|0)+12>>2]&63](c,n)|0,pi(z),s=s+8|0;while((s|0)!=($|0))}return s=t+20|0,ie[s>>0]|0&&(ie[s>>0]=0,Qc(r[t+4>>2]|0)),Me=ge,n|0}function wi(t){t=t|0,r[t>>2]=4624,Ca(t+8|0),Li(t)}function Mi(t){t=t|0,wi(t),rr(t)}function Li(t){t=t|0}function Si(t){t=t|0,Cl()}function pi(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function Ca(t){t=t|0;var n=0,s=0,c=0;if(s=r[t>>2]|0,s|0){if(c=t+4|0,n=r[c>>2]|0,(n|0)==(s|0))n=s;else{do n=n+-8|0,pi(n);while((n|0)!=(s|0));n=r[t>>2]|0}r[c>>2]=s,In(n,(r[t+8>>2]|0)-n|0)}}function ns(t,n){t=t|0,n=n|0}function Ga(t){t=t|0,vi(t),rr(t)}function Va(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+8>>2]&255](t)}function bs(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==8546?t+12|0:0)|0}function Fs(t){t=t|0,In(t,16)}function zo(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=4692,r[t+4>>2]=n,Sd(t+8|0)}function wu(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4740,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function Es(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,n=r[n+4>>2]|0,r[t+4>>2]=n,r[t+8>>2]=n+(s<<3)}function Go(t){t=t|0,r[(r[t>>2]|0)+4>>2]=r[t+4>>2]}function Vo(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;m=t+12|0,r[m>>2]=0,r[t+16>>2]=c;do if(n)if(n>>>0>536870911)m=cn(8)|0,La(m,6723),r[m>>2]=5956,oi(m|0,3928,123);else{c=cr(n<<3)|0;break}else c=0;while(0);r[t>>2]=c,s=c+(s<<3)|0,r[t+8>>2]=s,r[t+4>>2]=s,r[m>>2]=c+(n<<3)}function Wo(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;if(ne=r[t>>2]|0,ge=t+4|0,s=r[ge>>2]|0,$=n+4|0,(s|0)==(ne|0))m=$,z=t,c=r[$>>2]|0,s=ne;else{c=r[$>>2]|0;do z=s,s=s+-8|0,r[c+-8>>2]=r[s>>2],z=z+-4|0,r[c+-4>>2]=r[z>>2],r[s>>2]=0,r[z>>2]=0,c=(r[$>>2]|0)+-8|0,r[$>>2]=c;while((s|0)!=(ne|0));m=$,z=t,s=r[t>>2]|0}r[z>>2]=c,r[m>>2]=s,ne=n+8|0,$=r[ge>>2]|0,r[ge>>2]=r[ne>>2],r[ne>>2]=$,ne=t+8|0,ge=n+12|0,t=r[ne>>2]|0,r[ne>>2]=r[ge>>2],r[ge>>2]=t,r[n>>2]=r[m>>2]}function Ho(t){t=t|0;var n=0,s=0,c=0,m=0;if(s=r[t+4>>2]|0,c=t+8|0,n=r[c>>2]|0,(n|0)!=(s|0))do m=n+-8|0,r[c>>2]=m,pi(m),n=r[c>>2]|0;while((n|0)!=(s|0));n=r[t>>2]|0,n|0&&In(n,(r[t+12>>2]|0)-n|0)}function qo(t){return t=t|0,536870911}function Xo(t){t=t|0,r[t>>2]=4716}function Sd(t){t=t|0,fb(t),hb(t+3980|0),db(t+4380|0),ie[t+4780>>0]=0,ie[t+4781>>0]=0}function p2(t){t=t|0,r[t>>2]=4692,Rd(t+8|0),go(t)}function sb(t){t=t|0,p2(t),rr(t)}function ob(t,n){return t=t|0,n=n|0,n|0}function ub(t,n){return t=t|0,n=n|0,Cd(t+8|0,r[t+4>>2]|0,n)|0}function go(t){t=t|0}function lb(t){t=t|0,go(t),rr(t)}function cb(t,n){return t=t|0,n=n|0,n|0}function fb(t){t=t|0;var n=0,s=0;m2(t),v2(t+52|0),v2(t+436|0),pa(t+852|0,64,0,0),ie[t+3976>>0]=0,n=t+20|0,s=n+32|0;do zt[n>>1]=0,n=n+2|0;while((n|0)<(s|0));n=cr(44)|0,pa(n,256,0,0),r[t+896>>2]=n,n=cr(44)|0,pa(n,256,0,0),r[t+900>>2]=n,n=t+820|0,r[n>>2]=0,r[n+4>>2]=0,r[n+8>>2]=0,r[n+12>>2]=0,r[n+16>>2]=0,r[n+20>>2]=0,r[n+24>>2]=0,r[n+28>>2]=0,n=0;do s=cr(44)|0,pa(s,256,0,0),r[t+904+(n<<2)>>2]=s,s=cr(44)|0,pa(s,256,0,0),r[t+1928+(n<<2)>>2]=s,s=cr(44)|0,pa(s,256,0,0),r[t+2952+(n<<2)>>2]=s,n=n+1|0;while(n>>>0<256)}function hb(t){t=t|0,yo(t,16,4,8,0),yo(t+80|0,16,1,8,0),yo(t+160|0,32,2,8,0),yo(t+240|0,32,22,8,0),yo(t+320|0,32,20,8,0)}function db(t){t=t|0,wa(t,16,4,8,0),wa(t+80|0,16,1,8,0),wa(t+160|0,32,2,8,0),wa(t+240|0,32,22,8,0),wa(t+320|0,32,20,8,0)}function pb(t){t=t|0,_o(t+320|0),_o(t+240|0),_o(t+160|0),_o(t+80|0),_o(t)}function mb(t){t=t|0;var n=0,s=0;n=r[t+896>>2]|0,n|0&&(Xn(n),rr(n)),n=r[t+900>>2]|0,n|0&&(Xn(n),rr(n)),s=0;do n=r[t+904+(s<<2)>>2]|0,n|0&&(Xn(n),rr(n)),n=r[t+1928+(s<<2)>>2]|0,n|0&&(Xn(n),rr(n)),n=r[t+2952+(s<<2)>>2]|0,n|0&&(Xn(n),rr(n)),s=s+1|0;while((s|0)!=256);Xn(t+852|0)}function m2(t){t=t|0;var n=0;ie[t>>0]=0,ie[t+1>>0]=0,ie[t+2>>0]=0,ie[t+3>>0]=0,n=t+4|0,ie[n>>0]=0,ie[n+1>>0]=0,ie[n+2>>0]=0,ie[n+3>>0]=0,t=t+12|0,n=t,ie[n>>0]=0,ie[n+1>>0]=0,ie[n+2>>0]=0,ie[n+3>>0]=0,t=t+4|0,ie[t>>0]=0,ie[t+1>>0]=0,ie[t+2>>0]=0,ie[t+3>>0]=0}function v2(t){t=t|0;var n=0;n=t+384|0;do vb(t),t=t+24|0;while((t|0)!=(n|0))}function vb(t){t=t|0,gb(t)}function gb(t){t=t|0,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,ie[t+20>>0]=1}function yo(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0;r[t+4>>2]=n,r[t+8>>2]=s,r[t+12>>2]=c,r[t+16>>2]=m,r[t+36>>2]=0,r[t+40>>2]=0,r[t+44>>2]=0,Md(t+48|0),r[t+68>>2]=0,r[t+72>>2]=0,r[t+76>>2]=0;do if(m){for(c=t+20|0,r[c>>2]=0,r[t+24>>2]=m,s=m,z=0;s=s>>>1,n=z+1|0,s;)z=n;r[c>>2]=(1<<z|0)==(m|0)?z:n,s=m>>>1,r[t+28>>2]=0-s,s=m+-1-s|0}else if(s=t+20|0,(n+-1|0)>>>0<31){r[s>>2]=n,m=1<<n,r[t+24>>2]=m,s=m>>>1,r[t+28>>2]=0-s,s=m+-1-s|0;break}else{r[s>>2]=32,r[t+24>>2]=0,r[t+28>>2]=-2147483648,s=2147483647;break}while(0);r[t+32>>2]=s,r[t>>2]=0}function _o(t){t=t|0;var n=0,s=0,c=0,m=0,z=0;if(z=t+36|0,s=r[z>>2]|0,c=t+40|0,n=r[c>>2]|0,(n|0)!=(s|0))do n=n+-44|0,Xn(n);while((n|0)!=(s|0));if(r[c>>2]=s,c=t+68|0,m=r[c>>2]|0,s=t+72|0,n=r[s>>2]|0,(n|0)!=(m|0))do n=n+-44|0,Xn(n);while((n|0)!=(m|0));r[s>>2]=m,Vl(c),Vl(z)}function Rd(t){t=t|0,yb(t+4380|0),pb(t+3980|0),mb(t)}function yb(t){t=t|0,za(t+320|0),za(t+240|0),za(t+160|0),za(t+80|0),za(t)}function Cd(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0;if(Qe=Me,Me=Me+32|0,Le=Qe,c=t+4781|0,ie[c>>0]|0||(_b(t+4380|0),ie[c>>0]=1),c=t+3976|0,ie[c>>0]|0)ne=Ma(n,t+852|0)|0,ne?(ne&32|0&&y2((Ma(n,r[t+904+(((g2(t)|0)&255)<<2)>>2]|0)|0)&255,t),ge=t+14|0,z=ie[ge>>0]|0,c=z&7,z=(z&255)>>>3&7,m=We[16+(z<<3)+c>>0]|0,c=We[80+(z<<3)+c>>0]|0,ne&16?(st=t+20+(m<<1)|0,$=(Ua(t+4380|0,n,Yt[st>>1]|0,m>>>0<3?m:3)|0)&65535,zt[st>>1]=$):$=zt[t+20+(m<<1)>>1]|0,zt[t+12>>1]=$,ne&8|0&&(st=t+15|0,ie[st>>0]=Ma(n,r[t+1928+(We[st>>0]<<2)>>2]|0)|0),ne&4|0&&(ge=Ma(n,r[t+896+(((We[ge>>0]|0)>>>6&1)<<2)>>2]|0)|0,st=t+16|0,ie[st>>0]=tf(ge+(ie[st>>0]|0)|0)|0),ne&2|0&&(st=t+17|0,ie[st>>0]=Ma(n,r[t+2952+(We[st>>0]<<2)>>2]|0)|0),ne&1&&(st=t+18|0,zt[st>>1]=Ua(t+4460|0,n,Yt[st>>1]|0,0)|0)):(st=ie[t+14>>0]|0,c=st&7,st=(st&255)>>>3&7,z=st,m=We[16+(st<<3)+c>>0]|0,c=We[80+(st<<3)+c>>0]|0),$=t+52+(m*24|0)|0,ne=t+4540|0,ge=(z|0)==1&1,z=Ua(ne,n,_2($)|0,ge)|0,r[Le>>2]=z,r[t>>2]=(r[t>>2]|0)+z,x2($,Le),$=t+436+(m*24|0)|0,z=_2($)|0,m=av(ne)|0,st=t+4620|0,m=Ua(st,n,z,(m>>>0<20?m&-2:20)|ge)|0,r[Le>>2]=m,z=t+4|0,r[z>>2]=(r[z>>2]|0)+m,x2($,Le),Le=av(ne)|0,Le=(av(st)|0)+Le|0,st=t+820+(c<<2)|0,Le=Ua(t+4700|0,n,r[st>>2]|0,(Le>>>0<36?Le>>>1&2147483646:18)|ge)|0,r[t+8>>2]=Le,r[st>>2]=Le,Kn(t,s);else{ie[c>>0]=1,mp(pp(n)|0,s,20),xb(Le,s),z=t,c=Le,m=z+20|0;do ie[z>>0]=ie[c>>0]|0,z=z+1|0,c=c+1|0;while((z|0)<(m|0));zt[t+12>>1]=0}return Me=Qe,s+20|0}function _b(t){t=t|0,ls(t),ls(t+80|0),ls(t+160|0),ls(t+240|0),ls(t+320|0)}function pp(t){return t=t|0,r[t>>2]|0}function mp(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0;if(ge=t+4|0,c=r[ge>>2]|0,ne=(r[t+8>>2]|0)-c|0,ne=ne>>>0>s>>>0?s:ne,$=t+12|0,m=(r[$>>2]|0)+c|0,z=m+ne|0,ne){for(c=m,m=n;ie[m>>0]=ie[c>>0]|0,c=c+1|0,(c|0)!=(z|0);)m=m+1|0;c=r[ge>>2]|0}if(r[ge>>2]=c+ne,s=s-ne|0,s|0){for(rh(t),m=(r[$>>2]|0)+(r[ge>>2]|0)|0,z=m+s|0,c=n+ne|0;ie[c>>0]=ie[m>>0]|0,m=m+1|0,(m|0)!=(z|0);)c=c+1|0;r[ge>>2]=(r[ge>>2]|0)+s}}function xb(t,n){t=t|0,n=n|0,m2(t),r[t>>2]=Pr(n)|0,r[t+4>>2]=Pr(n+4|0)|0,r[t+8>>2]=Pr(n+8|0)|0,zt[t+12>>1]=Qa(n+12|0)|0,y2(vp(n+14|0)|0,t),ie[t+15>>0]=vp(n+15|0)|0,ie[t+16>>0]=sv(n+16|0)|0,ie[t+17>>0]=sv(n+17|0)|0,zt[t+18>>1]=Qa(n+18|0)|0}function g2(t){return t=t|0,ie[t+14>>0]|0}function y2(t,n){t=t|0,n=n|0,ie[n+14>>0]=t}function tf(t){return t=t|0,t&255|0}function _2(t){return t=t|0,r[t+8>>2]|0}function x2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;ge=t+20|0;do if(ie[ge>>0]|0){if(m=r[n>>2]|0,$=t+8|0,s=r[$>>2]|0,z=t+12|0,c=r[z>>2]|0,(m|0)>=(s|0)){s=t+16|0,(m|0)<(c|0)?(r[s>>2]=c,r[z>>2]=r[n>>2]):r[s>>2]=m,ie[ge>>0]=0;break}if(r[t+16>>2]=c,r[z>>2]=s,s=r[n>>2]|0,c=r[t>>2]|0,m=t+4|0,z=r[m>>2]|0,(s|0)<(c|0)){r[$>>2]=z,r[m>>2]=c,r[t>>2]=r[n>>2];break}if((s|0)<(z|0)){r[$>>2]=z,r[m>>2]=r[n>>2];break}else{r[$>>2]=s;break}}else{if(ne=t+8|0,s=r[ne>>2]|0,c=r[n>>2]|0,m=t+4|0,z=r[m>>2]|0,(s|0)>=(c|0)){(z|0)<(c|0)?(r[t>>2]=z,r[m>>2]=r[n>>2]):r[t>>2]=c,ie[ge>>0]=1;break}if(r[t>>2]=z,r[m>>2]=s,m=t+16|0,z=r[m>>2]|0,$=r[n>>2]|0,s=t+12|0,c=r[s>>2]|0,(z|0)<($|0)){r[ne>>2]=c,r[s>>2]=z,r[m>>2]=r[n>>2];break}if((c|0)<($|0)){r[ne>>2]=c,r[s>>2]=r[n>>2];break}else{r[ne>>2]=$;break}}while(0)}function av(t){return t=t|0,r[t>>2]|0}function Kn(t,n){t=t|0,n=n|0;var s=0;Ld(We[t>>0]|We[t+1>>0]<<8|We[t+2>>0]<<16|We[t+3>>0]<<24,n),s=t+4|0,Ld(We[s>>0]|We[s+1>>0]<<8|We[s+2>>0]<<16|We[s+3>>0]<<24,n+4|0),s=t+8|0,Ld(We[s>>0]|We[s+1>>0]<<8|We[s+2>>0]<<16|We[s+3>>0]<<24,n+8|0),s=t+12|0,Xl(We[s>>0]|We[s+1>>0]<<8,n+12|0),gp(g2(t)|0,n+14|0),gp(ie[t+15>>0]|0,n+15|0),rf(ie[t+16>>0]|0,n+16|0),rf(ie[t+17>>0]|0,n+17|0),t=t+18|0,Xl(We[t>>0]|We[t+1>>0]<<8,n+18|0)}function Pr(t){return t=t|0,Pd(t)|0}function Qa(t){return t=t|0,(ie[t+1>>0]<<8|We[t>>0])&65535|0}function vp(t){return t=t|0,ie[t>>0]|0}function sv(t){return t=t|0,ie[t>>0]|0}function Pd(t){return t=t|0,(We[t+1>>0]|0)<<8|(We[t>>0]|0)|(We[t+2>>0]|0)<<16|(We[t+3>>0]|0)<<24|0}function Ld(t,n){t=t|0,n=n|0,Mu(t,n)}function Xl(t,n){t=t|0,n=n|0,ie[n+1>>0]=(t&65535)>>>8,ie[n>>0]=t}function gp(t,n){t=t|0,n=n|0,ie[n>>0]=t}function rf(t,n){t=t|0,n=n|0,ie[n>>0]=t}function Mu(t,n){t=t|0,n=n|0,ie[n+3>>0]=t>>>24,ie[n+2>>0]=t>>>16,ie[n+1>>0]=t>>>8,ie[n>>0]=t}function cs(t,n){t=t|0,n=n|0}function Ku(t){t=t|0,vi(t),rr(t)}function Zo(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function ov(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==9202?t+12|0:0)|0}function uv(t){t=t|0,In(t,16)}function nf(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=4768,r[t+4>>2]=n,Zl(t+8|0)}function yp(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4792,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function Zl(t){t=t|0,xp(t),jl(t+164|0),af(t+244|0),ie[t+324>>0]=0,ie[t+325>>0]=0}function _p(t){t=t|0,r[t>>2]=4768,sf(t+8|0),go(t)}function Od(t){t=t|0,_p(t),rr(t)}function lv(t,n){return t=t|0,n=n|0,of(t+8|0,r[t+4>>2]|0,n)|0}function xp(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0;for(z=Me,Me=Me+16|0,c=z,ie[t>>0]=0,pa(t+4|0,516,0,0),pa(t+48|0,6,0,0),r[t+92>>2]=0,r[t+96>>2]=0,s=t+100|0,A2(s),wp(c),m=r[c>>2]|0,c=r[c+4>>2]|0,n=4;$=s,ne=$,ie[ne>>0]=m,ie[ne+1>>0]=m>>8,ie[ne+2>>0]=m>>16,ie[ne+3>>0]=m>>24,$=$+4|0,ie[$>>0]=c,ie[$+1>>0]=c>>8,ie[$+2>>0]=c>>16,ie[$+3>>0]=c>>24,n=n+-1|0,n;)s=s+8|0;ne=t+132|0,r[ne>>2]=0,r[ne+4>>2]=0,r[ne+8>>2]=0,r[ne+12>>2]=0,r[ne+16>>2]=0,r[ne+20>>2]=0,r[ne+24>>2]=0,r[ne+28>>2]=0,Me=z}function jl(t){t=t|0,yo(t,32,9,8,0)}function af(t){t=t|0,wa(t,32,9,8,0)}function cv(t){t=t|0,_o(t)}function Ap(t){t=t|0,Xn(t+48|0),Xn(t+4|0)}function A2(t){t=t|0;var n=0;n=t+32|0;do wp(t),t=t+8|0;while((t|0)!=(n|0))}function wp(t){t=t|0;var n=0;n=t,ie[n>>0]=0,ie[n+1>>0]=0,ie[n+2>>0]=0,ie[n+3>>0]=0,t=t+4|0,ie[t>>0]=0,ie[t+1>>0]=0,ie[t+2>>0]=0,ie[t+3>>0]=0}function sf(t){t=t|0,w2(t+244|0),cv(t+164|0),Ap(t)}function w2(t){t=t|0,za(t)}function of(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0;if(c=t+325|0,ie[c>>0]|0||(fv(t+244|0),ie[c>>0]=1),!(ie[t>>0]|0))ie[t>>0]=1,mp(pp(n)|0,s,8),z=Mp(s)|0,$=ei()|0,t=t+100|0,n=t,ie[n>>0]=z,ie[n+1>>0]=z>>8,ie[n+2>>0]=z>>16,ie[n+3>>0]=z>>24,t=t+4|0,ie[t>>0]=$,ie[t+1>>0]=$>>8,ie[t+2>>0]=$>>16,ie[t+3>>0]=$>>24;else{$=t+92|0;e:do if(r[t+132+(r[$>>2]<<2)>>2]|0){if(z=Ma(n,t+4|0)|0,(z|0)==1){c=Ua(t+244|0,n,r[t+132+(r[$>>2]<<2)>>2]|0,1)|0,ne=r[$>>2]|0,n=t+100+(ne<<3)|0,z=n,m=z,z=z+4|0,c=ru(We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24|0,We[z>>0]|We[z+1>>0]<<8|We[z+2>>0]<<16|We[z+3>>0]<<24|0,c|0,((c|0)<0)<<31>>31|0)|0,z=ei()|0,m=n,ie[m>>0]=c,ie[m+1>>0]=c>>8,ie[m+2>>0]=c>>16,ie[m+3>>0]=c>>24,n=n+4|0,ie[n>>0]=z,ie[n+1>>0]=z>>8,ie[n+2>>0]=z>>16,ie[n+3>>0]=z>>24,r[t+148+(ne<<2)>>2]=0;break}if((z|0)>=511){if((z|0)==512){ne=t+96|0,r[ne>>2]=(r[ne>>2]|0)+1&3,z=t+100+(r[$>>2]<<3)+4|0,z=Ua(t+244|0,n,We[z>>0]|We[z+1>>0]<<8|We[z+2>>0]<<16|We[z+3>>0]<<24,8)|0,c=t+100+(r[ne>>2]<<3)|0,m=c,ie[m>>0]=0,ie[m+1>>0]=0,ie[m+2>>0]=0,ie[m+3>>0]=0,c=c+4|0,ie[c>>0]=z,ie[c+1>>0]=z>>8,ie[c+2>>0]=z>>16,ie[c+3>>0]=z>>24,c=hv(n)|0,ne=r[ne>>2]|0,n=t+100+(ne<<3)|0,z=n,m=z,z=z+4|0,z=We[z>>0]|We[z+1>>0]<<8|We[z+2>>0]<<16|We[z+3>>0]<<24,c=We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24|c,m=n,ie[m>>0]=c,ie[m+1>>0]=c>>8,ie[m+2>>0]=c>>16,ie[m+3>>0]=c>>24,n=n+4|0,ie[n>>0]=z,ie[n+1>>0]=z>>8,ie[n+2>>0]=z>>16,ie[n+3>>0]=z>>24,r[$>>2]=ne,r[t+132+(ne<<2)>>2]=0,r[t+148+(r[$>>2]<<2)>>2]=0;break}if((z|0)<=511)break;r[$>>2]=(r[$>>2]|0)+z&3,of(t,n,s)|0;break}do if(!z)c=Ua(t+244|0,n,0,7)|0,m=t+148+(r[$>>2]<<2)|0,r[m>>2]=(r[m>>2]|0)+1,m=r[$>>2]|0,(r[t+148+(m<<2)>>2]|0)>3&&(r[t+132+(m<<2)>>2]=c,r[t+148+(r[$>>2]<<2)>>2]=0);else{if((z|0)<500)if(c=t+244|0,m=Nn(r[t+132+(r[$>>2]<<2)>>2]|0,z)|0,(z|0)<10){c=Ua(c,n,m,2)|0;break}else{c=Ua(c,n,m,3)|0;break}if((z|0)==500){if(c=Ua(t+244|0,n,(r[t+132+(r[$>>2]<<2)>>2]|0)*500|0,4)|0,m=t+148+(r[$>>2]<<2)|0,r[m>>2]=(r[m>>2]|0)+1,m=r[$>>2]|0,(r[t+148+(m<<2)>>2]|0)<=3)break;r[t+132+(m<<2)>>2]=c,r[t+148+(r[$>>2]<<2)>>2]=0;break}if(c=500-z|0,m=t+244|0,z=r[t+132+(r[$>>2]<<2)>>2]|0,(c|0)>-10){c=Ua(m,n,Nn(z,c)|0,5)|0;break}c=Ua(m,n,Nn(z,-10)|0,6)|0,m=t+148+(r[$>>2]<<2)|0,r[m>>2]=(r[m>>2]|0)+1,m=r[$>>2]|0,(r[t+148+(m<<2)>>2]|0)>3&&(r[t+132+(m<<2)>>2]=c,r[t+148+(r[$>>2]<<2)>>2]=0)}while(0);ne=t+100+(r[$>>2]<<3)|0,m=ne,n=m,m=m+4|0,m=ru(We[n>>0]|We[n+1>>0]<<8|We[n+2>>0]<<16|We[n+3>>0]<<24|0,We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24|0,c|0,((c|0)<0)<<31>>31|0)|0,n=ei()|0,z=ne,ie[z>>0]=m,ie[z+1>>0]=m>>8,ie[z+2>>0]=m>>16,ie[z+3>>0]=m>>24,ne=ne+4|0,ie[ne>>0]=n,ie[ne+1>>0]=n>>8,ie[ne+2>>0]=n>>16,ie[ne+3>>0]=n>>24}else switch(c=Ma(n,t+48|0)|0,c|0){case 1:{n=Ua(t+244|0,n,0,0)|0,r[t+132+(r[$>>2]<<2)>>2]=n,n=r[$>>2]|0,ne=r[t+132+(n<<2)>>2]|0,z=t+100+(n<<3)|0,m=z,c=m,m=m+4|0,ne=ru(We[c>>0]|We[c+1>>0]<<8|We[c+2>>0]<<16|We[c+3>>0]<<24|0,We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24|0,ne|0,((ne|0)<0)<<31>>31|0)|0,m=ei()|0,c=z,ie[c>>0]=ne,ie[c+1>>0]=ne>>8,ie[c+2>>0]=ne>>16,ie[c+3>>0]=ne>>24,z=z+4|0,ie[z>>0]=m,ie[z+1>>0]=m>>8,ie[z+2>>0]=m>>16,ie[z+3>>0]=m>>24,r[t+148+(n<<2)>>2]=0;break e}case 2:{ne=t+96|0,r[ne>>2]=(r[ne>>2]|0)+1&3,z=t+100+(r[$>>2]<<3)+4|0,z=Ua(t+244|0,n,We[z>>0]|We[z+1>>0]<<8|We[z+2>>0]<<16|We[z+3>>0]<<24,8)|0,c=t+100+(r[ne>>2]<<3)|0,m=c,ie[m>>0]=0,ie[m+1>>0]=0,ie[m+2>>0]=0,ie[m+3>>0]=0,c=c+4|0,ie[c>>0]=z,ie[c+1>>0]=z>>8,ie[c+2>>0]=z>>16,ie[c+3>>0]=z>>24,c=hv(n)|0,ne=r[ne>>2]|0,n=t+100+(ne<<3)|0,z=n,m=z,z=z+4|0,z=We[z>>0]|We[z+1>>0]<<8|We[z+2>>0]<<16|We[z+3>>0]<<24,c=We[m>>0]|We[m+1>>0]<<8|We[m+2>>0]<<16|We[m+3>>0]<<24|c,m=n,ie[m>>0]=c,ie[m+1>>0]=c>>8,ie[m+2>>0]=c>>16,ie[m+3>>0]=c>>24,n=n+4|0,ie[n>>0]=z,ie[n+1>>0]=z>>8,ie[n+2>>0]=z>>16,ie[n+3>>0]=z>>24,r[$>>2]=ne,r[t+132+(ne<<2)>>2]=0,r[t+148+(r[$>>2]<<2)>>2]=0;break e}default:{if((c|0)<=2)break e;r[$>>2]=c+2+(r[$>>2]|0)&3,of(t,n,s)|0;break e}}while(0);M2(t+100+(r[$>>2]<<3)|0,s)}return s+8|0}function fv(t){t=t|0,ls(t)}function Mp(t){t=t|0;var n=0,s=0,c=0;return n=Me,Me=Me+16|0,s=n,c=Pd(t)|0,b2(s,c,Pd(t+4|0)|0),t=r[s>>2]|0,Cn(r[s+4>>2]|0),Me=n,t|0}function hv(t){t=t|0;var n=0;return n=(S(t)|0)&65535,((S(t)|0)&65535)<<16|n|0}function M2(t,n){t=t|0,n=n|0;var s=0;s=t,Mu(We[s>>0]|We[s+1>>0]<<8|We[s+2>>0]<<16|We[s+3>>0]<<24,n),t=t+4|0,Mu(We[t>>0]|We[t+1>>0]<<8|We[t+2>>0]<<16|We[t+3>>0]<<24,n+4|0)}function b2(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;c=t,ie[c>>0]=n,ie[c+1>>0]=n>>8,ie[c+2>>0]=n>>16,ie[c+3>>0]=n>>24,n=t+4|0,ie[n>>0]=s,ie[n+1>>0]=s>>8,ie[n+2>>0]=s>>16,ie[n+3>>0]=s>>24}function E2(t){t=t|0,vi(t),rr(t)}function T2(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function Fd(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==9890?t+12|0:0)|0}function S2(t){t=t|0,In(t,16)}function R2(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=4820,r[t+4>>2]=n,pv(t+8|0)}function dv(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4844,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function pv(t){t=t|0,ie[t>>0]=0,Ep(t+1|0),pa(t+8|0,128,0,0),pa(t+52|0,256,0,0),pa(t+96|0,256,0,0),pa(t+140|0,256,0,0),pa(t+184|0,256,0,0),pa(t+228|0,256,0,0),pa(t+272|0,256,0,0)}function mv(t){t=t|0,r[t>>2]=4820,Tp(t+8|0),go(t)}function bp(t){t=t|0,mv(t),rr(t)}function vv(t,n){return t=t|0,n=n|0,Sp(t+8|0,r[t+4>>2]|0,n)|0}function Ep(t){t=t|0;var n=0;ie[t>>0]=0,ie[t+1>>0]=0,n=t+2|0,ie[n>>0]=0,ie[n+1>>0]=0,t=t+4|0,ie[t>>0]=0,ie[t+1>>0]=0}function Tp(t){t=t|0,Xn(t+272|0),Xn(t+228|0),Xn(t+184|0),Xn(t+140|0),Xn(t+96|0),Xn(t+52|0),Xn(t+8|0)}function Sp(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0;if(Qe=Me,Me=Me+16|0,ge=Qe,!(ie[t>>0]|0))ie[t>>0]=1,mp(pp(n)|0,s,6),gv(ge,s),Le=t+1|0,ie[Le>>0]=ie[ge>>0]|0,ie[Le+1>>0]=ie[ge+1>>0]|0,ie[Le+2>>0]=ie[ge+2>>0]|0,ie[Le+3>>0]=ie[ge+3>>0]|0,ie[Le+4>>0]=ie[ge+4>>0]|0,ie[Le+5>>0]=ie[ge+5>>0]|0;else{Le=Ma(n,t+8|0)|0,Ep(ge),Le&1?(ne=(Ma(n,t+52|0)|0)&255,c=t+1|0,c=(tf(ne+((We[c>>0]|We[c+1>>0]<<8)&255)|0)|0)&255):(c=t+1|0,c=(We[c>>0]|We[c+1>>0]<<8)&255),zt[ge>>1]=c,Le&2?(c=(Ma(n,t+96|0)|0)&255,ne=t+1|0,c=((tf((((We[ne>>0]|We[ne+1>>0]<<8)&65535)>>>8)+c|0)|0)&255)<<8,c=(c|Yt[ge>>1])&65535):(ne=t+1|0,c=c|(We[ne>>0]|We[ne+1>>0]<<8)&-256),zt[ge>>1]=c;do if(Le&64)if($=t+1|0,m=(c&255)-((We[$>>0]|We[$+1>>0]<<8)&255)|0,Le&4?(c=(Ma(n,t+140|0)|0)&255,ne=t+3|0,ne=m+((We[ne>>0]|We[ne+1>>0]<<8)&255)|0,c=(tf(((ne|0)<1?0:(ne|0)>254?255:ne&255)+c|0)|0)&255):(c=t+3|0,c=(We[c>>0]|We[c+1>>0]<<8)&255),ne=ge+2|0,zt[ne>>1]=c,Le&16?(c=Ma(n,t+228|0)|0,st=t+3|0,z=t+5|0,z=((m+(zt[ne>>1]&255)-((We[st>>0]|We[st+1>>0]<<8)&255)|0)/2|0)+((We[z>>0]|We[z+1>>0]<<8)&255)|0,c=(tf(((z|0)<1?0:(z|0)>254?255:z&255)+(c&255)|0)|0)&255):(c=t+5|0,c=(We[c>>0]|We[c+1>>0]<<8)&255),z=ge+4|0,zt[z>>1]=c,c=((Yt[ge>>1]|0)>>>8)-(((We[$>>0]|We[$+1>>0]<<8)&65535)>>>8)|0,Le&8?(m=(Ma(n,t+184|0)|0)&255,st=t+3|0,st=(((We[st>>0]|We[st+1>>0]<<8)&65535)>>>8)+c|0,m=((tf(((st|0)<1?0:(st|0)>254?255:st&255)+m|0)|0)&255)<<8,m=(m|Yt[ne>>1])&65535):(m=t+3|0,m=zt[ne>>1]|(We[m>>0]|We[m+1>>0]<<8)&-256),zt[ne>>1]=m,Le&32){st=Ma(n,t+272|0)|0,n=t+3|0,Le=t+5|0,Le=((((Yt[ne>>1]|0)>>>8)+c-(((We[n>>0]|We[n+1>>0]<<8)&65535)>>>8)|0)/2|0)+(((We[Le>>0]|We[Le+1>>0]<<8)&65535)>>>8)|0,st=((tf(((Le|0)<1?0:(Le|0)>254?255:Le&255)+(st&255)|0)|0)&255)<<8,zt[z>>1]=st|Yt[z>>1];break}else{st=t+5|0,zt[z>>1]=zt[z>>1]|(We[st>>0]|We[st+1>>0]<<8)&-256;break}else zt[ge+2>>1]=c,zt[ge+4>>1]=c;while(0);st=t+1|0,ie[st>>0]=ie[ge>>0]|0,ie[st+1>>0]=ie[ge+1>>0]|0,ie[st+2>>0]=ie[ge+2>>0]|0,ie[st+3>>0]=ie[ge+3>>0]|0,ie[st+4>>0]=ie[ge+4>>0]|0,ie[st+5>>0]=ie[ge+5>>0]|0,yv(st,s)}return Me=Qe,s+6|0}function gv(t,n){t=t|0,n=n|0;var s=0,c=0;c=Qa(n)|0,s=Qa(n+2|0)|0,_v(t,c,s,Qa(n+4|0)|0)}function yv(t,n){t=t|0,n=n|0;var s=0;Xl(We[t>>0]|We[t+1>>0]<<8,n),s=t+2|0,Xl(We[s>>0]|We[s+1>>0]<<8,n+2|0),t=t+4|0,Xl(We[t>>0]|We[t+1>>0]<<8,n+4|0)}function _v(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0,ie[t>>0]=n,ie[t+1>>0]=n>>8,n=t+2|0,ie[n>>0]=s,ie[n+1>>0]=s>>8,s=t+4|0,ie[s>>0]=c,ie[s+1>>0]=c>>8}function xv(t){t=t|0,vi(t),rr(t)}function Av(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function uf(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==10570?t+12|0:0)|0}function fs(t){t=t|0,In(t,16)}function is(t,n,s){t=t|0,n=n|0,s=s|0,Xo(t),r[t>>2]=4872,r[t+4>>2]=n,C2(t+8|0,s)}function Id(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4896,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function C2(t,n){t=t|0,n=n|0,r[t>>2]=r[n>>2],ie[t+4>>0]=ie[n+4>>0]|0,Mv(t+8|0,n+8|0),Mv(t+20|0,n+20|0),O2(t+32|0,n+32|0)}function wv(t){t=t|0,r[t>>2]=4872,Mr(t+8|0),go(t)}function P2(t){t=t|0,wv(t),rr(t)}function L2(t,n){return t=t|0,n=n|0,Z2(t+8|0,r[t+4>>2]|0,n)|0}function Mv(t,n){t=t|0,n=n|0;var s=0,c=0;r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,s=n+4|0,c=(r[s>>2]|0)-(r[n>>2]|0)|0,c|0&&(bv(t,c),F2(t,r[n>>2]|0,r[s>>2]|0,c))}function O2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;s=Me,Me=Me+32|0,c=s+24|0,m=s+16|0,$=s+8|0,z=s,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,r[t+20>>2]=0,H2($,n),q2(z,n),r[m>>2]=r[$>>2],r[m+4>>2]=r[$+4>>2],r[c>>2]=r[z>>2],r[c+4>>2]=r[z+4>>2],k2(t,m,c,0),Me=s}function bv(t,n){t=t|0,n=n|0;var s=0;if((I2(t)|0)>>>0<n>>>0)Ss(t);else{s=cr(n)|0,r[t+4>>2]=s,r[t>>2]=s,r[t+8>>2]=s+n;return}}function F2(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;z=Me,Me=Me+16|0,m=z,Tv(m,t,c),c=m+4|0,t=s-n|0,(t|0)>0&&(wo(r[c>>2]|0,n|0,t|0)|0,r[c>>2]=(r[c>>2]|0)+t),Sv(m),Me=z}function Ev(t){t=t|0;var n=0,s=0;n=r[t>>2]|0,s=n,n|0&&(r[t+4>>2]=s,In(n,(r[t+8>>2]|0)-s|0))}function I2(t){return t=t|0,2147483647}function Tv(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,n=r[n+4>>2]|0,r[t+4>>2]=n,r[t+8>>2]=n+s}function Sv(t){t=t|0,r[(r[t>>2]|0)+4>>2]=r[t+4>>2]}function k2(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0;if(Lt=Me,Me=Me+96|0,Bt=Lt+80|0,st=Lt+64|0,ge=Lt+48|0,Le=Lt+40|0,Qe=Lt+8|0,ne=Lt,gt=Lt+32|0,Ot=Lt+16|0,$=n,z=r[$>>2]|0,$=r[$+4>>2]|0,m=s,s=r[m>>2]|0,m=r[m+4>>2]|0,c=z,(m|0)==($|0)?$=0:$=((m-(r[s>>2]|0)|0)/44|0)+((s-z>>2)*93|0)+(($-(r[z>>2]|0)|0)/-44|0)|0,s=(r[t+8>>2]|0)-(r[t+4>>2]|0)|0,s=((s|0)==0?0:((s>>2)*93|0)+-1|0)-((r[t+20>>2]|0)+(r[t+16>>2]|0))|0,$>>>0>s>>>0&&Rv(t,$-s|0),lh(Le,t),lh(ne,t),m=ne,s=r[m>>2]|0,m=r[m+4>>2]|0,z=Qe,r[z>>2]=s,r[z+4>>2]=m,z=s,$|0&&(s=((m-(r[s>>2]|0)|0)/44|0)+$|0,(s|0)>0?(ne=(s>>>0)/93|0,$=z+(ne<<2)|0,r[Qe>>2]=$,s=(r[$>>2]|0)+((s-(ne*93|0)|0)*44|0)|0):(s=92-s|0,ne=z+(((s|0)/-93|0)<<2)|0,r[Qe>>2]=ne,s=(r[ne>>2]|0)+((92-((s|0)%93|0)|0)*44|0)|0),r[Qe+4>>2]=s),r[st>>2]=r[Le>>2],r[st+4>>2]=r[Le+4>>2],r[Bt>>2]=r[Qe>>2],r[Bt+4>>2]=r[Qe+4>>2],Rp(ge,st,Bt),Cv(Bt,ge),Pv(st,ge),kd(Bt,st)|0){z=Ot+4|0,$=n+4|0;do{if(Lv(gt,Bt),Ov(Ot,t,gt),s=r[Ot>>2]|0,(s|0)!=(r[z>>2]|0)){m=r[$>>2]|0;do ah(s,m),s=(r[Ot>>2]|0)+44|0,r[Ot>>2]=s,m=m+44|0,r[$>>2]=m,(m-(r[c>>2]|0)|0)==4092&&(c=c+4|0,r[n>>2]=c,m=r[c>>2]|0,r[$>>2]=m);while((s|0)!=(r[z>>2]|0))}Fv(Ot),Iv(Bt)|0}while(kd(Bt,st)|0)}Me=Lt}function D2(t){t=t|0;var n=0,s=0,c=0;n=r[t+4>>2]|0,s=t+8|0,c=r[s>>2]|0,(c|0)!=(n|0)&&(r[s>>2]=c+(~((c+-4-n|0)>>>2)<<2)),n=r[t>>2]|0,n|0&&In(n,(r[t+12>>2]|0)-n|0)}function Rv(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0,Mn=0,Ar=0,sr=0,Xr=0,Gt=0,gi=0,ea=0,yi=0,jn=0,Vi=0,Pn=0;Vi=Me,Me=Me+64|0,Xr=Vi+52|0,sr=Vi+48|0,Gt=Vi+28|0,gi=Vi+24|0,ea=Vi+20|0,Bt=Vi,yi=t+8|0,s=r[yi>>2]|0,jn=t+4|0,ge=r[jn>>2]|0,Mn=((s|0)==(ge|0)&1)+n|0,$=(Mn>>>0)/93|0,$=$+((Mn-($*93|0)|0)!=0&1)|0,Mn=t+16|0,c=r[Mn>>2]|0,ne=(c>>>0)/93|0,Lt=$>>>0<ne>>>0?$:ne,n=$-Lt|0,z=s;e:do if(n)if(Ar=t+12|0,c=r[Ar>>2]|0,m=c-(r[t>>2]|0)|0,s=z-ge>>2,n>>>0>((m>>2)-s|0)>>>0){Ot=m>>1,gt=s+n|0,el(Bt,Ot>>>0<gt>>>0?gt:Ot,s-Lt|0,t+12|0);do r[Xr>>2]=cr(4092)|0,U2(Bt,Xr),n=n+-1|0;while((n|0)!=0);if(!Lt)s=r[jn>>2]|0;else{ne=Bt+8|0,ge=Bt+12|0,Le=Bt+4|0,Qe=Bt+16|0,st=Gt+4|0,gt=Gt+8|0,Ot=Gt+12|0,$=Lt,n=r[ne>>2]|0,s=r[jn>>2]|0;do{z=r[ge>>2]|0,c=z;do if((n|0)==(z|0)){if(m=r[Le>>2]|0,z=r[Bt>>2]|0,n=z,m>>>0<=z>>>0){n=c-n|0,n=(n|0)==0?1:n>>1,el(Gt,n,n>>>2,r[Qe>>2]|0),r[gi>>2]=r[Le>>2],r[ea>>2]=r[ne>>2],r[sr>>2]=r[gi>>2],r[Xr>>2]=r[ea>>2],Yl(Gt,sr,Xr),n=r[Bt>>2]|0,r[Bt>>2]=r[Gt>>2],r[Gt>>2]=n,n=r[Le>>2]|0,r[Le>>2]=r[st>>2],r[st>>2]=n,n=r[ne>>2]|0,r[ne>>2]=r[gt>>2],r[gt>>2]=n,n=r[ge>>2]|0,r[ge>>2]=r[Ot>>2],r[Ot>>2]=n,tl(Gt),n=r[ne>>2]|0;break}Pn=m,n=((Pn-n>>2)+1|0)/-2|0,z=m+(n<<2)|0,c=c-Pn|0,c?(nu(z|0,m|0,c|0)|0,n=(r[Le>>2]|0)+(n<<2)|0):n=z,Pn=z+(c>>2<<2)|0,r[ne>>2]=Pn,r[Le>>2]=n,n=Pn}while(0);r[n>>2]=r[s>>2],n=(r[ne>>2]|0)+4|0,r[ne>>2]=n,s=(r[jn>>2]|0)+4|0,r[jn>>2]=s,$=$+-1|0}while(($|0)!=0)}if(n=r[yi>>2]|0,(n|0)!=(s|0)){do n=n+-4|0,z2(Bt,n),s=r[jn>>2]|0;while((n|0)!=(s|0));n=r[yi>>2]|0}Pn=r[t>>2]|0,r[t>>2]=r[Bt>>2],r[Bt>>2]=Pn,Pn=Bt+4|0,r[jn>>2]=r[Pn>>2],r[Pn>>2]=s,Pn=Bt+8|0,r[yi>>2]=r[Pn>>2],r[Pn>>2]=n,Pn=Bt+12|0,jn=r[Ar>>2]|0,r[Ar>>2]=r[Pn>>2],r[Pn>>2]=jn,r[Mn>>2]=(r[Mn>>2]|0)+(Nn(Lt,-93)|0),tl(Bt);break}else{t:do if((c|0)==(z|0))Le=18;else{for(;r[Xr>>2]=cr(4092)|0,N2(t,Xr),n=n+-1|0,!!n;)if((r[Ar>>2]|0)==(r[yi>>2]|0)){Le=18;break t}s=Lt,n=r[Mn>>2]|0}while(0);if((Le|0)==18){c=~($>>>0>ne>>>0?ne:$),s=n;do r[Xr>>2]=cr(4092)|0,B2(t,Xr),s=s+-1|0,m=(((r[yi>>2]|0)-(r[jn>>2]|0)|0)==4?92:93)+(r[Mn>>2]|0)|0,r[Mn>>2]=m;while((s|0)!=0);s=n+-1-c|0,n=m}if(r[Mn>>2]=n+(Nn(s,-93)|0),!s)break;ne=t+12|0,ge=Gt+4|0,Le=Gt+8|0,Qe=Gt+12|0,n=r[yi>>2]|0;do{z=r[jn>>2]|0,$=r[z>>2]|0,z=z+4|0,r[jn>>2]=z,Pn=r[Ar>>2]|0,c=Pn;do if((n|0)==(Pn|0)){if(Pn=r[t>>2]|0,n=Pn,z>>>0<=Pn>>>0){n=c-n|0,n=(n|0)==0?1:n>>1,el(Gt,n,n>>>2,ne),r[gi>>2]=r[jn>>2],r[ea>>2]=r[yi>>2],r[sr>>2]=r[gi>>2],r[Xr>>2]=r[ea>>2],Yl(Gt,sr,Xr),n=r[t>>2]|0,r[t>>2]=r[Gt>>2],r[Gt>>2]=n,n=r[jn>>2]|0,r[jn>>2]=r[ge>>2],r[ge>>2]=n,n=r[yi>>2]|0,r[yi>>2]=r[Le>>2],r[Le>>2]=n,n=r[Ar>>2]|0,r[Ar>>2]=r[Qe>>2],r[Qe>>2]=n,tl(Gt),n=r[yi>>2]|0;break}Pn=z,n=((Pn-n>>2)+1|0)/-2|0,m=z+(n<<2)|0,c=c-Pn|0,c?(nu(m|0,z|0,c|0)|0,n=(r[jn>>2]|0)+(n<<2)|0):n=m,Pn=m+(c>>2<<2)|0,r[yi>>2]=Pn,r[jn>>2]=n,n=Pn}while(0);r[n>>2]=$,n=(r[yi>>2]|0)+4|0,r[yi>>2]=n,s=s+-1|0}while((s|0)!=0)}else if(r[Mn>>2]=(Nn(Lt,-93)|0)+c,Lt|0)for(ne=t+12|0,Le=t+12|0,Qe=Gt+4|0,st=Gt+8|0,gt=Gt+12|0,n=Lt,c=ge;;){$=r[c>>2]|0,z=c+4|0,r[jn>>2]=z,Ar=r[ne>>2]|0,c=Ar;do if((s|0)==(Ar|0)){if(Ar=r[t>>2]|0,s=Ar,z>>>0<=Ar>>>0){s=c-s|0,s=(s|0)==0?1:s>>1,el(Gt,s,s>>>2,Le),r[gi>>2]=r[jn>>2],r[ea>>2]=r[yi>>2],r[sr>>2]=r[gi>>2],r[Xr>>2]=r[ea>>2],Yl(Gt,sr,Xr),s=r[t>>2]|0,r[t>>2]=r[Gt>>2],r[Gt>>2]=s,s=r[jn>>2]|0,r[jn>>2]=r[Qe>>2],r[Qe>>2]=s,s=r[yi>>2]|0,r[yi>>2]=r[st>>2],r[st>>2]=s,s=r[ne>>2]|0,r[ne>>2]=r[gt>>2],r[gt>>2]=s,tl(Gt),s=r[yi>>2]|0;break}Ar=z,s=((Ar-s>>2)+1|0)/-2|0,m=z+(s<<2)|0,c=c-Ar|0,c?(nu(m|0,z|0,c|0)|0,s=(r[jn>>2]|0)+(s<<2)|0):s=m,Ar=m+(c>>2<<2)|0,r[yi>>2]=Ar,r[jn>>2]=s,s=Ar}while(0);if(r[s>>2]=$,s=(r[yi>>2]|0)+4|0,r[yi>>2]=s,n=n+-1|0,!n)break e;c=r[jn>>2]|0}while(0);Me=Vi}function lh(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;s=(r[n+16>>2]|0)+(r[n+20>>2]|0)|0,z=r[n+4>>2]|0,c=(s>>>0)/93|0,m=z+(c<<2)|0,(r[n+8>>2]|0)==(z|0)?n=0:n=(r[m>>2]|0)+((s-(c*93|0)|0)*44|0)|0,r[t>>2]=m,r[t+4>>2]=n}function Rp(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;m=n,n=r[m+4>>2]|0,c=t,r[c>>2]=r[m>>2],r[c+4>>2]=n,c=s,n=r[c+4>>2]|0,s=t+8|0,r[s>>2]=r[c>>2],r[s+4>>2]=n}function Cv(t,n){t=t|0,n=n|0,r[t>>2]=r[n>>2],r[t+4>>2]=r[n+4>>2],r[t+8>>2]=r[n+8>>2],r[t+12>>2]=r[n+12>>2]}function Pv(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;s=Me,Me=Me+32|0,c=s+24|0,m=s+16|0,$=s+8|0,z=s,ne=n+8|0,ge=r[ne>>2]|0,ne=r[ne+4>>2]|0,n=$,r[n>>2]=ge,r[n+4>>2]=ne,n=z,r[n>>2]=ge,r[n+4>>2]=ne,r[m>>2]=r[$>>2],r[m+4>>2]=r[$+4>>2],r[c>>2]=r[z>>2],r[c+4>>2]=r[z+4>>2],Rp(t,m,c),Me=s}function kd(t,n){return t=t|0,n=n|0,(W2(t,n)|0)^1|0}function Lv(t,n){t=t|0,n=n|0;var s=0,c=0;s=r[n>>2]|0,c=r[n+4>>2]|0,(s|0)==(r[n+8>>2]|0)?kv(t,c,r[n+12>>2]|0):kv(t,c,(r[s>>2]|0)+4092|0)}function Ov(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;c=r[s>>2]|0,r[t>>2]=c,r[t+4>>2]=r[s+4>>2],r[t+8>>2]=c,r[t+12>>2]=n}function Fv(t){t=t|0;var n=0;n=(r[t+12>>2]|0)+20|0,r[n>>2]=(r[n>>2]|0)+(((r[t>>2]|0)-(r[t+8>>2]|0)|0)/44|0)}function Iv(t){t=t|0;var n=0,s=0,c=0;return n=r[t>>2]|0,s=t+8|0,(n|0)==(r[s>>2]|0)?(c=s,n=r[c+4>>2]|0,s=t,r[s>>2]=r[c>>2],r[s+4>>2]=n):(c=n+4|0,r[t>>2]=c,r[t+4>>2]=r[c>>2]),t|0}function N2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0;Bt=Me,Me=Me+48|0,m=Bt+32|0,c=Bt+28|0,ne=Bt+8|0,ge=Bt+4|0,Le=Bt,Ot=t+8|0,s=r[Ot>>2]|0,Qe=t+12|0,gt=r[Qe>>2]|0,z=gt;do if((s|0)==(gt|0)){if(gt=t+4|0,st=r[gt>>2]|0,Lt=r[t>>2]|0,$=Lt,st>>>0<=Lt>>>0){s=z-$|0,s=(s|0)==0?1:s>>1,el(ne,s,s>>>2,t+12|0),r[ge>>2]=r[gt>>2],r[Le>>2]=r[Ot>>2],r[c>>2]=r[ge>>2],r[m>>2]=r[Le>>2],Yl(ne,c,m),s=r[t>>2]|0,r[t>>2]=r[ne>>2],r[ne>>2]=s,s=ne+4|0,Lt=r[gt>>2]|0,r[gt>>2]=r[s>>2],r[s>>2]=Lt,s=ne+8|0,Lt=r[Ot>>2]|0,r[Ot>>2]=r[s>>2],r[s>>2]=Lt,s=ne+12|0,Lt=r[Qe>>2]|0,r[Qe>>2]=r[s>>2],r[s>>2]=Lt,tl(ne),s=r[Ot>>2]|0;break}m=st,c=((m-$>>2)+1|0)/-2|0,t=st+(c<<2)|0,m=s-m|0,m?(nu(t|0,st|0,m|0)|0,s=(r[gt>>2]|0)+(c<<2)|0):s=t,Lt=t+(m>>2<<2)|0,r[Ot>>2]=Lt,r[gt>>2]=s,s=Lt}while(0);r[s>>2]=r[n>>2],r[Ot>>2]=(r[Ot>>2]|0)+4,Me=Bt}function B2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0;Bt=Me,Me=Me+48|0,c=Bt+32|0,s=Bt+28|0,$=Bt+8|0,ne=Bt+4|0,ge=Bt,Ot=t+4|0,st=r[Ot>>2]|0,gt=r[t>>2]|0,Le=gt;do if((st|0)==(gt|0)){if(gt=t+8|0,Qe=r[gt>>2]|0,z=t+12|0,Lt=r[z>>2]|0,m=Lt,Qe>>>0>=Lt>>>0){Lt=m-Le|0,Lt=(Lt|0)==0?1:Lt>>1,el($,Lt,(Lt+3|0)>>>2,t+12|0),r[ne>>2]=r[Ot>>2],r[ge>>2]=r[gt>>2],r[s>>2]=r[ne>>2],r[c>>2]=r[ge>>2],Yl($,s,c),s=r[t>>2]|0,r[t>>2]=r[$>>2],r[$>>2]=s,s=$+4|0,Lt=r[Ot>>2]|0,r[Ot>>2]=r[s>>2],r[s>>2]=Lt,s=$+8|0,Lt=r[gt>>2]|0,r[gt>>2]=r[s>>2],r[s>>2]=Lt,s=$+12|0,Lt=r[z>>2]|0,r[z>>2]=r[s>>2],r[s>>2]=Lt,tl($),s=r[Ot>>2]|0;break}c=Qe,t=((m-c>>2)+1|0)/2|0,m=Qe+(t<<2)|0,c=c-st|0,s=m+(0-(c>>2)<<2)|0,c?(nu(s|0,st|0,c|0)|0,c=(r[gt>>2]|0)+(t<<2)|0):(s=m,c=m),r[Ot>>2]=s,r[gt>>2]=c}else s=st;while(0);r[s+-4>>2]=r[n>>2],r[Ot>>2]=(r[Ot>>2]|0)+-4,Me=Bt}function el(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;m=t+12|0,r[m>>2]=0,r[t+16>>2]=c;do if(n)if(n>>>0>1073741823)m=cn(8)|0,La(m,6723),r[m>>2]=5956,oi(m|0,3928,123);else{c=cr(n<<2)|0;break}else c=0;while(0);r[t>>2]=c,s=c+(s<<2)|0,r[t+8>>2]=s,r[t+4>>2]=s,r[m>>2]=c+(n<<2)}function U2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0;Bt=Me,Me=Me+48|0,m=Bt+32|0,c=Bt+28|0,ne=Bt+8|0,ge=Bt+4|0,Le=Bt,Ot=t+8|0,s=r[Ot>>2]|0,Qe=t+12|0,gt=r[Qe>>2]|0,z=gt;do if((s|0)==(gt|0)){if(gt=t+4|0,st=r[gt>>2]|0,Lt=r[t>>2]|0,$=Lt,st>>>0<=Lt>>>0){s=z-$|0,s=(s|0)==0?1:s>>1,el(ne,s,s>>>2,r[t+16>>2]|0),r[ge>>2]=r[gt>>2],r[Le>>2]=r[Ot>>2],r[c>>2]=r[ge>>2],r[m>>2]=r[Le>>2],Yl(ne,c,m),s=r[t>>2]|0,r[t>>2]=r[ne>>2],r[ne>>2]=s,s=ne+4|0,Lt=r[gt>>2]|0,r[gt>>2]=r[s>>2],r[s>>2]=Lt,s=ne+8|0,Lt=r[Ot>>2]|0,r[Ot>>2]=r[s>>2],r[s>>2]=Lt,s=ne+12|0,Lt=r[Qe>>2]|0,r[Qe>>2]=r[s>>2],r[s>>2]=Lt,tl(ne),s=r[Ot>>2]|0;break}m=st,c=((m-$>>2)+1|0)/-2|0,t=st+(c<<2)|0,m=s-m|0,m?(nu(t|0,st|0,m|0)|0,s=(r[gt>>2]|0)+(c<<2)|0):s=t,Lt=t+(m>>2<<2)|0,r[Ot>>2]=Lt,r[gt>>2]=s,s=Lt}while(0);r[s>>2]=r[n>>2],r[Ot>>2]=(r[Ot>>2]|0)+4,Me=Bt}function z2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0;Bt=Me,Me=Me+48|0,c=Bt+32|0,s=Bt+28|0,$=Bt+8|0,ne=Bt+4|0,ge=Bt,Ot=t+4|0,st=r[Ot>>2]|0,gt=r[t>>2]|0,Le=gt;do if((st|0)==(gt|0)){if(gt=t+8|0,Qe=r[gt>>2]|0,z=t+12|0,Lt=r[z>>2]|0,m=Lt,Qe>>>0>=Lt>>>0){Lt=m-Le|0,Lt=(Lt|0)==0?1:Lt>>1,el($,Lt,(Lt+3|0)>>>2,r[t+16>>2]|0),r[ne>>2]=r[Ot>>2],r[ge>>2]=r[gt>>2],r[s>>2]=r[ne>>2],r[c>>2]=r[ge>>2],Yl($,s,c),s=r[t>>2]|0,r[t>>2]=r[$>>2],r[$>>2]=s,s=$+4|0,Lt=r[Ot>>2]|0,r[Ot>>2]=r[s>>2],r[s>>2]=Lt,s=$+8|0,Lt=r[gt>>2]|0,r[gt>>2]=r[s>>2],r[s>>2]=Lt,s=$+12|0,Lt=r[z>>2]|0,r[z>>2]=r[s>>2],r[s>>2]=Lt,tl($),s=r[Ot>>2]|0;break}c=Qe,t=((m-c>>2)+1|0)/2|0,m=Qe+(t<<2)|0,c=c-st|0,s=m+(0-(c>>2)<<2)|0,c?(nu(s|0,st|0,c|0)|0,c=(r[gt>>2]|0)+(t<<2)|0):(s=m,c=m),r[Ot>>2]=s,r[gt>>2]=c}else s=st;while(0);r[s+-4>>2]=r[n>>2],r[Ot>>2]=(r[Ot>>2]|0)+-4,Me=Bt}function tl(t){t=t|0;var n=0,s=0,c=0;n=r[t+4>>2]|0,s=t+8|0,c=r[s>>2]|0,(c|0)!=(n|0)&&(r[s>>2]=c+(~((c+-4-n|0)>>>2)<<2)),n=r[t>>2]|0,n|0&&In(n,(r[t+12>>2]|0)-n|0)}function Yl(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;if($=Me,Me=Me+16|0,z=$,m=r[n>>2]|0,G2(z,t+8|0,(r[s>>2]|0)-m>>2),t=r[z>>2]|0,c=z+4|0,(t|0)!=(r[c>>2]|0)){s=m;do r[t>>2]=r[s>>2],t=(r[z>>2]|0)+4|0,r[z>>2]=t,s=s+4|0;while((t|0)!=(r[c>>2]|0));r[n>>2]=s}V2(z),Me=$}function G2(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=r[n>>2],r[t+4>>2]=(r[n>>2]|0)+(s<<2),r[t+8>>2]=n}function V2(t){t=t|0,r[r[t+8>>2]>>2]=r[t>>2]}function W2(t,n){return t=t|0,n=n|0,(r[t+4>>2]|0)==(r[n+4>>2]|0)|0}function kv(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,r[t+4>>2]=s}function H2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;z=r[n+4>>2]|0,s=r[n+16>>2]|0,c=(s>>>0)/93|0,m=z+(c<<2)|0,(r[n+8>>2]|0)==(z|0)?n=0:n=(r[m>>2]|0)+((s-(c*93|0)|0)*44|0)|0,r[t>>2]=m,r[t+4>>2]=n}function q2(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;s=(r[n+16>>2]|0)+(r[n+20>>2]|0)|0,z=r[n+4>>2]|0,c=(s>>>0)/93|0,m=z+(c<<2)|0,(r[n+8>>2]|0)==(z|0)?n=0:n=(r[m>>2]|0)+((s-(c*93|0)|0)*44|0)|0,r[t>>2]=m,r[t+4>>2]=n}function X2(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0;if(ne=Me,Me=Me+16|0,c=ne+8|0,z=ne,Dv(c,t),lh(z,t),m=c+4|0,n=r[m>>2]|0,z=z+4|0,(n|0)!=(r[z>>2]|0))do Xn(n),n=(r[m>>2]|0)+44|0,r[m>>2]=n,s=r[c>>2]|0,(n-(r[s>>2]|0)|0)==4092&&(n=s+4|0,r[c>>2]=n,n=r[n>>2]|0,r[m>>2]=n);while((n|0)!=(r[z>>2]|0));if(r[t+20>>2]=0,m=t+8|0,c=t+4|0,s=r[c>>2]|0,n=(r[m>>2]|0)-s>>2,n>>>0>2)do In(r[s>>2]|0,4092),s=(r[c>>2]|0)+4|0,r[c>>2]=s,n=(r[m>>2]|0)-s>>2;while(n>>>0>2);switch(n|0){case 1:{n=46,$=11;break}case 2:{n=93,$=11;break}default:}($|0)==11&&(r[t+16>>2]=n),Me=ne}function Dv(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;z=r[n+4>>2]|0,s=r[n+16>>2]|0,c=(s>>>0)/93|0,m=z+(c<<2)|0,(r[n+8>>2]|0)==(z|0)?n=0:n=(r[m>>2]|0)+((s-(c*93|0)|0)*44|0)|0,r[t>>2]=m,r[t+4>>2]=n}function Z2(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0;if(Le=Me,Me=Me+16|0,ge=Le,$=t+4|0,ie[$>>0]|0){if(m=r[t+20>>2]|0,c=r[t+8>>2]|0,Dv(ge,t+32|0),t=t+12|0,(c|0)!=(r[t>>2]|0))for(ne=ge+4|0,$=c,z=m,c=r[ne>>2]|0;m=We[$>>0]|0,m=j2((Ma(n,c)|0)+m|0)|0,ie[z>>0]=m,ie[s>>0]=m,ie[$>>0]=m,$=$+1|0,s=s+1|0,m=r[ge>>2]|0,c=(r[ne>>2]|0)+44|0,r[ne>>2]=c,(c-(r[m>>2]|0)|0)==4092&&(c=m+4|0,r[ge>>2]=c,c=r[c>>2]|0,r[ne>>2]=c),($|0)!=(r[t>>2]|0);)z=z+1|0}else{if(ge=pp(n)|0,mp(ge,s,r[t>>2]|0),ge=r[t>>2]|0,z=s+ge|0,!ge)c=0;else{for(c=s,m=r[t+8>>2]|0;ie[m>>0]=ie[c>>0]|0,c=c+1|0,(c|0)!=(z|0);)m=m+1|0;c=r[t>>2]|0}ie[$>>0]=1,s=s+c|0}return Me=Le,s|0}function j2(t){return t=t|0,t&255|0}function Nv(t){t=t|0,vi(t),rr(t)}function Bv(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function Cp(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==11262?t+12|0:0)|0}function Uv(t){t=t|0,In(t,16)}function zv(t,n){t=t|0,n=n|0,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,n|0&&(bv(t,n),Gv(t,n))}function rl(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,r[t+20>>2]=0,n|0&&Y2(t,n,s)}function Gv(t,n){t=t|0,n=n|0;var s=0,c=0,m=0;if(m=Me,Me=Me+16|0,c=m,Tv(c,t,n),n=c+4|0,t=r[n>>2]|0,s=c+8|0,(t|0)!=(r[s>>2]|0))do ie[t>>0]=0,t=(r[n>>2]|0)+1|0,r[n>>2]=t;while((t|0)!=(r[s>>2]|0));Sv(c),Me=m}function Y2(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0;if(Ot=Me,Me=Me+96|0,gt=Ot+80|0,Le=Ot+64|0,$=Ot+48|0,ne=Ot+40|0,ge=Ot+8|0,m=Ot,Qe=Ot+32|0,st=Ot+16|0,c=(r[t+8>>2]|0)-(r[t+4>>2]|0)|0,c=((c|0)==0?0:((c>>2)*93|0)+-1|0)-((r[t+20>>2]|0)+(r[t+16>>2]|0))|0,c>>>0<n>>>0&&Rv(t,n-c|0),lh(ne,t),lh(m,t),c=r[m>>2]|0,m=r[m+4>>2]|0,z=ge,r[z>>2]=c,r[z+4>>2]=m,z=c,n|0&&(c=((m-(r[c>>2]|0)|0)/44|0)+n|0,(c|0)>0?(n=(c>>>0)/93|0,z=z+(n<<2)|0,r[ge>>2]=z,c=(r[z>>2]|0)+((c-(n*93|0)|0)*44|0)|0):(c=92-c|0,n=z+(((c|0)/-93|0)<<2)|0,r[ge>>2]=n,c=(r[n>>2]|0)+((92-((c|0)%93|0)|0)*44|0)|0),r[ge+4>>2]=c),r[Le>>2]=r[ne>>2],r[Le+4>>2]=r[ne+4>>2],r[gt>>2]=r[ge>>2],r[gt+4>>2]=r[ge+4>>2],Rp($,Le,gt),Cv(gt,$),Pv(Le,$),kd(gt,Le)|0){m=st+4|0;do{if(Lv(Qe,gt),Ov(st,t,Qe),c=r[st>>2]|0,(c|0)!=(r[m>>2]|0))do ah(c,s),c=(r[st>>2]|0)+44|0,r[st>>2]=c;while((c|0)!=(r[m>>2]|0));Fv(st),Iv(gt)|0}while(kd(gt,Le)|0)}Me=Ot}function J2(t){t=t|0;var n=0,s=0;if(X2(t),n=r[t+4>>2]|0,s=r[t+8>>2]|0,(n|0)!=(s|0))do In(r[n>>2]|0,4092),n=n+4|0;while((n|0)!=(s|0));D2(t)}function $2(t,n,s){t=t|0,n=n|0,s=s|0,mn(t),r[t>>2]=4924,r[t+4>>2]=n,r[t+8>>2]=s}function Vv(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4944,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,fh(t,c),Me=s}function Q2(t,n){return t=t|0,n=n|0,e1(r[t+8>>2]|0,r[t+4>>2]|0,n)|0}function Wv(t){t=t|0;var n=0,s=0;r[t>>2]=4924,s=t+8|0,n=r[s>>2]|0,r[s>>2]=0,n|0&&(ch(n),rr(n)),Li(t)}function K2(t){t=t|0,Wv(t),rr(t)}function e1(t,n,s){return t=t|0,n=n|0,s=s|0,Pp(t+4784|0,n,Cd(t,n,s)|0)|0}function Pp(t,n,s){return t=t|0,n=n|0,s=s|0,ie[t>>0]|0&&(Qc(n),ie[t>>0]=0),s|0}function ch(t){t=t|0,Rd(t)}function fh(t,n){t=t|0,n=n|0}function Hv(t){t=t|0,vi(t),rr(t)}function t1(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+8>>2]&255](t)}function Lp(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==12004?t+12|0:0)|0}function r1(t){t=t|0,In(t,16)}function Op(t){t=t|0,ie[t>>0]=1}function n1(t,n,s){t=t|0,n=n|0,s=s|0,mn(t),r[t>>2]=4972,r[t+4>>2]=n,r[t+8>>2]=s}function qv(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=4992,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,fh(t,c),Me=s}function i1(t,n){return t=t|0,n=n|0,a1(r[t+8>>2]|0,r[t+4>>2]|0,n)|0}function Fp(t){t=t|0;var n=0,s=0;r[t>>2]=4972,s=t+8|0,n=r[s>>2]|0,r[s>>2]=0,n|0&&(o1(n),rr(n)),Li(t)}function Xv(t){t=t|0,Fp(t),rr(t)}function a1(t,n,s){return t=t|0,n=n|0,s=s|0,s1(t+4784|0,n,Cd(t,n,s)|0)|0}function s1(t,n,s){return t=t|0,n=n|0,s=s|0,Pp(t+328|0,n,of(t,n,s)|0)|0}function o1(t){t=t|0,u1(t+4784|0),Rd(t)}function u1(t){t=t|0,sf(t)}function l1(t){t=t|0,vi(t),rr(t)}function c1(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+8>>2]&255](t)}function f1(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==12827?t+12|0:0)|0}function h1(t){t=t|0,In(t,16)}function d1(t){t=t|0,Zl(t),Op(t+328|0)}function p1(t,n,s){t=t|0,n=n|0,s=s|0,mn(t),r[t>>2]=5020,r[t+4>>2]=n,r[t+8>>2]=s}function m1(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5040,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,fh(t,c),Me=s}function Zv(t,n){return t=t|0,n=n|0,g1(r[t+8>>2]|0,r[t+4>>2]|0,n)|0}function Ip(t){t=t|0;var n=0,s=0;r[t>>2]=5020,s=t+8|0,n=r[s>>2]|0,r[s>>2]=0,n|0&&(y1(n),rr(n)),Li(t)}function v1(t){t=t|0,Ip(t),rr(t)}function g1(t,n,s){return t=t|0,n=n|0,s=s|0,jv(t+4784|0,n,Cd(t,n,s)|0)|0}function jv(t,n,s){return t=t|0,n=n|0,s=s|0,Pp(t+316|0,n,Sp(t,n,s)|0)|0}function y1(t){t=t|0,Yv(t+4784|0),Rd(t)}function Yv(t){t=t|0,Tp(t)}function _1(t){t=t|0,vi(t),rr(t)}function Jv(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+8>>2]&255](t)}function x1(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==13672?t+12|0:0)|0}function Dd(t){t=t|0,In(t,16)}function hh(t){t=t|0,pv(t),Op(t+316|0)}function A1(t,n,s){t=t|0,n=n|0,s=s|0,mn(t),r[t>>2]=5068,r[t+4>>2]=n,r[t+8>>2]=s}function w1(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5088,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,fh(t,c),Me=s}function $v(t,n){return t=t|0,n=n|0,Kv(r[t+8>>2]|0,r[t+4>>2]|0,n)|0}function Qv(t){t=t|0;var n=0,s=0;r[t>>2]=5068,s=t+8|0,n=r[s>>2]|0,r[s>>2]=0,n|0&&(Jl(n),rr(n)),Li(t)}function M1(t){t=t|0,Qv(t),rr(t)}function Kv(t,n,s){return t=t|0,n=n|0,s=s|0,kp(t+4784|0,n,Cd(t,n,s)|0)|0}function kp(t,n,s){return t=t|0,n=n|0,s=s|0,jv(t+328|0,n,of(t,n,s)|0)|0}function Jl(t){t=t|0,b1(t+4784|0),Rd(t)}function b1(t){t=t|0,Yv(t+328|0),sf(t)}function Dp(t){t=t|0,vi(t),rr(t)}function Nd(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+8>>2]&255](t)}function E1(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==14573?t+12|0:0)|0}function T1(t){t=t|0,In(t,16)}function S1(t){t=t|0,Zl(t),hh(t+328|0)}function Ri(t){return t=t|0,t+20|0}function eg(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=n,r[t+4>>2]=s,r[t+8>>2]=0}function dh(t,n){t=t|0,n=n|0,r[t>>2]=n,r[t+4>>2]=0,r[t+8>>2]=-1}function ph(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;s=Me,Me=Me+16|0,c=s+4|0,z=s,m=cr(24)|0,Np(m,n),r[z>>2]=0,r[c>>2]=r[z>>2],ng(t,m,c),Me=s}function nl(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function $l(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5116,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,il(t,c),Me=s}function Yi(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function il(t,n){t=t|0,n=n|0}function Bd(t){t=t|0,vi(t),rr(t)}function lf(t){t=t|0,t=r[t+12>>2]|0,t|0&&rr(t)}function mh(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==14966?t+12|0:0)|0}function cf(t){t=t|0,In(t,16)}function ff(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5144,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,vh(t,c),Me=s}function Ql(t){t=t|0;var n=0,s=0;t=r[t+4>>2]|0,t|0&&(s=t+4|0,n=r[s>>2]|0,r[s>>2]=n+-1,(n|0)==0)&&(Bi[r[(r[t>>2]|0)+8>>2]&255](t),Qs(t))}function vh(t,n){t=t|0,n=n|0}function tg(t){t=t|0,vi(t),rr(t)}function Ud(t){t=t|0,t=r[t+12>>2]|0,t|0&&(rg(t),rr(t))}function gh(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==15127?t+12|0:0)|0}function zd(t){t=t|0,In(t,16)}function rg(t){t=t|0}function Np(t,n){t=t|0,n=n|0,mn(t),r[t>>2]=5172,r[t+4>>2]=n,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,ie[t+20>>0]=1}function ng(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5192,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,ag(t,c),Me=s}function Gd(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;if(ge=Me,Me=Me+16|0,z=ge,s=r[t+8>>2]|0,$=r[t+12>>2]|0,(s|0)!=($|0)){ne=z+4|0;do c=r[s>>2]|0,r[z>>2]=c,m=r[s+4>>2]|0,r[ne>>2]=m,m|0&&(m=m+4|0,r[m>>2]=(r[m>>2]|0)+1),n=km[r[(r[c>>2]|0)+12>>2]&63](c,n)|0,pi(z),s=s+8|0;while((s|0)!=($|0))}return s=t+20|0,ie[s>>0]|0&&(ie[s>>0]=0,ig(r[t+4>>2]|0)),Me=ge,n|0}function yh(t){t=t|0,r[t>>2]=5172,Ca(t+8|0),Li(t)}function Vd(t){t=t|0,yh(t),rr(t)}function ig(t){t=t|0;var n=0;n=((Kl(r[t>>2]|0)|0)&255)<<24,n=((Kl(r[t>>2]|0)|0)&255)<<16|n,n=n|((Kl(r[t>>2]|0)|0)&255)<<8,r[t+4>>2]=n|(Kl(r[t>>2]|0)|0)&255}function Kl(t){t=t|0;var n=0,s=0;return n=r[t>>2]|0,s=t+8|0,t=r[s>>2]|0,r[s>>2]=t+1,ie[n+t>>0]|0}function ag(t,n){t=t|0,n=n|0}function sg(t){t=t|0,vi(t),rr(t)}function og(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+8>>2]&255](t)}function R1(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==15450?t+12|0:0)|0}function ug(t){t=t|0,In(t,16)}function hf(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(180)|0,tc($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],lg(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function ec(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(180)|0,Hd($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],qd(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function tc(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=5220,r[t+4>>2]=n,C1(t+8|0)}function lg(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5244,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function C1(t){t=t|0,yo(t,32,1,8,0),wa(t+80|0,32,1,8,0),ie[t+160>>0]=0,ie[t+161>>0]=0,fg(t+164|0)}function _h(t){t=t|0,r[t>>2]=5220,Wd(t+8|0),go(t)}function rc(t){t=t|0,_h(t),rr(t)}function cg(t,n){return t=t|0,n=n|0,xh(t+8|0,r[t+4>>2]|0,n)|0}function fg(t){t=t|0,ie[t+4>>0]=0}function Wd(t){t=t|0,za(t+80|0),_o(t)}function xh(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;return z=Me,Me=Me+16|0,c=z,ie[t+161>>0]|0||ls(t+80|0),m=t+164|0,Bp(m)|0?(n=Ji(t+80|0,n,r[m>>2]|0,0)|0,r[c>>2]=n,Ld(n,s)):(ic(nc(n)|0,s,4),r[c>>2]=Pr(s)|0),hg(m,c),Me=z,s+4|0}function Bp(t){return t=t|0,(ie[t+4>>0]|0)!=0|0}function Ji(t,n,s,c){return t=t|0,n=n|0,s=s|0,c=c|0,s=(Up(t,n,(r[t+36>>2]|0)+(c*44|0)|0)|0)+s|0,n=r[t+24>>2]|0,(s|0)<0?s+n|0:s-(s>>>0<n>>>0?0:n)|0}function nc(t){return t=t|0,r[t>>2]|0}function ic(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;if((s|0)>0){c=0;do ie[n+c>>0]=Kl(t)|0,c=c+1|0;while((c|0)!=(s|0))}}function hg(t,n){t=t|0,n=n|0;var s=0;s=t+4|0,ie[s>>0]|0||(ie[s>>0]=1),r[t>>2]=r[n>>2]}function Up(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;s=df(n,s)|0,r[t>>2]=s;do if(s){if(s>>>0>=32){s=r[t+28>>2]|0;break}if(c=r[t+12>>2]|0,s>>>0>c>>>0?(c=s-c|0,s=df(n,(r[t+68>>2]|0)+((s+-1|0)*44|0)|0)|0,c=s<<c|(jo(n,c)|0)):c=df(n,(r[t+68>>2]|0)+((s+-1|0)*44|0)|0)|0,s=r[t>>2]|0,(c|0)<(1<<s+-1|0)){s=c+1+(-1<<s)|0;break}else{s=c+1|0;break}}else s=dg(n,t+48|0)|0;while(0);return s|0}function df(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0;if(gt=t+8|0,st=r[gt>>2]|0,m=r[n+16>>2]|0,m){if(c=t+4|0,s=r[c>>2]|0,Qe=st>>>15,r[gt>>2]=Qe,ge=(s>>>0)/(Qe>>>0)|0,ne=ge>>>(r[n+40>>2]|0),z=r[m+(ne<<2)>>2]|0,ne=(r[m+(ne+1<<2)>>2]|0)+1|0,$=z+1|0,Le=r[n+8>>2]|0,ne>>>0>$>>>0){m=z,z=ne;do $=(z+m|0)>>>1,ne=(r[Le+($<<2)>>2]|0)>>>0>ge>>>0,m=ne?m:$,z=ne?$:z,$=m+1|0;while(z>>>0>$>>>0);z=m}m=Nn(r[Le+(z<<2)>>2]|0,Qe)|0,(z|0)==(r[n+32>>2]|0)?$=st:$=Nn(r[Le+($<<2)>>2]|0,Qe)|0}else{Le=st>>>15,r[gt>>2]=Le,ne=r[n>>2]|0,Qe=r[n+8>>2]|0,c=t+4|0,s=r[c>>2]|0,ge=ne>>>1,m=0,$=st,z=0;do Ot=Nn(r[Qe+(ge<<2)>>2]|0,Le)|0,st=Ot>>>0>s>>>0,$=st?Ot:$,m=st?m:Ot,z=st?z:ge,ne=st?ge:ne,ge=(z+ne|0)>>>1;while((ge|0)!=(z|0))}return r[c>>2]=s-m,Ot=$-m|0,r[gt>>2]=Ot,Ot>>>0<16777216&&Ah(t),gt=(r[n+12>>2]|0)+(z<<2)|0,r[gt>>2]=(r[gt>>2]|0)+1,gt=n+28|0,Ot=(r[gt>>2]|0)+-1|0,r[gt>>2]=Ot,Ot||sh(n),z|0}function jo(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;return n>>>0>19?(s=(Ts(t)|0)&65535,(jo(t,n+-16|0)|0)<<16|s|0):(c=t+4|0,m=r[c>>2]|0,z=t+8|0,s=(r[z>>2]|0)>>>n,r[z>>2]=s,n=(m>>>0)/(s>>>0)|0,r[c>>2]=m-(Nn(n,s)|0),s>>>0<16777216&&Ah(t),n|0)}function dg(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0,ne=0;return c=t+8|0,m=r[c>>2]|0,s=Nn(m>>>13,r[n+8>>2]|0)|0,z=t+4|0,$=r[z>>2]|0,ne=$>>>0>=s>>>0,ne?(r[z>>2]=$-s,s=m-s|0,r[c>>2]=s):(r[c>>2]=s,$=n+12|0,r[$>>2]=(r[$>>2]|0)+1),s>>>0<16777216&&Ah(t),$=n+4|0,t=(r[$>>2]|0)+-1|0,r[$>>2]=t,t||A(n),ne&1|0}function Ah(t){t=t|0;var n=0,s=0,c=0,m=0;n=t+4|0,s=t+8|0,c=r[n>>2]|0;do c=c<<8|(Kl(r[t>>2]|0)|0)&255,r[n>>2]=c,m=r[s>>2]<<8,r[s>>2]=m;while(m>>>0<16777216)}function Ts(t){t=t|0;var n=0,s=0,c=0,m=0;return s=t+4|0,m=r[s>>2]|0,n=t+8|0,c=(r[n>>2]|0)>>>16,r[n>>2]=c,n=(m>>>0)/(c>>>0)|0,r[s>>2]=m-(Nn(n,c)|0),Ah(t),n&65535|0}function zp(t){t=t|0,vi(t),rr(t)}function ac(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function pg(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==15904?t+12|0:0)|0}function Gp(t){t=t|0,In(t,16)}function Hd(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=5272,r[t+4>>2]=n,wh(t+8|0)}function qd(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5296,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function wh(t){t=t|0,yo(t,32,1,8,0),wa(t+80|0,32,1,8,0),ie[t+160>>0]=0,ie[t+161>>0]=0,Wp(t+164|0)}function Vp(t){t=t|0,r[t>>2]=5272,gg(t+8|0),go(t)}function mg(t){t=t|0,Vp(t),rr(t)}function vg(t,n){return t=t|0,n=n|0,pf(t+8|0,r[t+4>>2]|0,n)|0}function Wp(t){t=t|0,ie[t+4>>0]=0}function gg(t){t=t|0,za(t+80|0),_o(t)}function pf(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;return z=Me,Me=Me+16|0,c=z,ie[t+161>>0]|0||ls(t+80|0),m=t+164|0,al(m)|0?(n=Ji(t+80|0,n,r[m>>2]|0,0)|0,r[c>>2]=n,Mu(n,s)):(ic(nc(n)|0,s,4),r[c>>2]=Pd(s)|0),mf(m,c),Me=z,s+4|0}function al(t){return t=t|0,(ie[t+4>>0]|0)!=0|0}function mf(t,n){t=t|0,n=n|0;var s=0;s=t+4|0,ie[s>>0]|0||(ie[s>>0]=1),r[t>>2]=r[n>>2]}function Yo(t){t=t|0,vi(t),rr(t)}function vf(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function Xd(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==16402?t+12|0:0)|0}function Zd(t){t=t|0,In(t,16)}function Hp(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(172)|0,qp($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],Is(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function jd(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(176)|0,k1($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],D1(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function qp(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=5324,r[t+4>>2]=n,Mh(t+8|0)}function Is(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5348,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function Mh(t){t=t|0,yo(t,8,1,8,0),wa(t+80|0,8,1,8,0),ie[t+160>>0]=0,ie[t+161>>0]=0,Zp(t+162|0)}function Yd(t){t=t|0,r[t>>2]=5324,jp(t+8|0),go(t)}function Xp(t){t=t|0,Yd(t),rr(t)}function Jd(t,n){return t=t|0,n=n|0,Yp(t+8|0,r[t+4>>2]|0,n)|0}function Zp(t){t=t|0,ie[t+1>>0]=0}function jp(t){t=t|0,za(t+80|0),_o(t)}function Yp(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;return z=Me,Me=Me+16|0,c=z,ie[t+161>>0]|0||ls(t+80|0),m=t+162|0,Jp(m)|0?(n=(Ji(t+80|0,n,ie[m>>0]|0,0)|0)&255,ie[c>>0]=n,yg(n,s)):(ic(nc(n)|0,s,1),ie[c>>0]=P1(s)|0),L1(m,c),Me=z,s+1|0}function Jp(t){return t=t|0,(ie[t+1>>0]|0)!=0|0}function yg(t,n){t=t|0,n=n|0,ie[n>>0]=t}function P1(t){return t=t|0,ie[t>>0]|0}function L1(t,n){t=t|0,n=n|0;var s=0;s=t+1|0,ie[s>>0]|0||(ie[s>>0]=1),ie[t>>0]=ie[n>>0]|0}function O1(t){t=t|0,vi(t),rr(t)}function bh(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function F1(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==16900?t+12|0:0)|0}function I1(t){t=t|0,In(t,16)}function k1(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=5376,r[t+4>>2]=n,Eh(t+8|0)}function D1(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5400,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function Eh(t){t=t|0,yo(t,16,1,8,0),wa(t+80|0,16,1,8,0),ie[t+160>>0]=0,ie[t+161>>0]=0,_g(t+162|0)}function Th(t){t=t|0,r[t>>2]=5376,$d(t+8|0),go(t)}function $p(t){t=t|0,Th(t),rr(t)}function Sh(t,n){return t=t|0,n=n|0,Qd(t+8|0,r[t+4>>2]|0,n)|0}function _g(t){t=t|0,ie[t+2>>0]=0}function $d(t){t=t|0,za(t+80|0),_o(t)}function Qd(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;return z=Me,Me=Me+16|0,c=z,ie[t+161>>0]|0||ls(t+80|0),m=t+162|0,Kd(m)|0?(n=(Ji(t+80|0,n,zt[m>>1]|0,0)|0)&65535,zt[c>>1]=n,Qp(n,s)):(ic(nc(n)|0,s,2),zt[c>>1]=xg(s)|0),Rh(m,c),Me=z,s+2|0}function Kd(t){return t=t|0,(ie[t+2>>0]|0)!=0|0}function Qp(t,n){t=t|0,n=n|0,Xl(t,n)}function xg(t){return t=t|0,Qa(t)|0}function Rh(t,n){t=t|0,n=n|0;var s=0;s=t+2|0,ie[s>>0]|0||(ie[s>>0]=1),zt[t>>1]=zt[n>>1]|0}function Jo(t){t=t|0,vi(t),rr(t)}function N1(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function Ag(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==17398?t+12|0:0)|0}function sl(t){t=t|0,In(t,16)}function Ch(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(172)|0,U1($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],z1(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function B1(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;ge=Me,Me=Me+32|0,c=ge+12|0,m=ge,n=ge+8|0,$=cr(176)|0,e0($,r[t+4>>2]|0),z=t+8|0,r[n>>2]=0,r[c>>2]=r[n>>2],Mg(m,$,c),$=t+12|0,n=r[$>>2]|0,ne=t+16|0;do if(n>>>0>=(r[ne>>2]|0)>>>0)if(n=(n-(r[z>>2]|0)>>3)+1|0,s=qo(z)|0,s>>>0<n>>>0)Ss(z);else{Le=r[z>>2]|0,Qe=(r[ne>>2]|0)-Le|0,ne=Qe>>2,Vo(c,Qe>>3>>>0<s>>>1>>>0?ne>>>0<n>>>0?n:ne:s,(r[$>>2]|0)-Le>>3,t+16|0),ne=c+8|0,$=r[ne>>2]|0,r[$>>2]=r[m>>2],t=m+4|0,r[$+4>>2]=r[t>>2],r[m>>2]=0,r[t>>2]=0,r[ne>>2]=$+8,Wo(z,c),Ho(c);break}else Es(c,z,1),Qe=c+4|0,Le=r[Qe>>2]|0,r[Le>>2]=r[m>>2],ne=m+4|0,r[Le+4>>2]=r[ne>>2],r[m>>2]=0,r[ne>>2]=0,r[Qe>>2]=Le+8,Go(c);while(0);pi(m),Me=ge}function U1(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=5428,r[t+4>>2]=n,G1(t+8|0)}function z1(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5452,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function G1(t){t=t|0,yo(t,8,1,8,0),wa(t+80|0,8,1,8,0),ie[t+160>>0]=0,ie[t+161>>0]=0,H1(t+162|0)}function wg(t){t=t|0,r[t>>2]=5428,q1(t+8|0),go(t)}function V1(t){t=t|0,wg(t),rr(t)}function W1(t,n){return t=t|0,n=n|0,X1(t+8|0,r[t+4>>2]|0,n)|0}function H1(t){t=t|0,ie[t+1>>0]=0}function q1(t){t=t|0,za(t+80|0),_o(t)}function X1(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;return z=Me,Me=Me+16|0,c=z,ie[t+161>>0]|0||ls(t+80|0),m=t+162|0,Z1(m)|0?(n=(Ji(t+80|0,n,We[m>>0]|0,0)|0)&255,ie[c>>0]=n,gp(n,s)):(ic(nc(n)|0,s,1),ie[c>>0]=vp(s)|0),Kp(m,c),Me=z,s+1|0}function Z1(t){return t=t|0,(ie[t+1>>0]|0)!=0|0}function Kp(t,n){t=t|0,n=n|0;var s=0;s=t+1|0,ie[s>>0]|0||(ie[s>>0]=1),ie[t>>0]=ie[n>>0]|0}function j1(t){t=t|0,vi(t),rr(t)}function gf(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function Y1(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==17896?t+12|0:0)|0}function $i(t){t=t|0,In(t,16)}function e0(t,n){t=t|0,n=n|0,Xo(t),r[t>>2]=5480,r[t+4>>2]=n,t0(t+8|0)}function Mg(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;s=Me,Me=Me+16|0,c=s,r[t>>2]=n,m=cr(16)|0,r[m+4>>2]=0,r[m+8>>2]=0,r[m>>2]=5504,r[m+12>>2]=n,r[t+4>>2]=m,r[c>>2]=n,r[c+4>>2]=n,cs(t,c),Me=s}function t0(t){t=t|0,yo(t,16,1,8,0),wa(t+80|0,16,1,8,0),ie[t+160>>0]=0,ie[t+161>>0]=0,$1(t+162|0)}function Ph(t){t=t|0,r[t>>2]=5480,bg(t+8|0),go(t)}function J1(t){t=t|0,Ph(t),rr(t)}function Lh(t,n){return t=t|0,n=n|0,Eg(t+8|0,r[t+4>>2]|0,n)|0}function $1(t){t=t|0,ie[t+2>>0]=0}function bg(t){t=t|0,za(t+80|0),_o(t)}function Eg(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;return z=Me,Me=Me+16|0,c=z,ie[t+161>>0]|0||ls(t+80|0),m=t+162|0,Oh(m)|0?(n=(Ji(t+80|0,n,Yt[m>>1]|0,0)|0)&65535,zt[c>>1]=n,Xl(n,s)):(ic(nc(n)|0,s,2),zt[c>>1]=Qa(s)|0),em(m,c),Me=z,s+2|0}function Oh(t){return t=t|0,(ie[t+2>>0]|0)!=0|0}function em(t,n){t=t|0,n=n|0;var s=0;s=t+2|0,ie[s>>0]|0||(ie[s>>0]=1),zt[t>>1]=zt[n>>1]|0}function Q1(t){t=t|0,vi(t),rr(t)}function $o(t){t=t|0,t=r[t+12>>2]|0,t|0&&Bi[r[(r[t>>2]|0)+4>>2]&255](t)}function Tg(t,n){return t=t|0,n=n|0,((r[n+4>>2]|0)==18394?t+12|0:0)|0}function Sg(t){t=t|0,In(t,16)}function bu(){}function K1(t){return t=t|0,oc(t)|0}function e_(){return 0}function yf(){return 0}function _f(t){t=t|0,t|0&&(Af(t),rr(t))}function xo(){return wf()|0}function xf(){return Mf()|0}function sc(){return bf()|0}function Rg(){return 0}function oc(t){return t=t|0,3360}function Af(t){t=t|0;var n=0,s=0,c=0,m=0;n=Me,Me=Me+16|0,c=n,r[c>>2]=r[t>>2],r[t>>2]=0,s=t+4|0,r[c+4>>2]=r[s>>2],r[s>>2]=0,Ra(c),s=t+8|0,r[c>>2]=r[s>>2],r[s>>2]=0,m=t+12|0,r[c+4>>2]=r[m>>2],r[m>>2]=0,so(c),so(s),Ra(t),Me=n}function wf(){return 3360}function Mf(){return 3368}function bf(){return 3384}function Ef(){return 18579}function Fh(){return 18582}function tm(){return 18584}function rm(){var t=0;return t=cr(16)|0,um(t),t|0}function r0(t){t=t|0;var n=0,s=0,c=0,m=0;n=Me,Me=Me+16|0,s=n,m=xo()|0,c=im(s)|0,s=am(s)|0,xs(m|0,c|0,s|0,Ef()|0,12,t|0),Me=n}function nm(t){return t=t|0,sm(Ax[t&3]()|0)|0}function im(t){return t=t|0,1}function am(t){return t=t|0,om()|0}function sm(t){return t=t|0,t|0}function om(){return 5524}function um(t){t=t|0,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0}function lm(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;s=Me,Me=Me+16|0,c=s,m=s+8|0,$=r[n+4>>2]|0,r[c>>2]=r[n>>2],r[c+4>>2]=$,$=xo()|0,z=Gi(m)|0,m=Eu(m)|0,n=n0()|0,us($|0,t|0,z|0,m|0,n|0,4,Cg(c)|0,0),Me=s}function t_(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;z=Ih(n)|0,n=r[t>>2]|0,m=r[t+4>>2]|0,t=z+(m>>1)|0,m&1&&(n=r[(r[t>>2]|0)+n>>2]|0),m=cm(s)|0,z=ks(c)|0,Dm[n&15](t,m,z)}function Gi(t){return t=t|0,4}function Eu(t){return t=t|0,uc()|0}function Cg(t){t=t|0;var n=0,s=0;return n=cr(8)|0,s=r[t+4>>2]|0,r[n>>2]=r[t>>2],r[n+4>>2]=s,n|0}function Ih(t){return t=t|0,t|0}function cm(t){return t=t|0,t|0}function ks(t){return t=t|0,t|0}function uc(){return 144}function n0(){return 18587}function kh(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;s=Me,Me=Me+16|0,c=s,m=s+8|0,$=r[n+4>>2]|0,r[c>>2]=r[n>>2],r[c+4>>2]=$,$=xo()|0,z=Tf(m)|0,m=lc(m)|0,n=fm()|0,us($|0,t|0,z|0,m|0,n|0,7,Dh(c)|0,0),Me=s}function Pg(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;m=Ih(n)|0,n=r[t>>2]|0,c=r[t+4>>2]|0,t=m+(c>>1)|0,c&1&&(n=r[(r[t>>2]|0)+n>>2]|0),m=Sf(s)|0,Lf[n&15](t,m)}function Tf(t){return t=t|0,3}function lc(t){return t=t|0,r_()|0}function Dh(t){t=t|0;var n=0,s=0;return n=cr(8)|0,s=r[t+4>>2]|0,r[n>>2]=r[t>>2],r[n+4>>2]=s,n|0}function Sf(t){return t=t|0,t|0}function r_(){return 5528}function fm(){return 18593}function cc(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;s=Me,Me=Me+16|0,c=s,m=s+8|0,$=r[n+4>>2]|0,r[c>>2]=r[n>>2],r[c+4>>2]=$,$=xo()|0,z=Lg(m)|0,m=hs(m)|0,n=i_()|0,us($|0,t|0,z|0,m|0,n|0,41,Tu(c)|0,0),Me=s}function hm(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;return c=Me,Me=Me+16|0,s=c,z=Ih(n)|0,n=r[t>>2]|0,m=r[t+4>>2]|0,t=z+(m>>1)|0,m&1&&(n=r[(r[t>>2]|0)+n>>2]|0),r[s>>2]=Ly[n&15](t)|0,z=Qo(s)|0,Me=c,z|0}function Lg(t){return t=t|0,2}function hs(t){return t=t|0,n_()|0}function Tu(t){t=t|0;var n=0,s=0;return n=cr(8)|0,s=r[t+4>>2]|0,r[n>>2]=r[t>>2],r[n+4>>2]=s,n|0}function Qo(t){return t=t|0,r[t>>2]|0}function n_(){return 5540}function i_(){return 18598}function i0(){}function Og(t){return t=t|0,Ng(t)|0}function Fg(){return 0}function Ig(){return 0}function Ao(t){t=t|0,t|0&&(dm(t),rr(t))}function fc(){return Bg()|0}function kg(){return pm()|0}function Dg(){return Ug()|0}function Ng(t){return t=t|0,3400}function dm(t){t=t|0;var n=0,s=0,c=0,m=0;n=Me,Me=Me+16|0,c=n,r[c>>2]=r[t>>2],r[t>>2]=0,s=t+4|0,r[c+4>>2]=r[s>>2],r[s>>2]=0,Yi(c),s=t+16|0,r[c>>2]=r[s>>2],r[s>>2]=0,m=t+20|0,r[c+4>>2]=r[m>>2],r[m>>2]=0,nl(c),r[c>>2]=r[s>>2],r[s>>2]=0,r[c+4>>2]=r[m>>2],r[m>>2]=0,nl(c),nl(s),Ql(t+8|0),Yi(t),Me=n}function Bg(){return 3400}function pm(){return 3408}function Ug(){return 3424}function Nh(){var t=0;return t=cr(24)|0,_m(t),t|0}function mm(t){t=t|0;var n=0,s=0,c=0,m=0;n=Me,Me=Me+16|0,s=n,m=fc()|0,c=vm(s)|0,s=Gg(s)|0,xs(m|0,c|0,s|0,Ef()|0,13,t|0),Me=n}function zg(t){return t=t|0,gm(Ax[t&3]()|0)|0}function vm(t){return t=t|0,1}function Gg(t){return t=t|0,ym()|0}function gm(t){return t=t|0,t|0}function ym(){return 5548}function _m(t){t=t|0,r[t>>2]=0,r[t+4>>2]=0,r[t+8>>2]=0,r[t+12>>2]=0,r[t+16>>2]=0,r[t+20>>2]=0}function xm(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;s=Me,Me=Me+16|0,c=s,m=s+8|0,$=r[n+4>>2]|0,r[c>>2]=r[n>>2],r[c+4>>2]=$,$=fc()|0,z=Vg(m)|0,m=a0(m)|0,n=n0()|0,us($|0,t|0,z|0,m|0,n|0,5,Am(c)|0,0),Me=s}function Bh(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;z=s0(n)|0,n=r[t>>2]|0,m=r[t+4>>2]|0,t=z+(m>>1)|0,m&1&&(n=r[(r[t>>2]|0)+n>>2]|0),m=cm(s)|0,z=ks(c)|0,Dm[n&15](t,m,z)}function Vg(t){return t=t|0,4}function a0(t){return t=t|0,a_()|0}function Am(t){t=t|0;var n=0,s=0;return n=cr(8)|0,s=r[t+4>>2]|0,r[n>>2]=r[t>>2],r[n+4>>2]=s,n|0}function s0(t){return t=t|0,t|0}function a_(){return 160}function wm(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;s=Me,Me=Me+16|0,c=s,m=s+8|0,$=r[n+4>>2]|0,r[c>>2]=r[n>>2],r[c+4>>2]=$,$=fc()|0,z=Hg(m)|0,m=qg(m)|0,n=fm()|0,us($|0,t|0,z|0,m|0,n|0,8,o0(c)|0,0),Me=s}function Wg(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;m=s0(n)|0,n=r[t>>2]|0,c=r[t+4>>2]|0,t=m+(c>>1)|0,c&1&&(n=r[(r[t>>2]|0)+n>>2]|0),m=ks(s)|0,Lf[n&15](t,m)}function Hg(t){return t=t|0,3}function qg(t){return t=t|0,Mm()|0}function o0(t){t=t|0;var n=0,s=0;return n=cr(8)|0,s=r[t+4>>2]|0,r[n>>2]=r[t>>2],r[n+4>>2]=s,n|0}function Mm(){return 5552}function Xg(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;s=Me,Me=Me+16|0,c=s,m=s+8|0,$=r[n+4>>2]|0,r[c>>2]=r[n>>2],r[c+4>>2]=$,$=fc()|0,z=jg(m)|0,m=Yg(m)|0,n=fm()|0,us($|0,t|0,z|0,m|0,n|0,9,Jg(c)|0,0),Me=s}function Zg(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;m=s0(n)|0,n=r[t>>2]|0,c=r[t+4>>2]|0,t=m+(c>>1)|0,c&1&&(n=r[(r[t>>2]|0)+n>>2]|0),m=Sf(s)|0,Lf[n&15](t,m)}function jg(t){return t=t|0,3}function Yg(t){return t=t|0,hc()|0}function Jg(t){t=t|0;var n=0,s=0;return n=cr(8)|0,s=r[t+4>>2]|0,r[n>>2]=r[t>>2],r[n+4>>2]=s,n|0}function hc(){return 5564}function s_(){Pl()}function $g(){Qg()}function Qg(){dc(22144)}function dc(t){t=t|0;var n=0;n=Me,Me=Me+16|0,r[n>>2]=t,bm(),Me=n}function bm(){io(o_()|0,18653),Tl(pc()|0,18658,1,1,0),u_(18663),Em(18668),mc(18680),Kg(18694),l_(18700),vc(18715),c_(18719),ey(18732),ty(18737),Tm(18751),f_(18757),As(Sm()|0,18764),As(h_()|0,18776),qs(d_()|0,4,18809),qs(p_()|0,2,18822),qs(m_()|0,4,18837),Sl(v_()|0,18852),g_(18868),ry(18898),ny(18935),ui(18974),Rm(19005),iy(19045),Cm(19074),u0(19112),ay(19142),ry(19181),ny(19213),ui(19246),Rm(19279),iy(19313),Cm(19346),sy(19380),y_(19411),oy(19443)}function o_(){return rx()|0}function pc(){return tx()|0}function u_(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=K_()|0,ka(t|0,r[s>>2]|0,1,-128<<24>>24|0,127<<24>>24|0),Me=n}function Em(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=$_()|0,ka(t|0,r[s>>2]|0,1,-128<<24>>24|0,127<<24>>24|0),Me=n}function mc(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=Y_()|0,ka(t|0,r[s>>2]|0,1,0,255),Me=n}function Kg(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=Z_()|0,ka(t|0,r[s>>2]|0,2,-32768<<16>>16|0,32767<<16>>16|0),Me=n}function l_(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=q_()|0,ka(t|0,r[s>>2]|0,2,0,65535),Me=n}function vc(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=W_()|0,ka(t|0,r[s>>2]|0,4,-2147483648,2147483647),Me=n}function c_(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=G_()|0,ka(t|0,r[s>>2]|0,4,0,-1),Me=n}function ey(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=U_()|0,ka(t|0,r[s>>2]|0,4,-2147483648,2147483647),Me=n}function ty(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=N_()|0,ka(t|0,r[s>>2]|0,4,0,-1),Me=n}function Tm(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=k_()|0,pu(t|0,r[s>>2]|0,4),Me=n}function f_(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,t=F_()|0,pu(t|0,r[s>>2]|0,8),Me=n}function Sm(){return O_()|0}function h_(){return wy()|0}function d_(){return L_()|0}function p_(){return Ay()|0}function m_(){return P_()|0}function v_(){return Om()|0}function g_(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=C_()|0,t=xy()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function ry(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=d0()|0,t=_y()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function ny(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=ia()|0,t=S_()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function ui(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=yy()|0,t=T_()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function Rm(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=E_()|0,t=gy()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function iy(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=my()|0,t=b_()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function Cm(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=w_()|0,t=M_()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function u0(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=Lm()|0,t=hy()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function ay(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=A_()|0,t=ol()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function sy(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=l0()|0,t=cy()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function y_(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=uy()|0,t=Rf()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function oy(t){t=t|0;var n=0,s=0,c=0;n=Me,Me=Me+16|0,s=n,r[s>>2]=t,c=Pm()|0,t=__()|0,Sa(c|0,t|0,r[s>>2]|0),Me=n}function Pm(){return x_()|0}function __(){return 7}function x_(){return 3440}function uy(){return ly()|0}function Rf(){return 7}function ly(){return 3448}function l0(){return fy()|0}function cy(){return 6}function fy(){return 3456}function A_(){return c0()|0}function ol(){return 5}function c0(){return 3464}function Lm(){return dy()|0}function hy(){return 4}function dy(){return 3472}function w_(){return py()|0}function M_(){return 5}function py(){return 3480}function my(){return vy()|0}function b_(){return 4}function vy(){return 3488}function E_(){return f0()|0}function gy(){return 3}function f0(){return 3496}function yy(){return h0()|0}function T_(){return 2}function h0(){return 3504}function ia(){return ma()|0}function S_(){return 1}function ma(){return 3512}function d0(){return R_()|0}function _y(){return 0}function R_(){return 3520}function C_(){return p0()|0}function xy(){return 0}function p0(){return 3528}function Om(){return 3536}function P_(){return 3544}function Ay(){return 3576}function L_(){return 3600}function wy(){return 3624}function O_(){return 3648}function F_(){return I_()|0}function I_(){return 4144}function k_(){return D_()|0}function D_(){return 4136}function N_(){return B_()|0}function B_(){return 4128}function U_(){return z_()|0}function z_(){return 4120}function G_(){return V_()|0}function V_(){return 4112}function W_(){return H_()|0}function H_(){return 4104}function q_(){return X_()|0}function X_(){return 4096}function Z_(){return j_()|0}function j_(){return 4088}function Y_(){return J_()|0}function J_(){return 4072}function $_(){return Q_()|0}function Q_(){return 4080}function K_(){return ex()|0}function ex(){return 4064}function tx(){return 4056}function rx(){return 4040}function nx(t){t=t|0;var n=0,s=0,c=0,m=0;return n=Me,Me=Me+16|0,s=n+8|0,c=n+4|0,m=n,r[m>>2]=t,r[c>>2]=r[m>>2],r[s>>2]=r[(r[c>>2]|0)+4>>2],t=xe(r[s>>2]|0)|0,Me=n,t|0}function Ko(){return 21636}function Uh(t){return t=t|0,(t+-48|0)>>>0<10|0}function My(){return 5576}function by(t,n){t=t|0,n=n|0;var s=0,c=0;if(s=ie[t>>0]|0,c=ie[n>>0]|0,s<<24>>24==0||s<<24>>24!=c<<24>>24)t=c;else{do t=t+1|0,n=n+1|0,s=ie[t>>0]|0,c=ie[n>>0]|0;while(!(s<<24>>24==0||s<<24>>24!=c<<24>>24));t=c}return(s&255)-(t&255)|0}function m0(t){t=t|0;var n=0,s=0,c=0;c=t;e:do if(!(c&3))s=5;else for(n=c;;){if(!(ie[t>>0]|0)){t=n;break e}if(t=t+1|0,n=t,!(n&3)){s=5;break}}while(0);if((s|0)==5){for(;n=r[t>>2]|0,!((n&-2139062144^-2139062144)&n+-16843009);)t=t+4|0;if((n&255)<<24>>24)do t=t+1|0;while((ie[t>>0]|0)!=0)}return t-c|0}function ix(t){t=t|0}function ax(t){return t=t|0,1}function sx(t){t=t|0;var n=0,s=0;return n=t+74|0,s=ie[n>>0]|0,ie[n>>0]=s+255|s,n=r[t>>2]|0,n&8?(r[t>>2]=n|32,t=-1):(r[t+8>>2]=0,r[t+4>>2]=0,s=r[t+44>>2]|0,r[t+28>>2]=s,r[t+20>>2]=s,r[t+16>>2]=s+(r[t+48>>2]|0),t=0),t|0}function ox(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0;c=s+16|0,m=r[c>>2]|0,m?z=5:sx(s)|0?c=0:(m=r[c>>2]|0,z=5);e:do if((z|0)==5){if(ne=s+20|0,$=r[ne>>2]|0,c=$,(m-$|0)>>>0<n>>>0){c=_0[r[s+36>>2]&7](s,t,n)|0;break}t:do if((ie[s+75>>0]|0)<0|(n|0)==0)z=0,m=t;else{for($=n;m=$+-1|0,(ie[t+m>>0]|0)!=10;)if(m)$=m;else{z=0,m=t;break t}if(c=_0[r[s+36>>2]&7](s,t,$)|0,c>>>0<$>>>0)break e;z=$,m=t+$|0,n=n-$|0,c=r[ne>>2]|0}while(0);wo(c|0,m|0,n|0)|0,r[ne>>2]=(r[ne>>2]|0)+n,c=z+n|0}while(0);return c|0}function ux(t,n){return t=t|0,n=n|0,n?n=lx(r[n>>2]|0,r[n+4>>2]|0,t)|0:n=0,((n|0)==0?t:n)|0}function lx(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0;gt=(r[t>>2]|0)+1794895138|0,z=gc(r[t+8>>2]|0,gt)|0,c=gc(r[t+12>>2]|0,gt)|0,m=gc(r[t+16>>2]|0,gt)|0;e:do if(z>>>0<n>>>2>>>0&&(st=n-(z<<2)|0,c>>>0<st>>>0&m>>>0<st>>>0)&&((m|c)&3|0)==0){for(st=c>>>2,Qe=m>>>2,Le=0;;){if(ne=z>>>1,ge=Le+ne|0,$=ge<<1,m=$+st|0,c=gc(r[t+(m<<2)>>2]|0,gt)|0,m=gc(r[t+(m+1<<2)>>2]|0,gt)|0,!(m>>>0<n>>>0&c>>>0<(n-m|0)>>>0)){c=0;break e}if(ie[t+(m+c)>>0]|0){c=0;break e}if(c=by(s,t+m|0)|0,!c)break;if(c=(c|0)<0,(z|0)==1){c=0;break e}Le=c?Le:ge,z=c?ne:z-ne|0}c=$+Qe|0,m=gc(r[t+(c<<2)>>2]|0,gt)|0,c=gc(r[t+(c+1<<2)>>2]|0,gt)|0,c>>>0<n>>>0&m>>>0<(n-c|0)>>>0?c=(ie[t+(c+m)>>0]|0)==0?t+c|0:0:c=0}else c=0;while(0);return c|0}function gc(t,n){t=t|0,n=n|0;var s=0;return s=Rb(t|0)|0,((n|0)==0?t:s)|0}function cx(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;z=n&255,c=(s|0)!=0;e:do if(c&(t&3|0)!=0)for(m=n&255;;){if((ie[t>>0]|0)==m<<24>>24){m=6;break e}if(t=t+1|0,s=s+-1|0,c=(s|0)!=0,!(c&(t&3|0)!=0)){m=5;break}}else m=5;while(0);(m|0)==5&&(c?m=6:t=0);e:do if((m|0)==6){if((ie[t>>0]|0)!=(n&255)<<24>>24){c=Nn(z,16843009)|0;t:do if(s>>>0>3)do{if(z=r[t>>2]^c,(z&-2139062144^-2139062144)&z+-16843009|0)break t;t=t+4|0,s=s+-4|0}while(s>>>0>3);while(0)}if(!s)t=0;else for(c=n&255;;){if((ie[t>>0]|0)==c<<24>>24)break e;if(s=s+-1|0,s)t=t+1|0;else{t=0;break}}}while(0);return t|0}function fx(t,n,s){return t=t|0,n=n|0,s=s|0,f(t,n,s,1,8)|0}function hx(t,n,s,c,m,z){t=t|0,n=+n,s=s|0,c=c|0,m=m|0,z=z|0;var $=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0,Mn=0,Ar=0,sr=0,Xr=0,Gt=0,gi=0,ea=0,yi=0,jn=0,Vi=0,Pn=0,Un=0,Cu=0;Cu=Me,Me=Me+560|0,ge=Cu+32|0,Ar=Cu+536|0,Un=Cu,Pn=Un,Le=Cu+540|0,r[Ar>>2]=0,Vi=Le+12|0,de(n)|0,$=ei()|0,($|0)<0?(n=-n,de(n)|0,jn=1,yi=20247,$=ei()|0):(jn=(m&2049|0)!=0&1,yi=(m&2048|0)==0?(m&1|0)==0?20248:20253:20250);do if(!0&($&2146435072|0)==2146435072)Un=(z&32|0)!=0,$=jn+3|0,J(t,32,s,$,m&-65537),i(t,yi,jn),i(t,n!=n|!1?Un?20274:20278:Un?20266:20270,3),J(t,32,s,$,m^8192);else{if(Ot=+ve(n,Ar)*2,$=Ot!=0,$&&(r[Ar>>2]=(r[Ar>>2]|0)+-1),Mn=z|32,(Mn|0)==97){st=z&32,Bt=(st|0)==0?yi:yi+9|0,gt=jn|2,$=12-c|0;do if(c>>>0>11|($|0)==0)n=Ot;else{n=8;do $=$+-1|0,n=n*16;while(($|0)!=0);if((ie[Bt>>0]|0)==45){n=-(n+(-Ot-n));break}else{n=Ot+n-n;break}}while(0);ne=r[Ar>>2]|0,$=(ne|0)<0?0-ne|0:ne,$=I($,(($|0)<0)<<31>>31,Vi)|0,($|0)==(Vi|0)&&($=Le+11|0,ie[$>>0]=48),ie[$+-1>>0]=(ne>>31&2)+43,Qe=$+-2|0,ie[Qe>>0]=z+15,ne=(c|0)<1,ge=(m&8|0)==0,Le=Un;do jn=~~n,$=Le+1|0,ie[Le>>0]=st|We[640+jn>>0],n=(n-+(jn|0))*16,($-Pn|0)==1&&!(ge&(ne&n==0))?(ie[$>>0]=46,Le=Le+2|0):Le=$;while(n!=0);(c|0)!=0&&(-2-Pn+Le|0)<(c|0)?(ne=Vi,ge=Qe,$=c+2+ne-ge|0):(ne=Vi,ge=Qe,$=ne-Pn-ge+Le|0),Vi=$+gt|0,J(t,32,s,Vi,m),i(t,Bt,gt),J(t,48,s,Vi,m^65536),Pn=Le-Pn|0,i(t,Un,Pn),Un=ne-ge|0,J(t,48,$-(Pn+Un)|0,0,0),i(t,Qe,Un),J(t,32,s,Vi,m^8192),$=Vi;break}ne=(c|0)<0?6:c,$?($=(r[Ar>>2]|0)+-28|0,r[Ar>>2]=$,n=Ot*268435456):(n=Ot,$=r[Ar>>2]|0),ea=($|0)<0?ge:ge+288|0,ge=ea;do Gt=~~n>>>0,r[ge>>2]=Gt,ge=ge+4|0,n=(n-+(Gt>>>0))*1e9;while(n!=0);if(Gt=ea,($|0)>0)for(st=ea;;){if(Qe=($|0)<29?$:29,$=ge+-4|0,$>>>0>=st>>>0){Le=0;do Lt=Tb(r[$>>2]|0,0,Qe|0)|0,Lt=ru(Lt|0,ei()|0,Le|0,0)|0,sr=ei()|0,Le=yx(Lt|0,sr|0,1e9,0)|0,Xr=gx(Le|0,ei()|0,1e9,0)|0,Xr=y0(Lt|0,sr|0,Xr|0,ei()|0)|0,ei()|0,r[$>>2]=Xr,$=$+-4|0;while($>>>0>=st>>>0);Le?(Xr=st+-4|0,r[Xr>>2]=Le,Le=Xr):Le=st}else Le=st;e:do if(ge>>>0>Le>>>0)for($=ge;;){if(ge=$+-4|0,r[ge>>2]|0){ge=$;break e}if(ge>>>0>Le>>>0)$=ge;else break}while(0);if($=(r[Ar>>2]|0)-Qe|0,r[Ar>>2]=$,($|0)>0)st=Le;else break}else Le=ea;if(($|0)<0){c=((ne+25|0)/9|0)+1|0,Lt=(Mn|0)==102;do{if(Bt=0-$|0,Bt=(Bt|0)<9?Bt:9,Le>>>0<ge>>>0){Qe=(1<<Bt)+-1|0,st=1e9>>>Bt,gt=0,$=Le;do Xr=r[$>>2]|0,r[$>>2]=(Xr>>>Bt)+gt,gt=Nn(Xr&Qe,st)|0,$=$+4|0;while($>>>0<ge>>>0);Le=(r[Le>>2]|0)==0?Le+4|0:Le,gt&&(r[ge>>2]=gt,ge=ge+4|0)}else Le=(r[Le>>2]|0)==0?Le+4|0:Le;$=Lt?ea:Le,ge=(ge-$>>2|0)>(c|0)?$+(c<<2)|0:ge,$=(r[Ar>>2]|0)+Bt|0,r[Ar>>2]=$}while(($|0)<0);Lt=Le}else Lt=Le;if(Lt>>>0<ge>>>0){if($=(Gt-Lt>>2)*9|0,Qe=r[Lt>>2]|0,Qe>>>0>=10){Le=10;do Le=Le*10|0,$=$+1|0;while(Qe>>>0>=Le>>>0)}}else $=0;if(sr=(Mn|0)==103,Xr=(ne|0)!=0,Le=ne-((Mn|0)==102?0:$)+((Xr&sr)<<31>>31)|0,(Le|0)<(((ge-Gt>>2)*9|0)+-9|0)){if(Ar=Le+9216|0,Le=(Ar|0)/9|0,c=ea+4+(Le+-1024<<2)|0,Le=Ar-(Le*9|0)|0,(Le|0)<8)for(Qe=10;Qe=Qe*10|0,(Le|0)<7;)Le=Le+1|0;else Qe=10;if(gt=r[c>>2]|0,Le=(gt>>>0)/(Qe>>>0)|0,Bt=gt-(Nn(Le,Qe)|0)|0,st=(c+4|0)==(ge|0),st&(Bt|0)==0)Le=c,Qe=Lt;else if(Ot=(Le&1|0)==0?9007199254740992:9007199254740994,Ar=Qe>>>1,n=Bt>>>0<Ar>>>0?.5:st&(Bt|0)==(Ar|0)?1:1.5,jn&&(Ar=(ie[yi>>0]|0)==45,n=Ar?-n:n,Ot=Ar?-Ot:Ot),Le=gt-Bt|0,r[c>>2]=Le,Ot+n!=Ot){if(Ar=Le+Qe|0,r[c>>2]=Ar,Ar>>>0>999999999)for(Qe=c,$=Lt;;)if(Le=Qe+-4|0,r[Qe>>2]=0,Le>>>0<$>>>0&&($=$+-4|0,r[$>>2]=0),Ar=(r[Le>>2]|0)+1|0,r[Le>>2]=Ar,Ar>>>0>999999999)Qe=Le;else{Qe=$;break}else Le=c,Qe=Lt;if($=(Gt-Qe>>2)*9|0,gt=r[Qe>>2]|0,gt>>>0>=10){st=10;do st=st*10|0,$=$+1|0;while(gt>>>0>=st>>>0)}}else Le=c,Qe=Lt;Ar=Le+4|0,ge=ge>>>0>Ar>>>0?Ar:ge}else Qe=Lt;c=0-$|0;e:do if(ge>>>0>Qe>>>0)for(;;){if(Le=ge+-4|0,r[Le>>2]|0){Ar=ge,Mn=1;break e}if(Le>>>0>Qe>>>0)ge=Le;else{Ar=Le,Mn=0;break}}else Ar=ge,Mn=0;while(0);do if(sr){if(ne=ne+((Xr^1)&1)|0,(ne|0)>($|0)&($|0)>-5?(st=z+-1|0,ne=ne+-1-$|0):(st=z+-2|0,ne=ne+-1|0),!(m&8)){if(Mn&&(gi=r[Ar+-4>>2]|0,(gi|0)!=0))if((gi>>>0)%10|0)Le=0;else{Le=0,ge=10;do ge=ge*10|0,Le=Le+1|0;while(!((gi>>>0)%(ge>>>0)|0|0))}else Le=9;if(ge=((Ar-Gt>>2)*9|0)+-9|0,(st|32|0)==102){z=ge-Le|0,z=(z|0)>0?z:0,ne=(ne|0)<(z|0)?ne:z;break}else{z=ge+$-Le|0,z=(z|0)>0?z:0,ne=(ne|0)<(z|0)?ne:z;break}}}else st=z;while(0);if(Lt=(ne|0)!=0,gt=Lt?1:m>>>3&1,Bt=(st|32|0)==102,Bt)sr=0,$=($|0)>0?$:0;else{if(ge=($|0)<0?c:$,ge=I(ge,((ge|0)<0)<<31>>31,Vi)|0,Le=Vi,(Le-ge|0)<2)do ge=ge+-1|0,ie[ge>>0]=48;while((Le-ge|0)<2);ie[ge+-1>>0]=($>>31&2)+43,$=ge+-2|0,ie[$>>0]=st,sr=$,$=Le-$|0}if($=jn+1+ne+gt+$|0,J(t,32,s,$,m),i(t,yi,jn),J(t,48,s,$,m^65536),Bt){gt=Qe>>>0>ea>>>0?ea:Qe,Bt=Un+9|0,Qe=Bt,st=Un+8|0,Le=gt;do{if(ge=I(r[Le>>2]|0,0,Bt)|0,(Le|0)==(gt|0))(ge|0)==(Bt|0)&&(ie[st>>0]=48,ge=st);else if(ge>>>0>Un>>>0){Vh(Un|0,48,ge-Pn|0)|0;do ge=ge+-1|0;while(ge>>>0>Un>>>0)}i(t,ge,Qe-ge|0),Le=Le+4|0}while(Le>>>0<=ea>>>0);if((m&8|0)==0&(Lt^1)||i(t,20282,1),Le>>>0<Ar>>>0&(ne|0)>0)for(;;){if(ge=I(r[Le>>2]|0,0,Bt)|0,ge>>>0>Un>>>0){Vh(Un|0,48,ge-Pn|0)|0;do ge=ge+-1|0;while(ge>>>0>Un>>>0)}if(i(t,ge,(ne|0)<9?ne:9),Le=Le+4|0,ge=ne+-9|0,Le>>>0<Ar>>>0&(ne|0)>9)ne=ge;else{ne=ge;break}}J(t,48,ne+9|0,9,0)}else{if(Ar=Mn?Ar:Qe+4|0,Qe>>>0<Ar>>>0&(ne|0)>-1){c=Un+9|0,Lt=(m&8|0)==0,Mn=c,gt=0-Pn|0,Bt=Un+8|0,st=Qe;do{ge=I(r[st>>2]|0,0,c)|0,(ge|0)==(c|0)&&(ie[Bt>>0]=48,ge=Bt);do if((st|0)==(Qe|0)){if(Le=ge+1|0,i(t,ge,1),Lt&(ne|0)<1){ge=Le;break}i(t,20282,1),ge=Le}else{if(ge>>>0<=Un>>>0)break;Vh(Un|0,48,ge+gt|0)|0;do ge=ge+-1|0;while(ge>>>0>Un>>>0)}while(0);Pn=Mn-ge|0,i(t,ge,(ne|0)>(Pn|0)?Pn:ne),ne=ne-Pn|0,st=st+4|0}while(st>>>0<Ar>>>0&(ne|0)>-1)}J(t,48,ne+18|0,18,0),i(t,sr,Vi-sr|0)}J(t,32,s,$,m^8192)}while(0);return Me=Cu,(($|0)<(s|0)?s:$)|0}function dx(t,n){t=t|0,n=n|0;var s=0,c=0;c=(r[n>>2]|0)+(8-1)&~(8-1),s=+xr[c>>3],r[n>>2]=c+8,xr[t>>3]=s}function f(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0,Mn=0,Ar=0;Ar=Me,Me=Me+224|0,Ot=Ar+208|0,Bt=Ar+160|0,Lt=Ar+80|0,Mn=Ar,z=Bt,$=z+40|0;do r[z>>2]=0,z=z+4|0;while((z|0)<($|0));return r[Ot>>2]=r[s>>2],(e(0,n,Ot,Lt,Bt,c,m)|0)<0?s=-1:((r[t+76>>2]|0)>-1?gt=ax(t)|0:gt=0,s=r[t>>2]|0,st=s&32,(ie[t+74>>0]|0)<1&&(r[t>>2]=s&-33),z=t+48|0,r[z>>2]|0?s=e(t,n,Ot,Lt,Bt,c,m)|0:($=t+44|0,ne=r[$>>2]|0,r[$>>2]=Mn,ge=t+28|0,r[ge>>2]=Mn,Le=t+20|0,r[Le>>2]=Mn,r[z>>2]=80,Qe=t+16|0,r[Qe>>2]=Mn+80,s=e(t,n,Ot,Lt,Bt,c,m)|0,ne&&(_0[r[t+36>>2]&7](t,0,0)|0,s=(r[Le>>2]|0)==0?-1:s,r[$>>2]=ne,r[z>>2]=0,r[Qe>>2]=0,r[ge>>2]=0,r[Le>>2]=0)),z=r[t>>2]|0,r[t>>2]=z|st,gt|0&&ix(t),s=(z&32|0)==0?s:-1),Me=Ar,s|0}function e(t,n,s,c,m,z,$){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0,$=$|0;var ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0,Mn=0,Ar=0,sr=0,Xr=0,Gt=0,gi=0,ea=0,yi=0,jn=0,Vi=0,Pn=0,Un=0,Cu=0,sa=0,Hh=0,iu=0;Hh=Me,Me=Me+64|0,Un=Hh+56|0,sa=Hh+40|0,ea=Hh,jn=Hh+48|0,Vi=Hh+60|0,r[Un>>2]=n,Xr=(t|0)!=0,Gt=ea+40|0,gi=Gt,ea=ea+39|0,yi=jn+4|0,ne=0,n=0,Le=0;e:for(;;){do{do if((n|0)>-1)if((ne|0)>(2147483647-n|0)){r[(Ko()|0)>>2]=61,n=-1;break}else{n=ne+n|0;break}while(0);if(Ot=r[Un>>2]|0,ne=ie[Ot>>0]|0,!(ne<<24>>24)){sr=92;break e}ge=Ot;t:for(;;){switch(ne<<24>>24){case 37:{sr=10;break t}case 0:{ne=ge;break t}default:}Ar=ge+1|0,r[Un>>2]=Ar,ne=ie[Ar>>0]|0,ge=Ar}t:do if((sr|0)==10){sr=0,ne=ge;do{if((ie[ge+1>>0]|0)!=37)break t;ne=ne+1|0,ge=ge+2|0,r[Un>>2]=ge}while((ie[ge>>0]|0)==37)}while(0);ne=ne-Ot|0,Xr&&i(t,Ot,ne)}while((ne|0)!=0);if(Ar=(Uh(ie[(r[Un>>2]|0)+1>>0]|0)|0)==0,ge=r[Un>>2]|0,!Ar&&(ie[ge+2>>0]|0)==36?(Lt=(ie[ge+1>>0]|0)+-48|0,st=1,ne=3):(Lt=-1,st=Le,ne=1),ne=ge+ne|0,r[Un>>2]=ne,ge=ie[ne>>0]|0,Le=(ge<<24>>24)+-32|0,Le>>>0>31|(1<<Le&75913|0)==0)Qe=0;else{Qe=0;do Qe=1<<Le|Qe,ne=ne+1|0,r[Un>>2]=ne,ge=ie[ne>>0]|0,Le=(ge<<24>>24)+-32|0;while(!(Le>>>0>31|(1<<Le&75913|0)==0))}if(ge<<24>>24==42){if((Uh(ie[ne+1>>0]|0)|0)!=0&&(Cu=r[Un>>2]|0,(ie[Cu+2>>0]|0)==36))ne=Cu+1|0,r[m+((ie[ne>>0]|0)+-48<<2)>>2]=10,ne=r[c+((ie[ne>>0]|0)+-48<<3)>>2]|0,Le=1,ge=Cu+3|0;else{if(st|0){n=-1;break}Xr?(Ar=(r[s>>2]|0)+(4-1)&~(4-1),ne=r[Ar>>2]|0,r[s>>2]=Ar+4):ne=0,Le=0,ge=(r[Un>>2]|0)+1|0}r[Un>>2]=ge,Ar=(ne|0)<0,Mn=Ar?0-ne|0:ne,Qe=Ar?Qe|8192:Qe,Ar=Le}else{if(ne=o(Un)|0,(ne|0)<0){n=-1;break}Mn=ne,Ar=st,ge=r[Un>>2]|0}do if((ie[ge>>0]|0)==46){if(ne=ge+1|0,(ie[ne>>0]|0)!=42){r[Un>>2]=ne,ne=o(Un)|0,ge=r[Un>>2]|0;break}if(Uh(ie[ge+2>>0]|0)|0&&(Pn=r[Un>>2]|0,(ie[Pn+3>>0]|0)==36)){ne=Pn+2|0,r[m+((ie[ne>>0]|0)+-48<<2)>>2]=10,ne=r[c+((ie[ne>>0]|0)+-48<<3)>>2]|0,ge=Pn+4|0,r[Un>>2]=ge;break}if(Ar|0){n=-1;break e}Xr?(Bt=(r[s>>2]|0)+(4-1)&~(4-1),ne=r[Bt>>2]|0,r[s>>2]=Bt+4):ne=0,ge=(r[Un>>2]|0)+2|0,r[Un>>2]=ge}else ne=-1;while(0);for(Bt=0;;){if(((ie[ge>>0]|0)+-65|0)>>>0>57){n=-1;break e}if(Le=ge,ge=ge+1|0,r[Un>>2]=ge,Le=ie[(ie[Le>>0]|0)+-65+(176+(Bt*58|0))>>0]|0,st=Le&255,(st+-1|0)>>>0>=8)break;Bt=st}if(!(Le<<24>>24)){n=-1;break}gt=(Lt|0)>-1;do if(Le<<24>>24==19)if(gt){n=-1;break e}else sr=54;else{if(gt){r[m+(Lt<<2)>>2]=st,gt=c+(Lt<<3)|0,Lt=r[gt+4>>2]|0,sr=sa,r[sr>>2]=r[gt>>2],r[sr+4>>2]=Lt,sr=54;break}if(!Xr){n=0;break e}l(sa,st,s,$),ge=r[Un>>2]|0,sr=55}while(0);(sr|0)==54&&(sr=0,Xr?sr=55:ne=0);t:do if((sr|0)==55){sr=0,ge=ie[ge+-1>>0]|0,ge=(Bt|0)!=0&(ge&15|0)==3?ge&-33:ge,Le=Qe&-65537,Lt=(Qe&8192|0)==0?Qe:Le;r:do switch(ge|0){case 110:switch((Bt&255)<<24>>24){case 0:{r[r[sa>>2]>>2]=n,ne=0;break t}case 1:{r[r[sa>>2]>>2]=n,ne=0;break t}case 2:{ne=r[sa>>2]|0,r[ne>>2]=n,r[ne+4>>2]=((n|0)<0)<<31>>31,ne=0;break t}case 3:{zt[r[sa>>2]>>1]=n,ne=0;break t}case 4:{ie[r[sa>>2]>>0]=n,ne=0;break t}case 6:{r[r[sa>>2]>>2]=n,ne=0;break t}case 7:{ne=r[sa>>2]|0,r[ne>>2]=n,r[ne+4>>2]=((n|0)<0)<<31>>31,ne=0;break t}default:{ne=0;break t}}case 112:{ge=120,ne=ne>>>0>8?ne:8,Le=Lt|8,sr=67;break}case 88:case 120:{Le=Lt,sr=67;break}case 111:{gt=sa,gt=w(r[gt>>2]|0,r[gt+4>>2]|0,Gt)|0,Le=gi-gt|0,Qe=0,st=20230,ne=(Lt&8|0)==0|(ne|0)>(Le|0)?ne:Le+1|0,Le=Lt,sr=73;break}case 105:case 100:if(Le=sa,ge=r[Le>>2]|0,Le=r[Le+4>>2]|0,(Le|0)<0){ge=y0(0,0,ge|0,Le|0)|0,Le=ei()|0,Qe=sa,r[Qe>>2]=ge,r[Qe+4>>2]=Le,Qe=1,st=20230,sr=72;break r}else{Qe=(Lt&2049|0)!=0&1,st=(Lt&2048|0)==0?(Lt&1|0)==0?20230:20232:20231,sr=72;break r}case 117:{Le=sa,Qe=0,st=20230,ge=r[Le>>2]|0,Le=r[Le+4>>2]|0,sr=72;break}case 99:{ie[ea>>0]=r[sa>>2],Ot=ea,Qe=0,st=20230,gt=1,ge=Le,ne=gi;break}case 115:{Bt=r[sa>>2]|0,Bt=(Bt|0)==0?20240:Bt,Lt=cx(Bt,0,ne)|0,iu=(Lt|0)==0,Ot=Bt,Qe=0,st=20230,gt=iu?ne:Lt-Bt|0,ge=Le,ne=iu?Bt+ne|0:Lt;break}case 67:{r[jn>>2]=r[sa>>2],r[yi>>2]=0,r[sa>>2]=jn,st=-1,sr=79;break}case 83:{ne?(st=ne,sr=79):(J(t,32,Mn,0,Lt),ne=0,sr=89);break}case 65:case 71:case 70:case 69:case 97:case 103:case 102:case 101:{ne=Ob[z&1](t,+xr[sa>>3],Mn,ne,Lt,ge)|0;break t}default:Qe=0,st=20230,gt=ne,ge=Lt,ne=gi}while(0);r:do if((sr|0)==67)gt=sa,gt=d(r[gt>>2]|0,r[gt+4>>2]|0,Gt,ge&32)|0,st=sa,st=(Le&8|0)==0|(r[st>>2]|0)==0&(r[st+4>>2]|0)==0,Qe=st?0:2,st=st?20230:20230+(ge>>>4)|0,sr=73;else if((sr|0)==72)gt=I(ge,Le,Gt)|0,Le=Lt,sr=73;else if((sr|0)==79){for(sr=0,Qe=r[sa>>2]|0,ne=0;ge=r[Qe>>2]|0,!!ge;){if(ge=ee(Vi,ge)|0,Le=(ge|0)<0,Le|ge>>>0>(st-ne|0)>>>0){sr=83;break}if(ne=ge+ne|0,st>>>0>ne>>>0)Qe=Qe+4|0;else break}if((sr|0)==83&&(sr=0,Le)){n=-1;break e}if(J(t,32,Mn,ne,Lt),!ne)ne=0,sr=89;else for(Le=r[sa>>2]|0,Qe=0;;){if(ge=r[Le>>2]|0,!ge){sr=89;break r}if(ge=ee(Vi,ge)|0,Qe=ge+Qe|0,(Qe|0)>(ne|0)){sr=89;break r}if(i(t,Vi,ge),Qe>>>0>=ne>>>0){sr=89;break}else Le=Le+4|0}}while(0);if((sr|0)==73)sr=0,ge=sa,ge=(r[ge>>2]|0)!=0|(r[ge+4>>2]|0)!=0,iu=(ne|0)!=0|ge,ge=gi-gt+((ge^1)&1)|0,Ot=iu?gt:Gt,gt=iu?(ne|0)>(ge|0)?ne:ge:0,ge=(ne|0)>-1?Le&-65537:Le,ne=gi;else if((sr|0)==89){sr=0,J(t,32,Mn,ne,Lt^8192),ne=(Mn|0)>(ne|0)?Mn:ne;break}Lt=ne-Ot|0,Bt=(gt|0)<(Lt|0)?Lt:gt,iu=Bt+Qe|0,ne=(Mn|0)<(iu|0)?iu:Mn,J(t,32,ne,iu,ge),i(t,st,Qe),J(t,48,ne,iu,ge^65536),J(t,48,Bt,Lt,0),i(t,Ot,Lt),J(t,32,ne,iu,ge^8192)}while(0);Le=Ar}e:do if((sr|0)==92&&!t)if(!Le)n=0;else{for(n=1;ne=r[m+(n<<2)>>2]|0,!!ne;)if(l(c+(n<<3)|0,ne,s,$),n=n+1|0,n>>>0>=10){n=1;break e}for(;;){if(r[m+(n<<2)>>2]|0){n=-1;break e}if(n=n+1|0,n>>>0>=10){n=1;break}}}while(0);return Me=Hh,n|0}function i(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]&32||ox(n,s,t)|0}function o(t){t=t|0;var n=0,s=0;if(!(Uh(ie[r[t>>2]>>0]|0)|0))n=0;else{n=0;do s=r[t>>2]|0,n=(n*10|0)+-48+(ie[s>>0]|0)|0,s=s+1|0,r[t>>2]=s;while((Uh(ie[s>>0]|0)|0)!=0)}return n|0}function l(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;e:do if(n>>>0<=20)do switch(n|0){case 9:{n=(r[s>>2]|0)+(4-1)&~(4-1),c=r[n>>2]|0,r[s>>2]=n+4,r[t>>2]=c;break e}case 10:{c=(r[s>>2]|0)+(4-1)&~(4-1),n=r[c>>2]|0,r[s>>2]=c+4,c=t,r[c>>2]=n,r[c+4>>2]=((n|0)<0)<<31>>31;break e}case 11:{c=(r[s>>2]|0)+(4-1)&~(4-1),n=r[c>>2]|0,r[s>>2]=c+4,c=t,r[c>>2]=n,r[c+4>>2]=0;break e}case 12:{c=(r[s>>2]|0)+(8-1)&~(8-1),n=c,m=r[n>>2]|0,n=r[n+4>>2]|0,r[s>>2]=c+8,c=t,r[c>>2]=m,r[c+4>>2]=n;break e}case 13:{m=(r[s>>2]|0)+(4-1)&~(4-1),c=r[m>>2]|0,r[s>>2]=m+4,c=(c&65535)<<16>>16,m=t,r[m>>2]=c,r[m+4>>2]=((c|0)<0)<<31>>31;break e}case 14:{m=(r[s>>2]|0)+(4-1)&~(4-1),c=r[m>>2]|0,r[s>>2]=m+4,m=t,r[m>>2]=c&65535,r[m+4>>2]=0;break e}case 15:{m=(r[s>>2]|0)+(4-1)&~(4-1),c=r[m>>2]|0,r[s>>2]=m+4,c=(c&255)<<24>>24,m=t,r[m>>2]=c,r[m+4>>2]=((c|0)<0)<<31>>31;break e}case 16:{m=(r[s>>2]|0)+(4-1)&~(4-1),c=r[m>>2]|0,r[s>>2]=m+4,m=t,r[m>>2]=c&255,r[m+4>>2]=0;break e}case 17:{m=(r[s>>2]|0)+(8-1)&~(8-1),z=+xr[m>>3],r[s>>2]=m+8,xr[t>>3]=z;break e}case 18:{Lf[c&15](t,s);break e}default:break e}while(0);while(0)}function d(t,n,s,c){if(t=t|0,n=n|0,s=s|0,c=c|0,!((t|0)==0&(n|0)==0))do s=s+-1|0,ie[s>>0]=We[640+(t&15)>>0]|0|c,t=Py(t|0,n|0,4)|0,n=ei()|0;while(!((t|0)==0&(n|0)==0));return s|0}function w(t,n,s){if(t=t|0,n=n|0,s=s|0,!((t|0)==0&(n|0)==0))do s=s+-1|0,ie[s>>0]=t&7|48,t=Py(t|0,n|0,3)|0,n=ei()|0;while(!((t|0)==0&(n|0)==0));return s|0}function I(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;if(n>>>0>0|(n|0)==0&t>>>0>4294967295){do c=t,t=yx(t|0,n|0,10,0)|0,m=n,n=ei()|0,z=gx(t|0,n|0,10,0)|0,z=y0(c|0,m|0,z|0,ei()|0)|0,ei()|0,s=s+-1|0,ie[s>>0]=z&255|48;while(m>>>0>9|(m|0)==9&c>>>0>4294967295);n=t}else n=t;if(n)do z=n,n=(n>>>0)/10|0,s=s+-1|0,ie[s>>0]=z-(n*10|0)|48;while(z>>>0>=10);return s|0}function J(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0,$=0;if($=Me,Me=Me+256|0,z=$,(s|0)>(c|0)&(m&73728|0)==0){if(m=s-c|0,Vh(z|0,n<<24>>24|0,(m>>>0<256?m:256)|0)|0,m>>>0>255){n=s-c|0;do i(t,z,256),m=m+-256|0;while(m>>>0>255);m=n&255}i(t,z,m)}Me=$}function ee(t,n){return t=t|0,n=n|0,t?t=he(t,n,0)|0:t=0,t|0}function he(t,n,s){t=t|0,n=n|0,s=s|0;do if(t){if(n>>>0<128){ie[t>>0]=n,t=1;break}if(!(r[r[(fe()|0)+176>>2]>>2]|0))if((n&-128|0)==57216){ie[t>>0]=n,t=1;break}else{r[(Ko()|0)>>2]=25,t=-1;break}if(n>>>0<2048){ie[t>>0]=n>>>6|192,ie[t+1>>0]=n&63|128,t=2;break}if(n>>>0<55296|(n&-8192|0)==57344){ie[t>>0]=n>>>12|224,ie[t+1>>0]=n>>>6&63|128,ie[t+2>>0]=n&63|128,t=3;break}if((n+-65536|0)>>>0<1048576){ie[t>>0]=n>>>18|240,ie[t+1>>0]=n>>>12&63|128,ie[t+2>>0]=n>>>6&63|128,ie[t+3>>0]=n&63|128,t=4;break}else{r[(Ko()|0)>>2]=25,t=-1;break}}else t=1;while(0);return t|0}function fe(){return My()|0}function de(t){t=+t;var n=0;return xr[Nt>>3]=t,n=r[Nt>>2]|0,Cn(r[Nt+4>>2]|0),n|0}function ve(t,n){t=+t,n=n|0;var s=0,c=0,m=0;switch(xr[Nt>>3]=t,s=r[Nt>>2]|0,c=r[Nt+4>>2]|0,m=Py(s|0,c|0,52)|0,ei()|0,m&2047){case 0:{t!=0?(t=+ve(t*18446744073709552e3,n),s=(r[n>>2]|0)+-64|0):s=0,r[n>>2]=s;break}case 2047:break;default:r[n>>2]=(m&2047)+-1022,r[Nt>>2]=s,r[Nt+4>>2]=c&-2146435073|1071644672,t=+xr[Nt>>3]}return+t}function Ce(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;e:do if(!s)t=0;else{for(;c=ie[t>>0]|0,m=ie[n>>0]|0,c<<24>>24==m<<24>>24;)if(s=s+-1|0,s)t=t+1|0,n=n+1|0;else{t=0;break e}t=(c&255)-(m&255)|0}while(0);return t|0}function Ne(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;return m=Me,Me=Me+16|0,z=m,r[z>>2]=c,c=Ke(t,n,s,z)|0,Me=m,c|0}function Ke(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0,$=0,ne=0;return ne=Me,Me=Me+160|0,m=ne+144|0,$=ne,wo($|0,3672,144)|0,(n+-1|0)>>>0>2147483646?n?(r[(Ko()|0)>>2]=61,n=-1):(t=m,n=1,z=4):z=4,(z|0)==4&&(z=-2-t|0,z=n>>>0>z>>>0?z:n,r[$+48>>2]=z,m=$+20|0,r[m>>2]=t,r[$+44>>2]=t,n=t+z|0,t=$+16|0,r[t>>2]=n,r[$+28>>2]=n,n=fx($,s,c)|0,z&&($=r[m>>2]|0,ie[$+((($|0)==(r[t>>2]|0))<<31>>31)>>0]=0)),Me=ne,n|0}function Oe(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;return c=t+20|0,m=r[c>>2]|0,t=(r[t+16>>2]|0)-m|0,t=t>>>0>s>>>0?s:t,wo(m|0,n|0,t|0)|0,r[c>>2]=(r[c>>2]|0)+t,s|0}function xe(t){t=t|0;var n=0,s=0;return n=(m0(t)|0)+1|0,s=Cy(n)|0,s?t=wo(s|0,t|0,n|0)|0:t=0,t|0}function ut(t,n){t=t|0,n=n|0;var s=0,c=0;for(s=0;;){if((We[656+s>>0]|0)==(t|0)){c=4;break}if(s=s+1|0,(s|0)==87){t=87,c=5;break}}if((c|0)==4&&(s?(t=s,c=5):s=752),(c|0)==5){s=752;do{do c=s,s=s+1|0;while((ie[c>>0]|0)!=0);t=t+-1|0}while((t|0)!=0)}return rt(s,r[n+20>>2]|0)|0}function rt(t,n){return t=t|0,n=n|0,ux(t,n)|0}function ft(t){return t=t|0,ut(t,r[(Mt()|0)+176>>2]|0)|0}function Mt(){return My()|0}function Rt(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;return c=ft(t)|0,t=m0(c)|0,t>>>0>=s>>>0?(t=s+-1|0,s&&(wo(n|0,c|0,t|0)|0,ie[n+t>>0]=0),t=68):(wo(n|0,c|0,t+1|0)|0,t=0),t|0}function kt(){var t=0,n=0,s=0,c=0,m=0,z=0,$=0;c=Me,Me=Me+48|0,z=c+32|0,n=c+24|0,$=c+16|0,m=c,c=c+36|0,t=nr()|0,t|0&&(s=r[t>>2]|0,s|0)&&(t=s+48|0,Xt(t)|0||(r[n>>2]=20420,Pt(20370,n)),n=it(t)|0,(n|0)==1126902529&(ei()|0)==1129074247?t=r[s+44>>2]|0:t=s+80|0,r[c>>2]=t,s=r[s>>2]|0,t=r[s+4>>2]|0,_0[r[(r[954]|0)+16>>2]&7](3816,s,c)|0?($=r[c>>2]|0,$=Ly[r[(r[$>>2]|0)+8>>2]&15]($)|0,r[m>>2]=20420,r[m+4>>2]=t,r[m+8>>2]=$,Pt(20284,m)):(r[$>>2]=20420,r[$+4>>2]=t,Pt(20329,$))),Pt(20408,z)}function nr(){return 21640}function Xt(t){return t=t|0,t=it(t)|0,(t&-256|0)==1126902528&(ei()|0)==1129074247|0}function it(t){t=t|0;var n=0;return n=t,t=r[n>>2]|0,Cn(r[n+4>>2]|0),t|0}function Pt(t,n){t=t|0,n=n|0,Cl()}function Vt(t){t=t|0}function Zt(t){t=t|0,Vt(t),rr(t)}function Jt(t){t=t|0}function jt(t){t=t|0}function ir(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0;if(ge=Me,Me=Me+64|0,$=ge,tr(t,n,0)|0)t=1;else if((n|0)!=0&&(ne=Ft(n,3840,3824,0)|0,(ne|0)!=0)){r[$>>2]=ne,r[$+4>>2]=0,r[$+8>>2]=t,r[$+12>>2]=-1,t=$+16|0,n=$+24|0,c=$+48|0,m=t,z=m+36|0;do r[m>>2]=0,m=m+4|0;while((m|0)<(z|0));zt[t+36>>1]=0,ie[t+38>>0]=0,r[c>>2]=1,Nm[r[(r[ne>>2]|0)+28>>2]&7](ne,$,r[s>>2]|0,1),(r[n>>2]|0)==1?(r[s>>2]=r[t>>2],t=1):t=0}else t=0;return Me=ge,t|0}function Sr(t,n,s,c,m,z){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0,tr(t,r[n+8>>2]|0,z)|0&&vn(0,n,s,c,m)}function Hr(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0;do if(tr(t,r[n+8>>2]|0,m)|0)nn(0,n,s,c);else if(tr(t,r[n>>2]|0,m)|0){if((r[n+16>>2]|0)!=(s|0)&&(z=n+20|0,(r[z>>2]|0)!=(s|0))){r[n+32>>2]=c,r[z>>2]=s,m=n+40|0,r[m>>2]=(r[m>>2]|0)+1,(r[n+36>>2]|0)==1&&(r[n+24>>2]|0)==2&&(ie[n+54>>0]=1),r[n+44>>2]=4;break}(c|0)==1&&(r[n+32>>2]=1)}while(0)}function or(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0,tr(t,r[n+8>>2]|0,0)|0&&Br(0,n,s,c)}function tr(t,n,s){return t=t|0,n=n|0,s=s|0,s?(t|0)==(n|0)?t=1:t=(by(r[t+4>>2]|0,r[n+4>>2]|0)|0)==0:t=(r[t+4>>2]|0)==(r[n+4>>2]|0),t|0}function Br(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;t=n+16|0,m=r[t>>2]|0;do if(m){if((m|0)!=(s|0)){c=n+36|0,r[c>>2]=(r[c>>2]|0)+1,r[n+24>>2]=2,ie[n+54>>0]=1;break}t=n+24|0,(r[t>>2]|0)==2&&(r[t>>2]=c)}else r[t>>2]=s,r[n+24>>2]=c,r[n+36>>2]=1;while(0)}function nn(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0;(r[n+4>>2]|0)==(s|0)&&(m=n+28|0,(r[m>>2]|0)!=1)&&(r[m>>2]=c)}function vn(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,ie[n+53>>0]=1;do if((r[n+4>>2]|0)==(c|0)){if(ie[n+52>>0]=1,t=n+16|0,c=r[t>>2]|0,!c){if(r[t>>2]=s,r[n+24>>2]=m,r[n+36>>2]=1,!((m|0)==1&&(r[n+48>>2]|0)==1))break;ie[n+54>>0]=1;break}if((c|0)!=(s|0)){m=n+36|0,r[m>>2]=(r[m>>2]|0)+1,ie[n+54>>0]=1;break}c=n+24|0,t=r[c>>2]|0,(t|0)==2&&(r[c>>2]=m,t=m),(t|0)==1&&(r[n+48>>2]|0)==1&&(ie[n+54>>0]=1)}while(0)}function Ft(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0;gt=Me,Me=Me+64|0,Qe=gt,Le=r[t>>2]|0,st=t+(r[Le+-8>>2]|0)|0,Le=r[Le+-4>>2]|0,r[Qe>>2]=s,r[Qe+4>>2]=t,r[Qe+8>>2]=n,r[Qe+12>>2]=c,t=Qe+16|0,n=Qe+20|0,c=Qe+24|0,m=Qe+28|0,z=Qe+32|0,$=Qe+40|0,ne=t,ge=ne+36|0;do r[ne>>2]=0,ne=ne+4|0;while((ne|0)<(ge|0));zt[t+36>>1]=0,ie[t+38>>0]=0;e:do if(tr(Le,s,0)|0)r[Qe+48>>2]=1,Bm[r[(r[Le>>2]|0)+20>>2]&3](Le,Qe,st,st,1,0),t=(r[c>>2]|0)==1?st:0;else{switch(Oy[r[(r[Le>>2]|0)+24>>2]&3](Le,Qe,st,1,0),r[Qe+36>>2]|0){case 0:{t=(r[$>>2]|0)==1&(r[m>>2]|0)==1&(r[z>>2]|0)==1?r[n>>2]|0:0;break e}case 1:break;default:{t=0;break e}}if((r[c>>2]|0)!=1&&!((r[$>>2]|0)==0&(r[m>>2]|0)==1&(r[z>>2]|0)==1)){t=0;break}t=r[t>>2]|0}while(0);return Me=gt,t|0}function mi(t){t=t|0,Vt(t),rr(t)}function gn(t,n,s,c,m,z){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0,tr(t,r[n+8>>2]|0,z)|0?vn(0,n,s,c,m):(t=r[t+8>>2]|0,Bm[r[(r[t>>2]|0)+20>>2]&3](t,n,s,c,m,z))}function Dn(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0,$=0,ne=0;e:do if(tr(t,r[n+8>>2]|0,m)|0)nn(0,n,s,c);else{if(!(tr(t,r[n>>2]|0,m)|0)){$=r[t+8>>2]|0,Oy[r[(r[$>>2]|0)+24>>2]&3]($,n,s,c,m);break}if((r[n+16>>2]|0)!=(s|0)&&($=n+20|0,(r[$>>2]|0)!=(s|0))){r[n+32>>2]=c,c=n+44|0;do if((r[c>>2]|0)!=4)if(z=n+52|0,ie[z>>0]=0,ne=n+53|0,ie[ne>>0]=0,t=r[t+8>>2]|0,Bm[r[(r[t>>2]|0)+20>>2]&3](t,n,s,s,1,m),ie[ne>>0]|0){if(ne=(ie[z>>0]|0)==0,r[c>>2]=3,ne)break;break e}else{r[c>>2]=4;break}while(0);if(r[$>>2]=s,ne=n+40|0,r[ne>>2]=(r[ne>>2]|0)+1,(r[n+36>>2]|0)!=1||(r[n+24>>2]|0)!=2)break;ie[n+54>>0]=1;break}(c|0)==1&&(r[n+32>>2]=1)}while(0)}function Kr(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0,tr(t,r[n+8>>2]|0,0)|0?Br(0,n,s,c):(t=r[t+8>>2]|0,Nm[r[(r[t>>2]|0)+28>>2]&7](t,n,s,c))}function rr(t){t=t|0,vx(t)}function Bn(t){t=t|0}function pr(){var t=0,n=0;t=nr()|0,t|0&&(n=r[t>>2]|0,n|0)&&Xt(n+48|0)|0&&Fr(r[n+12>>2]|0),Fr(Cr()|0)}function Fr(t){t=t|0;var n=0;n=Me,Me=Me+16|0,wx[t&3](),Pt(20559,n)}function Cr(){return 2}function en(t){t=t|0}function Zr(t){t=t|0,rr(t)}function On(t){return t=t|0,20599}function Sn(t){t=t|0,r[t>>2]=5916,Et(t+4|0)}function li(t){t=t|0,Sn(t),rr(t)}function Ui(t){return t=t|0,Ci(t+4|0)|0}function Ci(t){return t=t|0,r[t>>2]|0}function Et(t){t=t|0;var n=0,s=0;mt(t)|0&&(n=lr(r[t>>2]|0)|0,s=n+8|0,t=r[s>>2]|0,r[s>>2]=t+-1,(t|0)<1)&&rr(n)}function mt(t){return t=t|0,1}function lr(t){return t=t|0,t+-12|0}function Rr(t){t=t|0,r[t>>2]=5936,Et(t+4|0)}function hn(t){t=t|0,Rr(t),rr(t)}function ur(t){return t=t|0,Ci(t+4|0)|0}function wn(t){t=t|0,Sn(t),rr(t)}function yn(t){t=t|0,Sn(t),rr(t)}function qr(){var t=0;t=Me,Me=Me+16|0,Pt(20848,t)}function Vr(t){t=t|0,Vt(t),rr(t)}function Vn(t,n,s){return t=t|0,n=n|0,s=s|0,tr(t,n,0)|0}function It(t){t=t|0,Vt(t),rr(t)}function sn(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0;Qe=Me,Me=Me+64|0,ge=Qe;do if(tr(n,4048,0)|0)r[s>>2]=0,n=1;else{if(Jr(t,n,0)|0){if(n=r[s>>2]|0,!n){n=1;break}r[s>>2]=r[n>>2],n=1;break}if((n|0)!=0&&(c=Ft(n,3840,3976,0)|0,(c|0)!=0))if(n=r[s>>2]|0,n|0&&(r[s>>2]=r[n>>2]),n=r[c+8>>2]|0,z=t+8|0,m=r[z>>2]|0,(n&7&(m^7)|0)==0&&((n&96^96)&m|0)==0)if(m=t+12|0,t=r[m>>2]|0,c=c+12|0,n=r[c>>2]|0,tr(t,n,0)|0)n=1;else{if(tr(t,4040,0)|0){if(!n){n=1;break}n=(Ft(n,3840,3992,0)|0)==0;break}if(t){if(n=Ft(t,3840,3976,0)|0,n|0){if(!(r[z>>2]&1)){n=0;break}n=Fn(n,r[c>>2]|0)|0;break}if(n=r[m>>2]|0,n){if(n=Ft(n,3840,4008,0)|0,n|0){if(!(r[z>>2]&1)){n=0;break}n=mr(n,r[c>>2]|0)|0;break}if(n=r[m>>2]|0,(n|0)!=0&&($=Ft(n,3840,3824,0)|0,($|0)!=0)&&(ne=r[c>>2]|0,(ne|0)!=0)&&(Le=Ft(ne,3840,3824,0)|0,(Le|0)!=0)){r[ge>>2]=Le,r[ge+4>>2]=0,r[ge+8>>2]=$,r[ge+12>>2]=-1,n=ge+16|0,t=ge+24|0,c=ge+48|0,m=n,z=m+36|0;do r[m>>2]=0,m=m+4|0;while((m|0)<(z|0));zt[n+36>>1]=0,ie[n+38>>0]=0,r[c>>2]=1,Nm[r[(r[Le>>2]|0)+28>>2]&7](Le,ge,r[s>>2]|0,1);do if((r[t>>2]|0)==1){if(!(r[s>>2]|0)){n=1;break}r[s>>2]=r[n>>2],n=1}else n=0;while(0)}else n=0}else n=0}else n=0}else n=0;else n=0}while(0);return Me=Qe,n|0}function Jr(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;return r[t+8>>2]&24?(s=1,m=5):(n|0)!=0&&(c=Ft(n,3840,3960,0)|0,(c|0)!=0)?(s=(r[c+8>>2]&24|0)!=0,m=5):s=0,(m|0)==5&&(s=tr(t,n,s)|0),s|0}function Fn(t,n){t=t|0,n=n|0;for(var s=0,c=0,m=0,z=0,$=0;;){if(!n){n=0;break}if(s=Ft(n,3840,3976,0)|0,!s){n=0;break}if(m=r[t+8>>2]|0,r[s+8>>2]&~m|0){n=0;break}if(c=t+12|0,n=r[c>>2]|0,s=s+12|0,tr(n,r[s>>2]|0,0)|0){n=1;break}if((m&1|0)==0|(n|0)==0){n=0;break}if(t=Ft(n,3840,3976,0)|0,!t){$=9;break}n=r[s>>2]|0}return($|0)==9&&(n=r[c>>2]|0,(n|0)!=0&&(z=Ft(n,3840,4008,0)|0,(z|0)!=0)?n=mr(z,r[s>>2]|0)|0:n=0),n|0}function mr(t,n){t=t|0,n=n|0;var s=0;return(n|0)!=0&&(s=Ft(n,3840,4008,0)|0,(s|0)!=0)&&(r[s+8>>2]&~r[t+8>>2]|0)==0&&tr(r[t+12>>2]|0,r[s+12>>2]|0,0)|0?t=tr(r[t+16>>2]|0,r[s+16>>2]|0,0)|0:t=0,t|0}function En(t){t=t|0,Vt(t),rr(t)}function si(t,n,s,c,m,z){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0;var $=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0;if(tr(t,r[n+8>>2]|0,z)|0)vn(0,n,s,c,m);else{Lt=n+52|0,ne=ie[Lt>>0]|0,Bt=n+53|0,$=ie[Bt>>0]|0,Ot=r[t+12>>2]|0,Qe=t+16+(Ot<<3)|0,ie[Lt>>0]=0,ie[Bt>>0]=0,Js(t+16|0,n,s,c,m,z),ge=ie[Lt>>0]|0,ne=ge|ne,Le=ie[Bt>>0]|0,$=Le|$;e:do if((Ot|0)>1){st=n+24|0,gt=t+8|0,Ot=n+54|0,t=t+24|0;do{if($=$&1,ne=ne&1,ie[Ot>>0]|0)break e;if(ge<<24>>24){if((r[st>>2]|0)==1||!(r[gt>>2]&2))break e}else if(Le<<24>>24&&(r[gt>>2]&1|0)==0)break e;ie[Lt>>0]=0,ie[Bt>>0]=0,Js(t,n,s,c,m,z),ge=ie[Lt>>0]|0,ne=ge|ne,Le=ie[Bt>>0]|0,$=Le|$,t=t+8|0}while(t>>>0<Qe>>>0)}while(0);ie[Lt>>0]=ne<<24>>24!=0&1,ie[Bt>>0]=$<<24>>24!=0&1}}function Qi(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0;e:do if(tr(t,r[n+8>>2]|0,m)|0)nn(0,n,s,c);else{if(!(tr(t,r[n>>2]|0,m)|0)){if(Ot=r[t+12>>2]|0,ge=t+16+(Ot<<3)|0,$s(t+16|0,n,s,c,m),z=t+24|0,(Ot|0)<=1)break;if(t=r[t+8>>2]|0,(t&2|0)==0&&(ne=n+36|0,(r[ne>>2]|0)!=1)){if(!(t&1)){for(t=n+54|0;;)if(ie[t>>0]|0||(r[ne>>2]|0)==1||($s(z,n,s,c,m),z=z+8|0,z>>>0>=ge>>>0))break e}for(t=n+24|0,$=n+54|0;;)if(ie[$>>0]|0||(r[ne>>2]|0)==1&&(r[t>>2]|0)==1||($s(z,n,s,c,m),z=z+8|0,z>>>0>=ge>>>0))break e}for(t=n+54|0;;)if(ie[t>>0]|0||($s(z,n,s,c,m),z=z+8|0,z>>>0>=ge>>>0))break e}if((r[n+16>>2]|0)!=(s|0)&&(Ot=n+20|0,(r[Ot>>2]|0)!=(s|0))){if(r[n+32>>2]=c,gt=n+44|0,(r[gt>>2]|0)!=4){ne=t+16+(r[t+12>>2]<<3)|0,ge=n+52|0,c=n+53|0,Le=n+54|0,Qe=t+8|0,st=n+24|0,z=0,$=t+16|0,t=0;t:for(;;){if($>>>0>=ne>>>0){$=18;break}if(ie[ge>>0]=0,ie[c>>0]=0,Js($,n,s,s,1,m),ie[Le>>0]|0){$=18;break}do if(ie[c>>0]|0){if(!(ie[ge>>0]|0))if(r[Qe>>2]&1){t=1;break}else{$=19;break t}if((r[st>>2]|0)==1){z=1,$=19;break t}if(r[Qe>>2]&2)z=1,t=1;else{z=1,$=19;break t}}while(0);$=$+8|0}if(($|0)==18&&(t?$=19:t=4),($|0)==19&&(t=3),r[gt>>2]=t,z&1)break}if(r[Ot>>2]=s,s=n+40|0,r[s>>2]=(r[s>>2]|0)+1,(r[n+36>>2]|0)!=1||(r[n+24>>2]|0)!=2)break;ie[n+54>>0]=1;break}(c|0)==1&&(r[n+32>>2]=1)}while(0)}function Ds(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;e:do if(tr(t,r[n+8>>2]|0,0)|0)Br(0,n,s,c);else if(z=r[t+12>>2]|0,m=t+16+(z<<3)|0,Ki(t+16|0,n,s,c),(z|0)>1){z=n+54|0,t=t+24|0;do{if(Ki(t,n,s,c),ie[z>>0]|0)break e;t=t+8|0}while(t>>>0<m>>>0)}while(0)}function Ki(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;z=r[t+4>>2]|0,s?(m=z>>8,z&1&&(m=r[(r[s>>2]|0)+m>>2]|0)):m=0,t=r[t>>2]|0,Nm[r[(r[t>>2]|0)+28>>2]&7](t,n,s+m|0,(z&2|0)==0?2:c)}function Js(t,n,s,c,m,z){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0;var $=0,ne=0;ne=r[t+4>>2]|0,$=ne>>8,ne&1&&($=r[(r[c>>2]|0)+$>>2]|0),t=r[t>>2]|0,Bm[r[(r[t>>2]|0)+20>>2]&3](t,n,s,c+$|0,(ne&2|0)==0?2:m,z)}function $s(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0,$=0;$=r[t+4>>2]|0,z=$>>8,$&1&&(z=r[(r[s>>2]|0)+z>>2]|0),t=r[t>>2]|0,Oy[r[(r[t>>2]|0)+24>>2]&3](t,n,s+z|0,($&2|0)==0?2:c,m)}function v0(t){t=t|0,r[t>>2]=5896}function yc(t){t=t|0;var n=0,s=0;return n=Me,Me=Me+16|0,s=n,g0(s,t),t=Ey(s)|0,Me=n,t|0}function g0(t,n){t=t|0,n=n|0,qt(t,n)}function Ey(t){t=t|0;var n=0,s=0;return n=Me,Me=Me+16|0,s=n,Ty(s,r[t+4>>2]|0),(px(s)|0)<<24>>24?t=0:t=xt(Sy(t)|0)|0,Me=n,t|0}function Ty(t,n){t=t|0,n=n|0,r[t>>2]=n}function px(t){return t=t|0,ie[r[t>>2]>>0]|0}function Sy(t){return t=t|0,t|0}function xt(t){t=t|0;var n=0,s=0,c=0,m=0;m=Me,Me=Me+16|0,c=m,t=r[t+8>>2]|0,n=ie[t>>0]|0;do if(n<<24>>24!=1)if(n&2)Pt(20985,c);else{ie[t>>0]=2,s=1;break}else s=0;while(0);return Me=m,s|0}function qt(t,n){t=t|0,n=n|0,r[t>>2]=n,r[t+4>>2]=n,r[t+8>>2]=n+1,r[t+12>>2]=0}function Kt(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,g0(s,t),Qt(s),Me=n}function Qt(t){t=t|0;var n=0,s=0;n=Me,Me=Me+16|0,s=n,Ty(s,r[t+4>>2]|0),gr(s),zn(Sy(t)|0),Me=n}function gr(t){t=t|0,ie[r[t>>2]>>0]=1}function zn(t){t=t|0,ie[r[t+8>>2]>>0]=1}function Wn(){return 0}function cr(t){t=t|0;var n=0,s=0;for(s=(t|0)==0?1:t;;){if(n=Cy(s)|0,n|0){t=6;break}if(t=Wn()|0,!t){t=5;break}wx[t&3]()}if((t|0)==5)s=cn(4)|0,v0(s),oi(s|0,3880,121);else if((t|0)==6)return n|0;return 0}function Zn(t){return t=t|0,cr(t)|0}function bi(t){t=t|0,rr(t)}function ci(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;return m=Me,Me=Me+16|0,c=m,r[c>>2]=r[s>>2],t=_0[r[(r[t>>2]|0)+16>>2]&7](t,n,c)|0,t&&(r[s>>2]=r[c>>2]),Me=m,t&1|0}function hi(t){return t=t|0,t?t=(Ft(t,3840,3976,0)|0)!=0&1:t=0,t|0}function aa(t){return t=t|0,0}function _c(){return(Cf()|0)>0|0}function Cf(){return El()|0}function di(t){t=t|0}function eu(t){t=t|0,di(t),rr(t)}function Pa(t){return t=t|0,21039}function vi(t){t=t|0}function Qs(t){t=t|0;var n=0,s=0;n=t+8|0,(r[n>>2]|0)!=0&&(s=r[n>>2]|0,r[n>>2]=s+-1,(s|0)!=0)||Bi[r[(r[t>>2]|0)+16>>2]&255](t)}function tu(t){if(t=t|0,t=aa(t)|0,t)b3(t,21145);else return}function Su(t){t=t|0}function Wa(t,n){t=t|0,n=n|0;var s=0,c=0;c=m0(n)|0,s=cr(c+13|0)|0,r[s>>2]=c,r[s+4>>2]=c,r[s+8>>2]=0,s=zh(s)|0,wo(s|0,n|0,c+1|0)|0,r[t>>2]=s}function zh(t){return t=t|0,t+12|0}function La(t,n){t=t|0,n=n|0,r[t>>2]=5916,Wa(t+4|0,n)}function e3(t,n){t=t|0,n=n|0,r[t>>2]=5936,Wa(t+4|0,(ie[n+11>>0]|0)<0?r[n>>2]|0:n)}function Ru(t,n){t=t|0,n=n|0,r[t>>2]=5936,Wa(t+4|0,n)}function mx(t){t=t|0,t=cn(8)|0,La(t,21163),r[t>>2]=5956,oi(t|0,3928,123)}function t3(t){t=t|0,t=cn(8)|0,La(t,21163),r[t>>2]=5976,oi(t|0,3944,123)}function Ry(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;m=Me,Me=Me+16|0,c=m,s>>>0>4294967279&&mx(t),s>>>0<11?ie[t+11>>0]=s:($=s+16&-16,z=cr($)|0,r[t>>2]=z,r[t+8>>2]=$|-2147483648,r[t+4>>2]=s,t=z),Fm(t,n,s)|0,ie[c>>0]=0,Fo(t+s|0,c),Me=m}function Fm(t,n,s){return t=t|0,n=n|0,s=s|0,s|0&&wo(t|0,n|0,s|0)|0,t|0}function Im(t){t=t|0,(ie[t+11>>0]|0)<0&&In(r[t>>2]|0,r[t+8>>2]&2147483647)}function r3(t,n,s,c,m,z,$,ne){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0,$=$|0,ne=ne|0;var ge=0,Le=0,Qe=0,st=0,gt=0;gt=Me,Me=Me+16|0,st=gt,(-18-n|0)>>>0<s>>>0&&mx(t),(ie[t+11>>0]|0)<0?Qe=r[t>>2]|0:Qe=t,n>>>0<2147483623?(ge=s+n|0,Le=n<<1,ge=ge>>>0<Le>>>0?Le:ge,ge=ge>>>0<11?11:ge+16&-16):ge=-17,Le=cr(ge)|0,m|0&&Fm(Le,Qe,m)|0,$|0&&Fm(Le+m|0,ne,$)|0,c=c-z|0,s=c-m|0,s|0&&Fm(Le+m+$|0,Qe+m+z|0,s)|0,s=n+1|0,(s|0)!=11&&In(Qe,s),r[t>>2]=Le,r[t+8>>2]=ge|-2147483648,$=c+$|0,r[t+4>>2]=$,ie[st>>0]=0,Fo(Le+$|0,st),Me=gt}function Ab(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0,ne=0,ge=0;return ge=Me,Me=Me+16|0,$=ge,ne=t+11|0,c=ie[ne>>0]|0,z=c<<24>>24<0,z?(m=(r[t+8>>2]&2147483647)+-1|0,c=r[t+4>>2]|0):(m=10,c=c&255),(m-c|0)>>>0>=s>>>0?s|0&&(z?m=r[t>>2]|0:m=t,Fm(m+c|0,n,s)|0,c=c+s|0,(ie[ne>>0]|0)<0?r[t+4>>2]=c:ie[ne>>0]=c,ie[$>>0]=0,Fo(m+c|0,$)):r3(t,m,c+s-m|0,c,c,0,s,n),Me=ge,t|0}function n3(t,n){return t=t|0,n=n|0,Ab(t,n,fo(n)|0)|0}function i3(t,n,s){return t=t|0,n=n|0,s=s|0,s?t=Ce(t,n,s)|0:t=0,t|0}function a3(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0,$=0;return z=ie[t+11>>0]|0,$=z<<24>>24<0,$?z=r[t+4>>2]|0:z=z&255,(m|0)==-1|z>>>0<n>>>0&&t3(t),z=z-n|0,s=z>>>0<s>>>0?z:s,$&&(t=r[t>>2]|0),z=s>>>0>m>>>0,t=i3(t+n|0,c,z?m:s)|0,t?t|0:(s>>>0<m>>>0?-1:z&1)|0}function s3(t){t=t|0}function o3(t){t=t|0,rr(t)}function u3(t){return t=t|0,21228}function l3(t,n,s){t=t|0,n=n|0,s=s|0,r[t>>2]=s,r[t+4>>2]=n}function c3(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0;return m=Me,Me=Me+16|0,c=m,Dm[r[(r[t>>2]|0)+12>>2]&15](c,t,n),(r[c+4>>2]|0)==(r[s+4>>2]|0)?t=(r[c>>2]|0)==(r[s>>2]|0):t=0,Me=m,t|0}function f3(t,n,s){return t=t|0,n=n|0,s=s|0,((r[n>>2]|0)==(s|0)?(r[n+4>>2]|0)==(t|0):0)|0}function h3(t,n,s){t=t|0,n=n|0,s=s|0,(s|0)>256?Ry(t,21176,fo(21176)|0):wb(t,0,s)}function wb(t,n,s){t=t|0,n=n|0,s=s|0,d3(t,s)}function d3(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0,$=0;$=Me,Me=Me+1040|0,m=$+1024|0,s=$,z=r[(Ko()|0)>>2]|0,c=p3(Rt(n,s,1024)|0,s)|0,ie[c>>0]|0?s=c:(r[m>>2]=n,Ne(s,1024,21211,m)|0),r[(Ko()|0)>>2]=z,Ry(t,s,fo(s)|0),Me=$}function p3(t,n){t=t|0,n=n|0;var s=0,c=0;switch(t|0){case 0:{s=n;break}case-1:{t=r[(Ko()|0)>>2]|0,c=3;break}default:c=3}return(c|0)==3&&((t|0)==28?s=22145:Fc()),s|0}function m3(t){t=t|0,rr(t)}function v3(t){return t=t|0,21353}function g3(t,n,s){t=t|0,n=n|0,s=s|0,(s|0)>256?(Mb()|0,n=6180):(_3()|0,n=6176),r[t>>2]=s,r[t+4>>2]=n}function y3(t,n,s){t=t|0,n=n|0,s=s|0,(s|0)>256?Ry(t,21319,fo(21319)|0):wb(t,0,s)}function Mb(){return(ie[21488]|0)==0&&yc(21488)|0&&Kt(21488),6180}function _3(){return(ie[21480]|0)==0&&yc(21480)|0&&Kt(21480),6176}function bb(t){t=t|0,Rr(t)}function x3(t){t=t|0,bb(t),rr(t)}function A3(t,n){t=t|0,n=n|0;var s=0;s=r[n+4>>2]|0,Dm[r[(r[s>>2]|0)+24>>2]&15](t,s,r[n>>2]|0)}function w3(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;for(z=Me,Me=Me+16|0,m=z,r[n>>2]|0&&(c=ie[s+11>>0]|0,c<<24>>24<0?c=r[s+4>>2]|0:c=c&255,c|0&&n3(s,21417)|0,A3(m,n),n=ie[m+11>>0]|0,c=n<<24>>24<0,Ab(s,c?r[m>>2]|0:m,c?r[m+4>>2]|0:n&255)|0,Im(m)),r[t>>2]=r[s>>2],r[t+4>>2]=r[s+4>>2],r[t+8>>2]=r[s+8>>2],c=0;(c|0)!=3;)r[s+(c<<2)>>2]=0,c=c+1|0;Me=z}function M3(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;c=Me,Me=Me+32|0,z=c+12|0,m=c,Ry(m,s,fo(s)|0),w3(z,n,m),e3(t,z),Im(z),Im(m),r[t>>2]=6192,m=n,n=r[m+4>>2]|0,s=t+8|0,r[s>>2]=r[m>>2],r[s+4>>2]=n,Me=c}function b3(t,n){t=t|0,n=n|0;var s=0,c=0,m=0;m=Me,Me=Me+16|0,c=m+8|0,s=cn(16)|0,Mb()|0,r[m>>2]=t,r[m+4>>2]=6180,r[c>>2]=r[m>>2],r[c+4>>2]=r[m+4>>2],M3(s,c,n),oi(s|0,4272,136)}function Ss(t){t=t|0,t=cn(8)|0,La(t,21420),r[t>>2]=5956,oi(t|0,3928,123)}function Cy(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0,Lt=0,Mn=0,Ar=0,sr=0,Xr=0,Gt=0,gi=0;gi=Me,Me=Me+16|0,gt=gi;do if(t>>>0<245){if(Le=t>>>0<11?16:t+11&-8,t=Le>>>3,st=r[5412]|0,s=st>>>t,s&3|0)return n=(s&1^1)+t|0,t=21688+(n<<1<<2)|0,s=t+8|0,c=r[s>>2]|0,m=c+8|0,z=r[m>>2]|0,(z|0)==(t|0)?r[5412]=st&~(1<<n):(r[z+12>>2]=t,r[s>>2]=z),Gt=n<<3,r[c+4>>2]=Gt|3,Gt=c+Gt+4|0,r[Gt>>2]=r[Gt>>2]|1,Gt=m,Me=gi,Gt|0;if(Qe=r[5414]|0,Le>>>0>Qe>>>0){if(s|0)return n=2<<t,n=s<<t&(n|0-n),n=(n&0-n)+-1|0,ne=n>>>12&16,n=n>>>ne,s=n>>>5&8,n=n>>>s,z=n>>>2&4,n=n>>>z,t=n>>>1&2,n=n>>>t,c=n>>>1&1,c=(s|ne|z|t|c)+(n>>>c)|0,n=21688+(c<<1<<2)|0,t=n+8|0,z=r[t>>2]|0,ne=z+8|0,s=r[ne>>2]|0,(s|0)==(n|0)?(t=st&~(1<<c),r[5412]=t):(r[s+12>>2]=n,r[t>>2]=s,t=st),Gt=c<<3,$=Gt-Le|0,r[z+4>>2]=Le|3,m=z+Le|0,r[m+4>>2]=$|1,r[z+Gt>>2]=$,Qe|0&&(c=r[5417]|0,n=Qe>>>3,s=21688+(n<<1<<2)|0,n=1<<n,t&n?(t=s+8|0,n=r[t>>2]|0):(r[5412]=t|n,n=s,t=s+8|0),r[t>>2]=c,r[n+12>>2]=c,r[c+8>>2]=n,r[c+12>>2]=s),r[5414]=$,r[5417]=m,Gt=ne,Me=gi,Gt|0;if(z=r[5413]|0,z){for(s=(z&0-z)+-1|0,m=s>>>12&16,s=s>>>m,c=s>>>5&8,s=s>>>c,$=s>>>2&4,s=s>>>$,ne=s>>>1&2,s=s>>>ne,ge=s>>>1&1,ge=r[21952+((c|m|$|ne|ge)+(s>>>ge)<<2)>>2]|0,s=ge,ne=ge,ge=(r[ge+4>>2]&-8)-Le|0;t=r[s+16>>2]|0,!(!t&&(t=r[s+20>>2]|0,!t));)$=(r[t+4>>2]&-8)-Le|0,m=$>>>0<ge>>>0,s=t,ne=m?t:ne,ge=m?$:ge;if($=ne+Le|0,$>>>0>ne>>>0){m=r[ne+24>>2]|0,n=r[ne+12>>2]|0;do if((n|0)==(ne|0)){if(t=ne+20|0,n=r[t>>2]|0,!n&&(t=ne+16|0,n=r[t>>2]|0,!n)){s=0;break}for(;;)if(c=n+20|0,s=r[c>>2]|0,s)n=s,t=c;else if(c=n+16|0,s=r[c>>2]|0,s)n=s,t=c;else break;r[t>>2]=0,s=n}else s=r[ne+8>>2]|0,r[s+12>>2]=n,r[n+8>>2]=s,s=n;while(0);do if(m|0){if(n=r[ne+28>>2]|0,t=21952+(n<<2)|0,(ne|0)==(r[t>>2]|0)){if(r[t>>2]=s,!s){r[5413]=z&~(1<<n);break}}else if(Gt=m+16|0,r[((r[Gt>>2]|0)==(ne|0)?Gt:m+20|0)>>2]=s,!s)break;r[s+24>>2]=m,n=r[ne+16>>2]|0,n|0&&(r[s+16>>2]=n,r[n+24>>2]=s),n=r[ne+20>>2]|0,n|0&&(r[s+20>>2]=n,r[n+24>>2]=s)}while(0);return ge>>>0<16?(Gt=ge+Le|0,r[ne+4>>2]=Gt|3,Gt=ne+Gt+4|0,r[Gt>>2]=r[Gt>>2]|1):(r[ne+4>>2]=Le|3,r[$+4>>2]=ge|1,r[$+ge>>2]=ge,Qe|0&&(c=r[5417]|0,n=Qe>>>3,s=21688+(n<<1<<2)|0,n=1<<n,n&st?(t=s+8|0,n=r[t>>2]|0):(r[5412]=n|st,n=s,t=s+8|0),r[t>>2]=c,r[n+12>>2]=c,r[c+8>>2]=n,r[c+12>>2]=s),r[5414]=ge,r[5417]=$),Gt=ne+8|0,Me=gi,Gt|0}else st=Le}else st=Le}else st=Le}else if(t>>>0<=4294967231)if(t=t+11|0,Le=t&-8,c=r[5413]|0,c){m=0-Le|0,t=t>>>8,t?Le>>>0>16777215?ge=31:(st=(t+1048320|0)>>>16&8,Lt=t<<st,ne=(Lt+520192|0)>>>16&4,Lt=Lt<<ne,ge=(Lt+245760|0)>>>16&2,ge=14-(ne|st|ge)+(Lt<<ge>>>15)|0,ge=Le>>>(ge+7|0)&1|ge<<1):ge=0,s=r[21952+(ge<<2)>>2]|0;e:do if(!s)s=0,t=0,Lt=61;else for(t=0,ne=Le<<((ge|0)==31?0:25-(ge>>>1)|0),z=0;;){if($=(r[s+4>>2]&-8)-Le|0,$>>>0<m>>>0)if($)t=s,m=$;else{t=s,m=0,Lt=65;break e}if(Lt=r[s+20>>2]|0,s=r[s+16+(ne>>>31<<2)>>2]|0,z=(Lt|0)==0|(Lt|0)==(s|0)?z:Lt,s)ne=ne<<1;else{s=z,Lt=61;break}}while(0);if((Lt|0)==61){if((s|0)==0&(t|0)==0){if(t=2<<ge,t=(t|0-t)&c,!t){st=Le;break}st=(t&0-t)+-1|0,$=st>>>12&16,st=st>>>$,z=st>>>5&8,st=st>>>z,ne=st>>>2&4,st=st>>>ne,ge=st>>>1&2,st=st>>>ge,s=st>>>1&1,t=0,s=r[21952+((z|$|ne|ge|s)+(st>>>s)<<2)>>2]|0}s?Lt=65:(ne=t,$=m)}if((Lt|0)==65)for(z=s;;)if(st=(r[z+4>>2]&-8)-Le|0,s=st>>>0<m>>>0,m=s?st:m,t=s?z:t,s=r[z+16>>2]|0,s||(s=r[z+20>>2]|0),s)z=s;else{ne=t,$=m;break}if((ne|0)!=0&&$>>>0<((r[5414]|0)-Le|0)>>>0&&(Qe=ne+Le|0,Qe>>>0>ne>>>0)){z=r[ne+24>>2]|0,n=r[ne+12>>2]|0;do if((n|0)==(ne|0)){if(t=ne+20|0,n=r[t>>2]|0,!n&&(t=ne+16|0,n=r[t>>2]|0,!n)){n=0;break}for(;;)if(m=n+20|0,s=r[m>>2]|0,s)n=s,t=m;else if(m=n+16|0,s=r[m>>2]|0,s)n=s,t=m;else break;r[t>>2]=0}else Gt=r[ne+8>>2]|0,r[Gt+12>>2]=n,r[n+8>>2]=Gt;while(0);do if(z){if(t=r[ne+28>>2]|0,s=21952+(t<<2)|0,(ne|0)==(r[s>>2]|0)){if(r[s>>2]=n,!n){c=c&~(1<<t),r[5413]=c;break}}else if(Gt=z+16|0,r[((r[Gt>>2]|0)==(ne|0)?Gt:z+20|0)>>2]=n,!n)break;r[n+24>>2]=z,t=r[ne+16>>2]|0,t|0&&(r[n+16>>2]=t,r[t+24>>2]=n),t=r[ne+20>>2]|0,t&&(r[n+20>>2]=t,r[t+24>>2]=n)}while(0);e:do if($>>>0<16)Gt=$+Le|0,r[ne+4>>2]=Gt|3,Gt=ne+Gt+4|0,r[Gt>>2]=r[Gt>>2]|1;else{if(r[ne+4>>2]=Le|3,r[Qe+4>>2]=$|1,r[Qe+$>>2]=$,n=$>>>3,$>>>0<256){s=21688+(n<<1<<2)|0,t=r[5412]|0,n=1<<n,t&n?(t=s+8|0,n=r[t>>2]|0):(r[5412]=t|n,n=s,t=s+8|0),r[t>>2]=Qe,r[n+12>>2]=Qe,r[Qe+8>>2]=n,r[Qe+12>>2]=s;break}if(n=$>>>8,n?$>>>0>16777215?s=31:(Xr=(n+1048320|0)>>>16&8,Gt=n<<Xr,sr=(Gt+520192|0)>>>16&4,Gt=Gt<<sr,s=(Gt+245760|0)>>>16&2,s=14-(sr|Xr|s)+(Gt<<s>>>15)|0,s=$>>>(s+7|0)&1|s<<1):s=0,n=21952+(s<<2)|0,r[Qe+28>>2]=s,t=Qe+16|0,r[t+4>>2]=0,r[t>>2]=0,t=1<<s,!(c&t)){r[5413]=c|t,r[n>>2]=Qe,r[Qe+24>>2]=n,r[Qe+12>>2]=Qe,r[Qe+8>>2]=Qe;break}n=r[n>>2]|0;t:do if((r[n+4>>2]&-8|0)!=($|0)){for(c=$<<((s|0)==31?0:25-(s>>>1)|0);s=n+16+(c>>>31<<2)|0,t=r[s>>2]|0,!!t;)if((r[t+4>>2]&-8|0)==($|0)){n=t;break t}else c=c<<1,n=t;r[s>>2]=Qe,r[Qe+24>>2]=n,r[Qe+12>>2]=Qe,r[Qe+8>>2]=Qe;break e}while(0);Xr=n+8|0,Gt=r[Xr>>2]|0,r[Gt+12>>2]=Qe,r[Xr>>2]=Qe,r[Qe+8>>2]=Gt,r[Qe+12>>2]=n,r[Qe+24>>2]=0}while(0);return Gt=ne+8|0,Me=gi,Gt|0}else st=Le}else st=Le;else st=-1;while(0);if(s=r[5414]|0,s>>>0>=st>>>0)return n=s-st|0,t=r[5417]|0,n>>>0>15?(Gt=t+st|0,r[5417]=Gt,r[5414]=n,r[Gt+4>>2]=n|1,r[t+s>>2]=n,r[t+4>>2]=st|3):(r[5414]=0,r[5417]=0,r[t+4>>2]=s|3,Gt=t+s+4|0,r[Gt>>2]=r[Gt>>2]|1),Gt=t+8|0,Me=gi,Gt|0;if($=r[5415]|0,$>>>0>st>>>0)return sr=$-st|0,r[5415]=sr,Gt=r[5418]|0,Xr=Gt+st|0,r[5418]=Xr,r[Xr+4>>2]=sr|1,r[Gt+4>>2]=st|3,Gt=Gt+8|0,Me=gi,Gt|0;if(r[5530]|0?t=r[5532]|0:(r[5532]=4096,r[5531]=4096,r[5533]=-1,r[5534]=-1,r[5535]=0,r[5523]=0,r[5530]=gt&-16^1431655768,t=4096),ne=st+48|0,ge=st+47|0,z=t+ge|0,m=0-t|0,Le=z&m,Le>>>0<=st>>>0||(t=r[5522]|0,t|0&&(Qe=r[5520]|0,gt=Qe+Le|0,gt>>>0<=Qe>>>0|gt>>>0>t>>>0)))return Gt=0,Me=gi,Gt|0;e:do if(r[5523]&4)n=0,Lt=143;else{s=r[5418]|0;t:do if(s){for(c=22096;gt=r[c>>2]|0,!(gt>>>0<=s>>>0&&(gt+(r[c+4>>2]|0)|0)>>>0>s>>>0);)if(t=r[c+8>>2]|0,t)c=t;else{Lt=128;break t}if(n=z-$&m,n>>>0<2147483647)if(t=Gh(n)|0,(t|0)==((r[c>>2]|0)+(r[c+4>>2]|0)|0)){if((t|0)!=-1){$=n,z=t,Lt=145;break e}}else c=t,Lt=136;else n=0}else Lt=128;while(0);do if((Lt|0)==128)if(s=Gh(0)|0,(s|0)!=-1&&(n=s,Ot=r[5531]|0,Bt=Ot+-1|0,n=((Bt&n|0)==0?0:(Bt+n&0-Ot)-n|0)+Le|0,Ot=r[5520]|0,Bt=n+Ot|0,n>>>0>st>>>0&n>>>0<2147483647)){if(gt=r[5522]|0,gt|0&&Bt>>>0<=Ot>>>0|Bt>>>0>gt>>>0){n=0;break}if(t=Gh(n)|0,(t|0)==(s|0)){$=n,z=s,Lt=145;break e}else c=t,Lt=136}else n=0;while(0);do if((Lt|0)==136){if(s=0-n|0,!(ne>>>0>n>>>0&(n>>>0<2147483647&(c|0)!=-1)))if((c|0)==-1){n=0;break}else{$=n,z=c,Lt=145;break e}if(t=r[5532]|0,t=ge-n+t&0-t,t>>>0>=2147483647){$=n,z=c,Lt=145;break e}if((Gh(t)|0)==-1){Gh(s)|0,n=0;break}else{$=t+n|0,z=c,Lt=145;break e}}while(0);r[5523]=r[5523]|4,Lt=143}while(0);if((Lt|0)==143&&Le>>>0<2147483647&&(sr=Gh(Le)|0,Bt=Gh(0)|0,Mn=Bt-sr|0,Ar=Mn>>>0>(st+40|0)>>>0,!((sr|0)==-1|Ar^1|sr>>>0<Bt>>>0&((sr|0)!=-1&(Bt|0)!=-1)^1))&&($=Ar?Mn:n,z=sr,Lt=145),(Lt|0)==145){n=(r[5520]|0)+$|0,r[5520]=n,n>>>0>(r[5521]|0)>>>0&&(r[5521]=n),ge=r[5418]|0;e:do if(ge){for(n=22096;;){if(t=r[n>>2]|0,s=r[n+4>>2]|0,(z|0)==(t+s|0)){Lt=154;break}if(c=r[n+8>>2]|0,c)n=c;else break}if((Lt|0)==154&&(Xr=n+4|0,(r[n+12>>2]&8|0)==0)&&z>>>0>ge>>>0&t>>>0<=ge>>>0){r[Xr>>2]=s+$,Gt=(r[5415]|0)+$|0,sr=ge+8|0,sr=(sr&7|0)==0?0:0-sr&7,Xr=ge+sr|0,sr=Gt-sr|0,r[5418]=Xr,r[5415]=sr,r[Xr+4>>2]=sr|1,r[ge+Gt+4>>2]=40,r[5419]=r[5534];break}for(z>>>0<(r[5416]|0)>>>0&&(r[5416]=z),s=z+$|0,n=22096;;){if((r[n>>2]|0)==(s|0)){Lt=162;break}if(t=r[n+8>>2]|0,t)n=t;else break}if((Lt|0)==162&&(r[n+12>>2]&8|0)==0){r[n>>2]=z,Qe=n+4|0,r[Qe>>2]=(r[Qe>>2]|0)+$,Qe=z+8|0,Qe=z+((Qe&7|0)==0?0:0-Qe&7)|0,n=s+8|0,n=s+((n&7|0)==0?0:0-n&7)|0,Le=Qe+st|0,ne=n-Qe-st|0,r[Qe+4>>2]=st|3;t:do if((ge|0)==(n|0))Gt=(r[5415]|0)+ne|0,r[5415]=Gt,r[5418]=Le,r[Le+4>>2]=Gt|1;else{if((r[5417]|0)==(n|0)){Gt=(r[5414]|0)+ne|0,r[5414]=Gt,r[5417]=Le,r[Le+4>>2]=Gt|1,r[Le+Gt>>2]=Gt;break}if(t=r[n+4>>2]|0,(t&3|0)==1){$=t&-8,c=t>>>3;r:do if(t>>>0<256)if(t=r[n+8>>2]|0,s=r[n+12>>2]|0,(s|0)==(t|0)){r[5412]=r[5412]&~(1<<c);break}else{r[t+12>>2]=s,r[s+8>>2]=t;break}else{z=r[n+24>>2]|0,t=r[n+12>>2]|0;do if((t|0)==(n|0)){if(s=n+16|0,c=s+4|0,t=r[c>>2]|0,t)s=c;else if(t=r[s>>2]|0,!t){t=0;break}for(;;)if(m=t+20|0,c=r[m>>2]|0,c)t=c,s=m;else if(m=t+16|0,c=r[m>>2]|0,c)t=c,s=m;else break;r[s>>2]=0}else Gt=r[n+8>>2]|0,r[Gt+12>>2]=t,r[t+8>>2]=Gt;while(0);if(!z)break;s=r[n+28>>2]|0,c=21952+(s<<2)|0;do if((r[c>>2]|0)!=(n|0)){if(Gt=z+16|0,r[((r[Gt>>2]|0)==(n|0)?Gt:z+20|0)>>2]=t,!t)break r}else{if(r[c>>2]=t,t|0)break;r[5413]=r[5413]&~(1<<s);break r}while(0);if(r[t+24>>2]=z,s=n+16|0,c=r[s>>2]|0,c|0&&(r[t+16>>2]=c,r[c+24>>2]=t),s=r[s+4>>2]|0,!s)break;r[t+20>>2]=s,r[s+24>>2]=t}while(0);n=n+$|0,m=$+ne|0}else m=ne;if(n=n+4|0,r[n>>2]=r[n>>2]&-2,r[Le+4>>2]=m|1,r[Le+m>>2]=m,n=m>>>3,m>>>0<256){s=21688+(n<<1<<2)|0,t=r[5412]|0,n=1<<n,t&n?(t=s+8|0,n=r[t>>2]|0):(r[5412]=t|n,n=s,t=s+8|0),r[t>>2]=Le,r[n+12>>2]=Le,r[Le+8>>2]=n,r[Le+12>>2]=s;break}n=m>>>8;do if(!n)c=0;else{if(m>>>0>16777215){c=31;break}Xr=(n+1048320|0)>>>16&8,Gt=n<<Xr,sr=(Gt+520192|0)>>>16&4,Gt=Gt<<sr,c=(Gt+245760|0)>>>16&2,c=14-(sr|Xr|c)+(Gt<<c>>>15)|0,c=m>>>(c+7|0)&1|c<<1}while(0);if(n=21952+(c<<2)|0,r[Le+28>>2]=c,t=Le+16|0,r[t+4>>2]=0,r[t>>2]=0,t=r[5413]|0,s=1<<c,!(t&s)){r[5413]=t|s,r[n>>2]=Le,r[Le+24>>2]=n,r[Le+12>>2]=Le,r[Le+8>>2]=Le;break}n=r[n>>2]|0;r:do if((r[n+4>>2]&-8|0)!=(m|0)){for(c=m<<((c|0)==31?0:25-(c>>>1)|0);s=n+16+(c>>>31<<2)|0,t=r[s>>2]|0,!!t;)if((r[t+4>>2]&-8|0)==(m|0)){n=t;break r}else c=c<<1,n=t;r[s>>2]=Le,r[Le+24>>2]=n,r[Le+12>>2]=Le,r[Le+8>>2]=Le;break t}while(0);Xr=n+8|0,Gt=r[Xr>>2]|0,r[Gt+12>>2]=Le,r[Xr>>2]=Le,r[Le+8>>2]=Gt,r[Le+12>>2]=n,r[Le+24>>2]=0}while(0);return Gt=Qe+8|0,Me=gi,Gt|0}for(n=22096;t=r[n>>2]|0,!(t>>>0<=ge>>>0&&(Gt=t+(r[n+4>>2]|0)|0,Gt>>>0>ge>>>0));)n=r[n+8>>2]|0;m=Gt+-47|0,t=m+8|0,t=m+((t&7|0)==0?0:0-t&7)|0,m=ge+16|0,t=t>>>0<m>>>0?ge:t,n=t+8|0,s=$+-40|0,sr=z+8|0,sr=(sr&7|0)==0?0:0-sr&7,Xr=z+sr|0,sr=s-sr|0,r[5418]=Xr,r[5415]=sr,r[Xr+4>>2]=sr|1,r[z+s+4>>2]=40,r[5419]=r[5534],s=t+4|0,r[s>>2]=27,r[n>>2]=r[5524],r[n+4>>2]=r[5525],r[n+8>>2]=r[5526],r[n+12>>2]=r[5527],r[5524]=z,r[5525]=$,r[5527]=0,r[5526]=n,n=t+24|0;do Xr=n,n=n+4|0,r[n>>2]=7;while((Xr+8|0)>>>0<Gt>>>0);if((t|0)!=(ge|0)){if(z=t-ge|0,r[s>>2]=r[s>>2]&-2,r[ge+4>>2]=z|1,r[t>>2]=z,n=z>>>3,z>>>0<256){s=21688+(n<<1<<2)|0,t=r[5412]|0,n=1<<n,t&n?(t=s+8|0,n=r[t>>2]|0):(r[5412]=t|n,n=s,t=s+8|0),r[t>>2]=ge,r[n+12>>2]=ge,r[ge+8>>2]=n,r[ge+12>>2]=s;break}if(n=z>>>8,n?z>>>0>16777215?c=31:(Xr=(n+1048320|0)>>>16&8,Gt=n<<Xr,sr=(Gt+520192|0)>>>16&4,Gt=Gt<<sr,c=(Gt+245760|0)>>>16&2,c=14-(sr|Xr|c)+(Gt<<c>>>15)|0,c=z>>>(c+7|0)&1|c<<1):c=0,s=21952+(c<<2)|0,r[ge+28>>2]=c,r[ge+20>>2]=0,r[m>>2]=0,n=r[5413]|0,t=1<<c,!(n&t)){r[5413]=n|t,r[s>>2]=ge,r[ge+24>>2]=s,r[ge+12>>2]=ge,r[ge+8>>2]=ge;break}n=r[s>>2]|0;t:do if((r[n+4>>2]&-8|0)!=(z|0)){for(c=z<<((c|0)==31?0:25-(c>>>1)|0);s=n+16+(c>>>31<<2)|0,t=r[s>>2]|0,!!t;)if((r[t+4>>2]&-8|0)==(z|0)){n=t;break t}else c=c<<1,n=t;r[s>>2]=ge,r[ge+24>>2]=n,r[ge+12>>2]=ge,r[ge+8>>2]=ge;break e}while(0);Xr=n+8|0,Gt=r[Xr>>2]|0,r[Gt+12>>2]=ge,r[Xr>>2]=ge,r[ge+8>>2]=Gt,r[ge+12>>2]=n,r[ge+24>>2]=0}}else Gt=r[5416]|0,(Gt|0)==0|z>>>0<Gt>>>0&&(r[5416]=z),r[5524]=z,r[5525]=$,r[5527]=0,r[5421]=r[5530],r[5420]=-1,r[5425]=21688,r[5424]=21688,r[5427]=21696,r[5426]=21696,r[5429]=21704,r[5428]=21704,r[5431]=21712,r[5430]=21712,r[5433]=21720,r[5432]=21720,r[5435]=21728,r[5434]=21728,r[5437]=21736,r[5436]=21736,r[5439]=21744,r[5438]=21744,r[5441]=21752,r[5440]=21752,r[5443]=21760,r[5442]=21760,r[5445]=21768,r[5444]=21768,r[5447]=21776,r[5446]=21776,r[5449]=21784,r[5448]=21784,r[5451]=21792,r[5450]=21792,r[5453]=21800,r[5452]=21800,r[5455]=21808,r[5454]=21808,r[5457]=21816,r[5456]=21816,r[5459]=21824,r[5458]=21824,r[5461]=21832,r[5460]=21832,r[5463]=21840,r[5462]=21840,r[5465]=21848,r[5464]=21848,r[5467]=21856,r[5466]=21856,r[5469]=21864,r[5468]=21864,r[5471]=21872,r[5470]=21872,r[5473]=21880,r[5472]=21880,r[5475]=21888,r[5474]=21888,r[5477]=21896,r[5476]=21896,r[5479]=21904,r[5478]=21904,r[5481]=21912,r[5480]=21912,r[5483]=21920,r[5482]=21920,r[5485]=21928,r[5484]=21928,r[5487]=21936,r[5486]=21936,Gt=$+-40|0,sr=z+8|0,sr=(sr&7|0)==0?0:0-sr&7,Xr=z+sr|0,sr=Gt-sr|0,r[5418]=Xr,r[5415]=sr,r[Xr+4>>2]=sr|1,r[z+Gt+4>>2]=40,r[5419]=r[5534];while(0);if(n=r[5415]|0,n>>>0>st>>>0)return sr=n-st|0,r[5415]=sr,Gt=r[5418]|0,Xr=Gt+st|0,r[5418]=Xr,r[Xr+4>>2]=sr|1,r[Gt+4>>2]=st|3,Gt=Gt+8|0,Me=gi,Gt|0}return r[(Ko()|0)>>2]=48,Gt=0,Me=gi,Gt|0}function vx(t){t=t|0;var n=0,s=0,c=0,m=0,z=0,$=0,ne=0,ge=0;if(!t)return;s=t+-8|0,m=r[5416]|0,t=r[t+-4>>2]|0,n=t&-8,ge=s+n|0;do if(t&1)ne=s,$=s;else{if(c=r[s>>2]|0,!(t&3)||($=s+(0-c)|0,z=c+n|0,$>>>0<m>>>0))return;if((r[5417]|0)==($|0)){if(t=ge+4|0,n=r[t>>2]|0,(n&3|0)!=3){ne=$,n=z;break}r[5414]=z,r[t>>2]=n&-2,r[$+4>>2]=z|1,r[$+z>>2]=z;return}if(s=c>>>3,c>>>0<256)if(t=r[$+8>>2]|0,n=r[$+12>>2]|0,(n|0)==(t|0)){r[5412]=r[5412]&~(1<<s),ne=$,n=z;break}else{r[t+12>>2]=n,r[n+8>>2]=t,ne=$,n=z;break}m=r[$+24>>2]|0,t=r[$+12>>2]|0;do if((t|0)==($|0)){if(n=$+16|0,s=n+4|0,t=r[s>>2]|0,t)n=s;else if(t=r[n>>2]|0,!t){t=0;break}for(;;)if(c=t+20|0,s=r[c>>2]|0,s)t=s,n=c;else if(c=t+16|0,s=r[c>>2]|0,s)t=s,n=c;else break;r[n>>2]=0}else ne=r[$+8>>2]|0,r[ne+12>>2]=t,r[t+8>>2]=ne;while(0);if(m){if(n=r[$+28>>2]|0,s=21952+(n<<2)|0,(r[s>>2]|0)==($|0)){if(r[s>>2]=t,!t){r[5413]=r[5413]&~(1<<n),ne=$,n=z;break}}else if(ne=m+16|0,r[((r[ne>>2]|0)==($|0)?ne:m+20|0)>>2]=t,!t){ne=$,n=z;break}r[t+24>>2]=m,n=$+16|0,s=r[n>>2]|0,s|0&&(r[t+16>>2]=s,r[s+24>>2]=t),n=r[n+4>>2]|0,n?(r[t+20>>2]=n,r[n+24>>2]=t,ne=$,n=z):(ne=$,n=z)}else ne=$,n=z}while(0);if($>>>0>=ge>>>0||(t=ge+4|0,c=r[t>>2]|0,!(c&1)))return;if(c&2)r[t>>2]=c&-2,r[ne+4>>2]=n|1,r[$+n>>2]=n,m=n;else{if((r[5418]|0)==(ge|0)){if(ge=(r[5415]|0)+n|0,r[5415]=ge,r[5418]=ne,r[ne+4>>2]=ge|1,(ne|0)!=(r[5417]|0))return;r[5417]=0,r[5414]=0;return}if((r[5417]|0)==(ge|0)){ge=(r[5414]|0)+n|0,r[5414]=ge,r[5417]=$,r[ne+4>>2]=ge|1,r[$+ge>>2]=ge;return}m=(c&-8)+n|0,s=c>>>3;do if(c>>>0<256)if(n=r[ge+8>>2]|0,t=r[ge+12>>2]|0,(t|0)==(n|0)){r[5412]=r[5412]&~(1<<s);break}else{r[n+12>>2]=t,r[t+8>>2]=n;break}else{z=r[ge+24>>2]|0,t=r[ge+12>>2]|0;do if((t|0)==(ge|0)){if(n=ge+16|0,s=n+4|0,t=r[s>>2]|0,t)n=s;else if(t=r[n>>2]|0,!t){s=0;break}for(;;)if(c=t+20|0,s=r[c>>2]|0,s)t=s,n=c;else if(c=t+16|0,s=r[c>>2]|0,s)t=s,n=c;else break;r[n>>2]=0,s=t}else s=r[ge+8>>2]|0,r[s+12>>2]=t,r[t+8>>2]=s,s=t;while(0);if(z|0){if(t=r[ge+28>>2]|0,n=21952+(t<<2)|0,(r[n>>2]|0)==(ge|0)){if(r[n>>2]=s,!s){r[5413]=r[5413]&~(1<<t);break}}else if(c=z+16|0,r[((r[c>>2]|0)==(ge|0)?c:z+20|0)>>2]=s,!s)break;r[s+24>>2]=z,t=ge+16|0,n=r[t>>2]|0,n|0&&(r[s+16>>2]=n,r[n+24>>2]=s),t=r[t+4>>2]|0,t|0&&(r[s+20>>2]=t,r[t+24>>2]=s)}}while(0);if(r[ne+4>>2]=m|1,r[$+m>>2]=m,(ne|0)==(r[5417]|0)){r[5414]=m;return}}if(t=m>>>3,m>>>0<256){s=21688+(t<<1<<2)|0,n=r[5412]|0,t=1<<t,n&t?(n=s+8|0,t=r[n>>2]|0):(r[5412]=n|t,t=s,n=s+8|0),r[n>>2]=ne,r[t+12>>2]=ne,r[ne+8>>2]=t,r[ne+12>>2]=s;return}t=m>>>8,t?m>>>0>16777215?c=31:($=(t+1048320|0)>>>16&8,ge=t<<$,z=(ge+520192|0)>>>16&4,ge=ge<<z,c=(ge+245760|0)>>>16&2,c=14-(z|$|c)+(ge<<c>>>15)|0,c=m>>>(c+7|0)&1|c<<1):c=0,t=21952+(c<<2)|0,r[ne+28>>2]=c,r[ne+20>>2]=0,r[ne+16>>2]=0,n=r[5413]|0,s=1<<c;e:do if(!(n&s))r[5413]=n|s,r[t>>2]=ne,r[ne+24>>2]=t,r[ne+12>>2]=ne,r[ne+8>>2]=ne;else{t=r[t>>2]|0;t:do if((r[t+4>>2]&-8|0)!=(m|0)){for(c=m<<((c|0)==31?0:25-(c>>>1)|0);s=t+16+(c>>>31<<2)|0,n=r[s>>2]|0,!!n;)if((r[n+4>>2]&-8|0)==(m|0)){t=n;break t}else c=c<<1,t=n;r[s>>2]=ne,r[ne+24>>2]=t,r[ne+12>>2]=ne,r[ne+8>>2]=ne;break e}while(0);$=t+8|0,ge=r[$>>2]|0,r[ge+12>>2]=ne,r[$>>2]=ne,r[ne+8>>2]=ge,r[ne+12>>2]=t,r[ne+24>>2]=0}while(0);if(ge=(r[5420]|0)+-1|0,r[5420]=ge,!(ge|0)){for(t=22104;t=r[t>>2]|0,t;)t=t+8|0;r[5420]=-1}}function Gh(t){t=t|0;var n=0,s=0,c=0;c=t+3&-4,t=Sb()|0,n=r[t>>2]|0,s=n+c|0;do if((c|0)<1|s>>>0>n>>>0){if(s>>>0>(Xf()|0)>>>0&&(pd(s|0)|0)==0)break;return r[t>>2]=s,c=n,c|0}while(0);return r[(Ko()|0)>>2]=48,c=-1,c|0}function E3(t){t=t|0;var n=0;return n=Me,Me=Me+t|0,Me=Me+15&-16,n|0}function T3(t){t=t|0,Me=t}function S3(){return Me|0}function R3(t,n){t=t|0,n=n|0;var s=0,c=0,m=0,z=0;return z=t&65535,m=n&65535,s=Nn(m,z)|0,c=t>>>16,t=(s>>>16)+(Nn(m,c)|0)|0,m=n>>>16,n=Nn(m,z)|0,Cn((t>>>16)+(Nn(m,c)|0)+(((t&65535)+n|0)>>>16)|0),t+n<<16|s&65535|0|0}function gx(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0;var m=0,z=0;return m=t,z=s,s=R3(m,z)|0,t=ei()|0,Cn((Nn(n,z)|0)+(Nn(c,m)|0)+t|t&0|0),s|0|0|0}function ru(t,n,s,c){return t=t|0,n=n|0,s=s|0,c=c|0,s=t+s>>>0,Cn(n+c+(s>>>0<t>>>0|0)>>>0|0),s|0|0}function y0(t,n,s,c){return t=t|0,n=n|0,s=s|0,c=c|0,c=n-c-(s>>>0>t>>>0|0)>>>0,Cn(c|0),t-s>>>0|0|0}function Eb(t){return t=t|0,(t?31-(Ia(t^t-1)|0)|0:32)|0}function C3(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0;var z=0,$=0,ne=0,ge=0,Le=0,Qe=0,st=0,gt=0,Ot=0,Bt=0;if(Qe=t,ge=n,Le=ge,$=s,gt=c,ne=gt,!Le)return z=(m|0)!=0,ne?z?(r[m>>2]=t|0,r[m+4>>2]=n&0,gt=0,m=0,Cn(gt|0),m|0):(gt=0,m=0,Cn(gt|0),m|0):(z&&(r[m>>2]=(Qe>>>0)%($>>>0),r[m+4>>2]=0),gt=0,m=(Qe>>>0)/($>>>0)>>>0,Cn(gt|0),m|0);z=(ne|0)==0;do if($){if(!z){if(z=(Ia(ne|0)|0)-(Ia(Le|0)|0)|0,z>>>0<=31){st=z+1|0,ne=31-z|0,n=z-31>>31,$=st,t=Qe>>>(st>>>0)&n|Le<<ne,n=Le>>>(st>>>0)&n,z=0,ne=Qe<<ne;break}return m?(r[m>>2]=t|0,r[m+4>>2]=ge|n&0,gt=0,m=0,Cn(gt|0),m|0):(gt=0,m=0,Cn(gt|0),m|0)}if(z=$-1|0,z&$|0){ne=(Ia($|0)|0)+33-(Ia(Le|0)|0)|0,Bt=64-ne|0,st=32-ne|0,ge=st>>31,Ot=ne-32|0,n=Ot>>31,$=ne,t=st-1>>31&Le>>>(Ot>>>0)|(Le<<st|Qe>>>(ne>>>0))&n,n=n&Le>>>(ne>>>0),z=Qe<<Bt&ge,ne=(Le<<Bt|Qe>>>(Ot>>>0))&ge|Qe<<st&ne-33>>31;break}return m|0&&(r[m>>2]=z&Qe,r[m+4>>2]=0),($|0)==1?(Ot=ge|n&0,Bt=t|0|0,Cn(Ot|0),Bt|0):(Bt=Eb($|0)|0,Ot=Le>>>(Bt>>>0)|0,Bt=Le<<32-Bt|Qe>>>(Bt>>>0)|0,Cn(Ot|0),Bt|0)}else{if(z)return m|0&&(r[m>>2]=(Le>>>0)%($>>>0),r[m+4>>2]=0),Ot=0,Bt=(Le>>>0)/($>>>0)>>>0,Cn(Ot|0),Bt|0;if(!Qe)return m|0&&(r[m>>2]=0,r[m+4>>2]=(Le>>>0)%(ne>>>0)),Ot=0,Bt=(Le>>>0)/(ne>>>0)>>>0,Cn(Ot|0),Bt|0;if(z=ne-1|0,!(z&ne))return m|0&&(r[m>>2]=t|0,r[m+4>>2]=z&Le|n&0),Ot=0,Bt=Le>>>((Eb(ne|0)|0)>>>0),Cn(Ot|0),Bt|0;if(z=(Ia(ne|0)|0)-(Ia(Le|0)|0)|0,z>>>0<=30){n=z+1|0,ne=31-z|0,$=n,t=Le<<ne|Qe>>>(n>>>0),n=Le>>>(n>>>0),z=0,ne=Qe<<ne;break}return m?(r[m>>2]=t|0,r[m+4>>2]=ge|n&0,Ot=0,Bt=0,Cn(Ot|0),Bt|0):(Ot=0,Bt=0,Cn(Ot|0),Bt|0)}while(0);if(!$)Le=ne,ge=0,ne=0;else{st=s|0|0,Qe=gt|c&0,Le=ru(st|0,Qe|0,-1,-1)|0,s=ei()|0,ge=ne,ne=0;do c=ge,ge=z>>>31|ge<<1,z=ne|z<<1,c=t<<1|c>>>31|0,gt=t>>>31|n<<1|0,y0(Le|0,s|0,c|0,gt|0)|0,Bt=ei()|0,Ot=Bt>>31|((Bt|0)<0?-1:0)<<1,ne=Ot&1,t=y0(c|0,gt|0,Ot&st|0,(((Bt|0)<0?-1:0)>>31|((Bt|0)<0?-1:0)<<1)&Qe|0)|0,n=ei()|0,$=$-1|0;while(($|0)!=0);Le=ge,ge=0}return $=0,m|0&&(r[m>>2]=t,r[m+4>>2]=n),Ot=(z|0)>>>31|(Le|$)<<1|($<<1|z>>>31)&0|ge,Bt=(z<<1|0>>>31)&-2|ne,Cn(Ot|0),Bt|0}function yx(t,n,s,c){return t=t|0,n=n|0,s=s|0,c=c|0,C3(t,n,s,c,0)|0}function Py(t,n,s){return t=t|0,n=n|0,s=s|0,(s|0)<32?(Cn(n>>>s|0),t>>>s|(n&(1<<s)-1)<<32-s):(Cn(0),n>>>s-32|0)}function Tb(t,n,s){return t=t|0,n=n|0,s=s|0,(s|0)<32?(Cn(n<<s|(t&(1<<s)-1<<32-s)>>>32-s|0),t<<s):(Cn(t<<s-32|0),0)}function Sb(){return 22176}function Rb(t){return t=t|0,(t&255)<<24|(t>>8&255)<<16|(t>>16&255)<<8|t>>>24|0}function wo(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0;if((s|0)>=512)return dd(t|0,n|0,s|0)|0,t|0;if(z=t|0,m=t+s|0,(t&3)==(n&3)){for(;t&3;){if(!s)return z|0;ie[t>>0]=ie[n>>0]|0,t=t+1|0,n=n+1|0,s=s-1|0}for(s=m&-4|0,c=s-64|0;(t|0)<=(c|0);)r[t>>2]=r[n>>2],r[t+4>>2]=r[n+4>>2],r[t+8>>2]=r[n+8>>2],r[t+12>>2]=r[n+12>>2],r[t+16>>2]=r[n+16>>2],r[t+20>>2]=r[n+20>>2],r[t+24>>2]=r[n+24>>2],r[t+28>>2]=r[n+28>>2],r[t+32>>2]=r[n+32>>2],r[t+36>>2]=r[n+36>>2],r[t+40>>2]=r[n+40>>2],r[t+44>>2]=r[n+44>>2],r[t+48>>2]=r[n+48>>2],r[t+52>>2]=r[n+52>>2],r[t+56>>2]=r[n+56>>2],r[t+60>>2]=r[n+60>>2],t=t+64|0,n=n+64|0;for(;(t|0)<(s|0);)r[t>>2]=r[n>>2],t=t+4|0,n=n+4|0}else for(s=m-4|0;(t|0)<(s|0);)ie[t>>0]=ie[n>>0]|0,ie[t+1>>0]=ie[n+1>>0]|0,ie[t+2>>0]=ie[n+2>>0]|0,ie[t+3>>0]=ie[n+3>>0]|0,t=t+4|0,n=n+4|0;for(;(t|0)<(m|0);)ie[t>>0]=ie[n>>0]|0,t=t+1|0,n=n+1|0;return z|0}function nu(t,n,s){t=t|0,n=n|0,s=s|0;var c=0;if((n|0)<(t|0)&(t|0)<(n+s|0)){for(c=t,n=n+s|0,t=t+s|0;(s|0)>0;)t=t-1|0,n=n-1|0,s=s-1|0,ie[t>>0]=ie[n>>0]|0;t=c}else wo(t,n,s)|0;return t|0}function Vh(t,n,s){t=t|0,n=n|0,s=s|0;var c=0,m=0,z=0,$=0;if(z=t+s|0,n=n&255,(s|0)>=67){for(;t&3;)ie[t>>0]=n,t=t+1|0;for(c=z&-4|0,$=n|n<<8|n<<16|n<<24,m=c-64|0;(t|0)<=(m|0);)r[t>>2]=$,r[t+4>>2]=$,r[t+8>>2]=$,r[t+12>>2]=$,r[t+16>>2]=$,r[t+20>>2]=$,r[t+24>>2]=$,r[t+28>>2]=$,r[t+32>>2]=$,r[t+36>>2]=$,r[t+40>>2]=$,r[t+44>>2]=$,r[t+48>>2]=$,r[t+52>>2]=$,r[t+56>>2]=$,r[t+60>>2]=$,t=t+64|0;for(;(t|0)<(c|0);)r[t>>2]=$,t=t+4|0}for(;(t|0)<(z|0);)ie[t>>0]=n,t=t+1|0;return z-s|0}function P3(t){return t=t|0,Ax[t&3]()|0}function L3(t,n){return t=t|0,n=n|0,Ly[t&15](n|0)|0}function O3(t,n,s,c,m,z,$){return t=t|0,n=n|0,s=+s,c=c|0,m=m|0,z=z|0,$=$|0,Ob[t&1](n|0,+s,c|0,m|0,z|0,$|0)|0}function F3(t,n,s){return t=t|0,n=n|0,s=s|0,km[t&63](n|0,s|0)|0}function I3(t,n,s,c){return t=t|0,n=n|0,s=s|0,c=c|0,_0[t&7](n|0,s|0,c|0)|0}function k3(t){t=t|0,wx[t&3]()}function D3(t,n){t=t|0,n=n|0,Bi[t&255](n|0)}function N3(t,n,s){t=t|0,n=n|0,s=s|0,Lf[t&15](n|0,s|0)}function B3(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0,Dm[t&15](n|0,s|0,c|0)}function U3(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,Nm[t&7](n|0,s|0,c|0,m|0)}function z3(t,n,s,c,m,z){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0,Oy[t&3](n|0,s|0,c|0,m|0,z|0)}function G3(t,n,s,c,m,z,$){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0,$=$|0,Bm[t&3](n|0,s|0,c|0,m|0,z|0,$|0)}function Cb(){return Ya(0),0}function _x(t){return t=t|0,Ya(1),0}function V3(t,n,s,c,m,z){return t=t|0,n=+n,s=s|0,c=c|0,m=m|0,z=z|0,Ya(2),0}function va(t,n){return t=t|0,n=n|0,Ya(3),0}function Pb(t,n,s){return t=t|0,n=n|0,s=s|0,Ya(4),0}function Lb(){Ya(5)}function ar(t){t=t|0,Ya(6)}function Pf(t,n){t=t|0,n=n|0,Ya(7)}function Wh(t,n,s){t=t|0,n=n|0,s=s|0,Ya(8)}function xx(t,n,s,c){t=t|0,n=n|0,s=s|0,c=c|0,Ya(9)}function W3(t,n,s,c,m){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,Ya(10)}function H3(t,n,s,c,m,z){t=t|0,n=n|0,s=s|0,c=c|0,m=m|0,z=z|0,Ya(11)}var Ax=[Cb,rm,Nh,Cb],Ly=[_x,ur,ko,ju,On,Ui,Pa,u3,v3,K1,Yf,Og,nm,zg,_x,_x],Ob=[V3,hx],km=[va,md,Uc,Zu,Tt,kn,bs,ob,ub,cb,ov,lv,Fd,vv,uf,L2,Cp,Q2,Lp,i1,f1,Zv,x1,$v,E1,mh,gh,Gd,R1,cg,pg,vg,Xd,Jd,F1,Sh,Ag,W1,Y1,Lh,Tg,hm,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va,va],_0=[Pb,Oe,ir,Vn,sn,c3,f3,Pb],wx=[Lb,qr,kt,Lb],Bi=[ar,vi,Lo,Ll,Nc,Bc,Jf,Yn,Rr,Xu,jc,Io,No,Kf,Yu,Yc,Qn,da,xd,Ad,K0,fp,He,nt,At,oh,wi,Mi,Li,Si,Ga,Va,Fs,p2,sb,go,lb,Ku,Zo,uv,_p,Od,E2,T2,S2,mv,bp,xv,Av,fs,wv,P2,Nv,Bv,Uv,Wv,K2,Hv,t1,r1,Fp,Xv,l1,c1,h1,Ip,v1,_1,Jv,Dd,Qv,M1,Dp,Nd,T1,Bd,lf,cf,tg,Ud,zd,yh,Vd,sg,og,ug,_h,rc,zp,ac,Gp,Vp,mg,Yo,vf,Zd,Yd,Xp,O1,bh,I1,Th,$p,Jo,N1,sl,wg,V1,j1,gf,$i,Ph,J1,Q1,$o,Sg,Vt,Zt,Jt,jt,mi,en,Zr,Sn,li,hn,wn,yn,Vr,It,En,di,eu,s3,o3,m3,bb,x3,_f,Ao,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar,ar],Lf=[Pf,Do,Zc,Ic,jr,Vu,Os,Z0,dx,Pf,Pf,Pf,Pf,Pf,Pf,Pf],Dm=[Wh,l3,h3,g3,y3,jf,Co,Pg,Wg,Zg,Wh,Wh,Wh,Wh,Wh,Wh],Nm=[xx,or,Kr,Ds,t_,Bh,xx,xx],Oy=[W3,Hr,Dn,Qi],Bm=[H3,Sr,gn,si];return{__ZSt18uncaught_exceptionv:_c,___cxa_can_catch:ci,___cxa_is_pointer_type:hi,___embind_register_native_and_builtin_types:bm,___errno_location:Ko,___getTypeName:nx,___muldi3:gx,___udivdi3:yx,_bitshift64Lshr:Py,_bitshift64Shl:Tb,_emscripten_get_sbrk_ptr:Sb,_free:vx,_i64Add:ru,_i64Subtract:y0,_llvm_bswap_i32:Rb,_malloc:Cy,_memcpy:wo,_memmove:nu,_memset:Vh,dynCall_i:P3,dynCall_ii:L3,dynCall_iidiiii:O3,dynCall_iii:F3,dynCall_iiii:I3,dynCall_v:k3,dynCall_vi:D3,dynCall_vii:N3,dynCall_viii:B3,dynCall_viiii:U3,dynCall_viiiii:z3,dynCall_viiiiii:G3,globalCtors:Zf,stackAlloc:E3,stackRestore:T3,stackSave:S3}}(Al,os,ce),no=a.__ZSt18uncaught_exceptionv=un.__ZSt18uncaught_exceptionv;a.___cxa_can_catch=un.___cxa_can_catch,a.___cxa_is_pointer_type=un.___cxa_is_pointer_type,a.___embind_register_native_and_builtin_types=un.___embind_register_native_and_builtin_types,a.___errno_location=un.___errno_location;var wl=a.___getTypeName=un.___getTypeName;a.___muldi3=un.___muldi3,a.___udivdi3=un.___udivdi3,a._bitshift64Lshr=un._bitshift64Lshr,a._bitshift64Shl=un._bitshift64Shl,a._emscripten_get_sbrk_ptr=un._emscripten_get_sbrk_ptr;var Ps=a._free=un._free;a._i64Add=un._i64Add,a._i64Subtract=un._i64Subtract,a._llvm_bswap_i32=un._llvm_bswap_i32;var Ws=a._malloc=un._malloc;a._memcpy=un._memcpy,a._memmove=un._memmove,a._memset=un._memset;var Wf=a.globalCtors=un.globalCtors;if(a.stackAlloc=un.stackAlloc,a.stackRestore=un.stackRestore,a.stackSave=un.stackSave,a.dynCall_i=un.dynCall_i,a.dynCall_ii=un.dynCall_ii,a.dynCall_iidiiii=un.dynCall_iidiiii,a.dynCall_iii=un.dynCall_iii,a.dynCall_iiii=un.dynCall_iiii,a.dynCall_v=un.dynCall_v,a.dynCall_vi=un.dynCall_vi,a.dynCall_vii=un.dynCall_vii,a.dynCall_viii=un.dynCall_viii,a.dynCall_viiii=un.dynCall_viiii,a.dynCall_viiiii=un.dynCall_viiiii,a.dynCall_viiiiii=un.dynCall_viiiiii,a.asm=un,re)if(Re(re)||(re=g(re)),v||y){var fd=B(re);ue.set(fd,T)}else{ot();var Ml=function(Ye){Ye.byteLength&&(Ye=new Uint8Array(Ye)),ue.set(Ye,T),a.memoryInitializerRequest&&delete a.memoryInitializerRequest.response,bt()},Hf=function(){D(re,Ml,function(){var Ye=new Error("could not load memory initializer "+re);throw Ye})},Lc=ja(re);if(Lc)Ml(Lc.buffer);else if(a.memoryInitializerRequest){var bl=function(){var Ye=a.memoryInitializerRequest,qe=Ye.response;if(Ye.status!==200&&Ye.status!==0){var yt=ja(a.memoryInitializerRequestURL);if(yt)qe=yt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Ye.status+", retrying "+re),Hf();return}}Ml(qe)};a.memoryInitializerRequest.response?setTimeout(bl,0):a.memoryInitializerRequest.addEventListener("load",bl)}else Hf()}var Gu;function hd(Ye){this.name="ExitStatus",this.message="Program terminated with exit("+Ye+")",this.status=Ye}lt=function Ye(){Gu||qf(),Gu||(lt=Ye)};function qf(Ye){if(je>0||(Ae(),je>0))return;function qe(){Gu||(Gu=!0,a.calledRun=!0,!N&&(Se(),Te(),a.onRuntimeInitialized&&a.onRuntimeInitialized(),me()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),qe()},1)):qe()}if(a.run=qf,a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return qf(),a}let qh=null;const jC={0:a=>({position:[a.getInt32(0,!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(15)}),1:a=>({position:[a.getInt32(0,!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(15)}),2:a=>({position:[a.getInt32(0,!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(15),color:[a.getUint16(20,!0),a.getUint16(22,!0),a.getUint16(24,!0)]}),3:a=>({position:[a.getInt32(0,!0),a.getInt32(4,!0),a.getInt32(8,!0)],intensity:a.getUint16(12,!0),classification:a.getUint8(15),color:[a.getUint16(28,!0),a.getUint16(30,!0),a.getUint16(32,!0)]})};function Of(a,u={},h,R){R=R===void 0||R===0?1:R;const M=a.slice(h,h+u.BYTES_PER_ELEMENT*R),v=new u(M);if(R===1)return v[0];const y=[];for(let p=0;p<R;p++)y.push(v[p]);return y}function YC(a){let u=131;const h={pointsOffset:Of(a,Uint32Array,32*3),pointsFormatId:Of(a,Uint8Array,32*3+8),pointsStructSize:Of(a,Uint16Array,32*3+8+1),pointsCount:Of(a,Uint32Array,32*3+11),scale:Of(a,Float64Array,u,3)};u+=24,h.offset=Of(a,Float64Array,u,3),u+=24;const R=Of(a,Float64Array,u,6);return u+=48,h.maxs=[R[0],R[2],R[4]],h.mins=[R[1],R[3],R[5]],h}class fk{constructor(u){Ei(this,"arraybuffer",void 0),Ei(this,"readOffset",0),Ei(this,"header",{pointsOffset:0,pointsFormatId:0,pointsStructSize:0,pointsCount:0,scale:[0,0,0],offset:[0,0,0],maxs:[0],mins:[0],totalToRead:0,totalRead:0,versionAsString:"",isCompressed:!0}),this.arraybuffer=u}open(){return!0}getHeader(){return this.header=YC(this.arraybuffer),this.header}readData(u,h){const{header:R,arraybuffer:M}=this;if(!R)throw new Error("Cannot start reading data till a header request is issued");let{readOffset:v}=this,y;if(h<=1){u=Math.min(u,R.pointsCount-v),y=R.pointsOffset+v*R.pointsStructSize;const B=y+u*R.pointsStructSize;return v+=u,this.readOffset=v,{buffer:M.slice(y,B),count:u,hasMoreData:v<R.pointsCount}}const p=Math.min(u*h,R.pointsCount-v),g=Math.ceil(p/h);let C=0;const D=new Uint8Array(g*R.pointsStructSize);for(let B=0;B<p;B++){if(B%h===0){y=R.pointsOffset+v*R.pointsStructSize;const V=new Uint8Array(M,y,R.pointsStructSize);D.set(V,C*R.pointsStructSize),C++}v++}return this.readOffset=v,{buffer:D.buffer,count:C,hasMoreData:v<R.pointsCount}}close(){return this.arraybuffer=null,!0}}class hk{constructor(u){Ei(this,"arraybuffer",void 0),Ei(this,"instance",null),Ei(this,"header",null),this.arraybuffer=u,qh||(qh=ck())}open(){try{const{arraybuffer:u}=this;this.instance=new qh.LASZip;const h=new Uint8Array(u),R=qh._malloc(u.byteLength);return this.instance.arraybuffer=u,this.instance.buf=R,qh.HEAPU8.set(h,R),this.instance.open(R,u.byteLength),this.instance.readOffset=0,!0}catch(u){throw new Error("Failed to open file: ".concat(u.message))}}getHeader(){if(!this.instance)throw new Error("You need to open the file before trying to read header");try{const u=YC(this.instance.arraybuffer);return u.pointsFormatId&=63,this.header=u,u}catch(u){throw new Error("Failed to get header: ".concat(u.message))}}readData(u,h,R){if(!this.instance)throw new Error("You need to open the file before trying to read stuff");const{header:M,instance:v}=this;if(!M)throw new Error("You need to query header before reading, I maintain state that way, sorry :(");try{const y=Math.min(u*R,M.pointsCount-v.readOffset),p=Math.ceil(y/R);let g=0;const C=new Uint8Array(p*M.pointsStructSize),D=qh._malloc(M.pointsStructSize);for(let B=0;B<y;B++){if(v.getPoint(D),B%R===0){const V=new Uint8Array(qh.HEAPU8.buffer,D,M.pointsStructSize);C.set(V,g*M.pointsStructSize),g++}v.readOffset++}return{buffer:C.buffer,count:g,hasMoreData:v.readOffset<M.pointsCount}}catch(y){throw new Error("Failed to read data: ".concat(y.message))}}close(){try{return this.instance!==null&&(this.instance.delete(),this.instance=null),!0}catch(u){throw new Error("Failed to close file: ".concat(u.message))}}}class dk{constructor(u,h,R){Ei(this,"arrayb",void 0),Ei(this,"decoder",void 0),Ei(this,"pointsCount",void 0),Ei(this,"pointSize",void 0),Ei(this,"scale",void 0),Ei(this,"offset",void 0),Ei(this,"mins",void 0),Ei(this,"maxs",void 0),this.arrayb=u,this.decoder=jC[R.pointsFormatId],this.pointsCount=h,this.pointSize=R.pointsStructSize,this.scale=R.scale,this.offset=R.offset,this.mins=R.mins,this.maxs=R.maxs}getPoint(u){if(u<0||u>=this.pointsCount)throw new Error("Point index out of range");const h=new DataView(this.arrayb,u*this.pointSize,this.pointSize);return this.decoder(h)}}class pk{constructor(u){if(Ei(this,"arraybuffer",void 0),Ei(this,"formatId",0),Ei(this,"loader",void 0),Ei(this,"isCompressed",!0),Ei(this,"isOpen",!1),Ei(this,"version",0),Ei(this,"versionAsString",""),this.arraybuffer=u,this.determineVersion()>13)throw new Error("Only file versions <= 1.3 are supported at this time");if(this.determineFormat(),jC[this.formatId]===void 0)throw new Error("The point format ID is not supported");this.loader=this.isCompressed?new hk(this.arraybuffer):new fk(this.arraybuffer)}determineFormat(){const u=Of(this.arraybuffer,Uint8Array,104),h=(u&128)>>7,R=(u&64)>>6;if(h===1&&R===1)throw new Error("Old style compression not supported");this.formatId=u&63,this.isCompressed=h===1||R===1}determineVersion(){const u=new Int8Array(this.arraybuffer,24,2);return this.version=u[0]*10+u[1],this.versionAsString="".concat(u[0],".").concat(u[1]),this.version}open(){this.loader.open()&&(this.isOpen=!0)}getHeader(){return this.loader.getHeader()}readData(u,h,R){return this.loader.readData(u,h,R)}close(){this.loader.close()&&(this.isOpen=!1)}getUnpacker(){return dk}}function mk(a,u){const h=vk(a);return sk(u,h)}function vk(a){const u=new Map;return u.set("las_pointsOffset",a.pointsOffset.toString(10)),u.set("las_pointsFormatId",a.pointsFormatId.toString(10)),u.set("las_pointsStructSize",a.pointsStructSize.toString(10)),u.set("las_pointsCount",a.pointsCount.toString(10)),u.set("las_scale",JSON.stringify(a.scale)),u.set("las_offset",JSON.stringify(a.offset)),a.maxs!==void 0&&u.set("las_maxs",JSON.stringify(a.maxs)),a.mins!==void 0&&u.set("las_mins",JSON.stringify(a.mins)),u.set("las_totalToRead",a.totalToRead.toString(10)),u.set("las_pointsFortotalReadmatId",a.totalRead.toString(10)),a.versionAsString!==void 0&&u.set("las_versionAsString",a.versionAsString),a.isCompressed!==void 0&&u.set("las_isCompressed",a.isCompressed.toString()),u}function $S(a,u){return gk(a,u)}function gk(a,u={}){var h;let R=0,M,v,y,p,g;const C={loader:"las",loaderData:{},schema:new Zh([]),header:{vertexCount:0,boundingBox:[[0,0,0],[0,0,0]]},attributes:{},topology:"point-list",mode:0};return yk(a,(h=u.las)===null||h===void 0?void 0:h.skip,(D={},B)=>{var V,P;if(!g){var L;g=B;const te=B.totalToRead,Q=(L=u.las)!==null&&L!==void 0&&L.fp64?Float64Array:Float32Array;M=new Q(te*3),v=B.pointsFormatId>=2?new Uint8Array(te*4):null,y=new Uint16Array(te),p=new Uint8Array(te),C.loaderData=B,C.attributes={POSITION:{value:M,size:3},intensity:{value:y,size:1},classification:{value:p,size:1}},v&&(C.attributes.COLOR_0={value:v,size:4})}const E=D.pointsCount,{scale:[b,_,x],offset:[T,N,U]}=B,H=_k(D,E,(V=u.las)===null||V===void 0?void 0:V.colorDepth);for(let te=0;te<E;te++){const{position:Q,color:Z,intensity:ae,classification:F}=D.getPoint(te);M[R*3]=Q[0]*b+T,M[R*3+1]=Q[1]*_+N,M[R*3+2]=Q[2]*x+U,Z&&v&&(H?(v[R*4]=Z[0]/256,v[R*4+1]=Z[1]/256,v[R*4+2]=Z[2]/256):(v[R*4]=Z[0],v[R*4+1]=Z[1],v[R*4+2]=Z[2]),v[R*4+3]=255),y[R]=ae,p[R]=F,R++}const q={...C,header:{vertexCount:B.totalRead},progress:B.totalRead/B.totalToRead};u==null||(P=u.onProgress)===null||P===void 0||P.call(u,q)}),C.header={vertexCount:g.totalToRead,boundingBox:ZI((C==null?void 0:C.attributes)||{})},C&&(C.schema=mk(C.loaderData,C.attributes)),C}function yk(a,u,h={}){const R=new pk(a);try{R.open();const M=R.getHeader(),v=R.getUnpacker(),y=Math.ceil(M.pointsCount/Math.max(1,u));M.totalToRead=y;let p=0;for(;;){const g=R.readData(1e5,0,u);p+=g.count,M.totalRead=p,M.versionAsString=g.versionAsString,M.isCompressed=g.isCompressed;const C=new v(g.buffer,g.count,M);if(h(C,M),!g.hasMoreData||p>=y)break}}catch(M){throw M}finally{R.close()}}function _k(a={},u,h){let R=!1;switch(h){case 8:R=!1;break;case 16:R=!0;break;case"auto":if(a.getPoint(0).color)for(let M=0;M<u;M++){const{color:v}=a.getPoint(M);(v[0]>255||v[1]>255||v[2]>255)&&(R=!0)}break;default:console.warn("las: illegal value for options.las.colorDepth");break}return R}const JC={...VC,parse:async(a,u)=>$S(a,u),parseSync:(a,u)=>$S(a,u)},xk=JC,Ak=Object.freeze(Object.defineProperty({__proto__:null,LASWorkerLoader:VC,LASLoader:JC,_typecheckLoader:xk},Symbol.toStringTag,{value:"Module"})),wk=Ky(Ak);var QS;function $C(){return QS||(QS=1,function(a){var u=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=v(Dr()),R=wk;function M(p){if(typeof WeakMap!="function")return null;var g=new WeakMap,C=new WeakMap;return(M=function(B){return B?C:g})(p)}function v(p,g){if(!g&&p&&p.__esModule)return p;if(p===null||u(p)!=="object"&&typeof p!="function")return{default:p};var C=M(g);if(C&&C.has(p))return C.get(p);var D={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var V in p)if(V!=="default"&&Object.prototype.hasOwnProperty.call(p,V)){var P=B?Object.getOwnPropertyDescriptor(p,V):null;P&&(P.get||P.set)?Object.defineProperty(D,V,P):D[V]=p[V]}return D.default=p,C&&C.set(p,D),D}var y={parse:function(g){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return C.in=C.in||{},C.out=C.out||{},R.LASLoader.parse(g,{las:{colorDepth:C.in.colorDepth||"auto",skip:C.out.skip||1}}).then(function(D){var B=new h.BufferGeometry;B.userData=D.loaderData,B.userData.vertexCount=D.header.vertexCount,B.userData.boundingBox=D.header.boundingBox;var V=new h.BufferAttribute(D.attributes.POSITION.value,3,!1);B.setAttribute("position",V);var P=new h.BufferAttribute(D.attributes.intensity.value,1,!0);B.setAttribute("intensity",P);var L=new h.BufferAttribute(D.attributes.classification.value,1,!0);if(B.setAttribute("classification",L),D.attributes.COLOR_0){var E=new h.BufferAttribute(D.attributes.COLOR_0.value,4,!0);B.setAttribute("color",E)}return B.computeBoundingBox(),B})}};a.default=y}(pM)),pM}var KS;function Mk(){return KS||(KS=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(kr()),R=u(Ir()),M=u(Wi()),v=u(dn()),y=u(pn()),p=u(ln()),g=u(Jh),C=u($C()),D=u(GC()),B=u(dl()),V=u(pl());function P(_){var x=L();return function(){var T=(0,p.default)(_),N;if(x){var U=(0,p.default)(this).constructor;N=Reflect.construct(T,arguments,U)}else N=T.apply(this,arguments);return(0,y.default)(this,N)}}function L(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var E=function(_){(0,v.default)(T,_);var x=P(T);function T(N){var U;return(0,R.default)(this,T),U=x.call(this,N),U.isEntwinePointTileSource=!0,U.colorDepth=N.colorDepth,U.url=U.url.replace("/ept.json",""),U.whenReady=B.default.json("".concat(U.url,"/ept.json"),U.networkOptions).then(function(H){return U.parse=H.dataType==="laszip"?C.default.parse:D.default.parse,U.extension=H.dataType==="laszip"?"laz":"bin",H.srs&&H.srs.authority&&H.srs.horizontal&&(U.crs="".concat(H.srs.authority,":").concat(H.srs.horizontal),g.default.defs(U.crs)||g.default.defs(U.crs,H.srs.wkt),H.srs.vertical&&H.srs.vertical!==H.srs.horizontal&&console.warn("EntwinePointTileSource: Vertical coordinates system code is not yet supported.")),U.spacing=(Math.abs(H.boundsConforming[3]-H.boundsConforming[0])+Math.abs(H.boundsConforming[4]-H.boundsConforming[1]))/(2*H.span),U.boundsConforming=H.boundsConforming,U.span=H.span,(0,M.default)(U)}),U.fetcher=B.default.arrayBuffer,U}return(0,h.default)(T)}(V.default),b=E;a.default=b}(dM)),dM}var mM={},vM={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var eR;function bk(){return eR||(eR=1,function(a,u){(function(h){a.exports=h()})(function(){return function h(R,M,v){function y(C,D){if(!M[C]){if(!R[C]){var B=typeof If=="function"&&If;if(!D&&B)return B(C,!0);if(p)return p(C,!0);var V=new Error("Cannot find module '"+C+"'");throw V.code="MODULE_NOT_FOUND",V}var P=M[C]={exports:{}};R[C][0].call(P.exports,function(L){var E=R[C][1][L];return y(E||L)},P,P.exports,h,R,M,v)}return M[C].exports}for(var p=typeof If=="function"&&If,g=0;g<v.length;g++)y(v[g]);return y}({1:[function(h,R,M){var v=h("./utils"),y=h("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";M.encode=function(g){for(var C,D,B,V,P,L,E,b=[],_=0,x=g.length,T=x,N=v.getTypeOf(g)!=="string";_<g.length;)T=x-_,B=N?(C=g[_++],D=_<x?g[_++]:0,_<x?g[_++]:0):(C=g.charCodeAt(_++),D=_<x?g.charCodeAt(_++):0,_<x?g.charCodeAt(_++):0),V=C>>2,P=(3&C)<<4|D>>4,L=1<T?(15&D)<<2|B>>6:64,E=2<T?63&B:64,b.push(p.charAt(V)+p.charAt(P)+p.charAt(L)+p.charAt(E));return b.join("")},M.decode=function(g){var C,D,B,V,P,L,E=0,b=0,_="data:";if(g.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var x,T=3*(g=g.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(g.charAt(g.length-1)===p.charAt(64)&&T--,g.charAt(g.length-2)===p.charAt(64)&&T--,T%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=y.uint8array?new Uint8Array(0|T):new Array(0|T);E<g.length;)C=p.indexOf(g.charAt(E++))<<2|(V=p.indexOf(g.charAt(E++)))>>4,D=(15&V)<<4|(P=p.indexOf(g.charAt(E++)))>>2,B=(3&P)<<6|(L=p.indexOf(g.charAt(E++))),x[b++]=C,P!==64&&(x[b++]=D),L!==64&&(x[b++]=B);return x}},{"./support":30,"./utils":32}],2:[function(h,R,M){var v=h("./external"),y=h("./stream/DataWorker"),p=h("./stream/Crc32Probe"),g=h("./stream/DataLengthProbe");function C(D,B,V,P,L){this.compressedSize=D,this.uncompressedSize=B,this.crc32=V,this.compression=P,this.compressedContent=L}C.prototype={getContentWorker:function(){var D=new y(v.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new g("data_length")),B=this;return D.on("end",function(){if(this.streamInfo.data_length!==B.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),D},getCompressedWorker:function(){return new y(v.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},C.createWorkerFrom=function(D,B,V){return D.pipe(new p).pipe(new g("uncompressedSize")).pipe(B.compressWorker(V)).pipe(new g("compressedSize")).withStreamInfo("compression",B)},R.exports=C},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(h,R,M){var v=h("./stream/GenericWorker");M.STORE={magic:"\0\0",compressWorker:function(){return new v("STORE compression")},uncompressWorker:function(){return new v("STORE decompression")}},M.DEFLATE=h("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(h,R,M){var v=h("./utils"),y=function(){for(var p,g=[],C=0;C<256;C++){p=C;for(var D=0;D<8;D++)p=1&p?3988292384^p>>>1:p>>>1;g[C]=p}return g}();R.exports=function(p,g){return p!==void 0&&p.length?v.getTypeOf(p)!=="string"?function(C,D,B,V){var P=y,L=V+B;C^=-1;for(var E=V;E<L;E++)C=C>>>8^P[255&(C^D[E])];return-1^C}(0|g,p,p.length,0):function(C,D,B,V){var P=y,L=V+B;C^=-1;for(var E=V;E<L;E++)C=C>>>8^P[255&(C^D.charCodeAt(E))];return-1^C}(0|g,p,p.length,0):0}},{"./utils":32}],5:[function(h,R,M){M.base64=!1,M.binary=!1,M.dir=!1,M.createFolders=!0,M.date=null,M.compression=null,M.compressionOptions=null,M.comment=null,M.unixPermissions=null,M.dosPermissions=null},{}],6:[function(h,R,M){var v=null;v=typeof Promise<"u"?Promise:h("lie"),R.exports={Promise:v}},{lie:37}],7:[function(h,R,M){var v=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",y=h("pako"),p=h("./utils"),g=h("./stream/GenericWorker"),C=v?"uint8array":"array";function D(B,V){g.call(this,"FlateWorker/"+B),this._pako=null,this._pakoAction=B,this._pakoOptions=V,this.meta={}}M.magic="\b\0",p.inherits(D,g),D.prototype.processChunk=function(B){this.meta=B.meta,this._pako===null&&this._createPako(),this._pako.push(p.transformTo(C,B.data),!1)},D.prototype.flush=function(){g.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},D.prototype.cleanUp=function(){g.prototype.cleanUp.call(this),this._pako=null},D.prototype._createPako=function(){this._pako=new y[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var B=this;this._pako.onData=function(V){B.push({data:V,meta:B.meta})}},M.compressWorker=function(B){return new D("Deflate",B)},M.uncompressWorker=function(){return new D("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(h,R,M){function v(P,L){var E,b="";for(E=0;E<L;E++)b+=String.fromCharCode(255&P),P>>>=8;return b}function y(P,L,E,b,_,x){var T,N,U=P.file,H=P.compression,q=x!==C.utf8encode,te=p.transformTo("string",x(U.name)),Q=p.transformTo("string",C.utf8encode(U.name)),Z=U.comment,ae=p.transformTo("string",x(Z)),F=p.transformTo("string",C.utf8encode(Z)),W=Q.length!==U.name.length,O=F.length!==Z.length,X="",G="",j="",K=U.dir,ce=U.date,se={crc32:0,compressedSize:0,uncompressedSize:0};L&&!E||(se.crc32=P.crc32,se.compressedSize=P.compressedSize,se.uncompressedSize=P.uncompressedSize);var ue=0;L&&(ue|=8),q||!W&&!O||(ue|=2048);var Y=0,pe=0;K&&(Y|=16),_==="UNIX"?(pe=798,Y|=function(Fe,$e){var pt=Fe;return Fe||(pt=$e?16893:33204),(65535&pt)<<16}(U.unixPermissions,K)):(pe=20,Y|=function(Fe){return 63&(Fe||0)}(U.dosPermissions)),T=ce.getUTCHours(),T<<=6,T|=ce.getUTCMinutes(),T<<=5,T|=ce.getUTCSeconds()/2,N=ce.getUTCFullYear()-1980,N<<=4,N|=ce.getUTCMonth()+1,N<<=5,N|=ce.getUTCDate(),W&&(G=v(1,1)+v(D(te),4)+Q,X+="up"+v(G.length,2)+G),O&&(j=v(1,1)+v(D(ae),4)+F,X+="uc"+v(j.length,2)+j);var Ee="";return Ee+=`
\0`,Ee+=v(ue,2),Ee+=H.magic,Ee+=v(T,2),Ee+=v(N,2),Ee+=v(se.crc32,4),Ee+=v(se.compressedSize,4),Ee+=v(se.uncompressedSize,4),Ee+=v(te.length,2),Ee+=v(X.length,2),{fileRecord:B.LOCAL_FILE_HEADER+Ee+te+X,dirRecord:B.CENTRAL_FILE_HEADER+v(pe,2)+Ee+v(ae.length,2)+"\0\0\0\0"+v(Y,4)+v(b,4)+te+X+ae}}var p=h("../utils"),g=h("../stream/GenericWorker"),C=h("../utf8"),D=h("../crc32"),B=h("../signature");function V(P,L,E,b){g.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=L,this.zipPlatform=E,this.encodeFileName=b,this.streamFiles=P,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(V,g),V.prototype.push=function(P){var L=P.meta.percent||0,E=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(P):(this.bytesWritten+=P.data.length,g.prototype.push.call(this,{data:P.data,meta:{currentFile:this.currentFile,percent:E?(L+100*(E-b-1))/E:100}}))},V.prototype.openedSource=function(P){this.currentSourceOffset=this.bytesWritten,this.currentFile=P.file.name;var L=this.streamFiles&&!P.file.dir;if(L){var E=y(P,L,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:E.fileRecord,meta:{percent:0}})}else this.accumulate=!0},V.prototype.closedSource=function(P){this.accumulate=!1;var L=this.streamFiles&&!P.file.dir,E=y(P,L,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(E.dirRecord),L)this.push({data:function(b){return B.DATA_DESCRIPTOR+v(b.crc32,4)+v(b.compressedSize,4)+v(b.uncompressedSize,4)}(P),meta:{percent:100}});else for(this.push({data:E.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},V.prototype.flush=function(){for(var P=this.bytesWritten,L=0;L<this.dirRecords.length;L++)this.push({data:this.dirRecords[L],meta:{percent:100}});var E=this.bytesWritten-P,b=function(_,x,T,N,U){var H=p.transformTo("string",U(N));return B.CENTRAL_DIRECTORY_END+"\0\0\0\0"+v(_,2)+v(_,2)+v(x,4)+v(T,4)+v(H.length,2)+H}(this.dirRecords.length,E,P,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},V.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},V.prototype.registerPrevious=function(P){this._sources.push(P);var L=this;return P.on("data",function(E){L.processChunk(E)}),P.on("end",function(){L.closedSource(L.previous.streamInfo),L._sources.length?L.prepareNextSource():L.end()}),P.on("error",function(E){L.error(E)}),this},V.prototype.resume=function(){return!!g.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},V.prototype.error=function(P){var L=this._sources;if(!g.prototype.error.call(this,P))return!1;for(var E=0;E<L.length;E++)try{L[E].error(P)}catch{}return!0},V.prototype.lock=function(){g.prototype.lock.call(this);for(var P=this._sources,L=0;L<P.length;L++)P[L].lock()},R.exports=V},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(h,R,M){var v=h("../compressions"),y=h("./ZipFileWorker");M.generateWorker=function(p,g,C){var D=new y(g.streamFiles,C,g.platform,g.encodeFileName),B=0;try{p.forEach(function(V,P){B++;var L=function(x,T){var N=x||T,U=v[N];if(!U)throw new Error(N+" is not a valid compression method !");return U}(P.options.compression,g.compression),E=P.options.compressionOptions||g.compressionOptions||{},b=P.dir,_=P.date;P._compressWorker(L,E).withStreamInfo("file",{name:V,dir:b,date:_,comment:P.comment||"",unixPermissions:P.unixPermissions,dosPermissions:P.dosPermissions}).pipe(D)}),D.entriesCount=B}catch(V){D.error(V)}return D}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(h,R,M){function v(){if(!(this instanceof v))return new v;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var y=new v;for(var p in this)typeof this[p]!="function"&&(y[p]=this[p]);return y}}(v.prototype=h("./object")).loadAsync=h("./load"),v.support=h("./support"),v.defaults=h("./defaults"),v.version="3.10.1",v.loadAsync=function(y,p){return new v().loadAsync(y,p)},v.external=h("./external"),R.exports=v},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(h,R,M){var v=h("./utils"),y=h("./external"),p=h("./utf8"),g=h("./zipEntries"),C=h("./stream/Crc32Probe"),D=h("./nodejsUtils");function B(V){return new y.Promise(function(P,L){var E=V.decompressed.getContentWorker().pipe(new C);E.on("error",function(b){L(b)}).on("end",function(){E.streamInfo.crc32!==V.decompressed.crc32?L(new Error("Corrupted zip : CRC32 mismatch")):P()}).resume()})}R.exports=function(V,P){var L=this;return P=v.extend(P||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),D.isNode&&D.isStream(V)?y.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):v.prepareContent("the loaded zip file",V,!0,P.optimizedBinaryString,P.base64).then(function(E){var b=new g(P);return b.load(E),b}).then(function(E){var b=[y.Promise.resolve(E)],_=E.files;if(P.checkCRC32)for(var x=0;x<_.length;x++)b.push(B(_[x]));return y.Promise.all(b)}).then(function(E){for(var b=E.shift(),_=b.files,x=0;x<_.length;x++){var T=_[x],N=T.fileNameStr,U=v.resolve(T.fileNameStr);L.file(U,T.decompressed,{binary:!0,optimizedBinaryString:!0,date:T.date,dir:T.dir,comment:T.fileCommentStr.length?T.fileCommentStr:null,unixPermissions:T.unixPermissions,dosPermissions:T.dosPermissions,createFolders:P.createFolders}),T.dir||(L.file(U).unsafeOriginalName=N)}return b.zipComment.length&&(L.comment=b.zipComment),L})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(h,R,M){var v=h("../utils"),y=h("../stream/GenericWorker");function p(g,C){y.call(this,"Nodejs stream input adapter for "+g),this._upstreamEnded=!1,this._bindStream(C)}v.inherits(p,y),p.prototype._bindStream=function(g){var C=this;(this._stream=g).pause(),g.on("data",function(D){C.push({data:D,meta:{percent:0}})}).on("error",function(D){C.isPaused?this.generatedError=D:C.error(D)}).on("end",function(){C.isPaused?C._upstreamEnded=!0:C.end()})},p.prototype.pause=function(){return!!y.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},R.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(h,R,M){var v=h("readable-stream").Readable;function y(p,g,C){v.call(this,g),this._helper=p;var D=this;p.on("data",function(B,V){D.push(B)||D._helper.pause(),C&&C(V)}).on("error",function(B){D.emit("error",B)}).on("end",function(){D.push(null)})}h("../utils").inherits(y,v),y.prototype._read=function(){this._helper.resume()},R.exports=y},{"../utils":32,"readable-stream":16}],14:[function(h,R,M){R.exports={isNode:typeof Buffer<"u",newBufferFrom:function(v,y){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(v,y);if(typeof v=="number")throw new Error('The "data" argument must not be a number');return new Buffer(v,y)},allocBuffer:function(v){if(Buffer.alloc)return Buffer.alloc(v);var y=new Buffer(v);return y.fill(0),y},isBuffer:function(v){return Buffer.isBuffer(v)},isStream:function(v){return v&&typeof v.on=="function"&&typeof v.pause=="function"&&typeof v.resume=="function"}}},{}],15:[function(h,R,M){function v(U,H,q){var te,Q=p.getTypeOf(H),Z=p.extend(q||{},D);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(U=_(U)),Z.createFolders&&(te=b(U))&&x.call(this,te,!0);var ae=Q==="string"&&Z.binary===!1&&Z.base64===!1;q&&q.binary!==void 0||(Z.binary=!ae),(H instanceof B&&H.uncompressedSize===0||Z.dir||!H||H.length===0)&&(Z.base64=!1,Z.binary=!0,H="",Z.compression="STORE",Q="string");var F=null;F=H instanceof B||H instanceof g?H:L.isNode&&L.isStream(H)?new E(U,H):p.prepareContent(U,H,Z.binary,Z.optimizedBinaryString,Z.base64);var W=new V(U,F,Z);this.files[U]=W}var y=h("./utf8"),p=h("./utils"),g=h("./stream/GenericWorker"),C=h("./stream/StreamHelper"),D=h("./defaults"),B=h("./compressedObject"),V=h("./zipObject"),P=h("./generate"),L=h("./nodejsUtils"),E=h("./nodejs/NodejsStreamInputAdapter"),b=function(U){U.slice(-1)==="/"&&(U=U.substring(0,U.length-1));var H=U.lastIndexOf("/");return 0<H?U.substring(0,H):""},_=function(U){return U.slice(-1)!=="/"&&(U+="/"),U},x=function(U,H){return H=H!==void 0?H:D.createFolders,U=_(U),this.files[U]||v.call(this,U,null,{dir:!0,createFolders:H}),this.files[U]};function T(U){return Object.prototype.toString.call(U)==="[object RegExp]"}var N={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(U){var H,q,te;for(H in this.files)te=this.files[H],(q=H.slice(this.root.length,H.length))&&H.slice(0,this.root.length)===this.root&&U(q,te)},filter:function(U){var H=[];return this.forEach(function(q,te){U(q,te)&&H.push(te)}),H},file:function(U,H,q){if(arguments.length!==1)return U=this.root+U,v.call(this,U,H,q),this;if(T(U)){var te=U;return this.filter(function(Z,ae){return!ae.dir&&te.test(Z)})}var Q=this.files[this.root+U];return Q&&!Q.dir?Q:null},folder:function(U){if(!U)return this;if(T(U))return this.filter(function(Q,Z){return Z.dir&&U.test(Q)});var H=this.root+U,q=x.call(this,H),te=this.clone();return te.root=q.name,te},remove:function(U){U=this.root+U;var H=this.files[U];if(H||(U.slice(-1)!=="/"&&(U+="/"),H=this.files[U]),H&&!H.dir)delete this.files[U];else for(var q=this.filter(function(Q,Z){return Z.name.slice(0,U.length)===U}),te=0;te<q.length;te++)delete this.files[q[te].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(U){var H,q={};try{if((q=p.extend(U||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:y.utf8encode})).type=q.type.toLowerCase(),q.compression=q.compression.toUpperCase(),q.type==="binarystring"&&(q.type="string"),!q.type)throw new Error("No output type specified.");p.checkSupport(q.type),q.platform!=="darwin"&&q.platform!=="freebsd"&&q.platform!=="linux"&&q.platform!=="sunos"||(q.platform="UNIX"),q.platform==="win32"&&(q.platform="DOS");var te=q.comment||this.comment||"";H=P.generateWorker(this,q,te)}catch(Q){(H=new g("error")).error(Q)}return new C(H,q.type||"string",q.mimeType)},generateAsync:function(U,H){return this.generateInternalStream(U).accumulate(H)},generateNodeStream:function(U,H){return(U=U||{}).type||(U.type="nodebuffer"),this.generateInternalStream(U).toNodejsStream(H)}};R.exports=N},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(h,R,M){R.exports=h("stream")},{stream:void 0}],17:[function(h,R,M){var v=h("./DataReader");function y(p){v.call(this,p);for(var g=0;g<this.data.length;g++)p[g]=255&p[g]}h("../utils").inherits(y,v),y.prototype.byteAt=function(p){return this.data[this.zero+p]},y.prototype.lastIndexOfSignature=function(p){for(var g=p.charCodeAt(0),C=p.charCodeAt(1),D=p.charCodeAt(2),B=p.charCodeAt(3),V=this.length-4;0<=V;--V)if(this.data[V]===g&&this.data[V+1]===C&&this.data[V+2]===D&&this.data[V+3]===B)return V-this.zero;return-1},y.prototype.readAndCheckSignature=function(p){var g=p.charCodeAt(0),C=p.charCodeAt(1),D=p.charCodeAt(2),B=p.charCodeAt(3),V=this.readData(4);return g===V[0]&&C===V[1]&&D===V[2]&&B===V[3]},y.prototype.readData=function(p){if(this.checkOffset(p),p===0)return[];var g=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},R.exports=y},{"../utils":32,"./DataReader":18}],18:[function(h,R,M){var v=h("../utils");function y(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}y.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var g,C=0;for(this.checkOffset(p),g=this.index+p-1;g>=this.index;g--)C=(C<<8)+this.byteAt(g);return this.index+=p,C},readString:function(p){return v.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},R.exports=y},{"../utils":32}],19:[function(h,R,M){var v=h("./Uint8ArrayReader");function y(p){v.call(this,p)}h("../utils").inherits(y,v),y.prototype.readData=function(p){this.checkOffset(p);var g=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},R.exports=y},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(h,R,M){var v=h("./DataReader");function y(p){v.call(this,p)}h("../utils").inherits(y,v),y.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},y.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},y.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},y.prototype.readData=function(p){this.checkOffset(p);var g=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},R.exports=y},{"../utils":32,"./DataReader":18}],21:[function(h,R,M){var v=h("./ArrayReader");function y(p){v.call(this,p)}h("../utils").inherits(y,v),y.prototype.readData=function(p){if(this.checkOffset(p),p===0)return new Uint8Array(0);var g=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,g},R.exports=y},{"../utils":32,"./ArrayReader":17}],22:[function(h,R,M){var v=h("../utils"),y=h("../support"),p=h("./ArrayReader"),g=h("./StringReader"),C=h("./NodeBufferReader"),D=h("./Uint8ArrayReader");R.exports=function(B){var V=v.getTypeOf(B);return v.checkSupport(V),V!=="string"||y.uint8array?V==="nodebuffer"?new C(B):y.uint8array?new D(v.transformTo("uint8array",B)):new p(v.transformTo("array",B)):new g(B)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(h,R,M){M.LOCAL_FILE_HEADER="PK",M.CENTRAL_FILE_HEADER="PK",M.CENTRAL_DIRECTORY_END="PK",M.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",M.ZIP64_CENTRAL_DIRECTORY_END="PK",M.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(h,R,M){var v=h("./GenericWorker"),y=h("../utils");function p(g){v.call(this,"ConvertWorker to "+g),this.destType=g}y.inherits(p,v),p.prototype.processChunk=function(g){this.push({data:y.transformTo(this.destType,g.data),meta:g.meta})},R.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(h,R,M){var v=h("./GenericWorker"),y=h("../crc32");function p(){v.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}h("../utils").inherits(p,v),p.prototype.processChunk=function(g){this.streamInfo.crc32=y(g.data,this.streamInfo.crc32||0),this.push(g)},R.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(h,R,M){var v=h("../utils"),y=h("./GenericWorker");function p(g){y.call(this,"DataLengthProbe for "+g),this.propName=g,this.withStreamInfo(g,0)}v.inherits(p,y),p.prototype.processChunk=function(g){if(g){var C=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=C+g.data.length}y.prototype.processChunk.call(this,g)},R.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(h,R,M){var v=h("../utils"),y=h("./GenericWorker");function p(g){y.call(this,"DataWorker");var C=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,g.then(function(D){C.dataIsReady=!0,C.data=D,C.max=D&&D.length||0,C.type=v.getTypeOf(D),C.isPaused||C._tickAndRepeat()},function(D){C.error(D)})}v.inherits(p,y),p.prototype.cleanUp=function(){y.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!y.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,v.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(v.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var g=null,C=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":g=this.data.substring(this.index,C);break;case"uint8array":g=this.data.subarray(this.index,C);break;case"array":case"nodebuffer":g=this.data.slice(this.index,C)}return this.index=C,this.push({data:g,meta:{percent:this.max?this.index/this.max*100:0}})},R.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(h,R,M){function v(y){this.name=y||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}v.prototype={push:function(y){this.emit("data",y)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(y){this.emit("error",y)}return!0},error:function(y){return!this.isFinished&&(this.isPaused?this.generatedError=y:(this.isFinished=!0,this.emit("error",y),this.previous&&this.previous.error(y),this.cleanUp()),!0)},on:function(y,p){return this._listeners[y].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(y,p){if(this._listeners[y])for(var g=0;g<this._listeners[y].length;g++)this._listeners[y][g].call(this,p)},pipe:function(y){return y.registerPrevious(this)},registerPrevious:function(y){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=y.streamInfo,this.mergeStreamInfo(),this.previous=y;var p=this;return y.on("data",function(g){p.processChunk(g)}),y.on("end",function(){p.end()}),y.on("error",function(g){p.error(g)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var y=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),y=!0),this.previous&&this.previous.resume(),!y},flush:function(){},processChunk:function(y){this.push(y)},withStreamInfo:function(y,p){return this.extraStreamInfo[y]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var y in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,y)&&(this.streamInfo[y]=this.extraStreamInfo[y])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var y="Worker "+this.name;return this.previous?this.previous+" -> "+y:y}},R.exports=v},{}],29:[function(h,R,M){var v=h("../utils"),y=h("./ConvertWorker"),p=h("./GenericWorker"),g=h("../base64"),C=h("../support"),D=h("../external"),B=null;if(C.nodestream)try{B=h("../nodejs/NodejsStreamOutputAdapter")}catch{}function V(L,E){return new D.Promise(function(b,_){var x=[],T=L._internalType,N=L._outputType,U=L._mimeType;L.on("data",function(H,q){x.push(H),E&&E(q)}).on("error",function(H){x=[],_(H)}).on("end",function(){try{var H=function(q,te,Q){switch(q){case"blob":return v.newBlob(v.transformTo("arraybuffer",te),Q);case"base64":return g.encode(te);default:return v.transformTo(q,te)}}(N,function(q,te){var Q,Z=0,ae=null,F=0;for(Q=0;Q<te.length;Q++)F+=te[Q].length;switch(q){case"string":return te.join("");case"array":return Array.prototype.concat.apply([],te);case"uint8array":for(ae=new Uint8Array(F),Q=0;Q<te.length;Q++)ae.set(te[Q],Z),Z+=te[Q].length;return ae;case"nodebuffer":return Buffer.concat(te);default:throw new Error("concat : unsupported type '"+q+"'")}}(T,x),U);b(H)}catch(q){_(q)}x=[]}).resume()})}function P(L,E,b){var _=E;switch(E){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=E,this._mimeType=b,v.checkSupport(_),this._worker=L.pipe(new y(_)),L.lock()}catch(x){this._worker=new p("error"),this._worker.error(x)}}P.prototype={accumulate:function(L){return V(this,L)},on:function(L,E){var b=this;return L==="data"?this._worker.on(L,function(_){E.call(b,_.data,_.meta)}):this._worker.on(L,function(){v.delay(E,arguments,b)}),this},resume:function(){return v.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(L){if(v.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new B(this,{objectMode:this._outputType!=="nodebuffer"},L)}},R.exports=P},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(h,R,M){if(M.base64=!0,M.array=!0,M.string=!0,M.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",M.nodebuffer=typeof Buffer<"u",M.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")M.blob=!1;else{var v=new ArrayBuffer(0);try{M.blob=new Blob([v],{type:"application/zip"}).size===0}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);y.append(v),M.blob=y.getBlob("application/zip").size===0}catch{M.blob=!1}}}try{M.nodestream=!!h("readable-stream").Readable}catch{M.nodestream=!1}},{"readable-stream":16}],31:[function(h,R,M){for(var v=h("./utils"),y=h("./support"),p=h("./nodejsUtils"),g=h("./stream/GenericWorker"),C=new Array(256),D=0;D<256;D++)C[D]=252<=D?6:248<=D?5:240<=D?4:224<=D?3:192<=D?2:1;C[254]=C[254]=1;function B(){g.call(this,"utf-8 decode"),this.leftOver=null}function V(){g.call(this,"utf-8 encode")}M.utf8encode=function(P){return y.nodebuffer?p.newBufferFrom(P,"utf-8"):function(L){var E,b,_,x,T,N=L.length,U=0;for(x=0;x<N;x++)(64512&(b=L.charCodeAt(x)))==55296&&x+1<N&&(64512&(_=L.charCodeAt(x+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),x++),U+=b<128?1:b<2048?2:b<65536?3:4;for(E=y.uint8array?new Uint8Array(U):new Array(U),x=T=0;T<U;x++)(64512&(b=L.charCodeAt(x)))==55296&&x+1<N&&(64512&(_=L.charCodeAt(x+1)))==56320&&(b=65536+(b-55296<<10)+(_-56320),x++),b<128?E[T++]=b:(b<2048?E[T++]=192|b>>>6:(b<65536?E[T++]=224|b>>>12:(E[T++]=240|b>>>18,E[T++]=128|b>>>12&63),E[T++]=128|b>>>6&63),E[T++]=128|63&b);return E}(P)},M.utf8decode=function(P){return y.nodebuffer?v.transformTo("nodebuffer",P).toString("utf-8"):function(L){var E,b,_,x,T=L.length,N=new Array(2*T);for(E=b=0;E<T;)if((_=L[E++])<128)N[b++]=_;else if(4<(x=C[_]))N[b++]=65533,E+=x-1;else{for(_&=x===2?31:x===3?15:7;1<x&&E<T;)_=_<<6|63&L[E++],x--;1<x?N[b++]=65533:_<65536?N[b++]=_:(_-=65536,N[b++]=55296|_>>10&1023,N[b++]=56320|1023&_)}return N.length!==b&&(N.subarray?N=N.subarray(0,b):N.length=b),v.applyFromCharCode(N)}(P=v.transformTo(y.uint8array?"uint8array":"array",P))},v.inherits(B,g),B.prototype.processChunk=function(P){var L=v.transformTo(y.uint8array?"uint8array":"array",P.data);if(this.leftOver&&this.leftOver.length){if(y.uint8array){var E=L;(L=new Uint8Array(E.length+this.leftOver.length)).set(this.leftOver,0),L.set(E,this.leftOver.length)}else L=this.leftOver.concat(L);this.leftOver=null}var b=function(x,T){var N;for((T=T||x.length)>x.length&&(T=x.length),N=T-1;0<=N&&(192&x[N])==128;)N--;return N<0||N===0?T:N+C[x[N]]>T?N:T}(L),_=L;b!==L.length&&(y.uint8array?(_=L.subarray(0,b),this.leftOver=L.subarray(b,L.length)):(_=L.slice(0,b),this.leftOver=L.slice(b,L.length))),this.push({data:M.utf8decode(_),meta:P.meta})},B.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:M.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},M.Utf8DecodeWorker=B,v.inherits(V,g),V.prototype.processChunk=function(P){this.push({data:M.utf8encode(P.data),meta:P.meta})},M.Utf8EncodeWorker=V},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(h,R,M){var v=h("./support"),y=h("./base64"),p=h("./nodejsUtils"),g=h("./external");function C(E){return E}function D(E,b){for(var _=0;_<E.length;++_)b[_]=255&E.charCodeAt(_);return b}h("setimmediate"),M.newBlob=function(E,b){M.checkSupport("blob");try{return new Blob([E],{type:b})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(E),_.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var B={stringifyByChunk:function(E,b,_){var x=[],T=0,N=E.length;if(N<=_)return String.fromCharCode.apply(null,E);for(;T<N;)b==="array"||b==="nodebuffer"?x.push(String.fromCharCode.apply(null,E.slice(T,Math.min(T+_,N)))):x.push(String.fromCharCode.apply(null,E.subarray(T,Math.min(T+_,N)))),T+=_;return x.join("")},stringifyByChar:function(E){for(var b="",_=0;_<E.length;_++)b+=String.fromCharCode(E[_]);return b},applyCanBeUsed:{uint8array:function(){try{return v.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return v.nodebuffer&&String.fromCharCode.apply(null,p.allocBuffer(1)).length===1}catch{return!1}}()}};function V(E){var b=65536,_=M.getTypeOf(E),x=!0;if(_==="uint8array"?x=B.applyCanBeUsed.uint8array:_==="nodebuffer"&&(x=B.applyCanBeUsed.nodebuffer),x)for(;1<b;)try{return B.stringifyByChunk(E,_,b)}catch{b=Math.floor(b/2)}return B.stringifyByChar(E)}function P(E,b){for(var _=0;_<E.length;_++)b[_]=E[_];return b}M.applyFromCharCode=V;var L={};L.string={string:C,array:function(E){return D(E,new Array(E.length))},arraybuffer:function(E){return L.string.uint8array(E).buffer},uint8array:function(E){return D(E,new Uint8Array(E.length))},nodebuffer:function(E){return D(E,p.allocBuffer(E.length))}},L.array={string:V,array:C,arraybuffer:function(E){return new Uint8Array(E).buffer},uint8array:function(E){return new Uint8Array(E)},nodebuffer:function(E){return p.newBufferFrom(E)}},L.arraybuffer={string:function(E){return V(new Uint8Array(E))},array:function(E){return P(new Uint8Array(E),new Array(E.byteLength))},arraybuffer:C,uint8array:function(E){return new Uint8Array(E)},nodebuffer:function(E){return p.newBufferFrom(new Uint8Array(E))}},L.uint8array={string:V,array:function(E){return P(E,new Array(E.length))},arraybuffer:function(E){return E.buffer},uint8array:C,nodebuffer:function(E){return p.newBufferFrom(E)}},L.nodebuffer={string:V,array:function(E){return P(E,new Array(E.length))},arraybuffer:function(E){return L.nodebuffer.uint8array(E).buffer},uint8array:function(E){return P(E,new Uint8Array(E.length))},nodebuffer:C},M.transformTo=function(E,b){if(b=b||"",!E)return b;M.checkSupport(E);var _=M.getTypeOf(b);return L[_][E](b)},M.resolve=function(E){for(var b=E.split("/"),_=[],x=0;x<b.length;x++){var T=b[x];T==="."||T===""&&x!==0&&x!==b.length-1||(T===".."?_.pop():_.push(T))}return _.join("/")},M.getTypeOf=function(E){return typeof E=="string"?"string":Object.prototype.toString.call(E)==="[object Array]"?"array":v.nodebuffer&&p.isBuffer(E)?"nodebuffer":v.uint8array&&E instanceof Uint8Array?"uint8array":v.arraybuffer&&E instanceof ArrayBuffer?"arraybuffer":void 0},M.checkSupport=function(E){if(!v[E.toLowerCase()])throw new Error(E+" is not supported by this platform")},M.MAX_VALUE_16BITS=65535,M.MAX_VALUE_32BITS=-1,M.pretty=function(E){var b,_,x="";for(_=0;_<(E||"").length;_++)x+="\\x"+((b=E.charCodeAt(_))<16?"0":"")+b.toString(16).toUpperCase();return x},M.delay=function(E,b,_){setImmediate(function(){E.apply(_||null,b||[])})},M.inherits=function(E,b){function _(){}_.prototype=b.prototype,E.prototype=new _},M.extend=function(){var E,b,_={};for(E=0;E<arguments.length;E++)for(b in arguments[E])Object.prototype.hasOwnProperty.call(arguments[E],b)&&_[b]===void 0&&(_[b]=arguments[E][b]);return _},M.prepareContent=function(E,b,_,x,T){return g.Promise.resolve(b).then(function(N){return v.blob&&(N instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(N))!==-1)&&typeof FileReader<"u"?new g.Promise(function(U,H){var q=new FileReader;q.onload=function(te){U(te.target.result)},q.onerror=function(te){H(te.target.error)},q.readAsArrayBuffer(N)}):N}).then(function(N){var U=M.getTypeOf(N);return U?(U==="arraybuffer"?N=M.transformTo("uint8array",N):U==="string"&&(T?N=y.decode(N):_&&x!==!0&&(N=function(H){return D(H,v.uint8array?new Uint8Array(H.length):new Array(H.length))}(N))),N):g.Promise.reject(new Error("Can't read the data of '"+E+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(h,R,M){var v=h("./reader/readerFor"),y=h("./utils"),p=h("./signature"),g=h("./zipEntry"),C=h("./support");function D(B){this.files=[],this.loadOptions=B}D.prototype={checkSignature:function(B){if(!this.reader.readAndCheckSignature(B)){this.reader.index-=4;var V=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+y.pretty(V)+", expected "+y.pretty(B)+")")}},isSignature:function(B,V){var P=this.reader.index;this.reader.setIndex(B);var L=this.reader.readString(4)===V;return this.reader.setIndex(P),L},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var B=this.reader.readData(this.zipCommentLength),V=C.uint8array?"uint8array":"array",P=y.transformTo(V,B);this.zipComment=this.loadOptions.decodeFileName(P)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var B,V,P,L=this.zip64EndOfCentralSize-44;0<L;)B=this.reader.readInt(2),V=this.reader.readInt(4),P=this.reader.readData(V),this.zip64ExtensibleData[B]={id:B,length:V,value:P}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var B,V;for(B=0;B<this.files.length;B++)V=this.files[B],this.reader.setIndex(V.localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),V.readLocalPart(this.reader),V.handleUTF8(),V.processAttributes()},readCentralDir:function(){var B;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(B=new g({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(B);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var B=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(B<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(B);var V=B;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===y.MAX_VALUE_16BITS||this.diskWithCentralDirStart===y.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===y.MAX_VALUE_16BITS||this.centralDirRecords===y.MAX_VALUE_16BITS||this.centralDirSize===y.MAX_VALUE_32BITS||this.centralDirOffset===y.MAX_VALUE_32BITS){if(this.zip64=!0,(B=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(B),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var P=this.centralDirOffset+this.centralDirSize;this.zip64&&(P+=20,P+=12+this.zip64EndOfCentralSize);var L=V-P;if(0<L)this.isSignature(V,p.CENTRAL_FILE_HEADER)||(this.reader.zero=L);else if(L<0)throw new Error("Corrupted zip: missing "+Math.abs(L)+" bytes.")},prepareReader:function(B){this.reader=v(B)},load:function(B){this.prepareReader(B),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},R.exports=D},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(h,R,M){var v=h("./reader/readerFor"),y=h("./utils"),p=h("./compressedObject"),g=h("./crc32"),C=h("./utf8"),D=h("./compressions"),B=h("./support");function V(P,L){this.options=P,this.loadOptions=L}V.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(P){var L,E;if(P.skip(22),this.fileNameLength=P.readInt(2),E=P.readInt(2),this.fileName=P.readData(this.fileNameLength),P.skip(E),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((L=function(b){for(var _ in D)if(Object.prototype.hasOwnProperty.call(D,_)&&D[_].magic===b)return D[_];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+y.pretty(this.compressionMethod)+" unknown (inner file : "+y.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,L,P.readData(this.compressedSize))},readCentralPart:function(P){this.versionMadeBy=P.readInt(2),P.skip(2),this.bitFlag=P.readInt(2),this.compressionMethod=P.readString(2),this.date=P.readDate(),this.crc32=P.readInt(4),this.compressedSize=P.readInt(4),this.uncompressedSize=P.readInt(4);var L=P.readInt(2);if(this.extraFieldsLength=P.readInt(2),this.fileCommentLength=P.readInt(2),this.diskNumberStart=P.readInt(2),this.internalFileAttributes=P.readInt(2),this.externalFileAttributes=P.readInt(4),this.localHeaderOffset=P.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");P.skip(L),this.readExtraFields(P),this.parseZIP64ExtraField(P),this.fileComment=P.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var P=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),P==0&&(this.dosPermissions=63&this.externalFileAttributes),P==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var P=v(this.extraFields[1].value);this.uncompressedSize===y.MAX_VALUE_32BITS&&(this.uncompressedSize=P.readInt(8)),this.compressedSize===y.MAX_VALUE_32BITS&&(this.compressedSize=P.readInt(8)),this.localHeaderOffset===y.MAX_VALUE_32BITS&&(this.localHeaderOffset=P.readInt(8)),this.diskNumberStart===y.MAX_VALUE_32BITS&&(this.diskNumberStart=P.readInt(4))}},readExtraFields:function(P){var L,E,b,_=P.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});P.index+4<_;)L=P.readInt(2),E=P.readInt(2),b=P.readData(E),this.extraFields[L]={id:L,length:E,value:b};P.setIndex(_)},handleUTF8:function(){var P=B.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=C.utf8decode(this.fileName),this.fileCommentStr=C.utf8decode(this.fileComment);else{var L=this.findExtraFieldUnicodePath();if(L!==null)this.fileNameStr=L;else{var E=y.transformTo(P,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(E)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var _=y.transformTo(P,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var P=this.extraFields[28789];if(P){var L=v(P.value);return L.readInt(1)!==1||g(this.fileName)!==L.readInt(4)?null:C.utf8decode(L.readData(P.length-5))}return null},findExtraFieldUnicodeComment:function(){var P=this.extraFields[25461];if(P){var L=v(P.value);return L.readInt(1)!==1||g(this.fileComment)!==L.readInt(4)?null:C.utf8decode(L.readData(P.length-5))}return null}},R.exports=V},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(h,R,M){function v(L,E,b){this.name=L,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=E,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var y=h("./stream/StreamHelper"),p=h("./stream/DataWorker"),g=h("./utf8"),C=h("./compressedObject"),D=h("./stream/GenericWorker");v.prototype={internalStream:function(L){var E=null,b="string";try{if(!L)throw new Error("No output type specified.");var _=(b=L.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),E=this._decompressWorker();var x=!this._dataBinary;x&&!_&&(E=E.pipe(new g.Utf8EncodeWorker)),!x&&_&&(E=E.pipe(new g.Utf8DecodeWorker))}catch(T){(E=new D("error")).error(T)}return new y(E,b,"")},async:function(L,E){return this.internalStream(L).accumulate(E)},nodeStream:function(L,E){return this.internalStream(L||"nodebuffer").toNodejsStream(E)},_compressWorker:function(L,E){if(this._data instanceof C&&this._data.compression.magic===L.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new g.Utf8EncodeWorker)),C.createWorkerFrom(b,L,E)},_decompressWorker:function(){return this._data instanceof C?this._data.getContentWorker():this._data instanceof D?this._data:new p(this._data)}};for(var B=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],V=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},P=0;P<B.length;P++)v.prototype[B[P]]=V;R.exports=v},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(h,R,M){(function(v){var y,p,g=v.MutationObserver||v.WebKitMutationObserver;if(g){var C=0,D=new g(L),B=v.document.createTextNode("");D.observe(B,{characterData:!0}),y=function(){B.data=C=++C%2}}else if(v.setImmediate||v.MessageChannel===void 0)y="document"in v&&"onreadystatechange"in v.document.createElement("script")?function(){var E=v.document.createElement("script");E.onreadystatechange=function(){L(),E.onreadystatechange=null,E.parentNode.removeChild(E),E=null},v.document.documentElement.appendChild(E)}:function(){setTimeout(L,0)};else{var V=new v.MessageChannel;V.port1.onmessage=L,y=function(){V.port2.postMessage(0)}}var P=[];function L(){var E,b;p=!0;for(var _=P.length;_;){for(b=P,P=[],E=-1;++E<_;)b[E]();_=P.length}p=!1}R.exports=function(E){P.push(E)!==1||p||y()}}).call(this,typeof ua<"u"?ua:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(h,R,M){var v=h("immediate");function y(){}var p={},g=["REJECTED"],C=["FULFILLED"],D=["PENDING"];function B(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=D,this.queue=[],this.outcome=void 0,_!==y&&E(this,_)}function V(_,x,T){this.promise=_,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof T=="function"&&(this.onRejected=T,this.callRejected=this.otherCallRejected)}function P(_,x,T){v(function(){var N;try{N=x(T)}catch(U){return p.reject(_,U)}N===_?p.reject(_,new TypeError("Cannot resolve promise with itself")):p.resolve(_,N)})}function L(_){var x=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof x=="function")return function(){x.apply(_,arguments)}}function E(_,x){var T=!1;function N(q){T||(T=!0,p.reject(_,q))}function U(q){T||(T=!0,p.resolve(_,q))}var H=b(function(){x(U,N)});H.status==="error"&&N(H.value)}function b(_,x){var T={};try{T.value=_(x),T.status="success"}catch(N){T.status="error",T.value=N}return T}(R.exports=B).prototype.finally=function(_){if(typeof _!="function")return this;var x=this.constructor;return this.then(function(T){return x.resolve(_()).then(function(){return T})},function(T){return x.resolve(_()).then(function(){throw T})})},B.prototype.catch=function(_){return this.then(null,_)},B.prototype.then=function(_,x){if(typeof _!="function"&&this.state===C||typeof x!="function"&&this.state===g)return this;var T=new this.constructor(y);return this.state!==D?P(T,this.state===C?_:x,this.outcome):this.queue.push(new V(T,_,x)),T},V.prototype.callFulfilled=function(_){p.resolve(this.promise,_)},V.prototype.otherCallFulfilled=function(_){P(this.promise,this.onFulfilled,_)},V.prototype.callRejected=function(_){p.reject(this.promise,_)},V.prototype.otherCallRejected=function(_){P(this.promise,this.onRejected,_)},p.resolve=function(_,x){var T=b(L,x);if(T.status==="error")return p.reject(_,T.value);var N=T.value;if(N)E(_,N);else{_.state=C,_.outcome=x;for(var U=-1,H=_.queue.length;++U<H;)_.queue[U].callFulfilled(x)}return _},p.reject=function(_,x){_.state=g,_.outcome=x;for(var T=-1,N=_.queue.length;++T<N;)_.queue[T].callRejected(x);return _},B.resolve=function(_){return _ instanceof this?_:p.resolve(new this(y),_)},B.reject=function(_){var x=new this(y);return p.reject(x,_)},B.all=function(_){var x=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=_.length,N=!1;if(!T)return this.resolve([]);for(var U=new Array(T),H=0,q=-1,te=new this(y);++q<T;)Q(_[q],q);return te;function Q(Z,ae){x.resolve(Z).then(function(F){U[ae]=F,++H!==T||N||(N=!0,p.resolve(te,U))},function(F){N||(N=!0,p.reject(te,F))})}},B.race=function(_){var x=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var T=_.length,N=!1;if(!T)return this.resolve([]);for(var U=-1,H=new this(y);++U<T;)q=_[U],x.resolve(q).then(function(te){N||(N=!0,p.resolve(H,te))},function(te){N||(N=!0,p.reject(H,te))});var q;return H}},{immediate:36}],38:[function(h,R,M){var v={};(0,h("./lib/utils/common").assign)(v,h("./lib/deflate"),h("./lib/inflate"),h("./lib/zlib/constants")),R.exports=v},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(h,R,M){var v=h("./zlib/deflate"),y=h("./utils/common"),p=h("./utils/strings"),g=h("./zlib/messages"),C=h("./zlib/zstream"),D=Object.prototype.toString,B=0,V=-1,P=0,L=8;function E(_){if(!(this instanceof E))return new E(_);this.options=y.assign({level:V,method:L,chunkSize:16384,windowBits:15,memLevel:8,strategy:P,to:""},_||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new C,this.strm.avail_out=0;var T=v.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(T!==B)throw new Error(g[T]);if(x.header&&v.deflateSetHeader(this.strm,x.header),x.dictionary){var N;if(N=typeof x.dictionary=="string"?p.string2buf(x.dictionary):D.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(T=v.deflateSetDictionary(this.strm,N))!==B)throw new Error(g[T]);this._dict_set=!0}}function b(_,x){var T=new E(x);if(T.push(_,!0),T.err)throw T.msg||g[T.err];return T.result}E.prototype.push=function(_,x){var T,N,U=this.strm,H=this.options.chunkSize;if(this.ended)return!1;N=x===~~x?x:x===!0?4:0,typeof _=="string"?U.input=p.string2buf(_):D.call(_)==="[object ArrayBuffer]"?U.input=new Uint8Array(_):U.input=_,U.next_in=0,U.avail_in=U.input.length;do{if(U.avail_out===0&&(U.output=new y.Buf8(H),U.next_out=0,U.avail_out=H),(T=v.deflate(U,N))!==1&&T!==B)return this.onEnd(T),!(this.ended=!0);U.avail_out!==0&&(U.avail_in!==0||N!==4&&N!==2)||(this.options.to==="string"?this.onData(p.buf2binstring(y.shrinkBuf(U.output,U.next_out))):this.onData(y.shrinkBuf(U.output,U.next_out)))}while((0<U.avail_in||U.avail_out===0)&&T!==1);return N===4?(T=v.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===B):N!==2||(this.onEnd(B),!(U.avail_out=0))},E.prototype.onData=function(_){this.chunks.push(_)},E.prototype.onEnd=function(_){_===B&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},M.Deflate=E,M.deflate=b,M.deflateRaw=function(_,x){return(x=x||{}).raw=!0,b(_,x)},M.gzip=function(_,x){return(x=x||{}).gzip=!0,b(_,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(h,R,M){var v=h("./zlib/inflate"),y=h("./utils/common"),p=h("./utils/strings"),g=h("./zlib/constants"),C=h("./zlib/messages"),D=h("./zlib/zstream"),B=h("./zlib/gzheader"),V=Object.prototype.toString;function P(E){if(!(this instanceof P))return new P(E);this.options=y.assign({chunkSize:16384,windowBits:0,to:""},E||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||E&&E.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&(15&b.windowBits)==0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var _=v.inflateInit2(this.strm,b.windowBits);if(_!==g.Z_OK)throw new Error(C[_]);this.header=new B,v.inflateGetHeader(this.strm,this.header)}function L(E,b){var _=new P(b);if(_.push(E,!0),_.err)throw _.msg||C[_.err];return _.result}P.prototype.push=function(E,b){var _,x,T,N,U,H,q=this.strm,te=this.options.chunkSize,Q=this.options.dictionary,Z=!1;if(this.ended)return!1;x=b===~~b?b:b===!0?g.Z_FINISH:g.Z_NO_FLUSH,typeof E=="string"?q.input=p.binstring2buf(E):V.call(E)==="[object ArrayBuffer]"?q.input=new Uint8Array(E):q.input=E,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new y.Buf8(te),q.next_out=0,q.avail_out=te),(_=v.inflate(q,g.Z_NO_FLUSH))===g.Z_NEED_DICT&&Q&&(H=typeof Q=="string"?p.string2buf(Q):V.call(Q)==="[object ArrayBuffer]"?new Uint8Array(Q):Q,_=v.inflateSetDictionary(this.strm,H)),_===g.Z_BUF_ERROR&&Z===!0&&(_=g.Z_OK,Z=!1),_!==g.Z_STREAM_END&&_!==g.Z_OK)return this.onEnd(_),!(this.ended=!0);q.next_out&&(q.avail_out!==0&&_!==g.Z_STREAM_END&&(q.avail_in!==0||x!==g.Z_FINISH&&x!==g.Z_SYNC_FLUSH)||(this.options.to==="string"?(T=p.utf8border(q.output,q.next_out),N=q.next_out-T,U=p.buf2string(q.output,T),q.next_out=N,q.avail_out=te-N,N&&y.arraySet(q.output,q.output,T,N,0),this.onData(U)):this.onData(y.shrinkBuf(q.output,q.next_out)))),q.avail_in===0&&q.avail_out===0&&(Z=!0)}while((0<q.avail_in||q.avail_out===0)&&_!==g.Z_STREAM_END);return _===g.Z_STREAM_END&&(x=g.Z_FINISH),x===g.Z_FINISH?(_=v.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===g.Z_OK):x!==g.Z_SYNC_FLUSH||(this.onEnd(g.Z_OK),!(q.avail_out=0))},P.prototype.onData=function(E){this.chunks.push(E)},P.prototype.onEnd=function(E){E===g.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},M.Inflate=P,M.inflate=L,M.inflateRaw=function(E,b){return(b=b||{}).raw=!0,L(E,b)},M.ungzip=L},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(h,R,M){var v=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";M.assign=function(g){for(var C=Array.prototype.slice.call(arguments,1);C.length;){var D=C.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var B in D)D.hasOwnProperty(B)&&(g[B]=D[B])}}return g},M.shrinkBuf=function(g,C){return g.length===C?g:g.subarray?g.subarray(0,C):(g.length=C,g)};var y={arraySet:function(g,C,D,B,V){if(C.subarray&&g.subarray)g.set(C.subarray(D,D+B),V);else for(var P=0;P<B;P++)g[V+P]=C[D+P]},flattenChunks:function(g){var C,D,B,V,P,L;for(C=B=0,D=g.length;C<D;C++)B+=g[C].length;for(L=new Uint8Array(B),C=V=0,D=g.length;C<D;C++)P=g[C],L.set(P,V),V+=P.length;return L}},p={arraySet:function(g,C,D,B,V){for(var P=0;P<B;P++)g[V+P]=C[D+P]},flattenChunks:function(g){return[].concat.apply([],g)}};M.setTyped=function(g){g?(M.Buf8=Uint8Array,M.Buf16=Uint16Array,M.Buf32=Int32Array,M.assign(M,y)):(M.Buf8=Array,M.Buf16=Array,M.Buf32=Array,M.assign(M,p))},M.setTyped(v)},{}],42:[function(h,R,M){var v=h("./common"),y=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch{y=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{p=!1}for(var g=new v.Buf8(256),C=0;C<256;C++)g[C]=252<=C?6:248<=C?5:240<=C?4:224<=C?3:192<=C?2:1;function D(B,V){if(V<65537&&(B.subarray&&p||!B.subarray&&y))return String.fromCharCode.apply(null,v.shrinkBuf(B,V));for(var P="",L=0;L<V;L++)P+=String.fromCharCode(B[L]);return P}g[254]=g[254]=1,M.string2buf=function(B){var V,P,L,E,b,_=B.length,x=0;for(E=0;E<_;E++)(64512&(P=B.charCodeAt(E)))==55296&&E+1<_&&(64512&(L=B.charCodeAt(E+1)))==56320&&(P=65536+(P-55296<<10)+(L-56320),E++),x+=P<128?1:P<2048?2:P<65536?3:4;for(V=new v.Buf8(x),E=b=0;b<x;E++)(64512&(P=B.charCodeAt(E)))==55296&&E+1<_&&(64512&(L=B.charCodeAt(E+1)))==56320&&(P=65536+(P-55296<<10)+(L-56320),E++),P<128?V[b++]=P:(P<2048?V[b++]=192|P>>>6:(P<65536?V[b++]=224|P>>>12:(V[b++]=240|P>>>18,V[b++]=128|P>>>12&63),V[b++]=128|P>>>6&63),V[b++]=128|63&P);return V},M.buf2binstring=function(B){return D(B,B.length)},M.binstring2buf=function(B){for(var V=new v.Buf8(B.length),P=0,L=V.length;P<L;P++)V[P]=B.charCodeAt(P);return V},M.buf2string=function(B,V){var P,L,E,b,_=V||B.length,x=new Array(2*_);for(P=L=0;P<_;)if((E=B[P++])<128)x[L++]=E;else if(4<(b=g[E]))x[L++]=65533,P+=b-1;else{for(E&=b===2?31:b===3?15:7;1<b&&P<_;)E=E<<6|63&B[P++],b--;1<b?x[L++]=65533:E<65536?x[L++]=E:(E-=65536,x[L++]=55296|E>>10&1023,x[L++]=56320|1023&E)}return D(x,L)},M.utf8border=function(B,V){var P;for((V=V||B.length)>B.length&&(V=B.length),P=V-1;0<=P&&(192&B[P])==128;)P--;return P<0||P===0?V:P+g[B[P]]>V?P:V}},{"./common":41}],43:[function(h,R,M){R.exports=function(v,y,p,g){for(var C=65535&v|0,D=v>>>16&65535|0,B=0;p!==0;){for(p-=B=2e3<p?2e3:p;D=D+(C=C+y[g++]|0)|0,--B;);C%=65521,D%=65521}return C|D<<16|0}},{}],44:[function(h,R,M){R.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(h,R,M){var v=function(){for(var y,p=[],g=0;g<256;g++){y=g;for(var C=0;C<8;C++)y=1&y?3988292384^y>>>1:y>>>1;p[g]=y}return p}();R.exports=function(y,p,g,C){var D=v,B=C+g;y^=-1;for(var V=C;V<B;V++)y=y>>>8^D[255&(y^p[V])];return-1^y}},{}],46:[function(h,R,M){var v,y=h("../utils/common"),p=h("./trees"),g=h("./adler32"),C=h("./crc32"),D=h("./messages"),B=0,V=4,P=0,L=-2,E=-1,b=4,_=2,x=8,T=9,N=286,U=30,H=19,q=2*N+1,te=15,Q=3,Z=258,ae=Z+Q+1,F=42,W=113,O=1,X=2,G=3,j=4;function K(ye,Ze){return ye.msg=D[Ze],Ze}function ce(ye){return(ye<<1)-(4<ye?9:0)}function se(ye){for(var Ze=ye.length;0<=--Ze;)ye[Ze]=0}function ue(ye){var Ze=ye.state,Ge=Ze.pending;Ge>ye.avail_out&&(Ge=ye.avail_out),Ge!==0&&(y.arraySet(ye.output,Ze.pending_buf,Ze.pending_out,Ge,ye.next_out),ye.next_out+=Ge,Ze.pending_out+=Ge,ye.total_out+=Ge,ye.avail_out-=Ge,Ze.pending-=Ge,Ze.pending===0&&(Ze.pending_out=0))}function Y(ye,Ze){p._tr_flush_block(ye,0<=ye.block_start?ye.block_start:-1,ye.strstart-ye.block_start,Ze),ye.block_start=ye.strstart,ue(ye.strm)}function pe(ye,Ze){ye.pending_buf[ye.pending++]=Ze}function Ee(ye,Ze){ye.pending_buf[ye.pending++]=Ze>>>8&255,ye.pending_buf[ye.pending++]=255&Ze}function Fe(ye,Ze){var Ge,Ae,Se=ye.max_chain_length,Te=ye.strstart,me=ye.prev_length,be=ye.nice_match,we=ye.strstart>ye.w_size-ae?ye.strstart-(ye.w_size-ae):0,je=ye.window,lt=ye.w_mask,ot=ye.prev,bt=ye.strstart+Z,Ie=je[Te+me-1],re=je[Te+me];ye.prev_length>=ye.good_match&&(Se>>=2),be>ye.lookahead&&(be=ye.lookahead);do if(je[(Ge=Ze)+me]===re&&je[Ge+me-1]===Ie&&je[Ge]===je[Te]&&je[++Ge]===je[Te+1]){Te+=2,Ge++;do;while(je[++Te]===je[++Ge]&&je[++Te]===je[++Ge]&&je[++Te]===je[++Ge]&&je[++Te]===je[++Ge]&&je[++Te]===je[++Ge]&&je[++Te]===je[++Ge]&&je[++Te]===je[++Ge]&&je[++Te]===je[++Ge]&&Te<bt);if(Ae=Z-(bt-Te),Te=bt-Z,me<Ae){if(ye.match_start=Ze,be<=(me=Ae))break;Ie=je[Te+me-1],re=je[Te+me]}}while((Ze=ot[Ze&lt])>we&&--Se!=0);return me<=ye.lookahead?me:ye.lookahead}function $e(ye){var Ze,Ge,Ae,Se,Te,me,be,we,je,lt,ot=ye.w_size;do{if(Se=ye.window_size-ye.lookahead-ye.strstart,ye.strstart>=ot+(ot-ae)){for(y.arraySet(ye.window,ye.window,ot,ot,0),ye.match_start-=ot,ye.strstart-=ot,ye.block_start-=ot,Ze=Ge=ye.hash_size;Ae=ye.head[--Ze],ye.head[Ze]=ot<=Ae?Ae-ot:0,--Ge;);for(Ze=Ge=ot;Ae=ye.prev[--Ze],ye.prev[Ze]=ot<=Ae?Ae-ot:0,--Ge;);Se+=ot}if(ye.strm.avail_in===0)break;if(me=ye.strm,be=ye.window,we=ye.strstart+ye.lookahead,je=Se,lt=void 0,lt=me.avail_in,je<lt&&(lt=je),Ge=lt===0?0:(me.avail_in-=lt,y.arraySet(be,me.input,me.next_in,lt,we),me.state.wrap===1?me.adler=g(me.adler,be,lt,we):me.state.wrap===2&&(me.adler=C(me.adler,be,lt,we)),me.next_in+=lt,me.total_in+=lt,lt),ye.lookahead+=Ge,ye.lookahead+ye.insert>=Q)for(Te=ye.strstart-ye.insert,ye.ins_h=ye.window[Te],ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[Te+1])&ye.hash_mask;ye.insert&&(ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[Te+Q-1])&ye.hash_mask,ye.prev[Te&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=Te,Te++,ye.insert--,!(ye.lookahead+ye.insert<Q)););}while(ye.lookahead<ae&&ye.strm.avail_in!==0)}function pt(ye,Ze){for(var Ge,Ae;;){if(ye.lookahead<ae){if($e(ye),ye.lookahead<ae&&Ze===B)return O;if(ye.lookahead===0)break}if(Ge=0,ye.lookahead>=Q&&(ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[ye.strstart+Q-1])&ye.hash_mask,Ge=ye.prev[ye.strstart&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=ye.strstart),Ge!==0&&ye.strstart-Ge<=ye.w_size-ae&&(ye.match_length=Fe(ye,Ge)),ye.match_length>=Q)if(Ae=p._tr_tally(ye,ye.strstart-ye.match_start,ye.match_length-Q),ye.lookahead-=ye.match_length,ye.match_length<=ye.max_lazy_match&&ye.lookahead>=Q){for(ye.match_length--;ye.strstart++,ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[ye.strstart+Q-1])&ye.hash_mask,Ge=ye.prev[ye.strstart&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=ye.strstart,--ye.match_length!=0;);ye.strstart++}else ye.strstart+=ye.match_length,ye.match_length=0,ye.ins_h=ye.window[ye.strstart],ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[ye.strstart+1])&ye.hash_mask;else Ae=p._tr_tally(ye,0,ye.window[ye.strstart]),ye.lookahead--,ye.strstart++;if(Ae&&(Y(ye,!1),ye.strm.avail_out===0))return O}return ye.insert=ye.strstart<Q-1?ye.strstart:Q-1,Ze===V?(Y(ye,!0),ye.strm.avail_out===0?G:j):ye.last_lit&&(Y(ye,!1),ye.strm.avail_out===0)?O:X}function Ue(ye,Ze){for(var Ge,Ae,Se;;){if(ye.lookahead<ae){if($e(ye),ye.lookahead<ae&&Ze===B)return O;if(ye.lookahead===0)break}if(Ge=0,ye.lookahead>=Q&&(ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[ye.strstart+Q-1])&ye.hash_mask,Ge=ye.prev[ye.strstart&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=ye.strstart),ye.prev_length=ye.match_length,ye.prev_match=ye.match_start,ye.match_length=Q-1,Ge!==0&&ye.prev_length<ye.max_lazy_match&&ye.strstart-Ge<=ye.w_size-ae&&(ye.match_length=Fe(ye,Ge),ye.match_length<=5&&(ye.strategy===1||ye.match_length===Q&&4096<ye.strstart-ye.match_start)&&(ye.match_length=Q-1)),ye.prev_length>=Q&&ye.match_length<=ye.prev_length){for(Se=ye.strstart+ye.lookahead-Q,Ae=p._tr_tally(ye,ye.strstart-1-ye.prev_match,ye.prev_length-Q),ye.lookahead-=ye.prev_length-1,ye.prev_length-=2;++ye.strstart<=Se&&(ye.ins_h=(ye.ins_h<<ye.hash_shift^ye.window[ye.strstart+Q-1])&ye.hash_mask,Ge=ye.prev[ye.strstart&ye.w_mask]=ye.head[ye.ins_h],ye.head[ye.ins_h]=ye.strstart),--ye.prev_length!=0;);if(ye.match_available=0,ye.match_length=Q-1,ye.strstart++,Ae&&(Y(ye,!1),ye.strm.avail_out===0))return O}else if(ye.match_available){if((Ae=p._tr_tally(ye,0,ye.window[ye.strstart-1]))&&Y(ye,!1),ye.strstart++,ye.lookahead--,ye.strm.avail_out===0)return O}else ye.match_available=1,ye.strstart++,ye.lookahead--}return ye.match_available&&(Ae=p._tr_tally(ye,0,ye.window[ye.strstart-1]),ye.match_available=0),ye.insert=ye.strstart<Q-1?ye.strstart:Q-1,Ze===V?(Y(ye,!0),ye.strm.avail_out===0?G:j):ye.last_lit&&(Y(ye,!1),ye.strm.avail_out===0)?O:X}function Je(ye,Ze,Ge,Ae,Se){this.good_length=ye,this.max_lazy=Ze,this.nice_length=Ge,this.max_chain=Ae,this.func=Se}function et(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new y.Buf16(2*q),this.dyn_dtree=new y.Buf16(2*(2*U+1)),this.bl_tree=new y.Buf16(2*(2*H+1)),se(this.dyn_ltree),se(this.dyn_dtree),se(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new y.Buf16(te+1),this.heap=new y.Buf16(2*N+1),se(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new y.Buf16(2*N+1),se(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ze(ye){var Ze;return ye&&ye.state?(ye.total_in=ye.total_out=0,ye.data_type=_,(Ze=ye.state).pending=0,Ze.pending_out=0,Ze.wrap<0&&(Ze.wrap=-Ze.wrap),Ze.status=Ze.wrap?F:W,ye.adler=Ze.wrap===2?0:1,Ze.last_flush=B,p._tr_init(Ze),P):K(ye,L)}function Xe(ye){var Ze=ze(ye);return Ze===P&&function(Ge){Ge.window_size=2*Ge.w_size,se(Ge.head),Ge.max_lazy_match=v[Ge.level].max_lazy,Ge.good_match=v[Ge.level].good_length,Ge.nice_match=v[Ge.level].nice_length,Ge.max_chain_length=v[Ge.level].max_chain,Ge.strstart=0,Ge.block_start=0,Ge.lookahead=0,Ge.insert=0,Ge.match_length=Ge.prev_length=Q-1,Ge.match_available=0,Ge.ins_h=0}(ye.state),Ze}function tt(ye,Ze,Ge,Ae,Se,Te){if(!ye)return L;var me=1;if(Ze===E&&(Ze=6),Ae<0?(me=0,Ae=-Ae):15<Ae&&(me=2,Ae-=16),Se<1||T<Se||Ge!==x||Ae<8||15<Ae||Ze<0||9<Ze||Te<0||b<Te)return K(ye,L);Ae===8&&(Ae=9);var be=new et;return(ye.state=be).strm=ye,be.wrap=me,be.gzhead=null,be.w_bits=Ae,be.w_size=1<<be.w_bits,be.w_mask=be.w_size-1,be.hash_bits=Se+7,be.hash_size=1<<be.hash_bits,be.hash_mask=be.hash_size-1,be.hash_shift=~~((be.hash_bits+Q-1)/Q),be.window=new y.Buf8(2*be.w_size),be.head=new y.Buf16(be.hash_size),be.prev=new y.Buf16(be.w_size),be.lit_bufsize=1<<Se+6,be.pending_buf_size=4*be.lit_bufsize,be.pending_buf=new y.Buf8(be.pending_buf_size),be.d_buf=1*be.lit_bufsize,be.l_buf=3*be.lit_bufsize,be.level=Ze,be.strategy=Te,be.method=Ge,Xe(ye)}v=[new Je(0,0,0,0,function(ye,Ze){var Ge=65535;for(Ge>ye.pending_buf_size-5&&(Ge=ye.pending_buf_size-5);;){if(ye.lookahead<=1){if($e(ye),ye.lookahead===0&&Ze===B)return O;if(ye.lookahead===0)break}ye.strstart+=ye.lookahead,ye.lookahead=0;var Ae=ye.block_start+Ge;if((ye.strstart===0||ye.strstart>=Ae)&&(ye.lookahead=ye.strstart-Ae,ye.strstart=Ae,Y(ye,!1),ye.strm.avail_out===0)||ye.strstart-ye.block_start>=ye.w_size-ae&&(Y(ye,!1),ye.strm.avail_out===0))return O}return ye.insert=0,Ze===V?(Y(ye,!0),ye.strm.avail_out===0?G:j):(ye.strstart>ye.block_start&&(Y(ye,!1),ye.strm.avail_out),O)}),new Je(4,4,8,4,pt),new Je(4,5,16,8,pt),new Je(4,6,32,32,pt),new Je(4,4,16,16,Ue),new Je(8,16,32,32,Ue),new Je(8,16,128,128,Ue),new Je(8,32,128,256,Ue),new Je(32,128,258,1024,Ue),new Je(32,258,258,4096,Ue)],M.deflateInit=function(ye,Ze){return tt(ye,Ze,x,15,8,0)},M.deflateInit2=tt,M.deflateReset=Xe,M.deflateResetKeep=ze,M.deflateSetHeader=function(ye,Ze){return ye&&ye.state?ye.state.wrap!==2?L:(ye.state.gzhead=Ze,P):L},M.deflate=function(ye,Ze){var Ge,Ae,Se,Te;if(!ye||!ye.state||5<Ze||Ze<0)return ye?K(ye,L):L;if(Ae=ye.state,!ye.output||!ye.input&&ye.avail_in!==0||Ae.status===666&&Ze!==V)return K(ye,ye.avail_out===0?-5:L);if(Ae.strm=ye,Ge=Ae.last_flush,Ae.last_flush=Ze,Ae.status===F)if(Ae.wrap===2)ye.adler=0,pe(Ae,31),pe(Ae,139),pe(Ae,8),Ae.gzhead?(pe(Ae,(Ae.gzhead.text?1:0)+(Ae.gzhead.hcrc?2:0)+(Ae.gzhead.extra?4:0)+(Ae.gzhead.name?8:0)+(Ae.gzhead.comment?16:0)),pe(Ae,255&Ae.gzhead.time),pe(Ae,Ae.gzhead.time>>8&255),pe(Ae,Ae.gzhead.time>>16&255),pe(Ae,Ae.gzhead.time>>24&255),pe(Ae,Ae.level===9?2:2<=Ae.strategy||Ae.level<2?4:0),pe(Ae,255&Ae.gzhead.os),Ae.gzhead.extra&&Ae.gzhead.extra.length&&(pe(Ae,255&Ae.gzhead.extra.length),pe(Ae,Ae.gzhead.extra.length>>8&255)),Ae.gzhead.hcrc&&(ye.adler=C(ye.adler,Ae.pending_buf,Ae.pending,0)),Ae.gzindex=0,Ae.status=69):(pe(Ae,0),pe(Ae,0),pe(Ae,0),pe(Ae,0),pe(Ae,0),pe(Ae,Ae.level===9?2:2<=Ae.strategy||Ae.level<2?4:0),pe(Ae,3),Ae.status=W);else{var me=x+(Ae.w_bits-8<<4)<<8;me|=(2<=Ae.strategy||Ae.level<2?0:Ae.level<6?1:Ae.level===6?2:3)<<6,Ae.strstart!==0&&(me|=32),me+=31-me%31,Ae.status=W,Ee(Ae,me),Ae.strstart!==0&&(Ee(Ae,ye.adler>>>16),Ee(Ae,65535&ye.adler)),ye.adler=1}if(Ae.status===69)if(Ae.gzhead.extra){for(Se=Ae.pending;Ae.gzindex<(65535&Ae.gzhead.extra.length)&&(Ae.pending!==Ae.pending_buf_size||(Ae.gzhead.hcrc&&Ae.pending>Se&&(ye.adler=C(ye.adler,Ae.pending_buf,Ae.pending-Se,Se)),ue(ye),Se=Ae.pending,Ae.pending!==Ae.pending_buf_size));)pe(Ae,255&Ae.gzhead.extra[Ae.gzindex]),Ae.gzindex++;Ae.gzhead.hcrc&&Ae.pending>Se&&(ye.adler=C(ye.adler,Ae.pending_buf,Ae.pending-Se,Se)),Ae.gzindex===Ae.gzhead.extra.length&&(Ae.gzindex=0,Ae.status=73)}else Ae.status=73;if(Ae.status===73)if(Ae.gzhead.name){Se=Ae.pending;do{if(Ae.pending===Ae.pending_buf_size&&(Ae.gzhead.hcrc&&Ae.pending>Se&&(ye.adler=C(ye.adler,Ae.pending_buf,Ae.pending-Se,Se)),ue(ye),Se=Ae.pending,Ae.pending===Ae.pending_buf_size)){Te=1;break}Te=Ae.gzindex<Ae.gzhead.name.length?255&Ae.gzhead.name.charCodeAt(Ae.gzindex++):0,pe(Ae,Te)}while(Te!==0);Ae.gzhead.hcrc&&Ae.pending>Se&&(ye.adler=C(ye.adler,Ae.pending_buf,Ae.pending-Se,Se)),Te===0&&(Ae.gzindex=0,Ae.status=91)}else Ae.status=91;if(Ae.status===91)if(Ae.gzhead.comment){Se=Ae.pending;do{if(Ae.pending===Ae.pending_buf_size&&(Ae.gzhead.hcrc&&Ae.pending>Se&&(ye.adler=C(ye.adler,Ae.pending_buf,Ae.pending-Se,Se)),ue(ye),Se=Ae.pending,Ae.pending===Ae.pending_buf_size)){Te=1;break}Te=Ae.gzindex<Ae.gzhead.comment.length?255&Ae.gzhead.comment.charCodeAt(Ae.gzindex++):0,pe(Ae,Te)}while(Te!==0);Ae.gzhead.hcrc&&Ae.pending>Se&&(ye.adler=C(ye.adler,Ae.pending_buf,Ae.pending-Se,Se)),Te===0&&(Ae.status=103)}else Ae.status=103;if(Ae.status===103&&(Ae.gzhead.hcrc?(Ae.pending+2>Ae.pending_buf_size&&ue(ye),Ae.pending+2<=Ae.pending_buf_size&&(pe(Ae,255&ye.adler),pe(Ae,ye.adler>>8&255),ye.adler=0,Ae.status=W)):Ae.status=W),Ae.pending!==0){if(ue(ye),ye.avail_out===0)return Ae.last_flush=-1,P}else if(ye.avail_in===0&&ce(Ze)<=ce(Ge)&&Ze!==V)return K(ye,-5);if(Ae.status===666&&ye.avail_in!==0)return K(ye,-5);if(ye.avail_in!==0||Ae.lookahead!==0||Ze!==B&&Ae.status!==666){var be=Ae.strategy===2?function(we,je){for(var lt;;){if(we.lookahead===0&&($e(we),we.lookahead===0)){if(je===B)return O;break}if(we.match_length=0,lt=p._tr_tally(we,0,we.window[we.strstart]),we.lookahead--,we.strstart++,lt&&(Y(we,!1),we.strm.avail_out===0))return O}return we.insert=0,je===V?(Y(we,!0),we.strm.avail_out===0?G:j):we.last_lit&&(Y(we,!1),we.strm.avail_out===0)?O:X}(Ae,Ze):Ae.strategy===3?function(we,je){for(var lt,ot,bt,Ie,re=we.window;;){if(we.lookahead<=Z){if($e(we),we.lookahead<=Z&&je===B)return O;if(we.lookahead===0)break}if(we.match_length=0,we.lookahead>=Q&&0<we.strstart&&(ot=re[bt=we.strstart-1])===re[++bt]&&ot===re[++bt]&&ot===re[++bt]){Ie=we.strstart+Z;do;while(ot===re[++bt]&&ot===re[++bt]&&ot===re[++bt]&&ot===re[++bt]&&ot===re[++bt]&&ot===re[++bt]&&ot===re[++bt]&&ot===re[++bt]&&bt<Ie);we.match_length=Z-(Ie-bt),we.match_length>we.lookahead&&(we.match_length=we.lookahead)}if(we.match_length>=Q?(lt=p._tr_tally(we,1,we.match_length-Q),we.lookahead-=we.match_length,we.strstart+=we.match_length,we.match_length=0):(lt=p._tr_tally(we,0,we.window[we.strstart]),we.lookahead--,we.strstart++),lt&&(Y(we,!1),we.strm.avail_out===0))return O}return we.insert=0,je===V?(Y(we,!0),we.strm.avail_out===0?G:j):we.last_lit&&(Y(we,!1),we.strm.avail_out===0)?O:X}(Ae,Ze):v[Ae.level].func(Ae,Ze);if(be!==G&&be!==j||(Ae.status=666),be===O||be===G)return ye.avail_out===0&&(Ae.last_flush=-1),P;if(be===X&&(Ze===1?p._tr_align(Ae):Ze!==5&&(p._tr_stored_block(Ae,0,0,!1),Ze===3&&(se(Ae.head),Ae.lookahead===0&&(Ae.strstart=0,Ae.block_start=0,Ae.insert=0))),ue(ye),ye.avail_out===0))return Ae.last_flush=-1,P}return Ze!==V?P:Ae.wrap<=0?1:(Ae.wrap===2?(pe(Ae,255&ye.adler),pe(Ae,ye.adler>>8&255),pe(Ae,ye.adler>>16&255),pe(Ae,ye.adler>>24&255),pe(Ae,255&ye.total_in),pe(Ae,ye.total_in>>8&255),pe(Ae,ye.total_in>>16&255),pe(Ae,ye.total_in>>24&255)):(Ee(Ae,ye.adler>>>16),Ee(Ae,65535&ye.adler)),ue(ye),0<Ae.wrap&&(Ae.wrap=-Ae.wrap),Ae.pending!==0?P:1)},M.deflateEnd=function(ye){var Ze;return ye&&ye.state?(Ze=ye.state.status)!==F&&Ze!==69&&Ze!==73&&Ze!==91&&Ze!==103&&Ze!==W&&Ze!==666?K(ye,L):(ye.state=null,Ze===W?K(ye,-3):P):L},M.deflateSetDictionary=function(ye,Ze){var Ge,Ae,Se,Te,me,be,we,je,lt=Ze.length;if(!ye||!ye.state||(Te=(Ge=ye.state).wrap)===2||Te===1&&Ge.status!==F||Ge.lookahead)return L;for(Te===1&&(ye.adler=g(ye.adler,Ze,lt,0)),Ge.wrap=0,lt>=Ge.w_size&&(Te===0&&(se(Ge.head),Ge.strstart=0,Ge.block_start=0,Ge.insert=0),je=new y.Buf8(Ge.w_size),y.arraySet(je,Ze,lt-Ge.w_size,Ge.w_size,0),Ze=je,lt=Ge.w_size),me=ye.avail_in,be=ye.next_in,we=ye.input,ye.avail_in=lt,ye.next_in=0,ye.input=Ze,$e(Ge);Ge.lookahead>=Q;){for(Ae=Ge.strstart,Se=Ge.lookahead-(Q-1);Ge.ins_h=(Ge.ins_h<<Ge.hash_shift^Ge.window[Ae+Q-1])&Ge.hash_mask,Ge.prev[Ae&Ge.w_mask]=Ge.head[Ge.ins_h],Ge.head[Ge.ins_h]=Ae,Ae++,--Se;);Ge.strstart=Ae,Ge.lookahead=Q-1,$e(Ge)}return Ge.strstart+=Ge.lookahead,Ge.block_start=Ge.strstart,Ge.insert=Ge.lookahead,Ge.lookahead=0,Ge.match_length=Ge.prev_length=Q-1,Ge.match_available=0,ye.next_in=be,ye.input=we,ye.avail_in=me,Ge.wrap=Te,P},M.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(h,R,M){R.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(h,R,M){R.exports=function(v,y){var p,g,C,D,B,V,P,L,E,b,_,x,T,N,U,H,q,te,Q,Z,ae,F,W,O,X;p=v.state,g=v.next_in,O=v.input,C=g+(v.avail_in-5),D=v.next_out,X=v.output,B=D-(y-v.avail_out),V=D+(v.avail_out-257),P=p.dmax,L=p.wsize,E=p.whave,b=p.wnext,_=p.window,x=p.hold,T=p.bits,N=p.lencode,U=p.distcode,H=(1<<p.lenbits)-1,q=(1<<p.distbits)-1;e:do{T<15&&(x+=O[g++]<<T,T+=8,x+=O[g++]<<T,T+=8),te=N[x&H];t:for(;;){if(x>>>=Q=te>>>24,T-=Q,(Q=te>>>16&255)===0)X[D++]=65535&te;else{if(!(16&Q)){if((64&Q)==0){te=N[(65535&te)+(x&(1<<Q)-1)];continue t}if(32&Q){p.mode=12;break e}v.msg="invalid literal/length code",p.mode=30;break e}Z=65535&te,(Q&=15)&&(T<Q&&(x+=O[g++]<<T,T+=8),Z+=x&(1<<Q)-1,x>>>=Q,T-=Q),T<15&&(x+=O[g++]<<T,T+=8,x+=O[g++]<<T,T+=8),te=U[x&q];r:for(;;){if(x>>>=Q=te>>>24,T-=Q,!(16&(Q=te>>>16&255))){if((64&Q)==0){te=U[(65535&te)+(x&(1<<Q)-1)];continue r}v.msg="invalid distance code",p.mode=30;break e}if(ae=65535&te,T<(Q&=15)&&(x+=O[g++]<<T,(T+=8)<Q&&(x+=O[g++]<<T,T+=8)),P<(ae+=x&(1<<Q)-1)){v.msg="invalid distance too far back",p.mode=30;break e}if(x>>>=Q,T-=Q,(Q=D-B)<ae){if(E<(Q=ae-Q)&&p.sane){v.msg="invalid distance too far back",p.mode=30;break e}if(W=_,(F=0)===b){if(F+=L-Q,Q<Z){for(Z-=Q;X[D++]=_[F++],--Q;);F=D-ae,W=X}}else if(b<Q){if(F+=L+b-Q,(Q-=b)<Z){for(Z-=Q;X[D++]=_[F++],--Q;);if(F=0,b<Z){for(Z-=Q=b;X[D++]=_[F++],--Q;);F=D-ae,W=X}}}else if(F+=b-Q,Q<Z){for(Z-=Q;X[D++]=_[F++],--Q;);F=D-ae,W=X}for(;2<Z;)X[D++]=W[F++],X[D++]=W[F++],X[D++]=W[F++],Z-=3;Z&&(X[D++]=W[F++],1<Z&&(X[D++]=W[F++]))}else{for(F=D-ae;X[D++]=X[F++],X[D++]=X[F++],X[D++]=X[F++],2<(Z-=3););Z&&(X[D++]=X[F++],1<Z&&(X[D++]=X[F++]))}break}}break}}while(g<C&&D<V);g-=Z=T>>3,x&=(1<<(T-=Z<<3))-1,v.next_in=g,v.next_out=D,v.avail_in=g<C?C-g+5:5-(g-C),v.avail_out=D<V?V-D+257:257-(D-V),p.hold=x,p.bits=T}},{}],49:[function(h,R,M){var v=h("../utils/common"),y=h("./adler32"),p=h("./crc32"),g=h("./inffast"),C=h("./inftrees"),D=1,B=2,V=0,P=-2,L=1,E=852,b=592;function _(F){return(F>>>24&255)+(F>>>8&65280)+((65280&F)<<8)+((255&F)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function T(F){var W;return F&&F.state?(W=F.state,F.total_in=F.total_out=W.total=0,F.msg="",W.wrap&&(F.adler=1&W.wrap),W.mode=L,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new v.Buf32(E),W.distcode=W.distdyn=new v.Buf32(b),W.sane=1,W.back=-1,V):P}function N(F){var W;return F&&F.state?((W=F.state).wsize=0,W.whave=0,W.wnext=0,T(F)):P}function U(F,W){var O,X;return F&&F.state?(X=F.state,W<0?(O=0,W=-W):(O=1+(W>>4),W<48&&(W&=15)),W&&(W<8||15<W)?P:(X.window!==null&&X.wbits!==W&&(X.window=null),X.wrap=O,X.wbits=W,N(F))):P}function H(F,W){var O,X;return F?(X=new x,(F.state=X).window=null,(O=U(F,W))!==V&&(F.state=null),O):P}var q,te,Q=!0;function Z(F){if(Q){var W;for(q=new v.Buf32(512),te=new v.Buf32(32),W=0;W<144;)F.lens[W++]=8;for(;W<256;)F.lens[W++]=9;for(;W<280;)F.lens[W++]=7;for(;W<288;)F.lens[W++]=8;for(C(D,F.lens,0,288,q,0,F.work,{bits:9}),W=0;W<32;)F.lens[W++]=5;C(B,F.lens,0,32,te,0,F.work,{bits:5}),Q=!1}F.lencode=q,F.lenbits=9,F.distcode=te,F.distbits=5}function ae(F,W,O,X){var G,j=F.state;return j.window===null&&(j.wsize=1<<j.wbits,j.wnext=0,j.whave=0,j.window=new v.Buf8(j.wsize)),X>=j.wsize?(v.arraySet(j.window,W,O-j.wsize,j.wsize,0),j.wnext=0,j.whave=j.wsize):(X<(G=j.wsize-j.wnext)&&(G=X),v.arraySet(j.window,W,O-X,G,j.wnext),(X-=G)?(v.arraySet(j.window,W,O-X,X,0),j.wnext=X,j.whave=j.wsize):(j.wnext+=G,j.wnext===j.wsize&&(j.wnext=0),j.whave<j.wsize&&(j.whave+=G))),0}M.inflateReset=N,M.inflateReset2=U,M.inflateResetKeep=T,M.inflateInit=function(F){return H(F,15)},M.inflateInit2=H,M.inflate=function(F,W){var O,X,G,j,K,ce,se,ue,Y,pe,Ee,Fe,$e,pt,Ue,Je,et,ze,Xe,tt,ye,Ze,Ge,Ae,Se=0,Te=new v.Buf8(4),me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!F||!F.state||!F.output||!F.input&&F.avail_in!==0)return P;(O=F.state).mode===12&&(O.mode=13),K=F.next_out,G=F.output,se=F.avail_out,j=F.next_in,X=F.input,ce=F.avail_in,ue=O.hold,Y=O.bits,pe=ce,Ee=se,Ze=V;e:for(;;)switch(O.mode){case L:if(O.wrap===0){O.mode=13;break}for(;Y<16;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(2&O.wrap&&ue===35615){Te[O.check=0]=255&ue,Te[1]=ue>>>8&255,O.check=p(O.check,Te,2,0),Y=ue=0,O.mode=2;break}if(O.flags=0,O.head&&(O.head.done=!1),!(1&O.wrap)||(((255&ue)<<8)+(ue>>8))%31){F.msg="incorrect header check",O.mode=30;break}if((15&ue)!=8){F.msg="unknown compression method",O.mode=30;break}if(Y-=4,ye=8+(15&(ue>>>=4)),O.wbits===0)O.wbits=ye;else if(ye>O.wbits){F.msg="invalid window size",O.mode=30;break}O.dmax=1<<ye,F.adler=O.check=1,O.mode=512&ue?10:12,Y=ue=0;break;case 2:for(;Y<16;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(O.flags=ue,(255&O.flags)!=8){F.msg="unknown compression method",O.mode=30;break}if(57344&O.flags){F.msg="unknown header flags set",O.mode=30;break}O.head&&(O.head.text=ue>>8&1),512&O.flags&&(Te[0]=255&ue,Te[1]=ue>>>8&255,O.check=p(O.check,Te,2,0)),Y=ue=0,O.mode=3;case 3:for(;Y<32;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}O.head&&(O.head.time=ue),512&O.flags&&(Te[0]=255&ue,Te[1]=ue>>>8&255,Te[2]=ue>>>16&255,Te[3]=ue>>>24&255,O.check=p(O.check,Te,4,0)),Y=ue=0,O.mode=4;case 4:for(;Y<16;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}O.head&&(O.head.xflags=255&ue,O.head.os=ue>>8),512&O.flags&&(Te[0]=255&ue,Te[1]=ue>>>8&255,O.check=p(O.check,Te,2,0)),Y=ue=0,O.mode=5;case 5:if(1024&O.flags){for(;Y<16;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}O.length=ue,O.head&&(O.head.extra_len=ue),512&O.flags&&(Te[0]=255&ue,Te[1]=ue>>>8&255,O.check=p(O.check,Te,2,0)),Y=ue=0}else O.head&&(O.head.extra=null);O.mode=6;case 6:if(1024&O.flags&&(ce<(Fe=O.length)&&(Fe=ce),Fe&&(O.head&&(ye=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),v.arraySet(O.head.extra,X,j,Fe,ye)),512&O.flags&&(O.check=p(O.check,X,Fe,j)),ce-=Fe,j+=Fe,O.length-=Fe),O.length))break e;O.length=0,O.mode=7;case 7:if(2048&O.flags){if(ce===0)break e;for(Fe=0;ye=X[j+Fe++],O.head&&ye&&O.length<65536&&(O.head.name+=String.fromCharCode(ye)),ye&&Fe<ce;);if(512&O.flags&&(O.check=p(O.check,X,Fe,j)),ce-=Fe,j+=Fe,ye)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=8;case 8:if(4096&O.flags){if(ce===0)break e;for(Fe=0;ye=X[j+Fe++],O.head&&ye&&O.length<65536&&(O.head.comment+=String.fromCharCode(ye)),ye&&Fe<ce;);if(512&O.flags&&(O.check=p(O.check,X,Fe,j)),ce-=Fe,j+=Fe,ye)break e}else O.head&&(O.head.comment=null);O.mode=9;case 9:if(512&O.flags){for(;Y<16;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(ue!==(65535&O.check)){F.msg="header crc mismatch",O.mode=30;break}Y=ue=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),F.adler=O.check=0,O.mode=12;break;case 10:for(;Y<32;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}F.adler=O.check=_(ue),Y=ue=0,O.mode=11;case 11:if(O.havedict===0)return F.next_out=K,F.avail_out=se,F.next_in=j,F.avail_in=ce,O.hold=ue,O.bits=Y,2;F.adler=O.check=1,O.mode=12;case 12:if(W===5||W===6)break e;case 13:if(O.last){ue>>>=7&Y,Y-=7&Y,O.mode=27;break}for(;Y<3;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}switch(O.last=1&ue,Y-=1,3&(ue>>>=1)){case 0:O.mode=14;break;case 1:if(Z(O),O.mode=20,W!==6)break;ue>>>=2,Y-=2;break e;case 2:O.mode=17;break;case 3:F.msg="invalid block type",O.mode=30}ue>>>=2,Y-=2;break;case 14:for(ue>>>=7&Y,Y-=7&Y;Y<32;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if((65535&ue)!=(ue>>>16^65535)){F.msg="invalid stored block lengths",O.mode=30;break}if(O.length=65535&ue,Y=ue=0,O.mode=15,W===6)break e;case 15:O.mode=16;case 16:if(Fe=O.length){if(ce<Fe&&(Fe=ce),se<Fe&&(Fe=se),Fe===0)break e;v.arraySet(G,X,j,Fe,K),ce-=Fe,j+=Fe,se-=Fe,K+=Fe,O.length-=Fe;break}O.mode=12;break;case 17:for(;Y<14;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(O.nlen=257+(31&ue),ue>>>=5,Y-=5,O.ndist=1+(31&ue),ue>>>=5,Y-=5,O.ncode=4+(15&ue),ue>>>=4,Y-=4,286<O.nlen||30<O.ndist){F.msg="too many length or distance symbols",O.mode=30;break}O.have=0,O.mode=18;case 18:for(;O.have<O.ncode;){for(;Y<3;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}O.lens[me[O.have++]]=7&ue,ue>>>=3,Y-=3}for(;O.have<19;)O.lens[me[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,Ge={bits:O.lenbits},Ze=C(0,O.lens,0,19,O.lencode,0,O.work,Ge),O.lenbits=Ge.bits,Ze){F.msg="invalid code lengths set",O.mode=30;break}O.have=0,O.mode=19;case 19:for(;O.have<O.nlen+O.ndist;){for(;Je=(Se=O.lencode[ue&(1<<O.lenbits)-1])>>>16&255,et=65535&Se,!((Ue=Se>>>24)<=Y);){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(et<16)ue>>>=Ue,Y-=Ue,O.lens[O.have++]=et;else{if(et===16){for(Ae=Ue+2;Y<Ae;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(ue>>>=Ue,Y-=Ue,O.have===0){F.msg="invalid bit length repeat",O.mode=30;break}ye=O.lens[O.have-1],Fe=3+(3&ue),ue>>>=2,Y-=2}else if(et===17){for(Ae=Ue+3;Y<Ae;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}Y-=Ue,ye=0,Fe=3+(7&(ue>>>=Ue)),ue>>>=3,Y-=3}else{for(Ae=Ue+7;Y<Ae;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}Y-=Ue,ye=0,Fe=11+(127&(ue>>>=Ue)),ue>>>=7,Y-=7}if(O.have+Fe>O.nlen+O.ndist){F.msg="invalid bit length repeat",O.mode=30;break}for(;Fe--;)O.lens[O.have++]=ye}}if(O.mode===30)break;if(O.lens[256]===0){F.msg="invalid code -- missing end-of-block",O.mode=30;break}if(O.lenbits=9,Ge={bits:O.lenbits},Ze=C(D,O.lens,0,O.nlen,O.lencode,0,O.work,Ge),O.lenbits=Ge.bits,Ze){F.msg="invalid literal/lengths set",O.mode=30;break}if(O.distbits=6,O.distcode=O.distdyn,Ge={bits:O.distbits},Ze=C(B,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,Ge),O.distbits=Ge.bits,Ze){F.msg="invalid distances set",O.mode=30;break}if(O.mode=20,W===6)break e;case 20:O.mode=21;case 21:if(6<=ce&&258<=se){F.next_out=K,F.avail_out=se,F.next_in=j,F.avail_in=ce,O.hold=ue,O.bits=Y,g(F,Ee),K=F.next_out,G=F.output,se=F.avail_out,j=F.next_in,X=F.input,ce=F.avail_in,ue=O.hold,Y=O.bits,O.mode===12&&(O.back=-1);break}for(O.back=0;Je=(Se=O.lencode[ue&(1<<O.lenbits)-1])>>>16&255,et=65535&Se,!((Ue=Se>>>24)<=Y);){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(Je&&(240&Je)==0){for(ze=Ue,Xe=Je,tt=et;Je=(Se=O.lencode[tt+((ue&(1<<ze+Xe)-1)>>ze)])>>>16&255,et=65535&Se,!(ze+(Ue=Se>>>24)<=Y);){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}ue>>>=ze,Y-=ze,O.back+=ze}if(ue>>>=Ue,Y-=Ue,O.back+=Ue,O.length=et,Je===0){O.mode=26;break}if(32&Je){O.back=-1,O.mode=12;break}if(64&Je){F.msg="invalid literal/length code",O.mode=30;break}O.extra=15&Je,O.mode=22;case 22:if(O.extra){for(Ae=O.extra;Y<Ae;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}O.length+=ue&(1<<O.extra)-1,ue>>>=O.extra,Y-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=23;case 23:for(;Je=(Se=O.distcode[ue&(1<<O.distbits)-1])>>>16&255,et=65535&Se,!((Ue=Se>>>24)<=Y);){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if((240&Je)==0){for(ze=Ue,Xe=Je,tt=et;Je=(Se=O.distcode[tt+((ue&(1<<ze+Xe)-1)>>ze)])>>>16&255,et=65535&Se,!(ze+(Ue=Se>>>24)<=Y);){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}ue>>>=ze,Y-=ze,O.back+=ze}if(ue>>>=Ue,Y-=Ue,O.back+=Ue,64&Je){F.msg="invalid distance code",O.mode=30;break}O.offset=et,O.extra=15&Je,O.mode=24;case 24:if(O.extra){for(Ae=O.extra;Y<Ae;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}O.offset+=ue&(1<<O.extra)-1,ue>>>=O.extra,Y-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){F.msg="invalid distance too far back",O.mode=30;break}O.mode=25;case 25:if(se===0)break e;if(Fe=Ee-se,O.offset>Fe){if((Fe=O.offset-Fe)>O.whave&&O.sane){F.msg="invalid distance too far back",O.mode=30;break}$e=Fe>O.wnext?(Fe-=O.wnext,O.wsize-Fe):O.wnext-Fe,Fe>O.length&&(Fe=O.length),pt=O.window}else pt=G,$e=K-O.offset,Fe=O.length;for(se<Fe&&(Fe=se),se-=Fe,O.length-=Fe;G[K++]=pt[$e++],--Fe;);O.length===0&&(O.mode=21);break;case 26:if(se===0)break e;G[K++]=O.length,se--,O.mode=21;break;case 27:if(O.wrap){for(;Y<32;){if(ce===0)break e;ce--,ue|=X[j++]<<Y,Y+=8}if(Ee-=se,F.total_out+=Ee,O.total+=Ee,Ee&&(F.adler=O.check=O.flags?p(O.check,G,Ee,K-Ee):y(O.check,G,Ee,K-Ee)),Ee=se,(O.flags?ue:_(ue))!==O.check){F.msg="incorrect data check",O.mode=30;break}Y=ue=0}O.mode=28;case 28:if(O.wrap&&O.flags){for(;Y<32;){if(ce===0)break e;ce--,ue+=X[j++]<<Y,Y+=8}if(ue!==(4294967295&O.total)){F.msg="incorrect length check",O.mode=30;break}Y=ue=0}O.mode=29;case 29:Ze=1;break e;case 30:Ze=-3;break e;case 31:return-4;case 32:default:return P}return F.next_out=K,F.avail_out=se,F.next_in=j,F.avail_in=ce,O.hold=ue,O.bits=Y,(O.wsize||Ee!==F.avail_out&&O.mode<30&&(O.mode<27||W!==4))&&ae(F,F.output,F.next_out,Ee-F.avail_out)?(O.mode=31,-4):(pe-=F.avail_in,Ee-=F.avail_out,F.total_in+=pe,F.total_out+=Ee,O.total+=Ee,O.wrap&&Ee&&(F.adler=O.check=O.flags?p(O.check,G,Ee,F.next_out-Ee):y(O.check,G,Ee,F.next_out-Ee)),F.data_type=O.bits+(O.last?64:0)+(O.mode===12?128:0)+(O.mode===20||O.mode===15?256:0),(pe==0&&Ee===0||W===4)&&Ze===V&&(Ze=-5),Ze)},M.inflateEnd=function(F){if(!F||!F.state)return P;var W=F.state;return W.window&&(W.window=null),F.state=null,V},M.inflateGetHeader=function(F,W){var O;return F&&F.state?(2&(O=F.state).wrap)==0?P:((O.head=W).done=!1,V):P},M.inflateSetDictionary=function(F,W){var O,X=W.length;return F&&F.state?(O=F.state).wrap!==0&&O.mode!==11?P:O.mode===11&&y(1,W,X,0)!==O.check?-3:ae(F,W,X,X)?(O.mode=31,-4):(O.havedict=1,V):P},M.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(h,R,M){var v=h("../utils/common"),y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],g=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],C=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];R.exports=function(D,B,V,P,L,E,b,_){var x,T,N,U,H,q,te,Q,Z,ae=_.bits,F=0,W=0,O=0,X=0,G=0,j=0,K=0,ce=0,se=0,ue=0,Y=null,pe=0,Ee=new v.Buf16(16),Fe=new v.Buf16(16),$e=null,pt=0;for(F=0;F<=15;F++)Ee[F]=0;for(W=0;W<P;W++)Ee[B[V+W]]++;for(G=ae,X=15;1<=X&&Ee[X]===0;X--);if(X<G&&(G=X),X===0)return L[E++]=20971520,L[E++]=20971520,_.bits=1,0;for(O=1;O<X&&Ee[O]===0;O++);for(G<O&&(G=O),F=ce=1;F<=15;F++)if(ce<<=1,(ce-=Ee[F])<0)return-1;if(0<ce&&(D===0||X!==1))return-1;for(Fe[1]=0,F=1;F<15;F++)Fe[F+1]=Fe[F]+Ee[F];for(W=0;W<P;W++)B[V+W]!==0&&(b[Fe[B[V+W]]++]=W);if(q=D===0?(Y=$e=b,19):D===1?(Y=y,pe-=257,$e=p,pt-=257,256):(Y=g,$e=C,-1),F=O,H=E,K=W=ue=0,N=-1,U=(se=1<<(j=G))-1,D===1&&852<se||D===2&&592<se)return 1;for(;;){for(te=F-K,Z=b[W]<q?(Q=0,b[W]):b[W]>q?(Q=$e[pt+b[W]],Y[pe+b[W]]):(Q=96,0),x=1<<F-K,O=T=1<<j;L[H+(ue>>K)+(T-=x)]=te<<24|Q<<16|Z|0,T!==0;);for(x=1<<F-1;ue&x;)x>>=1;if(x!==0?(ue&=x-1,ue+=x):ue=0,W++,--Ee[F]==0){if(F===X)break;F=B[V+b[W]]}if(G<F&&(ue&U)!==N){for(K===0&&(K=G),H+=O,ce=1<<(j=F-K);j+K<X&&!((ce-=Ee[j+K])<=0);)j++,ce<<=1;if(se+=1<<j,D===1&&852<se||D===2&&592<se)return 1;L[N=ue&U]=G<<24|j<<16|H-E|0}}return ue!==0&&(L[H+ue]=F-K<<24|64<<16|0),_.bits=G,0}},{"../utils/common":41}],51:[function(h,R,M){R.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(h,R,M){var v=h("../utils/common"),y=0,p=1;function g(Se){for(var Te=Se.length;0<=--Te;)Se[Te]=0}var C=0,D=29,B=256,V=B+1+D,P=30,L=19,E=2*V+1,b=15,_=16,x=7,T=256,N=16,U=17,H=18,q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],te=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=new Array(2*(V+2));g(ae);var F=new Array(2*P);g(F);var W=new Array(512);g(W);var O=new Array(256);g(O);var X=new Array(D);g(X);var G,j,K,ce=new Array(P);function se(Se,Te,me,be,we){this.static_tree=Se,this.extra_bits=Te,this.extra_base=me,this.elems=be,this.max_length=we,this.has_stree=Se&&Se.length}function ue(Se,Te){this.dyn_tree=Se,this.max_code=0,this.stat_desc=Te}function Y(Se){return Se<256?W[Se]:W[256+(Se>>>7)]}function pe(Se,Te){Se.pending_buf[Se.pending++]=255&Te,Se.pending_buf[Se.pending++]=Te>>>8&255}function Ee(Se,Te,me){Se.bi_valid>_-me?(Se.bi_buf|=Te<<Se.bi_valid&65535,pe(Se,Se.bi_buf),Se.bi_buf=Te>>_-Se.bi_valid,Se.bi_valid+=me-_):(Se.bi_buf|=Te<<Se.bi_valid&65535,Se.bi_valid+=me)}function Fe(Se,Te,me){Ee(Se,me[2*Te],me[2*Te+1])}function $e(Se,Te){for(var me=0;me|=1&Se,Se>>>=1,me<<=1,0<--Te;);return me>>>1}function pt(Se,Te,me){var be,we,je=new Array(b+1),lt=0;for(be=1;be<=b;be++)je[be]=lt=lt+me[be-1]<<1;for(we=0;we<=Te;we++){var ot=Se[2*we+1];ot!==0&&(Se[2*we]=$e(je[ot]++,ot))}}function Ue(Se){var Te;for(Te=0;Te<V;Te++)Se.dyn_ltree[2*Te]=0;for(Te=0;Te<P;Te++)Se.dyn_dtree[2*Te]=0;for(Te=0;Te<L;Te++)Se.bl_tree[2*Te]=0;Se.dyn_ltree[2*T]=1,Se.opt_len=Se.static_len=0,Se.last_lit=Se.matches=0}function Je(Se){8<Se.bi_valid?pe(Se,Se.bi_buf):0<Se.bi_valid&&(Se.pending_buf[Se.pending++]=Se.bi_buf),Se.bi_buf=0,Se.bi_valid=0}function et(Se,Te,me,be){var we=2*Te,je=2*me;return Se[we]<Se[je]||Se[we]===Se[je]&&be[Te]<=be[me]}function ze(Se,Te,me){for(var be=Se.heap[me],we=me<<1;we<=Se.heap_len&&(we<Se.heap_len&&et(Te,Se.heap[we+1],Se.heap[we],Se.depth)&&we++,!et(Te,be,Se.heap[we],Se.depth));)Se.heap[me]=Se.heap[we],me=we,we<<=1;Se.heap[me]=be}function Xe(Se,Te,me){var be,we,je,lt,ot=0;if(Se.last_lit!==0)for(;be=Se.pending_buf[Se.d_buf+2*ot]<<8|Se.pending_buf[Se.d_buf+2*ot+1],we=Se.pending_buf[Se.l_buf+ot],ot++,be===0?Fe(Se,we,Te):(Fe(Se,(je=O[we])+B+1,Te),(lt=q[je])!==0&&Ee(Se,we-=X[je],lt),Fe(Se,je=Y(--be),me),(lt=te[je])!==0&&Ee(Se,be-=ce[je],lt)),ot<Se.last_lit;);Fe(Se,T,Te)}function tt(Se,Te){var me,be,we,je=Te.dyn_tree,lt=Te.stat_desc.static_tree,ot=Te.stat_desc.has_stree,bt=Te.stat_desc.elems,Ie=-1;for(Se.heap_len=0,Se.heap_max=E,me=0;me<bt;me++)je[2*me]!==0?(Se.heap[++Se.heap_len]=Ie=me,Se.depth[me]=0):je[2*me+1]=0;for(;Se.heap_len<2;)je[2*(we=Se.heap[++Se.heap_len]=Ie<2?++Ie:0)]=1,Se.depth[we]=0,Se.opt_len--,ot&&(Se.static_len-=lt[2*we+1]);for(Te.max_code=Ie,me=Se.heap_len>>1;1<=me;me--)ze(Se,je,me);for(we=bt;me=Se.heap[1],Se.heap[1]=Se.heap[Se.heap_len--],ze(Se,je,1),be=Se.heap[1],Se.heap[--Se.heap_max]=me,Se.heap[--Se.heap_max]=be,je[2*we]=je[2*me]+je[2*be],Se.depth[we]=(Se.depth[me]>=Se.depth[be]?Se.depth[me]:Se.depth[be])+1,je[2*me+1]=je[2*be+1]=we,Se.heap[1]=we++,ze(Se,je,1),2<=Se.heap_len;);Se.heap[--Se.heap_max]=Se.heap[1],function(re,oe){var _e,Re,ke,Be,at,wt,ht=oe.dyn_tree,_t=oe.max_code,St=oe.stat_desc.static_tree,Ct=oe.stat_desc.has_stree,vt=oe.stat_desc.extra_bits,ct=oe.stat_desc.extra_base,Dt=oe.stat_desc.max_length,fr=0;for(Be=0;Be<=b;Be++)re.bl_count[Be]=0;for(ht[2*re.heap[re.heap_max]+1]=0,_e=re.heap_max+1;_e<E;_e++)Dt<(Be=ht[2*ht[2*(Re=re.heap[_e])+1]+1]+1)&&(Be=Dt,fr++),ht[2*Re+1]=Be,_t<Re||(re.bl_count[Be]++,at=0,ct<=Re&&(at=vt[Re-ct]),wt=ht[2*Re],re.opt_len+=wt*(Be+at),Ct&&(re.static_len+=wt*(St[2*Re+1]+at)));if(fr!==0){do{for(Be=Dt-1;re.bl_count[Be]===0;)Be--;re.bl_count[Be]--,re.bl_count[Be+1]+=2,re.bl_count[Dt]--,fr-=2}while(0<fr);for(Be=Dt;Be!==0;Be--)for(Re=re.bl_count[Be];Re!==0;)_t<(ke=re.heap[--_e])||(ht[2*ke+1]!==Be&&(re.opt_len+=(Be-ht[2*ke+1])*ht[2*ke],ht[2*ke+1]=Be),Re--)}}(Se,Te),pt(je,Ie,Se.bl_count)}function ye(Se,Te,me){var be,we,je=-1,lt=Te[1],ot=0,bt=7,Ie=4;for(lt===0&&(bt=138,Ie=3),Te[2*(me+1)+1]=65535,be=0;be<=me;be++)we=lt,lt=Te[2*(be+1)+1],++ot<bt&&we===lt||(ot<Ie?Se.bl_tree[2*we]+=ot:we!==0?(we!==je&&Se.bl_tree[2*we]++,Se.bl_tree[2*N]++):ot<=10?Se.bl_tree[2*U]++:Se.bl_tree[2*H]++,je=we,Ie=(ot=0)===lt?(bt=138,3):we===lt?(bt=6,3):(bt=7,4))}function Ze(Se,Te,me){var be,we,je=-1,lt=Te[1],ot=0,bt=7,Ie=4;for(lt===0&&(bt=138,Ie=3),be=0;be<=me;be++)if(we=lt,lt=Te[2*(be+1)+1],!(++ot<bt&&we===lt)){if(ot<Ie)for(;Fe(Se,we,Se.bl_tree),--ot!=0;);else we!==0?(we!==je&&(Fe(Se,we,Se.bl_tree),ot--),Fe(Se,N,Se.bl_tree),Ee(Se,ot-3,2)):ot<=10?(Fe(Se,U,Se.bl_tree),Ee(Se,ot-3,3)):(Fe(Se,H,Se.bl_tree),Ee(Se,ot-11,7));je=we,Ie=(ot=0)===lt?(bt=138,3):we===lt?(bt=6,3):(bt=7,4)}}g(ce);var Ge=!1;function Ae(Se,Te,me,be){Ee(Se,(C<<1)+(be?1:0),3),function(we,je,lt,ot){Je(we),ot&&(pe(we,lt),pe(we,~lt)),v.arraySet(we.pending_buf,we.window,je,lt,we.pending),we.pending+=lt}(Se,Te,me,!0)}M._tr_init=function(Se){Ge||(function(){var Te,me,be,we,je,lt=new Array(b+1);for(we=be=0;we<D-1;we++)for(X[we]=be,Te=0;Te<1<<q[we];Te++)O[be++]=we;for(O[be-1]=we,we=je=0;we<16;we++)for(ce[we]=je,Te=0;Te<1<<te[we];Te++)W[je++]=we;for(je>>=7;we<P;we++)for(ce[we]=je<<7,Te=0;Te<1<<te[we]-7;Te++)W[256+je++]=we;for(me=0;me<=b;me++)lt[me]=0;for(Te=0;Te<=143;)ae[2*Te+1]=8,Te++,lt[8]++;for(;Te<=255;)ae[2*Te+1]=9,Te++,lt[9]++;for(;Te<=279;)ae[2*Te+1]=7,Te++,lt[7]++;for(;Te<=287;)ae[2*Te+1]=8,Te++,lt[8]++;for(pt(ae,V+1,lt),Te=0;Te<P;Te++)F[2*Te+1]=5,F[2*Te]=$e(Te,5);G=new se(ae,q,B+1,V,b),j=new se(F,te,0,P,b),K=new se(new Array(0),Q,0,L,x)}(),Ge=!0),Se.l_desc=new ue(Se.dyn_ltree,G),Se.d_desc=new ue(Se.dyn_dtree,j),Se.bl_desc=new ue(Se.bl_tree,K),Se.bi_buf=0,Se.bi_valid=0,Ue(Se)},M._tr_stored_block=Ae,M._tr_flush_block=function(Se,Te,me,be){var we,je,lt=0;0<Se.level?(Se.strm.data_type===2&&(Se.strm.data_type=function(ot){var bt,Ie=4093624447;for(bt=0;bt<=31;bt++,Ie>>>=1)if(1&Ie&&ot.dyn_ltree[2*bt]!==0)return y;if(ot.dyn_ltree[18]!==0||ot.dyn_ltree[20]!==0||ot.dyn_ltree[26]!==0)return p;for(bt=32;bt<B;bt++)if(ot.dyn_ltree[2*bt]!==0)return p;return y}(Se)),tt(Se,Se.l_desc),tt(Se,Se.d_desc),lt=function(ot){var bt;for(ye(ot,ot.dyn_ltree,ot.l_desc.max_code),ye(ot,ot.dyn_dtree,ot.d_desc.max_code),tt(ot,ot.bl_desc),bt=L-1;3<=bt&&ot.bl_tree[2*Z[bt]+1]===0;bt--);return ot.opt_len+=3*(bt+1)+5+5+4,bt}(Se),we=Se.opt_len+3+7>>>3,(je=Se.static_len+3+7>>>3)<=we&&(we=je)):we=je=me+5,me+4<=we&&Te!==-1?Ae(Se,Te,me,be):Se.strategy===4||je===we?(Ee(Se,2+(be?1:0),3),Xe(Se,ae,F)):(Ee(Se,4+(be?1:0),3),function(ot,bt,Ie,re){var oe;for(Ee(ot,bt-257,5),Ee(ot,Ie-1,5),Ee(ot,re-4,4),oe=0;oe<re;oe++)Ee(ot,ot.bl_tree[2*Z[oe]+1],3);Ze(ot,ot.dyn_ltree,bt-1),Ze(ot,ot.dyn_dtree,Ie-1)}(Se,Se.l_desc.max_code+1,Se.d_desc.max_code+1,lt+1),Xe(Se,Se.dyn_ltree,Se.dyn_dtree)),Ue(Se),be&&Je(Se)},M._tr_tally=function(Se,Te,me){return Se.pending_buf[Se.d_buf+2*Se.last_lit]=Te>>>8&255,Se.pending_buf[Se.d_buf+2*Se.last_lit+1]=255&Te,Se.pending_buf[Se.l_buf+Se.last_lit]=255&me,Se.last_lit++,Te===0?Se.dyn_ltree[2*me]++:(Se.matches++,Te--,Se.dyn_ltree[2*(O[me]+B+1)]++,Se.dyn_dtree[2*Y(Te)]++),Se.last_lit===Se.lit_bufsize-1},M._tr_align=function(Se){Ee(Se,2,3),Fe(Se,T,ae),function(Te){Te.bi_valid===16?(pe(Te,Te.bi_buf),Te.bi_buf=0,Te.bi_valid=0):8<=Te.bi_valid&&(Te.pending_buf[Te.pending++]=255&Te.bi_buf,Te.bi_buf>>=8,Te.bi_valid-=8)}(Se)}},{"../utils/common":41}],53:[function(h,R,M){R.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(h,R,M){(function(v){(function(y,p){if(!y.setImmediate){var g,C,D,B,V=1,P={},L=!1,E=y.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(y);b=b&&b.setTimeout?b:y,g={}.toString.call(y.process)==="[object process]"?function(N){process.nextTick(function(){x(N)})}:function(){if(y.postMessage&&!y.importScripts){var N=!0,U=y.onmessage;return y.onmessage=function(){N=!1},y.postMessage("","*"),y.onmessage=U,N}}()?(B="setImmediate$"+Math.random()+"$",y.addEventListener?y.addEventListener("message",T,!1):y.attachEvent("onmessage",T),function(N){y.postMessage(B+N,"*")}):y.MessageChannel?((D=new MessageChannel).port1.onmessage=function(N){x(N.data)},function(N){D.port2.postMessage(N)}):E&&"onreadystatechange"in E.createElement("script")?(C=E.documentElement,function(N){var U=E.createElement("script");U.onreadystatechange=function(){x(N),U.onreadystatechange=null,C.removeChild(U),U=null},C.appendChild(U)}):function(N){setTimeout(x,0,N)},b.setImmediate=function(N){typeof N!="function"&&(N=new Function(""+N));for(var U=new Array(arguments.length-1),H=0;H<U.length;H++)U[H]=arguments[H+1];var q={callback:N,args:U};return P[V]=q,g(V),V++},b.clearImmediate=_}function _(N){delete P[N]}function x(N){if(L)setTimeout(x,0,N);else{var U=P[N];if(U){L=!0;try{(function(H){var q=H.callback,te=H.args;switch(te.length){case 0:q();break;case 1:q(te[0]);break;case 2:q(te[0],te[1]);break;case 3:q(te[0],te[1],te[2]);break;default:q.apply(p,te)}})(U)}finally{_(N),L=!1}}}}function T(N){N.source===y&&typeof N.data=="string"&&N.data.indexOf(B)===0&&x(+N.data.slice(B.length))}})(typeof self>"u"?v===void 0?this:v:self)}).call(this,typeof ua<"u"?ua:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(vM)),vM.exports}var gM,tR;function Ek(){if(tR)return gM;tR=1;const a=bk();return gM=async u=>{const h=new a;await h.loadAsync(u);const R=h.file(/.+/),M={};return await Promise.all(R.map(async v=>{let y;v.name.slice(-3).toLowerCase()==="shp"||v.name.slice(-3).toLowerCase()==="dbf"?y=await v.async("nodebuffer"):y=await v.async("text"),M[v.name]=y})),M},gM}var yM,rR;function Tk(){if(rR)return yM;rR=1;var a=ua.MutationObserver||ua.WebKitMutationObserver,u;if(a){var h=0,R=new a(g),M=ua.document.createTextNode("");R.observe(M,{characterData:!0}),u=function(){M.data=h=++h%2}}else if(!ua.setImmediate&&typeof ua.MessageChannel<"u"){var v=new ua.MessageChannel;v.port1.onmessage=g,u=function(){v.port2.postMessage(0)}}else"document"in ua&&"onreadystatechange"in ua.document.createElement("script")?u=function(){var D=ua.document.createElement("script");D.onreadystatechange=function(){g(),D.onreadystatechange=null,D.parentNode.removeChild(D),D=null},ua.document.documentElement.appendChild(D)}:u=function(){setTimeout(g,0)};var y,p=[];function g(){y=!0;for(var D,B,V=p.length;V;){for(B=p,p=[],D=-1;++D<V;)B[D]();V=p.length}y=!1}yM=C;function C(D){p.push(D)===1&&!y&&u()}return yM}var _M,nR;function QC(){if(nR)return _M;nR=1;var a=Tk();function u(){}var h={},R=["REJECTED"],M=["FULFILLED"],v=["PENDING"];_M=y;function y(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,b!==u&&D(this,b)}y.prototype.finally=function(b){if(typeof b!="function")return this;var _=this.constructor;return this.then(x,T);function x(N){function U(){return N}return _.resolve(b()).then(U)}function T(N){function U(){throw N}return _.resolve(b()).then(U)}},y.prototype.catch=function(b){return this.then(null,b)},y.prototype.then=function(b,_){if(typeof b!="function"&&this.state===M||typeof _!="function"&&this.state===R)return this;var x=new this.constructor(u);if(this.state!==v){var T=this.state===M?b:_;g(x,T,this.outcome)}else this.queue.push(new p(x,b,_));return x};function p(b,_,x){this.promise=b,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}p.prototype.callFulfilled=function(b){h.resolve(this.promise,b)},p.prototype.otherCallFulfilled=function(b){g(this.promise,this.onFulfilled,b)},p.prototype.callRejected=function(b){h.reject(this.promise,b)},p.prototype.otherCallRejected=function(b){g(this.promise,this.onRejected,b)};function g(b,_,x){a(function(){var T;try{T=_(x)}catch(N){return h.reject(b,N)}T===b?h.reject(b,new TypeError("Cannot resolve promise with itself")):h.resolve(b,T)})}h.resolve=function(b,_){var x=B(C,_);if(x.status==="error")return h.reject(b,x.value);var T=x.value;if(T)D(b,T);else{b.state=M,b.outcome=_;for(var N=-1,U=b.queue.length;++N<U;)b.queue[N].callFulfilled(_)}return b},h.reject=function(b,_){b.state=R,b.outcome=_;for(var x=-1,T=b.queue.length;++x<T;)b.queue[x].callRejected(_);return b};function C(b){var _=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof _=="function")return function(){_.apply(b,arguments)}}function D(b,_){var x=!1;function T(q){x||(x=!0,h.reject(b,q))}function N(q){x||(x=!0,h.resolve(b,q))}function U(){_(N,T)}var H=B(U);H.status==="error"&&T(H.value)}function B(b,_){var x={};try{x.value=b(_),x.status="success"}catch(T){x.status="error",x.value=T}return x}y.resolve=V;function V(b){return b instanceof this?b:h.resolve(new this(u),b)}y.reject=P;function P(b){var _=new this(u);return h.reject(_,b)}y.all=L;function L(b){var _=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,T=!1;if(!x)return this.resolve([]);for(var N=new Array(x),U=0,H=-1,q=new this(u);++H<x;)te(b[H],H);return q;function te(Q,Z){_.resolve(Q).then(ae,function(F){T||(T=!0,h.reject(q,F))});function ae(F){N[Z]=F,++U===x&&!T&&(T=!0,h.resolve(q,N))}}}y.race=E;function E(b){var _=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,T=!1;if(!x)return this.resolve([]);for(var N=-1,U=new this(u);++N<x;)H(b[N]);return U;function H(q){_.resolve(q).then(function(te){T||(T=!0,h.resolve(U,te))},function(te){T||(T=!0,h.reject(U,te))})}}return _M}var xM,iR;function KC(){if(iR)return xM;iR=1;const a=ua.URL;return xM=(u,h)=>{if(!h)return u;const R=new a(u);return R.pathname=`${R.pathname}.${h}`,R.href},xM}var AM={},Wm={},aR;function Sk(){if(aR)return Wm;aR=1,Wm.byteLength=p,Wm.toByteArray=C,Wm.fromByteArray=V;for(var a=[],u=[],h=typeof Uint8Array<"u"?Uint8Array:Array,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=0,v=R.length;M<v;++M)a[M]=R[M],u[R.charCodeAt(M)]=M;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63;function y(P){var L=P.length;if(L%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=P.indexOf("=");E===-1&&(E=L);var b=E===L?0:4-E%4;return[E,b]}function p(P){var L=y(P),E=L[0],b=L[1];return(E+b)*3/4-b}function g(P,L,E){return(L+E)*3/4-E}function C(P){var L,E=y(P),b=E[0],_=E[1],x=new h(g(P,b,_)),T=0,N=_>0?b-4:b,U;for(U=0;U<N;U+=4)L=u[P.charCodeAt(U)]<<18|u[P.charCodeAt(U+1)]<<12|u[P.charCodeAt(U+2)]<<6|u[P.charCodeAt(U+3)],x[T++]=L>>16&255,x[T++]=L>>8&255,x[T++]=L&255;return _===2&&(L=u[P.charCodeAt(U)]<<2|u[P.charCodeAt(U+1)]>>4,x[T++]=L&255),_===1&&(L=u[P.charCodeAt(U)]<<10|u[P.charCodeAt(U+1)]<<4|u[P.charCodeAt(U+2)]>>2,x[T++]=L>>8&255,x[T++]=L&255),x}function D(P){return a[P>>18&63]+a[P>>12&63]+a[P>>6&63]+a[P&63]}function B(P,L,E){for(var b,_=[],x=L;x<E;x+=3)b=(P[x]<<16&16711680)+(P[x+1]<<8&65280)+(P[x+2]&255),_.push(D(b));return _.join("")}function V(P){for(var L,E=P.length,b=E%3,_=[],x=16383,T=0,N=E-b;T<N;T+=x)_.push(B(P,T,T+x>N?N:T+x));return b===1?(L=P[E-1],_.push(a[L>>2]+a[L<<4&63]+"==")):b===2&&(L=(P[E-2]<<8)+P[E-1],_.push(a[L>>10]+a[L>>4&63]+a[L<<2&63]+"=")),_.join("")}return Wm}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var sR;function d2(){return sR||(sR=1,function(a){const u=Sk(),h=rC(),R=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;a.Buffer=p,a.SlowBuffer=x,a.INSPECT_MAX_BYTES=50;const M=2147483647;a.kMaxLength=M,p.TYPED_ARRAY_SUPPORT=v(),!p.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function v(){try{const Ie=new Uint8Array(1),re={foo:function(){return 42}};return Object.setPrototypeOf(re,Uint8Array.prototype),Object.setPrototypeOf(Ie,re),Ie.foo()===42}catch{return!1}}Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(!!p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(!!p.isBuffer(this))return this.byteOffset}});function y(Ie){if(Ie>M)throw new RangeError('The value "'+Ie+'" is invalid for option "size"');const re=new Uint8Array(Ie);return Object.setPrototypeOf(re,p.prototype),re}function p(Ie,re,oe){if(typeof Ie=="number"){if(typeof re=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(Ie)}return g(Ie,re,oe)}p.poolSize=8192;function g(Ie,re,oe){if(typeof Ie=="string")return V(Ie,re);if(ArrayBuffer.isView(Ie))return L(Ie);if(Ie==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ie);if(we(Ie,ArrayBuffer)||Ie&&we(Ie.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(we(Ie,SharedArrayBuffer)||Ie&&we(Ie.buffer,SharedArrayBuffer)))return E(Ie,re,oe);if(typeof Ie=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _e=Ie.valueOf&&Ie.valueOf();if(_e!=null&&_e!==Ie)return p.from(_e,re,oe);const Re=b(Ie);if(Re)return Re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Ie[Symbol.toPrimitive]=="function")return p.from(Ie[Symbol.toPrimitive]("string"),re,oe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ie)}p.from=function(Ie,re,oe){return g(Ie,re,oe)},Object.setPrototypeOf(p.prototype,Uint8Array.prototype),Object.setPrototypeOf(p,Uint8Array);function C(Ie){if(typeof Ie!="number")throw new TypeError('"size" argument must be of type number');if(Ie<0)throw new RangeError('The value "'+Ie+'" is invalid for option "size"')}function D(Ie,re,oe){return C(Ie),Ie<=0?y(Ie):re!==void 0?typeof oe=="string"?y(Ie).fill(re,oe):y(Ie).fill(re):y(Ie)}p.alloc=function(Ie,re,oe){return D(Ie,re,oe)};function B(Ie){return C(Ie),y(Ie<0?0:_(Ie)|0)}p.allocUnsafe=function(Ie){return B(Ie)},p.allocUnsafeSlow=function(Ie){return B(Ie)};function V(Ie,re){if((typeof re!="string"||re==="")&&(re="utf8"),!p.isEncoding(re))throw new TypeError("Unknown encoding: "+re);const oe=T(Ie,re)|0;let _e=y(oe);const Re=_e.write(Ie,re);return Re!==oe&&(_e=_e.slice(0,Re)),_e}function P(Ie){const re=Ie.length<0?0:_(Ie.length)|0,oe=y(re);for(let _e=0;_e<re;_e+=1)oe[_e]=Ie[_e]&255;return oe}function L(Ie){if(we(Ie,Uint8Array)){const re=new Uint8Array(Ie);return E(re.buffer,re.byteOffset,re.byteLength)}return P(Ie)}function E(Ie,re,oe){if(re<0||Ie.byteLength<re)throw new RangeError('"offset" is outside of buffer bounds');if(Ie.byteLength<re+(oe||0))throw new RangeError('"length" is outside of buffer bounds');let _e;return re===void 0&&oe===void 0?_e=new Uint8Array(Ie):oe===void 0?_e=new Uint8Array(Ie,re):_e=new Uint8Array(Ie,re,oe),Object.setPrototypeOf(_e,p.prototype),_e}function b(Ie){if(p.isBuffer(Ie)){const re=_(Ie.length)|0,oe=y(re);return oe.length===0||Ie.copy(oe,0,0,re),oe}if(Ie.length!==void 0)return typeof Ie.length!="number"||je(Ie.length)?y(0):P(Ie);if(Ie.type==="Buffer"&&Array.isArray(Ie.data))return P(Ie.data)}function _(Ie){if(Ie>=M)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+M.toString(16)+" bytes");return Ie|0}function x(Ie){return+Ie!=Ie&&(Ie=0),p.alloc(+Ie)}p.isBuffer=function(re){return re!=null&&re._isBuffer===!0&&re!==p.prototype},p.compare=function(re,oe){if(we(re,Uint8Array)&&(re=p.from(re,re.offset,re.byteLength)),we(oe,Uint8Array)&&(oe=p.from(oe,oe.offset,oe.byteLength)),!p.isBuffer(re)||!p.isBuffer(oe))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(re===oe)return 0;let _e=re.length,Re=oe.length;for(let ke=0,Be=Math.min(_e,Re);ke<Be;++ke)if(re[ke]!==oe[ke]){_e=re[ke],Re=oe[ke];break}return _e<Re?-1:Re<_e?1:0},p.isEncoding=function(re){switch(String(re).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(re,oe){if(!Array.isArray(re))throw new TypeError('"list" argument must be an Array of Buffers');if(re.length===0)return p.alloc(0);let _e;if(oe===void 0)for(oe=0,_e=0;_e<re.length;++_e)oe+=re[_e].length;const Re=p.allocUnsafe(oe);let ke=0;for(_e=0;_e<re.length;++_e){let Be=re[_e];if(we(Be,Uint8Array))ke+Be.length>Re.length?(p.isBuffer(Be)||(Be=p.from(Be)),Be.copy(Re,ke)):Uint8Array.prototype.set.call(Re,Be,ke);else if(p.isBuffer(Be))Be.copy(Re,ke);else throw new TypeError('"list" argument must be an Array of Buffers');ke+=Be.length}return Re};function T(Ie,re){if(p.isBuffer(Ie))return Ie.length;if(ArrayBuffer.isView(Ie)||we(Ie,ArrayBuffer))return Ie.byteLength;if(typeof Ie!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ie);const oe=Ie.length,_e=arguments.length>2&&arguments[2]===!0;if(!_e&&oe===0)return 0;let Re=!1;for(;;)switch(re){case"ascii":case"latin1":case"binary":return oe;case"utf8":case"utf-8":return Ae(Ie).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe*2;case"hex":return oe>>>1;case"base64":return me(Ie).length;default:if(Re)return _e?-1:Ae(Ie).length;re=(""+re).toLowerCase(),Re=!0}}p.byteLength=T;function N(Ie,re,oe){let _e=!1;if((re===void 0||re<0)&&(re=0),re>this.length||((oe===void 0||oe>this.length)&&(oe=this.length),oe<=0)||(oe>>>=0,re>>>=0,oe<=re))return"";for(Ie||(Ie="utf8");;)switch(Ie){case"hex":return ce(this,re,oe);case"utf8":case"utf-8":return O(this,re,oe);case"ascii":return j(this,re,oe);case"latin1":case"binary":return K(this,re,oe);case"base64":return W(this,re,oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,re,oe);default:if(_e)throw new TypeError("Unknown encoding: "+Ie);Ie=(Ie+"").toLowerCase(),_e=!0}}p.prototype._isBuffer=!0;function U(Ie,re,oe){const _e=Ie[re];Ie[re]=Ie[oe],Ie[oe]=_e}p.prototype.swap16=function(){const re=this.length;if(re%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let oe=0;oe<re;oe+=2)U(this,oe,oe+1);return this},p.prototype.swap32=function(){const re=this.length;if(re%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let oe=0;oe<re;oe+=4)U(this,oe,oe+3),U(this,oe+1,oe+2);return this},p.prototype.swap64=function(){const re=this.length;if(re%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let oe=0;oe<re;oe+=8)U(this,oe,oe+7),U(this,oe+1,oe+6),U(this,oe+2,oe+5),U(this,oe+3,oe+4);return this},p.prototype.toString=function(){const re=this.length;return re===0?"":arguments.length===0?O(this,0,re):N.apply(this,arguments)},p.prototype.toLocaleString=p.prototype.toString,p.prototype.equals=function(re){if(!p.isBuffer(re))throw new TypeError("Argument must be a Buffer");return this===re?!0:p.compare(this,re)===0},p.prototype.inspect=function(){let re="";const oe=a.INSPECT_MAX_BYTES;return re=this.toString("hex",0,oe).replace(/(.{2})/g,"$1 ").trim(),this.length>oe&&(re+=" ... "),"<Buffer "+re+">"},R&&(p.prototype[R]=p.prototype.inspect),p.prototype.compare=function(re,oe,_e,Re,ke){if(we(re,Uint8Array)&&(re=p.from(re,re.offset,re.byteLength)),!p.isBuffer(re))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof re);if(oe===void 0&&(oe=0),_e===void 0&&(_e=re?re.length:0),Re===void 0&&(Re=0),ke===void 0&&(ke=this.length),oe<0||_e>re.length||Re<0||ke>this.length)throw new RangeError("out of range index");if(Re>=ke&&oe>=_e)return 0;if(Re>=ke)return-1;if(oe>=_e)return 1;if(oe>>>=0,_e>>>=0,Re>>>=0,ke>>>=0,this===re)return 0;let Be=ke-Re,at=_e-oe;const wt=Math.min(Be,at),ht=this.slice(Re,ke),_t=re.slice(oe,_e);for(let St=0;St<wt;++St)if(ht[St]!==_t[St]){Be=ht[St],at=_t[St];break}return Be<at?-1:at<Be?1:0};function H(Ie,re,oe,_e,Re){if(Ie.length===0)return-1;if(typeof oe=="string"?(_e=oe,oe=0):oe>2147483647?oe=2147483647:oe<-2147483648&&(oe=-2147483648),oe=+oe,je(oe)&&(oe=Re?0:Ie.length-1),oe<0&&(oe=Ie.length+oe),oe>=Ie.length){if(Re)return-1;oe=Ie.length-1}else if(oe<0)if(Re)oe=0;else return-1;if(typeof re=="string"&&(re=p.from(re,_e)),p.isBuffer(re))return re.length===0?-1:q(Ie,re,oe,_e,Re);if(typeof re=="number")return re=re&255,typeof Uint8Array.prototype.indexOf=="function"?Re?Uint8Array.prototype.indexOf.call(Ie,re,oe):Uint8Array.prototype.lastIndexOf.call(Ie,re,oe):q(Ie,[re],oe,_e,Re);throw new TypeError("val must be string, number or Buffer")}function q(Ie,re,oe,_e,Re){let ke=1,Be=Ie.length,at=re.length;if(_e!==void 0&&(_e=String(_e).toLowerCase(),_e==="ucs2"||_e==="ucs-2"||_e==="utf16le"||_e==="utf-16le")){if(Ie.length<2||re.length<2)return-1;ke=2,Be/=2,at/=2,oe/=2}function wt(_t,St){return ke===1?_t[St]:_t.readUInt16BE(St*ke)}let ht;if(Re){let _t=-1;for(ht=oe;ht<Be;ht++)if(wt(Ie,ht)===wt(re,_t===-1?0:ht-_t)){if(_t===-1&&(_t=ht),ht-_t+1===at)return _t*ke}else _t!==-1&&(ht-=ht-_t),_t=-1}else for(oe+at>Be&&(oe=Be-at),ht=oe;ht>=0;ht--){let _t=!0;for(let St=0;St<at;St++)if(wt(Ie,ht+St)!==wt(re,St)){_t=!1;break}if(_t)return ht}return-1}p.prototype.includes=function(re,oe,_e){return this.indexOf(re,oe,_e)!==-1},p.prototype.indexOf=function(re,oe,_e){return H(this,re,oe,_e,!0)},p.prototype.lastIndexOf=function(re,oe,_e){return H(this,re,oe,_e,!1)};function te(Ie,re,oe,_e){oe=Number(oe)||0;const Re=Ie.length-oe;_e?(_e=Number(_e),_e>Re&&(_e=Re)):_e=Re;const ke=re.length;_e>ke/2&&(_e=ke/2);let Be;for(Be=0;Be<_e;++Be){const at=parseInt(re.substr(Be*2,2),16);if(je(at))return Be;Ie[oe+Be]=at}return Be}function Q(Ie,re,oe,_e){return be(Ae(re,Ie.length-oe),Ie,oe,_e)}function Z(Ie,re,oe,_e){return be(Se(re),Ie,oe,_e)}function ae(Ie,re,oe,_e){return be(me(re),Ie,oe,_e)}function F(Ie,re,oe,_e){return be(Te(re,Ie.length-oe),Ie,oe,_e)}p.prototype.write=function(re,oe,_e,Re){if(oe===void 0)Re="utf8",_e=this.length,oe=0;else if(_e===void 0&&typeof oe=="string")Re=oe,_e=this.length,oe=0;else if(isFinite(oe))oe=oe>>>0,isFinite(_e)?(_e=_e>>>0,Re===void 0&&(Re="utf8")):(Re=_e,_e=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ke=this.length-oe;if((_e===void 0||_e>ke)&&(_e=ke),re.length>0&&(_e<0||oe<0)||oe>this.length)throw new RangeError("Attempt to write outside buffer bounds");Re||(Re="utf8");let Be=!1;for(;;)switch(Re){case"hex":return te(this,re,oe,_e);case"utf8":case"utf-8":return Q(this,re,oe,_e);case"ascii":case"latin1":case"binary":return Z(this,re,oe,_e);case"base64":return ae(this,re,oe,_e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,re,oe,_e);default:if(Be)throw new TypeError("Unknown encoding: "+Re);Re=(""+Re).toLowerCase(),Be=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(Ie,re,oe){return re===0&&oe===Ie.length?u.fromByteArray(Ie):u.fromByteArray(Ie.slice(re,oe))}function O(Ie,re,oe){oe=Math.min(Ie.length,oe);const _e=[];let Re=re;for(;Re<oe;){const ke=Ie[Re];let Be=null,at=ke>239?4:ke>223?3:ke>191?2:1;if(Re+at<=oe){let wt,ht,_t,St;switch(at){case 1:ke<128&&(Be=ke);break;case 2:wt=Ie[Re+1],(wt&192)===128&&(St=(ke&31)<<6|wt&63,St>127&&(Be=St));break;case 3:wt=Ie[Re+1],ht=Ie[Re+2],(wt&192)===128&&(ht&192)===128&&(St=(ke&15)<<12|(wt&63)<<6|ht&63,St>2047&&(St<55296||St>57343)&&(Be=St));break;case 4:wt=Ie[Re+1],ht=Ie[Re+2],_t=Ie[Re+3],(wt&192)===128&&(ht&192)===128&&(_t&192)===128&&(St=(ke&15)<<18|(wt&63)<<12|(ht&63)<<6|_t&63,St>65535&&St<1114112&&(Be=St))}}Be===null?(Be=65533,at=1):Be>65535&&(Be-=65536,_e.push(Be>>>10&1023|55296),Be=56320|Be&1023),_e.push(Be),Re+=at}return G(_e)}const X=4096;function G(Ie){const re=Ie.length;if(re<=X)return String.fromCharCode.apply(String,Ie);let oe="",_e=0;for(;_e<re;)oe+=String.fromCharCode.apply(String,Ie.slice(_e,_e+=X));return oe}function j(Ie,re,oe){let _e="";oe=Math.min(Ie.length,oe);for(let Re=re;Re<oe;++Re)_e+=String.fromCharCode(Ie[Re]&127);return _e}function K(Ie,re,oe){let _e="";oe=Math.min(Ie.length,oe);for(let Re=re;Re<oe;++Re)_e+=String.fromCharCode(Ie[Re]);return _e}function ce(Ie,re,oe){const _e=Ie.length;(!re||re<0)&&(re=0),(!oe||oe<0||oe>_e)&&(oe=_e);let Re="";for(let ke=re;ke<oe;++ke)Re+=lt[Ie[ke]];return Re}function se(Ie,re,oe){const _e=Ie.slice(re,oe);let Re="";for(let ke=0;ke<_e.length-1;ke+=2)Re+=String.fromCharCode(_e[ke]+_e[ke+1]*256);return Re}p.prototype.slice=function(re,oe){const _e=this.length;re=~~re,oe=oe===void 0?_e:~~oe,re<0?(re+=_e,re<0&&(re=0)):re>_e&&(re=_e),oe<0?(oe+=_e,oe<0&&(oe=0)):oe>_e&&(oe=_e),oe<re&&(oe=re);const Re=this.subarray(re,oe);return Object.setPrototypeOf(Re,p.prototype),Re};function ue(Ie,re,oe){if(Ie%1!==0||Ie<0)throw new RangeError("offset is not uint");if(Ie+re>oe)throw new RangeError("Trying to access beyond buffer length")}p.prototype.readUintLE=p.prototype.readUIntLE=function(re,oe,_e){re=re>>>0,oe=oe>>>0,_e||ue(re,oe,this.length);let Re=this[re],ke=1,Be=0;for(;++Be<oe&&(ke*=256);)Re+=this[re+Be]*ke;return Re},p.prototype.readUintBE=p.prototype.readUIntBE=function(re,oe,_e){re=re>>>0,oe=oe>>>0,_e||ue(re,oe,this.length);let Re=this[re+--oe],ke=1;for(;oe>0&&(ke*=256);)Re+=this[re+--oe]*ke;return Re},p.prototype.readUint8=p.prototype.readUInt8=function(re,oe){return re=re>>>0,oe||ue(re,1,this.length),this[re]},p.prototype.readUint16LE=p.prototype.readUInt16LE=function(re,oe){return re=re>>>0,oe||ue(re,2,this.length),this[re]|this[re+1]<<8},p.prototype.readUint16BE=p.prototype.readUInt16BE=function(re,oe){return re=re>>>0,oe||ue(re,2,this.length),this[re]<<8|this[re+1]},p.prototype.readUint32LE=p.prototype.readUInt32LE=function(re,oe){return re=re>>>0,oe||ue(re,4,this.length),(this[re]|this[re+1]<<8|this[re+2]<<16)+this[re+3]*16777216},p.prototype.readUint32BE=p.prototype.readUInt32BE=function(re,oe){return re=re>>>0,oe||ue(re,4,this.length),this[re]*16777216+(this[re+1]<<16|this[re+2]<<8|this[re+3])},p.prototype.readBigUInt64LE=ot(function(re){re=re>>>0,tt(re,"offset");const oe=this[re],_e=this[re+7];(oe===void 0||_e===void 0)&&ye(re,this.length-8);const Re=oe+this[++re]*2**8+this[++re]*2**16+this[++re]*2**24,ke=this[++re]+this[++re]*2**8+this[++re]*2**16+_e*2**24;return BigInt(Re)+(BigInt(ke)<<BigInt(32))}),p.prototype.readBigUInt64BE=ot(function(re){re=re>>>0,tt(re,"offset");const oe=this[re],_e=this[re+7];(oe===void 0||_e===void 0)&&ye(re,this.length-8);const Re=oe*2**24+this[++re]*2**16+this[++re]*2**8+this[++re],ke=this[++re]*2**24+this[++re]*2**16+this[++re]*2**8+_e;return(BigInt(Re)<<BigInt(32))+BigInt(ke)}),p.prototype.readIntLE=function(re,oe,_e){re=re>>>0,oe=oe>>>0,_e||ue(re,oe,this.length);let Re=this[re],ke=1,Be=0;for(;++Be<oe&&(ke*=256);)Re+=this[re+Be]*ke;return ke*=128,Re>=ke&&(Re-=Math.pow(2,8*oe)),Re},p.prototype.readIntBE=function(re,oe,_e){re=re>>>0,oe=oe>>>0,_e||ue(re,oe,this.length);let Re=oe,ke=1,Be=this[re+--Re];for(;Re>0&&(ke*=256);)Be+=this[re+--Re]*ke;return ke*=128,Be>=ke&&(Be-=Math.pow(2,8*oe)),Be},p.prototype.readInt8=function(re,oe){return re=re>>>0,oe||ue(re,1,this.length),this[re]&128?(255-this[re]+1)*-1:this[re]},p.prototype.readInt16LE=function(re,oe){re=re>>>0,oe||ue(re,2,this.length);const _e=this[re]|this[re+1]<<8;return _e&32768?_e|4294901760:_e},p.prototype.readInt16BE=function(re,oe){re=re>>>0,oe||ue(re,2,this.length);const _e=this[re+1]|this[re]<<8;return _e&32768?_e|4294901760:_e},p.prototype.readInt32LE=function(re,oe){return re=re>>>0,oe||ue(re,4,this.length),this[re]|this[re+1]<<8|this[re+2]<<16|this[re+3]<<24},p.prototype.readInt32BE=function(re,oe){return re=re>>>0,oe||ue(re,4,this.length),this[re]<<24|this[re+1]<<16|this[re+2]<<8|this[re+3]},p.prototype.readBigInt64LE=ot(function(re){re=re>>>0,tt(re,"offset");const oe=this[re],_e=this[re+7];(oe===void 0||_e===void 0)&&ye(re,this.length-8);const Re=this[re+4]+this[re+5]*2**8+this[re+6]*2**16+(_e<<24);return(BigInt(Re)<<BigInt(32))+BigInt(oe+this[++re]*2**8+this[++re]*2**16+this[++re]*2**24)}),p.prototype.readBigInt64BE=ot(function(re){re=re>>>0,tt(re,"offset");const oe=this[re],_e=this[re+7];(oe===void 0||_e===void 0)&&ye(re,this.length-8);const Re=(oe<<24)+this[++re]*2**16+this[++re]*2**8+this[++re];return(BigInt(Re)<<BigInt(32))+BigInt(this[++re]*2**24+this[++re]*2**16+this[++re]*2**8+_e)}),p.prototype.readFloatLE=function(re,oe){return re=re>>>0,oe||ue(re,4,this.length),h.read(this,re,!0,23,4)},p.prototype.readFloatBE=function(re,oe){return re=re>>>0,oe||ue(re,4,this.length),h.read(this,re,!1,23,4)},p.prototype.readDoubleLE=function(re,oe){return re=re>>>0,oe||ue(re,8,this.length),h.read(this,re,!0,52,8)},p.prototype.readDoubleBE=function(re,oe){return re=re>>>0,oe||ue(re,8,this.length),h.read(this,re,!1,52,8)};function Y(Ie,re,oe,_e,Re,ke){if(!p.isBuffer(Ie))throw new TypeError('"buffer" argument must be a Buffer instance');if(re>Re||re<ke)throw new RangeError('"value" argument is out of bounds');if(oe+_e>Ie.length)throw new RangeError("Index out of range")}p.prototype.writeUintLE=p.prototype.writeUIntLE=function(re,oe,_e,Re){if(re=+re,oe=oe>>>0,_e=_e>>>0,!Re){const at=Math.pow(2,8*_e)-1;Y(this,re,oe,_e,at,0)}let ke=1,Be=0;for(this[oe]=re&255;++Be<_e&&(ke*=256);)this[oe+Be]=re/ke&255;return oe+_e},p.prototype.writeUintBE=p.prototype.writeUIntBE=function(re,oe,_e,Re){if(re=+re,oe=oe>>>0,_e=_e>>>0,!Re){const at=Math.pow(2,8*_e)-1;Y(this,re,oe,_e,at,0)}let ke=_e-1,Be=1;for(this[oe+ke]=re&255;--ke>=0&&(Be*=256);)this[oe+ke]=re/Be&255;return oe+_e},p.prototype.writeUint8=p.prototype.writeUInt8=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,1,255,0),this[oe]=re&255,oe+1},p.prototype.writeUint16LE=p.prototype.writeUInt16LE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,2,65535,0),this[oe]=re&255,this[oe+1]=re>>>8,oe+2},p.prototype.writeUint16BE=p.prototype.writeUInt16BE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,2,65535,0),this[oe]=re>>>8,this[oe+1]=re&255,oe+2},p.prototype.writeUint32LE=p.prototype.writeUInt32LE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,4,4294967295,0),this[oe+3]=re>>>24,this[oe+2]=re>>>16,this[oe+1]=re>>>8,this[oe]=re&255,oe+4},p.prototype.writeUint32BE=p.prototype.writeUInt32BE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,4,4294967295,0),this[oe]=re>>>24,this[oe+1]=re>>>16,this[oe+2]=re>>>8,this[oe+3]=re&255,oe+4};function pe(Ie,re,oe,_e,Re){Xe(re,_e,Re,Ie,oe,7);let ke=Number(re&BigInt(4294967295));Ie[oe++]=ke,ke=ke>>8,Ie[oe++]=ke,ke=ke>>8,Ie[oe++]=ke,ke=ke>>8,Ie[oe++]=ke;let Be=Number(re>>BigInt(32)&BigInt(4294967295));return Ie[oe++]=Be,Be=Be>>8,Ie[oe++]=Be,Be=Be>>8,Ie[oe++]=Be,Be=Be>>8,Ie[oe++]=Be,oe}function Ee(Ie,re,oe,_e,Re){Xe(re,_e,Re,Ie,oe,7);let ke=Number(re&BigInt(4294967295));Ie[oe+7]=ke,ke=ke>>8,Ie[oe+6]=ke,ke=ke>>8,Ie[oe+5]=ke,ke=ke>>8,Ie[oe+4]=ke;let Be=Number(re>>BigInt(32)&BigInt(4294967295));return Ie[oe+3]=Be,Be=Be>>8,Ie[oe+2]=Be,Be=Be>>8,Ie[oe+1]=Be,Be=Be>>8,Ie[oe]=Be,oe+8}p.prototype.writeBigUInt64LE=ot(function(re,oe=0){return pe(this,re,oe,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeBigUInt64BE=ot(function(re,oe=0){return Ee(this,re,oe,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeIntLE=function(re,oe,_e,Re){if(re=+re,oe=oe>>>0,!Re){const wt=Math.pow(2,8*_e-1);Y(this,re,oe,_e,wt-1,-wt)}let ke=0,Be=1,at=0;for(this[oe]=re&255;++ke<_e&&(Be*=256);)re<0&&at===0&&this[oe+ke-1]!==0&&(at=1),this[oe+ke]=(re/Be>>0)-at&255;return oe+_e},p.prototype.writeIntBE=function(re,oe,_e,Re){if(re=+re,oe=oe>>>0,!Re){const wt=Math.pow(2,8*_e-1);Y(this,re,oe,_e,wt-1,-wt)}let ke=_e-1,Be=1,at=0;for(this[oe+ke]=re&255;--ke>=0&&(Be*=256);)re<0&&at===0&&this[oe+ke+1]!==0&&(at=1),this[oe+ke]=(re/Be>>0)-at&255;return oe+_e},p.prototype.writeInt8=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,1,127,-128),re<0&&(re=255+re+1),this[oe]=re&255,oe+1},p.prototype.writeInt16LE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,2,32767,-32768),this[oe]=re&255,this[oe+1]=re>>>8,oe+2},p.prototype.writeInt16BE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,2,32767,-32768),this[oe]=re>>>8,this[oe+1]=re&255,oe+2},p.prototype.writeInt32LE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,4,2147483647,-2147483648),this[oe]=re&255,this[oe+1]=re>>>8,this[oe+2]=re>>>16,this[oe+3]=re>>>24,oe+4},p.prototype.writeInt32BE=function(re,oe,_e){return re=+re,oe=oe>>>0,_e||Y(this,re,oe,4,2147483647,-2147483648),re<0&&(re=4294967295+re+1),this[oe]=re>>>24,this[oe+1]=re>>>16,this[oe+2]=re>>>8,this[oe+3]=re&255,oe+4},p.prototype.writeBigInt64LE=ot(function(re,oe=0){return pe(this,re,oe,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),p.prototype.writeBigInt64BE=ot(function(re,oe=0){return Ee(this,re,oe,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Fe(Ie,re,oe,_e,Re,ke){if(oe+_e>Ie.length)throw new RangeError("Index out of range");if(oe<0)throw new RangeError("Index out of range")}function $e(Ie,re,oe,_e,Re){return re=+re,oe=oe>>>0,Re||Fe(Ie,re,oe,4),h.write(Ie,re,oe,_e,23,4),oe+4}p.prototype.writeFloatLE=function(re,oe,_e){return $e(this,re,oe,!0,_e)},p.prototype.writeFloatBE=function(re,oe,_e){return $e(this,re,oe,!1,_e)};function pt(Ie,re,oe,_e,Re){return re=+re,oe=oe>>>0,Re||Fe(Ie,re,oe,8),h.write(Ie,re,oe,_e,52,8),oe+8}p.prototype.writeDoubleLE=function(re,oe,_e){return pt(this,re,oe,!0,_e)},p.prototype.writeDoubleBE=function(re,oe,_e){return pt(this,re,oe,!1,_e)},p.prototype.copy=function(re,oe,_e,Re){if(!p.isBuffer(re))throw new TypeError("argument should be a Buffer");if(_e||(_e=0),!Re&&Re!==0&&(Re=this.length),oe>=re.length&&(oe=re.length),oe||(oe=0),Re>0&&Re<_e&&(Re=_e),Re===_e||re.length===0||this.length===0)return 0;if(oe<0)throw new RangeError("targetStart out of bounds");if(_e<0||_e>=this.length)throw new RangeError("Index out of range");if(Re<0)throw new RangeError("sourceEnd out of bounds");Re>this.length&&(Re=this.length),re.length-oe<Re-_e&&(Re=re.length-oe+_e);const ke=Re-_e;return this===re&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(oe,_e,Re):Uint8Array.prototype.set.call(re,this.subarray(_e,Re),oe),ke},p.prototype.fill=function(re,oe,_e,Re){if(typeof re=="string"){if(typeof oe=="string"?(Re=oe,oe=0,_e=this.length):typeof _e=="string"&&(Re=_e,_e=this.length),Re!==void 0&&typeof Re!="string")throw new TypeError("encoding must be a string");if(typeof Re=="string"&&!p.isEncoding(Re))throw new TypeError("Unknown encoding: "+Re);if(re.length===1){const Be=re.charCodeAt(0);(Re==="utf8"&&Be<128||Re==="latin1")&&(re=Be)}}else typeof re=="number"?re=re&255:typeof re=="boolean"&&(re=Number(re));if(oe<0||this.length<oe||this.length<_e)throw new RangeError("Out of range index");if(_e<=oe)return this;oe=oe>>>0,_e=_e===void 0?this.length:_e>>>0,re||(re=0);let ke;if(typeof re=="number")for(ke=oe;ke<_e;++ke)this[ke]=re;else{const Be=p.isBuffer(re)?re:p.from(re,Re),at=Be.length;if(at===0)throw new TypeError('The value "'+re+'" is invalid for argument "value"');for(ke=0;ke<_e-oe;++ke)this[ke+oe]=Be[ke%at]}return this};const Ue={};function Je(Ie,re,oe){Ue[Ie]=class extends oe{constructor(){super(),Object.defineProperty(this,"message",{value:re.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Ie}]`,this.stack,delete this.name}get code(){return Ie}set code(Re){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Re,writable:!0})}toString(){return`${this.name} [${Ie}]: ${this.message}`}}}Je("ERR_BUFFER_OUT_OF_BOUNDS",function(Ie){return Ie?`${Ie} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Je("ERR_INVALID_ARG_TYPE",function(Ie,re){return`The "${Ie}" argument must be of type number. Received type ${typeof re}`},TypeError),Je("ERR_OUT_OF_RANGE",function(Ie,re,oe){let _e=`The value of "${Ie}" is out of range.`,Re=oe;return Number.isInteger(oe)&&Math.abs(oe)>2**32?Re=et(String(oe)):typeof oe=="bigint"&&(Re=String(oe),(oe>BigInt(2)**BigInt(32)||oe<-(BigInt(2)**BigInt(32)))&&(Re=et(Re)),Re+="n"),_e+=` It must be ${re}. Received ${Re}`,_e},RangeError);function et(Ie){let re="",oe=Ie.length;const _e=Ie[0]==="-"?1:0;for(;oe>=_e+4;oe-=3)re=`_${Ie.slice(oe-3,oe)}${re}`;return`${Ie.slice(0,oe)}${re}`}function ze(Ie,re,oe){tt(re,"offset"),(Ie[re]===void 0||Ie[re+oe]===void 0)&&ye(re,Ie.length-(oe+1))}function Xe(Ie,re,oe,_e,Re,ke){if(Ie>oe||Ie<re){const Be=typeof re=="bigint"?"n":"";let at;throw ke>3?re===0||re===BigInt(0)?at=`>= 0${Be} and < 2${Be} ** ${(ke+1)*8}${Be}`:at=`>= -(2${Be} ** ${(ke+1)*8-1}${Be}) and < 2 ** ${(ke+1)*8-1}${Be}`:at=`>= ${re}${Be} and <= ${oe}${Be}`,new Ue.ERR_OUT_OF_RANGE("value",at,Ie)}ze(_e,Re,ke)}function tt(Ie,re){if(typeof Ie!="number")throw new Ue.ERR_INVALID_ARG_TYPE(re,"number",Ie)}function ye(Ie,re,oe){throw Math.floor(Ie)!==Ie?(tt(Ie,oe),new Ue.ERR_OUT_OF_RANGE(oe||"offset","an integer",Ie)):re<0?new Ue.ERR_BUFFER_OUT_OF_BOUNDS:new Ue.ERR_OUT_OF_RANGE(oe||"offset",`>= ${oe?1:0} and <= ${re}`,Ie)}const Ze=/[^+/0-9A-Za-z-_]/g;function Ge(Ie){if(Ie=Ie.split("=")[0],Ie=Ie.trim().replace(Ze,""),Ie.length<2)return"";for(;Ie.length%4!==0;)Ie=Ie+"=";return Ie}function Ae(Ie,re){re=re||1/0;let oe;const _e=Ie.length;let Re=null;const ke=[];for(let Be=0;Be<_e;++Be){if(oe=Ie.charCodeAt(Be),oe>55295&&oe<57344){if(!Re){if(oe>56319){(re-=3)>-1&&ke.push(239,191,189);continue}else if(Be+1===_e){(re-=3)>-1&&ke.push(239,191,189);continue}Re=oe;continue}if(oe<56320){(re-=3)>-1&&ke.push(239,191,189),Re=oe;continue}oe=(Re-55296<<10|oe-56320)+65536}else Re&&(re-=3)>-1&&ke.push(239,191,189);if(Re=null,oe<128){if((re-=1)<0)break;ke.push(oe)}else if(oe<2048){if((re-=2)<0)break;ke.push(oe>>6|192,oe&63|128)}else if(oe<65536){if((re-=3)<0)break;ke.push(oe>>12|224,oe>>6&63|128,oe&63|128)}else if(oe<1114112){if((re-=4)<0)break;ke.push(oe>>18|240,oe>>12&63|128,oe>>6&63|128,oe&63|128)}else throw new Error("Invalid code point")}return ke}function Se(Ie){const re=[];for(let oe=0;oe<Ie.length;++oe)re.push(Ie.charCodeAt(oe)&255);return re}function Te(Ie,re){let oe,_e,Re;const ke=[];for(let Be=0;Be<Ie.length&&!((re-=2)<0);++Be)oe=Ie.charCodeAt(Be),_e=oe>>8,Re=oe%256,ke.push(Re),ke.push(_e);return ke}function me(Ie){return u.toByteArray(Ge(Ie))}function be(Ie,re,oe,_e){let Re;for(Re=0;Re<_e&&!(Re+oe>=re.length||Re>=Ie.length);++Re)re[Re+oe]=Ie[Re];return Re}function we(Ie,re){return Ie instanceof re||Ie!=null&&Ie.constructor!=null&&Ie.constructor.name!=null&&Ie.constructor.name===re.name}function je(Ie){return Ie!==Ie}const lt=function(){const Ie="0123456789abcdef",re=new Array(256);for(let oe=0;oe<16;++oe){const _e=oe*16;for(let Re=0;Re<16;++Re)re[_e+Re]=Ie[oe]+Ie[Re]}return re}();function ot(Ie){return typeof BigInt>"u"?bt:Ie}function bt(){throw new Error("BigInt not supported")}}(AM)),AM}var wM,oR;function Rk(){if(oR)return wM;oR=1;const a=QC(),u=KC(),h=d2().Buffer;wM=R;function R(M,v){return new a(function(y,p){const g=u(M,v),C=new XMLHttpRequest;C.open("GET",g,!0),v!=="prj"&&v!=="cpg"&&(C.responseType="arraybuffer"),C.addEventListener("load",function(){return C.status>399?v==="prj"||v==="cpg"?y(!1):p(new Error(C.status)):y(v!=="prj"&&v!=="cpg"?h.from(C.response):C.response)},!1),C.send()})}return wM}var MM,uR;function Ck(){if(uR)return MM;uR=1;const a=Rk(),u=KC(),h=d2().Buffer;return MM=async function(M,v){if(!ua.fetch)return a(M,v);const y=u(M,v),p=v==="prj"||v==="cpg";try{const g=await fetch(y);if(g.status>399)throw new Error(g.statusText);if(p)return g.text();const C=await g.arrayBuffer();return h.from(C)}catch(g){if(console.log("ERROR",g,v),p||v==="dbf")return!1;throw g}},MM}var bM,lR;function Pk(){if(lR)return bM;lR=1;function a(v){let y=0,p=1;const g=v.length;let C,D;for(;p<g;)C=D||v[0],D=v[p],y+=(D[0]-C[0])*(D[1]+C[1]),p++;return y>0}function u(v,y){return a(y)||!v.length?v.push([y]):v[v.length-1].push(y),v}M.prototype.parsePoint=function(v){return{type:"Point",coordinates:this.parseCoord(v,0)}},M.prototype.parseZPoint=function(v){const y=this.parsePoint(v);return y.coordinates.push(v.readDoubleLE(16)),y},M.prototype.parsePointArray=function(v,y,p){const g=[];let C=0;for(;C<p;)g.push(this.parseCoord(v,y)),y+=16,C++;return g},M.prototype.parseZPointArray=function(v,y,p,g){let C=0;for(;C<p;)g[C].push(v.readDoubleLE(y)),C++,y+=8;return g},M.prototype.parseArrayGroup=function(v,y,p,g,C){const D=[];let B=0,V,P=0,L;for(;B<g;)B++,p+=4,V=P,B===g?P=C:P=v.readInt32LE(p),L=P-V,L&&(D.push(this.parsePointArray(v,y,L)),y+=L<<4);return D},M.prototype.parseZArrayGroup=function(v,y,p,g){let C=0;for(;C<p;)g[C]=this.parseZPointArray(v,y,g[C].length,g[C]),y+=g[C].length<<3,C++;return g},M.prototype.parseMultiPoint=function(v){const y={},p=v.readInt32LE(32,!0);if(!p)return null;const g=this.parseCoord(v,0),C=this.parseCoord(v,16);y.bbox=[g[0],g[1],C[0],C[1]];const D=36;return p===1?(y.type="Point",y.coordinates=this.parseCoord(v,D)):(y.type="MultiPoint",y.coordinates=this.parsePointArray(v,D,p)),y},M.prototype.parseZMultiPoint=function(v){const y=this.parseMultiPoint(v);if(!y)return null;let p;if(y.type==="Point")return y.coordinates.push(v.readDoubleLE(72)),y;p=y.coordinates.length;const g=52+(p<<4);return y.coordinates=this.parseZPointArray(v,g,p,y.coordinates),y},M.prototype.parsePolyline=function(v){const y={},p=v.readInt32LE(32);if(!p)return null;const g=this.parseCoord(v,0),C=this.parseCoord(v,16);y.bbox=[g[0],g[1],C[0],C[1]];const D=v.readInt32LE(36);let B,V;return p===1?(y.type="LineString",B=44,y.coordinates=this.parsePointArray(v,B,D)):(y.type="MultiLineString",B=40+(p<<2),V=40,y.coordinates=this.parseArrayGroup(v,B,V,p,D)),y},M.prototype.parseZPolyline=function(v){const y=this.parsePolyline(v);if(!y)return null;const p=y.coordinates.length;let g;if(y.type==="LineString")return g=60+(p<<4),y.coordinates=this.parseZPointArray(v,g,p,y.coordinates),y;{const C=y.coordinates.reduce(function(D,B){return D+B.length},0);return g=56+(C<<4)+(p<<2),y.coordinates=this.parseZArrayGroup(v,g,p,y.coordinates),y}},M.prototype.polyFuncs=function(v){return v&&(v.type==="LineString"?(v.type="Polygon",v.coordinates=[v.coordinates],v):(v.coordinates=v.coordinates.reduce(u,[]),v.coordinates.length===1?(v.type="Polygon",v.coordinates=v.coordinates[0],v):(v.type="MultiPolygon",v)))},M.prototype.parsePolygon=function(v){return this.polyFuncs(this.parsePolyline(v))},M.prototype.parseZPolygon=function(v){return this.polyFuncs(this.parseZPolyline(v))};const h={1:"parsePoint",3:"parsePolyline",5:"parsePolygon",8:"parseMultiPoint",11:"parseZPoint",13:"parseZPolyline",15:"parseZPolygon",18:"parseZMultiPoint"};function R(v){return v?function(y,p){const g=[y.readDoubleLE(p),y.readDoubleLE(p+8)];return v.inverse(g)}:function(y,p){return[y.readDoubleLE(p),y.readDoubleLE(p+8)]}}function M(v,y){if(!(this instanceof M))return new M(v,y);this.buffer=v,this.headers=this.parseHeader(),this.headers.length<this.buffer.byteLength&&(this.buffer=this.buffer.slice(0,this.headers.length)),this.shpFuncs(y),this.rows=this.getRows()}return M.prototype.shpFuncs=function(v){let y=this.headers.shpCode;if(y>20&&(y-=20),!(y in h))throw new Error("I don't know that shp type");this.parseFunc=this[h[y]],this.parseCoord=R(v)},M.prototype.getShpCode=function(){return this.parseHeader().shpCode},M.prototype.parseHeader=function(){const v=this.buffer.slice(0,100);return{length:v.readInt32BE(6<<2)<<1,version:v.readInt32LE(7<<2),shpCode:v.readInt32LE(8<<2),bbox:[v.readDoubleLE(9<<2),v.readDoubleLE(11<<2),v.readDoubleLE(13<<2),v.readDoubleLE(13<<2)]}},M.prototype.getRows=function(){let v=100;const y=this.buffer.byteLength,p=[];let g;for(;v<y&&(g=this.getRow(v),!!g);)v+=8,v+=g.len,g.type?p.push(this.parseFunc(g.data)):p.push(null);return p},M.prototype.getRow=function(v){const y=this.buffer.slice(v,v+12),p=y.readInt32BE(4)<<1,g=y.readInt32BE(0);return p===0?{id:g,len:p,type:0}:{id:g,len:p,data:this.buffer.slice(v+12,v+p+8),type:y.readInt32LE(8)}},bM=function(v,y){return new M(v,y).rows},bM}var EM={exports:{}},TM={exports:{}},cR;function Lk(){return cR||(cR=1,function(a){(function(u){a.exports&&u["encoding-indexes"];function h(Ae,Se,Te){return Se<=Ae&&Ae<=Te}function R(Ae,Se){return Ae.indexOf(Se)!==-1}var M=Math.floor;function v(Ae){if(Ae===void 0)return{};if(Ae===Object(Ae))return Ae;throw TypeError("Could not convert argument to dictionary")}function y(Ae){for(var Se=String(Ae),Te=Se.length,me=0,be=[];me<Te;){var we=Se.charCodeAt(me);if(we<55296||we>57343)be.push(we);else if(56320<=we&&we<=57343)be.push(65533);else if(55296<=we&&we<=56319)if(me===Te-1)be.push(65533);else{var je=Se.charCodeAt(me+1);if(56320<=je&&je<=57343){var lt=we&1023,ot=je&1023;be.push(65536+(lt<<10)+ot),me+=1}else be.push(65533)}me+=1}return be}function p(Ae){for(var Se="",Te=0;Te<Ae.length;++Te){var me=Ae[Te];me<=65535?Se+=String.fromCharCode(me):(me-=65536,Se+=String.fromCharCode((me>>10)+55296,(me&1023)+56320))}return Se}function g(Ae){return 0<=Ae&&Ae<=127}var C=g,D=-1;function B(Ae){this.tokens=[].slice.call(Ae),this.tokens.reverse()}B.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.pop():D},prepend:function(Ae){if(Array.isArray(Ae))for(var Se=Ae;Se.length;)this.tokens.push(Se.pop());else this.tokens.push(Ae)},push:function(Ae){if(Array.isArray(Ae))for(var Se=Ae;Se.length;)this.tokens.unshift(Se.shift());else this.tokens.unshift(Ae)}};var V=-1;function P(Ae,Se){if(Ae)throw TypeError("Decoder error");return Se||65533}function L(Ae){throw TypeError("The code point "+Ae+" could not be encoded.")}function E(Ae){return Ae=String(Ae).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(_,Ae)?_[Ae]:null}var b=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"UTF-8"}],heading:"The Encoding"},{encodings:[{labels:["866","cp866","csibm866","ibm866"],name:"IBM866"},{labels:["csisolatin2","iso-8859-2","iso-ir-101","iso8859-2","iso88592","iso_8859-2","iso_8859-2:1987","l2","latin2"],name:"ISO-8859-2"},{labels:["csisolatin3","iso-8859-3","iso-ir-109","iso8859-3","iso88593","iso_8859-3","iso_8859-3:1988","l3","latin3"],name:"ISO-8859-3"},{labels:["csisolatin4","iso-8859-4","iso-ir-110","iso8859-4","iso88594","iso_8859-4","iso_8859-4:1988","l4","latin4"],name:"ISO-8859-4"},{labels:["csisolatincyrillic","cyrillic","iso-8859-5","iso-ir-144","iso8859-5","iso88595","iso_8859-5","iso_8859-5:1988"],name:"ISO-8859-5"},{labels:["arabic","asmo-708","csiso88596e","csiso88596i","csisolatinarabic","ecma-114","iso-8859-6","iso-8859-6-e","iso-8859-6-i","iso-ir-127","iso8859-6","iso88596","iso_8859-6","iso_8859-6:1987"],name:"ISO-8859-6"},{labels:["csisolatingreek","ecma-118","elot_928","greek","greek8","iso-8859-7","iso-ir-126","iso8859-7","iso88597","iso_8859-7","iso_8859-7:1987","sun_eu_greek"],name:"ISO-8859-7"},{labels:["csiso88598e","csisolatinhebrew","hebrew","iso-8859-8","iso-8859-8-e","iso-ir-138","iso8859-8","iso88598","iso_8859-8","iso_8859-8:1988","visual"],name:"ISO-8859-8"},{labels:["csiso88598i","iso-8859-8-i","logical"],name:"ISO-8859-8-I"},{labels:["csisolatin6","iso-8859-10","iso-ir-157","iso8859-10","iso885910","l6","latin6"],name:"ISO-8859-10"},{labels:["iso-8859-13","iso8859-13","iso885913"],name:"ISO-8859-13"},{labels:["iso-8859-14","iso8859-14","iso885914"],name:"ISO-8859-14"},{labels:["csisolatin9","iso-8859-15","iso8859-15","iso885915","iso_8859-15","l9"],name:"ISO-8859-15"},{labels:["iso-8859-16"],name:"ISO-8859-16"},{labels:["cskoi8r","koi","koi8","koi8-r","koi8_r"],name:"KOI8-R"},{labels:["koi8-ru","koi8-u"],name:"KOI8-U"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:["dos-874","iso-8859-11","iso8859-11","iso885911","tis-620","windows-874"],name:"windows-874"},{labels:["cp1250","windows-1250","x-cp1250"],name:"windows-1250"},{labels:["cp1251","windows-1251","x-cp1251"],name:"windows-1251"},{labels:["ansi_x3.4-1968","ascii","cp1252","cp819","csisolatin1","ibm819","iso-8859-1","iso-ir-100","iso8859-1","iso88591","iso_8859-1","iso_8859-1:1987","l1","latin1","us-ascii","windows-1252","x-cp1252"],name:"windows-1252"},{labels:["cp1253","windows-1253","x-cp1253"],name:"windows-1253"},{labels:["cp1254","csisolatin5","iso-8859-9","iso-ir-148","iso8859-9","iso88599","iso_8859-9","iso_8859-9:1989","l5","latin5","windows-1254","x-cp1254"],name:"windows-1254"},{labels:["cp1255","windows-1255","x-cp1255"],name:"windows-1255"},{labels:["cp1256","windows-1256","x-cp1256"],name:"windows-1256"},{labels:["cp1257","windows-1257","x-cp1257"],name:"windows-1257"},{labels:["cp1258","windows-1258","x-cp1258"],name:"windows-1258"},{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:["chinese","csgb2312","csiso58gb231280","gb2312","gb_2312","gb_2312-80","gbk","iso-ir-58","x-gbk"],name:"GBK"},{labels:["gb18030"],name:"gb18030"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"Big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese","euc-jp","x-euc-jp"],name:"EUC-JP"},{labels:["csiso2022jp","iso-2022-jp"],name:"ISO-2022-JP"},{labels:["csshiftjis","ms932","ms_kanji","shift-jis","shift_jis","sjis","windows-31j","x-sjis"],name:"Shift_JIS"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:["cseuckr","csksc56011987","euc-kr","iso-ir-149","korean","ks_c_5601-1987","ks_c_5601-1989","ksc5601","ksc_5601","windows-949"],name:"EUC-KR"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["csiso2022kr","hz-gb-2312","iso-2022-cn","iso-2022-cn-ext","iso-2022-kr"],name:"replacement"},{labels:["utf-16be"],name:"UTF-16BE"},{labels:["utf-16","utf-16le"],name:"UTF-16LE"},{labels:["x-user-defined"],name:"x-user-defined"}],heading:"Legacy miscellaneous encodings"}],_={};b.forEach(function(Ae){Ae.encodings.forEach(function(Se){Se.labels.forEach(function(Te){_[Te]=Se})})});var x={},T={};function N(Ae,Se){return Se&&Se[Ae]||null}function U(Ae,Se){var Te=Se.indexOf(Ae);return Te===-1?null:Te}function H(Ae){if(!("encoding-indexes"in u))throw Error("Indexes missing. Did you forget to include encoding-indexes.js first?");return u["encoding-indexes"][Ae]}function q(Ae){if(Ae>39419&&Ae<189e3||Ae>1237575)return null;if(Ae===7457)return 59335;var Se=0,Te=0,me=H("gb18030-ranges"),be;for(be=0;be<me.length;++be){var we=me[be];if(we[0]<=Ae)Se=we[0],Te=we[1];else break}return Te+Ae-Se}function te(Ae){if(Ae===59335)return 7457;var Se=0,Te=0,me=H("gb18030-ranges"),be;for(be=0;be<me.length;++be){var we=me[be];if(we[1]<=Ae)Se=we[1],Te=we[0];else break}return Te+Ae-Se}function Q(Ae){Z=Z||H("jis0208").map(function(Te,me){return h(me,8272,8835)?null:Te});var Se=Z;return Se.indexOf(Ae)}var Z;function ae(Ae){F=F||H("big5").map(function(Te,me){return me<(161-129)*157?null:Te});var Se=F;return Ae===9552||Ae===9566||Ae===9569||Ae===9578||Ae===21313||Ae===21317?Se.lastIndexOf(Ae):U(Ae,Se)}var F,W="utf-8";function O(Ae,Se){if(!(this instanceof O))throw TypeError("Called as a function. Did you forget 'new'?");Ae=Ae!==void 0?String(Ae):W,Se=v(Se),this._encoding=null,this._decoder=null,this._ignoreBOM=!1,this._BOMseen=!1,this._error_mode="replacement",this._do_not_flush=!1;var Te=E(Ae);if(Te===null||Te.name==="replacement")throw RangeError("Unknown encoding: "+Ae);if(!T[Te.name])throw Error("Decoder not present. Did you forget to include encoding-indexes.js first?");var me=this;return me._encoding=Te,Boolean(Se.fatal)&&(me._error_mode="fatal"),Boolean(Se.ignoreBOM)&&(me._ignoreBOM=!0),Object.defineProperty||(this.encoding=me._encoding.name.toLowerCase(),this.fatal=me._error_mode==="fatal",this.ignoreBOM=me._ignoreBOM),me}Object.defineProperty&&(Object.defineProperty(O.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),Object.defineProperty(O.prototype,"fatal",{get:function(){return this._error_mode==="fatal"}}),Object.defineProperty(O.prototype,"ignoreBOM",{get:function(){return this._ignoreBOM}})),O.prototype.decode=function(Se,Te){var me;typeof Se=="object"&&Se instanceof ArrayBuffer?me=new Uint8Array(Se):typeof Se=="object"&&"buffer"in Se&&Se.buffer instanceof ArrayBuffer?me=new Uint8Array(Se.buffer,Se.byteOffset,Se.byteLength):me=new Uint8Array(0),Te=v(Te),this._do_not_flush||(this._decoder=T[this._encoding.name]({fatal:this._error_mode==="fatal"}),this._BOMseen=!1),this._do_not_flush=Boolean(Te.stream);for(var be=new B(me),we=[],je;;){var lt=be.read();if(lt===D||(je=this._decoder.handler(be,lt),je===V))break;je!==null&&(Array.isArray(je)?we.push.apply(we,je):we.push(je))}if(!this._do_not_flush){do{if(je=this._decoder.handler(be,be.read()),je===V)break;je!==null&&(Array.isArray(je)?we.push.apply(we,je):we.push(je))}while(!be.endOfStream());this._decoder=null}function ot(bt){return R(["UTF-8","UTF-16LE","UTF-16BE"],this._encoding.name)&&!this._ignoreBOM&&!this._BOMseen&&(bt.length>0&&bt[0]===65279?(this._BOMseen=!0,bt.shift()):bt.length>0&&(this._BOMseen=!0)),p(bt)}return ot.call(this,we)};function X(Ae,Se){if(!(this instanceof X))throw TypeError("Called as a function. Did you forget 'new'?");Se=v(Se),this._encoding=null,this._encoder=null,this._do_not_flush=!1,this._fatal=Boolean(Se.fatal)?"fatal":"replacement";var Te=this;if(Boolean(Se.NONSTANDARD_allowLegacyEncoding)){Ae=Ae!==void 0?String(Ae):W;var me=E(Ae);if(me===null||me.name==="replacement")throw RangeError("Unknown encoding: "+Ae);if(!x[me.name])throw Error("Encoder not present. Did you forget to include encoding-indexes.js first?");Te._encoding=me}else Te._encoding=E("utf-8"),Ae!==void 0&&"console"in u&&console.warn("TextEncoder constructor called with encoding label, which is ignored.");return Object.defineProperty||(this.encoding=Te._encoding.name.toLowerCase()),Te}Object.defineProperty&&Object.defineProperty(X.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),X.prototype.encode=function(Se,Te){Se=Se===void 0?"":String(Se),Te=v(Te),this._do_not_flush||(this._encoder=x[this._encoding.name]({fatal:this._fatal==="fatal"})),this._do_not_flush=Boolean(Te.stream);for(var me=new B(y(Se)),be=[],we;;){var je=me.read();if(je===D||(we=this._encoder.handler(me,je),we===V))break;Array.isArray(we)?be.push.apply(be,we):be.push(we)}if(!this._do_not_flush){for(;we=this._encoder.handler(me,me.read()),we!==V;)Array.isArray(we)?be.push.apply(be,we):be.push(we);this._encoder=null}return new Uint8Array(be)};function G(Ae){var Se=Ae.fatal,Te=0,me=0,be=0,we=128,je=191;this.handler=function(lt,ot){if(ot===D&&be!==0)return be=0,P(Se);if(ot===D)return V;if(be===0){if(h(ot,0,127))return ot;if(h(ot,194,223))be=1,Te=ot&31;else if(h(ot,224,239))ot===224&&(we=160),ot===237&&(je=159),be=2,Te=ot&15;else if(h(ot,240,244))ot===240&&(we=144),ot===244&&(je=143),be=3,Te=ot&7;else return P(Se);return null}if(!h(ot,we,je))return Te=be=me=0,we=128,je=191,lt.prepend(ot),P(Se);if(we=128,je=191,Te=Te<<6|ot&63,me+=1,me!==be)return null;var bt=Te;return Te=be=me=0,bt}}function j(Ae){Ae.fatal,this.handler=function(Se,Te){if(Te===D)return V;if(C(Te))return Te;var me,be;h(Te,128,2047)?(me=1,be=192):h(Te,2048,65535)?(me=2,be=224):h(Te,65536,1114111)&&(me=3,be=240);for(var we=[(Te>>6*me)+be];me>0;){var je=Te>>6*(me-1);we.push(128|je&63),me-=1}return we}}x["UTF-8"]=function(Ae){return new j(Ae)},T["UTF-8"]=function(Ae){return new G(Ae)};function K(Ae,Se){var Te=Se.fatal;this.handler=function(me,be){if(be===D)return V;if(g(be))return be;var we=Ae[be-128];return we===null?P(Te):we}}function ce(Ae,Se){Se.fatal,this.handler=function(Te,me){if(me===D)return V;if(C(me))return me;var be=U(me,Ae);return be===null&&L(me),be+128}}(function(){"encoding-indexes"in u&&b.forEach(function(Ae){Ae.heading==="Legacy single-byte encodings"&&Ae.encodings.forEach(function(Se){var Te=Se.name,me=H(Te.toLowerCase());T[Te]=function(be){return new K(me,be)},x[Te]=function(be){return new ce(me,be)}})})})(),T.GBK=function(Ae){return new se(Ae)},x.GBK=function(Ae){return new ue(Ae,!0)};function se(Ae){var Se=Ae.fatal,Te=0,me=0,be=0;this.handler=function(we,je){if(je===D&&Te===0&&me===0&&be===0)return V;je===D&&(Te!==0||me!==0||be!==0)&&(Te=0,me=0,be=0,P(Se));var lt;if(be!==0){lt=null,h(je,48,57)&&(lt=q((((Te-129)*10+me-48)*126+be-129)*10+je-48));var ot=[me,be,je];return Te=0,me=0,be=0,lt===null?(we.prepend(ot),P(Se)):lt}if(me!==0)return h(je,129,254)?(be=je,null):(we.prepend([me,je]),Te=0,me=0,P(Se));if(Te!==0){if(h(je,48,57))return me=je,null;var bt=Te,Ie=null;Te=0;var re=je<127?64:65;return(h(je,64,126)||h(je,128,254))&&(Ie=(bt-129)*190+(je-re)),lt=Ie===null?null:N(Ie,H("gb18030")),lt===null&&g(je)&&we.prepend(je),lt===null?P(Se):lt}return g(je)?je:je===128?8364:h(je,129,254)?(Te=je,null):P(Se)}}function ue(Ae,Se){Ae.fatal,this.handler=function(Te,me){if(me===D)return V;if(C(me))return me;if(me===58853)return L(me);if(Se&&me===8364)return 128;var be=U(me,H("gb18030"));if(be!==null){var we=M(be/190)+129,je=be%190,lt=je<63?64:65;return[we,je+lt]}if(Se)return L(me);be=te(me);var ot=M(be/10/126/10);be=be-ot*10*126*10;var bt=M(be/10/126);be=be-bt*10*126;var Ie=M(be/10),re=be-Ie*10;return[ot+129,bt+48,Ie+129,re+48]}}x.gb18030=function(Ae){return new ue(Ae)},T.gb18030=function(Ae){return new se(Ae)};function Y(Ae){var Se=Ae.fatal,Te=0;this.handler=function(me,be){if(be===D&&Te!==0)return Te=0,P(Se);if(be===D&&Te===0)return V;if(Te!==0){var we=Te,je=null;Te=0;var lt=be<127?64:98;switch((h(be,64,126)||h(be,161,254))&&(je=(we-129)*157+(be-lt)),je){case 1133:return[202,772];case 1135:return[202,780];case 1164:return[234,772];case 1166:return[234,780]}var ot=je===null?null:N(je,H("big5"));return ot===null&&g(be)&&me.prepend(be),ot===null?P(Se):ot}return g(be)?be:h(be,129,254)?(Te=be,null):P(Se)}}function pe(Ae){Ae.fatal,this.handler=function(Se,Te){if(Te===D)return V;if(C(Te))return Te;var me=ae(Te);if(me===null)return L(Te);var be=M(me/157)+129;if(be<161)return L(Te);var we=me%157,je=we<63?64:98;return[be,we+je]}}x.Big5=function(Ae){return new pe(Ae)},T.Big5=function(Ae){return new Y(Ae)};function Ee(Ae){var Se=Ae.fatal,Te=!1,me=0;this.handler=function(be,we){if(we===D&&me!==0)return me=0,P(Se);if(we===D&&me===0)return V;if(me===142&&h(we,161,223))return me=0,65377-161+we;if(me===143&&h(we,161,254))return Te=!0,me=we,null;if(me!==0){var je=me;me=0;var lt=null;return h(je,161,254)&&h(we,161,254)&&(lt=N((je-161)*94+(we-161),H(Te?"jis0212":"jis0208"))),Te=!1,h(we,161,254)||be.prepend(we),lt===null?P(Se):lt}return g(we)?we:we===142||we===143||h(we,161,254)?(me=we,null):P(Se)}}function Fe(Ae){Ae.fatal,this.handler=function(Se,Te){if(Te===D)return V;if(C(Te))return Te;if(Te===165)return 92;if(Te===8254)return 126;if(h(Te,65377,65439))return[142,Te-65377+161];Te===8722&&(Te=65293);var me=U(Te,H("jis0208"));if(me===null)return L(Te);var be=M(me/94)+161,we=me%94+161;return[be,we]}}x["EUC-JP"]=function(Ae){return new Fe(Ae)},T["EUC-JP"]=function(Ae){return new Ee(Ae)};function $e(Ae){var Se=Ae.fatal,Te={ASCII:0,Roman:1,Katakana:2,LeadByte:3,TrailByte:4,EscapeStart:5,Escape:6},me=Te.ASCII,be=Te.ASCII,we=0,je=!1;this.handler=function(lt,ot){switch(me){default:case Te.ASCII:return ot===27?(me=Te.EscapeStart,null):h(ot,0,127)&&ot!==14&&ot!==15&&ot!==27?(je=!1,ot):ot===D?V:(je=!1,P(Se));case Te.Roman:return ot===27?(me=Te.EscapeStart,null):ot===92?(je=!1,165):ot===126?(je=!1,8254):h(ot,0,127)&&ot!==14&&ot!==15&&ot!==27&&ot!==92&&ot!==126?(je=!1,ot):ot===D?V:(je=!1,P(Se));case Te.Katakana:return ot===27?(me=Te.EscapeStart,null):h(ot,33,95)?(je=!1,65377-33+ot):ot===D?V:(je=!1,P(Se));case Te.LeadByte:return ot===27?(me=Te.EscapeStart,null):h(ot,33,126)?(je=!1,we=ot,me=Te.TrailByte,null):ot===D?V:(je=!1,P(Se));case Te.TrailByte:if(ot===27)return me=Te.EscapeStart,P(Se);if(h(ot,33,126)){me=Te.LeadByte;var bt=(we-33)*94+ot-33,Ie=N(bt,H("jis0208"));return Ie===null?P(Se):Ie}return ot===D?(me=Te.LeadByte,lt.prepend(ot),P(Se)):(me=Te.LeadByte,P(Se));case Te.EscapeStart:return ot===36||ot===40?(we=ot,me=Te.Escape,null):(lt.prepend(ot),je=!1,me=be,P(Se));case Te.Escape:var re=we;we=0;var oe=null;if(re===40&&ot===66&&(oe=Te.ASCII),re===40&&ot===74&&(oe=Te.Roman),re===40&&ot===73&&(oe=Te.Katakana),re===36&&(ot===64||ot===66)&&(oe=Te.LeadByte),oe!==null){me=me=oe;var _e=je;return je=!0,_e?P(Se):null}return lt.prepend([re,ot]),je=!1,me=be,P(Se)}}}function pt(Ae){Ae.fatal;var Se={ASCII:0,Roman:1,jis0208:2},Te=Se.ASCII;this.handler=function(me,be){if(be===D&&Te!==Se.ASCII)return me.prepend(be),Te=Se.ASCII,[27,40,66];if(be===D&&Te===Se.ASCII)return V;if((Te===Se.ASCII||Te===Se.Roman)&&(be===14||be===15||be===27))return L(65533);if(Te===Se.ASCII&&C(be))return be;if(Te===Se.Roman&&(C(be)&&be!==92&&be!==126||be==165||be==8254)){if(C(be))return be;if(be===165)return 92;if(be===8254)return 126}if(C(be)&&Te!==Se.ASCII)return me.prepend(be),Te=Se.ASCII,[27,40,66];if((be===165||be===8254)&&Te!==Se.Roman)return me.prepend(be),Te=Se.Roman,[27,40,74];be===8722&&(be=65293);var we=U(be,H("jis0208"));if(we===null)return L(be);if(Te!==Se.jis0208)return me.prepend(be),Te=Se.jis0208,[27,36,66];var je=M(we/94)+33,lt=we%94+33;return[je,lt]}}x["ISO-2022-JP"]=function(Ae){return new pt(Ae)},T["ISO-2022-JP"]=function(Ae){return new $e(Ae)};function Ue(Ae){var Se=Ae.fatal,Te=0;this.handler=function(me,be){if(be===D&&Te!==0)return Te=0,P(Se);if(be===D&&Te===0)return V;if(Te!==0){var we=Te,je=null;Te=0;var lt=be<127?64:65,ot=we<160?129:193;if((h(be,64,126)||h(be,128,252))&&(je=(we-ot)*188+be-lt),h(je,8836,10715))return 57344-8836+je;var bt=je===null?null:N(je,H("jis0208"));return bt===null&&g(be)&&me.prepend(be),bt===null?P(Se):bt}return g(be)||be===128?be:h(be,161,223)?65377-161+be:h(be,129,159)||h(be,224,252)?(Te=be,null):P(Se)}}function Je(Ae){Ae.fatal,this.handler=function(Se,Te){if(Te===D)return V;if(C(Te)||Te===128)return Te;if(Te===165)return 92;if(Te===8254)return 126;if(h(Te,65377,65439))return Te-65377+161;Te===8722&&(Te=65293);var me=Q(Te);if(me===null)return L(Te);var be=M(me/188),we=be<31?129:193,je=me%188,lt=je<63?64:65;return[be+we,je+lt]}}x.Shift_JIS=function(Ae){return new Je(Ae)},T.Shift_JIS=function(Ae){return new Ue(Ae)};function et(Ae){var Se=Ae.fatal,Te=0;this.handler=function(me,be){if(be===D&&Te!==0)return Te=0,P(Se);if(be===D&&Te===0)return V;if(Te!==0){var we=Te,je=null;Te=0,h(be,65,254)&&(je=(we-129)*190+(be-65));var lt=je===null?null:N(je,H("euc-kr"));return je===null&&g(be)&&me.prepend(be),lt===null?P(Se):lt}return g(be)?be:h(be,129,254)?(Te=be,null):P(Se)}}function ze(Ae){Ae.fatal,this.handler=function(Se,Te){if(Te===D)return V;if(C(Te))return Te;var me=U(Te,H("euc-kr"));if(me===null)return L(Te);var be=M(me/190)+129,we=me%190+65;return[be,we]}}x["EUC-KR"]=function(Ae){return new ze(Ae)},T["EUC-KR"]=function(Ae){return new et(Ae)};function Xe(Ae,Se){var Te=Ae>>8,me=Ae&255;return Se?[Te,me]:[me,Te]}function tt(Ae,Se){var Te=Se.fatal,me=null,be=null;this.handler=function(we,je){if(je===D&&(me!==null||be!==null))return P(Te);if(je===D&&me===null&&be===null)return V;if(me===null)return me=je,null;var lt;if(Ae?lt=(me<<8)+je:lt=(je<<8)+me,me=null,be!==null){var ot=be;return be=null,h(lt,56320,57343)?65536+(ot-55296)*1024+(lt-56320):(we.prepend(Xe(lt,Ae)),P(Te))}return h(lt,55296,56319)?(be=lt,null):h(lt,56320,57343)?P(Te):lt}}function ye(Ae,Se){Se.fatal,this.handler=function(Te,me){if(me===D)return V;if(h(me,0,65535))return Xe(me,Ae);var be=Xe((me-65536>>10)+55296,Ae),we=Xe((me-65536&1023)+56320,Ae);return be.concat(we)}}x["UTF-16BE"]=function(Ae){return new ye(!0,Ae)},T["UTF-16BE"]=function(Ae){return new tt(!0,Ae)},x["UTF-16LE"]=function(Ae){return new ye(!1,Ae)},T["UTF-16LE"]=function(Ae){return new tt(!1,Ae)};function Ze(Ae){Ae.fatal,this.handler=function(Se,Te){return Te===D?V:g(Te)?Te:63360+Te-128}}function Ge(Ae){Ae.fatal,this.handler=function(Se,Te){return Te===D?V:C(Te)?Te:h(Te,63360,63487)?Te-63360+128:L(Te)}}x["x-user-defined"]=function(Ae){return new Ge(Ae)},T["x-user-defined"]=function(Ae){return new Ze(Ae)},u.TextEncoder||(u.TextEncoder=X),u.TextDecoder||(u.TextDecoder=O),a.exports&&(a.exports={TextEncoder:u.TextEncoder,TextDecoder:u.TextDecoder,EncodingIndexes:u["encoding-indexes"]})})(ua||{})}(TM)),TM.exports}var fR;function Ok(){return fR||(fR=1,function(a){a.exports=Lk()}(EM)),EM.exports}var SM={},By={exports:{}},hR;function Fk(){return hR||(hR=1,function(a,u){var h=d2(),R=h.Buffer;function M(y,p){for(var g in y)p[g]=y[g]}R.from&&R.alloc&&R.allocUnsafe&&R.allocUnsafeSlow?a.exports=h:(M(h,u),u.Buffer=v);function v(y,p,g){return R(y,p,g)}M(R,v),v.from=function(y,p,g){if(typeof y=="number")throw new TypeError("Argument must not be a number");return R(y,p,g)},v.alloc=function(y,p,g){if(typeof y!="number")throw new TypeError("Argument must be a number");var C=R(y);return p!==void 0?typeof g=="string"?C.fill(p,g):C.fill(p):C.fill(0),C},v.allocUnsafe=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return R(y)},v.allocUnsafeSlow=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(y)}}(By,By.exports)),By.exports}var dR;function Ik(){if(dR)return SM;dR=1;var a=Fk().Buffer,u=a.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function h(_){if(!_)return"utf8";for(var x;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(x)return;_=(""+_).toLowerCase(),x=!0}}function R(_){var x=h(_);if(typeof x!="string"&&(a.isEncoding===u||!u(_)))throw new Error("Unknown encoding: "+_);return x||_}SM.StringDecoder=M;function M(_){this.encoding=R(_);var x;switch(this.encoding){case"utf16le":this.text=B,this.end=V,x=4;break;case"utf8":this.fillLast=g,x=4;break;case"base64":this.text=P,this.end=L,x=3;break;default:this.write=E,this.end=b;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=a.allocUnsafe(x)}M.prototype.write=function(_){if(_.length===0)return"";var x,T;if(this.lastNeed){if(x=this.fillLast(_),x===void 0)return"";T=this.lastNeed,this.lastNeed=0}else T=0;return T<_.length?x?x+this.text(_,T):this.text(_,T):x||""},M.prototype.end=D,M.prototype.text=C,M.prototype.fillLast=function(_){if(this.lastNeed<=_.length)return _.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),this.lastNeed-=_.length};function v(_){return _<=127?0:_>>5===6?2:_>>4===14?3:_>>3===30?4:_>>6===2?-1:-2}function y(_,x,T){var N=x.length-1;if(N<T)return 0;var U=v(x[N]);return U>=0?(U>0&&(_.lastNeed=U-1),U):--N<T||U===-2?0:(U=v(x[N]),U>=0?(U>0&&(_.lastNeed=U-2),U):--N<T||U===-2?0:(U=v(x[N]),U>=0?(U>0&&(U===2?U=0:_.lastNeed=U-3),U):0))}function p(_,x,T){if((x[0]&192)!==128)return _.lastNeed=0,"\uFFFD";if(_.lastNeed>1&&x.length>1){if((x[1]&192)!==128)return _.lastNeed=1,"\uFFFD";if(_.lastNeed>2&&x.length>2&&(x[2]&192)!==128)return _.lastNeed=2,"\uFFFD"}}function g(_){var x=this.lastTotal-this.lastNeed,T=p(this,_);if(T!==void 0)return T;if(this.lastNeed<=_.length)return _.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,x,0,_.length),this.lastNeed-=_.length}function C(_,x){var T=y(this,_,x);if(!this.lastNeed)return _.toString("utf8",x);this.lastTotal=T;var N=_.length-(T-this.lastNeed);return _.copy(this.lastChar,0,N),_.toString("utf8",x,N)}function D(_){var x=_&&_.length?this.write(_):"";return this.lastNeed?x+"\uFFFD":x}function B(_,x){if((_.length-x)%2===0){var T=_.toString("utf16le",x);if(T){var N=T.charCodeAt(T.length-1);if(N>=55296&&N<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],T.slice(0,-1)}return T}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",x,_.length-1)}function V(_){var x=_&&_.length?this.write(_):"";if(this.lastNeed){var T=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,T)}return x}function P(_,x){var T=(_.length-x)%3;return T===0?_.toString("base64",x):(this.lastNeed=3-T,this.lastTotal=3,T===1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",x,_.length-T))}function L(_){var x=_&&_.length?this.write(_):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function E(_){return _.toString(this.encoding)}function b(_){return _&&_.length?this.write(_):""}return SM}var RM,pR;function kk(){if(pR)return RM;pR=1,Ok();var a=Ik().StringDecoder;function u(M){var v=new a,y=v.write(M)+v.end();return y.replace(/\0/g,"").trim()}RM=R;var h=/^(?:ANSI\s)?(\d+)$/m;function R(M,v){if(!M)return u;try{new TextDecoder(M.trim())}catch{var y=h.exec(M);return y&&!v?R("windows-"+y[1],!0):u}return p;function p(g){var C=new TextDecoder(M),D=C.decode(g,{stream:!0})+C.decode();return D.replace(/\0/g,"").trim()}}return RM}var CM,mR;function Dk(){if(mR)return CM;mR=1;var a=kk();function u(v){var y={};return y.lastUpdated=new Date(v.readUInt8(1)+1900,v.readUInt8(2),v.readUInt8(3)),y.records=v.readUInt32LE(4),y.headerLen=v.readUInt16LE(8),y.recLen=v.readUInt16LE(10),y}function h(v,y,p){for(var g=[],C=32;C<y&&(g.push({name:p(v.slice(C,C+11)),dataType:String.fromCharCode(v.readUInt8(C+11)),len:v.readUInt8(C+16),decimal:v.readUInt8(C+17)}),v.readUInt8(C+32)!==13);)C+=32;return g}function R(v,y,p,g,C){var D=v.slice(y,y+p),B=C(D);switch(g){case"N":case"F":case"O":return parseFloat(B,10);case"D":return new Date(B.slice(0,4),parseInt(B.slice(4,6),10)-1,B.slice(6,8));case"L":return B.toLowerCase()==="y"||B.toLowerCase()==="t";default:return B}}function M(v,y,p,g){for(var C={},D=0,B=p.length,V,P;D<B;)P=p[D],V=R(v,y,P.len,P.dataType,g),y+=P.len,typeof V<"u"&&(C[P.name]=V),D++;return C}return CM=function(v,y){for(var p=a(y),g=u(v),C=h(v,g.headerLen-1,p),D=(C.length+1<<5)+2,B=g.recLen,V=g.records,P=[];V;)P.push(M(v,D,C,p)),D+=B,V--;return P},CM}var PM={exports:{}},vR;function Nk(){return vR||(vR=1,function(a){(function(){a.exports?a.exports=v:this.LRUCache=v;function u(P,L){return Object.prototype.hasOwnProperty.call(P,L)}function h(){return 1}var R=!1;function M(P){!R&&typeof P!="string"&&typeof P!="number"&&(R=!0,console.error(new TypeError("LRU: key must be a string or number. Almost certainly a bug! "+typeof P).stack))}function v(P){if(!(this instanceof v))return new v(P);typeof P=="number"&&(P={max:P}),P||(P={}),this._max=P.max,(!this._max||typeof this._max!="number"||this._max<=0)&&(this._max=1/0),this._lengthCalculator=P.length||h,typeof this._lengthCalculator!="function"&&(this._lengthCalculator=h),this._allowStale=P.stale||!1,this._maxAge=P.maxAge||null,this._dispose=P.dispose,this.reset()}Object.defineProperty(v.prototype,"max",{set:function(P){(!P||typeof P!="number"||P<=0)&&(P=1/0),this._max=P,this._length>this._max&&C(this)},get:function(){return this._max},enumerable:!0}),Object.defineProperty(v.prototype,"lengthCalculator",{set:function(P){if(typeof P!="function"){this._lengthCalculator=h,this._length=this._itemCount;for(var L in this._cache)this._cache[L].length=1}else{this._lengthCalculator=P,this._length=0;for(var L in this._cache)this._cache[L].length=this._lengthCalculator(this._cache[L].value),this._length+=this._cache[L].length}this._length>this._max&&C(this)},get:function(){return this._lengthCalculator},enumerable:!0}),Object.defineProperty(v.prototype,"length",{get:function(){return this._length},enumerable:!0}),Object.defineProperty(v.prototype,"itemCount",{get:function(){return this._itemCount},enumerable:!0}),v.prototype.forEach=function(P,L){L=L||this;for(var E=0,b=this._itemCount,_=this._mru-1;_>=0&&E<b;_--)if(this._lruList[_]){E++;var x=this._lruList[_];p(this,x)&&(B(this,x),this._allowStale||(x=void 0)),x&&P.call(L,x.value,x.key,this)}},v.prototype.keys=function(){for(var P=new Array(this._itemCount),L=0,E=this._mru-1;E>=0&&L<this._itemCount;E--)if(this._lruList[E]){var b=this._lruList[E];P[L++]=b.key}return P},v.prototype.values=function(){for(var P=new Array(this._itemCount),L=0,E=this._mru-1;E>=0&&L<this._itemCount;E--)if(this._lruList[E]){var b=this._lruList[E];P[L++]=b.value}return P},v.prototype.reset=function(){if(this._dispose&&this._cache)for(var P in this._cache)this._dispose(P,this._cache[P].value);this._cache=Object.create(null),this._lruList=Object.create(null),this._mru=0,this._lru=0,this._length=0,this._itemCount=0},v.prototype.dump=function(){for(var P=[],L=0,E=this._mru-1;E>=0&&L<this._itemCount;E--)if(this._lruList[E]){var b=this._lruList[E];p(this,b)||(++L,P.push({k:b.key,v:b.value,e:b.now+(b.maxAge||0)}))}return P},v.prototype.dumpLru=function(){return this._lruList},v.prototype.set=function(P,L,E){E=E||this._maxAge,M(P);var b=E?Date.now():0,_=this._lengthCalculator(L);if(u(this._cache,P))return _>this._max?(B(this,this._cache[P]),!1):(this._dispose&&this._dispose(P,this._cache[P].value),this._cache[P].now=b,this._cache[P].maxAge=E,this._cache[P].value=L,this._length+=_-this._cache[P].length,this._cache[P].length=_,this.get(P),this._length>this._max&&C(this),!0);var x=new V(P,L,this._mru++,_,b,E);return x.length>this._max?(this._dispose&&this._dispose(P,L),!1):(this._length+=x.length,this._lruList[x.lu]=this._cache[P]=x,this._itemCount++,this._length>this._max&&C(this),!0)},v.prototype.has=function(P){if(M(P),!u(this._cache,P))return!1;var L=this._cache[P];return!p(this,L)},v.prototype.get=function(P){return M(P),y(this,P,!0)},v.prototype.peek=function(P){return M(P),y(this,P,!1)},v.prototype.pop=function(){var P=this._lruList[this._lru];return B(this,P),P||null},v.prototype.del=function(P){M(P),B(this,this._cache[P])},v.prototype.load=function(P){this.reset();for(var L=Date.now(),E=P.length-1;E>=0;E--){var b=P[E];M(b.k);var _=b.e||0;if(_===0)this.set(b.k,b.v);else{var x=_-L;x>0&&this.set(b.k,b.v,x)}}};function y(P,L,E){M(L);var b=P._cache[L];return b&&(p(P,b)?(B(P,b),P._allowStale||(b=void 0)):E&&g(P,b),b&&(b=b.value)),b}function p(P,L){if(!L||!L.maxAge&&!P._maxAge)return!1;var E=!1,b=Date.now()-L.now;return L.maxAge?E=b>L.maxAge:E=P._maxAge&&b>P._maxAge,E}function g(P,L){D(P,L),L.lu=P._mru++,P._lruList[L.lu]=L}function C(P){for(;P._lru<P._mru&&P._length>P._max;)B(P,P._lruList[P._lru])}function D(P,L){for(delete P._lruList[L.lu];P._lru<P._mru&&!P._lruList[P._lru];)P._lru++}function B(P,L){L&&(P._dispose&&P._dispose(L.key,L.value),P._length-=L.length,P._itemCount--,delete P._cache[L.key],D(P,L))}function V(P,L,E,b,_,x){this.key=P,this.value=L,this.lu=E,this.length=b,this.now=_,x&&(this.maxAge=x)}})()}(PM)),PM.exports}var LM,gR;function Bk(){if(gR)return LM;gR=1;let a=Jh;a.default&&(a=a.default);const u=Ek(),h=Ck(),R=Pk(),M=Dk(),v=QC(),y=Nk(),p=d2().Buffer,g=ua.URL,C=new y({max:20});function D(_){if(!_)throw new Error("forgot to pass buffer");if(p.isBuffer(_))return _;if(B(_))return p.from(_);if(B(_.buffer))return _.BYTES_PER_ELEMENT===1?p.from(_):p.from(_.buffer)}function B(_){return _ instanceof ua.ArrayBuffer||Object.prototype.toString.call(_)==="[object ArrayBuffer]"}function V(_,x){return typeof _=="string"&&C.has(_)?v.resolve(C.get(_)):V.getShapefile(_,x).then(function(T){return typeof _=="string"&&C.set(_,T),T})}V.combine=function([_,x]){const T={};T.type="FeatureCollection",T.features=[];let N=0;const U=_.length;for(x||(x=[]);N<U;)T.features.push({type:"Feature",geometry:_[N],properties:x[N]||{}}),N++;return T},V.parseZip=async function(_,x){let T;_=D(_);const N=await u(_),U=[];x=x||[];for(T in N)T.indexOf("__MACOSX")===-1&&(T.slice(-3).toLowerCase()==="shp"?(U.push(T.slice(0,-4)),N[T.slice(0,-3)+T.slice(-3).toLowerCase()]=N[T]):T.slice(-3).toLowerCase()==="prj"?N[T.slice(0,-3)+T.slice(-3).toLowerCase()]=a(N[T]):T.slice(-4).toLowerCase()==="json"||x.indexOf(T.split(".").pop())>-1?U.push(T.slice(0,-3)+T.slice(-3).toLowerCase()):(T.slice(-3).toLowerCase()==="dbf"||T.slice(-3).toLowerCase()==="cpg")&&(N[T.slice(0,-3)+T.slice(-3).toLowerCase()]=N[T]));if(!U.length)throw new Error("no layers founds");const H=U.map(function(q){let te,Q;const Z=q.lastIndexOf(".");return Z>-1&&q.slice(Z).indexOf("json")>-1?(te=JSON.parse(N[q]),te.fileName=q.slice(0,Z)):x.indexOf(q.slice(Z+1))>-1?(te=N[q],te.fileName=q):(N[q+".dbf"]&&(Q=M(N[q+".dbf"],N[q+".cpg"])),te=V.combine([R(N[q+".shp"],N[q+".prj"]),Q]),te.fileName=q),te});return H.length===1?H[0]:H};async function P(_,x){const T=await h(_);return V.parseZip(T,x)}const L=async _=>{const x=await v.all([h(_,"shp"),h(_,"prj")]);let T=!1;try{x[1]&&(T=a(x[1]))}catch{T=!1}return R(x[0],T)},E=async _=>{const[x,T]=await v.all([h(_,"dbf"),h(_,"cpg")]);if(!!x)return M(x,T)},b=(_,x)=>new g(_).pathname.slice(-4).toLowerCase()===x;return V.getShapefile=async function(_,x){if(typeof _!="string")return V.parseZip(_);if(b(_,".zip"))return P(_,x);const T=await v.all([L(_),E(_)]);return V.combine(T)},V.parseShp=function(_,x){if(_=D(_),p.isBuffer(x)&&(x=x.toString()),typeof x=="string")try{x=a(x)}catch{x=!1}return R(_,x)},V.parseDbf=function(_,x){return _=D(_),M(_,x)},LM=V,LM}var yR;function Uk(){return yR||(yR=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Jh),R=u(Bk()),M=u(k0()),v=nd(),y={parse:function(g){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};C=(0,v.deprecatedParsingOptionsToNewOne)(C);var D;return g.zip?D=R.default.parseZip(g.zip):g.shp&&g.shx&&g.dbf&&(D=Promise.all([R.default.parseShp(g.shp,g.prj),R.default.parseDbf(g.dbf)]).then(R.default.combine)),C.in=C.in||{},C.in.crs=g.prj?(0,h.default)(g.prj).oProj.datumName:C.in.crs,Promise.resolve(D).then(function(B){return M.default.parse(B,C)})}};a.default=y}(mM)),mM}var OM={},_R;function zk(){return _R||(_R=1,function(a){var u=hr.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var h=u(Ir()),R=u(kr());function M(C,D){var B=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!B){if(Array.isArray(C)||(B=v(C))||D&&C&&typeof C.length=="number"){B&&(C=B);var V=0,P=function(){};return{s:P,n:function(){return V>=C.length?{done:!0}:{done:!1,value:C[V++]}},e:function(x){throw x},f:P}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,E=!1,b;return{s:function(){B=B.call(C)},n:function(){var x=B.next();return L=x.done,x},e:function(x){E=!0,b=x},f:function(){try{!L&&B.return!=null&&B.return()}finally{if(E)throw b}}}}function v(C,D){if(!!C){if(typeof C=="string")return y(C,D);var B=Object.prototype.toString.call(C).slice(8,-1);if(B==="Object"&&C.constructor&&(B=C.constructor.name),B==="Map"||B==="Set")return Array.from(C);if(B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B))return y(C,D)}}function y(C,D){(D==null||D>C.length)&&(D=C.length);for(var B=0,V=new Array(D);B<D;B++)V[B]=C[B];return V}var p=function(){function C(D){(0,h.default)(this,C),this.classes=D.classes,this.inverseHierarchy={},this.instancesIdxs=[];var B={},V=0,P=D.parentCounts;P===void 0&&(P=new Array(D.instancesLength),P.fill(1));for(var L=0;L<D.instancesLength;L++){for(var E=0;E<P[L];E++)L!==D.parentIds[V]&&(this.inverseHierarchy[L]===void 0&&(this.inverseHierarchy[L]=[]),this.inverseHierarchy[L].push(D.parentIds[V]),V++);var b=D.classIds[L];B[b]===void 0&&(B[b]=0),this.instancesIdxs[L]={classId:b,instanceIdx:B[b]},B[b]++}}return(0,R.default)(C,[{key:"getInfoById",value:function(B){var V={},P=this.instancesIdxs[B].classId,L=this.classes[P].name,E=this.instancesIdxs[B].instanceIdx,b=this.classes[P].instances;for(var _ in b)Object.prototype.hasOwnProperty.call(b,_)&&(V[_]=b[_][E]);var x={};if(x[L]=V,this.inverseHierarchy&&this.inverseHierarchy[B]){var T=M(this.inverseHierarchy[B]),N;try{for(T.s();!(N=T.n()).done;){var U=N.value;Object.assign(x,this.getInfoById(U))}}catch(H){T.e(H)}finally{T.f()}}return x}}]),C}(),g=p;a.default=g}(OM)),OM}(function(a){var u=hr.exports,h=Lr.exports;Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"$3dTilesCulling",{enumerable:!0,get:function(){return Dt.$3dTilesCulling}}),Object.defineProperty(a,"$3dTilesSubdivisionControl",{enumerable:!0,get:function(){return Dt.$3dTilesSubdivisionControl}}),Object.defineProperty(a,"C3DTBatchTable",{enumerable:!0,get:function(){return St.default}}),Object.defineProperty(a,"C3DTBatchTableHierarchyExtension",{enumerable:!0,get:function(){return ct.default}}),Object.defineProperty(a,"C3DTBoundingVolume",{enumerable:!0,get:function(){return _t.default}}),Object.defineProperty(a,"C3DTExtensions",{enumerable:!0,get:function(){return Ct.default}}),Object.defineProperty(a,"C3DTilesLayer",{enumerable:!0,get:function(){return Fe.default}}),Object.defineProperty(a,"C3DTilesSource",{enumerable:!0,get:function(){return lt.default}}),Object.defineProperty(a,"C3DTilesTypes",{enumerable:!0,get:function(){return vt.default}}),Object.defineProperty(a,"C3DTileset",{enumerable:!0,get:function(){return ht.default}}),Object.defineProperty(a,"CAMERA_TYPE",{enumerable:!0,get:function(){return O.CAMERA_TYPE}}),Object.defineProperty(a,"CONTROL_EVENTS",{enumerable:!0,get:function(){return _.CONTROL_EVENTS}}),Object.defineProperty(a,"CRS",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(a,"CameraCalibrationParser",{enumerable:!0,get:function(){return oe.default}}),Object.defineProperty(a,"CameraUtils",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(a,"Capabilities",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(a,"ColorLayer",{enumerable:!0,get:function(){return ce.default}}),Object.defineProperty(a,"ColorLayersOrdering",{enumerable:!0,get:function(){return Je.default}}),Object.defineProperty(a,"Coordinates",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(a,"DEMUtils",{enumerable:!0,get:function(){return te.default}}),Object.defineProperty(a,"ElevationLayer",{enumerable:!0,get:function(){return se.default}}),Object.defineProperty(a,"Ellipsoid",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(a,"EntwinePointTileLayer",{enumerable:!0,get:function(){return tt.default}}),Object.defineProperty(a,"EntwinePointTileSource",{enumerable:!0,get:function(){return ot.default}}),Object.defineProperty(a,"Extent",{enumerable:!0,get:function(){return R.default}}),Object.defineProperty(a,"FEATURE_TYPES",{enumerable:!0,get:function(){return X.FEATURE_TYPES}}),Object.defineProperty(a,"Feature",{enumerable:!0,get:function(){return X.default}}),Object.defineProperty(a,"Feature2Mesh",{enumerable:!0,get:function(){return H.default}}),Object.defineProperty(a,"FeatureCollection",{enumerable:!0,get:function(){return X.FeatureCollection}}),Object.defineProperty(a,"FeatureGeometry",{enumerable:!0,get:function(){return X.FeatureGeometry}}),Object.defineProperty(a,"FeatureGeometryLayer",{enumerable:!0,get:function(){return Y.default}}),Object.defineProperty(a,"FeatureProcessing",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(a,"FeaturesUtils",{enumerable:!0,get:function(){return q.default}}),Object.defineProperty(a,"Fetcher",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(a,"FileSource",{enumerable:!0,get:function(){return Ge.default}}),Object.defineProperty(a,"FirstPersonControls",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(a,"FlyControls",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(a,"GDFParser",{enumerable:!0,get:function(){return Be.default}}),Object.defineProperty(a,"GLOBE_VIEW_EVENTS",{enumerable:!0,get:function(){return g.GLOBE_VIEW_EVENTS}}),Object.defineProperty(a,"GTXParser",{enumerable:!0,get:function(){return at.default}}),Object.defineProperty(a,"GeoJsonParser",{enumerable:!0,get:function(){return Ie.default}}),Object.defineProperty(a,"GeoidGrid",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(a,"GeoidLayer",{enumerable:!0,get:function(){return ye.default}}),Object.defineProperty(a,"GeometryLayer",{enumerable:!0,get:function(){return ue.default}}),Object.defineProperty(a,"GlobeControls",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(a,"GlobeLayer",{enumerable:!0,get:function(){return et.default}}),Object.defineProperty(a,"GlobeView",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(a,"GpxParser",{enumerable:!0,get:function(){return bt.default}}),Object.defineProperty(a,"ISGParser",{enumerable:!0,get:function(){return ke.default}}),Object.defineProperty(a,"ImageryLayers",{enumerable:!0,get:function(){return K.ImageryLayers}}),Object.defineProperty(a,"KMLParser",{enumerable:!0,get:function(){return re.default}}),Object.defineProperty(a,"LASParser",{enumerable:!0,get:function(){return Re.default}}),Object.defineProperty(a,"Label",{enumerable:!0,get:function(){return j.default}}),Object.defineProperty(a,"LabelLayer",{enumerable:!0,get:function(){return Xe.default}}),Object.defineProperty(a,"Layer",{enumerable:!0,get:function(){return K.default}}),Object.defineProperty(a,"MAIN_LOOP_EVENTS",{enumerable:!0,get:function(){return B.MAIN_LOOP_EVENTS}}),Object.defineProperty(a,"OrientationUtils",{enumerable:!0,get:function(){return Z.default}}),Object.defineProperty(a,"OrientedImageCamera",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(a,"OrientedImageLayer",{enumerable:!0,get:function(){return pt.default}}),Object.defineProperty(a,"OrientedImageSource",{enumerable:!0,get:function(){return we.default}}),Object.defineProperty(a,"PLANAR_CONTROL_EVENT",{enumerable:!0,get:function(){return U.PLANAR_CONTROL_EVENT}}),Object.defineProperty(a,"PlanarControls",{enumerable:!0,get:function(){return U.default}}),Object.defineProperty(a,"PlanarLayer",{enumerable:!0,get:function(){return ze.default}}),Object.defineProperty(a,"PlanarView",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(a,"PointCloudLayer",{enumerable:!0,get:function(){return pe.default}}),Object.defineProperty(a,"PointsMaterial",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(a,"PotreeLayer",{enumerable:!0,get:function(){return Ee.default}}),Object.defineProperty(a,"PotreeSource",{enumerable:!0,get:function(){return je.default}}),a.REVISION=void 0,Object.defineProperty(a,"STRATEGY_DICHOTOMY",{enumerable:!0,get:function(){return Ue.STRATEGY_DICHOTOMY}}),Object.defineProperty(a,"STRATEGY_GROUP",{enumerable:!0,get:function(){return Ue.STRATEGY_GROUP}}),Object.defineProperty(a,"STRATEGY_MIN_NETWORK_TRAFFIC",{enumerable:!0,get:function(){return Ue.STRATEGY_MIN_NETWORK_TRAFFIC}}),Object.defineProperty(a,"STRATEGY_PROGRESSIVE",{enumerable:!0,get:function(){return Ue.STRATEGY_PROGRESSIVE}}),Object.defineProperty(a,"ShaderChunk",{enumerable:!0,get:function(){return ae.default}}),Object.defineProperty(a,"ShapefileParser",{enumerable:!0,get:function(){return _e.default}}),Object.defineProperty(a,"Source",{enumerable:!0,get:function(){return Ze.default}}),Object.defineProperty(a,"StreetControls",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(a,"Style",{enumerable:!0,get:function(){return G.default}}),Object.defineProperty(a,"TMSSource",{enumerable:!0,get:function(){return Ae.default}}),Object.defineProperty(a,"TiledGeometryLayer",{enumerable:!0,get:function(){return $e.default}}),Object.defineProperty(a,"VIEW_EVENTS",{enumerable:!0,get:function(){return V.VIEW_EVENTS}}),Object.defineProperty(a,"VectorTilesSource",{enumerable:!0,get:function(){return be.default}}),Object.defineProperty(a,"View",{enumerable:!0,get:function(){return V.default}}),Object.defineProperty(a,"WFSSource",{enumerable:!0,get:function(){return Se.default}}),Object.defineProperty(a,"WMSSource",{enumerable:!0,get:function(){return Te.default}}),Object.defineProperty(a,"WMTSSource",{enumerable:!0,get:function(){return me.default}}),Object.defineProperty(a,"colorLayerEffects",{enumerable:!0,get:function(){return F.colorLayerEffects}}),Object.defineProperty(a,"ellipsoidSizes",{enumerable:!0,get:function(){return p.ellipsoidSizes}}),Object.defineProperty(a,"enableDracoLoader",{enumerable:!0,get:function(){return wt.enableDracoLoader}}),Object.defineProperty(a,"getMaxColorSamplerUnitsCount",{enumerable:!0,get:function(){return F.getMaxColorSamplerUnitsCount}}),Object.defineProperty(a,"glTFLoader",{enumerable:!0,get:function(){return wt.glTFLoader}}),Object.defineProperty(a,"legacyGLTFLoader",{enumerable:!0,get:function(){return wt.legacyGLTFLoader}}),Object.defineProperty(a,"process3dTilesNode",{enumerable:!0,get:function(){return Dt.process3dTilesNode}}),Object.defineProperty(a,"updateLayeredMaterialNodeElevation",{enumerable:!0,get:function(){return L.updateLayeredMaterialNodeElevation}}),Object.defineProperty(a,"updateLayeredMaterialNodeImagery",{enumerable:!0,get:function(){return L.updateLayeredMaterialNodeImagery}});var R=u(ya()),M=u(Zi()),v=u(r2()),y=u(ps()),p=er($h()),g=er(vI()),C=u(yI()),D=u(dl()),B=ed(),V=er(iv()),P=u(CC()),L=D0(),E=u(PC()),b=u(LC()),_=er(bC()),x=u(_I()),T=u(OC()),N=u(xI()),U=er(SC()),H=u(FC()),q=u(sC()),te=u(F0()),Q=u(f2()),Z=u(tb()),ae=u(wI()),F=rd(),W=u(td()),O=ZR(),X=er(Uf()),G=u(I0()),j=u(lC()),K=er(id()),ce=u(EI()),se=u(TI()),ue=u(ad()),Y=u(SI()),pe=u(rb()),Ee=u(CI()),Fe=u(PI()),$e=u(eb()),pt=u(OI()),Ue=qM(),Je=u(aC()),et=u(TC()),ze=u(RC()),Xe=u(cC()),tt=u(II()),ye=u(h2()),Ze=u(pl()),Ge=u(kI()),Ae=u(ib()),Se=u(DI()),Te=u(NI()),me=u(BI()),be=u(zI()),we=u(GI()),je=u(WI()),lt=u(HI()),ot=u(Mk()),bt=u(eC()),Ie=u(k0()),re=u(KR()),oe=u(zC()),_e=u(Uk()),Re=u($C()),ke=u(tC()),Be=u(XM()),at=u(i2()),wt=uC(),ht=u(BC()),_t=u(NC()),St=u(jM()),Ct=u(UC()),vt=u(o2()),ct=u(zk()),Dt=DC();function fr(Ut){if(typeof WeakMap!="function")return null;var on=new WeakMap,tn=new WeakMap;return(fr=function(_i){return _i?tn:on})(Ut)}function er(Ut,on){if(!on&&Ut&&Ut.__esModule)return Ut;if(Ut===null||h(Ut)!=="object"&&typeof Ut!="function")return{default:Ut};var tn=fr(on);if(tn&&tn.has(Ut))return tn.get(Ut);var Ln={},_i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var xn in Ut)if(xn!=="default"&&Object.prototype.hasOwnProperty.call(Ut,xn)){var ri=_i?Object.getOwnPropertyDescriptor(Ut,xn):null;ri&&(ri.get||ri.set)?Object.defineProperty(Ln,xn,ri):Ln[xn]=Ut[xn]}return Ln.default=Ut,tn&&tn.set(Ut,Ln),Ln}var dr={version:"2.38.2"},zr=dr.version;a.REVISION=zr})(Qm);const Gk=document.getElementById("map"),Vk={coord:new Qm.Coordinates("EPSG:4326",150,30),heading:-50,range:1e7,tilt:50},Wk=new Qm.GlobeView(Gk,Vk),Hk=new Qm.TMSSource({format:"image/jpeg",projection:"EPSG:3857",url:"https://tile.mierune.co.jp/mierune_mono/${z}/${x}/${y}.png",attribution:{name:"Maptiles by <a href='http://mierune.co.jp/' target='_blank'>MIERUNE</a>, under CC BY. Data by <a href='http://osm.org/copyright' target='_blank'>OpenStreetMap</a> contributors, under ODbL."},isInverted:!0}),qk=new Qm.ColorLayer("m_mono",{source:Hk});Wk.addLayer(qk)});export default Xk();
