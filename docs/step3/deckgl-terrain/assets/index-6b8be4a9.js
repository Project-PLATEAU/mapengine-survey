function nw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var Rte=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rw={exports:{}},Pd={},iw={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lu=Symbol.for("react.element"),gL=Symbol.for("react.portal"),pL=Symbol.for("react.fragment"),mL=Symbol.for("react.strict_mode"),vL=Symbol.for("react.profiler"),yL=Symbol.for("react.provider"),_L=Symbol.for("react.context"),bL=Symbol.for("react.forward_ref"),AL=Symbol.for("react.suspense"),EL=Symbol.for("react.memo"),TL=Symbol.for("react.lazy"),R1=Symbol.iterator;function SL(t){return t===null||typeof t!="object"?null:(t=R1&&t[R1]||t["@@iterator"],typeof t=="function"?t:null)}var sw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ow=Object.assign,aw={};function bc(t,e,n){this.props=t,this.context=e,this.refs=aw,this.updater=n||sw}bc.prototype.isReactComponent={};bc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};bc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cw(){}cw.prototype=bc.prototype;function Xv(t,e,n){this.props=t,this.context=e,this.refs=aw,this.updater=n||sw}var Jv=Xv.prototype=new cw;Jv.constructor=Xv;ow(Jv,bc.prototype);Jv.isPureReactComponent=!0;var I1=Array.isArray,lw=Object.prototype.hasOwnProperty,Kv={current:null},uw={key:!0,ref:!0,__self:!0,__source:!0};function fw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)lw.call(e,r)&&!uw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:lu,type:t,key:s,ref:o,props:i,_owner:Kv.current}}function CL(t,e){return{$$typeof:lu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Yv(t){return typeof t=="object"&&t!==null&&t.$$typeof===lu}function wL(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var L1=/\/+/g;function Lg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wL(""+t.key):e.toString(36)}function Vf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case lu:case gL:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Lg(o,0):r,I1(i)?(n="",t!=null&&(n=t.replace(L1,"$&/")+"/"),Vf(i,e,n,"",function(l){return l})):i!=null&&(Yv(i)&&(i=CL(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(L1,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",I1(t))for(var a=0;a<t.length;a++){s=t[a];var c=r+Lg(s,a);o+=Vf(s,e,n,c,i)}else if(c=SL(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=r+Lg(s,a++),o+=Vf(s,e,n,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Bu(t,e,n){if(t==null)return t;var r=[],i=0;return Vf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function xL(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Mn={current:null},Wf={transition:null},PL={ReactCurrentDispatcher:Mn,ReactCurrentBatchConfig:Wf,ReactCurrentOwner:Kv};Ce.Children={map:Bu,forEach:function(t,e,n){Bu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Bu(t,function(){e++}),e},toArray:function(t){return Bu(t,function(e){return e})||[]},only:function(t){if(!Yv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ce.Component=bc;Ce.Fragment=pL;Ce.Profiler=vL;Ce.PureComponent=Xv;Ce.StrictMode=mL;Ce.Suspense=AL;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PL;Ce.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ow({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Kv.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)lw.call(e,c)&&!uw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];r.children=a}return{$$typeof:lu,type:t.type,key:i,ref:s,props:r,_owner:o}};Ce.createContext=function(t){return t={$$typeof:_L,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:yL,_context:t},t.Consumer=t};Ce.createElement=fw;Ce.createFactory=function(t){var e=fw.bind(null,t);return e.type=t,e};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(t){return{$$typeof:bL,render:t}};Ce.isValidElement=Yv;Ce.lazy=function(t){return{$$typeof:TL,_payload:{_status:-1,_result:t},_init:xL}};Ce.memo=function(t,e){return{$$typeof:EL,type:t,compare:e===void 0?null:e}};Ce.startTransition=function(t){var e=Wf.transition;Wf.transition={};try{t()}finally{Wf.transition=e}};Ce.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ce.useCallback=function(t,e){return Mn.current.useCallback(t,e)};Ce.useContext=function(t){return Mn.current.useContext(t)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(t){return Mn.current.useDeferredValue(t)};Ce.useEffect=function(t,e){return Mn.current.useEffect(t,e)};Ce.useId=function(){return Mn.current.useId()};Ce.useImperativeHandle=function(t,e,n){return Mn.current.useImperativeHandle(t,e,n)};Ce.useInsertionEffect=function(t,e){return Mn.current.useInsertionEffect(t,e)};Ce.useLayoutEffect=function(t,e){return Mn.current.useLayoutEffect(t,e)};Ce.useMemo=function(t,e){return Mn.current.useMemo(t,e)};Ce.useReducer=function(t,e,n){return Mn.current.useReducer(t,e,n)};Ce.useRef=function(t){return Mn.current.useRef(t)};Ce.useState=function(t){return Mn.current.useState(t)};Ce.useSyncExternalStore=function(t,e,n){return Mn.current.useSyncExternalStore(t,e,n)};Ce.useTransition=function(){return Mn.current.useTransition()};Ce.version="18.2.0";iw.exports=Ce;var E=iw.exports;const Nn=cu(E),Md=nw({__proto__:null,default:Nn},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ML=E,RL=Symbol.for("react.element"),IL=Symbol.for("react.fragment"),LL=Object.prototype.hasOwnProperty,BL=ML.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,OL={key:!0,ref:!0,__self:!0,__source:!0};function hw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)LL.call(e,r)&&!OL.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:RL,type:t,key:s,ref:o,props:i,_owner:BL.current}}Pd.Fragment=IL;Pd.jsx=hw;Pd.jsxs=hw;rw.exports=Pd;var rr=rw.exports,xm={},dw={exports:{}},hr={},gw={exports:{}},pw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,D){var W=F.length;F.push(D);e:for(;0<W;){var ee=W-1>>>1,te=F[ee];if(0<i(te,D))F[ee]=D,F[W]=te,W=ee;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var D=F[0],W=F.pop();if(W!==D){F[0]=W;e:for(var ee=0,te=F.length,pe=te>>>1;ee<pe;){var Ae=2*(ee+1)-1,we=F[Ae],be=Ae+1,ie=F[be];if(0>i(we,W))be<te&&0>i(ie,we)?(F[ee]=ie,F[be]=W,ee=be):(F[ee]=we,F[Ae]=W,ee=Ae);else if(be<te&&0>i(ie,W))F[ee]=ie,F[be]=W,ee=be;else break e}}return D}function i(F,D){var W=F.sortIndex-D.sortIndex;return W!==0?W:F.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],u=1,f=null,h=3,d=!1,p=!1,y=!1,b=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(F){for(var D=n(l);D!==null;){if(D.callback===null)r(l);else if(D.startTime<=F)r(l),D.sortIndex=D.expirationTime,e(c,D);else break;D=n(l)}}function A(F){if(y=!1,_(F),!p)if(n(c)!==null)p=!0,V(S);else{var D=n(l);D!==null&&U(A,D.startTime-F)}}function S(F,D){p=!1,y&&(y=!1,v(M),M=-1),d=!0;var W=h;try{for(_(D),f=n(c);f!==null&&(!(f.expirationTime>D)||F&&!I());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,h=f.priorityLevel;var te=ee(f.expirationTime<=D);D=t.unstable_now(),typeof te=="function"?f.callback=te:f===n(c)&&r(c),_(D)}else r(c);f=n(c)}if(f!==null)var pe=!0;else{var Ae=n(l);Ae!==null&&U(A,Ae.startTime-D),pe=!1}return pe}finally{f=null,h=W,d=!1}}var w=!1,x=null,M=-1,L=5,R=-1;function I(){return!(t.unstable_now()-R<L)}function N(){if(x!==null){var F=t.unstable_now();R=F;var D=!0;try{D=x(!0,F)}finally{D?k():(w=!1,x=null)}}else w=!1}var k;if(typeof m=="function")k=function(){m(N)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,$=z.port2;z.port1.onmessage=N,k=function(){$.postMessage(null)}}else k=function(){b(N,0)};function V(F){x=F,w||(w=!0,k())}function U(F,D){M=b(function(){F(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){p||d||(p=!0,V(S))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(F){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var W=h;h=D;try{return F()}finally{h=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,D){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var W=h;h=F;try{return D()}finally{h=W}},t.unstable_scheduleCallback=function(F,D,W){var ee=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ee+W:ee):W=ee,F){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=W+te,F={id:u++,callback:D,priorityLevel:F,startTime:W,expirationTime:te,sortIndex:-1},W>ee?(F.sortIndex=W,e(l,F),n(c)===null&&F===n(l)&&(y?(v(M),M=-1):y=!0,U(A,W-ee))):(F.sortIndex=te,e(c,F),p||d||(p=!0,V(S))),F},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(F){var D=h;return function(){var W=h;h=D;try{return F.apply(this,arguments)}finally{h=W}}}})(pw);gw.exports=pw;var FL=gw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mw=E,fr=FL;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vw=new Set,Sl={};function Uo(t,e){Za(t,e),Za(t+"Capture",e)}function Za(t,e){for(Sl[t]=e,t=0;t<e.length;t++)vw.add(e[t])}var es=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pm=Object.prototype.hasOwnProperty,DL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B1={},O1={};function NL(t){return Pm.call(O1,t)?!0:Pm.call(B1,t)?!1:DL.test(t)?O1[t]=!0:(B1[t]=!0,!1)}function kL(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function UL(t,e,n,r){if(e===null||typeof e>"u"||kL(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){sn[t]=new Rn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];sn[e]=new Rn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){sn[t]=new Rn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){sn[t]=new Rn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){sn[t]=new Rn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){sn[t]=new Rn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){sn[t]=new Rn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){sn[t]=new Rn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){sn[t]=new Rn(t,5,!1,t.toLowerCase(),null,!1,!1)});var qv=/[\-:]([a-z])/g;function Qv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(qv,Qv);sn[e]=new Rn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(qv,Qv);sn[e]=new Rn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(qv,Qv);sn[e]=new Rn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){sn[t]=new Rn(t,1,!1,t.toLowerCase(),null,!1,!1)});sn.xlinkHref=new Rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){sn[t]=new Rn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Zv(t,e,n,r){var i=sn.hasOwnProperty(e)?sn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(UL(e,n,i,r)&&(n=null),r||i===null?NL(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var cs=mw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ou=Symbol.for("react.element"),ya=Symbol.for("react.portal"),_a=Symbol.for("react.fragment"),ey=Symbol.for("react.strict_mode"),Mm=Symbol.for("react.profiler"),yw=Symbol.for("react.provider"),_w=Symbol.for("react.context"),ty=Symbol.for("react.forward_ref"),Rm=Symbol.for("react.suspense"),Im=Symbol.for("react.suspense_list"),ny=Symbol.for("react.memo"),Ts=Symbol.for("react.lazy"),bw=Symbol.for("react.offscreen"),F1=Symbol.iterator;function Mc(t){return t===null||typeof t!="object"?null:(t=F1&&t[F1]||t["@@iterator"],typeof t=="function"?t:null)}var ut=Object.assign,Bg;function Zc(t){if(Bg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bg=e&&e[1]||""}return`
`+Bg+t}var Og=!1;function Fg(t,e){if(!t||Og)return"";Og=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Og=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Zc(t):""}function zL(t){switch(t.tag){case 5:return Zc(t.type);case 16:return Zc("Lazy");case 13:return Zc("Suspense");case 19:return Zc("SuspenseList");case 0:case 2:case 15:return t=Fg(t.type,!1),t;case 11:return t=Fg(t.type.render,!1),t;case 1:return t=Fg(t.type,!0),t;default:return""}}function Lm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _a:return"Fragment";case ya:return"Portal";case Mm:return"Profiler";case ey:return"StrictMode";case Rm:return"Suspense";case Im:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _w:return(t.displayName||"Context")+".Consumer";case yw:return(t._context.displayName||"Context")+".Provider";case ty:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ny:return e=t.displayName||null,e!==null?e:Lm(t.type)||"Memo";case Ts:e=t._payload,t=t._init;try{return Lm(t(e))}catch{}}return null}function HL(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lm(e);case 8:return e===ey?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function js(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Aw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jL(t){var e=Aw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fu(t){t._valueTracker||(t._valueTracker=jL(t))}function Ew(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Aw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Eh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Bm(t,e){var n=e.checked;return ut({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function D1(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=js(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Tw(t,e){e=e.checked,e!=null&&Zv(t,"checked",e,!1)}function Om(t,e){Tw(t,e);var n=js(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Fm(t,e.type,n):e.hasOwnProperty("defaultValue")&&Fm(t,e.type,js(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function N1(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Fm(t,e,n){(e!=="number"||Eh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var el=Array.isArray;function Ga(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+js(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Dm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return ut({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function k1(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(el(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:js(n)}}function Sw(t,e){var n=js(e.value),r=js(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function U1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Cw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Cw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Du,ww=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Du=Du||document.createElement("div"),Du.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Du.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Cl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var al={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VL=["Webkit","ms","Moz","O"];Object.keys(al).forEach(function(t){VL.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),al[e]=al[t]})});function xw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||al.hasOwnProperty(t)&&al[t]?(""+e).trim():e+"px"}function Pw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=xw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var WL=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function km(t,e){if(e){if(WL[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Um(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gm=null;function ry(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zm=null,za=null,Ha=null;function G1(t){if(t=hu(t)){if(typeof zm!="function")throw Error(H(280));var e=t.stateNode;e&&(e=Od(e),zm(t.stateNode,t.type,e))}}function Mw(t){za?Ha?Ha.push(t):Ha=[t]:za=t}function Rw(){if(za){var t=za,e=Ha;if(Ha=za=null,G1(t),e)for(t=0;t<e.length;t++)G1(e[t])}}function Iw(t,e){return t(e)}function Lw(){}var Dg=!1;function Bw(t,e,n){if(Dg)return t(e,n);Dg=!0;try{return Iw(t,e,n)}finally{Dg=!1,(za!==null||Ha!==null)&&(Lw(),Rw())}}function wl(t,e){var n=t.stateNode;if(n===null)return null;var r=Od(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var Hm=!1;if(es)try{var Rc={};Object.defineProperty(Rc,"passive",{get:function(){Hm=!0}}),window.addEventListener("test",Rc,Rc),window.removeEventListener("test",Rc,Rc)}catch{Hm=!1}function $L(t,e,n,r,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var cl=!1,Th=null,Sh=!1,jm=null,XL={onError:function(t){cl=!0,Th=t}};function JL(t,e,n,r,i,s,o,a,c){cl=!1,Th=null,$L.apply(XL,arguments)}function KL(t,e,n,r,i,s,o,a,c){if(JL.apply(this,arguments),cl){if(cl){var l=Th;cl=!1,Th=null}else throw Error(H(198));Sh||(Sh=!0,jm=l)}}function Go(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ow(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function z1(t){if(Go(t)!==t)throw Error(H(188))}function YL(t){var e=t.alternate;if(!e){if(e=Go(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return z1(i),t;if(s===r)return z1(i),e;s=s.sibling}throw Error(H(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function Fw(t){return t=YL(t),t!==null?Dw(t):null}function Dw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Dw(t);if(e!==null)return e;t=t.sibling}return null}var Nw=fr.unstable_scheduleCallback,H1=fr.unstable_cancelCallback,qL=fr.unstable_shouldYield,QL=fr.unstable_requestPaint,At=fr.unstable_now,ZL=fr.unstable_getCurrentPriorityLevel,iy=fr.unstable_ImmediatePriority,kw=fr.unstable_UserBlockingPriority,Ch=fr.unstable_NormalPriority,eB=fr.unstable_LowPriority,Uw=fr.unstable_IdlePriority,Rd=null,Mi=null;function tB(t){if(Mi&&typeof Mi.onCommitFiberRoot=="function")try{Mi.onCommitFiberRoot(Rd,t,void 0,(t.current.flags&128)===128)}catch{}}var oi=Math.clz32?Math.clz32:iB,nB=Math.log,rB=Math.LN2;function iB(t){return t>>>=0,t===0?32:31-(nB(t)/rB|0)|0}var Nu=64,ku=4194304;function tl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function wh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=tl(a):(s&=o,s!==0&&(r=tl(s)))}else o=n&~i,o!==0?r=tl(o):s!==0&&(r=tl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-oi(e),i=1<<n,r|=t[n],e&=~i;return r}function sB(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oB(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-oi(s),a=1<<o,c=i[o];c===-1?(!(a&n)||a&r)&&(i[o]=sB(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function Vm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Gw(){var t=Nu;return Nu<<=1,!(Nu&4194240)&&(Nu=64),t}function Ng(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function uu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-oi(e),t[e]=n}function aB(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-oi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function sy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-oi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ue=0;function zw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hw,oy,jw,Vw,Ww,Wm=!1,Uu=[],Bs=null,Os=null,Fs=null,xl=new Map,Pl=new Map,Cs=[],cB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function j1(t,e){switch(t){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Os=null;break;case"mouseover":case"mouseout":Fs=null;break;case"pointerover":case"pointerout":xl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pl.delete(e.pointerId)}}function Ic(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=hu(e),e!==null&&oy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function lB(t,e,n,r,i){switch(e){case"focusin":return Bs=Ic(Bs,t,e,n,r,i),!0;case"dragenter":return Os=Ic(Os,t,e,n,r,i),!0;case"mouseover":return Fs=Ic(Fs,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return xl.set(s,Ic(xl.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Pl.set(s,Ic(Pl.get(s)||null,t,e,n,r,i)),!0}return!1}function $w(t){var e=fo(t.target);if(e!==null){var n=Go(e);if(n!==null){if(e=n.tag,e===13){if(e=Ow(n),e!==null){t.blockedOn=e,Ww(t.priority,function(){jw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function $f(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=$m(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Gm=r,n.target.dispatchEvent(r),Gm=null}else return e=hu(n),e!==null&&oy(e),t.blockedOn=n,!1;e.shift()}return!0}function V1(t,e,n){$f(t)&&n.delete(e)}function uB(){Wm=!1,Bs!==null&&$f(Bs)&&(Bs=null),Os!==null&&$f(Os)&&(Os=null),Fs!==null&&$f(Fs)&&(Fs=null),xl.forEach(V1),Pl.forEach(V1)}function Lc(t,e){t.blockedOn===e&&(t.blockedOn=null,Wm||(Wm=!0,fr.unstable_scheduleCallback(fr.unstable_NormalPriority,uB)))}function Ml(t){function e(i){return Lc(i,t)}if(0<Uu.length){Lc(Uu[0],t);for(var n=1;n<Uu.length;n++){var r=Uu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Bs!==null&&Lc(Bs,t),Os!==null&&Lc(Os,t),Fs!==null&&Lc(Fs,t),xl.forEach(e),Pl.forEach(e),n=0;n<Cs.length;n++)r=Cs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Cs.length&&(n=Cs[0],n.blockedOn===null);)$w(n),n.blockedOn===null&&Cs.shift()}var ja=cs.ReactCurrentBatchConfig,xh=!0;function fB(t,e,n,r){var i=Ue,s=ja.transition;ja.transition=null;try{Ue=1,ay(t,e,n,r)}finally{Ue=i,ja.transition=s}}function hB(t,e,n,r){var i=Ue,s=ja.transition;ja.transition=null;try{Ue=4,ay(t,e,n,r)}finally{Ue=i,ja.transition=s}}function ay(t,e,n,r){if(xh){var i=$m(t,e,n,r);if(i===null)Xg(t,e,r,Ph,n),j1(t,r);else if(lB(i,t,e,n,r))r.stopPropagation();else if(j1(t,r),e&4&&-1<cB.indexOf(t)){for(;i!==null;){var s=hu(i);if(s!==null&&Hw(s),s=$m(t,e,n,r),s===null&&Xg(t,e,r,Ph,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Xg(t,e,r,null,n)}}var Ph=null;function $m(t,e,n,r){if(Ph=null,t=ry(r),t=fo(t),t!==null)if(e=Go(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ow(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ph=t,null}function Xw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZL()){case iy:return 1;case kw:return 4;case Ch:case eB:return 16;case Uw:return 536870912;default:return 16}default:return 16}}var xs=null,cy=null,Xf=null;function Jw(){if(Xf)return Xf;var t,e=cy,n=e.length,r,i="value"in xs?xs.value:xs.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Xf=i.slice(t,1<r?1-r:void 0)}function Jf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Gu(){return!0}function W1(){return!1}function dr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Gu:W1,this.isPropagationStopped=W1,this}return ut(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Gu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Gu)},persist:function(){},isPersistent:Gu}),e}var Ac={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ly=dr(Ac),fu=ut({},Ac,{view:0,detail:0}),dB=dr(fu),kg,Ug,Bc,Id=ut({},fu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bc&&(Bc&&t.type==="mousemove"?(kg=t.screenX-Bc.screenX,Ug=t.screenY-Bc.screenY):Ug=kg=0,Bc=t),kg)},movementY:function(t){return"movementY"in t?t.movementY:Ug}}),$1=dr(Id),gB=ut({},Id,{dataTransfer:0}),pB=dr(gB),mB=ut({},fu,{relatedTarget:0}),Gg=dr(mB),vB=ut({},Ac,{animationName:0,elapsedTime:0,pseudoElement:0}),yB=dr(vB),_B=ut({},Ac,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bB=dr(_B),AB=ut({},Ac,{data:0}),X1=dr(AB),EB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SB={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CB(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=SB[t])?!!e[t]:!1}function uy(){return CB}var wB=ut({},fu,{key:function(t){if(t.key){var e=EB[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Jf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TB[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uy,charCode:function(t){return t.type==="keypress"?Jf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Jf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xB=dr(wB),PB=ut({},Id,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),J1=dr(PB),MB=ut({},fu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uy}),RB=dr(MB),IB=ut({},Ac,{propertyName:0,elapsedTime:0,pseudoElement:0}),LB=dr(IB),BB=ut({},Id,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),OB=dr(BB),FB=[9,13,27,32],fy=es&&"CompositionEvent"in window,ll=null;es&&"documentMode"in document&&(ll=document.documentMode);var DB=es&&"TextEvent"in window&&!ll,Kw=es&&(!fy||ll&&8<ll&&11>=ll),K1=String.fromCharCode(32),Y1=!1;function Yw(t,e){switch(t){case"keyup":return FB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ba=!1;function NB(t,e){switch(t){case"compositionend":return qw(e);case"keypress":return e.which!==32?null:(Y1=!0,K1);case"textInput":return t=e.data,t===K1&&Y1?null:t;default:return null}}function kB(t,e){if(ba)return t==="compositionend"||!fy&&Yw(t,e)?(t=Jw(),Xf=cy=xs=null,ba=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Kw&&e.locale!=="ko"?null:e.data;default:return null}}var UB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function q1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!UB[t.type]:e==="textarea"}function Qw(t,e,n,r){Mw(r),e=Mh(e,"onChange"),0<e.length&&(n=new ly("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ul=null,Rl=null;function GB(t){lx(t,0)}function Ld(t){var e=Ta(t);if(Ew(e))return t}function zB(t,e){if(t==="change")return e}var Zw=!1;if(es){var zg;if(es){var Hg="oninput"in document;if(!Hg){var Q1=document.createElement("div");Q1.setAttribute("oninput","return;"),Hg=typeof Q1.oninput=="function"}zg=Hg}else zg=!1;Zw=zg&&(!document.documentMode||9<document.documentMode)}function Z1(){ul&&(ul.detachEvent("onpropertychange",ex),Rl=ul=null)}function ex(t){if(t.propertyName==="value"&&Ld(Rl)){var e=[];Qw(e,Rl,t,ry(t)),Bw(GB,e)}}function HB(t,e,n){t==="focusin"?(Z1(),ul=e,Rl=n,ul.attachEvent("onpropertychange",ex)):t==="focusout"&&Z1()}function jB(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ld(Rl)}function VB(t,e){if(t==="click")return Ld(e)}function WB(t,e){if(t==="input"||t==="change")return Ld(e)}function $B(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ui=typeof Object.is=="function"?Object.is:$B;function Il(t,e){if(ui(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Pm.call(e,i)||!ui(t[i],e[i]))return!1}return!0}function eb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tb(t,e){var n=eb(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=eb(n)}}function tx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?tx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function nx(){for(var t=window,e=Eh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Eh(t.document)}return e}function hy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function XB(t){var e=nx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&tx(n.ownerDocument.documentElement,n)){if(r!==null&&hy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=tb(n,s);var o=tb(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var JB=es&&"documentMode"in document&&11>=document.documentMode,Aa=null,Xm=null,fl=null,Jm=!1;function nb(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jm||Aa==null||Aa!==Eh(r)||(r=Aa,"selectionStart"in r&&hy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),fl&&Il(fl,r)||(fl=r,r=Mh(Xm,"onSelect"),0<r.length&&(e=new ly("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Aa)))}function zu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ea={animationend:zu("Animation","AnimationEnd"),animationiteration:zu("Animation","AnimationIteration"),animationstart:zu("Animation","AnimationStart"),transitionend:zu("Transition","TransitionEnd")},jg={},rx={};es&&(rx=document.createElement("div").style,"AnimationEvent"in window||(delete Ea.animationend.animation,delete Ea.animationiteration.animation,delete Ea.animationstart.animation),"TransitionEvent"in window||delete Ea.transitionend.transition);function Bd(t){if(jg[t])return jg[t];if(!Ea[t])return t;var e=Ea[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in rx)return jg[t]=e[n];return t}var ix=Bd("animationend"),sx=Bd("animationiteration"),ox=Bd("animationstart"),ax=Bd("transitionend"),cx=new Map,rb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xs(t,e){cx.set(t,e),Uo(e,[t])}for(var Vg=0;Vg<rb.length;Vg++){var Wg=rb[Vg],KB=Wg.toLowerCase(),YB=Wg[0].toUpperCase()+Wg.slice(1);Xs(KB,"on"+YB)}Xs(ix,"onAnimationEnd");Xs(sx,"onAnimationIteration");Xs(ox,"onAnimationStart");Xs("dblclick","onDoubleClick");Xs("focusin","onFocus");Xs("focusout","onBlur");Xs(ax,"onTransitionEnd");Za("onMouseEnter",["mouseout","mouseover"]);Za("onMouseLeave",["mouseout","mouseover"]);Za("onPointerEnter",["pointerout","pointerover"]);Za("onPointerLeave",["pointerout","pointerover"]);Uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qB=new Set("cancel close invalid load scroll toggle".split(" ").concat(nl));function ib(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,KL(r,e,void 0,t),t.currentTarget=null}function lx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;ib(i,a,l),s=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;ib(i,a,l),s=c}}}if(Sh)throw t=jm,Sh=!1,jm=null,t}function et(t,e){var n=e[Zm];n===void 0&&(n=e[Zm]=new Set);var r=t+"__bubble";n.has(r)||(ux(e,t,2,!1),n.add(r))}function $g(t,e,n){var r=0;e&&(r|=4),ux(n,t,r,e)}var Hu="_reactListening"+Math.random().toString(36).slice(2);function Ll(t){if(!t[Hu]){t[Hu]=!0,vw.forEach(function(n){n!=="selectionchange"&&(qB.has(n)||$g(n,!1,t),$g(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hu]||(e[Hu]=!0,$g("selectionchange",!1,e))}}function ux(t,e,n,r){switch(Xw(e)){case 1:var i=fB;break;case 4:i=hB;break;default:i=ay}n=i.bind(null,e,n,t),i=void 0,!Hm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Xg(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=fo(a),o===null)return;if(c=o.tag,c===5||c===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Bw(function(){var l=s,u=ry(n),f=[];e:{var h=cx.get(t);if(h!==void 0){var d=ly,p=t;switch(t){case"keypress":if(Jf(n)===0)break e;case"keydown":case"keyup":d=xB;break;case"focusin":p="focus",d=Gg;break;case"focusout":p="blur",d=Gg;break;case"beforeblur":case"afterblur":d=Gg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=pB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=RB;break;case ix:case sx:case ox:d=yB;break;case ax:d=LB;break;case"scroll":d=dB;break;case"wheel":d=OB;break;case"copy":case"cut":case"paste":d=bB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=J1}var y=(e&4)!==0,b=!y&&t==="scroll",v=y?h!==null?h+"Capture":null:h;y=[];for(var m=l,_;m!==null;){_=m;var A=_.stateNode;if(_.tag===5&&A!==null&&(_=A,v!==null&&(A=wl(m,v),A!=null&&y.push(Bl(m,A,_)))),b)break;m=m.return}0<y.length&&(h=new d(h,p,null,n,u),f.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",h&&n!==Gm&&(p=n.relatedTarget||n.fromElement)&&(fo(p)||p[ts]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(p=n.relatedTarget||n.toElement,d=l,p=p?fo(p):null,p!==null&&(b=Go(p),p!==b||p.tag!==5&&p.tag!==6)&&(p=null)):(d=null,p=l),d!==p)){if(y=$1,A="onMouseLeave",v="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(y=J1,A="onPointerLeave",v="onPointerEnter",m="pointer"),b=d==null?h:Ta(d),_=p==null?h:Ta(p),h=new y(A,m+"leave",d,n,u),h.target=b,h.relatedTarget=_,A=null,fo(u)===l&&(y=new y(v,m+"enter",p,n,u),y.target=_,y.relatedTarget=b,A=y),b=A,d&&p)t:{for(y=d,v=p,m=0,_=y;_;_=Zo(_))m++;for(_=0,A=v;A;A=Zo(A))_++;for(;0<m-_;)y=Zo(y),m--;for(;0<_-m;)v=Zo(v),_--;for(;m--;){if(y===v||v!==null&&y===v.alternate)break t;y=Zo(y),v=Zo(v)}y=null}else y=null;d!==null&&sb(f,h,d,y,!1),p!==null&&b!==null&&sb(f,b,p,y,!0)}}e:{if(h=l?Ta(l):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var S=zB;else if(q1(h))if(Zw)S=WB;else{S=jB;var w=HB}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=VB);if(S&&(S=S(t,l))){Qw(f,S,n,u);break e}w&&w(t,h,l),t==="focusout"&&(w=h._wrapperState)&&w.controlled&&h.type==="number"&&Fm(h,"number",h.value)}switch(w=l?Ta(l):window,t){case"focusin":(q1(w)||w.contentEditable==="true")&&(Aa=w,Xm=l,fl=null);break;case"focusout":fl=Xm=Aa=null;break;case"mousedown":Jm=!0;break;case"contextmenu":case"mouseup":case"dragend":Jm=!1,nb(f,n,u);break;case"selectionchange":if(JB)break;case"keydown":case"keyup":nb(f,n,u)}var x;if(fy)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else ba?Yw(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Kw&&n.locale!=="ko"&&(ba||M!=="onCompositionStart"?M==="onCompositionEnd"&&ba&&(x=Jw()):(xs=u,cy="value"in xs?xs.value:xs.textContent,ba=!0)),w=Mh(l,M),0<w.length&&(M=new X1(M,t,null,n,u),f.push({event:M,listeners:w}),x?M.data=x:(x=qw(n),x!==null&&(M.data=x)))),(x=DB?NB(t,n):kB(t,n))&&(l=Mh(l,"onBeforeInput"),0<l.length&&(u=new X1("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:l}),u.data=x))}lx(f,e)})}function Bl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Mh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=wl(t,n),s!=null&&r.unshift(Bl(t,s,i)),s=wl(t,e),s!=null&&r.push(Bl(t,s,i))),t=t.return}return r}function Zo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function sb(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&l!==null&&(a=l,i?(c=wl(n,s),c!=null&&o.unshift(Bl(n,c,a))):i||(c=wl(n,s),c!=null&&o.push(Bl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var QB=/\r\n?/g,ZB=/\u0000|\uFFFD/g;function ob(t){return(typeof t=="string"?t:""+t).replace(QB,`
`).replace(ZB,"")}function ju(t,e,n){if(e=ob(e),ob(t)!==e&&n)throw Error(H(425))}function Rh(){}var Km=null,Ym=null;function qm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qm=typeof setTimeout=="function"?setTimeout:void 0,eO=typeof clearTimeout=="function"?clearTimeout:void 0,ab=typeof Promise=="function"?Promise:void 0,tO=typeof queueMicrotask=="function"?queueMicrotask:typeof ab<"u"?function(t){return ab.resolve(null).then(t).catch(nO)}:Qm;function nO(t){setTimeout(function(){throw t})}function Jg(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ml(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ml(e)}function Ds(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function cb(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ec=Math.random().toString(36).slice(2),Si="__reactFiber$"+Ec,Ol="__reactProps$"+Ec,ts="__reactContainer$"+Ec,Zm="__reactEvents$"+Ec,rO="__reactListeners$"+Ec,iO="__reactHandles$"+Ec;function fo(t){var e=t[Si];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ts]||n[Si]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=cb(t);t!==null;){if(n=t[Si])return n;t=cb(t)}return e}t=n,n=t.parentNode}return null}function hu(t){return t=t[Si]||t[ts],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ta(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function Od(t){return t[Ol]||null}var e0=[],Sa=-1;function Js(t){return{current:t}}function tt(t){0>Sa||(t.current=e0[Sa],e0[Sa]=null,Sa--)}function Ye(t,e){Sa++,e0[Sa]=t.current,t.current=e}var Vs={},_n=Js(Vs),Vn=Js(!1),xo=Vs;function ec(t,e){var n=t.type.contextTypes;if(!n)return Vs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Wn(t){return t=t.childContextTypes,t!=null}function Ih(){tt(Vn),tt(_n)}function lb(t,e,n){if(_n.current!==Vs)throw Error(H(168));Ye(_n,e),Ye(Vn,n)}function fx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(H(108,HL(t)||"Unknown",i));return ut({},n,r)}function Lh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vs,xo=_n.current,Ye(_n,t),Ye(Vn,Vn.current),!0}function ub(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=fx(t,e,xo),r.__reactInternalMemoizedMergedChildContext=t,tt(Vn),tt(_n),Ye(_n,t)):tt(Vn),Ye(Vn,n)}var Hi=null,Fd=!1,Kg=!1;function hx(t){Hi===null?Hi=[t]:Hi.push(t)}function sO(t){Fd=!0,hx(t)}function Ks(){if(!Kg&&Hi!==null){Kg=!0;var t=0,e=Ue;try{var n=Hi;for(Ue=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Hi=null,Fd=!1}catch(i){throw Hi!==null&&(Hi=Hi.slice(t+1)),Nw(iy,Ks),i}finally{Ue=e,Kg=!1}}return null}var Ca=[],wa=0,Bh=null,Oh=0,Tr=[],Sr=0,Po=null,Xi=1,Ji="";function oo(t,e){Ca[wa++]=Oh,Ca[wa++]=Bh,Bh=t,Oh=e}function dx(t,e,n){Tr[Sr++]=Xi,Tr[Sr++]=Ji,Tr[Sr++]=Po,Po=t;var r=Xi;t=Ji;var i=32-oi(r)-1;r&=~(1<<i),n+=1;var s=32-oi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xi=1<<32-oi(e)+i|n<<i|r,Ji=s+t}else Xi=1<<s|n<<i|r,Ji=t}function dy(t){t.return!==null&&(oo(t,1),dx(t,1,0))}function gy(t){for(;t===Bh;)Bh=Ca[--wa],Ca[wa]=null,Oh=Ca[--wa],Ca[wa]=null;for(;t===Po;)Po=Tr[--Sr],Tr[Sr]=null,Ji=Tr[--Sr],Tr[Sr]=null,Xi=Tr[--Sr],Tr[Sr]=null}var lr=null,ar=null,rt=!1,qr=null;function gx(t,e){var n=Cr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fb(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,lr=t,ar=Ds(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,lr=t,ar=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Po!==null?{id:Xi,overflow:Ji}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Cr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,lr=t,ar=null,!0):!1;default:return!1}}function t0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function n0(t){if(rt){var e=ar;if(e){var n=e;if(!fb(t,e)){if(t0(t))throw Error(H(418));e=Ds(n.nextSibling);var r=lr;e&&fb(t,e)?gx(r,n):(t.flags=t.flags&-4097|2,rt=!1,lr=t)}}else{if(t0(t))throw Error(H(418));t.flags=t.flags&-4097|2,rt=!1,lr=t}}}function hb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;lr=t}function Vu(t){if(t!==lr)return!1;if(!rt)return hb(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!qm(t.type,t.memoizedProps)),e&&(e=ar)){if(t0(t))throw px(),Error(H(418));for(;e;)gx(t,e),e=Ds(e.nextSibling)}if(hb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ar=Ds(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ar=null}}else ar=lr?Ds(t.stateNode.nextSibling):null;return!0}function px(){for(var t=ar;t;)t=Ds(t.nextSibling)}function tc(){ar=lr=null,rt=!1}function py(t){qr===null?qr=[t]:qr.push(t)}var oO=cs.ReactCurrentBatchConfig;function Jr(t,e){if(t&&t.defaultProps){e=ut({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Fh=Js(null),Dh=null,xa=null,my=null;function vy(){my=xa=Dh=null}function yy(t){var e=Fh.current;tt(Fh),t._currentValue=e}function r0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Va(t,e){Dh=t,my=xa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Gn=!0),t.firstContext=null)}function Ir(t){var e=t._currentValue;if(my!==t)if(t={context:t,memoizedValue:e,next:null},xa===null){if(Dh===null)throw Error(H(308));xa=t,Dh.dependencies={lanes:0,firstContext:t}}else xa=xa.next=t;return e}var ho=null;function _y(t){ho===null?ho=[t]:ho.push(t)}function mx(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,_y(e)):(n.next=i.next,i.next=n),e.interleaved=n,ns(t,r)}function ns(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ss=!1;function by(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ns(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ns(t,n)}return i=r.interleaved,i===null?(e.next=e,_y(r)):(e.next=i.next,i.next=e),r.interleaved=e,ns(t,n)}function Kf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sy(t,n)}}function db(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Nh(t,e,n,r){var i=t.updateQueue;Ss=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,u=l=c=null,a=s;do{var h=a.lane,d=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,y=a;switch(h=e,d=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){f=p.call(d,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,h=typeof p=="function"?p.call(d,f,h):p,h==null)break e;f=ut({},f,h);break e;case 2:Ss=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else d={eventTime:d,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(l=u=d,c=f):u=u.next=d,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(c=f),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ro|=o,t.lanes=o,t.memoizedState=f}}function gb(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(H(191,i));i.call(r)}}}var yx=new mw.Component().refs;function i0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ut({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dd={isMounted:function(t){return(t=t._reactInternals)?Go(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Pn(),i=Us(t),s=qi(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ns(t,s,i),e!==null&&(ai(e,t,i,r),Kf(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Pn(),i=Us(t),s=qi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ns(t,s,i),e!==null&&(ai(e,t,i,r),Kf(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Pn(),r=Us(t),i=qi(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ns(t,i,r),e!==null&&(ai(e,t,r,n),Kf(e,t,r))}};function pb(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Il(n,r)||!Il(i,s):!0}function _x(t,e,n){var r=!1,i=Vs,s=e.contextType;return typeof s=="object"&&s!==null?s=Ir(s):(i=Wn(e)?xo:_n.current,r=e.contextTypes,s=(r=r!=null)?ec(t,i):Vs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function mb(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dd.enqueueReplaceState(e,e.state,null)}function s0(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=yx,by(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ir(s):(s=Wn(e)?xo:_n.current,i.context=ec(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(i0(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Dd.enqueueReplaceState(i,i.state,null),Nh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Oc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===yx&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function Wu(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vb(t){var e=t._init;return e(t._payload)}function bx(t){function e(v,m){if(t){var _=v.deletions;_===null?(v.deletions=[m],v.flags|=16):_.push(m)}}function n(v,m){if(!t)return null;for(;m!==null;)e(v,m),m=m.sibling;return null}function r(v,m){for(v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function i(v,m){return v=Gs(v,m),v.index=0,v.sibling=null,v}function s(v,m,_){return v.index=_,t?(_=v.alternate,_!==null?(_=_.index,_<m?(v.flags|=2,m):_):(v.flags|=2,m)):(v.flags|=1048576,m)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function a(v,m,_,A){return m===null||m.tag!==6?(m=np(_,v.mode,A),m.return=v,m):(m=i(m,_),m.return=v,m)}function c(v,m,_,A){var S=_.type;return S===_a?u(v,m,_.props.children,A,_.key):m!==null&&(m.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ts&&vb(S)===m.type)?(A=i(m,_.props),A.ref=Oc(v,m,_),A.return=v,A):(A=th(_.type,_.key,_.props,null,v.mode,A),A.ref=Oc(v,m,_),A.return=v,A)}function l(v,m,_,A){return m===null||m.tag!==4||m.stateNode.containerInfo!==_.containerInfo||m.stateNode.implementation!==_.implementation?(m=rp(_,v.mode,A),m.return=v,m):(m=i(m,_.children||[]),m.return=v,m)}function u(v,m,_,A,S){return m===null||m.tag!==7?(m=bo(_,v.mode,A,S),m.return=v,m):(m=i(m,_),m.return=v,m)}function f(v,m,_){if(typeof m=="string"&&m!==""||typeof m=="number")return m=np(""+m,v.mode,_),m.return=v,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ou:return _=th(m.type,m.key,m.props,null,v.mode,_),_.ref=Oc(v,null,m),_.return=v,_;case ya:return m=rp(m,v.mode,_),m.return=v,m;case Ts:var A=m._init;return f(v,A(m._payload),_)}if(el(m)||Mc(m))return m=bo(m,v.mode,_,null),m.return=v,m;Wu(v,m)}return null}function h(v,m,_,A){var S=m!==null?m.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return S!==null?null:a(v,m,""+_,A);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ou:return _.key===S?c(v,m,_,A):null;case ya:return _.key===S?l(v,m,_,A):null;case Ts:return S=_._init,h(v,m,S(_._payload),A)}if(el(_)||Mc(_))return S!==null?null:u(v,m,_,A,null);Wu(v,_)}return null}function d(v,m,_,A,S){if(typeof A=="string"&&A!==""||typeof A=="number")return v=v.get(_)||null,a(m,v,""+A,S);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Ou:return v=v.get(A.key===null?_:A.key)||null,c(m,v,A,S);case ya:return v=v.get(A.key===null?_:A.key)||null,l(m,v,A,S);case Ts:var w=A._init;return d(v,m,_,w(A._payload),S)}if(el(A)||Mc(A))return v=v.get(_)||null,u(m,v,A,S,null);Wu(m,A)}return null}function p(v,m,_,A){for(var S=null,w=null,x=m,M=m=0,L=null;x!==null&&M<_.length;M++){x.index>M?(L=x,x=null):L=x.sibling;var R=h(v,x,_[M],A);if(R===null){x===null&&(x=L);break}t&&x&&R.alternate===null&&e(v,x),m=s(R,m,M),w===null?S=R:w.sibling=R,w=R,x=L}if(M===_.length)return n(v,x),rt&&oo(v,M),S;if(x===null){for(;M<_.length;M++)x=f(v,_[M],A),x!==null&&(m=s(x,m,M),w===null?S=x:w.sibling=x,w=x);return rt&&oo(v,M),S}for(x=r(v,x);M<_.length;M++)L=d(x,v,M,_[M],A),L!==null&&(t&&L.alternate!==null&&x.delete(L.key===null?M:L.key),m=s(L,m,M),w===null?S=L:w.sibling=L,w=L);return t&&x.forEach(function(I){return e(v,I)}),rt&&oo(v,M),S}function y(v,m,_,A){var S=Mc(_);if(typeof S!="function")throw Error(H(150));if(_=S.call(_),_==null)throw Error(H(151));for(var w=S=null,x=m,M=m=0,L=null,R=_.next();x!==null&&!R.done;M++,R=_.next()){x.index>M?(L=x,x=null):L=x.sibling;var I=h(v,x,R.value,A);if(I===null){x===null&&(x=L);break}t&&x&&I.alternate===null&&e(v,x),m=s(I,m,M),w===null?S=I:w.sibling=I,w=I,x=L}if(R.done)return n(v,x),rt&&oo(v,M),S;if(x===null){for(;!R.done;M++,R=_.next())R=f(v,R.value,A),R!==null&&(m=s(R,m,M),w===null?S=R:w.sibling=R,w=R);return rt&&oo(v,M),S}for(x=r(v,x);!R.done;M++,R=_.next())R=d(x,v,M,R.value,A),R!==null&&(t&&R.alternate!==null&&x.delete(R.key===null?M:R.key),m=s(R,m,M),w===null?S=R:w.sibling=R,w=R);return t&&x.forEach(function(N){return e(v,N)}),rt&&oo(v,M),S}function b(v,m,_,A){if(typeof _=="object"&&_!==null&&_.type===_a&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Ou:e:{for(var S=_.key,w=m;w!==null;){if(w.key===S){if(S=_.type,S===_a){if(w.tag===7){n(v,w.sibling),m=i(w,_.props.children),m.return=v,v=m;break e}}else if(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Ts&&vb(S)===w.type){n(v,w.sibling),m=i(w,_.props),m.ref=Oc(v,w,_),m.return=v,v=m;break e}n(v,w);break}else e(v,w);w=w.sibling}_.type===_a?(m=bo(_.props.children,v.mode,A,_.key),m.return=v,v=m):(A=th(_.type,_.key,_.props,null,v.mode,A),A.ref=Oc(v,m,_),A.return=v,v=A)}return o(v);case ya:e:{for(w=_.key;m!==null;){if(m.key===w)if(m.tag===4&&m.stateNode.containerInfo===_.containerInfo&&m.stateNode.implementation===_.implementation){n(v,m.sibling),m=i(m,_.children||[]),m.return=v,v=m;break e}else{n(v,m);break}else e(v,m);m=m.sibling}m=rp(_,v.mode,A),m.return=v,v=m}return o(v);case Ts:return w=_._init,b(v,m,w(_._payload),A)}if(el(_))return p(v,m,_,A);if(Mc(_))return y(v,m,_,A);Wu(v,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,m!==null&&m.tag===6?(n(v,m.sibling),m=i(m,_),m.return=v,v=m):(n(v,m),m=np(_,v.mode,A),m.return=v,v=m),o(v)):n(v,m)}return b}var nc=bx(!0),Ax=bx(!1),du={},Ri=Js(du),Fl=Js(du),Dl=Js(du);function go(t){if(t===du)throw Error(H(174));return t}function Ay(t,e){switch(Ye(Dl,e),Ye(Fl,t),Ye(Ri,du),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Nm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Nm(e,t)}tt(Ri),Ye(Ri,e)}function rc(){tt(Ri),tt(Fl),tt(Dl)}function Ex(t){go(Dl.current);var e=go(Ri.current),n=Nm(e,t.type);e!==n&&(Ye(Fl,t),Ye(Ri,n))}function Ey(t){Fl.current===t&&(tt(Ri),tt(Fl))}var ot=Js(0);function kh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Yg=[];function Ty(){for(var t=0;t<Yg.length;t++)Yg[t]._workInProgressVersionPrimary=null;Yg.length=0}var Yf=cs.ReactCurrentDispatcher,qg=cs.ReactCurrentBatchConfig,Mo=0,lt=null,Gt=null,Jt=null,Uh=!1,hl=!1,Nl=0,aO=0;function hn(){throw Error(H(321))}function Sy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ui(t[n],e[n]))return!1;return!0}function Cy(t,e,n,r,i,s){if(Mo=s,lt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Yf.current=t===null||t.memoizedState===null?fO:hO,t=n(r,i),hl){s=0;do{if(hl=!1,Nl=0,25<=s)throw Error(H(301));s+=1,Jt=Gt=null,e.updateQueue=null,Yf.current=dO,t=n(r,i)}while(hl)}if(Yf.current=Gh,e=Gt!==null&&Gt.next!==null,Mo=0,Jt=Gt=lt=null,Uh=!1,e)throw Error(H(300));return t}function wy(){var t=Nl!==0;return Nl=0,t}function Ei(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?lt.memoizedState=Jt=t:Jt=Jt.next=t,Jt}function Lr(){if(Gt===null){var t=lt.alternate;t=t!==null?t.memoizedState:null}else t=Gt.next;var e=Jt===null?lt.memoizedState:Jt.next;if(e!==null)Jt=e,Gt=t;else{if(t===null)throw Error(H(310));Gt=t,t={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Jt===null?lt.memoizedState=Jt=t:Jt=Jt.next=t}return Jt}function kl(t,e){return typeof e=="function"?e(t):e}function Qg(t){var e=Lr(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=Gt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,c=null,l=s;do{var u=l.lane;if((Mo&u)===u)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var f={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=f,o=r):c=c.next=f,lt.lanes|=u,Ro|=u}l=l.next}while(l!==null&&l!==s);c===null?o=r:c.next=a,ui(r,e.memoizedState)||(Gn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,lt.lanes|=s,Ro|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Zg(t){var e=Lr(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);ui(s,e.memoizedState)||(Gn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Tx(){}function Sx(t,e){var n=lt,r=Lr(),i=e(),s=!ui(r.memoizedState,i);if(s&&(r.memoizedState=i,Gn=!0),r=r.queue,xy(xx.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Jt!==null&&Jt.memoizedState.tag&1){if(n.flags|=2048,Ul(9,wx.bind(null,n,r,i,e),void 0,null),Yt===null)throw Error(H(349));Mo&30||Cx(n,e,i)}return i}function Cx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function wx(t,e,n,r){e.value=n,e.getSnapshot=r,Px(e)&&Mx(t)}function xx(t,e,n){return n(function(){Px(e)&&Mx(t)})}function Px(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ui(t,n)}catch{return!0}}function Mx(t){var e=ns(t,1);e!==null&&ai(e,t,1,-1)}function yb(t){var e=Ei();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kl,lastRenderedState:t},e.queue=t,t=t.dispatch=uO.bind(null,lt,t),[e.memoizedState,t]}function Ul(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=lt.updateQueue,e===null?(e={lastEffect:null,stores:null},lt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Rx(){return Lr().memoizedState}function qf(t,e,n,r){var i=Ei();lt.flags|=t,i.memoizedState=Ul(1|e,n,void 0,r===void 0?null:r)}function Nd(t,e,n,r){var i=Lr();r=r===void 0?null:r;var s=void 0;if(Gt!==null){var o=Gt.memoizedState;if(s=o.destroy,r!==null&&Sy(r,o.deps)){i.memoizedState=Ul(e,n,s,r);return}}lt.flags|=t,i.memoizedState=Ul(1|e,n,s,r)}function _b(t,e){return qf(8390656,8,t,e)}function xy(t,e){return Nd(2048,8,t,e)}function Ix(t,e){return Nd(4,2,t,e)}function Lx(t,e){return Nd(4,4,t,e)}function Bx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ox(t,e,n){return n=n!=null?n.concat([t]):null,Nd(4,4,Bx.bind(null,e,t),n)}function Py(){}function Fx(t,e){var n=Lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Dx(t,e){var n=Lr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Sy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Nx(t,e,n){return Mo&21?(ui(n,e)||(n=Gw(),lt.lanes|=n,Ro|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Gn=!0),t.memoizedState=n)}function cO(t,e){var n=Ue;Ue=n!==0&&4>n?n:4,t(!0);var r=qg.transition;qg.transition={};try{t(!1),e()}finally{Ue=n,qg.transition=r}}function kx(){return Lr().memoizedState}function lO(t,e,n){var r=Us(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ux(t))Gx(e,n);else if(n=mx(t,e,n,r),n!==null){var i=Pn();ai(n,t,r,i),zx(n,e,r)}}function uO(t,e,n){var r=Us(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ux(t))Gx(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ui(a,o)){var c=e.interleaved;c===null?(i.next=i,_y(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=mx(t,e,i,r),n!==null&&(i=Pn(),ai(n,t,r,i),zx(n,e,r))}}function Ux(t){var e=t.alternate;return t===lt||e!==null&&e===lt}function Gx(t,e){hl=Uh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zx(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sy(t,n)}}var Gh={readContext:Ir,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useInsertionEffect:hn,useLayoutEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useMutableSource:hn,useSyncExternalStore:hn,useId:hn,unstable_isNewReconciler:!1},fO={readContext:Ir,useCallback:function(t,e){return Ei().memoizedState=[t,e===void 0?null:e],t},useContext:Ir,useEffect:_b,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,qf(4194308,4,Bx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return qf(4194308,4,t,e)},useInsertionEffect:function(t,e){return qf(4,2,t,e)},useMemo:function(t,e){var n=Ei();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ei();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=lO.bind(null,lt,t),[r.memoizedState,t]},useRef:function(t){var e=Ei();return t={current:t},e.memoizedState=t},useState:yb,useDebugValue:Py,useDeferredValue:function(t){return Ei().memoizedState=t},useTransition:function(){var t=yb(!1),e=t[0];return t=cO.bind(null,t[1]),Ei().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=lt,i=Ei();if(rt){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),Yt===null)throw Error(H(349));Mo&30||Cx(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,_b(xx.bind(null,r,s,t),[t]),r.flags|=2048,Ul(9,wx.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ei(),e=Yt.identifierPrefix;if(rt){var n=Ji,r=Xi;n=(r&~(1<<32-oi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Nl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=aO++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},hO={readContext:Ir,useCallback:Fx,useContext:Ir,useEffect:xy,useImperativeHandle:Ox,useInsertionEffect:Ix,useLayoutEffect:Lx,useMemo:Dx,useReducer:Qg,useRef:Rx,useState:function(){return Qg(kl)},useDebugValue:Py,useDeferredValue:function(t){var e=Lr();return Nx(e,Gt.memoizedState,t)},useTransition:function(){var t=Qg(kl)[0],e=Lr().memoizedState;return[t,e]},useMutableSource:Tx,useSyncExternalStore:Sx,useId:kx,unstable_isNewReconciler:!1},dO={readContext:Ir,useCallback:Fx,useContext:Ir,useEffect:xy,useImperativeHandle:Ox,useInsertionEffect:Ix,useLayoutEffect:Lx,useMemo:Dx,useReducer:Zg,useRef:Rx,useState:function(){return Zg(kl)},useDebugValue:Py,useDeferredValue:function(t){var e=Lr();return Gt===null?e.memoizedState=t:Nx(e,Gt.memoizedState,t)},useTransition:function(){var t=Zg(kl)[0],e=Lr().memoizedState;return[t,e]},useMutableSource:Tx,useSyncExternalStore:Sx,useId:kx,unstable_isNewReconciler:!1};function ic(t,e){try{var n="",r=e;do n+=zL(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function ep(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function o0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var gO=typeof WeakMap=="function"?WeakMap:Map;function Hx(t,e,n){n=qi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Hh||(Hh=!0,m0=r),o0(t,e)},n}function jx(t,e,n){n=qi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){o0(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){o0(t,e),typeof r!="function"&&(ks===null?ks=new Set([this]):ks.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function bb(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new gO;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=PO.bind(null,t,e,n),e.then(t,t))}function Ab(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Eb(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qi(-1,1),e.tag=2,Ns(n,e,1))),n.lanes|=1),t)}var pO=cs.ReactCurrentOwner,Gn=!1;function Cn(t,e,n,r){e.child=t===null?Ax(e,null,n,r):nc(e,t.child,n,r)}function Tb(t,e,n,r,i){n=n.render;var s=e.ref;return Va(e,i),r=Cy(t,e,n,r,s,i),n=wy(),t!==null&&!Gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rs(t,e,i)):(rt&&n&&dy(e),e.flags|=1,Cn(t,e,r,i),e.child)}function Sb(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Dy(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Vx(t,e,s,r,i)):(t=th(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Il,n(o,r)&&t.ref===e.ref)return rs(t,e,i)}return e.flags|=1,t=Gs(s,r),t.ref=e.ref,t.return=e,e.child=t}function Vx(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Il(s,r)&&t.ref===e.ref)if(Gn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Gn=!0);else return e.lanes=t.lanes,rs(t,e,i)}return a0(t,e,n,r,i)}function Wx(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(Ma,sr),sr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ye(Ma,sr),sr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ye(Ma,sr),sr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ye(Ma,sr),sr|=r;return Cn(t,e,i,n),e.child}function $x(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function a0(t,e,n,r,i){var s=Wn(n)?xo:_n.current;return s=ec(e,s),Va(e,i),n=Cy(t,e,n,r,s,i),r=wy(),t!==null&&!Gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,rs(t,e,i)):(rt&&r&&dy(e),e.flags|=1,Cn(t,e,n,i),e.child)}function Cb(t,e,n,r,i){if(Wn(n)){var s=!0;Lh(e)}else s=!1;if(Va(e,i),e.stateNode===null)Qf(t,e),_x(e,n,r),s0(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=n.contextType;typeof l=="object"&&l!==null?l=Ir(l):(l=Wn(n)?xo:_n.current,l=ec(e,l));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==l)&&mb(e,o,r,l),Ss=!1;var h=e.memoizedState;o.state=h,Nh(e,r,o,i),c=e.memoizedState,a!==r||h!==c||Vn.current||Ss?(typeof u=="function"&&(i0(e,n,u,r),c=e.memoizedState),(a=Ss||pb(e,n,a,r,h,c,l))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,vx(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:Jr(e.type,a),o.props=l,f=e.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Ir(c):(c=Wn(n)?xo:_n.current,c=ec(e,c));var d=n.getDerivedStateFromProps;(u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==c)&&mb(e,o,r,c),Ss=!1,h=e.memoizedState,o.state=h,Nh(e,r,o,i);var p=e.memoizedState;a!==f||h!==p||Vn.current||Ss?(typeof d=="function"&&(i0(e,n,d,r),p=e.memoizedState),(l=Ss||pb(e,n,l,r,h,p,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=c,r=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return c0(t,e,n,r,s,i)}function c0(t,e,n,r,i,s){$x(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&ub(e,n,!1),rs(t,e,s);r=e.stateNode,pO.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=nc(e,t.child,null,s),e.child=nc(e,null,a,s)):Cn(t,e,a,s),e.memoizedState=r.state,i&&ub(e,n,!0),e.child}function Xx(t){var e=t.stateNode;e.pendingContext?lb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&lb(t,e.context,!1),Ay(t,e.containerInfo)}function wb(t,e,n,r,i){return tc(),py(i),e.flags|=256,Cn(t,e,n,r),e.child}var l0={dehydrated:null,treeContext:null,retryLane:0};function u0(t){return{baseLanes:t,cachePool:null,transitions:null}}function Jx(t,e,n){var r=e.pendingProps,i=ot.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ye(ot,i&1),t===null)return n0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Gd(o,r,0,null),t=bo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=u0(n),e.memoizedState=l0,t):My(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return mO(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=Gs(i,c),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Gs(a,s):(s=bo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?u0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=l0,r}return s=t.child,t=s.sibling,r=Gs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function My(t,e){return e=Gd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $u(t,e,n,r){return r!==null&&py(r),nc(e,t.child,null,n),t=My(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mO(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=ep(Error(H(422))),$u(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Gd({mode:"visible",children:r.children},i,0,null),s=bo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&nc(e,t.child,null,o),e.child.memoizedState=u0(o),e.memoizedState=l0,s);if(!(e.mode&1))return $u(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(H(419)),r=ep(s,r,void 0),$u(t,e,o,r)}if(a=(o&t.childLanes)!==0,Gn||a){if(r=Yt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ns(t,i),ai(r,t,i,-1))}return Fy(),r=ep(Error(H(421))),$u(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=MO.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ar=Ds(i.nextSibling),lr=e,rt=!0,qr=null,t!==null&&(Tr[Sr++]=Xi,Tr[Sr++]=Ji,Tr[Sr++]=Po,Xi=t.id,Ji=t.overflow,Po=e),e=My(e,r.children),e.flags|=4096,e)}function xb(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),r0(t.return,e,n)}function tp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Kx(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Cn(t,e,r.children,n),r=ot.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&xb(t,n,e);else if(t.tag===19)xb(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ye(ot,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&kh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),tp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&kh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}tp(e,!0,n,null,s);break;case"together":tp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function rs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ro|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=Gs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Gs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function vO(t,e,n){switch(e.tag){case 3:Xx(e),tc();break;case 5:Ex(e);break;case 1:Wn(e.type)&&Lh(e);break;case 4:Ay(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ye(Fh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ye(ot,ot.current&1),e.flags|=128,null):n&e.child.childLanes?Jx(t,e,n):(Ye(ot,ot.current&1),t=rs(t,e,n),t!==null?t.sibling:null);Ye(ot,ot.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Kx(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ye(ot,ot.current),r)break;return null;case 22:case 23:return e.lanes=0,Wx(t,e,n)}return rs(t,e,n)}var Yx,f0,qx,Qx;Yx=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};f0=function(){};qx=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,go(Ri.current);var s=null;switch(n){case"input":i=Bm(t,i),r=Bm(t,r),s=[];break;case"select":i=ut({},i,{value:void 0}),r=ut({},r,{value:void 0}),s=[];break;case"textarea":i=Dm(t,i),r=Dm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Rh)}km(n,r);var o;n=null;for(l in i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Sl.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in r){var c=r[l];if(a=i!=null?i[l]:void 0,r.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(l,n)),n=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Sl.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&et("scroll",t),s||a===c||(s=[])):(s=s||[]).push(l,c))}n&&(s=s||[]).push("style",n);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};Qx=function(t,e,n,r){n!==r&&(e.flags|=4)};function Fc(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function dn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function yO(t,e,n){var r=e.pendingProps;switch(gy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(e),null;case 1:return Wn(e.type)&&Ih(),dn(e),null;case 3:return r=e.stateNode,rc(),tt(Vn),tt(_n),Ty(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Vu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qr!==null&&(_0(qr),qr=null))),f0(t,e),dn(e),null;case 5:Ey(e);var i=go(Dl.current);if(n=e.type,t!==null&&e.stateNode!=null)qx(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return dn(e),null}if(t=go(Ri.current),Vu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Si]=e,r[Ol]=s,t=(e.mode&1)!==0,n){case"dialog":et("cancel",r),et("close",r);break;case"iframe":case"object":case"embed":et("load",r);break;case"video":case"audio":for(i=0;i<nl.length;i++)et(nl[i],r);break;case"source":et("error",r);break;case"img":case"image":case"link":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"input":D1(r,s),et("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},et("invalid",r);break;case"textarea":k1(r,s),et("invalid",r)}km(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&ju(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&ju(r.textContent,a,t),i=["children",""+a]):Sl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&et("scroll",r)}switch(n){case"input":Fu(r),N1(r,s,!0);break;case"textarea":Fu(r),U1(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Rh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Cw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Si]=e,t[Ol]=r,Yx(t,e,!1,!1),e.stateNode=t;e:{switch(o=Um(n,r),n){case"dialog":et("cancel",t),et("close",t),i=r;break;case"iframe":case"object":case"embed":et("load",t),i=r;break;case"video":case"audio":for(i=0;i<nl.length;i++)et(nl[i],t);i=r;break;case"source":et("error",t),i=r;break;case"img":case"image":case"link":et("error",t),et("load",t),i=r;break;case"details":et("toggle",t),i=r;break;case"input":D1(t,r),i=Bm(t,r),et("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ut({},r,{value:void 0}),et("invalid",t);break;case"textarea":k1(t,r),i=Dm(t,r),et("invalid",t);break;default:i=r}km(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?Pw(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ww(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Cl(t,c):typeof c=="number"&&Cl(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Sl.hasOwnProperty(s)?c!=null&&s==="onScroll"&&et("scroll",t):c!=null&&Zv(t,s,c,o))}switch(n){case"input":Fu(t),N1(t,r,!1);break;case"textarea":Fu(t),U1(t);break;case"option":r.value!=null&&t.setAttribute("value",""+js(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ga(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ga(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Rh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dn(e),null;case 6:if(t&&e.stateNode!=null)Qx(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=go(Dl.current),go(Ri.current),Vu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Si]=e,(s=r.nodeValue!==n)&&(t=lr,t!==null))switch(t.tag){case 3:ju(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ju(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Si]=e,e.stateNode=r}return dn(e),null;case 13:if(tt(ot),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&ar!==null&&e.mode&1&&!(e.flags&128))px(),tc(),e.flags|=98560,s=!1;else if(s=Vu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(H(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(H(317));s[Si]=e}else tc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dn(e),s=!1}else qr!==null&&(_0(qr),qr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ot.current&1?zt===0&&(zt=3):Fy())),e.updateQueue!==null&&(e.flags|=4),dn(e),null);case 4:return rc(),f0(t,e),t===null&&Ll(e.stateNode.containerInfo),dn(e),null;case 10:return yy(e.type._context),dn(e),null;case 17:return Wn(e.type)&&Ih(),dn(e),null;case 19:if(tt(ot),s=e.memoizedState,s===null)return dn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Fc(s,!1);else{if(zt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=kh(t),o!==null){for(e.flags|=128,Fc(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ye(ot,ot.current&1|2),e.child}t=t.sibling}s.tail!==null&&At()>sc&&(e.flags|=128,r=!0,Fc(s,!1),e.lanes=4194304)}else{if(!r)if(t=kh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Fc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!rt)return dn(e),null}else 2*At()-s.renderingStartTime>sc&&n!==1073741824&&(e.flags|=128,r=!0,Fc(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=At(),e.sibling=null,n=ot.current,Ye(ot,r?n&1|2:n&1),e):(dn(e),null);case 22:case 23:return Oy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sr&1073741824&&(dn(e),e.subtreeFlags&6&&(e.flags|=8192)):dn(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function _O(t,e){switch(gy(e),e.tag){case 1:return Wn(e.type)&&Ih(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return rc(),tt(Vn),tt(_n),Ty(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ey(e),null;case 13:if(tt(ot),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));tc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return tt(ot),null;case 4:return rc(),null;case 10:return yy(e.type._context),null;case 22:case 23:return Oy(),null;case 24:return null;default:return null}}var Xu=!1,vn=!1,bO=typeof WeakSet=="function"?WeakSet:Set,K=null;function Pa(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){_t(t,e,r)}else n.current=null}function h0(t,e,n){try{n()}catch(r){_t(t,e,r)}}var Pb=!1;function AO(t,e){if(Km=xh,t=nx(),hy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,l=0,u=0,f=t,h=null;t:for(;;){for(var d;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(c=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===t)break t;if(h===n&&++l===i&&(a=o),h===s&&++u===r&&(c=o),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ym={focusedElem:t,selectionRange:n},xh=!1,K=e;K!==null;)if(e=K,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,K=t;else for(;K!==null;){e=K;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,b=p.memoizedState,v=e.stateNode,m=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:Jr(e.type,y),b);v.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(A){_t(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,K=t;break}K=e.return}return p=Pb,Pb=!1,p}function dl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&h0(e,n,s)}i=i.next}while(i!==r)}}function kd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function d0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Zx(t){var e=t.alternate;e!==null&&(t.alternate=null,Zx(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Si],delete e[Ol],delete e[Zm],delete e[rO],delete e[iO])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function eP(t){return t.tag===5||t.tag===3||t.tag===4}function Mb(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||eP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function g0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Rh));else if(r!==4&&(t=t.child,t!==null))for(g0(t,e,n),t=t.sibling;t!==null;)g0(t,e,n),t=t.sibling}function p0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(p0(t,e,n),t=t.sibling;t!==null;)p0(t,e,n),t=t.sibling}var tn=null,Kr=!1;function gs(t,e,n){for(n=n.child;n!==null;)tP(t,e,n),n=n.sibling}function tP(t,e,n){if(Mi&&typeof Mi.onCommitFiberUnmount=="function")try{Mi.onCommitFiberUnmount(Rd,n)}catch{}switch(n.tag){case 5:vn||Pa(n,e);case 6:var r=tn,i=Kr;tn=null,gs(t,e,n),tn=r,Kr=i,tn!==null&&(Kr?(t=tn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):tn.removeChild(n.stateNode));break;case 18:tn!==null&&(Kr?(t=tn,n=n.stateNode,t.nodeType===8?Jg(t.parentNode,n):t.nodeType===1&&Jg(t,n),Ml(t)):Jg(tn,n.stateNode));break;case 4:r=tn,i=Kr,tn=n.stateNode.containerInfo,Kr=!0,gs(t,e,n),tn=r,Kr=i;break;case 0:case 11:case 14:case 15:if(!vn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&h0(n,e,o),i=i.next}while(i!==r)}gs(t,e,n);break;case 1:if(!vn&&(Pa(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){_t(n,e,a)}gs(t,e,n);break;case 21:gs(t,e,n);break;case 22:n.mode&1?(vn=(r=vn)||n.memoizedState!==null,gs(t,e,n),vn=r):gs(t,e,n);break;default:gs(t,e,n)}}function Rb(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new bO),e.forEach(function(r){var i=RO.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Wr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:tn=a.stateNode,Kr=!1;break e;case 3:tn=a.stateNode.containerInfo,Kr=!0;break e;case 4:tn=a.stateNode.containerInfo,Kr=!0;break e}a=a.return}if(tn===null)throw Error(H(160));tP(s,o,i),tn=null,Kr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){_t(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)nP(e,t),e=e.sibling}function nP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Wr(e,t),vi(t),r&4){try{dl(3,t,t.return),kd(3,t)}catch(y){_t(t,t.return,y)}try{dl(5,t,t.return)}catch(y){_t(t,t.return,y)}}break;case 1:Wr(e,t),vi(t),r&512&&n!==null&&Pa(n,n.return);break;case 5:if(Wr(e,t),vi(t),r&512&&n!==null&&Pa(n,n.return),t.flags&32){var i=t.stateNode;try{Cl(i,"")}catch(y){_t(t,t.return,y)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Tw(i,s),Um(a,o);var l=Um(a,s);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?Pw(i,f):u==="dangerouslySetInnerHTML"?ww(i,f):u==="children"?Cl(i,f):Zv(i,u,f,l)}switch(a){case"input":Om(i,s);break;case"textarea":Sw(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Ga(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ga(i,!!s.multiple,s.defaultValue,!0):Ga(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ol]=s}catch(y){_t(t,t.return,y)}}break;case 6:if(Wr(e,t),vi(t),r&4){if(t.stateNode===null)throw Error(H(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(y){_t(t,t.return,y)}}break;case 3:if(Wr(e,t),vi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ml(e.containerInfo)}catch(y){_t(t,t.return,y)}break;case 4:Wr(e,t),vi(t);break;case 13:Wr(e,t),vi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ly=At())),r&4&&Rb(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(vn=(l=vn)||u,Wr(e,t),vn=l):Wr(e,t),vi(t),r&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!u&&t.mode&1)for(K=t,u=t.child;u!==null;){for(f=K=u;K!==null;){switch(h=K,d=h.child,h.tag){case 0:case 11:case 14:case 15:dl(4,h,h.return);break;case 1:Pa(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){_t(r,n,y)}}break;case 5:Pa(h,h.return);break;case 22:if(h.memoizedState!==null){Lb(f);continue}}d!==null?(d.return=h,K=d):Lb(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=xw("display",o))}catch(y){_t(t,t.return,y)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(y){_t(t,t.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Wr(e,t),vi(t),r&4&&Rb(t);break;case 21:break;default:Wr(e,t),vi(t)}}function vi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(eP(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Cl(i,""),r.flags&=-33);var s=Mb(t);p0(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=Mb(t);g0(t,a,o);break;default:throw Error(H(161))}}catch(c){_t(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EO(t,e,n){K=t,rP(t)}function rP(t,e,n){for(var r=(t.mode&1)!==0;K!==null;){var i=K,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Xu;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||vn;a=Xu;var l=vn;if(Xu=o,(vn=c)&&!l)for(K=i;K!==null;)o=K,c=o.child,o.tag===22&&o.memoizedState!==null?Bb(i):c!==null?(c.return=o,K=c):Bb(i);for(;s!==null;)K=s,rP(s),s=s.sibling;K=i,Xu=a,vn=l}Ib(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,K=s):Ib(t)}}function Ib(t){for(;K!==null;){var e=K;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vn||kd(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!vn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Jr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&gb(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}gb(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Ml(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}vn||e.flags&512&&d0(e)}catch(h){_t(e,e.return,h)}}if(e===t){K=null;break}if(n=e.sibling,n!==null){n.return=e.return,K=n;break}K=e.return}}function Lb(t){for(;K!==null;){var e=K;if(e===t){K=null;break}var n=e.sibling;if(n!==null){n.return=e.return,K=n;break}K=e.return}}function Bb(t){for(;K!==null;){var e=K;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{kd(4,e)}catch(c){_t(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){_t(e,i,c)}}var s=e.return;try{d0(e)}catch(c){_t(e,s,c)}break;case 5:var o=e.return;try{d0(e)}catch(c){_t(e,o,c)}}}catch(c){_t(e,e.return,c)}if(e===t){K=null;break}var a=e.sibling;if(a!==null){a.return=e.return,K=a;break}K=e.return}}var TO=Math.ceil,zh=cs.ReactCurrentDispatcher,Ry=cs.ReactCurrentOwner,Mr=cs.ReactCurrentBatchConfig,Re=0,Yt=null,Rt=null,nn=0,sr=0,Ma=Js(0),zt=0,Gl=null,Ro=0,Ud=0,Iy=0,gl=null,kn=null,Ly=0,sc=1/0,zi=null,Hh=!1,m0=null,ks=null,Ju=!1,Ps=null,jh=0,pl=0,v0=null,Zf=-1,eh=0;function Pn(){return Re&6?At():Zf!==-1?Zf:Zf=At()}function Us(t){return t.mode&1?Re&2&&nn!==0?nn&-nn:oO.transition!==null?(eh===0&&(eh=Gw()),eh):(t=Ue,t!==0||(t=window.event,t=t===void 0?16:Xw(t.type)),t):1}function ai(t,e,n,r){if(50<pl)throw pl=0,v0=null,Error(H(185));uu(t,n,r),(!(Re&2)||t!==Yt)&&(t===Yt&&(!(Re&2)&&(Ud|=n),zt===4&&ws(t,nn)),$n(t,r),n===1&&Re===0&&!(e.mode&1)&&(sc=At()+500,Fd&&Ks()))}function $n(t,e){var n=t.callbackNode;oB(t,e);var r=wh(t,t===Yt?nn:0);if(r===0)n!==null&&H1(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&H1(n),e===1)t.tag===0?sO(Ob.bind(null,t)):hx(Ob.bind(null,t)),tO(function(){!(Re&6)&&Ks()}),n=null;else{switch(zw(r)){case 1:n=iy;break;case 4:n=kw;break;case 16:n=Ch;break;case 536870912:n=Uw;break;default:n=Ch}n=fP(n,iP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function iP(t,e){if(Zf=-1,eh=0,Re&6)throw Error(H(327));var n=t.callbackNode;if(Wa()&&t.callbackNode!==n)return null;var r=wh(t,t===Yt?nn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Vh(t,r);else{e=r;var i=Re;Re|=2;var s=oP();(Yt!==t||nn!==e)&&(zi=null,sc=At()+500,_o(t,e));do try{wO();break}catch(a){sP(t,a)}while(1);vy(),zh.current=s,Re=i,Rt!==null?e=0:(Yt=null,nn=0,e=zt)}if(e!==0){if(e===2&&(i=Vm(t),i!==0&&(r=i,e=y0(t,i))),e===1)throw n=Gl,_o(t,0),ws(t,r),$n(t,At()),n;if(e===6)ws(t,r);else{if(i=t.current.alternate,!(r&30)&&!SO(i)&&(e=Vh(t,r),e===2&&(s=Vm(t),s!==0&&(r=s,e=y0(t,s))),e===1))throw n=Gl,_o(t,0),ws(t,r),$n(t,At()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:ao(t,kn,zi);break;case 3:if(ws(t,r),(r&130023424)===r&&(e=Ly+500-At(),10<e)){if(wh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Pn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Qm(ao.bind(null,t,kn,zi),e);break}ao(t,kn,zi);break;case 4:if(ws(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-oi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=At()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TO(r/1960))-r,10<r){t.timeoutHandle=Qm(ao.bind(null,t,kn,zi),r);break}ao(t,kn,zi);break;case 5:ao(t,kn,zi);break;default:throw Error(H(329))}}}return $n(t,At()),t.callbackNode===n?iP.bind(null,t):null}function y0(t,e){var n=gl;return t.current.memoizedState.isDehydrated&&(_o(t,e).flags|=256),t=Vh(t,e),t!==2&&(e=kn,kn=n,e!==null&&_0(e)),t}function _0(t){kn===null?kn=t:kn.push.apply(kn,t)}function SO(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ui(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ws(t,e){for(e&=~Iy,e&=~Ud,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oi(e),r=1<<n;t[n]=-1,e&=~r}}function Ob(t){if(Re&6)throw Error(H(327));Wa();var e=wh(t,0);if(!(e&1))return $n(t,At()),null;var n=Vh(t,e);if(t.tag!==0&&n===2){var r=Vm(t);r!==0&&(e=r,n=y0(t,r))}if(n===1)throw n=Gl,_o(t,0),ws(t,e),$n(t,At()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ao(t,kn,zi),$n(t,At()),null}function By(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(sc=At()+500,Fd&&Ks())}}function Io(t){Ps!==null&&Ps.tag===0&&!(Re&6)&&Wa();var e=Re;Re|=1;var n=Mr.transition,r=Ue;try{if(Mr.transition=null,Ue=1,t)return t()}finally{Ue=r,Mr.transition=n,Re=e,!(Re&6)&&Ks()}}function Oy(){sr=Ma.current,tt(Ma)}function _o(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,eO(n)),Rt!==null)for(n=Rt.return;n!==null;){var r=n;switch(gy(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ih();break;case 3:rc(),tt(Vn),tt(_n),Ty();break;case 5:Ey(r);break;case 4:rc();break;case 13:tt(ot);break;case 19:tt(ot);break;case 10:yy(r.type._context);break;case 22:case 23:Oy()}n=n.return}if(Yt=t,Rt=t=Gs(t.current,null),nn=sr=e,zt=0,Gl=null,Iy=Ud=Ro=0,kn=gl=null,ho!==null){for(e=0;e<ho.length;e++)if(n=ho[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ho=null}return t}function sP(t,e){do{var n=Rt;try{if(vy(),Yf.current=Gh,Uh){for(var r=lt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Uh=!1}if(Mo=0,Jt=Gt=lt=null,hl=!1,Nl=0,Ry.current=null,n===null||n.return===null){zt=1,Gl=e,Rt=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=nn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,u=a,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=Ab(o);if(d!==null){d.flags&=-257,Eb(d,o,a,s,e),d.mode&1&&bb(s,l,e),e=d,c=l;var p=e.updateQueue;if(p===null){var y=new Set;y.add(c),e.updateQueue=y}else p.add(c);break e}else{if(!(e&1)){bb(s,l,e),Fy();break e}c=Error(H(426))}}else if(rt&&a.mode&1){var b=Ab(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Eb(b,o,a,s,e),py(ic(c,a));break e}}s=c=ic(c,a),zt!==4&&(zt=2),gl===null?gl=[s]:gl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=Hx(s,c,e);db(s,v);break e;case 1:a=c;var m=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ks===null||!ks.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var A=jx(s,a,e);db(s,A);break e}}s=s.return}while(s!==null)}cP(n)}catch(S){e=S,Rt===n&&n!==null&&(Rt=n=n.return);continue}break}while(1)}function oP(){var t=zh.current;return zh.current=Gh,t===null?Gh:t}function Fy(){(zt===0||zt===3||zt===2)&&(zt=4),Yt===null||!(Ro&268435455)&&!(Ud&268435455)||ws(Yt,nn)}function Vh(t,e){var n=Re;Re|=2;var r=oP();(Yt!==t||nn!==e)&&(zi=null,_o(t,e));do try{CO();break}catch(i){sP(t,i)}while(1);if(vy(),Re=n,zh.current=r,Rt!==null)throw Error(H(261));return Yt=null,nn=0,zt}function CO(){for(;Rt!==null;)aP(Rt)}function wO(){for(;Rt!==null&&!qL();)aP(Rt)}function aP(t){var e=uP(t.alternate,t,sr);t.memoizedProps=t.pendingProps,e===null?cP(t):Rt=e,Ry.current=null}function cP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_O(n,e),n!==null){n.flags&=32767,Rt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{zt=6,Rt=null;return}}else if(n=yO(n,e,sr),n!==null){Rt=n;return}if(e=e.sibling,e!==null){Rt=e;return}Rt=e=t}while(e!==null);zt===0&&(zt=5)}function ao(t,e,n){var r=Ue,i=Mr.transition;try{Mr.transition=null,Ue=1,xO(t,e,n,r)}finally{Mr.transition=i,Ue=r}return null}function xO(t,e,n,r){do Wa();while(Ps!==null);if(Re&6)throw Error(H(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(aB(t,s),t===Yt&&(Rt=Yt=null,nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ju||(Ju=!0,fP(Ch,function(){return Wa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Mr.transition,Mr.transition=null;var o=Ue;Ue=1;var a=Re;Re|=4,Ry.current=null,AO(t,n),nP(n,t),XB(Ym),xh=!!Km,Ym=Km=null,t.current=n,EO(n),QL(),Re=a,Ue=o,Mr.transition=s}else t.current=n;if(Ju&&(Ju=!1,Ps=t,jh=i),s=t.pendingLanes,s===0&&(ks=null),tB(n.stateNode),$n(t,At()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hh)throw Hh=!1,t=m0,m0=null,t;return jh&1&&t.tag!==0&&Wa(),s=t.pendingLanes,s&1?t===v0?pl++:(pl=0,v0=t):pl=0,Ks(),null}function Wa(){if(Ps!==null){var t=zw(jh),e=Mr.transition,n=Ue;try{if(Mr.transition=null,Ue=16>t?16:t,Ps===null)var r=!1;else{if(t=Ps,Ps=null,jh=0,Re&6)throw Error(H(331));var i=Re;for(Re|=4,K=t.current;K!==null;){var s=K,o=s.child;if(K.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(K=l;K!==null;){var u=K;switch(u.tag){case 0:case 11:case 15:dl(8,u,s)}var f=u.child;if(f!==null)f.return=u,K=f;else for(;K!==null;){u=K;var h=u.sibling,d=u.return;if(Zx(u),u===l){K=null;break}if(h!==null){h.return=d,K=h;break}K=d}}}var p=s.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var b=y.sibling;y.sibling=null,y=b}while(y!==null)}}K=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,K=o;else e:for(;K!==null;){if(s=K,s.flags&2048)switch(s.tag){case 0:case 11:case 15:dl(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,K=v;break e}K=s.return}}var m=t.current;for(K=m;K!==null;){o=K;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,K=_;else e:for(o=m;K!==null;){if(a=K,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:kd(9,a)}}catch(S){_t(a,a.return,S)}if(a===o){K=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,K=A;break e}K=a.return}}if(Re=i,Ks(),Mi&&typeof Mi.onPostCommitFiberRoot=="function")try{Mi.onPostCommitFiberRoot(Rd,t)}catch{}r=!0}return r}finally{Ue=n,Mr.transition=e}}return!1}function Fb(t,e,n){e=ic(n,e),e=Hx(t,e,1),t=Ns(t,e,1),e=Pn(),t!==null&&(uu(t,1,e),$n(t,e))}function _t(t,e,n){if(t.tag===3)Fb(t,t,n);else for(;e!==null;){if(e.tag===3){Fb(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ks===null||!ks.has(r))){t=ic(n,t),t=jx(e,t,1),e=Ns(e,t,1),t=Pn(),e!==null&&(uu(e,1,t),$n(e,t));break}}e=e.return}}function PO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Pn(),t.pingedLanes|=t.suspendedLanes&n,Yt===t&&(nn&n)===n&&(zt===4||zt===3&&(nn&130023424)===nn&&500>At()-Ly?_o(t,0):Iy|=n),$n(t,e)}function lP(t,e){e===0&&(t.mode&1?(e=ku,ku<<=1,!(ku&130023424)&&(ku=4194304)):e=1);var n=Pn();t=ns(t,e),t!==null&&(uu(t,e,n),$n(t,n))}function MO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),lP(t,n)}function RO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),lP(t,n)}var uP;uP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vn.current)Gn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Gn=!1,vO(t,e,n);Gn=!!(t.flags&131072)}else Gn=!1,rt&&e.flags&1048576&&dx(e,Oh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Qf(t,e),t=e.pendingProps;var i=ec(e,_n.current);Va(e,n),i=Cy(null,e,r,t,i,n);var s=wy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wn(r)?(s=!0,Lh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,by(e),i.updater=Dd,e.stateNode=i,i._reactInternals=e,s0(e,r,t,n),e=c0(null,e,r,!0,s,n)):(e.tag=0,rt&&s&&dy(e),Cn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Qf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=LO(r),t=Jr(r,t),i){case 0:e=a0(null,e,r,t,n);break e;case 1:e=Cb(null,e,r,t,n);break e;case 11:e=Tb(null,e,r,t,n);break e;case 14:e=Sb(null,e,r,Jr(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jr(r,i),a0(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jr(r,i),Cb(t,e,r,i,n);case 3:e:{if(Xx(e),t===null)throw Error(H(387));r=e.pendingProps,s=e.memoizedState,i=s.element,vx(t,e),Nh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ic(Error(H(423)),e),e=wb(t,e,r,n,i);break e}else if(r!==i){i=ic(Error(H(424)),e),e=wb(t,e,r,n,i);break e}else for(ar=Ds(e.stateNode.containerInfo.firstChild),lr=e,rt=!0,qr=null,n=Ax(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(tc(),r===i){e=rs(t,e,n);break e}Cn(t,e,r,n)}e=e.child}return e;case 5:return Ex(e),t===null&&n0(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,qm(r,i)?o=null:s!==null&&qm(r,s)&&(e.flags|=32),$x(t,e),Cn(t,e,o,n),e.child;case 6:return t===null&&n0(e),null;case 13:return Jx(t,e,n);case 4:return Ay(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=nc(e,null,r,n):Cn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jr(r,i),Tb(t,e,r,i,n);case 7:return Cn(t,e,e.pendingProps,n),e.child;case 8:return Cn(t,e,e.pendingProps.children,n),e.child;case 12:return Cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ye(Fh,r._currentValue),r._currentValue=o,s!==null)if(ui(s.value,o)){if(s.children===i.children&&!Vn.current){e=rs(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(s.tag===1){c=qi(-1,n&-n),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?c.next=c:(c.next=u.next,u.next=c),l.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),r0(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(H(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),r0(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Cn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Va(e,n),i=Ir(i),r=r(i),e.flags|=1,Cn(t,e,r,n),e.child;case 14:return r=e.type,i=Jr(r,e.pendingProps),i=Jr(r.type,i),Sb(t,e,r,i,n);case 15:return Vx(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Jr(r,i),Qf(t,e),e.tag=1,Wn(r)?(t=!0,Lh(e)):t=!1,Va(e,n),_x(e,r,i),s0(e,r,i,n),c0(null,e,r,!0,t,n);case 19:return Kx(t,e,n);case 22:return Wx(t,e,n)}throw Error(H(156,e.tag))};function fP(t,e){return Nw(t,e)}function IO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cr(t,e,n,r){return new IO(t,e,n,r)}function Dy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function LO(t){if(typeof t=="function")return Dy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ty)return 11;if(t===ny)return 14}return 2}function Gs(t,e){var n=t.alternate;return n===null?(n=Cr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function th(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Dy(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case _a:return bo(n.children,i,s,e);case ey:o=8,i|=8;break;case Mm:return t=Cr(12,n,e,i|2),t.elementType=Mm,t.lanes=s,t;case Rm:return t=Cr(13,n,e,i),t.elementType=Rm,t.lanes=s,t;case Im:return t=Cr(19,n,e,i),t.elementType=Im,t.lanes=s,t;case bw:return Gd(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case yw:o=10;break e;case _w:o=9;break e;case ty:o=11;break e;case ny:o=14;break e;case Ts:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=Cr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function bo(t,e,n,r){return t=Cr(7,t,r,e),t.lanes=n,t}function Gd(t,e,n,r){return t=Cr(22,t,r,e),t.elementType=bw,t.lanes=n,t.stateNode={isHidden:!1},t}function np(t,e,n){return t=Cr(6,t,null,e),t.lanes=n,t}function rp(t,e,n){return e=Cr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function BO(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ng(0),this.expirationTimes=Ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ng(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ny(t,e,n,r,i,s,o,a,c){return t=new BO(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Cr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},by(s),t}function OO(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ya,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function hP(t){if(!t)return Vs;t=t._reactInternals;e:{if(Go(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Wn(n))return fx(t,n,e)}return e}function dP(t,e,n,r,i,s,o,a,c){return t=Ny(n,r,!0,t,i,s,o,a,c),t.context=hP(null),n=t.current,r=Pn(),i=Us(n),s=qi(r,i),s.callback=e??null,Ns(n,s,i),t.current.lanes=i,uu(t,i,r),$n(t,r),t}function zd(t,e,n,r){var i=e.current,s=Pn(),o=Us(i);return n=hP(n),e.context===null?e.context=n:e.pendingContext=n,e=qi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ns(i,e,o),t!==null&&(ai(t,i,o,s),Kf(t,i,o)),o}function Wh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Db(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ky(t,e){Db(t,e),(t=t.alternate)&&Db(t,e)}function FO(){return null}var gP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Uy(t){this._internalRoot=t}Hd.prototype.render=Uy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));zd(t,e,null,null)};Hd.prototype.unmount=Uy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Io(function(){zd(null,t,null,null)}),e[ts]=null}};function Hd(t){this._internalRoot=t}Hd.prototype.unstable_scheduleHydration=function(t){if(t){var e=Vw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Cs.length&&e!==0&&e<Cs[n].priority;n++);Cs.splice(n,0,t),n===0&&$w(t)}};function Gy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function jd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Nb(){}function DO(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var l=Wh(o);s.call(l)}}var o=dP(e,r,t,0,null,!1,!1,"",Nb);return t._reactRootContainer=o,t[ts]=o.current,Ll(t.nodeType===8?t.parentNode:t),Io(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var l=Wh(c);a.call(l)}}var c=Ny(t,0,!1,null,null,!1,!1,"",Nb);return t._reactRootContainer=c,t[ts]=c.current,Ll(t.nodeType===8?t.parentNode:t),Io(function(){zd(e,c,n,r)}),c}function Vd(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=Wh(o);a.call(c)}}zd(e,o,t,i)}else o=DO(n,e,t,i,r);return Wh(o)}Hw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=tl(e.pendingLanes);n!==0&&(sy(e,n|1),$n(e,At()),!(Re&6)&&(sc=At()+500,Ks()))}break;case 13:Io(function(){var r=ns(t,1);if(r!==null){var i=Pn();ai(r,t,1,i)}}),ky(t,1)}};oy=function(t){if(t.tag===13){var e=ns(t,134217728);if(e!==null){var n=Pn();ai(e,t,134217728,n)}ky(t,134217728)}};jw=function(t){if(t.tag===13){var e=Us(t),n=ns(t,e);if(n!==null){var r=Pn();ai(n,t,e,r)}ky(t,e)}};Vw=function(){return Ue};Ww=function(t,e){var n=Ue;try{return Ue=t,e()}finally{Ue=n}};zm=function(t,e,n){switch(e){case"input":if(Om(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Od(r);if(!i)throw Error(H(90));Ew(r),Om(r,i)}}}break;case"textarea":Sw(t,n);break;case"select":e=n.value,e!=null&&Ga(t,!!n.multiple,e,!1)}};Iw=By;Lw=Io;var NO={usingClientEntryPoint:!1,Events:[hu,Ta,Od,Mw,Rw,By]},Dc={findFiberByHostInstance:fo,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},kO={bundleType:Dc.bundleType,version:Dc.version,rendererPackageName:Dc.rendererPackageName,rendererConfig:Dc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fw(t),t===null?null:t.stateNode},findFiberByHostInstance:Dc.findFiberByHostInstance||FO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ku.isDisabled&&Ku.supportsFiber)try{Rd=Ku.inject(kO),Mi=Ku}catch{}}hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NO;hr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gy(e))throw Error(H(200));return OO(t,e,null,n)};hr.createRoot=function(t,e){if(!Gy(t))throw Error(H(299));var n=!1,r="",i=gP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Ny(t,1,!1,null,null,n,!1,r,i),t[ts]=e.current,Ll(t.nodeType===8?t.parentNode:t),new Uy(e)};hr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=Fw(e),t=t===null?null:t.stateNode,t};hr.flushSync=function(t){return Io(t)};hr.hydrate=function(t,e,n){if(!jd(e))throw Error(H(200));return Vd(null,t,e,!0,n)};hr.hydrateRoot=function(t,e,n){if(!Gy(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=gP;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=dP(e,null,t,1,n??null,i,!1,s,o),t[ts]=e.current,Ll(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Hd(e)};hr.render=function(t,e,n){if(!jd(e))throw Error(H(200));return Vd(null,t,e,!1,n)};hr.unmountComponentAtNode=function(t){if(!jd(t))throw Error(H(40));return t._reactRootContainer?(Io(function(){Vd(null,null,t,!1,function(){t._reactRootContainer=null,t[ts]=null})}),!0):!1};hr.unstable_batchedUpdates=By;hr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!jd(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return Vd(t,e,n,!1,r)};hr.version="18.2.0-next-9e3b772b8-20220608";function pP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pP)}catch(t){console.error(t)}}pP(),dw.exports=hr;var Tc=dw.exports;const UO=cu(Tc);var kb=Tc;xm.createRoot=kb.createRoot,xm.hydrateRoot=kb.hydrateRoot;function $e(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Wd=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Ub=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Ub&&parseFloat(Ub[1]);const GO="3.4.14";function Bi(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const ip={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},zO=ip.global||ip.self||ip.window||{},Qi=typeof process!="object"||String(process)!=="[object process]"||process.browser,zy=typeof importScripts=="function",HO=typeof window<"u"&&typeof window.orientation<"u",Gb=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Gb&&parseFloat(Gb[1]);function Bt(t){"@babel/helpers - typeof";return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(t)}function jO(t,e){if(Bt(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Bt(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mP(t){var e=jO(t,"string");return Bt(e)==="symbol"?e:String(e)}function g(t,e,n){return e=mP(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class VO{constructor(e,n){g(this,"name",void 0),g(this,"workerThread",void 0),g(this,"isRunning",!0),g(this,"result",void 0),g(this,"_resolve",()=>{}),g(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Bi(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Bi(this.isRunning),this.isRunning=!1,this._reject(e)}}let sp=class{terminate(){}};const op=new Map;function WO(t){Bi(t.source&&!t.url||!t.source&&t.url);let e=op.get(t.source||t.url);return e||(t.url&&(e=$O(t.url),op.set(t.url,e)),t.source&&(e=vP(t.source),op.set(t.source,e))),Bi(e),e}function $O(t){if(!t.startsWith("http"))return t;const e=XO(t);return vP(e)}function vP(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function XO(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function yP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(zb(t))r.add(t);else if(zb(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)yP(t[i],e,r)}}return n===void 0?Array.from(r):[]}function zb(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const ap=()=>{};class b0{static isSupported(){return typeof Worker<"u"&&Qi||typeof sp<"u"&&!Qi}constructor(e){g(this,"name",void 0),g(this,"source",void 0),g(this,"url",void 0),g(this,"terminated",!1),g(this,"worker",void 0),g(this,"onMessage",void 0),g(this,"onError",void 0),g(this,"_loadableURL","");const{name:n,source:r,url:i}=e;Bi(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=ap,this.onError=s=>console.log(s),this.worker=Qi?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ap,this.onError=ap,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||yP(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=WO({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new sp(r,{eval:!1})}else if(this.source)e=new sp(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class JO{static isSupported(){return b0.isSupported()}constructor(e){g(this,"name","unnamed"),g(this,"source",void 0),g(this,"url",void 0),g(this,"maxConcurrency",1),g(this,"maxMobileConcurrency",1),g(this,"onDebug",()=>{}),g(this,"reuseWorkers",!0),g(this,"props",{}),g(this,"jobQueue",[]),g(this,"idleQueue",[]),g(this,"count",0),g(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,o,a)=>s.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,o)=>s.error(o);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new VO(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new b0({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return HO?this.maxMobileConcurrency:this.maxConcurrency}}const KO={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Wi{static isSupported(){return b0.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Wi._workerFarm=Wi._workerFarm||new Wi({}),Wi._workerFarm.setProps(e),Wi._workerFarm}constructor(e){g(this,"props",void 0),g(this,"workerPools",new Map),this.props={...KO},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new JO({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}g(Wi,"_workerFarm",void 0);const YO="latest";function qO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=YO);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return Bi(i),i}function QO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:GO;Bi(t,"no worker provided");const n=t.version;return!(!e||!n)}const ZO=null,e3=null,A0=null,_P=null,t3=Object.freeze(Object.defineProperty({__proto__:null,readFileAsArrayBuffer:ZO,readFileAsText:e3,requireFromFile:A0,requireFromString:_P},Symbol.toStringTag,{value:"Module"})),n3="3.4.14",cp={};async function Ao(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e&&(t=r3(t,e,n)),cp[t]=cp[t]||i3(t),await cp[t]}function r3(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:Qi?n.CDN?(Bi(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(n3,"/dist/libs/").concat(t)):zy?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}async function i3(t){if(t.endsWith("wasm"))return await(await fetch(t)).arrayBuffer();if(!Qi)try{return t3&&A0&&await A0(t)}catch{return null}if(zy)return importScripts(t);const n=await(await fetch(t)).text();return s3(n,t)}function s3(t,e){if(!Qi)return _P;if(zy)return eval.call(zO,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}function o3(t,e){return!Wi.isSupported()||!Qi&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function a3(t,e,n,r,i){const s=t.id,o=qO(t,n),c=Wi.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const l=await c.startJob("process-on-worker",c3.bind(null,i));return l.postMessage("process",{input:e,options:n,context:r}),await(await l.result).result}async function c3(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const c=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function l3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Hb(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Hb(t,0,e):""}function Hb(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}function u3(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(l3(t),'"'))}}function f3(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function h3(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),i=r.reduce((a,c)=>a+c.byteLength,0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}function Hy(t,e,n){const r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function gu(t,e){return $e(t>=0),$e(e>0),t+(e-1)&~(e-1)}function d3(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const i=t.byteOffset,s=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,i,s)}return e.set(r,n),n+gu(r.byteLength,4)}async function g3(t){const e=[];for await(const n of t)e.push(n);return h3(...e)}function jb(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let Vb=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=jb(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(jb()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},p3=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof Vb?i=e:i=new Vb(n,r),this.stats[n]=i),i}};const m3="Queued Requests",v3="Active Requests",y3="Cancelled Requests",_3="Queued Requests Ever",b3="Active Requests Ever",A3={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class E3{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g(this,"props",void 0),g(this,"stats",void 0),g(this,"activeRequestCount",0),g(this,"requestQueue",[]),g(this,"requestMap",new Map),g(this,"deferredUpdate",null),this.props={...A3,...e},this.stats=new p3({id:this.props.id}),this.stats.get(m3),this.stats.get(v3),this.stats.get(y3),this.stats.get(_3),this.stats.get(b3)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let T3="";const Wb={};function S3(t){for(const e in Wb)if(t.startsWith(e)){const n=Wb[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(T3).concat(t)),t}function C3(t){return t&&typeof t=="object"&&t.isBuffer}function bP(t){if(C3(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function AP(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function jy(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const w3=t=>typeof t=="boolean",ml=t=>typeof t=="function",pu=t=>t!==null&&typeof t=="object",$b=t=>pu(t)&&t.constructor==={}.constructor,x3=t=>t&&typeof t[Symbol.iterator]=="function",P3=t=>t&&typeof t[Symbol.asyncIterator]=="function",zo=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ho=t=>typeof Blob<"u"&&t instanceof Blob,M3=t=>t&&typeof t=="object"&&t.isBuffer,R3=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||pu(t)&&ml(t.tee)&&ml(t.cancel)&&ml(t.getReader),I3=t=>pu(t)&&ml(t.read)&&ml(t.pipe)&&w3(t.readable),EP=t=>R3(t)||I3(t),L3=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,B3=/^([-\w.]+\/[-\w.+]+)/;function O3(t){const e=B3.exec(t);return e?e[1]:t}function Xb(t){const e=L3.exec(t);return e?e[1]:""}const TP=/\?.*/;function F3(t){const e=t.match(TP);return e&&e[0]}function Vy(t){return t.replace(TP,"")}function $d(t){return zo(t)?t.url:Ho(t)?t.name||"":typeof t=="string"?t:""}function Wy(t){if(zo(t)){const e=t,n=e.headers.get("content-type")||"",r=Vy(e.url);return O3(n)||Xb(r)}return Ho(t)?t.type||"":typeof t=="string"?Xb(t):""}function D3(t){return zo(t)?t.headers["content-length"]||-1:Ho(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function SP(t){if(zo(t))return t;const e={},n=D3(t);n>=0&&(e["content-length"]=String(n));const r=$d(t),i=Wy(t);i&&(e["content-type"]=i);const s=await U3(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function N3(t){if(!t.ok){const e=await k3(t);throw new Error(e)}}async function k3(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function U3(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=G3(n);return"data:base64,".concat(r)}return null}function G3(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function Jb(t,e){if(typeof t=="string"){t=S3(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await SP(t)}function z3(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function mu(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||z3()}const Yu=globalThis.window||globalThis.self||globalThis.global,Nc=globalThis.process||{},CP=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";mu();function H3(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let j3=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=H3(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function V3(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function W3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function lp(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let $h;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})($h||($h={}));const $3=10;function Kb(t){return typeof t!="string"?t:(t=t.toUpperCase(),$h[t]||$h.WHITE)}function X3(t,e,n){if(!mu&&typeof t=="string"){if(e){const r=Kb(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=Kb(n);t="\x1B[".concat(r+$3,"m").concat(t,"\x1B[49m")}}return t}function J3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function Xh(t,e){if(!t)throw new Error(e||"Assertion failed")}function ea(){let t;if(mu()&&Yu.performance){var e,n;t=Yu==null||(e=Yu.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Nc){var r;const i=Nc==null||(r=Nc.hrtime)===null||r===void 0?void 0:r.call(Nc);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const ta={debug:mu()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},K3={enabled:!0,level:0};function Ar(){}const Yb={},qb={once:!0};let $y=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=CP,this._startTs=ea(),this._deltaTs=ea(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new j3("__probe-".concat(this.id,"__"),K3),this.timeStamp("".concat(this.id," started")),J3(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ea()-this._startTs).toPrecision(10))}getDelta(){return Number((ea()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Xh(e,n)}warn(e){return this._getLogFunction(0,e,ta.warn,arguments,qb)}error(e){return this._getLogFunction(0,e,ta.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,ta.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,ta.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,ta.debug||ta.info,arguments,qb)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Ar,r&&[r],{tag:Z3(n)}):Ar}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?mu()?Q3({image:i,message:s,scale:o}):q3():Ar}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ar)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=Qb({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ar)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=wP(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=Qb({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Xh(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=ea();const o=s.tag||s.message;if(s.once&&o)if(!Yb[o])Yb[o]=ea();else return Ar;return n=Y3(this.id,s.message,s),r.bind(console,n,...s.args)}return Ar}};$y.VERSION=CP;function wP(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Xh(Number.isFinite(e)&&e>=0),e}function Qb(t){const{logLevel:e,message:n}=t;t.logLevel=wP(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Xh(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function Y3(t,e,n){if(typeof e=="string"){const r=n.time?W3(V3(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=X3(e,n.color,n.background)}return e}function q3(t){return console.warn("removed"),Ar}function Q3(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=lp(s,n,r);console.log(...o)},s.src=e,Ar}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...lp(e,n,r)),Ar;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...lp(s,n,r)),s.src=e.toDataURL(),Ar}return Ar}function Z3(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Zb=new $y({id:"loaders.gl"});class eF{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class tF{constructor(){g(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const xP={fetch:null,mimeType:void 0,nothrow:!1,log:new tF,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Wd,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},nF={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function PP(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const MP=()=>{const t=PP();return t.globalOptions=t.globalOptions||{...xP},t.globalOptions};function rF(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],iF(t,n),oF(e,t,r)}function iF(t,e){eA(t,null,xP,nF,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};eA(r,n.id,i,s,e)}}function eA(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const c=!e&&pu(t[a]),l=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in n)&&!l&&!u){if(a in r)Zb.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!c){const f=sF(a,i);Zb.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(f))()}}}}function sF(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function oF(t,e,n){const i={...t.options||{}};return aF(i,n),i.log===null&&(i.log=new eF),tA(i,MP()),tA(i,e),i}function tA(t,e){for(const n in e)if(n in e){const r=e[n];$b(r)&&$b(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function aF(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function Xy(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function Jy(t){var e,n;$e(t,"null loader"),$e(Xy(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const RP=()=>{const t=PP();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function cF(t){const e=RP();t=Array.isArray(t)?t:[t];for(const n of t){const r=Jy(n);e.find(i=>r===i)||e.unshift(r)}}function lF(){return RP()}const uF=new $y({id:"loaders.gl"}),fF=/\.([^.]+)$/;async function hF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!IP(t))return null;let i=nA(t,e,{...n,nothrow:!0},r);if(i)return i;if(Ho(t)&&(t=await t.slice(0,10).arrayBuffer(),i=nA(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(LP(t));return i}function nA(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!IP(t))return null;if(e&&!Array.isArray(e))return Jy(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...lF()),gF(i);const s=dF(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(LP(t));return s}function dF(t,e,n,r){const i=$d(t),s=Wy(t),o=Vy(i)||(r==null?void 0:r.url);let a=null,c="";if(n!=null&&n.mimeType&&(a=up(e,n==null?void 0:n.mimeType),c="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||pF(e,o),c=c||(a?"matched url ".concat(o):""),a=a||up(e,s),c=c||(a?"matched MIME type ".concat(s):""),a=a||vF(e,t),c=c||(a?"matched initial data ".concat(BP(t)):""),a=a||up(e,n==null?void 0:n.fallbackMimeType),c=c||(a?"matched fallback MIME type ".concat(s):""),c){var l;uF.log(1,"selectLoader selected ".concat((l=a)===null||l===void 0?void 0:l.name,": ").concat(c,"."))}return a}function IP(t){return!(t instanceof Response&&t.status===204)}function LP(t){const e=$d(t),n=Wy(t);let r="No valid loader found (";r+=e?"".concat(AP(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?BP(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function gF(t){for(const e of t)Jy(e)}function pF(t,e){const n=e&&fF.exec(e),r=n&&n[1];return r?mF(t,r):null}function mF(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function up(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function vF(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(yF(e,n))return n}else if(ArrayBuffer.isView(e)){if(rA(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&rA(e,0,n))return n;return null}function yF(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function rA(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>_F(t,e,n,i))}function _F(t,e,n,r){if(r instanceof ArrayBuffer)return f3(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=E0(t,e,r.length);return r===i;default:return!1}}function BP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?E0(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?E0(t,0,e):""}function E0(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const bF=256*1024;function*AF(t,e){const n=(e==null?void 0:e.chunkSize)||bF;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const EF=256*1024;function TF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=EF}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}()}const SF=1024*1024;async function*CF(t,e){const n=(e==null?void 0:e.chunkSize)||SF;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function iA(t,e){return Wd?wF(t,e):xF(t)}async function*wF(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield bP(o)}}catch{n.releaseLock()}}async function*xF(t,e){for await(const n of t)yield bP(n)}function PF(t,e){if(typeof t=="string")return AF(t,e);if(t instanceof ArrayBuffer)return TF(t,e);if(Ho(t))return CF(t,e);if(EP(t))return iA(t,e);if(zo(t))return iA(t.body,e);throw new Error("makeIterator")}const OP="Cannot convert supplied data type";function MF(t,e,n){if(e.text&&typeof t=="string")return t;if(M3(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(OP)}async function RF(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return MF(t,e);if(Ho(t)&&(t=await SP(t)),zo(t)){const i=t;return await N3(i),e.binary?await i.arrayBuffer():await i.text()}if(EP(t)&&(t=PF(t,n)),x3(t)||P3(t))return g3(t);throw new Error(OP)}function FP(t,e){const n=MP(),r=t||n;return typeof r.fetch=="function"?r.fetch:pu(r.fetch)?i=>Jb(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:Jb}function IF(t,e,n){if(n)return n;const r={fetch:FP(e,t),...t};if(r.url){const i=Vy(r.url);r.baseUrl=i,r.queryString=F3(r.url),r.filename=AP(i),r.baseUrl=jy(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function LF(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function Ky(t,e,n,r){Bi(!r||typeof r=="object"),e&&!Array.isArray(e)&&!Xy(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=$d(t),o=LF(e,r),a=await hF(t,o,n);return a?(n=rF(n,a,o,i),r=IF({url:i,parse:Ky,loaders:o},n,r||null),await BF(a,t,n,r)):null}async function BF(t,e,n,r){if(QO(t),zo(e)){const i=e,{ok:s,redirected:o,status:a,statusText:c,type:l,url:u}=i,f=Object.fromEntries(i.headers.entries());r.response={headers:f,ok:s,redirected:o,status:a,statusText:c,type:l,url:u}}if(e=await RF(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(o3(t,n))return await a3(t,e,n,r,Ky);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw Bi(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function is(t,e,n,r){!Array.isArray(e)&&!Xy(e)&&(n=e,e=void 0);const i=FP(n);let s=t;return typeof t=="string"&&(s=await i(t)),Ho(t)&&(s=await i(t)),await Ky(s,e,n)}const OF="3.4.14",{_parseImageNode:FF}=globalThis,T0=typeof Image<"u",S0=typeof ImageBitmap<"u",DF=!!FF,C0=Wd?!0:DF;function NF(t){switch(t){case"auto":return S0||T0||C0;case"imagebitmap":return S0;case"image":return T0;case"data":return C0;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function kF(){if(S0)return"imagebitmap";if(T0)return"image";if(C0)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function UF(t){const e=zF(t);if(!e)throw new Error("Not an image");return e}function GF(t){switch(UF(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function zF(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const HF=/^data:image\/svg\+xml/,jF=/\.svg((\?|#).*)?$/;function Yy(t){return t&&(HF.test(t)||jF.test(t))}function VF(t,e){if(Yy(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return DP(t,e)}function DP(t,e){if(Yy(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function NP(t,e,n){const r=VF(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await WF(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function WF(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const $F={};let sA=!0;async function XF(t,e,n){let r;Yy(n)?r=await NP(t,e,n):r=DP(t,n);const i=e&&e.imagebitmap;return await JF(r,i)}async function JF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((KF(e)||!sA)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),sA=!1}return await createImageBitmap(t)}function KF(t){for(const e in t||$F)return!1;return!0}function YF(t){return!eD(t,"ftyp",4)||!(t[8]&96)?null:qF(t)}function qF(t){switch(QF(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function QF(t,e,n){return String.fromCharCode(...t.slice(e,n))}function ZF(t){return[...t].map(e=>e.charCodeAt(0))}function eD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=ZF(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Ci=!1,vl=!0;function qy(t){const e=vu(t);return nD(e)||sD(e)||rD(e)||iD(e)||tD(e)}function tD(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=YF(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function nD(t){const e=vu(t);return e.byteLength>=24&&e.getUint32(0,Ci)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Ci),height:e.getUint32(20,Ci)}:null}function rD(t){const e=vu(t);return e.byteLength>=10&&e.getUint32(0,Ci)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,vl),height:e.getUint16(8,vl)}:null}function iD(t){const e=vu(t);return e.byteLength>=14&&e.getUint16(0,Ci)===16973&&e.getUint32(2,vl)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,vl),height:e.getUint32(22,vl)}:null}function sD(t){const e=vu(t);if(!(e.byteLength>=3&&e.getUint16(0,Ci)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=oD();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Ci);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Ci),width:e.getUint16(s+7,Ci)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,Ci)}return null}function oD(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function vu(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function aD(t,e){const{mimeType:n}=qy(t)||{},r=globalThis._parseImageNode;return $e(r),await r(t,n)}async function cD(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=lD(i);let a;switch(o){case"imagebitmap":a=await XF(t,e,s);break;case"image":a=await NP(t,e,s);break;case"data":a=await aD(t);break;default:$e(!1)}return i==="data"&&(a=GF(a)),a}function lD(t){switch(t){case"auto":case"data":return kF();default:return NF(t),t}}const uD=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],fD=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],hD={image:{type:"auto",decode:!0}},kP={id:"image",module:"images",name:"Images",version:OF,mimeTypes:fD,extensions:uD,parse:cD,tests:[t=>!!qy(new DataView(t))],options:hD},fp={};function dD(t){if(fp[t]===void 0){const e=Wd?pD(t):gD(t);fp[t]=e}return fp[t]}function gD(t){const e=["image/png","image/jpeg","image/gif"],{_parseImageNode:n,_imageFormatsNode:r=e}=globalThis;return!!n&&r.includes(t)}function pD(t){switch(t){case"image/avif":case"image/webp":return mD(t);default:return!0}}function mD(t){try{return document.createElement("canvas").toDataURL(t).indexOf("data:".concat(t))===0}catch{return!1}}function UP(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function ls(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||UP()}const nh={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},qu=nh.window||nh.self||nh.global,kc=nh.process||{},GP=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";ls();const hp=globalThis;function zP(t){if(!t&&!ls())return"Node";if(UP(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":hp.chrome?"Chrome":hp.safari?"Safari":hp.mozInnerScreenX?"Firefox":"Unknown"}function vD(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class yD{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";g(this,"storage",void 0),g(this,"id",void 0),g(this,"config",void 0),this.storage=vD(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function _D(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function bD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function dp(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Jh;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Jh||(Jh={}));function oA(t){return typeof t=="string"?Jh[t.toUpperCase()]||Jh.WHITE:t}function AD(t,e,n){return!ls&&typeof t=="string"&&(e&&(e=oA(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=oA(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function ED(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Kh(t,e){if(!t)throw new Error(e||"Assertion failed")}function na(){let t;if(ls&&"performance"in qu){var e,n;t=qu==null||(e=qu.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in kc){var r;const i=kc==null||(r=kc.hrtime)===null||r===void 0?void 0:r.call(kc);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const ra={debug:ls&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},TD={enabled:!0,level:0};function Er(){}const aA={},cA={once:!0};class Qy{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};g(this,"id",void 0),g(this,"VERSION",GP),g(this,"_startTs",na()),g(this,"_deltaTs",na()),g(this,"_storage",void 0),g(this,"userData",{}),g(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new yD("__probe-".concat(this.id,"__"),TD),this.timeStamp("".concat(this.id," started")),ED(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((na()-this._startTs).toPrecision(10))}getDelta(){return Number((na()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Kh(e,n)}warn(e){return this._getLogFunction(0,e,ra.warn,arguments,cA)}error(e){return this._getLogFunction(0,e,ra.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,ra.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,ra.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,ra.debug||ra.info,arguments,cA)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Er,r&&[r],{tag:xD(n)}):Er}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?ls?wD({image:i,message:s,scale:o}):CD():Er}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Er)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=lA({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Er)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=HP(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=lA({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Kh(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=na();const o=s.tag||s.message;if(s.once)if(!aA[o])aA[o]=na();else return Er;return n=SD(this.id,s.message,s),r.bind(console,n,...s.args)}return Er}}g(Qy,"VERSION",GP);function HP(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Kh(Number.isFinite(e)&&e>=0),e}function lA(t){const{logLevel:e,message:n}=t;t.logLevel=HP(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Kh(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function SD(t,e,n){if(typeof e=="string"){const r=n.time?bD(_D(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=AD(e,n.color,n.background)}return e}function CD(t){return console.warn("removed"),Er}function wD(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=dp(s,n,r);console.log(...o)},s.src=e,Er}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...dp(e,n,r)),Er;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...dp(s,n,r)),s.src=e.toDataURL(),Er}return Er}function xD(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const de=new Qy({id:"deck"});let w0={};function PD(t){w0=t}function pn(t,e,n,r){de.level>0&&w0[t]&&w0[t].call(null,e,n,r)}function MD(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const RD={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:MD,parseTextSync:JSON.parse};function ID(){const t="8.9.31",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(de.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:de,_registerLoggers:PD},cF([RD,[kP,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const LD=ID(),Te={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Te,"IDENTITY",{get:()=>(de.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const xi={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Ws={common:0,meters:1,pixels:2},uA={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Y=new Qy({id:"luma.gl"});function wn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const BD="Invalid WebGLRenderingContext",OD="Requires WebGL2";function Xd(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function _e(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function FD(t){return _e(t)?t:null}function Jd(t){return wn(Xd(t),BD),t}function yn(t){return wn(_e(t),OD),t}const rl={};function DD(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function ND(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function kD(t,e){rl[t]=!0,e!==void 0&&DD(e)}function UD(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(rl[r]=!0);while(r!==0);for(r in rl)if(rl[r])return delete rl[r],parseInt(r,10);return 0}}const yu=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};yu.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};yu.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const jo=function(e){const n=this;this.gl=e,UD(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const c=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return c.buffer;case 34338:return c.enabled;case 34339:return c.size;case 34340:return c.stride;case 34341:return c.type;case 34922:return c.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,c,l,u){const f=n.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const h=f.attribs[s];return h.buffer=n.currentArrayBuffer,h.size=o,h.type=a,h.normalized=c,h.stride=l,h.offset=u,h.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{ND("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};jo.prototype.VERTEX_ARRAY_BINDING_OES=34229;jo.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new yu(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};jo.prototype.createVertexArrayOES=function(){const e=new yu(this);return this.vertexArrayObjects.push(e),e};jo.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};jo.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof yu&&e.hasBeenBound&&e.ext===this)};jo.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){kD(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let c=0;c<=a;c++){const l=s.attribs[c],u=i?i.attribs[c]:null;if((!i||l.enabled!==u.enabled)&&(l.enabled?r.enableVertexAttribArray.call(n,c):r.disableVertexAttribArray.call(n,c)),l.enabled){let f=!1;(!i||l.buffer!==u.buffer)&&(o!==l.buffer&&(r.bindBuffer.call(n,34962,l.buffer),o=l.buffer),f=!0),(f||l.cached!==u.cached)&&r.vertexAttribPointer.call(n,c,l.size,l.type,l.normalized,l.stride,l.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function GD(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new jo(this)),this.__OESVertexArrayObject))}}const fA="OES_element_index",hA="WEBGL_draw_buffers",zD="EXT_disjoint_timer_query",HD="EXT_disjoint_timer_query_webgl2",jD="EXT_texture_filter_anisotropic",dA="WEBGL_debug_renderer_info",VD=35723,WD=4352,$D=36795,XD=34047,JD=37445,KD=37446,Ke=t=>_e(t)?void 0:0,YD={3074:t=>_e(t)?void 0:36064,[VD]:t=>_e(t)?void 0:WD,35977:Ke,32937:Ke,[$D]:(t,e)=>{const n=_e(t)?t.getExtension(HD):t.getExtension(zD);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[JD]:(t,e)=>{const n=t.getExtension(dA);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[KD]:(t,e)=>{const n=t.getExtension(dA);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[XD]:(t,e)=>{const n=t.luma.extensions[jD];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Ke,35071:Ke,37447:Ke,36063:(t,e)=>{if(!_e(t)){const n=t.getExtension(hA);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Ke,35374:Ke,35377:Ke,34852:t=>{if(!_e(t)){const e=t.getExtension(hA);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(fA)?2147483647:65535,33001:t=>t.getExtension(fA)?16777216:65535,33e3:t=>16777216,37157:Ke,35373:Ke,35657:Ke,36183:Ke,37137:Ke,34045:Ke,35978:Ke,35979:Ke,35968:Ke,35376:Ke,35375:Ke,35659:Ke,37154:Ke,35371:Ke,35658:Ke,35076:Ke,35077:Ke,35380:Ke};function qD(t,e,n){const r=YD[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const QD="OES_vertex_array_object",jP="ANGLE_instanced_arrays",ZD="WEBGL_draw_buffers",eN="EXT_disjoint_timer_query",tN="EXT_texture_filter_anisotropic",nN="VertexArray requires WebGL2 or OES_vertex_array_object extension";function rN(t,e){return{webgl2:_e(t),ext:t.getExtension(e)}}const VP={[QD]:{meta:{suffix:"OES"},createVertexArray:()=>{wn(!1,nN)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[jP]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){wn(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[ZD]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{wn(!1)}},[eN]:{meta:{suffix:"EXT"},createQuery:()=>{wn(!1)},deleteQuery:()=>{wn(!1)},beginQuery:()=>{wn(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},gp={readBuffer:(t,e,n)=>{_e(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=rN(t,jP);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!_e(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!_e(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[tN];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:qD,hint(t,e,n,r){return e(n,r)}};function iN(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(GD(t),sN(t),aN(t,VP),oN(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=iN;function sN(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function oN(t,e){let{target:n,target2:r}=e;Object.keys(gp).forEach(i=>{if(typeof gp[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=gp[i].bind(null,t,s);n[i]=o,r[i]=o}})}function aN(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&cN(t,{extension:n,target:t.luma,target2:t})}function cN(t,e){let{extension:n,target:r,target2:i}=e;const s=VP[n];wn(s);const{meta:o={}}=s,{suffix:a=""}=o,c=t.getExtension(n);for(const l of Object.keys(s)){const u="".concat(l).concat(a);let f=null;l==="meta"||typeof t[l]=="function"||(c&&typeof c[u]=="function"?f=function(){return c[u](...arguments)}:typeof s[l]=="function"&&(f=s[l].bind(r))),f&&(r[l]=f,i[l]=f)}}const Zy={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},ps=(t,e,n)=>e?t.enable(n):t.disable(n),gA=(t,e,n)=>t.hint(n,e),qn=(t,e,n)=>t.pixelStorei(n,e),lN=(t,e)=>{const n=_e(t)?36009:36160;return t.bindFramebuffer(n,e)},uN=(t,e)=>t.bindFramebuffer(36008,e);function Uc(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const fN={3042:ps,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:ps,2885:(t,e)=>t.cullFace(e),2929:ps,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:ps,35723:gA,36006:lN,2886:(t,e)=>t.frontFace(e),33170:gA,2849:(t,e)=>t.lineWidth(e),32823:ps,32824:"polygonOffset",10752:"polygonOffset",35977:ps,32938:"sampleCoverage",32939:"sampleCoverage",3089:ps,3088:(t,e)=>t.scissor(...e),2960:ps,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:qn,3317:qn,37440:qn,37441:qn,37443:qn,3330:qn,3332:qn,3331:qn,36010:uN,3314:qn,32878:qn,3316:qn,3315:qn,32877:qn,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Uc(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Uc(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Uc(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Uc(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Uc(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function vt(t,e,n){return e[t]!==void 0?e[t]:n[t]}const hN={blendEquation:(t,e,n)=>t.blendEquationSeparate(vt(32777,e,n),vt(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(vt(32969,e,n),vt(32968,e,n),vt(32971,e,n),vt(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(vt(32824,e,n),vt(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(vt(32938,e,n),vt(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,vt(2962,e,n),vt(2967,e,n),vt(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,vt(34816,e,n),vt(36003,e,n),vt(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,vt(2964,e,n),vt(2965,e,n),vt(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,vt(34817,e,n),vt(34818,e,n),vt(34819,e,n))},pA={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},yi=(t,e)=>t.isEnabled(e),mA={3042:yi,2884:yi,2929:yi,3024:yi,32823:yi,32926:yi,32928:yi,3089:yi,2960:yi,35977:yi};function WP(t){for(const e in t)return!1;return!0}function dN(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function vA(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function gN(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:c,oldValue:l}=n(t.state._updateCache,...o);return c&&r(...o),l},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function pN(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class mN{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?yN(e):Object.assign({},Zy),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){wn(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];ss(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){wn(s!==void 0);const o=e[s],a=this.cache[s];dN(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function $P(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(wn(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new mN(t,{copyState:r}),pN(t);for(const s in pA){const o=pA[s];gN(t,s,o)}vA(t,"getParameter"),vA(t,"isEnabled")}return t.state.enable=n,t}function vN(t){t.state||$P(t,{copyState:!1}),t.state.push()}function yA(t){wn(t.state),t.state.pop()}function ss(t,e){if(wn(Xd(t),"setParameters requires a WebGL context"),WP(e))return;const n={};for(const i in e){const s=Number(i),o=fN[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=hN[i];s(t,e,r)}}function yN(t,e){if(e=e||Zy,typeof e=="number"){const i=e,s=mA[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=mA[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function _N(t){ss(t,Zy)}function Xn(t,e,n){if(WP(e))return n(t);const{nocatch:r=!0}=e;vN(t),ss(t,e);let i;if(r)i=n(t),yA(t);else try{i=n(t)}finally{yA(t)}return i}function oc(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function pp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=oc(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return AN(e,r,i,s,n)}function bN(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function AN(t,e,n,r,i){const s=_A(t[0],e,n);let o=bA(t[1],e,r,i),a=_A(t[0]+1,e,n);const c=a===n-1?a:a-1;a=bA(t[1]+1,e,r,i);let l;return i?(a=a===0?a:a+1,l=o,o=a):l=a===r-1?a:a-1,{x:s,y:o,width:Math.max(c-s+1,1),height:Math.max(l-o+1,1)}}function _A(t,e,n){return Math.min(Math.round(t*e),n-1)}function bA(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const e_=ls(),EN=e_&&typeof document<"u",XP={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function JP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wn(e_,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},XP,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=wN({canvas:s,width:e,height:n,onError:r});return i=CN(o,t),i?(i=t_(i,t),xN(i),i):null}function t_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||PN(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},XP,e);const{manageState:n,debug:r}=e;return n&&$P(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Y.log(1,...s)()}}),e_&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Y.level=Math.max(Y.level,1)):Y.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function TN(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function SN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=bN(e.useDevicePixels);MN(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function CN(t,e){const{onError:n}=e;let r=null;const i=c=>r=c.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function wN(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(EN&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function xN(t){const e=_e(t)?"WebGL2":"WebGL1",n=TN(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";Y.info(1,"".concat(e).concat(i," context ").concat(r))()}function PN(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function MN(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(Y.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),c=Math.floor(i*o);t.canvas.width=a,t.canvas.height=c,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==c)&&(Y.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function AA(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let EA=class{constructor(e,n){g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",void 0),g(this,"count",void 0),g(this,"samples",void 0),g(this,"lastTiming",void 0),g(this,"lastSampleTime",void 0),g(this,"lastSampleCount",void 0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=AA(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(AA()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},n_=class{constructor(e){g(this,"id",void 0),g(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof EA?this.stats[n]=e:this.stats[n]=new EA(n,r)),this.stats[n]}};const yl="8.5.21",RN="set luma.log.level=1 (or higher) to trace rendering";class IN{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new n_({id:e})),this.stats.get(e)}}const po=new IN;if(globalThis.luma&&globalThis.luma.VERSION!==yl)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(yl));globalThis.luma||(ls()&&Y.log(1,"luma.gl ".concat(yl," - ").concat(RN))(),globalThis.luma=globalThis.luma||{VERSION:yl,version:yl,log:Y,stats:po,globals:{modules:{},nodeIO:{}}});function LN(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function BN(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function J(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function mp(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return J(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function zs(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const vp={};function os(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";vp[t]=vp[t]||1;const e=vp[t]++;return"".concat(t,"-").concat(e)}function TA(t){return J(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function ac(t){let e=!0;for(const n in t){e=!1;break}return e}function KP(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw Y.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const ia="Resource subclass must define virtual methods";let us=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Jd(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||os(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=mp(this.gl,e),J(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=_e(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,c="webgl2"in i?i.webgl2:i.webgl1;return s?c:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=_e(this.gl),o={},a=n||Object.keys(i);for(const c of a){const l=i[c];if(l&&(!("webgl2"in l)||s)&&(!("extension"in l)||this.gl.getExtension(l.extension))){const f=r?zs(this.gl,c):c;o[f]=this.getParameter(c,e),r&&l.type==="GLenum"&&(o[f]=zs(this.gl,o[f]))}}return o}setParameter(e,n){e=mp(this.gl,e),J(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=_e(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=mp(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return KP(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(ia)}_deleteHandle(){throw new Error(ia)}_bindHandle(e){throw new Error(ia)}_getOptsFromHandle(){throw new Error(ia)}_getParameter(e,n){throw new Error(ia)}_setParameter(e,n){throw new Error(ia)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=po.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];po.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=po.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=po.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const ON="Failed to deduce GL constant from typed array";function x0(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(ON)}}function zl(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function FN(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const c=a*o,l=(r-a-1)*o;s.set(e.subarray(c,c+o)),e.copyWithin(c,l,l+o),e.set(s,l)}}function DN(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let c=0;c<i;c++)for(let l=0;l<4;l++)o[(a*i+c)*4+l]=e[(a*2*n+c*2)*4+l];return{data:o,width:i,height:s}}function P0(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const l=r[a]?"".concat(t,".").concat(r[a]):"N/A";Y.removed("".concat(t,".").concat(a),l)()}for(const a in i)if(a in e){const c=i[a];Y.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))()}let o=null;for(const a in s)if(a in e){const c=s[a];Y.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))(),o=o||Object.assign({},e),o[c]=e[a],delete o[a]}return o||e}const NN={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},kN={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Un{static getBytesPerElement(e){return zl(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return J(e.size),zl(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Un(NN,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Un.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Un.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=P0("Accessor",e,kN),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const SA=10,YP={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},UN={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:YP},GN={removedProps:YP};class ke extends us{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Un.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Un.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=P0("Buffer",e,UN),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=P0("Buffer",e,GN),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Un(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;J(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(yn(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return yn(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};yn(this.gl);const s=zl(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let c,l;e?(l=e.length,c=l-a):(c=Math.min(o,i||o),l=a+c);const u=Math.min(o,c);return i=i||u,J(i<=u),e=e||new s(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(J(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(SA,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;J(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,SA),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=x0(e);return J(s),this.setAccessor(new Un(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;J(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=zl(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Un(this.accessor,{type:x0(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Y.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Y.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Y.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Y.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Un(this.accessor,e),this}}const r_={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},qP={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},QP={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function zN(t,e){const n=r_[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=_e(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function HN(t,e){const n=r_[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const jN=[9729,9728],CA=globalThis.WebGLBuffer||function(){};class Lo extends us{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&zN(e,r),s=s&&(!i||HN(e,r))),s}constructor(e,n){const{id:r=os("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(m=>this.initialize(Object.assign({},e,{pixels:m,data:m}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:c={},pixelStore:l={},textureUnit:u=void 0}=e;n||(n=i);let{width:f,height:h,dataFormat:d,type:p,compressed:y=!1,mipmaps:b=!0}=e;const{depth:v=0}=e;return{width:f,height:h,compressed:y,dataFormat:d,type:p}=this._deduceParameters({format:s,type:p,dataFormat:d,compressed:y,data:n,width:f,height:h}),this.width=f,this.height=h,this.depth=v,this.format=s,this.type=p,this.dataFormat=d,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),b&&this._isNPOT()&&(Y.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),b=!1,this._updateForNPOT(c)),this.mipmaps=b,this.setImageData({data:n,width:f,height:h,depth:v,format:s,type:p,dataFormat:d,border:o,mipmaps:b,parameters:l,compressed:y}),b&&this.generateMipmap(),this.setParameters(c),a&&(this.data=n),r&&(this._video={video:n,parameters:c,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Y.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Xn(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:c={}}=e;let{data:l=null,type:u=this.type,width:f=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:p=!1}=e;l||(l=r),{type:u,dataFormat:d,compressed:p,width:f,height:h}=this._deduceParameters({format:s,type:u,dataFormat:d,compressed:p,data:l,width:f,height:h});const{gl:y}=this;y.bindTexture(this.target,this.handle);let b=null;({data:l,dataType:b}=this._getDataType({data:l,compressed:p}));let v,m=0;if(Xn(this.gl,c,()=>{switch(b){case"null":y.texImage2D(n,i,s,f,h,o,d,u,l);break;case"typed-array":y.texImage2D(n,i,s,f,h,o,d,u,l,a);break;case"buffer":v=yn(y),v.bindBuffer(35052,l.handle||l),v.texImage2D(n,i,s,f,h,o,d,u,a),v.bindBuffer(35052,null);break;case"browser-object":_e(y)?y.texImage2D(n,i,s,f,h,o,d,u,l):y.texImage2D(n,i,s,d,u,l);break;case"compressed":for(const[_,A]of l.entries())y.compressedTexImage2D(n,_,A.format,A.width,A.height,o,A.data),m+=A.levelSize;break;default:J(!1,"Unknown image data type")}}),b==="compressed")this._trackAllocatedMemory(m,"Texture");else if(l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const _=qP[this.dataFormat]||4,A=QP[this.type]||1;this._trackAllocatedMemory(this.width*this.height*_*A,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:c=this.height,level:l=0,format:u=this.format,type:f=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:p=0,border:y=this.border,parameters:b={}}=e;if({type:f,dataFormat:h,compressed:d,width:a,height:c}=this._deduceParameters({format:u,type:f,dataFormat:h,compressed:d,data:i,width:a,height:c}),J(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const v=i;i=v.data,a=v.shape[0],c=v.shape[1]}i instanceof ke&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Xn(this.gl,b,()=>{if(d)this.gl.compressedTexSubImage2D(n,l,s,o,a,c,u,i);else if(i===null)this.gl.texSubImage2D(n,l,s,o,a,c,h,f,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,l,s,o,a,c,h,f,i,p);else if(i instanceof CA){const v=yn(this.gl);v.bindBuffer(35052,i),v.texSubImage2D(n,l,s,o,a,c,h,f,p),v.bindBuffer(35052,null)}else _e(this.gl)?yn(this.gl).texSubImage2D(n,l,s,o,a,c,h,f,i):this.gl.texSubImage2D(n,l,s,o,h,f,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Y.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ke?{data:n.handle,dataType:"buffer"}:n instanceof CA?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:c}=e;const l=r_[n];return o=o||l&&l.dataFormat,a=a||l&&l.types[0],c=c||l&&l.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:c,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},J(i,"Could not deduced texture size"),J(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),J(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:J(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return _e(this.gl)||!this.width||!this.height?!1:!TA(this.width)||!TA(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:jN.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let VN="";function WN(t,e){return J(typeof t=="string"),t=VN+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class on extends Lo{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Lo.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Jd(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:WN(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const M0=[34069,34070,34071,34072,34073,34074];class ZP extends Lo{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Jd(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:c=5121}=e;const{gl:l}=this,u=i||s,f=await Promise.all(M0.map(h=>{const d=u[h];return Promise.all(Array.isArray(d)?d:[d])}));this.bind(),M0.forEach((h,d)=>{f[d].length>1&&this.opts.mipmaps!==!1&&Y.warn("".concat(this.id," has mipmap and multiple LODs."))(),f[d].forEach((p,y)=>{n&&r?l.texImage2D(h,y,a,n,r,o,a,c,p):l.texImage2D(h,y,a,a,c,p)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:c=6408,type:l=5121}=e,{gl:u}=this,f=s||o;return this.bind(),f instanceof Promise?f.then(h=>this.setImageDataForFace(Object.assign({},e,{face:n,data:h,pixels:h}))):this.width||this.height?u.texImage2D(n,0,c,r,i,a,c,l,f):u.texImage2D(n,0,c,c,l,f),this}}ZP.FACES=M0;class $N extends Lo{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return _e(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};yn(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:c,type:l=5121,offset:u=0,data:f,parameters:h={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Xn(this.gl,h,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,c,l,f),f instanceof ke&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,c,l,u))}),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const d=qP[this.dataFormat]||4,p=QP[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*d*p,"Texture")}return this.loaded=!0,this}}const no="EXT_color_buffer_float",wA={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:no,bpp:2},33327:{gl2:no,bpp:4},34842:{gl2:no,bpp:8},33326:{gl2:no,bpp:4},33328:{gl2:no,bpp:8},34836:{gl2:no,bpp:16},35898:{gl2:no,bpp:4}};function XN(t,e,n){const r=n[e];if(!r)return!1;const i=_e(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Ra extends us{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||XN(e,n,wA)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return J(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&_e(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*wA[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const JN=256,KN=1024,YN=16384,xA=6144,PA=6145,MA=6146,RA=34041,eM="clear: bad arguments";function i_(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=YN,n!==!0&&(s.clearColor=n)),r&&(o|=JN,r!==!0&&(s.clearDepth=r)),i&&(o|=KN,r!==!0&&(s.clearStencil=r)),J(o!==0,eM),Xn(t,s,()=>{t.clear(o)})}function qN(t){let{framebuffer:e=null,buffer:n=xA,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};yn(t),Xn(t,{framebuffer:e},()=>{switch(n){case xA:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case PA:t.clearBufferfv(PA,0,[i]);break;case MA:t.clearBufferiv(MA,0,[i]);break;case RA:const[s,o]=i;t.clearBufferfi(RA,0,s,o);break;default:J(!1,eM)}})}function QN(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return J(!1),0}}function Kd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:c,sourceType:l}=e;const{framebuffer:u,deleteFramebuffer:f}=tM(t);J(u);const{gl:h,handle:d,attachments:p}=u;a=a||u.width,c=c||u.height,s===36064&&d===null&&(s=1028),J(p[s]),l=l||p[s].type,o=ek(o,l,i,a,c),l=l||x0(o);const y=h.bindFramebuffer(36160,d);return h.readPixels(n,r,a,c,i,l,o),h.bindFramebuffer(36160,y||null),f&&u.delete(),o}function IA(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Kd(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=DN({data:r,width:i,height:s}));FN({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),c=a.createImageData(i,s);return c.data.set(r),a.putImageData(c,0,0),o.toDataURL()}function ZN(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:c,targetZ:l,width:u,height:f}=n;const{framebuffer:h,deleteFramebuffer:d}=tM(t);J(h);const{gl:p,handle:y}=h,b=typeof a<"u"||typeof c<"u"||typeof l<"u";a=a||0,c=c||0,l=l||0;const v=p.bindFramebuffer(36160,y);J(e);let m=null;if(e instanceof Lo&&(m=e,u=Number.isFinite(u)?u:m.width,f=Number.isFinite(f)?f:m.height,m.bind(0),e=m.target),!b)p.copyTexImage2D(e,s,o,r,i,u,f,0);else switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,s,a,c,r,i,u,f);break;case 35866:case 32879:yn(p).copyTexSubImage3D(e,s,a,c,l,r,i,u,f);break}return m&&m.unbind(),p.bindFramebuffer(36160,v||null),d&&h.delete(),m}function tM(t){return t instanceof Et?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:lk(t),deleteFramebuffer:!0}}function ek(t,e,n,r,i){if(t)return t;e=e||5121;const s=zl(e,{clamped:!1}),o=QN(n);return new s(r*i*o)}const We={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function tk(t){const e=new on(t,{format:6408,type:5126,dataFormat:6408}),n=new Et(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const nM={[We.WEBGL2]:[!1,!0],[We.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[We.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[We.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[We.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[We.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[We.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[We.FLOAT_BLEND]:["EXT_float_blend"],[We.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[We.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[We.TEXTURE_FLOAT]:["OES_texture_float",!0],[We.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[We.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[We.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[We.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[We.COLOR_ATTACHMENT_RGBA32F]:[tk,"EXT_color_buffer_float"],[We.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[We.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[We.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[We.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[We.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[We.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},nk=2;function s_(t,e){return o_(t,e)}function o_(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>rM(t,n))}function rk(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in nM)t.luma.caps[e]===void 0&&(t.luma.caps[e]=rM(t,e));return t.luma.caps}function rM(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=ik(t,e)),t.luma.caps[e]||Y.log(nk,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function ik(t,e){const n=nM[e];J(n,e);let r;const i=_e(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:J(!1);return r}const LA="Multiple render targets not supported";class Et extends us{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Et(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=yn(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=yn(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:c=!0,readBuffer:l=void 0,drawBuffers:u=void 0}=e;if(J(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const f in i){const h=i[f];(Array.isArray(h)?h[0]:h).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:u}),i&&c&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,c=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,c||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return J(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&Y.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){J(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),c=i[a];let l=c;if(!l)this._unattach(a);else if(l instanceof Ra)this._attachRenderbuffer({attachment:a,renderbuffer:l});else if(Array.isArray(c)){const[u,f=0,h=0]=c;l=u,this._attachTexture({attachment:a,texture:u,layer:f,level:h})}else this._attachTexture({attachment:a,texture:l,layer:0,level:0});r&&l&&l.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(ok(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&i_(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,c)=>{qN(this.gl,{drawBuffer:c,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return Y.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Y.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Y.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Y.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Y.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Y.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=yn(this.gl),c=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,c),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=zs(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?zs(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?zs(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(IA(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Y.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=IA(this,{targetMaxHeight:100});return Y.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new on(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new Ra(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new Ra(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&J(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof Ra?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:yn(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const c=sk(i);o.framebufferTexture2D(36160,n,c,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:J(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=FD(this.gl);n?n.readBuffer(e):J(e===36064||e===1029,LA),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=yn(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):J(e.length===1&&(e[0]===36064||e[0]===1029),LA)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=rk(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function sk(t){return t<34069?t+34069:t}function ok(t){return(Et.STATUS||{})[t]||"Framebuffer error ".concat(t)}const ak=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Et.ATTACHMENT_PARAMETERS=ak;function ck(t,e){J(t instanceof on||t instanceof ZP||t instanceof $N);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u}=t,f=Object.assign({width:i,height:s,format:o,type:a,dataFormat:c,border:l,mipmaps:u},e);return new n(r,f)}function lk(t,e){const{gl:n,width:r,height:i,id:s}=t;return new Et(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function rh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const uk=35632,fk=35633;function hk(t){switch(t){case uk:return"fragment";case fk:return"vertex";default:return"unknown type"}}function dk(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||rh(e)||"(unnamed)",c="".concat(hk(n)," shader ").concat(a);for(let u=0;u<i.length;u++){const f=i[u];if(f.length<=1)continue;const h=f.split(":"),d=h[0],p=parseInt(h[2],10);if(isNaN(p))throw new Error("GLSL compilation error in ".concat(c,": ").concat(t));d!=="WARNING"?s[p]=f:o[p]=f}const l=gk(e);return{shaderName:c,errors:BA(s,l),warnings:BA(o,l)}}function BA(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],c=parseInt(o[1],10)||0,l=s.substring(o.join(":").length+1).trim();n+=iM("^^^ ".concat(a,": ").concat(l,`

`),c)}}return n}function gk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),c=a.length;return iM(a,i-c)+n+s})}function iM(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function sM(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const pk="Shader: GLSL source code must be a JavaScript string";class Hl extends us{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return J(!1),"unknown"}}constructor(e,n){Jd(e),J(typeof n.source=="string",pk);const r=rh(n.source,null)||n.id||os("unnamed ".concat(Hl.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=rh(n,null);r&&(this.id=os(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Hl.getTypeName(this.shaderType),":").concat(this.id)}getName(){return rh(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=dk(r,this.source,this.shaderType,this.id);throw Y.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),Y.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class yp extends Hl{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class _p extends Hl{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const mk={5126:Ze.bind(null,"uniform1fv",Qn,1,gn),35664:Ze.bind(null,"uniform2fv",Qn,2,gn),35665:Ze.bind(null,"uniform3fv",Qn,3,gn),35666:Ze.bind(null,"uniform4fv",Qn,4,gn),5124:Ze.bind(null,"uniform1iv",ms,1,gn),35667:Ze.bind(null,"uniform2iv",ms,2,gn),35668:Ze.bind(null,"uniform3iv",ms,3,gn),35669:Ze.bind(null,"uniform4iv",ms,4,gn),35670:Ze.bind(null,"uniform1iv",ms,1,gn),35671:Ze.bind(null,"uniform2iv",ms,2,gn),35672:Ze.bind(null,"uniform3iv",ms,3,gn),35673:Ze.bind(null,"uniform4iv",ms,4,gn),35674:Ze.bind(null,"uniformMatrix2fv",Qn,4,Ni),35675:Ze.bind(null,"uniformMatrix3fv",Qn,9,Ni),35676:Ze.bind(null,"uniformMatrix4fv",Qn,16,Ni),35678:en,35680:en,5125:Ze.bind(null,"uniform1uiv",Qu,1,gn),36294:Ze.bind(null,"uniform2uiv",Qu,2,gn),36295:Ze.bind(null,"uniform3uiv",Qu,3,gn),36296:Ze.bind(null,"uniform4uiv",Qu,4,gn),35685:Ze.bind(null,"uniformMatrix2x3fv",Qn,6,Ni),35686:Ze.bind(null,"uniformMatrix2x4fv",Qn,8,Ni),35687:Ze.bind(null,"uniformMatrix3x2fv",Qn,6,Ni),35688:Ze.bind(null,"uniformMatrix3x4fv",Qn,12,Ni),35689:Ze.bind(null,"uniformMatrix4x2fv",Qn,8,Ni),35690:Ze.bind(null,"uniformMatrix4x3fv",Qn,12,Ni),35678:en,35680:en,35679:en,35682:en,36289:en,36292:en,36293:en,36298:en,36299:en,36300:en,36303:en,36306:en,36307:en,36308:en,36311:en},vk={},yk={},_k={},OA=[0];function a_(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(OA[0]=t,t=OA);const i=t.length;if(i%e&&Y.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function Qn(t,e){return a_(t,e,Float32Array,vk)}function ms(t,e){return a_(t,e,Int32Array,yk)}function Qu(t,e){return a_(t,e,Uint32Array,_k)}function FA(t,e,n){const r=mk[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function bk(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function Ak(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!Ek(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function Ek(t){return Array.isArray(t)||ArrayBuffer.isView(t)?Sk(t):isFinite(t)||t===!0||t===!1||t instanceof Lo||t instanceof Ra?!0:t instanceof Et?!!t.texture:!1}function Tk(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function Sk(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function en(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Ze(t,e,n,r){let i=null,s=null;return(o,a,c)=>{const l=e(c,n),u=l.length;let f=!1;if(i===null)i=new Float32Array(u),s=u,f=!0;else{J(s===u,"Uniform length cannot change.");for(let h=0;h<u;++h)if(l[h]!==i[h]){f=!0;break}}return f&&(r(o,t,a,l),i.set(l)),f}}function gn(t,e,n,r){t[e](n,r)}function Ni(t,e,n,r){t[e](n,!1,r)}const Ck=5120,wk=5121,xk=5122,Pk=5123,DA=0,Zu=1,Mk=2,Rk=3,ef=4,Ik=5,Lk=6,Ut=5126,Bk=35664,Ok=35665,Fk=35666,Gc=5124,Dk=35667,Nk=35668,kk=35669,zc=5125,Uk=36294,Gk=36295,zk=36296,Hk=35670,jk=35671,Vk=35672,Wk=35673,$k=35674,Xk=35675,Jk=35676,Kk=35685,Yk=35686,qk=35687,Qk=35688,Zk=35689,eU=35690,R0={[Ut]:[Ut,1,"float"],[Bk]:[Ut,2,"vec2"],[Ok]:[Ut,3,"vec3"],[Fk]:[Ut,4,"vec4"],[Gc]:[Gc,1,"int"],[Dk]:[Gc,2,"ivec2"],[Nk]:[Gc,3,"ivec3"],[kk]:[Gc,4,"ivec4"],[zc]:[zc,1,"uint"],[Uk]:[zc,2,"uvec2"],[Gk]:[zc,3,"uvec3"],[zk]:[zc,4,"uvec4"],[Hk]:[Ut,1,"bool"],[jk]:[Ut,2,"bvec2"],[Vk]:[Ut,3,"bvec3"],[Wk]:[Ut,4,"bvec4"],[$k]:[Ut,8,"mat2"],[Kk]:[Ut,8,"mat2x3"],[Yk]:[Ut,8,"mat2x4"],[Xk]:[Ut,12,"mat3"],[qk]:[Ut,12,"mat3x2"],[Qk]:[Ut,12,"mat3x4"],[Jk]:[Ut,16,"mat4"],[Zk]:[Ut,16,"mat4x2"],[eU]:[Ut,16,"mat4x3"]};function tU(t){switch(t){case DA:return DA;case Zu:return Zu;case Rk:return Zu;case Mk:return Zu;case ef:return ef;case Ik:return ef;case Lk:return ef;default:return J(!1),0}}function NA(t){const e=R0[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function oM(t,e){switch(t){case Ck:case wk:case xk:case Pk:t=Ut;break}for(const n in R0){const[r,i,s]=R0[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class nU{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),c=n.getAttribLocation(e.handle,s);c>=0&&this._addAttribute(c,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!_e(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=NA(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const c={location:e,name:n,accessor:new Un(a)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=NA(r),a=new Un({type:s,size:i*o}),c={location:e,name:n,accessor:a};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}const kA=4,rU=35981,iU=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class aM extends us{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",iU),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=rU}=e;return this.hash=n||"",this.vs=typeof r=="string"?new yp(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new _p(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,J(this.vs instanceof yp),J(this.fs instanceof _p),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(yn(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new nU(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:c=!1,indexType:l=5123,instanceCount:u=0,isInstanced:f=u>0,vertexArray:h=null,transformFeedback:d,framebuffer:p,parameters:y={},uniforms:b,samplers:v}=e;if((b||v)&&(Y.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(b||{})),Y.priority>=n){const m=p?p.id:"default",_="mode=".concat(zs(this.gl,r)," verts=").concat(i," ")+"instances=".concat(u," indexType=").concat(zs(this.gl,l)," ")+"isInstanced=".concat(f," isIndexed=").concat(c," ")+"Framebuffer=".concat(m);Y.log(n,_)()}return J(h),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||f&&u===0?!1:(h.bindForDraw(i,u,()=>{if(p!==void 0&&(y=Object.assign({},y,{framebuffer:p})),d){const m=tU(r);d.begin(m)}this._bindTextures(),Xn(this.gl,y,()=>{c&&f?this.gl2.drawElementsInstanced(r,i,l,s,u):c&&_e(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,l,s):c?this.gl.drawElements(r,i,l,s):f?this.gl2.drawArraysInstanced(r,s,i,u):this.gl.drawArrays(r,s,i)}),d&&d.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Y.priority>=2&&Ak(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof Et&&(s=s.texture),s instanceof Lo)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:c}=i;a.bind(c),s=c,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&Tk(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new yp({handle:i});break;case 35632:r.fs=new _p({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=os(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Y.time(kA,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Y.timeEnd(kA,"linkProgram for ".concat(this._getName()))(),e.debug||Y.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=bk(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=FA(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=FA(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const sU=34918,oU=34919,aU=35007,cU=36795,lU=35976,uU=35887,fU=36202;class Yh extends us{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=_e(e),i=o_(e,We.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:J(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(aU)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?fU:uU)}beginTransformFeedbackQuery(){return this.begin(lU)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,oU);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(cU)}getResult(){return this.gl2.getQueryParameter(this.handle,sU)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Yh.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class cM extends us{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return _e(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};yn(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,ac(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,Y.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ke?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let tf=null;function hU(t){return(!tf||tf.byteLength<t)&&(tf=new ArrayBuffer(t)),tf}function dU(t,e){const n=hU(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function gU(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let c=r;a<s;a++)e[c++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const pU="elements must be GL.ELEMENT_ARRAY_BUFFER";class ir extends us{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?_e(e)||zP()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new ir(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return ir.MAX_ATTRIBUTES=ir.MAX_ATTRIBUTES||e.getParameter(34921),ir.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:ir._setConstantFloatArray(e,n,r);break;case Int32Array:ir._setConstantIntArray(e,n,r);break;case Uint32Array:ir._setConstantUintArray(e,n,r);break;default:J(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return ir.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return J(!e||e.target===34963,pU),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:c,integer:l,divisor:u}=r,{gl:f,gl2:h}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,n.handle),l?(J(_e(f)),h.vertexAttribIPointer(e,i,s,o,a)):f.vertexAttribPointer(e,i,s,c,o,a),f.enableVertexAttribArray(e),h.vertexAttribDivisor(e,u||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!ir.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new ke(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=dU(n.constructor,s);gU({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:J(!1)}}static _setConstantIntArray(e,n,r){switch(J(_e(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:J(!1)}}static _setConstantUintArray(e,n,r){switch(J(_e(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:J(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return J(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const mU="VertexArray: attributes must be Buffers or constants (i.e. typed array)",vU=/^(.+)__LOCATION_([0-9]+)$/,yU=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class _U{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new ir(e),KP(this,"VertexArray","v6.0",yU),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ke(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ke&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ke&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,Y.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const c=this._getAttributeInfo(a||o);if(!c)return s;const l=this.accessors[o]||{},u=Un.resolve(c.accessor,l,r,i),{size:f,type:h}=u;return J(Number.isFinite(f)&&Number.isFinite(h)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=vU.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ke)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ke){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ke){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(mU)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(ir.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){ir.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof ke){const a=r;if(o){const c=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,c)}else{const c=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,c)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Y.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function bU(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=jl(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function jl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return bU(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function UA(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;J(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,c={},l=Object.keys(a).sort();let u=0;for(const d of l)!d.match(s)&&!d.match(o)&&bp({table:c,header:e,uniforms:r,uniformName:d,undefinedOnly:i})&&u++;for(const d of l)d.match(o)&&bp({table:c,header:e,uniforms:r,uniformName:d,undefinedOnly:i})&&u++;for(const d of l)c[d]||bp({table:c,header:e,uniforms:r,uniformName:d,undefinedOnly:i})&&u++;let f=0;const h={};if(!i)for(const d in r){const p=r[d];c[d]||(f++,h[d]={Type:"NOT USED: ".concat(p),[e]:jl(p)})}return{table:c,count:u,unusedTable:h,unusedCount:f}}function bp(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=AU(o);return!s||!a?(e[i]={[n]:a?jl(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function AU(t){return t!=null}function EU(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=GA(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const c=e.accessors[o.location];c&&(a="".concat(s,": ").concat(TU(o.name,c))),r[a]=GA(e,i[s],c,n)}}return r}function GA(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,c=0,l,u,f;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),l=s.indexOf("nt")!==-1),e instanceof ke){const h=e,{data:d,changed:p}=h.getDebugData();u=p?"*":"",f=d,c=h.byteLength,a=c/d.BYTES_PER_ELEMENT/o;let y;if(n){const b=n.divisor>0;y="".concat(b?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(c," bytes ").concat(zs(i,s),")")}else l=!0,y="".concat(c," bytes");return{[r]:"".concat(u).concat(jl(f,{size:o,isInteger:l})),"Format ":y}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),l=s.indexOf("nt")!==-1,{[r]:"".concat(jl(f,{size:o,isInteger:l})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function TU(t,e){const{type:n,size:r}=e,i=oM(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function SU(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=zA(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=zA(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function zA(t){const{type:e,size:n}=t.accessor,r=oM(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const HA=ls()&&typeof document<"u";let CU=0;class wU{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=b=>JP(b),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:c=null,glOptions:l={},debug:u=!1,createFramebuffer:f=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:d=!0,stats:p=po.get("animation-loop-".concat(CU++))}=e;let{useDevicePixels:y=!0}=e;"useDevicePixelRatio"in e&&(Y.deprecated("useDevicePixelRatio","useDevicePixels")(),y=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:c,glOptions:l,debug:u,createFramebuffer:f},this.gl=c,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:d,useDevicePixels:y}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return J(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Yh.isSupported(this.gl,["timers"])?new Yh(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return Y.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=HA?new Promise((e,n)=>{if(HA&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):BN(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):LN(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?t_(this.props.gl,e):this.onCreateContext(e),!Xd(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");_N(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&SN(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Et(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const _u="vs",c_="fs";function ur(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Ap={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function xU(t){const e={};for(const n in t){const r=t[n],i=PU(r);e[n]=i}return e}function PU(t){let e=jA(t);return e==="object"?t?"type"in t?Object.assign({},t,Ap[t.type]):"value"in t?(e=jA(t.value),Object.assign({type:e},t,Ap[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Ap[e])}function jA(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const MU="vs",RU="fs";class VA{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:c=[],defines:l={},inject:u={},vertexShader:f,fragmentShader:h}=e;ur(typeof n=="string"),this.name=n,this.vs=r||f,this.fs=i||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=l,this.injections=IU(u),o&&(this.uniforms=xU(o))}getModuleSource(e){let n;switch(e){case MU:n=this.vs||"";break;case RU:n=this.fs||"";break;default:ur(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&ur(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function IU(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function LU(t){return BU(uM(t))}function BU(t){const e={},n={};return lM({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function lM(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&lM({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function uM(t,e){return t.map(n=>(n instanceof VA||(ur(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),ur(n.name,"shader module has no name"),n=new VA(n),n.dependencies=uM(n.dependencies)),n))}function OU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const FU=7936,DU=7937,NU=7938,kU=35724,l_={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},co={};Object.keys(l_).forEach(t=>{co[t]=t});function UU(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function GU(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||FU),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||DU);return{gpuVendor:zU(n,r),vendor:n,renderer:r,version:t.getParameter(NU),shadingLanguageVersion:t.getParameter(kU)}}function zU(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Ep={};function WA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=l_[e];if(ur(r,e),!OU(n))return!0;if(e in Ep)return Ep[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const c=t.getShaderParameter(a,35713);return t.deleteShader(a),Ep[e]=c,c}function HU(t,e){const n=l_[e];ur(n,e);const r=UU(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return ur(i===!1||i===!0),i}function nf(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>HU(t,n))}function jU(t){switch(GU(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function VU(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return nf(t,co.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),nf(t,co.GLSL_DERIVATIVES)&&WA(t,co.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),nf(t,co.GLSL_FRAG_DATA)&&WA(t,co.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),nf(t,co.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const WU=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,$U=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,XU={[_u]:WU,[c_]:$U},ih="__LUMA_INJECT_DECLARATIONS__",$A=/void\s+main\s*\([^)]*\)\s*\{\n?/,XA=/}\n?[^{}]*$/,Tp=[];function JA(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===_u;for(const s in n){const o=n[s];o.sort((c,l)=>c.order-l.order),Tp.length=o.length;for(let c=0,l=o.length;c<l;++c)Tp[c]=o[c].injection;const a="".concat(Tp.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(ih,a));break;case"vs:#main-start":i&&(t=t.replace($A,c=>c+a));break;case"vs:#main-end":i&&(t=t.replace(XA,c=>a+c));break;case"fs:#decl":i||(t=t.replace(ih,a));break;case"fs:#main-start":i||(t=t.replace($A,c=>c+a));break;case"fs:#main-end":i||(t=t.replace(XA,c=>a+c));break;default:t=t.replace(s,c=>c+a)}}return t=t.replace(ih,""),r&&(t=t.replace(/\}\s*$/,s=>s+XU[e])),t}function I0(t){const e={};return ur(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function cc(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const fM=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],JU=[...fM,[cc("attribute"),"in $1"],[cc("varying"),"out $1"]],KU=[...fM,[cc("varying"),"in $1"]],hM=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],YU=[...hM,[cc("in"),"attribute $1"],[cc("out"),"varying $1"]],qU=[...hM,[cc("in"),"varying $1"]],L0="gl_FragColor",B0=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,QU=/void\s+main\s*\([^)]*\)\s*\{\n?/;function ZU(t,e,n){switch(e){case 300:return n?qh(t,JU):eG(t);case 100:return n?qh(t,YU):tG(t);default:throw new Error("unknown GLSL version ".concat(e))}}function qh(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function eG(t){t=qh(t,KU);const e=t.match(B0);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(L0,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(QU,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(L0,"\\b"),"g"),n)}return t}function tG(t){t=qh(t,qU);const e=t.match(B0);if(e){const n=e[1];t=t.replace(B0,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),L0)}return t}const nG=`

`.concat(ih,`

`),dM={[_u]:"vertex",[c_]:"fragment"},rG=`precision highp float;

`;function iG(t,e){const{vs:n,fs:r}=e,i=LU(e.modules||[]);return{gl:t,vs:KA(t,Object.assign({},e,{source:n,type:_u,modules:i})),fs:KA(t,Object.assign({},e,{source:r,type:c_,modules:i})),getUniforms:sG(i)}}function KA(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:c={},transpileToGLSL100:l=!1,prologue:u=!0,log:f}=e;ur(typeof r=="string","shader source must be a string");const h=i===_u,d=r.split(`
`);let p=100,y="",b=r;d[0].indexOf("#version ")===0?(p=300,y=d[0],b=d.slice(1).join(`
`)):y="#version ".concat(p);const v={};s.forEach(x=>{Object.assign(v,x.getDefines())}),Object.assign(v,o);let m=u?"".concat(y,`
`).concat(aG({id:n,source:r,type:i}),`
`).concat(oG({type:i}),`
`).concat(jU(t),`
`).concat(VU(t),`
`).concat(cG(v),`
`).concat(h?"":rG,`
`):"".concat(y,`
`);const _=uG(a),A={},S={},w={};for(const x in c){const M=typeof c[x]=="string"?{injection:c[x],order:0}:c[x],L=x.match(/^(v|f)s:(#)?([\w-]+)$/);if(L){const R=L[2],I=L[3];R?I==="decl"?S[x]=[M]:w[x]=[M]:A[x]=[M]}else w[x]=[M]}for(const x of s){f&&x.checkDeprecations(b,f);const M=x.getModuleSource(i,p);m+=M;const L=x.injections[i];for(const R in L){const I=R.match(/^(v|f)s:#([\w-]+)$/);if(I){const k=I[2]==="decl"?S:w;k[R]=k[R]||[],k[R].push(L[R])}else A[R]=A[R]||[],A[R].push(L[R])}}return m+=nG,m=JA(m,i,S),m+=lG(_[i],A),m+=b,m=JA(m,i,w),m=ZU(m,l?100:p,h),m}function sG(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function oG(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(dM[e].toUpperCase(),`
`)}function aG(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(dM[r],`

`):""}function cG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function lG(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function uG(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const fG="void main() {gl_FragColor = vec4(0);}",gM=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,hG=`#version 300 es
`.concat(gM);function pM(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function mM(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?hG:e>300?"#version ".concat(e,`
`).concat(gM):fG;const s=pG(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function dG(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return ur(!1),null}}function gG(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return ur(!1),null}}function pG(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return ur(!1),null}}const mG=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,vG={name:"fp32",vs:mG,fs:null};function Zr(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const yG=1/Math.PI*180,_G=1/180*Math.PI,Ht={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function bG(t,{precision:e=Ht.precision}={}){return t=SG(t),"".concat(parseFloat(t.toPrecision(e)))}function $s(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function AG(t){return TG(t)}function EG(t){return Ki(t)}function TG(t,e){return u_(t,n=>n*_G,e)}function Ki(t,e){return u_(t,n=>n*yG,e)}function ti(t,e,n){return u_(t,r=>Math.max(e,Math.min(n,r)))}function Qh(t,e,n){return $s(t)?t.map((r,i)=>Qh(r,e[i],n)):n*e+(1-n)*t}function ci(t,e,n){const r=Ht.EPSILON;n&&(Ht.EPSILON=n);try{if(t===e)return!0;if($s(t)&&$s(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!ci(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Ht.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Ht.EPSILON=r}}function SG(t){return Math.round(t/Ht.EPSILON)*Ht.EPSILON}function CG(t){return t.clone?t.clone():new Array(t.length)}function u_(t,e,n){if($s(t)){const r=t;n=n||CG(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function wG(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class f_ extends wG(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:$s(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ht)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+bG(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!ci(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Ht.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function xG(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Fe(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function _l(t,e,n=""){if(Ht.debug&&!xG(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class h_ extends f_{get x(){return this[0]}set x(e){this[0]=Fe(e)}get y(){return this[1]}set y(e){this[1]=Fe(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Fe(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Fe(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Zr(e>=0&&e<this.ELEMENTS,"index is out of range"),Fe(this[e])}setComponent(e,n){return Zr(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var bl=1e-6,fi=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function PG(){var t=new fi(2);return fi!=Float32Array&&(t[0]=0,t[1]=0),t}function Zh(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function vM(t,e){return t[0]=-e[0],t[1]=-e[1],t}function yM(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function MG(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function RG(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function _M(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function bM(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=PG();return function(e,n,r,i,s,o){var a,c;for(n||(n=2),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function AM(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function EM(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function IG(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function LG(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function TM(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}class d_ extends h_{constructor(e=0,n=0){super(2),$s(e)&&arguments.length===1?this.copy(e):(Ht.debug&&(Fe(e),Fe(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return Ht.debug&&(Fe(e.x),Fe(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return bM(this,this,e),this.check()}transformAsVector(e){return AM(this,this,e),this.check()}transformByMatrix3(e){return _M(this,this,e),this.check()}transformByMatrix2x3(e){return RG(this,this,e),this.check()}transformByMatrix2(e){return MG(this,this,e),this.check()}}function SM(){var t=new fi(3);return fi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function CM(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function YA(t,e,n){var r=new fi(3);return r[0]=t,r[1]=e,r[2]=n,r}function BG(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function OG(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function FG(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function g_(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function sh(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],c=n[2];return t[0]=i*c-s*a,t[1]=s*o-r*c,t[2]=r*a-i*o,t}function p_(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function wM(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function xM(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],c=e[1],l=e[2],u=i*l-s*c,f=s*a-r*l,h=r*c-i*a,d=i*h-s*f,p=s*u-r*h,y=r*f-i*u,b=o*2;return u*=b,f*=b,h*=b,d*=2,p*=2,y*=2,t[0]=a+u+d,t[1]=c+f+p,t[2]=l+h+y,t}function DG(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function NG(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function kG(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function UG(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],c=Math.sqrt(n*n+r*r+i*i),l=Math.sqrt(s*s+o*o+a*a),u=c*l,f=u&&g_(t,e)/u;return Math.acos(Math.min(Math.max(f,-1),1))}var GG=BG,zG=CM;(function(){var t=SM();return function(e,n,r,i,s,o){var a,c;for(n||(n=3),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const Sp=[0,0,0];let rf;class B extends h_{static get ZERO(){return rf||(rf=new B(0,0,0),Object.freeze(rf)),rf}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&$s(e)?this.copy(e):(Ht.debug&&(Fe(e),Fe(n),Fe(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ht.debug&&(Fe(e.x),Fe(e.y),Fe(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Fe(e)}angle(e){return UG(this,e)}cross(e){return sh(this,this,e),this.check()}rotateX({radians:e,origin:n=Sp}){return DG(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Sp}){return NG(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Sp}){return kG(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return p_(this,this,e),this.check()}transformAsVector(e){return EM(this,this,e),this.check()}transformByMatrix3(e){return wM(this,this,e),this.check()}transformByMatrix2(e){return IG(this,this,e),this.check()}transformByQuaternion(e){return xM(this,this,e),this.check()}}let sf;class m_ extends h_{static get ZERO(){return sf||(sf=new m_(0,0,0,0),Object.freeze(sf)),sf}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),$s(e)&&arguments.length===1?this.copy(e):(Ht.debug&&(Fe(e),Fe(n),Fe(r),Fe(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Ht.debug&&(Fe(e.x),Fe(e.y),Fe(e.z),Fe(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Fe(e)}get w(){return this[3]}set w(e){this[3]=Fe(e)}transform(e){return p_(this,this,e),this.check()}transformByMatrix3(e){return TM(this,this,e),this.check()}transformByMatrix2(e){return LG(this,this,e),this.check()}transformByQuaternion(e){return xM(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class PM extends f_{toString(){let e="[";if(Ht.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Fe(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function HG(){var t=new fi(9);return fi!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function jG(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function VG(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],f=u*o-a*l,h=-u*s+a*c,d=l*s-o*c,p=n*f+r*h+i*d;return p?(p=1/p,t[0]=f*p,t[1]=(-u*r+i*l)*p,t[2]=(a*r-i*o)*p,t[3]=h*p,t[4]=(u*n-i*c)*p,t[5]=(-a*n+i*s)*p,t[6]=d*p,t[7]=(-l*n+r*c)*p,t[8]=(o*n-r*s)*p,t):null}function WG(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8];return e*(l*s-o*c)+n*(-l*i+o*a)+r*(c*i-s*a)}function qA(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],f=e[8],h=n[0],d=n[1],p=n[2],y=n[3],b=n[4],v=n[5],m=n[6],_=n[7],A=n[8];return t[0]=h*r+d*o+p*l,t[1]=h*i+d*a+p*u,t[2]=h*s+d*c+p*f,t[3]=y*r+b*o+v*l,t[4]=y*i+b*a+v*u,t[5]=y*s+b*c+v*f,t[6]=m*r+_*o+A*l,t[7]=m*i+_*a+A*u,t[8]=m*s+_*c+A*f,t}function $G(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],f=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=c,t[6]=h*r+d*o+l,t[7]=h*i+d*a+u,t[8]=h*s+d*c+f,t}function XG(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*o,t[1]=d*i+h*a,t[2]=d*s+h*c,t[3]=d*o-h*r,t[4]=d*a-h*i,t[5]=d*c-h*s,t[6]=l,t[7]=u,t[8]=f,t}function QA(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function JG(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,c=i+i,l=n*o,u=r*o,f=r*a,h=i*o,d=i*a,p=i*c,y=s*o,b=s*a,v=s*c;return t[0]=1-f-p,t[3]=u-v,t[6]=h+b,t[1]=u+v,t[4]=1-l-p,t[7]=d-y,t[2]=h-b,t[5]=d+y,t[8]=1-l-f,t}var O0;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(O0||(O0={}));const KG=Object.freeze([1,0,0,0,1,0,0,0,1]);class bt extends PM{static get IDENTITY(){return qG()}static get ZERO(){return YG()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return O0}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(KG)}fromObject(e){return this.check()}fromQuaternion(e){return JG(this,e),this.check()}set(e,n,r,i,s,o,a,c,l){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this.check()}setRowMajor(e,n,r,i,s,o,a,c,l){return this[0]=e,this[1]=i,this[2]=a,this[3]=n,this[4]=s,this[5]=c,this[6]=r,this[7]=o,this[8]=l,this.check()}determinant(){return WG(this)}transpose(){return jG(this,this),this.check()}invert(){return VG(this,this),this.check()}multiplyLeft(e){return qA(this,e,this),this.check()}multiplyRight(e){return qA(this,this,e),this.check()}rotate(e){return XG(this,this,e),this.check()}scale(e){return Array.isArray(e)?QA(this,this,e):QA(this,this,[e,e]),this.check()}translate(e){return $G(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=_M(n||[-0,-0],e,this);break;case 3:r=wM(n||[-0,-0,-0],e,this);break;case 4:r=TM(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _l(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let of,af;function YG(){return of||(of=new bt([0,0,0,0,0,0,0,0,0]),Object.freeze(of)),of}function qG(){return af||(af=new bt,Object.freeze(af)),af}function QG(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ZG(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function F0(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],f=e[9],h=e[10],d=e[11],p=e[12],y=e[13],b=e[14],v=e[15],m=n*a-r*o,_=n*c-i*o,A=n*l-s*o,S=r*c-i*a,w=r*l-s*a,x=i*l-s*c,M=u*y-f*p,L=u*b-h*p,R=u*v-d*p,I=f*b-h*y,N=f*v-d*y,k=h*v-d*b,z=m*k-_*N+A*I+S*R-w*L+x*M;return z?(z=1/z,t[0]=(a*k-c*N+l*I)*z,t[1]=(i*N-r*k-s*I)*z,t[2]=(y*x-b*w+v*S)*z,t[3]=(h*w-f*x-d*S)*z,t[4]=(c*R-o*k-l*L)*z,t[5]=(n*k-i*R+s*L)*z,t[6]=(b*A-p*x-v*_)*z,t[7]=(u*x-h*A+d*_)*z,t[8]=(o*N-a*R+l*M)*z,t[9]=(r*R-n*N-s*M)*z,t[10]=(p*w-y*A+v*m)*z,t[11]=(f*A-u*w-d*m)*z,t[12]=(a*L-o*I-c*M)*z,t[13]=(n*I-r*L+i*M)*z,t[14]=(y*_-p*S-b*m)*z,t[15]=(u*S-f*_+h*m)*z,t):null}function e4(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],c=t[7],l=t[8],u=t[9],f=t[10],h=t[11],d=t[12],p=t[13],y=t[14],b=t[15],v=e*o-n*s,m=e*a-r*s,_=e*c-i*s,A=n*a-r*o,S=n*c-i*o,w=r*c-i*a,x=l*p-u*d,M=l*y-f*d,L=l*b-h*d,R=u*y-f*p,I=u*b-h*p,N=f*b-h*y;return v*N-m*I+_*R+A*L-S*M+w*x}function Eo(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],l=e[6],u=e[7],f=e[8],h=e[9],d=e[10],p=e[11],y=e[12],b=e[13],v=e[14],m=e[15],_=n[0],A=n[1],S=n[2],w=n[3];return t[0]=_*r+A*a+S*f+w*y,t[1]=_*i+A*c+S*h+w*b,t[2]=_*s+A*l+S*d+w*v,t[3]=_*o+A*u+S*p+w*m,_=n[4],A=n[5],S=n[6],w=n[7],t[4]=_*r+A*a+S*f+w*y,t[5]=_*i+A*c+S*h+w*b,t[6]=_*s+A*l+S*d+w*v,t[7]=_*o+A*u+S*p+w*m,_=n[8],A=n[9],S=n[10],w=n[11],t[8]=_*r+A*a+S*f+w*y,t[9]=_*i+A*c+S*h+w*b,t[10]=_*s+A*l+S*d+w*v,t[11]=_*o+A*u+S*p+w*m,_=n[12],A=n[13],S=n[14],w=n[15],t[12]=_*r+A*a+S*f+w*y,t[13]=_*i+A*c+S*h+w*b,t[14]=_*s+A*l+S*d+w*v,t[15]=_*o+A*u+S*p+w*m,t}function ed(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,c,l,u,f,h,d,p,y,b,v;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],c=e[2],l=e[3],u=e[4],f=e[5],h=e[6],d=e[7],p=e[8],y=e[9],b=e[10],v=e[11],t[0]=o,t[1]=a,t[2]=c,t[3]=l,t[4]=u,t[5]=f,t[6]=h,t[7]=d,t[8]=p,t[9]=y,t[10]=b,t[11]=v,t[12]=o*r+u*i+p*s+e[12],t[13]=a*r+f*i+y*s+e[13],t[14]=c*r+h*i+b*s+e[14],t[15]=l*r+d*i+v*s+e[15]),t}function v_(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function t4(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),c,l,u,f,h,d,p,y,b,v,m,_,A,S,w,x,M,L,R,I,N,k,z,$;return a<bl?null:(a=1/a,i*=a,s*=a,o*=a,c=Math.sin(n),l=Math.cos(n),u=1-l,f=e[0],h=e[1],d=e[2],p=e[3],y=e[4],b=e[5],v=e[6],m=e[7],_=e[8],A=e[9],S=e[10],w=e[11],x=i*i*u+l,M=s*i*u+o*c,L=o*i*u-s*c,R=i*s*u-o*c,I=s*s*u+l,N=o*s*u+i*c,k=i*o*u+s*c,z=s*o*u-i*c,$=o*o*u+l,t[0]=f*x+y*M+_*L,t[1]=h*x+b*M+A*L,t[2]=d*x+v*M+S*L,t[3]=p*x+m*M+w*L,t[4]=f*R+y*I+_*N,t[5]=h*R+b*I+A*N,t[6]=d*R+v*I+S*N,t[7]=p*R+m*I+w*N,t[8]=f*k+y*z+_*$,t[9]=h*k+b*z+A*$,t[10]=d*k+v*z+S*$,t[11]=p*k+m*z+w*$,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function MM(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],c=e[7],l=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+l*r,t[5]=o*i+u*r,t[6]=a*i+f*r,t[7]=c*i+h*r,t[8]=l*i-s*r,t[9]=u*i-o*r,t[10]=f*i-a*r,t[11]=h*i-c*r,t}function n4(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],l=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-l*r,t[1]=o*i-u*r,t[2]=a*i-f*r,t[3]=c*i-h*r,t[8]=s*r+l*i,t[9]=o*r+u*i,t[10]=a*r+f*i,t[11]=c*r+h*i,t}function RM(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],l=e[4],u=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+l*r,t[1]=o*i+u*r,t[2]=a*i+f*r,t[3]=c*i+h*r,t[4]=l*i-s*r,t[5]=u*i-o*r,t[6]=f*i-a*r,t[7]=h*i-c*r,t}function r4(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],a=e[6],c=e[8],l=e[9],u=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,o,a),t[2]=Math.hypot(c,l,u),t}function i4(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,c=i+i,l=n*o,u=r*o,f=r*a,h=i*o,d=i*a,p=i*c,y=s*o,b=s*a,v=s*c;return t[0]=1-f-p,t[1]=u+v,t[2]=h-b,t[3]=0,t[4]=u-v,t[5]=1-l-p,t[6]=d+y,t[7]=0,t[8]=h+b,t[9]=d-y,t[10]=1-l-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function s4(t,e,n,r,i,s,o){var a=1/(n-e),c=1/(i-r),l=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*c,t[10]=(o+s)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*l,t[15]=0,t}function o4(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var a4=o4;function c4(t,e,n,r,i,s,o){var a=1/(e-n),c=1/(r-i),l=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*c,t[14]=(o+s)*l,t[15]=1,t}var l4=c4;function u4(t,e,n,r){var i,s,o,a,c,l,u,f,h,d,p=e[0],y=e[1],b=e[2],v=r[0],m=r[1],_=r[2],A=n[0],S=n[1],w=n[2];return Math.abs(p-A)<bl&&Math.abs(y-S)<bl&&Math.abs(b-w)<bl?QG(t):(u=p-A,f=y-S,h=b-w,d=1/Math.hypot(u,f,h),u*=d,f*=d,h*=d,i=m*h-_*f,s=_*u-v*h,o=v*f-m*u,d=Math.hypot(i,s,o),d?(d=1/d,i*=d,s*=d,o*=d):(i=0,s=0,o=0),a=f*o-h*s,c=h*i-u*o,l=u*s-f*i,d=Math.hypot(a,c,l),d?(d=1/d,a*=d,c*=d,l*=d):(a=0,c=0,l=0),t[0]=i,t[1]=a,t[2]=u,t[3]=0,t[4]=s,t[5]=c,t[6]=f,t[7]=0,t[8]=o,t[9]=l,t[10]=h,t[11]=0,t[12]=-(i*p+s*y+o*b),t[13]=-(a*p+c*y+l*b),t[14]=-(u*p+f*y+h*b),t[15]=1,t)}function f4(){var t=new fi(4);return fi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function h4(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function IM(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function d4(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function g4(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function p4(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t}function m4(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function v4(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function bu(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}function y4(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],c=n[2],l=n[3],u=l*r+a*s-c*i,f=l*i+c*r-o*s,h=l*s+o*i-a*r,d=-o*r-a*i-c*s;return t[0]=u*l+d*-o+f*-c-h*-a,t[1]=f*l+d*-a+h*-o-u*-c,t[2]=h*l+d*-c+u*-a-f*-o,t[3]=e[3],t}(function(){var t=f4();return function(e,n,r,i,s,o){var a,c;for(n||(n=4),r||(r=0),i?c=Math.min(i*n+r,e.length):c=e.length,a=r;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var D0;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(D0||(D0={}));const _4=45*Math.PI/180,b4=1,Cp=.1,wp=500,A4=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Ee extends PM{static get IDENTITY(){return T4()}static get ZERO(){return E4()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return D0}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,c,l,u,f,h,d,p,y,b){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=l,this[9]=u,this[10]=f,this[11]=h,this[12]=d,this[13]=p,this[14]=y,this[15]=b,this.check()}setRowMajor(e,n,r,i,s,o,a,c,l,u,f,h,d,p,y,b){return this[0]=e,this[1]=s,this[2]=l,this[3]=d,this[4]=n,this[5]=o,this[6]=u,this[7]=p,this[8]=r,this[9]=a,this[10]=f,this[11]=y,this[12]=i,this[13]=c,this[14]=h,this[15]=b,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(A4)}fromObject(e){return this.check()}fromQuaternion(e){return i4(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=Cp,far:a=wp}=e;return a===1/0?S4(this,n,r,i,s,o):s4(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return u4(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=Cp,far:a=wp}=e;return l4(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=_4,aspect:r=b4,focalDistance:i=1,near:s=Cp,far:o=wp}=e;ZA(n);const a=n/2,c=i*Math.tan(a),l=c*r;return this.ortho({left:-l,right:l,bottom:-c,top:c,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return ZA(n),a4(this,n,r,i,s),this.check()}determinant(){return e4(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return ZG(this,this),this.check()}invert(){return F0(this,this),this.check()}multiplyLeft(e){return Eo(this,e,this),this.check()}multiplyRight(e){return Eo(this,this,e),this.check()}rotateX(e){return MM(this,this,e),this.check()}rotateY(e){return n4(this,this,e),this.check()}rotateZ(e){return RM(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return t4(this,this,e,n),this.check()}scale(e){return v_(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return ed(this,this,e),this.check()}transform(e,n){return e.length===4?(n=bu(n||[-0,-0,-0,-0],e,this),_l(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=bM(n||[-0,-0],e,this);break;case 3:i=p_(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _l(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=AM(n||[-0,-0],e,this);break;case 3:r=EM(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return _l(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let cf,lf;function E4(){return cf||(cf=new Ee([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(cf)),cf}function T4(){return lf||(lf=new Ee,Object.freeze(lf)),lf}function ZA(t){if(t>Math.PI*2)throw Error("expected radians")}function S4(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),c=(n+e)/(n-e),l=(i+r)/(i-r),u=-1,f=-1,h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=u,t[11]=f,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}function eE(){var t=new fi(4);return fi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function C4(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function LM(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function tE(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=n[0],c=n[1],l=n[2],u=n[3];return t[0]=r*u+o*a+i*l-s*c,t[1]=i*u+o*c+s*a-r*l,t[2]=s*u+o*l+r*c-i*a,t[3]=o*u-r*a-i*c-s*l,t}function w4(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*a,t[1]=i*c+s*a,t[2]=s*c-i*a,t[3]=o*c-r*a,t}function x4(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c-s*a,t[1]=i*c+o*a,t[2]=s*c+r*a,t[3]=o*c-i*a,t}function P4(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*a,t[1]=i*c-r*a,t[2]=s*c+o*a,t[3]=o*c-s*a,t}function M4(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function oh(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3],c=n[0],l=n[1],u=n[2],f=n[3],h,d,p,y,b;return d=i*c+s*l+o*u+a*f,d<0&&(d=-d,c=-c,l=-l,u=-u,f=-f),1-d>bl?(h=Math.acos(d),p=Math.sin(h),y=Math.sin((1-r)*h)/p,b=Math.sin(r*h)/p):(y=1-r,b=r),t[0]=y*i+b*c,t[1]=y*s+b*l,t[2]=y*o+b*u,t[3]=y*a+b*f,t}function R4(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a,t}function I4(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function BM(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[o*3+o]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+o]-e[o*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[o]=(e[o*3+i]+e[i*3+o])*r}return t}var L4=h4,B4=IM,O4=m4,F4=v4,D4=d4,N4=g4,OM=p4,k4=function(){var t=SM(),e=YA(1,0,0),n=YA(0,1,0);return function(r,i,s){var o=g_(i,s);return o<-.999999?(sh(t,e,i),zG(t)<1e-6&&sh(t,n,i),FG(t,t),LM(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(sh(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,OM(r,r))}}();(function(){var t=eE(),e=eE();return function(n,r,i,s,o,a){return oh(t,r,o,a),oh(e,i,s,a),oh(n,t,e,2*a*(1-a)),n}})();(function(){var t=HG();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],OM(e,BM(e,t))}})();const U4=[0,0,0,1];class Vl extends f_{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return BM(this,e),this.check()}fromAxisRotation(e,n){return LM(this,e,n),this.check()}identity(){return C4(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Fe(e)}get y(){return this[1]}set y(e){this[1]=Fe(e)}get z(){return this[2]}set z(e){this[2]=Fe(e)}get w(){return this[3]}set w(e){this[3]=Fe(e)}len(){return D4(this)}lengthSquared(){return N4(this)}dot(e){return O4(this,e)}rotationTo(e,n){return k4(this,e,n),this.check()}add(e){return L4(this,this,e),this.check()}calculateW(){return M4(this,this),this.check()}conjugate(){return I4(this,this),this.check()}invert(){return R4(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(F4(this,e,n,r),this.check())}multiplyRight(e){return tE(this,this,e),this.check()}multiplyLeft(e){return tE(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return w4(this,this,e),this.check()}rotateY(e){return x4(this,this,e),this.check()}rotateZ(e){return P4(this,this,e),this.check()}scale(e){return B4(this,this,e),this.check()}slerp(e,n,r){let i,s,o;switch(arguments.length){case 1:({start:i=U4,target:s,ratio:o}=e);break;case 2:i=this,s=e,o=n;break;default:i=e,s=n,o=r}return oh(this,i,s,o),this.check()}transformVector4(e,n=new m_){return y4(n,e,this),_l(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const Wl={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},nE=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,G4={lightSources:{}};function xp(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function z4(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=xp(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{i["lighting_uPointLight[".concat(o,"].color")]=xp(s),i["lighting_uPointLight[".concat(o,"].position")]=s.position,i["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,o)=>{i["lighting_uDirectionalLight[".concat(o,"].color")]=xp(s),i["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function FM(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G4;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},z4({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return FM({lightSources:e})}return{}}const y_={name:"lights",vs:nE,fs:nE,getUniforms:FM,defines:{MAX_LIGHTS:3}},H4=new Uint8Array([0,255,255,255]),j4={pickingSelectedColor:null,pickingHighlightColor:H4,pickingActive:!1,pickingAttribute:!1};function V4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j4;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const W4=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,$4=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,X4={name:"picking",vs:W4,fs:$4,getUniforms:V4},DM=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,J4={};function K4(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function NM(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J4;if(!("material"in t))return{};const{material:e}=t;return e?K4(e):{lighting_uEnabled:!1}}const kM={name:"gouraud-lighting",dependencies:[y_],vs:DM,defines:{LIGHTING_VERTEX:1},getUniforms:NM},Y4={name:"phong-lighting",dependencies:[y_],fs:DM,defines:{LIGHTING_FRAGMENT:1},getUniforms:NM},q4=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,Q4=`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,__={name:"pbr",vs:q4,fs:Q4,defines:{LIGHTING_FRAGMENT:1},dependencies:[y_]},Z4=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,ez={name:"transform",vs:Z4,fs:null};class Sc{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Sc(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:c=!1}=e,l=this._getModuleList(e.modules),u=this._getHash(n),f=this._getHash(r),h=l.map(_=>this._getHash(_.name)).sort(),d=o.map(_=>this._getHash(_)),p=Object.keys(i).sort(),y=Object.keys(s).sort(),b=[],v=[];for(const _ of p)b.push(this._getHash(_)),b.push(this._getHash(i[_]));for(const _ of y)v.push(this._getHash(_)),v.push(this._getHash(s[_]));const m="".concat(u,"/").concat(f,"D").concat(b.join("/"),"M").concat(h.join("/"),"I").concat(v.join("/"),"V").concat(d.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(c?"T":"");if(!this._programCache[m]){const _=iG(this.gl,{vs:n,fs:r,modules:l,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[m]=new aM(this.gl,{hash:m,vs:_.vs,fs:_.fs,varyings:o,bufferMode:a}),this._getUniforms[m]=_.getUniforms||(A=>{}),this._useCounts[m]=0}return this._useCounts[m]++,this._programCache[m]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],c=a.name;n[i++]=a,r[c]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],c=a.name;r[c]||(n[i++]=a,r[c]=!0)}return n.length=i,n}}const tz={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function nz(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=rz(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const c=o.value,l={...o};delete l.value,r[a]=[new ke(t,c),l],iz(s,l)}}if(i){const s=i.value||i;J(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ke(t,{data:s,target:34963}),o]}return r}function rz(t,e){const{attributeMap:n=tz}=e||{};return n&&n[t]||t}function iz(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}J(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const sa=2,sz=1e4,oz="Model needs drawMode and vertexCount",rE=()=>{},az={};class Br{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=os("model")}=n;J(Xd(e)),this.id=r,this.gl=e,this.id=n.id||os("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Sc.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},J(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),oz)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:c,bufferMode:l,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return J(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return J(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=nz(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ac(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return i_(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let l;Y.priority>=sa&&(l=this._logDrawCallStart(sa));const u=this.vertexArray.getDrawParams(),{isIndexed:f=u.isIndexed,indexType:h=u.indexType,indexOffset:d=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&Y.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:y,instanceCount:b}=this,{onBeforeRender:v=rE,onAfterRender:m=rE}=this.props;v(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(az,e,{logPriority:l,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:f,indexType:h,isInstanced:y,instanceCount:b,offset:f?d:0}));return m(),Y.priority>=sa&&this._logDrawCallEnd(l,c,r),_}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Y.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:c,bufferMode:l,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}J(n instanceof aM,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new _U(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ke&&n.delete()}}_setAnimationProps(e){this.animated&&J(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ac(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new cM(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:sz;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Y.group(sa,">>> DRAWING MODEL ".concat(this.id),{collapsed:Y.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=EU({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=UA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:l,count:u}=UA({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});u>0&&Y.log("MISSING UNIFORMS",Object.keys(l))(),c>0&&Y.log("UNUSED UNIFORMS",Object.keys(a))();const f=SU(this.vertexArray.configuration);Y.table(e,s)(),Y.table(e,o)(),Y.table(e+1,f)(),i&&i.log({logLevel:sa,message:"Rendered to ".concat(i.id)}),Y.groupEnd(sa)()}}class cz{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ke?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&J(_e(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:c,accessor:l}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:c,accessor:l})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new cM(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],J(r[s]instanceof ke)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ke(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const lz="transform_uSampler_",td="transform_uSize_",iE="transform_position";function uz(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const c={};let l=e,u={};if(o>0||r){const f=l.split(`
`),h=f.slice();if(f.forEach((d,p,y)=>{if(o>0){const b=pz(d,n);if(b){const{updatedLine:v,inject:m}=b;h[p]=v,u=I0([u,m]),Object.assign(c,b.samplerTextureMap),o--}}r&&!a&&(a=gz(d,r))}),r){J(i);const d="".concat(td).concat(r),p="uniform vec2 ".concat(d,`;
`),y="     vec2 ".concat(iE," = transform_getPos(").concat(d,`);
     gl_Position = vec4(`).concat(iE,`, 0, 1.);
`);u=I0([u,{"vs:#decl":p,"vs:#main-start":y}])}l=h.join(`
`)}return{vs:l,targetTextureType:a,inject:u,samplerTextureMap:c}}function fz(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(td).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(td).concat(a)]=[s,o];return i}function hz(t){return pM(t,["attribute","in"])}function dz(t){const e="".concat(lz).concat(t),n="".concat(td).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function gz(t,e){const n=pM(t,["varying","out"]);return n&&n.name===e?n.type:null}function pz(t,e){const n={},r=hz(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:c,uniformDeclerations:l}=dz(s),u=dG(i),f="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(c,").").concat(u,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":l,"vs:#main-start":f},samplerTextureMap:n}}return null}const mz={10241:9728,10240:9728,10242:33071,10243:33071},vz="transform_output";class yz{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),c=Object.assign({},e.parameters);let l=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap){const h=this.samplerTextureMap[f];a[f]=r[h]}this._setSourceTextureParameters();const u=fz({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(l=!1,c.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:l,parameters:c}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=Kd(n);if(!e)return r;const i=r.constructor,s=gG(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let c=0;c<r.length;c+=4)for(let l=0;l<s;l++)o[a++]=r[c+l];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof on)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ke(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:c}=e;c?(c.update({attachments:{36064:s},resizeAttachments:!1}),c.resize({width:o,height:a})):e.framebuffer=new Et(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(mz)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=ck(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:c}=uz({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),l=I0([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=c;const u=e._fs||mM({version:sM(i),input:this.targetTextureVarying,inputType:o,output:vz}),f=this.hasSourceTextures||this.targetTextureVarying?[ez].concat(e.modules||[]):e.modules;return{vs:i,fs:u,modules:f,uniforms:s,inject:l}}}class b_{static isSupported(e){return _e(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();J(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Br(n,Object.assign({},e,{fs:e.fs||mM({version:sM(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){_z(n)&&(this.bufferTransform=new cz(e,n)),bz(n)&&(this.textureTransform=new yz(e,n)),J(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function _z(t){return!!(!ac(t.feedbackBuffers)||!ac(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function bz(t){return!!(!ac(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const sE={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Ii{static get DRAW_MODE(){return sE}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=os("geometry"),drawMode:r=sE.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,J(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(J(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:c}=s;!c&&o&&a>=1&&(r=Math.min(r,o.length/a))}return J(Number.isFinite(r)),r}}let Az=1,Ez=1;class UM{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=Az++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=Ez++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const Tz=[255,255,255],Sz=1;let Cz=0;class wz{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","ambient");const{color:n=Tz}=e,{intensity:r=Sz}=e;this.id=e.id||"ambient-".concat(Cz++),this.color=n,this.intensity=r}}const xz=[255,255,255],Pz=1,Mz=[0,0,-1];let Rz=0;class oE{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","directional"),g(this,"direction",void 0),g(this,"shadow",void 0);const{color:n=xz}=e,{intensity:r=Pz}=e,{direction:i=Mz}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(Rz++),this.color=n,this.intensity=r,this.type="directional",this.direction=new B(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Iz{constructor(e,n={id:"pass"}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Yd extends Iz{constructor(...e){super(...e),g(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return ss(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:c=!0}=e;e.pass=e.pass||"unknown";const l=this.gl;c&&Bz(l,n),a&&(this._lastRenderIndex=-1);const u=[];for(const f of i){const h=s&&s[f.id];o==null||o(f);const d=this._getDrawLayerParams(f,e),p=f.subViewports||[f];for(const y of p){const b=this._drawLayersInViewport(l,{target:n,moduleParameters:r,viewport:y,view:h,pass:e.pass,layers:e.layers},d);u.push(b)}}return u}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:c},l=!1){const u=[],f=GM(this._lastRenderIndex+1),h={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},d={};for(let p=0;p<n.length;p++){const y=n[p],b=this._shouldDrawLayer(y,h,s,d),v={shouldDrawLayer:b};b&&!l&&(v.layerRenderIndex=f(y,b),v.moduleParameters=this._getModuleParameters(y,a,r,c),v.layerParameters=this.getLayerParameters(y,p,e)),u[p]=v}return u}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},c){const l=Lz(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const f=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Xn(e,{scissorTest:!0,scissor:l},()=>i_(e,f))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};ss(e,{viewport:l});for(let f=0;f<n.length;f++){const h=n[f],{shouldDrawLayer:d,layerRenderIndex:p,moduleParameters:y,layerParameters:b}=c[f];if(d&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(d){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,p),y.viewport=o;try{h._drawLayer({moduleParameters:y,uniforms:{layerIndex:p},parameters:b})}catch(v){h.raiseError(v,"drawing ".concat(h," to ").concat(i))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:oc(this.gl)});if(n)for(const c of n){var a;Object.assign(o,(a=c.getModuleParameters)===null||a===void 0?void 0:a.call(c,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function GM(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,c=i.parent&&i.parent.id;let l;if(c&&!(c in e)&&r(i.parent,!1),c in n){const u=n[c]=n[c]||GM(e[c],e);l=u(i,s),n[a]=u}else Number.isFinite(o)?(l=o+(e[c]||0),n[a]=null):l=t;return s&&l>=t&&(t=l+1),e[a]=l,l};return r}function Lz(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||oc(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function Bz(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;ss(t,{viewport:[0,0,n,r]}),t.clear(16640)}class Oz extends Yd{constructor(e,n){super(e,n),g(this,"shadowMap",void 0),g(this,"depthBuffer",void 0),g(this,"fbo",void 0),this.shadowMap=new on(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Ra(e,{format:33189,width:1,height:1}),this.fbo=new Et(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Xn(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=oc(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const zM="#define SMOOTH_EDGE_RADIUS 0.5",Fz=`
`.concat(zM,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),Dz=`
`.concat(zM,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),Nz={name:"geometry",vs:Fz,fs:Dz},kz=Object.keys(Te).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Te[t],";")).join(""),Uz=Object.keys(xi).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(xi[t],";")).join(""),Gz=Object.keys(Ws).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Ws[t],";")).join(""),zz="".concat(kz,`
`).concat(Uz,`
`).concat(Gz,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function Hz(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Au(t){let e={},n;return r=>{for(const i in r)if(!Hz(r[i],e[i])){n=t(r),e=r;break}return n}}const aE=[0,0,0,0],jz=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],HM=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Vz=[0,0,0],jM=[0,0,0],Wz=Au(Jz);function VM(t,e,n=jM){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===Te.LNGLAT_OFFSETS||e===Te.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case xi.WEB_MERCATOR:(e===Te.LNGLAT||e===Te.CARTESIAN)&&(i=[0,0,0],s=!1);break;case xi.WEB_MERCATOR_AUTO_OFFSET:e===Te.LNGLAT?r=i:e===Te.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case xi.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case xi.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function $z(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=aE,c=aE,l=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:f,offsetMode:h}=VM(t,e,n);return h&&(c=t.projectPosition(u||f),l=[l[0]-c[0],l[1]-c[1],l[2]-c[2]],c[3]=1,a=bu([],c,o),s=r||s,o=Eo([],i,s),o=Eo([],o,jz)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:c,cameraPosCommon:l,shaderCoordinateOrigin:f,geospatialOrigin:u}}function Xz({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Te.DEFAULT,coordinateOrigin:i=jM,autoWrapLongitude:s=!1}){r===Te.DEFAULT&&(r=t.isGeospatial?Te.LNGLAT:Te.CARTESIAN);const o=Wz({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||HM,o}function Jz({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:c,geospatialOrigin:l}=$z(t,n,r),u=t.getDistanceScales(),f=[t.width*e,t.height*e],h=bu([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Vz,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:HM,project_uCameraPosition:a};if(l){const p=t.getDistanceScales(l);switch(n){case Te.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=p.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=p.unitsPerMeter2;break;case Te.LNGLAT:case Te.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=p.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=p.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=p.unitsPerDegree2;break;case Te.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,p.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,p.unitsPerMeter2[2]];break}}return d}const Kz={};function Yz(t=Kz){return"viewport"in t?Xz(t):{}}const qd={name:"project",dependencies:[vG,Nz],vs:zz,getUniforms:Yz};function qz(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function $a(t,e){const n=bu([],e,t);return IM(n,n,1/n[3]),n}function cE(t,e){const n=t%e;return n<0?e+n:n}function N0(t,e,n){return t<e?e:t>n?n:t}function Qz(t){return Math.log(t)*Math.LOG2E}const A_=Math.log2||Qz;function as(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ni=Math.PI,WM=ni/4,Rr=ni/180,k0=180/ni,lc=512,nd=4003e4,uf=85.051129,Zz=1.5;function e6(t){return A_(t)}function rd(t){const[e,n]=t;as(Number.isFinite(e)),as(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Rr,i=n*Rr,s=lc*(r+ni)/(2*ni),o=lc*(ni+Math.log(Math.tan(WM+i*.5)))/(2*ni);return[s,o]}function uc(t){const[e,n]=t,r=e/lc*(2*ni)-ni,i=2*(Math.atan(Math.exp(n/lc*(2*ni)-ni))-WM);return[r*k0,i*k0]}function t6(t){const{latitude:e}=t;as(Number.isFinite(e));const n=Math.cos(e*Rr);return e6(nd*n)-9}function Pp(t){const e=Math.cos(t*Rr);return lc/nd/e}function U0(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;as(Number.isFinite(e)&&Number.isFinite(n));const i=lc,s=Math.cos(e*Rr),o=i/360,a=o/s,c=i/nd/s,l={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(r){const u=Rr*Math.tan(e*Rr)/s,f=o*u/2,h=i/nd*u,d=h/a*c;l.unitsPerDegree2=[0,f,h],l.unitsPerMeter2=[d,0,d]}return l}function $M(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:c,unitsPerMeter2:l}=U0({longitude:n,latitude:r,highPrecision:!0}),u=rd(t);u[0]+=s*(c[0]+l[0]*o),u[1]+=o*(c[1]+l[1]*o);const f=uc(u),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function n6(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=qz();ed(a,a,[0,0,-i]),MM(a,a,-n*Rr),RM(a,a,r*Rr);const c=s/e;return v_(a,a,[c,c,c]),o&&ed(a,a,OG([],o)),a}function r6(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:c=1,farZMultiplier:l=1}=t;let{fovy:u=id(Zz)}=t;r!==void 0&&(u=id(r));const f=u*Rr,h=i*Rr,d=XM(u);let p=d;o&&(p+=o[2]*a/Math.cos(h)/n);const y=f*(.5+(s?s[1]:0)/n),b=Math.sin(y)*p/Math.sin(N0(Math.PI/2-h-y,.01,Math.PI-.01)),v=Math.sin(h)*b+p,m=p*10,_=Math.min(v*l,m);return{fov:f,aspect:e/n,focalDistance:d,near:c,far:_}}function id(t){return 2*Math.atan(.5/t)*k0}function XM(t){return .5/Math.tan(.5*t*Rr)}function JM(t,e){const[n,r,i=0]=t;return as(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),$a(e,[n,r,i,1])}function Qd(t,e,n=0){const[r,i,s]=t;if(as(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return $a(e,[r,i,s,1]);const o=$a(e,[r,i,0,1]),a=$a(e,[r,i,1,1]),c=o[2],l=a[2],u=c===l?0:((n||0)-c)/(l-c);return yM([],o,a,u)}function i6(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,c],[l,u]]=r,f=s6(t.padding),h=rd([a,N0(u,-uf,uf)]),d=rd([l,N0(c,-uf,uf)]),p=[Math.max(Math.abs(d[0]-h[0]),i),Math.max(Math.abs(d[1]-h[1]),i)],y=[e-f.left-f.right-Math.abs(o[0])*2,n-f.top-f.bottom-Math.abs(o[1])*2];as(y[0]>0&&y[1]>0);const b=y[0]/p[0],v=y[1]/p[1],m=(f.right-f.left)/2/b,_=(f.top-f.bottom)/2/v,A=[(d[0]+h[0])/2+m,(d[1]+h[1])/2+_],S=uc(A),w=Math.min(s,A_(Math.abs(Math.min(b,v))));return as(Number.isFinite(w)),{longitude:S[0],latitude:S[1],zoom:w}}function s6(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(as(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const lE=Math.PI/180;function o6(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let c,l;const u=t.fovy?.5*t.fovy*lE:Math.atan(.5/t.altitude),f=(90-t.pitch)*lE;return u>f-.01?(c=uE(t,0,e),l=uE(t,n,e)):(c=i([0,0],s),l=i([n,0],s)),[o,a,l,c]}function uE(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=$a(r,[e,0,1,1]),s=$a(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),c=yM([],i,s,a),l=uc(c);return l.push(n),l}const fE=512;function a6(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=cE(i+180,360)-180),(a<-180||a>180)&&(a=cE(a+180,360)-180);const c=A_(n/fE);if(o<=c)o=c,s=0;else{const l=n/2/Math.pow(2,o),u=uc([0,l])[1];if(s<u)s=u;else{const f=uc([0,fE-l])[1];s>f&&(s=f)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const c6=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,l6=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,u6=Au(p6),f6=Au(m6),h6=[0,0,0,1],d6=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function g6(t,e){const[n,r,i]=t,s=Qd([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function p6({viewport:t,center:e}){return new Ee(t.viewProjectionMatrix).invert().transform(e)}function m6({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>g6(o,r));for(const o of e){const a=o.clone().translate(new B(t.center).negate()),c=s.map(u=>a.transform(u)),l=new Ee().ortho({left:Math.min(...c.map(u=>u[0])),right:Math.max(...c.map(u=>u[0])),bottom:Math.min(...c.map(u=>u[1])),top:Math.max(...c.map(u=>u[1])),near:Math.min(...c.map(u=>-u[2])),far:Math.max(...c.map(u=>-u[2]))});n.push(l.multiplyRight(o))}return n}function v6(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||h6,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=u6({viewport:t.viewport,center:e.project_uCenter}),s=[],o=f6({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const c=o[a],l=c.clone().translate(new B(t.viewport.center).negate());e.project_uCoordinateSystem===Te.LNGLAT&&e.project_uProjectionMode===xi.WEB_MERCATOR?(o[a]=l,s[a]=i):(o[a]=c.clone().multiplyRight(d6),s[a]=l.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const Mp={name:"shadow",dependencies:[qd],vs:c6,fs:l6,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?v6(t,e):{}},y6={color:[255,255,255],intensity:1},hE=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],_6=[0,0,0,200/255];class KM{constructor(e={}){g(this,"id","lighting-effect"),g(this,"props",void 0),g(this,"shadowColor",_6),g(this,"shadow",void 0),g(this,"ambientLight",void 0),g(this,"directionalLights",void 0),g(this,"pointLights",void 0),g(this,"shadowPasses",[]),g(this,"shadowMaps",[]),g(this,"dummyShadowMap",null),g(this,"programManager",void 0),g(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Sc.getDefaultProgramManager(e),Mp&&this.programManager.addDefaultModule(Mp)),this.dummyShadowMap||(this.dummyShadowMap=new on(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Mp),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Ee().lookAt({eye:new B(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new Oz(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new wz(y6),this.directionalLights.push(new oE(hE[0]),new oE(hE[1])))}}class b6{constructor(e={}){g(this,"_pool",[]),g(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:c}){const l=i||e&&e.constructor||Float32Array,u=n*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new l(e.buffer,0,u)}let f=1/0;c&&(f=c*r+s);const h=this._allocate(l,u,a,f);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,c=o.findIndex(l=>l.byteLength>=a);if(c>=0){const l=new e(o.splice(c,1)[0],0,s);return r&&l.fill(0),l}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const fc=new b6;function il(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function A6(t){return[t[12],t[13],t[14]]}function E6(t){return{left:oa(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:oa(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:oa(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:oa(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:oa(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:oa(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const dE=new B;function oa(t,e,n,r){dE.set(t,e,n);const i=dE.len();return{distance:r/i,normal:new B(-t/i,-e/i,-n/i)}}function T6(t){return t-Math.fround(t)}let Hc;function Rp(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Hc=fc.allocate(Hc,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let c=0;c<n;c++){const l=t[o++];Hc[a+c]=l,Hc[a+c+n]=T6(l)}a+=n*2}return Hc.subarray(0,s*n*2)}function S6(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const C6=Math.PI/180,w6=il(),gE=[0,0,0],x6={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function P6({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const c=t/e,l=n?new Ee().orthographic({fovy:r,aspect:c,focalDistance:i,near:o,far:a}):new Ee().perspective({fovy:r,aspect:c,near:o,far:a});if(s){const{left:u=0,right:f=0,top:h=0,bottom:d=0}=s,p=ti((u+t-f)/2,0,t)-t/2,y=ti((h+e-d)/2,0,e)-e/2;l[8]-=p*2/t,l[9]+=y*2/e}return l}class Vo{constructor(e={}){g(this,"id",void 0),g(this,"x",void 0),g(this,"y",void 0),g(this,"width",void 0),g(this,"height",void 0),g(this,"padding",void 0),g(this,"isGeospatial",void 0),g(this,"zoom",void 0),g(this,"focalDistance",void 0),g(this,"position",void 0),g(this,"modelMatrix",void 0),g(this,"distanceScales",void 0),g(this,"scale",void 0),g(this,"center",void 0),g(this,"cameraPosition",void 0),g(this,"projectionMatrix",void 0),g(this,"viewMatrix",void 0),g(this,"viewMatrixUncentered",void 0),g(this,"viewMatrixInverse",void 0),g(this,"viewProjectionMatrix",void 0),g(this,"pixelProjectionMatrix",void 0),g(this,"pixelUnprojectionMatrix",void 0),g(this,"resolution",void 0),g(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||x6,this.focalDistance=e.focalDistance||1,this.position=e.position||gE,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?xi.WEB_MERCATOR:xi.WEB_MERCATOR_AUTO_OFFSET:xi.IDENTITY}equals(e){return e instanceof Vo?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&ci(e.projectionMatrix,this.projectionMatrix)&&ci(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=JM(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,c=r&&r*this.distanceScales.unitsPerMeter[2],l=Qd([i,a,o],this.pixelUnprojectionMatrix,c),[u,f,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,f,h]:Number.isFinite(r)?[u,f,r]:[u,f]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=rd(e);return n[1]=ti(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?uc(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?U0({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,E6(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=t6({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||U0({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=gE;if(s&&(a=o?new Ee(o).transformAsVector(s,[]):s),this.isGeospatial){const c=this.projectPosition([n,r,0]);this.center=new B(a).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=w6,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:c=1e3,padding:l=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Ee().multiplyRight(n).translate(new B(this.center).negate()),this.projectionMatrix=r||P6({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*C6,focalDistance:u,padding:l,near:a,far:c});const f=il();Eo(f,f,this.projectionMatrix),Eo(f,f,this.viewMatrix),this.viewProjectionMatrix=f,this.viewMatrixInverse=F0([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=A6(this.viewMatrixInverse);const h=il(),d=il();v_(h,h,[this.width/2,-this.height/2,1]),ed(h,h,[1,-1,0]),Eo(d,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=F0(il(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||de.warn("Pixel project matrix not invertible")()}}g(Vo,"displayName","Viewport");class Bo extends Vo{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,nearZ:l,farZ:u,orthographic:f=!1,projectionMatrix:h,repeat:d=!1,worldOffset:p=0,position:y,padding:b,legacyMeterSizes:v=!1}=e;let{width:m,height:_,altitude:A=1.5}=e;const S=Math.pow(2,i);m=m||1,_=_||1;let w,x=null;if(h)A=h[5]/2,w=id(A);else{e.fovy?(w=e.fovy,A=XM(w)):w=id(A);let L;if(b){const{top:R=0,bottom:I=0}=b;L=[0,ti((R+_-I)/2,0,_)-_/2]}x=r6({width:m,height:_,scale:S,center:y&&[0,0,y[2]*Pp(n)],offset:L,pitch:s,fovy:w,nearZMultiplier:a,farZMultiplier:c}),Number.isFinite(l)&&(x.near=l),Number.isFinite(u)&&(x.far=u)}let M=n6({height:_,pitch:s,bearing:o,scale:S,altitude:A});p&&(M=new Ee().translate([512*p,0,0]).multiplyLeft(M)),super({...e,width:m,height:_,viewMatrix:M,longitude:r,latitude:n,zoom:i,...x,fovy:w,focalDistance:A}),g(this,"longitude",void 0),g(this,"latitude",void 0),g(this,"pitch",void 0),g(this,"bearing",void 0),g(this,"altitude",void 0),g(this,"fovy",void 0),g(this,"orthographic",void 0),g(this,"_subViewports",void 0),g(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=A,this.fovy=w,this.orthographic=f,this._subViewports=d?[]:null,this._pseudoMeters=v,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Bo({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Pp(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Pp(r);return[n,r,i]}addMetersToLngLat(e,n){return $M(e,n)}panByPosition(e,n){const r=Qd(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Zh([],i,vM([],r)),o=Zh([],this.center,s),[a,c]=this.unprojectFlat(o);return{longitude:a,latitude:c}}getBounds(e={}){const n=o6(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=i6({width:r,height:i,bounds:e,...n});return new Bo({width:r,height:i,longitude:s,latitude:o,zoom:a})}}g(Bo,"displayName","WebMercatorViewport");const pE=[0,0,0];function Ip(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Bo){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function M6(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===Te.DEFAULT&&(i=e.isGeospatial?Te.LNGLAT:Te.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function YM(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,c=0]=t;switch(n&&([o,a,c]=bu([],[o,a,c,1],n)),r){case Te.LNGLAT:return Ip([o,a,c],e,s);case Te.LNGLAT_OFFSETS:return Ip([o+i[0],a+i[1],c+(i[2]||0)],e,s);case Te.METER_OFFSETS:return Ip($M(i,[o,a,c]),e,s);case Te.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],c+i[2]]:e.projectPosition([o,a,c])}}function R6(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=M6(e),{autoOffset:c=!0}=e,{geospatialOrigin:l=pE,shaderCoordinateOrigin:u=pE,offsetMode:f=!1}=c?VM(n,r,i):{},h=YM(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:f});if(f){const d=n.projectPosition(l||u);GG(h,h,d)}return h}const mE={blendFunc:[1,0,32771,0],blendEquation:32774};class E_ extends Yd{constructor(...e){super(...e),g(this,"pickZ",void 0),g(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:c,width:l,height:u},cullRect:f,effects:h,pass:d="picking",pickZ:p,moduleParameters:y}){const b=this.gl;this.pickZ=p;const v=this._resetColorEncoder(p),m=Xn(b,{scissorTest:!0,scissor:[a,c,l,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...mE,blend:!p},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:f,effects:h==null?void 0:h.filter(A=>A.useInPicking),pass:d,isPicking:!0,moduleParameters:y}));return this._colorEncoderState=null,{decodePickingColor:v&&L6.bind(null,v),stats:m}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:o}=e.props;return this._colorEncoderState?s&&o.includes("draw")&&(Object.assign(i,mE),i.blend=!0,i.blendColor=I6(this._colorEncoderState,e,r)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function I6(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(de.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function L6(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const pa={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},sd=Symbol.for("component"),Hs=Symbol.for("propTypes"),Lp=Symbol.for("deprecatedProps"),Xa=Symbol.for("asyncPropDefaults"),Oo=Symbol.for("asyncPropOriginal"),Ms=Symbol.for("asyncPropResolved");function T_(t,e=()=>!0){return Array.isArray(t)?qM(t,e,[]):e(t)?[t]:[]}function qM(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?qM(i,e,n):e(i)&&n.push(i)}return n}function B6({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class O6{constructor(e,n,r){g(this,"id",void 0),g(this,"context",void 0),g(this,"isLoaded",void 0),g(this,"persistent",void 0),g(this,"_loadCount",0),g(this,"_subscribers",new Set),g(this,"_data",void 0),g(this,"_loader",void 0),g(this,"_error",void 0),g(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=is(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class F6{constructor({gl:e,protocol:n}){g(this,"protocol",void 0),g(this,"_context",void 0),g(this,"_resources",void 0),g(this,"_consumers",void 0),g(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new O6(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},c=a.resourceId&&this._resources[a.resourceId];c&&(c.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const D6=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Ys={name:"project32",dependencies:[qd],vs:D6},qs={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...X4},N6=[qd],k6=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function U6(t){const e=Sc.getDefaultProgramManager(t);for(const n of N6)e.addDefaultModule(n);for(const n of k6)e.addShaderHook(n);return e}const G6="layerManager.setLayers",z6="layerManager.activateViewport";class H6{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){g(this,"layers",void 0),g(this,"context",void 0),g(this,"resourceManager",void 0),g(this,"_lastRenderedLayers",[]),g(this,"_needsRedraw",!1),g(this,"_needsUpdate",!1),g(this,"_nextLayers",null),g(this,"_debug",!1),g(this,"activateViewport",o=>{pn(z6,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new F6({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&U6(e),stats:r||new n_({id:"deck.gl"}),viewport:i||new Vo({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new UM,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){pn(G6,this,n,e),this._lastRenderedLayers=e;const r=T_(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?de.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&de.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=pa.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=pa.MATCHED,n!==e&&(e.lifecycle=pa.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=pa.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=pa.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function ri(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!ri(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!ri(t[s],e[s],n-1))return!1;return!0}return!1}class j6{constructor(e){g(this,"width",void 0),g(this,"height",void 0),g(this,"views",void 0),g(this,"viewState",void 0),g(this,"controllers",void 0),g(this,"timeline",void 0),g(this,"_viewports",void 0),g(this,"_viewportMap",void 0),g(this,"_isUpdating",void 0),g(this,"_needsRedraw",void 0),g(this,"_needsUpdate",void 0),g(this,"_eventManager",void 0),g(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=T_(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!ri(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):de.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let c=n[s.id];const l=!!s.controller;l&&!c&&(r=!0),(r||!l)&&c&&(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,o,a,c),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const V6=/([0-9]+\.?[0-9]*)(%|px)/;function vs(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=V6.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function ys(t,e){return t.relative?Math.round(t.position*e):t.position}function Kt(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class hc{constructor(e){g(this,"id",void 0),g(this,"viewportInstance",void 0),g(this,"_x",void 0),g(this,"_y",void 0),g(this,"_width",void 0),g(this,"_height",void 0),g(this,"_padding",void 0),g(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:c}=e||{};Kt(!c||c instanceof Vo),this.viewportInstance=c,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=vs(r),this._y=vs(i),this._width=vs(s),this._height=vs(o),this._padding=a&&{left:vs(a.left||0),right:vs(a.right||0),top:vs(a.top||0),bottom:vs(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&ri(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:ys(this._x,e),y:ys(this._y,n),width:ys(this._width,e),height:ys(this._height,n)};return this._padding&&(r.padding={left:ys(this._padding.left,e),top:ys(this._padding.top,n),right:ys(this._padding.right,e),bottom:ys(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Eu{constructor(e){g(this,"_inProgress",void 0),g(this,"_handle",void 0),g(this,"_timeline",void 0),g(this,"time",void 0),g(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const vE=()=>{},G0={BREAK:1,SNAP_TO_END:2,IGNORE:3},W6=t=>t,$6=G0.BREAK;class X6{constructor(e){g(this,"getControllerState",void 0),g(this,"props",void 0),g(this,"propsInTransition",void 0),g(this,"transition",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:c}}=n,l=c(r/a),u=i.interpolateProps(s,o,l);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Eu(e.timeline),this.onViewStateChange=e.onViewStateChange||vE,this.onStateChange=e.onStateChange||vE}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===G0.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===G0.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const c={duration:o,easing:n.transitionEasing||W6,interpolator:s,interruption:n.transitionInterruption||$6,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class J6{constructor(e){g(this,"_propsToCompare",void 0),g(this,"_propsToExtract",void 0),g(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!ci(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Kt(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const K6=["longitude","latitude","zoom","bearing","pitch"],Y6=["longitude","latitude","zoom"];class QM extends J6{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:K6,required:Y6},super(r.transitionProps),g(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),c=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(c),aroundPosition:c,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Qh(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Qh(e.around,n.around,r)))}return i}}const _s={transitionDuration:0},q6=300,ff=t=>1-(1-t)*(1-t),aa={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},ro={};class Q6{constructor(e){g(this,"props",void 0),g(this,"state",{}),g(this,"transitionManager",void 0),g(this,"eventManager",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"makeViewport",void 0),g(this,"_controllerState",void 0),g(this,"_events",{}),g(this,"_interactionState",{isDragging:!1}),g(this,"_customEvents",[]),g(this,"_eventStartBlocked",null),g(this,"_panMove",!1),g(this,"invertPan",!1),g(this,"dragMode","rotate"),g(this,"inertia",0),g(this,"scrollZoom",!0),g(this,"dragPan",!0),g(this,"dragRotate",!0),g(this,"doubleClickZoom",!0),g(this,"touchZoom",!0),g(this,"touchRotate",!1),g(this,"keyboard",!0),this.transitionManager=new X6({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?q6:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:c=!1,keyboard:l=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(aa.WHEEL,u&&r),this.toggleEvents(aa.PAN,u),this.toggleEvents(aa.PINCH,u&&(a||c)),this.toggleEvents(aa.TRIPLE_PAN,u&&c),this.toggleEvents(aa.DOUBLE_TAP,u&&o),this.toggleEvents(aa.KEYBOARD,u&&l),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=c,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,_s,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,_s,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ff},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,_s,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ff},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,_s,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,_s,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:ff},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return ro._startPinchRotation=e.rotation,ro._lastPinchEvent=e,this.updateViewport(r,_s,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:ro._startPinchRotation-r})}return this.updateViewport(n,_s,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),ro._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=ro;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),c=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:c}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:ff},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return ro._startPinchRotation=null,ro._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let c;const l={};switch(e.srcEvent.code){case"Minus":c=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),l.isZooming=!0;break;case"Equal":c=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),l.isZooming=!0;break;case"ArrowLeft":n?(c=a.rotateLeft(s),l.isRotating=!0):(c=a.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":n?(c=a.rotateRight(s),l.isRotating=!0):(c=a.moveRight(i),l.isPanning=!0);break;case"ArrowUp":n?(c=a.rotateUp(o),l.isRotating=!0):(c=a.moveUp(i),l.isPanning=!0);break;case"ArrowDown":n?(c=a.rotateDown(o),l.isRotating=!0):(c=a.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),l),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?_s:e?{...n,transitionInterpolator:new QM({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class Z6{constructor(e,n){g(this,"_viewportProps",void 0),g(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const yE=5,eH=1.2;class tH extends Z6{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:c=0,altitude:l=1.5,position:u=[0,0,0],maxZoom:f=20,minZoom:h=0,maxPitch:d=60,minPitch:p=0,startPanLngLat:y,startZoomLngLat:b,startRotatePos:v,startBearing:m,startPitch:_,startZoom:A,normalize:S=!0}=e;Kt(Number.isFinite(s)),Kt(Number.isFinite(i)),Kt(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:c,altitude:l,maxZoom:f,minZoom:h,maxPitch:d,minPitch:p,normalize:S,position:u},{startPanLngLat:y,startZoomLngLat:b,startRotatePos:v,startBearing:m,startPitch:_,startZoom:A}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=i+Math.log2(r);c=ti(c,a,o);const l=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...l.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=ti(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=ti(a,o,s);const{normalize:c=!0}=e;return c&&Object.assign(e,a6(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],c=n[1],{width:l,height:u}=this.getViewportProps(),f=s/l;let h=0;o>0?Math.abs(u-c)>yE&&(h=o/(c-u)*eH):o<0&&c>yE&&(h=1-a/c),h=ti(h,-1,1);const{minPitch:d,maxPitch:p}=this.getViewportProps(),y=i+180*f;let b=r;return h>0?b=r+h*(p-r):h<0&&(b=r-h*(d-r)),{pitch:b,bearing:y}}}class nH extends Q6{constructor(...e){super(...e),g(this,"ControllerState",tH),g(this,"transition",{transitionDuration:300,transitionInterpolator:new QM({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),g(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class ZM extends hc{get ViewportType(){return Bo}get ControllerType(){return nH}}g(ZM,"displayName","MapView");const rH=new KM;function iH(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class sH{constructor(){g(this,"effects",void 0),g(this,"_resolvedEffects",[]),g(this,"_defaultEffects",[]),g(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>iH(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(ri(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof KM)||this._resolvedEffects.push(rH),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class oH extends Yd{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const aH="deckRenderer.renderLayers";class cH{constructor(e){g(this,"gl",void 0),g(this,"layerFilter",void 0),g(this,"drawPickingColors",void 0),g(this,"drawLayersPass",void 0),g(this,"pickLayersPass",void 0),g(this,"renderCount",void 0),g(this,"_needsRedraw",void 0),g(this,"renderBuffers",void 0),g(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new oH(e),this.pickLayersPass=new E_(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||Et.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,pn(aH,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Et(this.gl),new Et(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const lH={pickedColor:null,pickedObjectIndex:-1};function uH({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:c,height:l}=s;let u=i*i,f=-1,h=0;for(let d=0;d<l;d++){const p=d+a-r,y=p*p;if(y>u)h+=4*c;else for(let b=0;b<c;b++){if(t[h+3]-1>=0){const m=b+o-n,_=m*m+y;_<=u&&(u=_,f=h)}h+=4}}if(f>=0){const d=t.slice(f,f+4),p=e(d);if(p){const y=Math.floor(f/4/c),b=f/4-y*c;return{...p,pickedColor:d,pickedX:o+b,pickedY:a+y}}de.error("Picked non-existent layer. Is picking buffer corrupt?")()}return lH}function fH({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):de.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function eR({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=dH((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const c=[r-o.x,i-o.y];s!==void 0&&(c[2]=s),a=o.unproject(c)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function hH(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,c=o?[o]:[];if(r==="hover"){const f=n.index,h=n.layerId,d=o?o.props.id:null;if(d!==h||a!==f){if(d!==h){const p=i.find(y=>y.props.id===h);p&&c.unshift(p)}n.layerId=d,n.index=a,n.info=null}}const l=eR(t),u=new Map;return u.set(null,l),c.forEach(f=>{let h={...l};f===o&&(h.color=s,h.index=a,h.picked=!0),h=tR({layer:f,info:h,mode:r});const d=h.layer;f===o&&r==="hover"&&(n.info=h),u.set(d.id,h),r==="hover"&&d.updateAutoHighlight(h)}),u}function tR({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function dH(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class gH{constructor(e){g(this,"gl",void 0),g(this,"pickingFBO",void 0),g(this,"depthFBO",void 0),g(this,"pickLayersPass",void 0),g(this,"layerFilter",void 0),g(this,"lastPickedInfo",void 0),g(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new E_(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,c=o?r.find(h=>h.id===o):null,l=a&&i.find(h=>h.id===a)||i[0],u=l&&l.unproject([e-l.x,n-l.y]);return{...s,...{x:e,y:n,viewport:l,coordinate:u,layer:c}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Et(r),Et.isSupported(r,{colorBufferFloat:!0}))){const i=new Et(r);i.attach({36064:new on(r,{format:_e(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:c="query",unproject3D:l,onViewportActive:u,effects:f}){const h=this._getPickable(e),d=oc(this.gl);if(!h)return{result:[],emptyInfo:eR({viewports:r,x:i,y:s,pixelRatio:d})};this._resizeBuffer();const p=pp(this.gl,[i,s],!0),y=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],b=Math.round(o*d),{width:v,height:m}=this.pickingFBO,_=this._getPickingRect({deviceX:y[0],deviceY:y[1],deviceRadius:b,deviceWidth:v,deviceHeight:m}),A={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let S;const w=[],x=new Set;for(let M=0;M<a;M++){let L;if(_){const I=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:u,deviceRect:_,cullRect:A,effects:f,pass:"picking:".concat(c)});L=uH({...I,deviceX:y[0],deviceY:y[1],deviceRadius:b,deviceRect:_})}else L={pickedColor:null,pickedObjectIndex:-1};let R;if(L.pickedLayer&&l&&this.depthFBO){const{pickedColors:I}=this._drawAndSample({layers:[L.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:L.pickedX,y:L.pickedY,width:1,height:1},cullRect:A,effects:f,pass:"picking:".concat(c,":z")},!0);I[3]&&(R=I[0])}L.pickedLayer&&M+1<a&&(x.add(L.pickedLayer),L.pickedLayer.disablePickingIndex(L.pickedObjectIndex)),S=hH({pickInfo:L,lastPickedInfo:this.lastPickedInfo,mode:c,layers:h,viewports:r,x:i,y:s,z:R,pixelRatio:d});for(const I of S.values())I.layer&&w.push(I);if(!L.pickedColor)break}for(const M of x)M.restorePickingColors();return{result:w,emptyInfo:S.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:c="query",maxObjects:l=null,onViewportActive:u,effects:f}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const d=oc(this.gl),p=pp(this.gl,[i,s],!0),y=p.x,b=p.y+p.height,v=pp(this.gl,[i+o,s+a],!0),m=v.x+v.width,_=v.y,A={x:y,y:_,width:m-y,height:b-_},S=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:u,deviceRect:A,cullRect:{x:i,y:s,width:o,height:a},effects:f,pass:"picking:".concat(c)}),w=fH(S),x=new Map,M=Number.isFinite(l);for(let L=0;L<w.length&&!(M&&l&&x.size>=l);L++){const R=w[L];let I={color:R.pickedColor,layer:null,index:R.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:d};I=tR({layer:R.pickedLayer,info:I,mode:c}),x.has(I.object)||x.set(I.object,I)}return Array.from(x.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:c},l=!1){const u=l?this.depthFBO:this.pickingFBO,f={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:c,pickZ:l,preRenderStats:{}};for(const m of a)m.useInPicking&&(f.preRenderStats[m.id]=m.preRender(this.gl,f));const{decodePickingColor:h}=this.pickLayersPass.render(f),{x:d,y:p,width:y,height:b}=s,v=new(l?Float32Array:Uint8Array)(y*b*4);return Kd(u,{sourceX:d,sourceY:p,sourceWidth:y,sourceHeight:b,target:v}),{pickedColors:v,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),c=Math.min(i,e+r+1)-o,l=Math.min(s,n+r+1)-a;return c<=0||l<=0?null:{x:o,y:a,width:c,height:l}}}const pH={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};let mH=class{constructor(e){g(this,"el",null),g(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,pH),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}};var nR={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",c=Math.round,l=Math.abs,u=Date.now;function f(T,C,P){return setTimeout(_(T,P),C)}function h(T,C,P){return Array.isArray(T)?(d(T,P[C],P),!0):!1}function d(T,C,P){var O;if(T)if(T.forEach)T.forEach(C,P);else if(T.length!==i)for(O=0;O<T.length;)C.call(P,T[O],O,T),O++;else for(O in T)T.hasOwnProperty(O)&&C.call(P,T[O],O,T)}function p(T,C,P){var O="DEPRECATED METHOD: "+C+`
`+P+` AT 
`;return function(){var G=new Error("get-stack-trace"),X=G&&G.stack?G.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ge=e.console&&(e.console.warn||e.console.log);return ge&&ge.call(e.console,O,X),T.apply(this,arguments)}}var y;typeof Object.assign!="function"?y=function(C){if(C===i||C===null)throw new TypeError("Cannot convert undefined or null to object");for(var P=Object(C),O=1;O<arguments.length;O++){var G=arguments[O];if(G!==i&&G!==null)for(var X in G)G.hasOwnProperty(X)&&(P[X]=G[X])}return P}:y=Object.assign;var b=p(function(C,P,O){for(var G=Object.keys(P),X=0;X<G.length;)(!O||O&&C[G[X]]===i)&&(C[G[X]]=P[G[X]]),X++;return C},"extend","Use `assign`."),v=p(function(C,P){return b(C,P,!0)},"merge","Use `assign`.");function m(T,C,P){var O=C.prototype,G;G=T.prototype=Object.create(O),G.constructor=T,G._super=O,P&&y(G,P)}function _(T,C){return function(){return T.apply(C,arguments)}}function A(T,C){return typeof T==a?T.apply(C&&C[0]||i,C):T}function S(T,C){return T===i?C:T}function w(T,C,P){d(R(C),function(O){T.addEventListener(O,P,!1)})}function x(T,C,P){d(R(C),function(O){T.removeEventListener(O,P,!1)})}function M(T,C){for(;T;){if(T==C)return!0;T=T.parentNode}return!1}function L(T,C){return T.indexOf(C)>-1}function R(T){return T.trim().split(/\s+/g)}function I(T,C,P){if(T.indexOf&&!P)return T.indexOf(C);for(var O=0;O<T.length;){if(P&&T[O][P]==C||!P&&T[O]===C)return O;O++}return-1}function N(T){return Array.prototype.slice.call(T,0)}function k(T,C,P){for(var O=[],G=[],X=0;X<T.length;){var ge=C?T[X][C]:T[X];I(G,ge)<0&&O.push(T[X]),G[X]=ge,X++}return P&&(C?O=O.sort(function(gt,Nt){return gt[C]>Nt[C]}):O=O.sort()),O}function z(T,C){for(var P,O,G=C[0].toUpperCase()+C.slice(1),X=0;X<s.length;){if(P=s[X],O=P?P+G:C,O in T)return O;X++}return i}var $=1;function V(){return $++}function U(T){var C=T.ownerDocument||T;return C.defaultView||C.parentWindow||e}var F=/mobile|tablet|ip(ad|hone|od)|android/i,D="ontouchstart"in e,W=z(e,"PointerEvent")!==i,ee=D&&F.test(navigator.userAgent),te="touch",pe="pen",Ae="mouse",we="kinect",be=25,ie=1,he=2,se=4,me=8,Ie=1,Xe=2,De=4,Be=8,xe=16,Pe=Xe|De,Ne=Be|xe,ue=Pe|Ne,ae=["x","y"],ce=["clientX","clientY"];function ne(T,C){var P=this;this.manager=T,this.callback=C,this.element=T.element,this.target=T.options.inputTarget,this.domHandler=function(O){A(T.options.enable,[T])&&P.handler(O)},this.init()}ne.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(U(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(U(this.element),this.evWin,this.domHandler)}};function nt(T){var C,P=T.options.inputClass;return P?C=P:W?C=fe:ee?C=ln:D?C=Gr:C=st,new C(T,ft)}function ft(T,C,P){var O=P.pointers.length,G=P.changedPointers.length,X=C&ie&&O-G===0,ge=C&(se|me)&&O-G===0;P.isFirst=!!X,P.isFinal=!!ge,X&&(T.session={}),P.eventType=C,Fi(T,P),T.emit("hammer.input",P),T.recognize(P),T.session.prevInput=P}function Fi(T,C){var P=T.session,O=C.pointers,G=O.length;P.firstInput||(P.firstInput=gr(C)),G>1&&!P.firstMultiple?P.firstMultiple=gr(C):G===1&&(P.firstMultiple=!1);var X=P.firstInput,ge=P.firstMultiple,Qe=ge?ge.center:X.center,gt=C.center=jt(O);C.timeStamp=u(),C.deltaTime=C.timeStamp-X.timeStamp,C.angle=Ct(Qe,gt),C.distance=St(Qe,gt),kr(P,C),C.offsetDirection=Vt(C.deltaX,C.deltaY);var Nt=Ot(C.deltaTime,C.deltaX,C.deltaY);C.overallVelocityX=Nt.x,C.overallVelocityY=Nt.y,C.overallVelocity=l(Nt.x)>l(Nt.y)?Nt.x:Nt.y,C.scale=ge?ht(ge.pointers,O):1,C.rotation=ge?an(ge.pointers,O):0,C.maxPointers=P.prevInput?C.pointers.length>P.prevInput.maxPointers?C.pointers.length:P.prevInput.maxPointers:C.pointers.length,Tt(P,C);var On=T.element;M(C.srcEvent.target,On)&&(On=C.srcEvent.target),C.target=On}function kr(T,C){var P=C.center,O=T.offsetDelta||{},G=T.prevDelta||{},X=T.prevInput||{};(C.eventType===ie||X.eventType===se)&&(G=T.prevDelta={x:X.deltaX||0,y:X.deltaY||0},O=T.offsetDelta={x:P.x,y:P.y}),C.deltaX=G.x+(P.x-O.x),C.deltaY=G.y+(P.y-O.y)}function Tt(T,C){var P=T.lastInterval||C,O=C.timeStamp-P.timeStamp,G,X,ge,Qe;if(C.eventType!=me&&(O>be||P.velocity===i)){var gt=C.deltaX-P.deltaX,Nt=C.deltaY-P.deltaY,On=Ot(O,gt,Nt);X=On.x,ge=On.y,G=l(On.x)>l(On.y)?On.x:On.y,Qe=Vt(gt,Nt),T.lastInterval=C}else G=P.velocity,X=P.velocityX,ge=P.velocityY,Qe=P.direction;C.velocity=G,C.velocityX=X,C.velocityY=ge,C.direction=Qe}function gr(T){for(var C=[],P=0;P<T.pointers.length;)C[P]={clientX:c(T.pointers[P].clientX),clientY:c(T.pointers[P].clientY)},P++;return{timeStamp:u(),pointers:C,center:jt(C),deltaX:T.deltaX,deltaY:T.deltaY}}function jt(T){var C=T.length;if(C===1)return{x:c(T[0].clientX),y:c(T[0].clientY)};for(var P=0,O=0,G=0;G<C;)P+=T[G].clientX,O+=T[G].clientY,G++;return{x:c(P/C),y:c(O/C)}}function Ot(T,C,P){return{x:C/T||0,y:P/T||0}}function Vt(T,C){return T===C?Ie:l(T)>=l(C)?T<0?Xe:De:C<0?Be:xe}function St(T,C,P){P||(P=ae);var O=C[P[0]]-T[P[0]],G=C[P[1]]-T[P[1]];return Math.sqrt(O*O+G*G)}function Ct(T,C,P){P||(P=ae);var O=C[P[0]]-T[P[0]],G=C[P[1]]-T[P[1]];return Math.atan2(G,O)*180/Math.PI}function an(T,C){return Ct(C[1],C[0],ce)+Ct(T[1],T[0],ce)}function ht(T,C){return St(C[0],C[1],ce)/St(T[0],T[1],ce)}var it={mousedown:ie,mousemove:he,mouseup:se},qt="mousedown",pr="mousemove mouseup";function st(){this.evEl=qt,this.evWin=pr,this.pressed=!1,ne.apply(this,arguments)}m(st,ne,{handler:function(C){var P=it[C.type];P&ie&&C.button===0&&(this.pressed=!0),P&he&&C.which!==1&&(P=se),this.pressed&&(P&se&&(this.pressed=!1),this.callback(this.manager,P,{pointers:[C],changedPointers:[C],pointerType:Ae,srcEvent:C}))}});var wt={pointerdown:ie,pointermove:he,pointerup:se,pointercancel:me,pointerout:me},He={2:te,3:pe,4:Ae,5:we},In="pointerdown",An="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(In="MSPointerDown",An="MSPointerMove MSPointerUp MSPointerCancel");function fe(){this.evEl=In,this.evWin=An,ne.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}m(fe,ne,{handler:function(C){var P=this.store,O=!1,G=C.type.toLowerCase().replace("ms",""),X=wt[G],ge=He[C.pointerType]||C.pointerType,Qe=ge==te,gt=I(P,C.pointerId,"pointerId");X&ie&&(C.button===0||Qe)?gt<0&&(P.push(C),gt=P.length-1):X&(se|me)&&(O=!0),!(gt<0)&&(P[gt]=C,this.callback(this.manager,X,{pointers:P,changedPointers:[C],pointerType:ge,srcEvent:C}),O&&P.splice(gt,1))}});var oe={touchstart:ie,touchmove:he,touchend:se,touchcancel:me},qe="touchstart",je="touchstart touchmove touchend touchcancel";function cn(){this.evTarget=qe,this.evWin=je,this.started=!1,ne.apply(this,arguments)}m(cn,ne,{handler:function(C){var P=oe[C.type];if(P===ie&&(this.started=!0),!!this.started){var O=mr.call(this,C,P);P&(se|me)&&O[0].length-O[1].length===0&&(this.started=!1),this.callback(this.manager,P,{pointers:O[0],changedPointers:O[1],pointerType:te,srcEvent:C})}}});function mr(T,C){var P=N(T.touches),O=N(T.changedTouches);return C&(se|me)&&(P=k(P.concat(O),"identifier",!0)),[P,O]}var En={touchstart:ie,touchmove:he,touchend:se,touchcancel:me},Ft="touchstart touchmove touchend touchcancel";function ln(){this.evTarget=Ft,this.targetIds={},ne.apply(this,arguments)}m(ln,ne,{handler:function(C){var P=En[C.type],O=Ur.call(this,C,P);O&&this.callback(this.manager,P,{pointers:O[0],changedPointers:O[1],pointerType:te,srcEvent:C})}});function Ur(T,C){var P=N(T.touches),O=this.targetIds;if(C&(ie|he)&&P.length===1)return O[P[0].identifier]=!0,[P,P];var G,X,ge=N(T.changedTouches),Qe=[],gt=this.target;if(X=P.filter(function(Nt){return M(Nt.target,gt)}),C===ie)for(G=0;G<X.length;)O[X[G].identifier]=!0,G++;for(G=0;G<ge.length;)O[ge[G].identifier]&&Qe.push(ge[G]),C&(se|me)&&delete O[ge[G].identifier],G++;if(Qe.length)return[k(X.concat(Qe),"identifier",!0),Qe]}var un=2500,xt=25;function Gr(){ne.apply(this,arguments);var T=_(this.handler,this);this.touch=new ln(this.manager,T),this.mouse=new st(this.manager,T),this.primaryTouch=null,this.lastTouches=[]}m(Gr,ne,{handler:function(C,P,O){var G=O.pointerType==te,X=O.pointerType==Ae;if(!(X&&O.sourceCapabilities&&O.sourceCapabilities.firesTouchEvents)){if(G)di.call(this,P,O);else if(X&&zr.call(this,O))return;this.callback(C,P,O)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function di(T,C){T&ie?(this.primaryTouch=C.changedPointers[0].identifier,Tn.call(this,C)):T&(se|me)&&Tn.call(this,C)}function Tn(T){var C=T.changedPointers[0];if(C.identifier===this.primaryTouch){var P={x:C.clientX,y:C.clientY};this.lastTouches.push(P);var O=this.lastTouches,G=function(){var X=O.indexOf(P);X>-1&&O.splice(X,1)};setTimeout(G,un)}}function zr(T){for(var C=T.srcEvent.clientX,P=T.srcEvent.clientY,O=0;O<this.lastTouches.length;O++){var G=this.lastTouches[O],X=Math.abs(C-G.x),ge=Math.abs(P-G.y);if(X<=xt&&ge<=xt)return!0}return!1}var Oe=z(o.style,"touchAction"),ve=Oe!==i,le="compute",Je="auto",Se="manipulation",Dt="none",Ve="pan-x",dt="pan-y",Sn=vr();function gi(T,C){this.manager=T,this.set(C)}gi.prototype={set:function(T){T==le&&(T=this.compute()),ve&&this.manager.element.style&&Sn[T]&&(this.manager.element.style[Oe]=T),this.actions=T.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var T=[];return d(this.manager.recognizers,function(C){A(C.options.enable,[C])&&(T=T.concat(C.getTouchAction()))}),Di(T.join(" "))},preventDefaults:function(T){var C=T.srcEvent,P=T.offsetDirection;if(this.manager.session.prevented){C.preventDefault();return}var O=this.actions,G=L(O,Dt)&&!Sn[Dt],X=L(O,dt)&&!Sn[dt],ge=L(O,Ve)&&!Sn[Ve];if(G){var Qe=T.pointers.length===1,gt=T.distance<2,Nt=T.deltaTime<250;if(Qe&&gt&&Nt)return}if(!(ge&&X)&&(G||X&&P&Pe||ge&&P&Ne))return this.preventSrc(C)},preventSrc:function(T){this.manager.session.prevented=!0,T.preventDefault()}};function Di(T){if(L(T,Dt))return Dt;var C=L(T,Ve),P=L(T,dt);return C&&P?Dt:C||P?C?Ve:dt:L(T,Se)?Se:Je}function vr(){if(!ve)return!1;var T={},C=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(P){T[P]=C?e.CSS.supports("touch-action",P):!0}),T}var Ln=1,Qt=2,pi=4,fn=8,Zt=fn,Hr=16,Wt=32;function $t(T){this.options=y({},this.defaults,T||{}),this.id=V(),this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=Ln,this.simultaneous={},this.requireFail=[]}$t.prototype={defaults:{},set:function(T){return y(this.options,T),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(T){if(h(T,"recognizeWith",this))return this;var C=this.simultaneous;return T=Vr(T,this),C[T.id]||(C[T.id]=T,T.recognizeWith(this)),this},dropRecognizeWith:function(T){return h(T,"dropRecognizeWith",this)?this:(T=Vr(T,this),delete this.simultaneous[T.id],this)},requireFailure:function(T){if(h(T,"requireFailure",this))return this;var C=this.requireFail;return T=Vr(T,this),I(C,T)===-1&&(C.push(T),T.requireFailure(this)),this},dropRequireFailure:function(T){if(h(T,"dropRequireFailure",this))return this;T=Vr(T,this);var C=I(this.requireFail,T);return C>-1&&this.requireFail.splice(C,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(T){return!!this.simultaneous[T.id]},emit:function(T){var C=this,P=this.state;function O(G){C.manager.emit(G,T)}P<fn&&O(C.options.event+jr(P)),O(C.options.event),T.additionalEvent&&O(T.additionalEvent),P>=fn&&O(C.options.event+jr(P))},tryEmit:function(T){if(this.canEmit())return this.emit(T);this.state=Wt},canEmit:function(){for(var T=0;T<this.requireFail.length;){if(!(this.requireFail[T].state&(Wt|Ln)))return!1;T++}return!0},recognize:function(T){var C=y({},T);if(!A(this.options.enable,[this,C])){this.reset(),this.state=Wt;return}this.state&(Zt|Hr|Wt)&&(this.state=Ln),this.state=this.process(C),this.state&(Qt|pi|fn|Hr)&&this.tryEmit(C)},process:function(T){},getTouchAction:function(){},reset:function(){}};function jr(T){return T&Hr?"cancel":T&fn?"end":T&pi?"move":T&Qt?"start":""}function mi(T){return T==xe?"down":T==Be?"up":T==Xe?"left":T==De?"right":""}function Vr(T,C){var P=C.manager;return P?P.get(T):T}function Xt(){$t.apply(this,arguments)}m(Xt,$t,{defaults:{pointers:1},attrTest:function(T){var C=this.options.pointers;return C===0||T.pointers.length===C},process:function(T){var C=this.state,P=T.eventType,O=C&(Qt|pi),G=this.attrTest(T);return O&&(P&me||!G)?C|Hr:O||G?P&se?C|fn:C&Qt?C|pi:Qt:Wt}});function Bn(){Xt.apply(this,arguments),this.pX=null,this.pY=null}m(Bn,Xt,{defaults:{event:"pan",threshold:10,pointers:1,direction:ue},getTouchAction:function(){var T=this.options.direction,C=[];return T&Pe&&C.push(dt),T&Ne&&C.push(Ve),C},directionTest:function(T){var C=this.options,P=!0,O=T.distance,G=T.direction,X=T.deltaX,ge=T.deltaY;return G&C.direction||(C.direction&Pe?(G=X===0?Ie:X<0?Xe:De,P=X!=this.pX,O=Math.abs(T.deltaX)):(G=ge===0?Ie:ge<0?Be:xe,P=ge!=this.pY,O=Math.abs(T.deltaY))),T.direction=G,P&&O>C.threshold&&G&C.direction},attrTest:function(T){return Xt.prototype.attrTest.call(this,T)&&(this.state&Qt||!(this.state&Qt)&&this.directionTest(T))},emit:function(T){this.pX=T.deltaX,this.pY=T.deltaY;var C=mi(T.direction);C&&(T.additionalEvent=this.options.event+C),this._super.emit.call(this,T)}});function Qs(){Xt.apply(this,arguments)}m(Qs,Xt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Dt]},attrTest:function(T){return this._super.attrTest.call(this,T)&&(Math.abs(T.scale-1)>this.options.threshold||this.state&Qt)},emit:function(T){if(T.scale!==1){var C=T.scale<1?"in":"out";T.additionalEvent=this.options.event+C}this._super.emit.call(this,T)}});function fs(){$t.apply(this,arguments),this._timer=null,this._input=null}m(fs,$t,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Je]},process:function(T){var C=this.options,P=T.pointers.length===C.pointers,O=T.distance<C.threshold,G=T.deltaTime>C.time;if(this._input=T,!O||!P||T.eventType&(se|me)&&!G)this.reset();else if(T.eventType&ie)this.reset(),this._timer=f(function(){this.state=Zt,this.tryEmit()},C.time,this);else if(T.eventType&se)return Zt;return Wt},reset:function(){clearTimeout(this._timer)},emit:function(T){this.state===Zt&&(T&&T.eventType&se?this.manager.emit(this.options.event+"up",T):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function Zs(){Xt.apply(this,arguments)}m(Zs,Xt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Dt]},attrTest:function(T){return this._super.attrTest.call(this,T)&&(Math.abs(T.rotation)>this.options.threshold||this.state&Qt)}});function hs(){Xt.apply(this,arguments)}m(hs,Xt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Pe|Ne,pointers:1},getTouchAction:function(){return Bn.prototype.getTouchAction.call(this)},attrTest:function(T){var C=this.options.direction,P;return C&(Pe|Ne)?P=T.overallVelocity:C&Pe?P=T.overallVelocityX:C&Ne&&(P=T.overallVelocityY),this._super.attrTest.call(this,T)&&C&T.offsetDirection&&T.distance>this.options.threshold&&T.maxPointers==this.options.pointers&&l(P)>this.options.velocity&&T.eventType&se},emit:function(T){var C=mi(T.offsetDirection);C&&this.manager.emit(this.options.event+C,T),this.manager.emit(this.options.event,T)}});function ds(){$t.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}m(ds,$t,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Se]},process:function(T){var C=this.options,P=T.pointers.length===C.pointers,O=T.distance<C.threshold,G=T.deltaTime<C.time;if(this.reset(),T.eventType&ie&&this.count===0)return this.failTimeout();if(O&&G&&P){if(T.eventType!=se)return this.failTimeout();var X=this.pTime?T.timeStamp-this.pTime<C.interval:!0,ge=!this.pCenter||St(this.pCenter,T.center)<C.posThreshold;this.pTime=T.timeStamp,this.pCenter=T.center,!ge||!X?this.count=1:this.count+=1,this._input=T;var Qe=this.count%C.taps;if(Qe===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=Zt,this.tryEmit()},C.interval,this),Qt):Zt}return Wt},failTimeout:function(){return this._timer=f(function(){this.state=Wt},this.options.interval,this),Wt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Zt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Yn(T,C){return C=C||{},C.recognizers=S(C.recognizers,Yn.defaults.preset),new to(T,C)}Yn.VERSION="2.0.7",Yn.defaults={domEvents:!1,touchAction:le,enable:!0,inputTarget:null,inputClass:null,preset:[[Zs,{enable:!1}],[Qs,{enable:!1},["rotate"]],[hs,{direction:Pe}],[Bn,{direction:Pe},["swipe"]],[ds],[ds,{event:"doubletap",taps:2},["tap"]],[fs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var xc=1,eo=2;function to(T,C){this.options=y({},Yn.defaults,C||{}),this.options.inputTarget=this.options.inputTarget||T,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=T,this.input=nt(this),this.touchAction=new gi(this,this.options.touchAction),qo(this,!0),d(this.options.recognizers,function(P){var O=this.add(new P[0](P[1]));P[2]&&O.recognizeWith(P[2]),P[3]&&O.requireFailure(P[3])},this)}to.prototype={set:function(T){return y(this.options,T),T.touchAction&&this.touchAction.update(),T.inputTarget&&(this.input.destroy(),this.input.target=T.inputTarget,this.input.init()),this},stop:function(T){this.session.stopped=T?eo:xc},recognize:function(T){var C=this.session;if(!C.stopped){this.touchAction.preventDefaults(T);var P,O=this.recognizers,G=C.curRecognizer;(!G||G&&G.state&Zt)&&(G=C.curRecognizer=null);for(var X=0;X<O.length;)P=O[X],C.stopped!==eo&&(!G||P==G||P.canRecognizeWith(G))?P.recognize(T):P.reset(),!G&&P.state&(Qt|pi|fn)&&(G=C.curRecognizer=P),X++}},get:function(T){if(T instanceof $t)return T;for(var C=this.recognizers,P=0;P<C.length;P++)if(C[P].options.event==T)return C[P];return null},add:function(T){if(h(T,"add",this))return this;var C=this.get(T.options.event);return C&&this.remove(C),this.recognizers.push(T),T.manager=this,this.touchAction.update(),T},remove:function(T){if(h(T,"remove",this))return this;if(T=this.get(T),T){var C=this.recognizers,P=I(C,T);P!==-1&&(C.splice(P,1),this.touchAction.update())}return this},on:function(T,C){if(T!==i&&C!==i){var P=this.handlers;return d(R(T),function(O){P[O]=P[O]||[],P[O].push(C)}),this}},off:function(T,C){if(T!==i){var P=this.handlers;return d(R(T),function(O){C?P[O]&&P[O].splice(I(P[O],C),1):delete P[O]}),this}},emit:function(T,C){this.options.domEvents&&Qo(T,C);var P=this.handlers[T]&&this.handlers[T].slice();if(!(!P||!P.length)){C.type=T,C.preventDefault=function(){C.srcEvent.preventDefault()};for(var O=0;O<P.length;)P[O](C),O++}},destroy:function(){this.element&&qo(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function qo(T,C){var P=T.element;if(P.style){var O;d(T.options.cssProps,function(G,X){O=z(P.style,X),C?(T.oldCssProps[O]=P.style[O],P.style[O]=G):P.style[O]=T.oldCssProps[O]||""}),C||(T.oldCssProps={})}}function Qo(T,C){var P=n.createEvent("Event");P.initEvent(T,!0,!0),P.gesture=C,C.target.dispatchEvent(P)}y(Yn,{INPUT_START:ie,INPUT_MOVE:he,INPUT_END:se,INPUT_CANCEL:me,STATE_POSSIBLE:Ln,STATE_BEGAN:Qt,STATE_CHANGED:pi,STATE_ENDED:fn,STATE_RECOGNIZED:Zt,STATE_CANCELLED:Hr,STATE_FAILED:Wt,DIRECTION_NONE:Ie,DIRECTION_LEFT:Xe,DIRECTION_RIGHT:De,DIRECTION_UP:Be,DIRECTION_DOWN:xe,DIRECTION_HORIZONTAL:Pe,DIRECTION_VERTICAL:Ne,DIRECTION_ALL:ue,Manager:to,Input:ne,TouchAction:gi,TouchInput:ln,MouseInput:st,PointerEventInput:fe,TouchMouseInput:Gr,SingleTouchInput:cn,Recognizer:$t,AttrRecognizer:Xt,Tap:ds,Pan:Bn,Swipe:hs,Pinch:Qs,Rotate:Zs,Press:fs,on:w,off:x,each:d,merge:v,extend:b,assign:y,inherit:m,bindFn:_,prefixed:z});var Pc=typeof e<"u"?e:typeof self<"u"?self:{};Pc.Hammer=Yn,typeof i=="function"&&i.amd?i(function(){return Yn}):t.exports?t.exports=Yn:e[r]=Yn})(window,document,"Hammer")})(nR);var Tu=nR.exports;const vH=cu(Tu),_i=nw({__proto__:null,default:vH},[Tu]),rR=1,iR=2,z0=4,yH={mousedown:rR,mousemove:iR,mouseup:z0};function _H(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function bH(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(_H(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function AH(t){t.prototype.handler=function(n){let r=yH[n.type];r&rR&&n.button>=0&&(this.pressed=!0),r&iR&&n.which===0&&(r=z0),this.pressed&&(r&z0&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}bH(Tu.PointerEventInput);AH(Tu.MouseInput);const EH=Tu.Manager;class Zd{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const TH=_i?[[_i.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[_i.Rotate,{enable:!1}],[_i.Pinch,{enable:!1}],[_i.Swipe,{enable:!1}],[_i.Pan,{threshold:0,enable:!1}],[_i.Press,{enable:!1}],[_i.Tap,{event:"doubletap",taps:2,enable:!1}],[_i.Tap,{event:"anytap",enable:!1}],[_i.Tap,{enable:!1}]]:null,_E={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},SH={doubletap:["tap"]},CH={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},S_={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},wH={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},bE={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},xH=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Ia=typeof window<"u"?window:global;let H0=!1;try{const t={get passive(){return H0=!0,!0}};Ia.addEventListener("test",null,t),Ia.removeEventListener("test",null)}catch{H0=!1}const PH=xH.indexOf("firefox")!==-1,{WHEEL_EVENTS:MH}=S_,AE="wheel",EE=4.000244140625,RH=40,IH=.25;class LH extends Zd{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Ia.WheelEvent&&(PH&&i.deltaMode===Ia.WheelEvent.DOM_DELTA_PIXEL&&(s/=Ia.devicePixelRatio),i.deltaMode===Ia.WheelEvent.DOM_DELTA_LINE&&(s*=RH)),s!==0&&s%EE===0&&(s=Math.floor(s/EE)),i.shiftKey&&s&&(s=s*IH),this.callback({type:AE,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(MH),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,H0?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===AE&&(this.options.enable=n)}}const{MOUSE_EVENTS:BH}=S_,TE="pointermove",SE="pointerover",CE="pointerout",wE="pointerenter",xE="pointerleave";class OH extends Zd{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(BH),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===TE&&(this.enableMoveEvent=n),e===SE&&(this.enableOverEvent=n),e===CE&&(this.enableOutEvent=n),e===wE&&(this.enableEnterEvent=n),e===xE&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(SE,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(CE,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(wE,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(xE,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(TE,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:FH}=S_,PE="keydown",ME="keyup";class DH extends Zd{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:PE,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:ME,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(FH),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===PE&&(this.enableDownEvent=n),e===ME&&(this.enableUpEvent=n)}}const RE="contextmenu";class NH extends Zd{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:RE,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===RE&&(this.options.enable=n)}}const j0=1,od=2,V0=4,kH={pointerdown:j0,pointermove:od,pointerup:V0,mousedown:j0,mousemove:od,mouseup:V0},UH=1,GH=2,zH=3,HH=0,jH=1,VH=2,WH=1,$H=2,XH=4;function JH(t){const e=kH[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===V0||e===od&&!Number.isFinite(n)?(s=i===UH,o=i===GH,a=i===zH):e===od?(s=!!(n&WH),o=!!(n&XH),a=!!(n&$H)):e===j0&&(s=r===HH,o=r===jH,a=r===VH),{leftButton:s,middleButton:o,rightButton:a}}function KH(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Bp={srcElement:"root",priority:0};class YH{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let c=Bp;typeof r=="string"||r&&r.addEventListener?c={...Bp,srcElement:r}:r&&(c={...Bp,...r});let l=a.get(c.srcElement);l||(l=[],a.set(c.srcElement,l));const u={type:e,handler:n,srcElement:c.srcElement,priority:c.priority};i&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let f=l.length-1;for(;f>=0&&!(l[f].priority>=u.priority);)f--;l.splice(f+1,0,u)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let c=0;c<r.length;c++){const{type:l,handler:u,once:f}=r[c];if(u({...e,type:l,stopPropagation:s,stopImmediatePropagation:o}),f&&a.push(r[c]),i)break}for(let c=0;c<a.length;c++){const{type:l,handler:u}=a[c];this.remove(l,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...JH(e),...KH(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const qH={events:null,recognizers:null,recognizerOptions:{},Manager:EH,touchAction:"none",tabIndex:0};class QH{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=CH[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...qH,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||TH}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(_E).forEach(i=>{const s=this.manager.get(i);s&&_E[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new LH(e,this._onOtherEvent,{enable:!1}),this.moveInput=new OH(e,this._onOtherEvent,{enable:!1}),this.keyInput=new DH(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new NH(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=SH[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const u in e)this._addEventHandler(u,e[u],r,i,s);return}const{manager:o,events:a}=this,c=bE[e]||e;let l=a.get(c);l||(l=new YH(this),a.set(c,l),l.recognizerName=wH[c]||c,o&&o.on(c,l.handleEvent)),l.add(e,n,r,i,s),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=bE[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const c of r.values())if(c.recognizerName===o&&!c.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function io(){}const ZH=({isDragging:t})=>t?"grabbing":"grab",sR={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:io,onResize:io,onViewStateChange:io,onInteractionStateChange:io,onBeforeRender:io,onAfterRender:io,onLoad:io,onError:t=>de.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:ZH,getTooltip:null,debug:!1,drawPickingColors:!1};class eg{constructor(e){g(this,"props",void 0),g(this,"width",0),g(this,"height",0),g(this,"userData",{}),g(this,"canvas",null),g(this,"viewManager",null),g(this,"layerManager",null),g(this,"effectManager",null),g(this,"deckRenderer",null),g(this,"deckPicker",null),g(this,"eventManager",null),g(this,"tooltip",null),g(this,"metrics",void 0),g(this,"animationLoop",void 0),g(this,"stats",void 0),g(this,"viewState",void 0),g(this,"cursorState",void 0),g(this,"_needsRedraw",void 0),g(this,"_pickRequest",void 0),g(this,"_lastPointerDownInfo",null),g(this,"_metricsCounter",void 0),g(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),g(this,"_onEvent",n=>{const r=uA[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,c=a&&(a[r.handler]||a.props[r.handler]),l=this.props[r.handler];let u=!1;c&&(u=c.call(a,o,n)),!u&&l&&l(o,n)}),g(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...sR,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&de.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),zP()==="IE"&&de.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new n_({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&fc.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,c;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(o=this.deckPicker)===null||o===void 0||o.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(c=this.tooltip)===null||c===void 0||c.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var l;(l=this.canvas.parentElement)===null||l===void 0||l.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&de.removed("onLayerHover","onHover")(),"onLayerClick"in e&&de.removed("onLayerClick","onClick")(),e.initialViewState&&!ri(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Kt(this.viewManager),this.viewManager.views}getViewports(e){return Kt(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Kt(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Kt(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var o,a;this.width=i,this.height=s,(o=this.viewManager)===null||o===void 0||o.setProps({width:i,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:c,onAfterRender:l,useDevicePixels:u}=e;return new wU({width:n,height:r,useDevicePixels:u,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:f=>JP({...s,...f,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:f=>this._setGLContext(f.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:c,onAfterRender:l,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new ZM({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,t_(e,{enable:!0,copyState:!0})),this.tooltip=new mH(this.canvas),ss(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new UM;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new QH(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in uA)this.eventManager.on(i,this._onEvent);this.viewManager=new j6({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new H6(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new sH,this.deckRenderer=new cH(e),this.deckPicker=new gH(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;ss(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),de.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=po.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}g(eg,"defaultProps",sR);g(eg,"VERSION",LD);class Op{constructor(e,n){g(this,"opts",void 0),g(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function ej(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function ah(t){return t.stride||t.size*t.bytesPerElement}function oR(t,e){e.offset&&de.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=ah(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function tj(t,e){const n=oR(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class nj{constructor(e,n,r){g(this,"gl",void 0),g(this,"id",void 0),g(this,"size",void 0),g(this,"settings",void 0),g(this,"value",void 0),g(this,"doublePrecision",void 0),g(this,"_buffer",void 0),g(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&s_(e,We.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let c=ej(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(c=Float32Array),this.value=null,this.settings={...n,defaultType:c,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ke(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*ah(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),fc.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=tj(this.getAccessor(),n||{});return r[e]=new Op(this,s.high),r["".concat(e,"64Low")]=i?new Op(this,s.low):new Float32Array(this.size),r}if(n){const r=oR(this.getAccessor(),n);return{[e]:new Op(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let c=0;c<s;)for(let l=0;l<i;l++){const u=n[c++];u<o[l]&&(o[l]=u),u>a[l]&&(a[l]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ke?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=ah(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=ah(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Rp(s,i));const c=s.byteLength+a+i.stride*2;o.byteLength<c&&o.reallocate(c),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Rp(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=fc.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?Rp(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&de.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const IE=[],LE=[];function Su(t,e=0,n=1/0){let r=IE;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(LE.length=t.length,r=LE):r=IE,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function aR(t){return t&&t[Symbol.asyncIterator]}function cR(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,c=r?r/a:n,l=i?i/a:0,u=Math.floor((t.length-l)/c);return(f,{index:h,target:d})=>{if(!s){const v=h*c+l;for(let m=0;m<n;m++)d[m]=t[v+m];return d}const p=s[h],y=s[h+1]||u;let b;if(o){b=new Array(y-p);for(let v=p;v<y;v++){const m=v*c+l;d=new Array(n);for(let _=0;_<n;_++)d[_]=t[m+_];b[v-p]=d}}else if(c===n)b=t.subarray(p*n+l,y*n+l);else{b=new t.constructor((y-p)*n);let v=0;for(let m=p;m<y;m++){const _=m*c+l;for(let A=0;A<n;A++)b[v++]=t[_+A]}}return b}}const rj=[],ch=[[0,1/0]];function ij(t,e){if(t===ch||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function Fp(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,c=o-r;if(a>c){n.set(e.subarray(0,c),r);return}if(n.set(e,r),!s)return;let l=a;for(;l<c;){const u=s(l,e);for(let f=0;f<i;f++)n[r+l]=u[f]||0,l++}}function sj({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Fp({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const c=r&&((u,f)=>r(u+a,f)),l=Math.min(i.length,s.length);for(let u=1;u<l;u++){const f=i[u]*n,h=s[u]*n;Fp({source:t.subarray(o,f),target:e,start:a,end:h,size:n,getData:c}),o=f,a=h}return a<e.length&&Fp({source:[],target:e,start:a,size:n,getData:c}),e}const oj={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function lR(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...oj[n],...e,...t,type:n}}function uR(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function fR(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function hR(t){t.push(t.shift())}function C_(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function dR({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,c=n.byteOffset,l=n.startIndices,u=i&&l,f=C_(n,e),h=n.isConstant;if(!u&&r>=f)return;const d=h?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!h){const v=s;s=(m,_)=>n.normalizeConstant(v(m,_))}const p=h?(v,m)=>s(d,m):(v,m)=>s(d.subarray(v,v+a),m),y=t.getData({length:r}),b=new Float32Array(f);sj({source:y,target:b,sourceStartIndices:i,targetStartIndices:l,size:a,getData:p}),t.byteLength<b.byteLength+c&&t.reallocate(b.byteLength+c),t.subData({data:b,offset:c})}class w_ extends nj{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:ch}),g(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return lR(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=ij(this.state.updateRanges,[r,i])}else this.state.updateRanges=ch}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=rj}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==ch),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[l,u]of s)o.call(i,this,{data:n,startRow:l,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[l,u]of s){const f=Number.isFinite(l)?this.getVertexOffset(l):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:h})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Kt(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=cR(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:c,value:l,size:u,startIndices:f}=e,{accessor:h,transform:d}=a,p=c.binaryAccessor||(typeof h=="function"?h:s[h]);Kt(typeof p=="function",'accessor "'.concat(h,'" is not a function'));let y=e.getVertexOffset(r);const{iterable:b,objectInfo:v}=Su(n,r,i);for(const m of b){v.index++;let _=p(m,v);if(d&&(_=d.call(this,_)),f){const A=(v.index<f.length-1?f[v.index+1]:o)-f[v.index];if(_&&Array.isArray(_[0])){let S=y;for(const w of _)e._normalizeValue(w,l,S),S+=u}else _&&_.length>u?l.set(_,y):(e._normalizeValue(_,v.target,0),B6({target:l,source:v.target,start:y,count:A}));y+=A*u}else e._normalizeValue(_,l,y),y+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class aj{constructor({gl:e,attribute:n,timeline:r}){g(this,"gl",void 0),g(this,"type","interpolation"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.transition=new Eu(r),this.attribute=n,this.attributeInTransition=new w_(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=lj(e,n);const i={byteLength:0,usage:35050};this.buffers=[new ke(e,i),new ke(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;hR(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)dR({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=C_(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:uR(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const cj=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function lj(t,e){const n=fR(e.size);return new b_(t,{vs:cj,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class uj{constructor({gl:e,attribute:n,timeline:r}){g(this,"gl",void 0),g(this,"type","spring"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"texture",void 0),g(this,"framebuffer",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Eu(r),this.attribute=n,this.attributeInTransition=new w_(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=hj(e),this.framebuffer=dj(e,this.texture),this.transform=fj(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new ke(e,i),new ke(e,i),new ke(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)dR({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=C_(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:uR(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),hR(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Kd(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function fj(t,e,n){const r=fR(e.size);return new b_(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function hj(t){return new on(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function dj(t,e){return new Et(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const gj={interpolation:aj,spring:uj};class pj{constructor(e,{id:n,timeline:r}){g(this,"id",void 0),g(this,"isSupported",void 0),g(this,"gl",void 0),g(this,"timeline",void 0),g(this,"transitions",void 0),g(this,"needsRedraw",void 0),g(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=b_.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){de.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=gj[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(de.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const BE="attributeManager.invalidate",mj="attributeManager.updateStart",vj="attributeManager.updateEnd",yj="attribute.updateStart",_j="attribute.allocate",bj="attribute.updateEnd";class Aj{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"attributes",void 0),g(this,"updateTriggers",void 0),g(this,"needsRedraw",void 0),g(this,"userData",void 0),g(this,"stats",void 0),g(this,"attributeTransitionManager",void 0),g(this,"mergeBoundsMemoized",Au(S6)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new pj(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);pn(BE,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);pn(BE,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let c=!1;pn(mj,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const l in this.attributes){const u=this.attributes[l],f=u.settings.accessor;u.startIndices=r,u.numInstances=n,s[l]&&de.removed("props.".concat(l),"data.attributes.".concat(l))(),u.setExternalBuffer(o[l])||u.setBinaryValue(typeof f=="string"?o[f]:void 0,e.startIndices)||typeof f=="string"&&!o[f]&&u.setConstantValue(s[f])||u.needsUpdate()&&(c=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}c&&pn(vj,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new w_(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(pn(yj,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&pn(_j,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,pn(bj,n,r))}}class Ej extends Eu{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Qh(n,r,o)}}const OE=1e-5;function FE(t,e,n,r,i){const s=e-t,a=(n-e)*i,c=-s*r;return a+c+s+e}function Tj(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=FE(t[o],e[o],n[o],r,i);return s}return FE(t,e,n,r,i)}function DE(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class Sj extends Eu{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=Tj(s,o,n,r,i);const c=DE(a,n),l=DE(a,o);c<OE&&l<OE&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const Cj={interpolation:Ej,spring:Sj};class wj{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const c=s.get(e),{value:l=c.settings.fromValue}=c;n=l,this.remove(e)}if(i=lR(i),!i)return;const o=Cj[i.type];if(!o){de.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function xj(t){const e=t[Hs];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function Pj(t,e){const n=gR({newProps:t,oldProps:e,propTypes:t[Hs],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=Rj(t,e);let i=!1;return r||(i=Ij(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Lj(t,e),transitionsChanged:Mj(t,e)}}function Mj(t,e){if(!t.transitions)return!1;const n={},r=t[Hs];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&W0(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function gR({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=W0(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=W0(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function W0(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function Rj(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function Ij(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&NE(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&NE(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function Lj(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function NE(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},gR({oldProps:i,newProps:r,triggerName:n})}const Bj="count(): argument not an object",Oj="count(): argument not a container";function Fj(t){if(!Nj(t))throw new Error(Bj);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Dj(t))return Object.keys(t).length;throw new Error(Oj)}function Dj(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function Nj(t){return t!==null&&typeof t=="object"}function kj(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const Uj={10241:9987,10240:9729,10242:33071,10243:33071},$0={};function Gj(t,e,n,r){if(n instanceof on)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new on(e,{...n,parameters:{...Uj,...i,...r}});return $0[s.id]=t,s}function zj(t,e){!e||!(e instanceof on)||$0[e.id]===t&&(e.delete(),delete $0[e.id])}const Hj={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||X0(t)&&(t.length===3||t.length===4)},equal(t,e,n){return ri(t,e,1)}},accessor:{validate(t,e){const n=ad(t);return n==="function"||n===ad(e.value)},equal(t,e,n){return typeof e=="function"?!0:ri(t,e,1)}},array:{validate(t,e){return e.optional&&!t||X0(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ri(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?ri(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:Gj(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{zj(n.id,t)}}};function jj(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=Vj(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function Vj(t,e){switch(ad(e)){case"object":return jc(t,e);case"array":return jc(t,{type:"array",value:e,compare:!1});case"boolean":return jc(t,{type:"boolean",value:e});case"number":return jc(t,{type:"number",value:e});case"function":return jc(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function jc(t,e){return"type"in e?{name:t,...Hj[e.type],...e}:"value"in e?{name:t,type:ad(e.value),...e}:{name:t,type:"object",value:e}}function X0(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function ad(t){return X0(t)?"array":t===null?"null":typeof t}function Wj(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=J0(t.constructor,n),i=Object.create(r);i[sd]=t,i[Oo]={},i[Ms]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const $j="_mergedDefaultProps";function J0(t,e){let n=$j;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=pR(t,n);return r||(t[n]=Xj(t,e||[]))}function Xj(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=J0(r),s=pR(t,"defaultProps")||{},o=jj(s),a=Object.assign(Object.create(null),i,o.defaultProps),c=Object.assign(Object.create(null),i==null?void 0:i[Hs],o.propTypes),l=Object.assign(Object.create(null),i==null?void 0:i[Lp],o.deprecatedProps);for(const u of e){const f=J0(u.constructor);f&&(Object.assign(a,f),Object.assign(c,f[Hs]),Object.assign(l,f[Lp]))}return Jj(a,t),Yj(a,c),Kj(a,l),a[Hs]=c,a[Lp]=l,e.length===0&&!x_(t,"_propTypes")&&(t._propTypes=c),a}function Jj(t,e){const n=Qj(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function Kj(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])x_(this,s)||(this[s]=r);de.deprecated(i,e[n].join("/"))()}})}function Yj(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=qj(o))}t[Xa]=n,t[Oo]={},Object.defineProperties(t,r)}function qj(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||aR(e)?this[Oo][t]=e:this[Ms][t]=e},get(){if(this[Ms]){if(t in this[Ms])return this[Ms][t]||this[Xa][t];if(t in this[Oo]){const e=this[sd]&&this[sd].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Xa][t]}}return this[Xa][t]}}}function x_(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function pR(t,e){return x_(t,e)&&t[e]}function Qj(t){const e=t.componentName;return e||de.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let Zj=0;class P_{constructor(...e){g(this,"id",void 0),g(this,"props",void 0),g(this,"count",void 0),this.props=Wj(this,e),this.id=this.props.id,this.count=Zj++}clone(e){const{props:n}=this,r={};for(const i in n[Xa])i in n[Ms]?r[i]=n[Ms][i]:i in n[Oo]&&(r[i]=n[Oo][i]);return new this.constructor({...n,...r,...e})}}g(P_,"componentName","Component");g(P_,"defaultProps",{});const e9=Object.freeze({});class t9{constructor(e){g(this,"component",void 0),g(this,"onAsyncPropUpdated",void 0),g(this,"asyncProps",void 0),g(this,"oldProps",void 0),g(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||e9}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[sd]||this.component;const n=e[Ms]||{},r=e[Oo]||e,i=e[Xa]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(aR(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:c}=this.component.props;c?s=c(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Hs];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class n9 extends t9{constructor({attributeManager:e,layer:n}){super(n),g(this,"attributeManager",void 0),g(this,"needsRedraw",void 0),g(this,"needsUpdate",void 0),g(this,"subLayers",void 0),g(this,"usesPickingColorCache",void 0),g(this,"hasPickingBuffer",void 0),g(this,"changeFlags",void 0),g(this,"viewport",void 0),g(this,"uniformTransitions",void 0),g(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const r9="layer.changeFlag",i9="layer.initialize",s9="layer.update",o9="layer.finalize",a9="layer.matched",kE=2**24-1,c9=Object.freeze([]),l9=Au(({oldViewport:t,viewport:e})=>t.equals(e));let bi=new Uint8ClampedArray(0);const u9={data:{type:"data",value:c9,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let c=o.contains(t);return!c&&!i&&(o.add({resourceId:t,data:is(t,r),persistent:!1}),c=!0),c?o.subscribe({resourceId:t,onChange:l=>{var u;return(u=n.internalState)===null||u===void 0?void 0:u.reloadAsyncProp(e,l)},consumerId:n.id,requestId:e}):is(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Te.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Fr extends P_{constructor(...e){super(...e),g(this,"internalState",null),g(this,"lifecycle",pa.NO_STATE),g(this,"context",void 0),g(this,"state",void 0),g(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Kt(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=YM(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=JM(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return Kt(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Kt(this.internalState);const r=this.internalState.viewport||this.context.viewport;return R6(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Te.DEFAULT||e===Te.LNGLAT||e===Te.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Kt(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Fj(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=kj(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:c}=n.attributes,l=a||c;l&&(o&&l.constant&&(l.constant=!1,n.invalidate(l.id)),!l.value&&!o&&(l.constant=!0,l.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!l9({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(bi.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>kE&&de.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),bi=fc.allocate(bi,n,{size:3,copy:!0,maxCount:Math.max(n,kE)});const i=Math.floor(bi.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),bi[o*3+0]=s[0],bi[o*3+1]=s[1],bi[o*3+2]=s[2]}e.value=bi.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,c=this.encodePickingColor(e);for(let l=0;l<n.length;l++){const u=s.getVertexOffset(l);a[u]===c[0]&&a[u+1]===c[1]&&a[u+2]===c[2]&&this._disablePickingIndex(l)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==bi.buffer&&(r.value=bi.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Kt(!this.internalState),Kt(Number.isFinite(this.props.coordinateSystem)),pn(i9,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new n9({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(de.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new wj(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){pn(a9,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(pn(s9,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),c=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const l=this.getModels()[0]!==c[0];this._postUpdate(a,l)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){pn(o9,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,c=a&&a(n)||[0,0];ss(s.gl,{polygonOffset:c}),Xn(s.gl,r,()=>{const l={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const u of this.props.extensions)u.draw.call(this,l,u);this.draw(l)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&pn(r9,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=Pj(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){xj(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Aj(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:c}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==c){const l={};o||(l.pickingSelectedColor=null),Array.isArray(c)&&(l.pickingHighlightColor=c),(n||a!==i.highlightedObjectIndex)&&(l.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(l)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}g(Fr,"defaultProps",u9);g(Fr,"layerName","Layer");const f9="compositeLayer.renderLayers";class tg extends Fr{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:d,positionFormat:p,modelMatrix:y,extensions:b,fetch:v,operation:m,_subLayerProps:_}=this.props,A={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:l,highlightColor:u,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:d,positionFormat:p,modelMatrix:y,extensions:b,fetch:v,operation:m},S=_&&e.id&&_[e.id],w=S&&S.updateTriggers,x=e.id||"sublayer";if(S){const M=this.props[Hs],L=e.type?e.type._propTypes:{};for(const R in S){const I=L[R]||M[R];I&&I.type==="accessor"&&(S[R]=this.getSubLayerAccessor(S[R]))}}Object.assign(A,e,S),A.id="".concat(this.props.id,"-").concat(x),A.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...w};for(const M of b){const L=M.getSubLayerProps.call(this,M);L&&Object.assign(A,L,{updateTriggers:Object.assign(A.updateTriggers,L.updateTriggers)})}return A}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=T_(s,Boolean),this.internalState.subLayers=r}pn(f9,this,i,r);for(const s of r)s.parent=this}}g(tg,"layerName","CompositeLayer");const h9=new Ee().lookAt({eye:[0,0,1]});function d9({width:t,height:e,near:n,far:r,padding:i}){let s=-t/2,o=t/2,a=-e/2,c=e/2;if(i){const{left:l=0,right:u=0,top:f=0,bottom:h=0}=i,d=ti((l+t-u)/2,0,t)-t/2,p=ti((f+e-h)/2,0,e)-e/2;s-=d,o-=d,a+=p,c+=p}return new Ee().ortho({left:s,right:o,bottom:a,top:c,near:n,far:r})}class g9 extends Vo{constructor(e){const{width:n,height:r,near:i=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:c=null,flipY:l=!0}=e,u=Array.isArray(o)?o[0]:o,f=Array.isArray(o)?o[1]:o,h=Math.min(u,f),d=Math.pow(2,h);let p;if(u!==f){const y=Math.pow(2,u),b=Math.pow(2,f);p={unitsPerMeter:[y/d,b/d,1],metersPerUnit:[d/y,d/b,1]}}super({...e,longitude:void 0,position:a,viewMatrix:h9.clone().scale([d,d*(l?-1:1),d]),projectionMatrix:d9({width:n||1,height:r||1,padding:c,near:i,far:s}),zoom:h,distanceScales:p})}projectFlat([e,n]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],n*r[1]]}unprojectFlat([e,n]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],n*r[1]]}panByPosition(e,n){const r=Qd(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Zh([],i,vM([],r)),o=Zh([],this.center,s);return{target:this.unprojectFlat(o)}}}class M_{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){g(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&ri(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],o=this.props[i];r[i]=o,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof o=="function"&&(r[i]=this.getSubLayerAccessor(o)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}g(M_,"defaultProps",{});g(M_,"extensionName","LayerExtension");class mR{constructor(e){g(this,"opts",void 0),g(this,"typedArrayManager",void 0),g(this,"indexStarts",[0]),g(this,"vertexStarts",[0]),g(this,"vertexCount",0),g(this,"instanceCount",0),g(this,"attributes",void 0),g(this,"_attributeDefs",void 0),g(this,"data",void 0),g(this,"getGeometry",void 0),g(this,"geometryBuffer",void 0),g(this,"buffers",void 0),g(this,"positionSize",void 0),g(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=fc,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:c=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=c,s&&(Kt(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),c||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(a))for(const l of a)this._rebuildGeometry(l);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?cR(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const c=s[a];c.copy=n,r[a]=o.allocate(r[a],e,c)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=Su(i,n,r);for(const c of o){a.index++;const l=s?s(c,a):null;e(l,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:c=1/0}=e||{},l={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((f,h)=>{const d=f&&this.normalizeGeometry(f);l[h]=d,r[h+1]=r[h]+(d?this.getGeometrySize(d):0)},a,c),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof ke){const f=o.accessor.stride||this.positionSize*4;i=i||o.byteLength/f}else if(o.buffer){const f=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/f}else if(o.value){const f=o.value,h=o.stride/f.BYTES_PER_ELEMENT||this.positionSize;i=i||f.length/h}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const u={};this._forEachGeometry((f,h)=>{const d=l[h]||f;u.vertexStart=r[h],u.indexStart=n[h];const p=h<r.length-1?r[h+1]:i;u.geometrySize=p-r[h],u.geometryIndex=h,this.updateGeometryAttributes(d,u)},a,c),this.vertexCount=n[n.length-1]}}const p9=typeof window<"u"?E.useLayoutEffect:E.useEffect,m9=p9;function cd(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const v9={position:"absolute",zIndex:-1};function vR(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>vR(n,e));if(ng(t)){if(y9(t))return e.style=v9,E.cloneElement(t,e);if(_9(t))return E.cloneElement(t,e)}return t}function ng(t){return t&&typeof t=="object"&&"type"in t||!1}function y9(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function _9(t){const e=t.type;return e&&e.deckGLViewProps}function K0(t){if(typeof t=="function")return E.createElement(hc,{},t);if(Array.isArray(t))return t.map(K0);if(ng(t)){if(t.type===E.Fragment)return K0(t.props.children);if(cd(t.type,hc))return t}return t}function b9({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return E.Children.forEach(K0(t),o=>{if(ng(o)){const a=o.type;if(cd(a,Fr)){const c=A9(a,o.props);i.push(c)}else r.push(o);if(cd(a,hc)&&a!==hc&&o.props.id){const c=new a(o.props);s[c.id]=c}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function A9(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function E9({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,c=o;ng(o)&&cd(o.type,hc)&&(a=o.props.id||s,c=o.props.children);const l=r.getViewport(a),u=r.getViewState(a);if(l){u.padding=l.padding;const{x:f,y:h,width:d,height:p}=l;c=vR(c,{x:f,y:h,width:d,height:p,viewport:l,viewState:u}),i[a]||(i[a]={viewport:l,children:[]}),i[a].children.push(c)}}return Object.keys(i).map(o=>{const{viewport:a,children:c}=i[o],{x:l,y:u,width:f,height:h}=a,d={position:"absolute",left:l,top:u,width:f,height:h},p="view-".concat(o),y=E.createElement("div",{key:p,id:p,style:d},...c);if(n){const b={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:v=>{v.viewId=o,e._onViewStateChange(v)}};return E.createElement(n,{key:p,value:b},y)}return y})}const T9={mixBlendMode:null};function S9({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in T9?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function C9(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function yR(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function w9(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():yR(t)}});return r}const _R=E.forwardRef((t,e)=>{const[n,r]=E.useState(0),s=E.useRef({control:null,version:n,forceUpdate:()=>r(S=>S+1)}).current,o=E.useRef(null),a=E.useRef(null),c=E.useMemo(()=>b9(t),[t.layers,t.views,t.children]);let l=!0;const u=S=>{var w;return l&&t.viewState?(s.viewStateUpdateRequested=S,null):(s.viewStateUpdateRequested=null,(w=t.onViewStateChange)===null||w===void 0?void 0:w.call(t,S))},f=S=>{if(l)s.interactionStateUpdateRequested=S;else{var w;s.interactionStateUpdateRequested=null,(w=t.onInteractionStateChange)===null||w===void 0||w.call(t,S)}},h=E.useMemo(()=>{const S={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:c.layers,views:c.views,onViewStateChange:u,onInteractionStateChange:f};return delete S._customRender,s.deck&&s.deck.setProps(S),S},[t]);E.useEffect(()=>{const S=t.Deck||eg;return s.deck=w9(s,S,{...h,parent:o.current,canvas:a.current}),()=>{var w;return(w=s.deck)===null||w===void 0?void 0:w.finalize()}},[]),m9(()=>{yR(s);const{viewStateUpdateRequested:S,interactionStateUpdateRequested:w}=s;S&&u(S),w&&f(w)}),E.useImperativeHandle(e,()=>C9(s),[]);const d=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:p,width:y,height:b,id:v,style:m}=t,{containerStyle:_,canvasStyle:A}=E.useMemo(()=>S9({width:y,height:b,style:m}),[y,b,m]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===d||s.version!==n){s.lastRenderedViewports=d,s.version=n;const S=E9({children:c.children,deck:s.deck,ContextProvider:p}),w=E.createElement("canvas",{key:"canvas",id:v||"deckgl-overlay",ref:a,style:A});s.control=E.createElement("div",{id:"".concat(v||"deckgl","-wrapper"),ref:o,style:_},[w,S])}return l=!1,s.control});_R.defaultProps=eg.defaultProps;const x9=_R,P9=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,M9=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,R9=1024,I9=4,UE=()=>{},GE={10241:9987,10240:9729,10242:33071,10243:33071};function L9(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function B9(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),o=Math.floor(e.height*i);return i===1?{data:e,width:s,height:o}:(t.canvas.height=o,t.canvas.width=s,t.clearRect(0,0,s,o),t.drawImage(e,0,0,e.width,e.height,0,0,s,o),{data:t.canvas,width:s,height:o})}function $l(t){return t&&(t.id||t.url)}function O9(t,e,n,r){const i=t.width,s=t.height,o=new on(t.gl,{width:e,height:n,parameters:r});return ZN(t,o,{targetY:0,width:i,height:s}),t.delete(),o}function zE(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=$l(i);t[o]={...i,x:s,y:n}}}function F9({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let c=0;c<t.length;c++){const l=t[c],u=$l(l);if(!n[u]){const{height:f,width:h}=l;r+h+e>o&&(zE(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:l,xOffset:r}),r=r+h+e,s=Math.max(s,f)}}return a.length>0&&zE(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:L9(s+i+e)}}function D9(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Su(t);for(const o of i){s.index++;const a=e(o,s),c=$l(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[c]&&(!n[c]||a.url!==n[c].url)&&(r[c]={...a,source:o,sourceIndex:s.index})}return r}class N9{constructor(e,{onUpdate:n=UE,onError:r=UE}){g(this,"gl",void 0),g(this,"onUpdate",void 0),g(this,"onError",void 0),g(this,"_loadOptions",null),g(this,"_texture",null),g(this,"_externalTexture",null),g(this,"_mapping",{}),g(this,"_textureParameters",null),g(this,"_pendingCount",0),g(this,"_autoPacking",!1),g(this,"_xOffset",0),g(this,"_yOffset",0),g(this,"_rowHeight",0),g(this,"_buffer",I9),g(this,"_canvasWidth",R9),g(this,"_canvasHeight",0),g(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?$l(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var o;(o=this._texture)===null||o===void 0||o.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(D9(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:c}=F9({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=c,this._texture||(this._texture=new on(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||GE})),this._texture.height!==this._canvasHeight&&(this._texture=O9(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||GE)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,is(r.url,this._loadOptions).then(i=>{const s=$l(r),o=this._mapping[s],{x:a,y:c,width:l,height:u}=o,{data:f,width:h,height:d}=B9(n,i,l,u);this._texture.setSubImageData({data:f,x:a+(l-h)/2,y:c+(u-d)/2,width:h,height:d}),o.width=h,o.height=d,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const bR=[0,0,0,255],k9={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:bR},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class rg extends Fr{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:P9,fs:M9,modules:[Ys,qs]})}initializeState(){this.state={iconManager:new N9(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:bR},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:c,getIcon:l,textureParameters:u}=n,{iconManager:f}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(f.setProps({loadOptions:n.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&f.packIcons(c,l),i.extensionsChanged){var d;const{gl:p}=this.context;(d=this.state.model)===null||d===void 0||d.delete(),this.state.model=this._getModel(p),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:c}=this.state,l=c.getTexture();l&&this.state.model.setUniforms(e).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:Ws[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Br(e,{...this.getShaders(),id:this.props.id,geometry:new Ii({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):de.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}g(rg,"defaultProps",k9);g(rg,"layerName","IconLayer");const U9=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,G9=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,AR=[0,0,0,255],ER=[0,0,1],z9={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:ER},getColor:{type:"accessor",value:AR},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function H9(t){const{header:e,attributes:n}=t;!e||!n||(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}class R_ extends Fr{getShaders(){return super.getShaders({vs:U9,fs:G9,modules:[Ys,kM,qs]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:ER},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:AR}})}updateState(e){const{changeFlags:n,props:r}=e;if(super.updateState(e),n.extensionsChanged){var i;const{gl:s}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}n.dataChanged&&H9(r.data)}draw({uniforms:e}){const{pointSize:n,sizeUnits:r}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:Ws[r],radiusPixels:n}).draw()}_getModel(e){const n=[];for(let r=0;r<3;r++){const i=r/3*Math.PI*2;n.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new Br(e,{...this.getShaders(),id:this.props.id,geometry:new Ii({drawMode:4,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}g(R_,"layerName","PointCloudLayer");g(R_,"defaultProps",z9);const j9=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,V9=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,HE=[0,0,0,255],W9={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:HE},getLineColor:{type:"accessor",value:HE},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class I_ extends Fr{getShaders(){return super.getShaders({vs:j9,fs:V9,modules:[Ys,qs]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:c,antialiasing:l,lineWidthUnits:u,lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:a,billboard:c,antialiasing:l,radiusUnits:Ws[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Ws[u],lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Br(e,{...this.getShaders(),id:this.props.id,geometry:new Ii({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}g(I_,"defaultProps",W9);g(I_,"layerName","ScatterplotLayer");const TR={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function SR(t,e,n={}){return $9(t,n)!==e?(J9(t,n),!0):!1}function $9(t,e={}){return Math.sign(X9(t,e))}function X9(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let o=n,a=r-i;o<r;o+=i)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function J9(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const c=n+a*i,l=n+(s-1-a)*i;for(let u=0;u<i;++u){const f=t[c+u];t[c+u]=t[l+u],t[l+u]=f}}}function ii(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function Y0(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Xl(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function q0(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function lh(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function CR(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},c=(a-o)/n;let l=[];const u=[l],f=Xl(t,0,n,o);let h,d;const p=xR(f,i,s,[]),y=[];ii(l,f);for(let b=1;b<c;b++){for(h=Xl(t,b,n,o,h),d=lh(h,p);d;){q0(f,h,d,p,y);const v=lh(y,p);v&&(q0(f,y,v,p,y),d=v),ii(l,y),Y0(f,y),Y9(p,i,d),r&&l.length>n&&(l=[],u.push(l),ii(l,f)),d=lh(h,p)}ii(l,h),Y0(f,h)}return r?u:u[0]}const jE=0,K9=1;function hf(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function wR(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],c=[{pos:t,types:o?new Array(t.length/r).fill(K9):null,holes:e||[]}],l=[[],[]];let u=[];for(;c.length;){const{pos:f,types:h,holes:d}=c.shift();q9(f,r,d[0]||f.length,l),u=xR(l[0],i,s,u);const p=lh(l[1],u);if(p){let y=VE(f,h,r,0,d[0]||f.length,u,p);const b={pos:y[0].pos,types:y[0].types,holes:[]},v={pos:y[1].pos,types:y[1].types,holes:[]};c.push(b,v);for(let m=0;m<d.length;m++)y=VE(f,h,r,d[m],d[m+1]||f.length,u,p),y[0]&&(b.holes.push(b.pos.length),b.pos=hf(b.pos,y[0].pos),o&&(b.types=hf(b.types,y[0].types))),y[1]&&(v.holes.push(v.pos.length),v.pos=hf(v.pos,y[1].pos),o&&(v.types=hf(v.types,y[1].types)))}else{const y={positions:f};o&&(y.edgeTypes=h),d.length&&(y.holeIndices=d),a.push(y)}}return a}function VE(t,e,n,r,i,s,o){const a=(i-r)/n,c=[],l=[],u=[],f=[],h=[];let d,p,y;const b=Xl(t,a-1,n,r);let v=Math.sign(o&8?b[1]-s[3]:b[0]-s[2]),m=e&&e[a-1],_=0,A=0;for(let S=0;S<a;S++)d=Xl(t,S,n,r,d),p=Math.sign(o&8?d[1]-s[3]:d[0]-s[2]),y=e&&e[r/n+S],p&&v&&v!==p&&(q0(b,d,o,s,h),ii(c,h)&&u.push(m),ii(l,h)&&f.push(m)),p<=0?(ii(c,d)&&u.push(y),_-=p):u.length&&(u[u.length-1]=jE),p>=0?(ii(l,d)&&f.push(y),A+=p):f.length&&(f[f.length-1]=jE),Y0(b,d),v=p,m=y;return[_?{pos:c,types:e&&u}:null,A?{pos:l,types:e&&f}:null]}function xR(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function Y9(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function q9(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let c=0;c<n;c+=e){const l=t[c],u=t[c+1];i=l<i?l:i,s=l>s?l:s,o=u<o?u:o,a=u>a?u:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}const Q9=85.051129;function Z9(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);PR(o,n,0,i-r);const a=CR(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const c of a)MR(c,n);return a}function eV(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let c=0,l=0;for(let f=0;f<=e.length;f++){const h=e[f]||t.length,d=l,p=tV(t,r,c,h);for(let y=p;y<h;y++)o[l++]=t[y];for(let y=c;y<p;y++)o[l++]=t[y];PR(o,r,d,l),nV(o,r,d,l,n==null?void 0:n.maxLatitude),c=h,a[f]=l}a.pop();const u=wR(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const f of u)MR(f.positions,r);return u}function tV(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function nV(t,e,n,r,i=Q9){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=Xl(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,ii(t,a),a[1]=Math.sign(a[1])*i,ii(t,a),a[0]=s,ii(t,a)}}function PR(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function MR(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function rV(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?CR(i,{size:e,gridResolution:n}):r?Z9(i,{size:e}):i}const iV=1,sV=2,Dp=4;class oV extends mR{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?rV(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(WE(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&WE(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=Dp,r[s+o-2]=Dp):(r[s]+=iV,r[s+o-2]+=sV),r[s+o-1]=Dp}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,c=0;c<s;a++,c++)this.getPointOnPath(e,c,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function WE(t){return Array.isArray(t[0])}const aV=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,cV=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,RR=[0,0,0,255],lV={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:RR},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Np={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class L_ extends Fr{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:aV,fs:cV,modules:[Ys,qs]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Np,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Np,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Np,defaultValue:RR},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new oV({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,c=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:c.getPath,buffers:c,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:c,widthMaxPixels:l}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Ws[o],widthScale:a,miterLimit:s,widthMinPixels:c,widthMaxPixels:l}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Br(e,{...this.getShaders(),id:this.props.id,geometry:new Ii({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}g(L_,"defaultProps",lV);g(L_,"layerName","PathLayer");var B_={exports:{}};B_.exports=ig;B_.exports.default=ig;function ig(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=IR(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,c,l,u,f,h,d;if(r&&(s=gV(t,e,s,n)),t.length>80*n){a=l=t[0],c=u=t[1];for(var p=n;p<i;p+=n)f=t[p],h=t[p+1],f<a&&(a=f),h<c&&(c=h),f>l&&(l=f),h>u&&(u=h);d=Math.max(l-a,u-c),d=d!==0?32767/d:0}return Jl(s,o,n,a,c,d,0),o}function IR(t,e,n,r,i){var s,o;if(i===ev(t,e,n,r)>0)for(s=e;s<n;s+=r)o=$E(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=$E(s,t[s],t[s+1],o);return o&&sg(o,o.next)&&(Yl(o),o=o.next),o}function Fo(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(sg(n,n.next)||at(n.prev,n,n.next)===0)){if(Yl(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Jl(t,e,n,r,i,s,o){if(t){!o&&s&&_V(t,r,i,s);for(var a=t,c,l;t.prev!==t.next;){if(c=t.prev,l=t.next,s?fV(t,r,i,s):uV(t)){e.push(c.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),Yl(t),t=l.next,a=l.next;continue}if(t=l,t===a){o?o===1?(t=hV(Fo(t),e,n),Jl(t,e,n,r,i,s,2)):o===2&&dV(t,e,n,r,i,s):Jl(Fo(t),e,n,r,i,s,1);break}}}}function uV(t){var e=t.prev,n=t,r=t.next;if(at(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,c=n.y,l=r.y,u=i<s?i<o?i:o:s<o?s:o,f=a<c?a<l?a:l:c<l?c:l,h=i>s?i>o?i:o:s>o?s:o,d=a>c?a>l?a:l:c>l?c:l,p=r.next;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=f&&p.y<=d&&La(i,a,s,c,o,l,p.x,p.y)&&at(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function fV(t,e,n,r){var i=t.prev,s=t,o=t.next;if(at(i,s,o)>=0)return!1;for(var a=i.x,c=s.x,l=o.x,u=i.y,f=s.y,h=o.y,d=a<c?a<l?a:l:c<l?c:l,p=u<f?u<h?u:h:f<h?f:h,y=a>c?a>l?a:l:c>l?c:l,b=u>f?u>h?u:h:f>h?f:h,v=Q0(d,p,e,n,r),m=Q0(y,b,e,n,r),_=t.prevZ,A=t.nextZ;_&&_.z>=v&&A&&A.z<=m;){if(_.x>=d&&_.x<=y&&_.y>=p&&_.y<=b&&_!==i&&_!==o&&La(a,u,c,f,l,h,_.x,_.y)&&at(_.prev,_,_.next)>=0||(_=_.prevZ,A.x>=d&&A.x<=y&&A.y>=p&&A.y<=b&&A!==i&&A!==o&&La(a,u,c,f,l,h,A.x,A.y)&&at(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;_&&_.z>=v;){if(_.x>=d&&_.x<=y&&_.y>=p&&_.y<=b&&_!==i&&_!==o&&La(a,u,c,f,l,h,_.x,_.y)&&at(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;A&&A.z<=m;){if(A.x>=d&&A.x<=y&&A.y>=p&&A.y<=b&&A!==i&&A!==o&&La(a,u,c,f,l,h,A.x,A.y)&&at(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function hV(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!sg(i,s)&&LR(i,r,r.next,s)&&Kl(i,s)&&Kl(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),Yl(r),Yl(r.next),r=t=s),r=r.next}while(r!==t);return Fo(r)}function dV(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&EV(o,a)){var c=BR(o,a);o=Fo(o,o.next),c=Fo(c,c.next),Jl(o,e,n,r,i,s,0),Jl(c,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function gV(t,e,n,r){var i=[],s,o,a,c,l;for(s=0,o=e.length;s<o;s++)a=e[s]*r,c=s<o-1?e[s+1]*r:t.length,l=IR(t,a,c,r,!1),l===l.next&&(l.steiner=!0),i.push(AV(l));for(i.sort(pV),s=0;s<i.length;s++)n=mV(i[s],n);return n}function pV(t,e){return t.x-e.x}function mV(t,e){var n=vV(t,e);if(!n)return e;var r=BR(n,t);return Fo(r,r.next),Fo(n,n.next)}function vV(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var c=o,l=o.x,u=o.y,f=1/0,h;n=o;do r>=n.x&&n.x>=l&&r!==n.x&&La(i<u?r:s,i,l,u,i<u?s:r,i,n.x,n.y)&&(h=Math.abs(i-n.y)/(r-n.x),Kl(n,t)&&(h<f||h===f&&(n.x>o.x||n.x===o.x&&yV(o,n)))&&(o=n,f=h)),n=n.next;while(n!==c);return o}function yV(t,e){return at(t.prev,t,e.prev)<0&&at(e.next,t,t.next)<0}function _V(t,e,n,r){var i=t;do i.z===0&&(i.z=Q0(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,bV(i)}function bV(t){var e,n,r,i,s,o,a,c,l=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<l&&(a++,r=r.nextZ,!!r);e++);for(c=l;a>0||c>0&&r;)a!==0&&(c===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,c--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,l*=2}while(o>1);return t}function Q0(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function AV(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function La(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function EV(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!TV(t,e)&&(Kl(t,e)&&Kl(e,t)&&SV(t,e)&&(at(t.prev,t,e.prev)||at(t,e.prev,e))||sg(t,e)&&at(t.prev,t,t.next)>0&&at(e.prev,e,e.next)>0)}function at(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function sg(t,e){return t.x===e.x&&t.y===e.y}function LR(t,e,n,r){var i=gf(at(t,e,n)),s=gf(at(t,e,r)),o=gf(at(n,r,t)),a=gf(at(n,r,e));return!!(i!==s&&o!==a||i===0&&df(t,n,e)||s===0&&df(t,r,e)||o===0&&df(n,t,r)||a===0&&df(n,e,r))}function df(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function gf(t){return t>0?1:t<0?-1:0}function TV(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&LR(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Kl(t,e){return at(t.prev,t,t.next)<0?at(t,e,t.next)>=0&&at(t,t.prev,e)>=0:at(t,e,t.prev)<0||at(t,t.next,e)<0}function SV(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function BR(t,e){var n=new Z0(t.i,t.x,t.y),r=new Z0(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function $E(t,e,n,r){var i=new Z0(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Yl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Z0(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ig.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(ev(t,0,s,n));if(i)for(var a=0,c=e.length;a<c;a++){var l=e[a]*n,u=a<c-1?e[a+1]*n:t.length;o-=Math.abs(ev(t,l,u,n))}var f=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,d=r[a+1]*n,p=r[a+2]*n;f+=Math.abs((t[h]-t[p])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[p+1]-t[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function ev(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}ig.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var CV=B_.exports;const wV=cu(CV),pf=TR.CLOCKWISE,XE=TR.COUNTER_CLOCKWISE,Rs={isClosed:!0};function xV(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function sl(t){return"positions"in t?t.positions:t}function uh(t){return"holeIndices"in t?t.holeIndices:null}function PV(t){return Array.isArray(t[0])}function MV(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function RV(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function IV(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function JE(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let c=0;c<r;c++)t[s++]=n[a][c]||0;if(!RV(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return Rs.start=e,Rs.end=s,Rs.size=r,SR(t,i,Rs),s}function KE(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let c=e;for(let l=0;l<a;l++)t[c++]=n[i+l];if(!IV(n,r,i,s))for(let l=0;l<r;l++)t[c++]=n[i+l];return Rs.start=e,Rs.end=c,Rs.size=r,SR(t,o,Rs),c}function LV(t,e){xV(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=KE(n,o,i,e,s[a-1],s[a],a===0?pf:XE),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!PV(t))return KE(n,0,t,e,0,n.length,pf),n;if(!MV(t)){let i=0;for(const[s,o]of t.entries())i=JE(n,i,o,e,s===0?pf:XE),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return JE(n,0,t,e,pf),n}function kp(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=t[s*3+e]*t[o*3+n],i-=t[o*3+e]*t[s*3+n]}return Math.abs(i/2)}function YE(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const o=s*3,a=t[o+0],c=t[o+1],l=t[o+2];t[o+e]=a,t[o+n]=c,t[o+r]=l}}function BV(t,e,n,r){let i=uh(t);i&&(i=i.map(a=>a/e));let s=sl(t);const o=r&&e===3;if(n){const a=s.length;s=s.slice();const c=[];for(let l=0;l<a;l+=e){c[0]=s[l],c[1]=s[l+1],o&&(c[2]=s[l+2]);const u=n(c);s[l]=u[0],s[l+1]=u[1],o&&(s[l+2]=u[2])}}if(o){const a=kp(s,0,1),c=kp(s,0,2),l=kp(s,1,2);if(!a&&!c&&!l)return[];a>c&&a>l||(c>l?(n||(s=s.slice()),YE(s,0,2,1)):(n||(s=s.slice()),YE(s,2,0,1)))}return wV(s,i,e)}class OV extends mR{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=LV(e,this.positionSize);return this.opts.resolution?wR(sl(n),uh(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?eV(sl(n),uh(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(qE(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return sl(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&qE(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let c=s.indices;if(!c||!e)return;let l=i;const u=BV(e,this.positionSize,this.opts.preproject,this.opts.full3d);c=a.allocate(c,i+u.length,{copy:!0});for(let f=0;f<u.length;f++)c[l++]=u[f]+r;o[n+1]=i+u.length,s.indices=c}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=sl(e);for(let a=n,c=0;c<r;a++,c++){const l=o[c*s],u=o[c*s+1],f=s>2?o[c*s+2]:0;i[a*3]=l,i[a*3+1]=u,i[a*3+2]=f}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&uh(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function qE(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const OR=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,FV=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(OR,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),DV=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(OR,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),NV=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,ld=[0,0,0,255],kV={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:ld},getLineColor:{type:"accessor",value:ld},material:!0},mf={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class O_ extends Fr{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?FV:DV,fs:NV,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Ys,kM,qs]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===Te.DEFAULT&&(r=Te.LNGLAT);let s;r===Te.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new OV({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||o_(e,We.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const o=this.getAttributeManager(),a=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:a},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:mf,accessor:"getPolygon",update:this.calculatePositions,noAlloc:a,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:a},elevations:{size:1,transition:mf,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:mf,accessor:"getFillColor",defaultValue:ld,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:mf,accessor:"getLineColor",defaultValue:ld,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(c,{index:l,target:u})=>this.encodePickingColor(c&&c.__source?c.__source.index:l,u),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,polygonTesselator:c}=this.state,l={...e,extruded:!!n,elevationScale:s};a&&(a.setInstanceCount(c.instanceCount-1),a.setUniforms(l),i&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),r&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(c.vertexCount),o.setUniforms(l).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(c=>c.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,o;if(r){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new Br(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new Br(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Ii({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,s].filter(Boolean),topModel:s,sideModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}g(O_,"defaultProps",kV);g(O_,"layerName","SolidPolygonLayer");function UV({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,c=o;for(let h=0;h<o;h++){const d=e(t[h]);if(a>h&&d>=i&&(a=h),d>=s){c=h;break}}let l=a;const f=c-a!==r.length?t.slice(c):void 0;for(let h=0;h<r.length;h++)t[l++]=r[h];if(f){for(let h=0;h<f.length;h++)t[l++]=f[h];t.length=l}return{startRow:a,endRow:a+r.length}}function GV(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?zV(t,r,n):null}function zV(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function HV(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*3+0]=s[0],n[r][o*3+1]=s[1],n[r][o*3+2]=s[2]}return n}const jV=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Up=192/256,QE=[],VV={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class F_ extends rg{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:jV}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&de.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,o=i?Math.max(r,Up*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Up,outlineBuffer:o,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:a}=this.state;a.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Up}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):QE}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):QE}}g(F_,"defaultProps",VV);g(F_,"layerName","MultiIconLayer");const Al=1e20;class WV{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const c=this.size=e+n*4,l=this._createCanvas(c),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${o} ${e}px ${s}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(c*c),this.gridInner=new Float64Array(c*c),this.f=new Float64Array(c),this.z=new Float64Array(c+1),this.v=new Uint16Array(c)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),c=0,l=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-s))),u=Math.min(this.size-this.buffer,a+Math.ceil(i)),f=l+2*this.buffer,h=u+2*this.buffer,d=Math.max(f*h,0),p=new Uint8ClampedArray(d),y={data:p,width:f,height:h,glyphWidth:l,glyphHeight:u,glyphTop:a,glyphLeft:c,glyphAdvance:n};if(l===0||u===0)return y;const{ctx:b,buffer:v,gridInner:m,gridOuter:_}=this;b.clearRect(v,v,l,u),b.fillText(e,v,v+a);const A=b.getImageData(v,v,l,u);_.fill(Al,0,d),m.fill(0,0,d);for(let S=0;S<u;S++)for(let w=0;w<l;w++){const x=A.data[4*(S*l+w)+3]/255;if(x===0)continue;const M=(S+v)*f+w+v;if(x===1)_[M]=0,m[M]=Al;else{const L=.5-x;_[M]=L>0?L*L:0,m[M]=L<0?L*L:0}}ZE(_,0,0,f,h,f,this.f,this.v,this.z),ZE(m,v,v,l,u,f,this.f,this.v,this.z);for(let S=0;S<d;S++){const w=Math.sqrt(_[S])-Math.sqrt(m[S]);p[S]=Math.round(255-255*(w/this.radius+this.cutoff))}return y}}function ZE(t,e,n,r,i,s,o,a,c){for(let l=e;l<e+r;l++)eT(t,n*s+l,s,i,o,a,c);for(let l=n;l<n+i;l++)eT(t,l*s+e,1,r,o,a,c)}function eT(t,e,n,r,i,s,o){s[0]=0,o[0]=-Al,o[1]=Al,i[0]=t[e];for(let a=1,c=0,l=0;a<r;a++){i[a]=t[e+a*n];const u=a*a;do{const f=s[c];l=(i[a]-i[f]+u-f*f)/(a-f)/2}while(l<=o[c]&&--c>-1);c++,s[c]=a,o[c]=l,o[c+1]=Al}for(let a=0,c=0;a<r;a++){for(;o[c+1]<a;)c++;const l=s[c],u=a-l;t[e+a*n]=i[l]+u*u}}const $V=32,XV=[];function JV(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function KV({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let c=0,l=o;const u=n+r*2;for(const f of t)if(!s[f]){const h=e(f);l+h+r*2>i&&(l=0,c++),s[f]={x:l+r,y:a+c*u+r,width:h,height:u,layoutWidth:h,layoutHeight:n},l+=h+r*2}return{mapping:s,xOffset:l,yOffset:a+c*u,canvasHeight:JV(a+(c+1)*u)}}function FR(t,e,n,r){let i=0;for(let o=e;o<n;o++){var s;const a=t[o];i+=((s=r[a])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function DR(t,e,n,r,i,s){let o=e,a=0;for(let c=e;c<n;c++){const l=FR(t,c,c+1,i);a+l>r&&(o<c&&s.push(c),o=c,a=0),a+=l}return a}function YV(t,e,n,r,i,s){let o=e,a=e,c=e,l=0;for(let u=e;u<n;u++)if((t[u]===" "||t[u+1]===" "||u+1===n)&&(c=u+1),c>a){let f=FR(t,a,c,i);l+f>r&&(o<a&&(s.push(a),o=a,l=0),f>r&&(f=DR(t,a,c,r,i,s),o=s[s.length-1])),a=c,l+=f}return l}function qV(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?DR(t,i,s,n,r,o):YV(t,i,s,n,r,o),o}function QV(t,e,n,r,i,s){let o=0,a=0;for(let c=e;c<n;c++){const l=t[c],u=r[l];u?(a||(a=u.layoutHeight),i[c]=o+u.layoutWidth/2,o+=u.layoutWidth):(de.warn("Missing character: ".concat(l," (").concat(l.codePointAt(0),")"))(),i[c]=o,o+=$V)}s[0]=o,s[1]=a}function ZV(t,e,n,r,i){const s=Array.from(t),o=s.length,a=new Array(o),c=new Array(o),l=new Array(o),u=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,f=[0,0],h=[0,0];let d=0,p=0,y=0;for(let v=0;v<=o;v++){const m=s[v];if((m===`
`||v===o)&&(y=v),y>p){const _=u?qV(s,n,r,i,p,y):XV;for(let A=0;A<=_.length;A++){const S=A===0?p:_[A-1],w=A<_.length?_[A]:y;QV(s,S,w,i,a,h);for(let x=S;x<w;x++){var b;const M=s[x],L=((b=i[M])===null||b===void 0?void 0:b.layoutOffsetY)||0;c[x]=d+h[1]/2+L,l[x]=h[0]}d=d+h[1]*e,f[0]=Math.max(f[0],h[0])}p=y}m===`
`&&(a[p]=0,c[p]=0,l[p]=0,p++)}return f[1]=d,{x:a,y:c,rowWidth:l,size:f}}function e8({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,c=r?r/o:0,l=i[e]||Math.ceil((t.length-c)/a),u=s&&new Set,f=new Array(e);let h=t;if(a>1||c>0){const d=t.constructor;h=new d(l);for(let p=0;p<l;p++)h[p]=t[p*a+c]}for(let d=0;d<e;d++){const p=i[d],y=i[d+1]||l,b=h.subarray(p,y);f[d]=String.fromCodePoint.apply(null,b),u&&b.forEach(u.add,u)}if(u)for(const d of u)s.add(String.fromCodePoint(d));return{texts:f,characterCount:l}}class NR{constructor(e=5){g(this,"limit",void 0),g(this,"_cache",{}),g(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function t8(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const Ja={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:t8(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},tT=1024,nT=.9,rT=1.2,kR=3;let ud=new NR(kR);function n8(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=ud.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function r8(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function iT(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function i8(t){de.assert(Number.isFinite(t)&&t>=kR,"Invalid cache limit"),ud=new NR(t)}class s8{constructor(){g(this,"props",{...Ja}),g(this,"_key",void 0),g(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*rT+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=n8(this._key,this.props.characterSet),r=ud.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,ud.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:o,sdf:a,radius:c,cutoff:l}=this.props;let u=n&&n.data;u||(u=document.createElement("canvas"),u.width=tT);const f=u.getContext("2d",{willReadFrequently:!0});iT(f,r,s,i);const{mapping:h,canvasHeight:d,xOffset:p,yOffset:y}=KV({getFontWidth:b=>f.measureText(b).width,fontHeight:s*rT,buffer:o,characterSet:e,maxCanvasWidth:tT,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(u.height!==d){const b=f.getImageData(0,0,u.width,u.height);u.height=d,f.putImageData(b,0,0)}if(iT(f,r,s,i),a){const b=new WV({fontSize:s,buffer:o,radius:c,cutoff:l,fontFamily:r,fontWeight:"".concat(i)});for(const v of e){const{data:m,width:_,height:A,glyphTop:S}=b.draw(v);h[v].width=_,h[v].layoutOffsetY=s*nT-S;const w=f.createImageData(_,A);r8(m,w),f.putImageData(w,h[v].x,h[v].y)}}else for(const b of e)f.fillText(b,h[b].x,h[b].y+o+s*nT);return{xOffset:p,yOffset:y,mapping:h,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const o8=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,a8=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,c8={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class D_ extends Fr{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:o8,fs:a8,modules:[Ys,qs]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:c}=this.props;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:c,sizeUnits:Ws[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Br(e,{...this.getShaders(),id:this.props.id,geometry:new Ii({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}g(D_,"defaultProps",c8);g(D_,"layerName","TextBackgroundLayer");const sT={start:1,middle:0,end:-1},oT={top:1,center:0,bottom:-1},Gp=[0,0,0,255],l8=1,u8={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Gp},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Ja.characterSet},fontFamily:Ja.fontFamily,fontWeight:Ja.fontWeight,lineHeight:l8,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Gp},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Gp},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class N_ extends tg{constructor(...e){super(...e),g(this,"state",void 0),g(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:o}=this.state.fontAtlasManager.props;i/=o,s/=o;const{getTextAnchor:a,getAlignmentBaseline:c}=this.props,l=sT[typeof a=="function"?a(n,r):a],u=oT[typeof c=="function"?c(n,r):c];return[(l-1)*i/2,(u-1)*s/2,i,s]}),g(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:o,y:a,rowWidth:c,size:[l,u]}=this.transformParagraph(n,r),f=sT[typeof i=="function"?i(n,r):i],h=oT[typeof s=="function"?s(n,r):s],d=o.length,p=new Array(d*2);let y=0;for(let b=0;b<d;b++){const v=(1-f)*(l-c[b])/2;p[y++]=(f-1)*l/2+v+o[b],p[y++]=(h-1)*u/2+a[b]}return p})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new s8},this.props.maxWidth>0&&de.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,o=n.startIndices,a;const c=r==="auto"&&new Set;if(i&&o){const{texts:l,characterCount:u}=e8({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:o,characterSet:c});a=u,s=(f,{index:h})=>l[h]}else{const{iterable:l,objectInfo:u}=Su(n);o=[0],a=0;for(const f of l){u.index++;const h=Array.from(s(f,u)||"");c&&h.forEach(c.add,c),a+=h.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:c||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:c}=this.props,l=s(e,n)||"";return ZV(l,a,o,c*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:o},styleVersion:a}=this.state,{data:c,_dataDiff:l,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:p,getBackgroundColor:y,getBorderColor:b,getBorderWidth:v,backgroundPadding:m,background:_,billboard:A,fontSettings:S,outlineWidth:w,outlineColor:x,sizeScale:M,sizeUnits:L,sizeMinPixels:R,sizeMaxPixels:I,transitions:N,updateTriggers:k}=this.props,z=this.getSubLayerClass("characters",F_),$=this.getSubLayerClass("background",D_);return[_&&new $({getFillColor:y,getLineColor:b,getLineWidth:v,padding:m,getPosition:u,getSize:h,getAngle:d,getPixelOffset:p,billboard:A,sizeScale:M,sizeUnits:L,sizeMinPixels:R,sizeMaxPixels:I,transitions:N&&{getPosition:N.getPosition,getAngle:N.getAngle,getSize:N.getSize,getFillColor:N.getBackgroundColor,getLineColor:N.getBorderColor,getLineWidth:N.getBorderWidth,getPixelOffset:N.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:k.getPosition,getAngle:k.getAngle,getSize:k.getSize,getFillColor:k.getBackgroundColor,getLineColor:k.getBorderColor,getLineWidth:k.getBorderWidth,getPixelOffset:k.getPixelOffset,getBoundingRect:{getText:k.getText,getTextAnchor:k.getTextAnchor,getAlignmentBaseline:k.getAlignmentBaseline,styleVersion:a}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new z({sdf:S.sdf,smoothing:Number.isFinite(S.smoothing)?S.smoothing:Ja.smoothing,outlineWidth:w/(S.radius||Ja.radius),outlineColor:x,iconAtlas:s,iconMapping:o,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:p,billboard:A,sizeScale:M*i,sizeUnits:L,sizeMinPixels:R*i,sizeMaxPixels:I*i,transitions:N&&{getPosition:N.getPosition,getAngle:N.getAngle,getColor:N.getColor,getSize:N.getSize,getPixelOffset:N.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:k.getText,getPosition:k.getPosition,getAngle:k.getAngle,getColor:k.getColor,getSize:k.getSize,getPixelOffset:k.getPixelOffset,getIconOffsets:{getTextAnchor:k.getTextAnchor,getAlignmentBaseline:k.getAlignmentBaseline,styleVersion:a}}}),{data:c,_dataDiff:l,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){i8(e)}}g(N_,"defaultProps",u8);g(N_,"layerName","TextLayer");const fh={circle:{type:I_,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:rg,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:N_,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},hh={type:L_,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},tv={type:O_,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Vc({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function zp(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function f8(t){if(Array.isArray(t))return t;switch(de.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return de.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function aT(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o],{geometry:c}=a;if(c)if(c.type==="GeometryCollection"){de.assert(Array.isArray(c.geometries),"GeoJSON does not have geometries array");const{geometries:l}=c;for(let u=0;u<l.length;u++){const f=l[u];cT(f,r,e,a,o)}}else cT(c,r,e,a,o)}return r}function cT(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:c,polygonFeatures:l,polygonOutlineFeatures:u}=e;if(!d8(s,o)){de.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(f=>{a.push(n({geometry:{type:"Point",coordinates:f}},r,i))});break;case"LineString":c.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(f=>{c.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"Polygon":l.push(n({geometry:t},r,i)),o.forEach(f=>{u.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"MultiPolygon":o.forEach(f=>{l.push(n({geometry:{type:"Polygon",coordinates:f}},r,i)),f.forEach(h=>{u.push(n({geometry:{type:"LineString",coordinates:h}},r,i))})});break}}const h8={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function d8(t,e){let n=h8[t];for(de.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function UR(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function vf(t){return t.geometry.coordinates}function g8(t,e){const n=UR(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=vf,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=vf,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=vf,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=vf,n}function p8(t,e){const n=UR(),{points:r,lines:i,polygons:s}=t,o=HV(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const m8=["points","linestrings","polygons"],v8={...Vc(fh.circle),...Vc(fh.icon),...Vc(fh.text),...Vc(hh),...Vc(tv),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class k_ extends tg{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=p8(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=f8(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const c=this.state.features;for(const l in c)s[l]=c[l].slice(),o[l]=[];for(const l of n.dataChanged){const u=aT(r,i,l);for(const f in c)o[f].push(UV({data:s[f],getIndex:h=>h.__source.index,dataRange:l,replace:u[f]}))}}else s=aT(r,i);const a=g8(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=m8.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,tv.type);if(s){const o=zp(this,tv.props),a=e&&n;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new s(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,hh.type),a=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,hh.type);if(o||a){const c=zp(this,hh.props);return[o&&new o(c,this.getSubLayerProps({id:i,updateTriggers:c.updateTriggers}),r.polygonsOutline),a&&new a(c,this.getSubLayerProps({id:s,updateTriggers:c.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(a=>a.__source.index===i));const s=new Set(e.split("+")),o=[];for(const a of s){const c="points-".concat(a),l=fh[a],u=l&&this.shouldRenderSubLayer(c,n.points.data)&&this.getSubLayerClass(c,l.type);if(u){const f=zp(this,l.props);let h=n.points;if(a==="text"&&r){const{instancePickingColors:d,...p}=h.data.attributes;h={...h,data:{...h.data,attributes:p}}}o.push(new u(f,this.getSubLayerProps({id:c,updateTriggers:f.updateTriggers,highlightedObjectIndex:i}),h))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=GV(s,o);return e(a,i)}}}g(k_,"layerName","GeoJsonLayer");g(k_,"defaultProps",v8);const or={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new B;new B;const Wc=new B,lT=new B;class Cu{constructor(e=[0,0,0],n=0){g(this,"center",void 0),g(this,"radius",void 0),this.radius=-0,this.center=new B,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Wc.from(n),this.center=new B().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new Cu(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,o=Wc.copy(i).subtract(n),a=o.magnitude();if(r>=a+s)return this.clone();if(s>=a+r)return e.clone();const c=(r+a+s)*.5;return lT.copy(o).scale((-r+c)/a).add(n),this.center.copy(lT),this.radius=c,this}expand(e){const r=Wc.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=r4(Wc,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Wc.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?or.OUTSIDE:s<r?or.INTERSECTING:or.INSIDE}}const y8=new B,_8=new B,yf=new B,_f=new B,bf=new B,b8=new B,A8=new B,ki={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class wu{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){g(this,"center",void 0),g(this,"halfAxes",void 0),this.center=new B().from(e),this.halfAxes=new bt(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new B(e).len(),new B(n).len(),new B(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new B(e).normalize(),s=new B(n).normalize(),o=new B(r).normalize();return new Vl().fromMatrix3(new bt([...i,...s,...o]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new Vl(r),s=new bt().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new B().from(e),this.halfAxes=s,this}clone(){return new wu(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new Cu){const n=this.halfAxes,r=n.getColumn(0,yf),i=n.getColumn(1,_f),s=n.getColumn(2,bf),o=y8.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,o=r.y,a=r.z,c=Math.abs(s*i[ki.COLUMN0ROW0]+o*i[ki.COLUMN0ROW1]+a*i[ki.COLUMN0ROW2])+Math.abs(s*i[ki.COLUMN1ROW0]+o*i[ki.COLUMN1ROW1]+a*i[ki.COLUMN1ROW2])+Math.abs(s*i[ki.COLUMN2ROW0]+o*i[ki.COLUMN2ROW1]+a*i[ki.COLUMN2ROW2]),l=r.dot(n)+e.distance;return l<=-c?or.OUTSIDE:l>=c?or.INSIDE:or.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=_8.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,yf),s=r.getColumn(1,_f),o=r.getColumn(2,bf),a=i.magnitude(),c=s.magnitude(),l=o.magnitude();i.normalize(),s.normalize(),o.normalize();let u=0,f;return f=Math.abs(n.dot(i))-a,f>0&&(u+=f*f),f=Math.abs(n.dot(s))-c,f>0&&(u+=f*f),f=Math.abs(n.dot(o))-l,f>0&&(u+=f*f),u}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,c=a.getColumn(0,yf),l=a.getColumn(1,_f),u=a.getColumn(2,bf),f=b8.copy(c).add(l).add(u).add(o),h=A8.copy(f).subtract(e);let d=n.dot(h);return i=Math.min(d,i),s=Math.max(d,s),f.copy(o).add(c).add(l).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),f.copy(o).add(c).subtract(l).add(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),f.copy(o).add(c).subtract(l).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(c).add(l).add(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(c).add(l).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(c).subtract(l).add(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),o.copy(f).subtract(c).subtract(l).subtract(u),h.copy(f).subtract(e),d=n.dot(h),i=Math.min(d,i),s=Math.max(d,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,yf);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,_f);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,bf);return i.transformAsPoint(e),this.halfAxes=new bt([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const uT=new B,fT=new B;class Qr{constructor(e=[0,0,1],n=0){g(this,"normal",void 0),g(this,"distance",void 0),this.normal=new B,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Zr(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=uT.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),Zr(ci(this.normal.len(),1)),this.distance=i,this}clone(){return new Qr(this.normal,this.distance)}equals(e){return ci(this.distance,e.distance)&&ci(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=fT.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=uT.from(e);const r=this.getPointDistance(e),i=fT.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const hT=[new B([1,0,0]),new B([0,1,0]),new B([0,0,1])],dT=new B,E8=new B;new Qr(new B(1,0,0),0);class wr{constructor(e=[]){g(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*hT.length;const n=e.center,r=e.radius;let i=0;for(const s of hT){let o=this.planes[i],a=this.planes[i+1];o||(o=this.planes[i]=new Qr),a||(a=this.planes[i+1]=new Qr);const c=dT.copy(s).scale(-r).add(n);-s.dot(c),o.fromPointNormal(c,s);const l=dT.copy(s).scale(r).add(n),u=E8.copy(s).negate();-u.dot(l),a.fromPointNormal(l,u),i+=2}return this}computeVisibility(e){let n=or.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case or.OUTSIDE:return or.OUTSIDE;case or.INTERSECTING:n=or.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Zr(Number.isFinite(n),"parentPlaneMask is required."),n===wr.MASK_OUTSIDE||n===wr.MASK_INSIDE)return n;let r=wr.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const o=s<31?1<<s:0;if(s<31&&!(n&o))continue;const a=i[s],c=e.intersectPlane(a);if(c===or.OUTSIDE)return wr.MASK_OUTSIDE;c===or.INTERSECTING&&(r|=o)}return r}}g(wr,"MASK_OUTSIDE",4294967295);g(wr,"MASK_INSIDE",0);g(wr,"MASK_INDETERMINATE",2147483647);new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;new B;const Ai=new bt,T8=new bt,S8=new bt,Af=new bt,gT=new bt;function C8(t,e={}){const n=Wl.EPSILON20,r=10;let i=0,s=0;const o=T8,a=S8;o.identity(),a.copy(t);const c=n*w8(a);for(;s<r&&x8(a)>c;)P8(a,Af),gT.copy(Af).transpose(),a.multiplyRight(Af),a.multiplyLeft(gT),o.multiplyRight(Af),++i>2&&(++s,i=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function w8(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const nv=[1,0,0],rv=[2,2,1];function x8(t){let e=0;for(let n=0;n<3;++n){const r=t[Ai.getElementIndex(rv[n],nv[n])];e+=2*r*r}return Math.sqrt(e)}function P8(t,e){const n=Wl.EPSILON15;let r=0,i=1;for(let l=0;l<3;++l){const u=Math.abs(t[Ai.getElementIndex(rv[l],nv[l])]);u>r&&(i=l,r=u)}const s=nv[i],o=rv[i];let a=1,c=0;if(Math.abs(t[Ai.getElementIndex(o,s)])>n){const l=t[Ai.getElementIndex(o,o)],u=t[Ai.getElementIndex(s,s)],f=t[Ai.getElementIndex(o,s)],h=(l-u)/2/f;let d;h<0?d=-1/(-h+Math.sqrt(1+h*h)):d=1/(h+Math.sqrt(1+h*h)),a=1/Math.sqrt(1+d*d),c=d*a}return bt.IDENTITY.to(e),e[Ai.getElementIndex(s,s)]=e[Ai.getElementIndex(o,o)]=a,e[Ai.getElementIndex(o,s)]=c,e[Ai.getElementIndex(s,o)]=-c,e}const bs=new B,M8=new B,R8=new B,I8=new B,L8=new B,B8=new bt,O8={diagonal:new bt,unitary:new bt};function F8(t,e=new wu){if(!t||t.length===0)return e.halfAxes=new bt([0,0,0,0,0,0,0,0,0]),e.center=new B,e;const n=t.length,r=new B(0,0,0);for(const L of t)r.add(L);const i=1/n;r.multiplyByScalar(i);let s=0,o=0,a=0,c=0,l=0,u=0;for(const L of t){const R=bs.copy(L).subtract(r);s+=R.x*R.x,o+=R.x*R.y,a+=R.x*R.z,c+=R.y*R.y,l+=R.y*R.z,u+=R.z*R.z}s*=i,o*=i,a*=i,c*=i,l*=i,u*=i;const f=B8;f[0]=s,f[1]=o,f[2]=a,f[3]=o,f[4]=c,f[5]=l,f[6]=a,f[7]=l,f[8]=u;const{unitary:h}=C8(f,O8),d=e.halfAxes.copy(h);let p=d.getColumn(0,R8),y=d.getColumn(1,I8),b=d.getColumn(2,L8),v=-Number.MAX_VALUE,m=-Number.MAX_VALUE,_=-Number.MAX_VALUE,A=Number.MAX_VALUE,S=Number.MAX_VALUE,w=Number.MAX_VALUE;for(const L of t)bs.copy(L),v=Math.max(bs.dot(p),v),m=Math.max(bs.dot(y),m),_=Math.max(bs.dot(b),_),A=Math.min(bs.dot(p),A),S=Math.min(bs.dot(y),S),w=Math.min(bs.dot(b),w);p=p.multiplyByScalar(.5*(A+v)),y=y.multiplyByScalar(.5*(S+m)),b=b.multiplyByScalar(.5*(w+_)),e.center.copy(p).add(y).add(b);const x=M8.set(v-A,m-S,_-w).multiplyByScalar(.5),M=new bt([x[0],0,0,0,x[1],0,0,0,x[2]]);return e.halfAxes.multiplyRight(M),e}const Hp=Math.PI/180,Ef=new Float32Array(16),pT=new Float32Array(12);function mT(t,e,n){const r=e[0]*Hp,i=e[1]*Hp,s=e[2]*Hp,o=Math.sin(s),a=Math.sin(r),c=Math.sin(i),l=Math.cos(s),u=Math.cos(r),f=Math.cos(i),h=n[0],d=n[1],p=n[2];t[0]=h*f*u,t[1]=h*c*u,t[2]=h*-a,t[3]=d*(-c*l+f*a*o),t[4]=d*(f*l+c*a*o),t[5]=d*u*o,t[6]=p*(c*o+f*a*l),t[7]=p*(-f*o+c*a*l),t[8]=p*u*l}function vT(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const GR={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,c=Array.isArray(a),l=c&&a.length===16,u=Array.isArray(s),f=Array.isArray(i),h=Array.isArray(o),d=l||!c&&!!a(r[0]);d?t.constant=l:t.constant=f&&u&&h;const p=t.value;if(t.constant){let y;d?(Ef.set(a),y=vT(Ef)):(y=pT,mT(y,i,s),y.set(o,9)),t.value=new Float32Array(y)}else{let y=e*t.size;const{iterable:b,objectInfo:v}=Su(r,e,n);for(const m of b){v.index++;let _;if(d)Ef.set(l?a:a(m,v)),_=vT(Ef);else{_=pT;const A=f?i:i(m,v),S=u?s:s(m,v);mT(_,A,S),_.set(h?o:o(m,v),9)}p[y++]=_[0],p[y++]=_[1],p[y++]=_[2],p[y++]=_[3],p[y++]=_[4],p[y++]=_[5],p[y++]=_[6],p[y++]=_[7],p[y++]=_[8],p[y++]=_[9],p[y++]=_[10],p[y++]=_[11]}}}};function zR(t,e){return e===Te.CARTESIAN||e===Te.METER_OFFSETS||e===Te.DEFAULT&&!t.isGeospatial}const D8=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,N8=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function HR(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],c=a&&a.length;for(let l=0;l<c;l+=3){const u=a[l],f=a[l+1],h=a[l+2];e=u<e?u:e,n=f<n?f:n,r=h<r?h:r,i=u>i?u:i,s=f>s?f:s,o=h>o?h:o}return[[e,n,r],[i,s,o]]}function k8(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class Ba{constructor(e,n){g(this,"fields",void 0),g(this,"metadata",void 0),k8(Array.isArray(e)),U8(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const o of r)e[o]=!0;const s=this.fields.filter(o=>e[o.name]);return new Ba(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(s=>this.fields[s]).filter(Boolean);return new Ba(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof Ba){const o=e;n=o.fields,r=yT(yT(new Map,this.metadata),o.metadata)}else n=e;const i=Object.create(null);for(const o of this.fields)i[o.name]=o;for(const o of n)i[o.name]=o;const s=Object.values(i);return new Ba(s,r)}}function U8(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function yT(t,e){return new Map([...t||new Map,...e||new Map])}class fd{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;g(this,"name",void 0),g(this,"type",void 0),g(this,"nullable",void 0),g(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new fd(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let yt=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),jR,VR,WR;class U_{static isNull(e){return e&&e.typeId===yt.Null}static isInt(e){return e&&e.typeId===yt.Int}static isFloat(e){return e&&e.typeId===yt.Float}static isBinary(e){return e&&e.typeId===yt.Binary}static isUtf8(e){return e&&e.typeId===yt.Utf8}static isBool(e){return e&&e.typeId===yt.Bool}static isDecimal(e){return e&&e.typeId===yt.Decimal}static isDate(e){return e&&e.typeId===yt.Date}static isTime(e){return e&&e.typeId===yt.Time}static isTimestamp(e){return e&&e.typeId===yt.Timestamp}static isInterval(e){return e&&e.typeId===yt.Interval}static isList(e){return e&&e.typeId===yt.List}static isStruct(e){return e&&e.typeId===yt.Struct}static isUnion(e){return e&&e.typeId===yt.Union}static isFixedSizeBinary(e){return e&&e.typeId===yt.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===yt.FixedSizeList}static isMap(e){return e&&e.typeId===yt.Map}static isDictionary(e){return e&&e.typeId===yt.Dictionary}get typeId(){return yt.NONE}compareTo(e){return this===e}}jR=Symbol.toStringTag;class Cc extends U_{constructor(e,n){super(),g(this,"isSigned",void 0),g(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return yt.Int}get[jR](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class G8 extends Cc{constructor(){super(!0,8)}}class z8 extends Cc{constructor(){super(!0,16)}}class H8 extends Cc{constructor(){super(!0,32)}}class j8 extends Cc{constructor(){super(!1,8)}}class V8 extends Cc{constructor(){super(!1,16)}}class W8 extends Cc{constructor(){super(!1,32)}}const $R={HALF:16,SINGLE:32,DOUBLE:64};VR=Symbol.toStringTag;class XR extends U_{constructor(e){super(),g(this,"precision",void 0),this.precision=e}get typeId(){return yt.Float}get[VR](){return"Float"}toString(){return"Float".concat(this.precision)}}class $8 extends XR{constructor(){super($R.SINGLE)}}class X8 extends XR{constructor(){super($R.DOUBLE)}}WR=Symbol.toStringTag;class J8 extends U_{constructor(e,n){super(),g(this,"listSize",void 0),g(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return yt.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[WR](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function K8(t){switch(t.constructor){case Int8Array:return new G8;case Uint8Array:return new j8;case Int16Array:return new z8;case Uint16Array:return new V8;case Int32Array:return new H8;case Uint32Array:return new W8;case Float32Array:return new $8;case Float64Array:return new X8;default:throw new Error("array type not supported")}}function Y8(t,e,n){const r=K8(e.value),i=n||q8(e);return new fd(t,new J8(e.size,new fd("value",r)),!1,i)}function q8(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}function _T(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),de.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function bT(t,e){if(t.attributes)return _T(t.attributes,e),t instanceof Ii?t:new Ii(t);if(t.positions||t.POSITION)return _T(t,e),new Ii({attributes:t});throw Error("Invalid mesh")}const Q8=[0,0,0,255],Z8={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Q8},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class G_ extends Fr{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){const e=!_e(this.context.gl),n={};return s_(this.context.gl,We.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:D8,fs:N8,modules:[Ys,Y4,qs],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:i}=bT(r,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,n=HR(i)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:GR}),this.setState({emptyTexture:new on(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const o=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||zR(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new Br(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:bT(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}g(G_,"defaultProps",Z8);g(G_,"layerName","SimpleMeshLayer");class Ka{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n}=e;this.id=n||os(this.constructor.name),this.display=!0,this.position=new B,this.rotation=new B,this.scale=new B(1,1,1),this.matrix=new Ee,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return J(e.length===3,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return J(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return J(e.length===3,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:n,rotation:r,scale:i,update:s=!0}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,n=this.rotation,r=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(r),this}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:n,rotation:r,scale:i}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,n){J(e),n=n||this.matrix;const r=new Ee(e).multiplyRight(n),i=r.invert(),s=i.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:r,worldInverseMatrix:i,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class El extends Ka{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:n=[]}=e;Y.assert(n.every(r=>r instanceof Ka),"every child must an instance of ScenegraphNode"),super(e),this.children=n}add(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(e){const n=this.children,r=n.indexOf(e);return r>-1&&n.splice(r,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((n,r)=>{let{worldMatrix:i}=r;const s=n.getBounds();if(!s)return;const[o,a]=s,c=new B(o).add(a).divide([2,2,2]);i.transformAsPoint(c,c);const l=new B(a).subtract(o).divide([2,2,2]);i.transformAsVector(l,l);for(let u=0;u<8;u++){const f=new B(u&1?-1:1,u&2?-1:1,u&4?-1:1).multiply(l).add(c);for(let h=0;h<3;h++)e[0][h]=Math.min(e[0][h],f[h]),e[1][h]=Math.max(e[1][h],f[h])}}),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:n=new Ee}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new Ee(n).multiplyRight(this.matrix);for(const i of this.children)i instanceof El?i.traverse(e,{worldMatrix:r}):e(i,{worldMatrix:r})}}const e5={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},t5={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function AT(t){if(!t._animation){const e=t5[t.componentType],n=e5[t.type],r=n*t.count,{buffer:i,byteOffset:s}=t.bufferView.data,o=new e(i,s+(t.byteOffset||0),r);if(n===1)t._animation=Array.from(o);else{const a=[];for(let c=0;c<o.length;c+=n)a.push(Array.from(o.slice(c,c+n)));t._animation=a}}return t._animation}const n5=new Ee;function r5(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=n5.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}const jp=new Vl;function i5(t,e,n,r,i){if(e==="rotation"){jp.slerp({start:n,target:r,ratio:i});for(let s=0;s<jp.length;s++)t[e][s]=jp[s]}else for(let s=0;s<n.length;s++)t[e][s]=i*r[s]+(1-i)*n[s]}function s5(t,e,n){let{p0:r,outTangent0:i,inTangent1:s,p1:o,tDiff:a,ratio:c}=n;for(let l=0;l<t[e].length;l++){const u=i[l]*a,f=s[l]*a;t[e][l]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*r[l]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*u+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[l]+(Math.pow(c,3)-Math.pow(c,2))*f}}function o5(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}function a5(t,e,n,r){let{input:i,interpolation:s,output:o}=e;const a=i[i.length-1],c=t%a,l=i.findIndex(d=>d>=c),u=Math.max(0,l-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:Y.warn("Bad animation path ".concat(r))()}J(n[r].length===o[u].length);const f=i[u],h=i[l];switch(s){case"STEP":o5(n,r,o[u]);break;case"LINEAR":if(h>f){const d=(c-f)/(h-f);i5(n,r,o[u],o[l],d)}break;case"CUBICSPLINE":if(h>f){const d=(c-f)/(h-f),p=h-f,y=o[3*u+1],b=o[3*u+2],v=o[3*l+0],m=o[3*l+1];s5(n,r,{p0:y,outTangent0:b,inTangent1:v,p1:m,tDiff:p,ratio:d})}break;default:Y.warn("Interpolation ".concat(s," not supported"))();break}}class c5{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const r=(e/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:s,target:o,path:a}=i;a5(r,s,o,a),r5(o,o._node)})}}class l5{constructor(e){this.animations=e.animations.map((n,r)=>{const i=n.name||"Animation-".concat(r),s=n.samplers.map(a=>{let{input:c,interpolation:l="LINEAR",output:u}=a;return{input:AT(e.accessors[c]),interpolation:l,output:AT(e.accessors[u])}}),o=n.channels.map(a=>{let{sampler:c,target:l}=a;return{sampler:s[c],target:e.nodes[l.node],path:l.path}});return new c5({name:i,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}}class u5 extends Ka{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(n),this.onBeforeRender=null,this.AfterRender=null,e instanceof Br?(this.model=e,this._setModelNodeProps(n)):this.model=new Br(e,n),this.bounds=null,this.managedResources=n.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class JR{constructor(e,n){let{attributes:r,material:i,pbrDebug:s,imageBasedLightingEnvironment:o,lights:a,useTangents:c}=n;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},s_(e,We.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,n){e&&(this.defines[n]=1)}parseTexture(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const c=new on(this.gl,{id:e.name||e.id,parameters:{...i,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[n]=c,this.defineIfPresent(r,r),this.generatedTextures.push(c)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:n=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[n,r]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:n=1}=e.normalTexture;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:n=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=n}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){const{alphaCutoff:n=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=n}else e.alphaMode==="BLEND"&&(Y.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}const f5=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,h5=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function ET(t,e){return _e(t)?`#version 300 es
`.concat(e):e}function d5(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:s,modelOptions:o}=e,a=new JR(t,e);Y.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(s).map(u=>u.buffer));const l=new u5(t,{id:n,drawMode:r,vertexCount:i,modules:[__],parameters:a.parameters,vs:ET(t,f5),fs:ET(t,h5),managedResources:c,...o,defines:{...a.defines,...o.defines}});return l.setProps({attributes:s}),l.setUniforms(a.uniforms),l}const g5={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},p5={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class m5{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.options=Object.assign({},p5,n)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(r=>this.createScene(r))}createAnimator(){return Array.isArray(this.gltf.animations)?new l5(this.gltf):null}createScene(e){const r=(e.nodes||[]).map(s=>this.createNode(s));return new El({id:e.name||e.id,children:r})}createNode(e){if(!e._node){const r=(e.children||[]).map(s=>this.createNode(s));e.mesh&&r.push(this.createMesh(e.mesh));const i=new El({id:e.name||e.id,children:r});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){const s=new Ee().fromQuaternion(e.rotation);i.matrix.multiplyRight(s)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node}createMesh(e){if(!e._mesh){const r=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),i=new El({id:e.name||e.id,children:r});e._mesh=i}return e._mesh}getVertexCount(e){Y.warn("getVertexCount() not found")()}createPrimitive(e,n,r){const i=d5(this.gl,Object.assign({id:e.name||"".concat(r.name||r.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return i.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],i}createAttributes(e,n){const r={};return Object.keys(e).forEach(i=>{r[i]=this.createAccessor(e[i],this.createBuffer(e[i],this.gl.ARRAY_BUFFER))}),n&&(r.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),Y.info(4,"glTF Attributes",{attributes:e,indices:n,generated:r})(),r}createBuffer(e,n){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[n]||(r.lumaBuffers[n]=new ke(this.gl,{id:"from-".concat(r.id),data:r.data||e.value,target:n})),r.lumaBuffers[n]}createAccessor(e,n){return new Un({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:g5[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function v5(t,e,n){const r=new m5(t,n),i=r.instantiate(e),s=r.createAnimator();return{scenes:i,animator:s}}const y5="3.4.14",_5="3.4.14",KR="3.4.14",b5="https://unpkg.com/@loaders.gl/textures@".concat(KR,"/dist/libs/basis_encoder.wasm"),A5="https://unpkg.com/@loaders.gl/textures@".concat(KR,"/dist/libs/basis_encoder.js");let Vp;async function TT(t){const e=t.modules||{};return e.basis?e.basis:(Vp=Vp||E5(t),await Vp)}async function E5(t){let e=null,n=null;return[e,n]=await Promise.all([await Ao("basis_transcoder.js","textures",t),await Ao("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,await T5(e,n)}function T5(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:s,initializeBasis:o}=i;o(),r({BasisFile:s})})})}let Wp;async function ST(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(Wp=Wp||S5(t),await Wp)}async function S5(t){let e=null,n=null;return[e,n]=await Promise.all([await Ao(A5,"textures",t),await Ao(b5,"textures",t)]),e=e||globalThis.BASIS,await C5(e,n)}function C5(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:s,KTX2File:o,initializeBasis:a,BasisEncoder:c}=i;a(),r({BasisFile:s,KTX2File:o,BasisEncoder:c})})})}const ca={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},w5=["","WEBKIT_","MOZ_"],CT={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Tf=null;function x5(t){if(!Tf){t=t||P5()||void 0,Tf=new Set;for(const e of w5)for(const n in CT)if(t&&t.getExtension("".concat(e).concat(n))){const r=CT[n];Tf.add(r)}}return Tf}function P5(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var wT,xT,PT,MT,RT,IT,LT,BT;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(wT||(wT={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(xT||(xT={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(PT||(PT={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(MT||(MT={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(RT||(RT={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(IT||(IT={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(LT||(LT={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(BT||(BT={}));const Zn=[171,75,84,88,32,50,48,187,13,10,26,10];function M5(t){const e=new Uint8Array(t);return!(e.byteLength<Zn.length||e[0]!==Zn[0]||e[1]!==Zn[1]||e[2]!==Zn[2]||e[3]!==Zn[3]||e[4]!==Zn[4]||e[5]!==Zn[5]||e[6]!==Zn[6]||e[7]!==Zn[7]||e[8]!==Zn[8]||e[9]!==Zn[9]||e[10]!==Zn[10]||e[11]!==Zn[11])}const R5={etc1:{basisFormat:0,compressed:!0,format:ca.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:ca.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:ca.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:ca.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:ca.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:ca.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function I5(t,e){if(e.basis.containerFormat==="auto"){if(M5(t)){const r=await ST(e);return OT(r.KTX2File,t,e)}const{BasisFile:n}=await TT(e);return $p(n,t,e)}switch(e.basis.module){case"encoder":const n=await ST(e);switch(e.basis.containerFormat){case"ktx2":return OT(n.KTX2File,t,e);case"basis":default:return $p(n.BasisFile,t,e)}case"transcoder":default:const{BasisFile:r}=await TT(e);return $p(r,t,e)}}function $p(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const i=r.getNumImages(),s=[];for(let o=0;o<i;o++){const a=r.getNumLevels(o),c=[];for(let l=0;l<a;l++)c.push(L5(r,o,l,n));s.push(c)}return s}finally{r.close(),r.delete()}}function L5(t,e,n,r){const i=t.getImageWidth(e,n),s=t.getImageHeight(e,n),o=t.getHasAlpha(),{compressed:a,format:c,basisFormat:l}=YR(r,o),u=t.getImageTranscodedSizeInBytes(e,n,l),f=new Uint8Array(u);if(!t.transcodeImage(f,e,n,l,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:s,data:f,compressed:a,format:c,hasAlpha:o}}function OT(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=r.getLevels(),s=[];for(let o=0;o<i;o++){s.push(B5(r,o,n));break}return[s]}finally{r.close(),r.delete()}}function B5(t,e,n){const{alphaFlag:r,height:i,width:s}=t.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=YR(n,r),l=t.getImageTranscodedSizeInBytes(e,0,0,c),u=new Uint8Array(l);if(!t.transcodeImage(u,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:i,data:u,compressed:o,levelSize:l,hasAlpha:r,format:a}}function YR(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=qR()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),R5[n]}function qR(){const t=x5();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const O5={name:"Basis",id:Qi?"basis":"basis-nodejs",module:"textures",version:_5,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},F5={...O5,parse:I5};function cr(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function QR(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const r=e.baseUri||e.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return r.substr(0,r.lastIndexOf("/")+1)+t}function D5(t,e,n){const r=t.bufferViews[n];cr(r);const i=r.buffer,s=e[i];cr(s);const o=(r.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,o,r.byteLength)}const FT=["SCALAR","VEC2","VEC3","VEC4"],N5=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],k5=new Map(N5),U5={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},G5={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},z5={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function ZR(t){return FT[t-1]||FT[0]}function eI(t){const e=k5.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function z_(t,e){const n=z5[t.componentType],r=U5[t.type],i=G5[t.componentType],s=t.count*r,o=t.count*r*i;return cr(o>=0&&o<=e.byteLength),{ArrayType:n,length:s,byteLength:o}}function tI(t){let{images:e,bufferViews:n}=t;e=e||[],n=n||[];const r=e.map(o=>o.bufferView);n=n.filter(o=>!r.includes(o));const i=n.reduce((o,a)=>o+a.byteLength,0),s=e.reduce((o,a)=>{const{width:c,height:l}=a.image;return o+c*l},0);return i+Math.ceil(4*s*1.33)}const H5={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class Kn{constructor(e){g(this,"gltf",void 0),g(this,"sourceBuffers",void 0),g(this,"byteLength",void 0),this.gltf=e||{json:{...H5},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const n=this.getUsedExtensions().find(i=>i===e),r=this.json.extensions||{};return n?r[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);const n=e.buffer,r=this.gltf.buffers[n];cr(r);const i=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,{ArrayType:s,length:o}=z_(e,n),a=n.byteOffset+e.byteOffset;return new s(i,a,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,s=n.byteOffset||0;return new Uint8Array(i,s,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){const i=e.extensions||{};i[n]=r}removeObjectExtension(e,n){const r=e.extensions||{},i=r[n];return delete r[n],i}addExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return cr(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){if(!this.getExtension(e))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const n=this.json.extensionsRemoved;n.includes(e)||n.push(e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];const i={mesh:n};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:r,material:i,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:s}]};if(r){const c=this._addIndices(r);a.primitives[0].indices=c}return Number.isFinite(i)&&(a.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){const r=qy(e),i=n||(r==null?void 0:r.mimeType),o={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const n=e.byteLength;cr(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const r={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=gu(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(e,n){const r={bufferView:e,type:ZR(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const r=this.addBufferView(e);let i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,n.size));const s={size:n.size,componentType:eI(e),count:Math.round(e.length/n.size),min:i.min,max:i.max};return this.addAccessor(r,Object.assign(s,n))}addTexture(e){const{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const r=this.byteLength,i=new ArrayBuffer(r),s=new Uint8Array(i);let o=0;for(const a of this.sourceBuffers||[])o=d3(a,s,o);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(e,n){let r=!0;for(;r;){const i=e.indexOf(n);i>-1?e.splice(i,1):r=!1}}_addAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={};for(const r in e){const i=e[r],s=this._getGltfAttributeName(r),o=this.addBinaryBuffer(i.value,i);n[s]=o}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];const i=e.subarray(0,n);for(const s of i)r.min.push(s),r.max.push(s);for(let s=n;s<e.length;s+=n)for(let o=0;o<n;o++)r.min[0+o]=Math.min(r.min[0+o],e[s+o]),r.max[0+o]=Math.max(r.max[0+o],e[s+o]);return r}}const j5="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",V5="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",W5=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),$5=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),X5={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},J5={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function K5(t,e,n,r,i){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const o=await Y5();Z5(o,o.exports[J5[i]],t,e,n,r,o.exports[X5[s||"NONE"]])}let Xp;async function Y5(){return Xp||(Xp=q5()),Xp}async function q5(){let t=j5;WebAssembly.validate(W5)&&(t=V5,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(Q5(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function Q5(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){const i=t.charCodeAt(r);e[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?$5[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function Z5(t,e,n,r,i,s,o){const a=t.exports.sbrk,c=r+3&-4,l=a(c*i),u=a(s.length),f=new Uint8Array(t.exports.memory.buffer);f.set(s,u);const h=e(l,r,i,u,s.length);if(h===0&&o&&o(l,c,i),n.set(f.subarray(l,l+r*i)),a(l-a(0)),h!==0)throw new Error("Malformed buffer data: ".concat(h))}const H_="EXT_meshopt_compression",eW=H_;async function tW(t,e){var n;const r=new Kn(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=[];for(const s of t.json.bufferViews||[])i.push(nW(r,s));await Promise.all(i),r.removeExtension(H_)}async function nW(t,e){const n=t.getObjectExtension(e,H_);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:s,count:o,mode:a,filter:c="NONE",buffer:l}=n,u=t.gltf.buffers[l],f=new Uint8Array(u.arrayBuffer,u.byteOffset+r,i),h=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await K5(h,o,s,f,a,c),h}return null}const rW=Object.freeze(Object.defineProperty({__proto__:null,decode:tW,name:eW},Symbol.toStringTag,{value:"Module"})),ma="EXT_texture_webp",iW=ma;function sW(t,e){const n=new Kn(t);if(!dD("image/webp")){if(n.getRequiredExtensions().includes(ma))throw new Error("gltf: Required extension ".concat(ma," not supported by browser"));return}const{json:r}=n;for(const i of r.textures||[]){const s=n.getObjectExtension(i,ma);s&&(i.source=s.source),n.removeObjectExtension(i,ma)}n.removeExtension(ma)}const oW=Object.freeze(Object.defineProperty({__proto__:null,name:iW,preprocess:sW},Symbol.toStringTag,{value:"Module"})),dh="KHR_texture_basisu",aW=dh;function cW(t,e){const n=new Kn(t),{json:r}=n;for(const i of r.textures||[]){const s=n.getObjectExtension(i,dh);s&&(i.source=s.source),n.removeObjectExtension(i,dh)}n.removeExtension(dh)}const lW=Object.freeze(Object.defineProperty({__proto__:null,name:aW,preprocess:cW},Symbol.toStringTag,{value:"Module"})),uW="3.4.14",fW={draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},hW={name:"Draco",id:Qi?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:uW,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:fW};function dW(t,e,n){const r=nI(e.metadata),i=[],s=gW(e.attributes);for(const o in t){const a=t[o],c=DT(o,a,s[o]);i.push(c)}if(n){const o=DT("indices",n);i.push(o)}return new Ba(i,r)}function gW(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}function DT(t,e,n){const r=n?nI(n.metadata):void 0;return Y8(t,e,r)}function nI(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const NT={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},pW={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},mW=4;class vW{constructor(e){g(this,"draco",void 0),g(this,"decoder",void 0),g(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const i=this.decoder.GetEncodedGeometryType(r),s=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(i){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(r,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(r,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const h="DRACO decompression failed: ".concat(o.error_msg());throw new Error(h)}const a=this._getDracoLoaderData(s,i,n),c=this._getMeshData(s,a,n),l=HR(c.attributes),u=dW(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:l},...c,schema:u}}finally{this.draco.destroy(r),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,n,r){const i=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:s}}_getDracoAttributes(e,n){const r={};for(let i=0;i<e.num_attributes();i++){const s=this.decoder.GetAttribute(e,i),o=this._getAttributeMetadata(e,i);r[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:i,metadata:o};const a=this._getQuantizationTransform(s,n);a&&(r[s.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(s,n);c&&(r[s.unique_id()].octahedron_transform=c)}return r}_getMeshData(e,n,r){const i=this._getMeshAttributes(n,e,r);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(r.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,n,r){const i={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,r);s.name=o;const{value:a,size:c}=this._getAttributeValues(n,s);i[o]={value:a,size:c,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return i}_getTriangleListIndices(e){const r=e.num_faces()*3,i=r*mW,s=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,s),new Uint32Array(this.draco.HEAPF32.buffer,s,r).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),bW(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const r=pW[n.data_type],i=n.num_components,o=e.num_points()*i,a=o*r.BYTES_PER_ELEMENT,c=yW(this.draco,r);let l;const u=this.draco._malloc(a);try{const f=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,f,c,a,u),l=new r(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:l,size:i}}_deduceAttributeName(e,n){const r=e.unique_id;for(const[o,a]of Object.entries(n.extraAttributes||{}))if(a===r)return o;const i=e.attribute_type;for(const o in NT)if(this.draco[o]===i)return NT[o];const s=n.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(r)}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},r=this.metadataQuerier.NumEntries(e);for(let i=0;i<r;i++){const s=this.metadataQuerier.GetEntryName(e,i);n[s]=this._getDracoMetadataField(e,s)}return n}_getDracoMetadataField(e,n){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);const i=_W(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:i}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,i=[...n,...r];for(const s of i)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,n){const{quantizedAttributes:r=[]}=n,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:r=[]}=n,i=e.attribute_type();if(r.map(o=>this.decoder[o]).includes(i)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}function yW(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function _W(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function bW(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}const AW="1.5.5",j_="https://www.gstatic.com/draco/versioned/decoders/".concat(AW),EW="".concat(j_,"/draco_decoder.js"),TW="".concat(j_,"/draco_wasm_wrapper.js"),SW="".concat(j_,"/draco_decoder.wasm");let $c;async function CW(t){const e=t.modules||{};return e.draco3d?$c=$c||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):$c=$c||wW(t),await $c}async function wW(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await Ao(EW,"draco",t);break;case"wasm":default:[e,n]=await Promise.all([await Ao(TW,"draco",t),await Ao(SW,"draco",t)])}return e=e||globalThis.DracoDecoderModule,await xW(e,n)}function xW(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:i=>r({draco:i})})})}const rI={...hW,parse:PW};async function PW(t,e){const{draco:n}=await CW(e),r=new vW(n);try{return r.parseSync(t,e==null?void 0:e.draco)}finally{r.destroy()}}function MW(t){const e={};for(const n in t){const r=t[n];if(n!=="indices"){const i=iI(r);e[n]=i}}return e}function iI(t){const{buffer:e,size:n,count:r}=RW(t);return{value:e,size:n,byteOffset:0,count:r,type:ZR(n),componentType:eI(e)}}function RW(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=IW(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function IW(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}const Do="KHR_draco_mesh_compression",LW=Do;function BW(t,e,n){const r=new Kn(t);for(const i of sI(r))r.getObjectExtension(i,Do)}async function OW(t,e,n){var r;if(!(e!=null&&(r=e.gltf)!==null&&r!==void 0&&r.decompressMeshes))return;const i=new Kn(t),s=[];for(const o of sI(i))i.getObjectExtension(o,Do)&&s.push(DW(i,o,e,n));await Promise.all(s),i.removeExtension(Do)}function FW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new Kn(t);for(const r of n.json.meshes||[])NW(r,e),n.addRequiredExtension(Do)}async function DW(t,e,n,r){const i=t.getObjectExtension(e,Do);if(!i)return;const s=t.getTypedArrayForBufferView(i.bufferView),o=Hy(s.buffer,s.byteOffset),{parse:a}=r,c={...n};delete c["3d-tiles"];const l=await a(o,rI,c,r),u=MW(l.attributes);for(const[f,h]of Object.entries(u))if(f in e.attributes){const d=e.attributes[f],p=t.getAccessor(d);p!=null&&p.min&&p!==null&&p!==void 0&&p.max&&(h.min=p.min,h.max=p.max)}e.attributes=u,l.indices&&(e.indices=iI(l.indices)),kW(e)}function NW(t,e){var n;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:t}),a=s==null||(n=s.parseSync)===null||n===void 0?void 0:n.call(s,{attributes:t}),c=i._addFauxAttributes(a.attributes),l=i.addBufferView(o);return{primitives:[{attributes:c,mode:r,extensions:{[Do]:{bufferView:l,attributes:c}}}]}}function kW(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*sI(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const UW=Object.freeze(Object.defineProperty({__proto__:null,decode:OW,encode:FW,name:LW,preprocess:BW},Symbol.toStringTag,{value:"Module"})),GW={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},zW={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},V_="KHR_texture_transform",HW=V_,Sf=new B,jW=new bt,VW=new bt;async function WW(t,e){if(!new Kn(t).getExtension(V_))return;const i=t.json.materials||[];for(let s=0;s<i.length;s++)$W(s,t)}function $W(t,e){var n,r,i;const s=[],o=(n=e.json.materials)===null||n===void 0?void 0:n[t],a=o==null||(r=o.pbrMetallicRoughness)===null||r===void 0?void 0:r.baseColorTexture;a&&Xc(e,t,a,s);const c=o==null?void 0:o.emissiveTexture;c&&Xc(e,t,c,s);const l=o==null?void 0:o.normalTexture;l&&Xc(e,t,l,s);const u=o==null?void 0:o.occlusionTexture;u&&Xc(e,t,u,s);const f=o==null||(i=o.pbrMetallicRoughness)===null||i===void 0?void 0:i.metallicRoughnessTexture;f&&Xc(e,t,f,s)}function Xc(t,e,n,r){const i=XW(n,r);if(!i)return;const s=t.json.meshes||[];for(const o of s)for(const a of o.primitives){const c=a.material;Number.isFinite(c)&&e===c&&JW(t,a,i)}}function XW(t,e){var n;const r=(n=t.extensions)===null||n===void 0?void 0:n[V_],{texCoord:i=0}=t,{texCoord:s=i}=r;if(!(e.findIndex(a=>{let[c,l]=a;return c===i&&l===s})!==-1)){const a=qW(r);return i!==s&&(t.texCoord=s),e.push([i,s]),{originalTexCoord:i,texCoord:s,matrix:a}}return null}function JW(t,e,n){const{originalTexCoord:r,texCoord:i,matrix:s}=n,o=e.attributes["TEXCOORD_".concat(r)];if(Number.isFinite(o)){var a;const l=(a=t.json.accessors)===null||a===void 0?void 0:a[o];if(l&&l.bufferView){var c;const u=(c=t.json.bufferViews)===null||c===void 0?void 0:c[l.bufferView];if(u){const{arrayBuffer:f,byteOffset:h}=t.buffers[u.buffer],d=(h||0)+(l.byteOffset||0)+(u.byteOffset||0),{ArrayType:p,length:y}=z_(l,u),b=zW[l.componentType],v=GW[l.type],m=u.byteStride||b*v,_=new Float32Array(y);for(let A=0;A<l.count;A++){const S=new p(f,d+A*m,2);Sf.set(S[0],S[1],1),Sf.transformByMatrix3(s),_.set([Sf[0],Sf[1]],A*v)}r===i?KW(l,u,t.buffers,_):YW(i,l,e,t,_)}}}}function KW(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function YW(t,e,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const s=r.json.bufferViews;if(!s)return;s.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const o=r.json.accessors;o&&(o.push({bufferView:(s==null?void 0:s.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes["TEXCOORD_".concat(t)]=o.length-1)}function qW(t){const{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,i=new bt().set(1,0,0,0,1,0,e[0],e[1],1),s=jW.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),o=VW.set(r[0],0,0,0,r[1],0,0,0,1);return i.multiplyRight(s).multiplyRight(o)}const QW=Object.freeze(Object.defineProperty({__proto__:null,decode:WW,name:HW},Symbol.toStringTag,{value:"Module"})),mo="KHR_lights_punctual",ZW=mo;async function e$(t){const e=new Kn(t),{json:n}=e,r=e.getExtension(mo);r&&(e.json.lights=r.lights,e.removeExtension(mo));for(const i of n.nodes||[]){const s=e.getObjectExtension(i,mo);s&&(i.light=s.light),e.removeObjectExtension(i,mo)}}async function t$(t){const e=new Kn(t),{json:n}=e;if(n.lights){const r=e.addExtension(mo);cr(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(const r of e.json.lights){const i=r.node;e.addObjectExtension(i,mo,r)}delete e.json.lights}}const n$=Object.freeze(Object.defineProperty({__proto__:null,decode:e$,encode:t$,name:ZW},Symbol.toStringTag,{value:"Module"})),ql="KHR_materials_unlit",r$=ql;async function i$(t){const e=new Kn(t),{json:n}=e;for(const r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,ql);e.removeExtension(ql)}function s$(t){const e=new Kn(t),{json:n}=e;if(e.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,ql,{}),e.addExtension(ql))}const o$=Object.freeze(Object.defineProperty({__proto__:null,decode:i$,encode:s$,name:r$},Symbol.toStringTag,{value:"Module"})),ol="KHR_techniques_webgl",a$=ol;async function c$(t){const e=new Kn(t),{json:n}=e,r=e.getExtension(ol);if(r){const i=u$(r,e);for(const s of n.materials||[]){const o=e.getObjectExtension(s,ol);o&&(s.technique=Object.assign({},o,i[o.technique]),s.technique.values=f$(s.technique,e)),e.removeObjectExtension(s,ol)}e.removeExtension(ol)}}async function l$(t,e){}function u$(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,s=new TextDecoder;return r.forEach(o=>{if(Number.isFinite(o.bufferView))o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(o=>{o.fragmentShader=r[o.fragmentShader],o.vertexShader=r[o.vertexShader]}),i.forEach(o=>{o.program=n[o.program]}),i}function f$(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]=="object"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}const h$=Object.freeze(Object.defineProperty({__proto__:null,decode:c$,encode:l$,name:a$},Symbol.toStringTag,{value:"Module"})),oI="EXT_feature_metadata",d$=oI;async function g$(t){const e=new Kn(t);p$(e)}function p$(t){var e;const n=t.getExtension(oI),r=n==null||(e=n.schema)===null||e===void 0?void 0:e.classes,i=n==null?void 0:n.featureTables;if((n==null?void 0:n.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),r&&i)for(const o in r){const a=r[o],c=y$(i,o);c&&m$(t,c,a)}}function m$(t,e,n){for(const i in n.properties){var r;const s=n.properties[i],o=e==null||(r=e.properties)===null||r===void 0?void 0:r[i],a=e.count;if(o){const c=v$(t,s,a,o);o.data=c}}}function v$(t,e,n,r){const i=r.bufferView;let s=t.getTypedArrayForBufferView(i);switch(e.type){case"STRING":{const o=r.stringOffsetBufferView,a=t.getTypedArrayForBufferView(o);s=_$(s,a,n);break}}return s}function y$(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}function _$(t,e,n){const r=[],i=new TextDecoder("utf8");let s=0;const o=4;for(let a=0;a<n;a++){const c=e[(a+1)*o]-e[a*o],l=t.subarray(s,c+s),u=i.decode(l);r.push(u),s+=c}return r}const b$=Object.freeze(Object.defineProperty({__proto__:null,decode:g$,name:d$},Symbol.toStringTag,{value:"Module"})),aI=[rW,oW,lW,UW,n$,o$,h$,QW,b$];function A$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=aI.filter(s=>cI(s.name,e));for(const s of r){var i;(i=s.preprocess)===null||i===void 0||i.call(s,t,e,n)}}async function E$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=aI.filter(s=>cI(s.name,e));for(const s of r){var i;await((i=s.decode)===null||i===void 0?void 0:i.call(s,t,e,n))}}function cI(t,e){var n;const r=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}const Jp="KHR_binary_glTF";function T$(t){const e=new Kn(t),{json:n}=e;for(const r of n.images||[]){const i=e.getObjectExtension(r,Jp);i&&Object.assign(r,i),e.removeObjectExtension(r,Jp)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(Jp)}const kT={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},S$={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class C${constructor(){g(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),g(this,"json",void 0)}normalize(e,n){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(r.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),T$(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in kT)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(const i in r){const s=r[i];s.id=s.id||i;const o=e[n].length;e[n].push(s),this.idToIndexMap[n][i]=o}}}_convertObjectIdsToArrayIndices(e){for(const n in kT)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:r,indices:i,material:s}=n;for(const o in r)r[o]=this._convertIdToIndex(r[o],"accessor");i&&(n.indices=this._convertIdToIndex(i,"accessor")),s&&(n.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);for(const r of e[n])for(const i in r){const s=r[i],o=this._convertIdToIndex(s,i);r[i]=o}}_convertIdToIndex(e,n){const r=S$[n];if(r in this.idToIndexMap){const i=this.idToIndexMap[r][e];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return i}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const s of e.materials){var n,r,i;s.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const o=((n=s.values)===null||n===void 0?void 0:n.tex)||((r=s.values)===null||r===void 0?void 0:r.texture2d_0)||((i=s.values)===null||i===void 0?void 0:i.diffuseTex),a=e.textures.findIndex(c=>c.id===o);a!==-1&&(s.pbrMetallicRoughness.baseColorTexture={index:a})}}}function w$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new C$().normalize(t,e)}const x$={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},P$={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},br={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},M$={magFilter:br.TEXTURE_MAG_FILTER,minFilter:br.TEXTURE_MIN_FILTER,wrapS:br.TEXTURE_WRAP_S,wrapT:br.TEXTURE_WRAP_T},R$={[br.TEXTURE_MAG_FILTER]:br.LINEAR,[br.TEXTURE_MIN_FILTER]:br.NEAREST_MIPMAP_LINEAR,[br.TEXTURE_WRAP_S]:br.REPEAT,[br.TEXTURE_WRAP_T]:br.REPEAT};function I$(t){return P$[t]}function L$(t){return x$[t]}class B${constructor(){g(this,"baseUri",""),g(this,"json",{}),g(this,"buffers",[]),g(this,"images",[])}postProcess(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:r,buffers:i=[],images:s=[],baseUri:o=""}=e;return cr(r),this.baseUri=o,this.json=r,this.buffers=i,this.images=s,this._resolveTree(this.json,n),this.json}_resolveTree(e){e.bufferViews&&(e.bufferViews=e.bufferViews.map((n,r)=>this._resolveBufferView(n,r))),e.images&&(e.images=e.images.map((n,r)=>this._resolveImage(n,r))),e.samplers&&(e.samplers=e.samplers.map((n,r)=>this._resolveSampler(n,r))),e.textures&&(e.textures=e.textures.map((n,r)=>this._resolveTexture(n,r))),e.accessors&&(e.accessors=e.accessors.map((n,r)=>this._resolveAccessor(n,r))),e.materials&&(e.materials=e.materials.map((n,r)=>this._resolveMaterial(n,r))),e.meshes&&(e.meshes=e.meshes.map((n,r)=>this._resolveMesh(n,r))),e.nodes&&(e.nodes=e.nodes.map((n,r)=>this._resolveNode(n,r))),e.skins&&(e.skins=e.skins.map((n,r)=>this._resolveSkin(n,r))),e.scenes&&(e.scenes=e.scenes.map((n,r)=>this._resolveScene(n,r))),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),r}_resolveScene(e,n){return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(r=>this.getNode(r)),e}_resolveNode(e,n){return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(r=>this.getNode(r))),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce((r,i)=>{const s=this.getMesh(i);return r.id=s.id,r.primitives=r.primitives.concat(s.primitives),r},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,n){return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(r=>{r={...r};const i=r.attributes;r.attributes={};for(const s in i)r.attributes[s]=this.getAccessor(i[s]);return r.indices!==void 0&&(r.indices=this.getAccessor(r.indices)),r.material!==void 0&&(r.material=this.getMaterial(r.material)),r})),e}_resolveMaterial(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture={...r.baseColorTexture},r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture={...r.metallicRoughnessTexture},r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,n){if(e.id=e.id||"accessor-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=I$(e.componentType),e.components=L$(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const r=e.bufferView.buffer,{ArrayType:i,byteLength:s}=z_(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+r.byteOffset;let a=r.arrayBuffer.slice(o,o+s);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(r,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new i(a)}return e}_getValueFromInterleavedBuffer(e,n,r,i,s){const o=new Uint8Array(s*i);for(let a=0;a<s;a++){const c=n+a*r;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+i)),a*i)}return o.buffer}_resolveTexture(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):R$,e.source=this.getImage(e.source),e}_resolveSampler(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(const r in e){const i=this._enumSamplerParameter(r);i!==void 0&&(e.parameters[i]=e[r])}return e}_enumSamplerParameter(e){return M$[e]}_resolveImage(e,n){e.id=e.id||"image-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));const r=this.images[n];return r&&(e.image=r),e}_resolveBufferView(e,n){const r=e.buffer,i={id:"bufferView-".concat(n),...e,buffer:this.buffers[r]},s=this.buffers[r].arrayBuffer;let o=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),i.data=new Uint8Array(s,o,e.byteLength),i}_resolveCamera(e,n){return e.id=e.id||"camera-".concat(n),e.perspective,e.orthographic,e}}function O$(t,e){return new B$().postProcess(t,e)}const UT=1735152710,W_=12,hd=8,F$=1313821514,D$=5130562,N$=0,k$=1,U$=0,dc=!0;function G$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function z$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new DataView(t),{magic:i=UT}=n,s=r.getUint32(e,!1);return s===i||s===UT}function H$(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e),i=G$(r,n+0),s=r.getUint32(n+4,dc),o=r.getUint32(n+8,dc);switch(Object.assign(t,{header:{byteOffset:n,byteLength:o,hasBinChunk:!1},type:i,version:s,json:{},binChunks:[]}),n+=W_,t.version){case 1:return j$(t,r,n);case 2:return V$(t,r,n,{});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}function j$(t,e,n){$e(t.header.byteLength>W_+hd);const r=e.getUint32(n+0,dc),i=e.getUint32(n+4,dc);return n+=hd,$e(i===U$),iv(t,e,n,r),n+=r,n+=sv(t,e,n,t.header.byteLength),n}function V$(t,e,n,r){return $e(t.header.byteLength>W_+hd),W$(t,e,n,r),n+t.header.byteLength}function W$(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,dc),s=e.getUint32(n+4,dc);switch(n+=hd,s){case F$:iv(t,e,n,i);break;case D$:sv(t,e,n,i);break;case N$:r.strict||iv(t,e,n,i);break;case k$:r.strict||sv(t,e,n,i);break}n+=gu(i,4)}return n}function iv(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),gu(r,4)}function sv(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),gu(r,4)}async function $$(t,e){var n,r,i,s;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0;X$(t,e,o,a),w$(t,{normalize:a==null||(n=a.gltf)===null||n===void 0?void 0:n.normalize}),A$(t,a,c);const l=[];if(a!=null&&(r=a.gltf)!==null&&r!==void 0&&r.loadBuffers&&t.json.buffers&&await J$(t,a,c),a!=null&&(i=a.gltf)!==null&&i!==void 0&&i.loadImages){const f=K$(t,a,c);l.push(f)}const u=E$(t,a,c);return l.push(u),await Promise.all(l),a!=null&&(s=a.gltf)!==null&&s!==void 0&&s.postProcess?O$(t,a):t}function X$(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!z$(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=u3(e);else if(e instanceof ArrayBuffer){const o={};n=H$(o,e,n,r.glb),cr(o.type==="glTF","Invalid GLB magic string ".concat(o.type)),t._glb=o,t.json=o.json}else cr(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:o}=t._glb;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}const s=t.json.images||[];t.images=new Array(s.length).fill({})}async function J$(t,e,n){const r=t.json.buffers||[];for(let o=0;o<r.length;++o){const a=r[o];if(a.uri){var i,s;const{fetch:c}=n;cr(c);const l=QR(a.uri,e),u=await(n==null||(i=n.fetch)===null||i===void 0?void 0:i.call(n,l)),f=await(u==null||(s=u.arrayBuffer)===null||s===void 0?void 0:s.call(u));t.buffers[o]={arrayBuffer:f,byteOffset:0,byteLength:f.byteLength},delete a.uri}else t.buffers[o]===null&&(t.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function K$(t,e,n){const r=Y$(t),i=t.json.images||[],s=[];for(const o of r)s.push(q$(t,i[o],o,e,n));return await Promise.all(s)}function Y$(t){const e=new Set,n=t.json.textures||[];for(const r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function q$(t,e,n,r,i){const{fetch:s,parse:o}=i;let a;if(e.uri&&!e.hasOwnProperty("bufferView")){const l=QR(e.uri,r);a=await(await s(l)).arrayBuffer(),e.bufferView={data:a}}if(Number.isFinite(e.bufferView)){const l=D5(t.json,t.buffers,e.bufferView);a=Hy(l.buffer,l.byteOffset,l.byteLength)}cr(a,"glTF image has no data");let c=await o(a,[kP,F5],{mimeType:e.mimeType,basis:r.basis||{format:qR()}},i);c&&c[0]&&(c={compressed:!0,mipmaps:!1,width:c[0].width,height:c[0].height,data:c[0]}),t.images=t.images||[],t.images[n]=c}const Ql={name:"glTF",id:"gltf",module:"gltf",version:y5,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:Q$,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function Q$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;e={...Ql.options,...e},e.gltf={...Ql.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await $$({},t,r,e,n)}async function Z$(t){const e=[];return t.scenes.forEach(n=>{n.traverse(r=>{Object.values(r.model.getUniforms()).forEach(i=>{i.loaded===!1&&e.push(i)})})}),await e7(()=>e.some(n=>!n.loaded))}async function e7(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}const t7=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,n7=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,lI=[255,255,255,255],r7={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene=="object"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:lI},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[Ql]};class $_ extends Fr{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){const e=[Ys,qs];return this.props._lighting==="pbr"&&e.push(__),super.getShaders({vs:t7,fs:n7,modules:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:lI,transition:!0},instanceModelMatrix:GR})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.scenegraph!==r.scenegraph?this._updateScenegraph():n._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:n}=this.context;let r=null;if(e.scenegraph instanceof Ka)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,c=v5(n,a,this._getModelOptions());r={gltf:a,...c},Z$(c).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(de.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);const i={layer:this,gl:n},s=e.getScene(r,i),o=e.getAnimator(r,i);s instanceof Ka?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,o,e._animations),this.setState({scenegraph:s,animator:o})):s!==null&&de.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const n=this.getAttributeManager().getAttributes();e.traverse(r=>{this._setModelAttributes(r.model,n)})}}_applyAnimationsProp(e,n,r){if(!e||!n||!r)return;const i=n.getAnimations();Object.keys(r).sort().forEach(s=>{const o=r[s];if(s==="*")i.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(s))){const a=Number(s);a>=0&&a<i.length?Object.assign(i[a],o):de.warn("animation ".concat(s," not found"))()}else{const a=i.find(({name:c})=>c===s);a?Object.assign(a,o):de.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof Ka&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let n=null;return e&&(typeof e=="function"?n=e({gl:this.context.gl,layer:this}):n=e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:n,modelOptions:{isInstanced:!0,transpileToGLSL100:!_e(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(n=>{this._setModelAttributes(n.model,e)})}draw({moduleParameters:e=null,parameters:n={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:i}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:c,coordinateSystem:l}=this.props,u=this.getNumInstances();this.state.scenegraph.traverse((f,{worldMatrix:h})=>{f.model.setInstanceCount(u),f.updateModuleSettings(e),f.draw({parameters:n,uniforms:{sizeScale:s,opacity:c,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:zR(i,l),sceneModelMatrix:h,u_Camera:f.model.getUniforms().project_uCameraPosition}})})}}g($_,"defaultProps",r7);g($_,"layerName","ScenegraphLayer");const i7=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,s7=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function o7(t){t.COLOR_0||t.colors||(t.colors={constant:!0,value:new Float32Array([1,1,1])})}const a7={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class X_ extends G_{getShaders(){const e=super.getShaders();return e.modules.push(__),{...e,vs:i7,fs:s7}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const n=this.getAttributeManager();e&&n.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(e){const{featureIds:n}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:!!n}),super.draw(e))}getModel(e){const{id:n,pbrMaterial:r}=this.props,i=this.parseMaterial(r,e);this.setState({materialParser:i});const s=this.getShaders();return o7(e.attributes),new Br(this.context.gl,{...this.getShaders(),id:n,geometry:e,defines:{...s.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:e.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:n}=this.state;if(n){const{mesh:r}=this.props,i=this.parseMaterial(e,r);this.setState({materialParser:i}),n.setUniforms(i.uniforms)}}parseMaterial(e,n){var r;const i=!!(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return(r=this.state.materialParser)===null||r===void 0||r.delete(),new JR(this.context.gl,{attributes:{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},material:{unlit:i,...e},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const n=this.props.featureIds,r=new Uint8ClampedArray(n.length*e.size),i=[];for(let s=0;s<n.length;s++)this.encodePickingColor(n[s],i),r[s*3]=i[0],r[s*3+1]=i[1],r[s*3+2]=i[2];e.value=r}finalizeState(e){var n;super.finalizeState(e),(n=this.state.materialParser)===null||n===void 0||n.delete(),this.setState({materialParser:null})}}g(X_,"layerName","MeshLayer");g(X_,"defaultProps",a7);const c7=6378137,l7=6378137,u7=6356752314245179e-9;function og(t){return t}new B;function f7(t,e=[],n=og){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function h7(t,e=[]){return f7(t,e,Ht._cartographicRadians?og:AG)}function d7(t,e,n=og){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function g7(t,e){return d7(t,e,Ht._cartographicRadians?og:EG)}const la=new B,p7=new B,m7=new B;function v7(t,e,n=[]){const{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:s}=e;la.from(t);const o=la.x,a=la.y,c=la.z,l=r.x,u=r.y,f=r.z,h=o*o*l*l,d=a*a*u*u,p=c*c*f*f,y=h+d+p,b=Math.sqrt(1/y);if(!Number.isFinite(b))return;const v=p7;if(v.copy(t).scale(b),y<s)return v.to(n);const m=i.x,_=i.y,A=i.z,S=m7;S.set(v.x*m*2,v.y*_*2,v.z*A*2);let w=(1-b)*la.len()/(.5*S.len()),x=0,M,L,R,I;do{w-=x,M=1/(1+w*m),L=1/(1+w*_),R=1/(1+w*A);const N=M*M,k=L*L,z=R*R,$=N*M,V=k*L,U=z*R;I=h*N+d*k+p*z-1;const D=-2*(h*$*m+d*V*_+p*U*A);x=I/D}while(Math.abs(I)>Wl.EPSILON12);return la.scale([M,L,R]).to(n)}const GT=1e-14,y7=new B,zT={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Kp={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Jc={east:new B,north:new B,up:new B,west:new B,south:new B,down:new B},_7=new B,b7=new B,A7=new B;function HT(t,e,n,r,i,s){const o=zT[e]&&zT[e][n];Zr(o&&(!r||r===o));let a,c,l;const u=y7.copy(i);if(ci(u.x,0,GT)&&ci(u.y,0,GT)){const h=Math.sign(u.z);a=_7.fromArray(Kp[e]),e!=="east"&&e!=="west"&&a.scale(h),c=b7.fromArray(Kp[n]),n!=="east"&&n!=="west"&&c.scale(h),l=A7.fromArray(Kp[r]),r!=="east"&&r!=="west"&&l.scale(h)}else{const{up:h,east:d,north:p}=Jc;d.set(-u.y,u.x,0).normalize(),t.geodeticSurfaceNormal(u,h),p.copy(h).cross(d);const{down:y,west:b,south:v}=Jc;y.copy(h).scale(-1),b.copy(d).scale(-1),v.copy(p).scale(-1),a=Jc[e],c=Jc[n],l=Jc[r]}return s[0]=a.x,s[1]=a.y,s[2]=a.z,s[3]=0,s[4]=c.x,s[5]=c.y,s[6]=c.z,s[7]=0,s[8]=l.x,s[9]=l.y,s[10]=l.z,s[11]=0,s[12]=u.x,s[13]=u.y,s[14]=u.z,s[15]=1,s}const Cf=new B,jT=new B,E7=new B,$r=new B,T7=new B,wf=new B;class ct{constructor(e=0,n=0,r=0){g(this,"radii",void 0),g(this,"radiiSquared",void 0),g(this,"radiiToTheFourth",void 0),g(this,"oneOverRadii",void 0),g(this,"oneOverRadiiSquared",void 0),g(this,"minimumRadius",void 0),g(this,"maximumRadius",void 0),g(this,"centerToleranceSquared",Wl.EPSILON1),g(this,"squaredXOverSquaredZ",void 0),Zr(e>=0),Zr(n>=0),Zr(r>=0),this.radii=new B(e,n,r),this.radiiSquared=new B(e*e,n*n,r*r),this.radiiToTheFourth=new B(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new B(e===0?0:1/e,n===0?0:1/n,r===0?0:1/r),this.oneOverRadiiSquared=new B(e===0?0:1/(e*e),n===0?0:1/(n*n),r===0?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){const r=jT,i=E7,[,,s]=e;this.geodeticSurfaceNormalCartographic(e,r),i.copy(this.radiiSquared).scale(r);const o=Math.sqrt(r.dot(i));return i.scale(1/o),r.scale(s),i.add(r),i.to(n)}cartesianToCartographic(e,n=[0,0,0]){wf.from(e);const r=this.scaleToGeodeticSurface(wf,$r);if(!r)return;const i=this.geodeticSurfaceNormal(r,jT),s=T7;s.copy(wf).subtract(r);const o=Math.atan2(i.y,i.x),a=Math.asin(i.z),c=Math.sign(g_(s,wf))*CM(s);return g7([o,a,c],n)}eastNorthUpToFixedFrame(e,n=new Ee){return HT(this,"east","north","up",e,n)}localFrameToFixedFrame(e,n,r,i,s=new Ee){return HT(this,e,n,r,i,s)}geocentricSurfaceNormal(e,n=[0,0,0]){return Cf.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){const r=h7(e),i=r[0],s=r[1],o=Math.cos(s);return Cf.set(o*Math.cos(i),o*Math.sin(i),Math.sin(s)).normalize(),Cf.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return Cf.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return v7(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){$r.from(e);const r=$r.x,i=$r.y,s=$r.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(r*r*o.x+i*i*o.y+s*s*o.z);return $r.multiplyScalar(a).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return $r.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return $r.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,r=[0,0,0]){Zr(ci(this.radii.x,this.radii.y,Wl.EPSILON15)),Zr(this.radii.z>0),$r.from(e);const i=$r.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return $r.set(0,0,i).to(r)}}g(ct,"WGS84",new ct(c7,l7,u7));function VT(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class WT{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=VT(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(VT()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class S7{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof WT?i=e:i=new WT(n,r),this.stats[n]=i),i}}class C7{constructor(e,n,r){g(this,"item",void 0),g(this,"previous",void 0),g(this,"next",void 0),this.item=e,this.previous=n,this.next=r}}class w7{constructor(){g(this,"head",null),g(this,"tail",null),g(this,"_length",0)}get length(){return this._length}add(e){const n=new C7(e,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,n){e!==n&&(this.remove(n),this._insert(e,n))}_insert(e,n){const r=e.next;e.next=n,this.tail===e?this.tail=n:r.previous=n,n.next=r,n.previous=e,++this._length}}class x7{constructor(){g(this,"_list",void 0),g(this,"_sentinel",void 0),g(this,"_trimTiles",void 0),this._list=new w7,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const n=e._cacheNode;n&&this._list.splice(this._sentinel,n)}add(e,n,r){n._cacheNode||(n._cacheNode=this._list.add(n),r&&r(e,n))}unloadTile(e,n,r){const i=n._cacheNode;i&&(this._list.remove(i),n._cacheNode=null,r&&r(e,n))}unloadTiles(e,n){const r=this._trimTiles;this._trimTiles=!1;const i=this._list,s=e.maximumMemoryUsage*1024*1024,o=this._sentinel;let a=i.head;for(;a!==o&&(e.gpuMemoryUsageInBytes>s||r);){const c=a.item;a=a.next,this.unloadTile(e,c,n)}}trim(){this._trimTiles=!0}}function P7(t,e){$e(t),$e(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:s}}=t;let o=new Ee(i);switch(n&&o.translate(n),r){case"Z":break;case"Y":const f=new Ee().rotateX(Math.PI/2);o=o.multiplyRight(f);break;case"X":const h=new Ee().rotateY(-Math.PI/2);o=o.multiplyRight(h);break}e.isQuantized&&o.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new B(s);e.cartesianModelMatrix=o,e.cartesianOrigin=a;const c=ct.WGS84.cartesianToCartographic(a,new B),u=ct.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=u.multiplyRight(o),e.cartographicOrigin=c,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const $T=new B,Yp=new B,ov=new wr([new Qr,new Qr,new Qr,new Qr,new Qr,new Qr]);function M7(t,e){const{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:s}=t.distanceScales,o=gh(t,t.center),a=ct.WGS84.eastNorthUpToFixedFrame(o),c=t.unprojectPosition(t.cameraPosition),l=ct.WGS84.cartographicToCartesian(c,new B),u=new B(a.transformAsVector(new B(n).scale(s))).normalize(),f=new B(a.transformAsVector(new B(r).scale(s))).normalize();I7(t);const h=t.constructor,{longitude:d,latitude:p,width:y,bearing:b,zoom:v}=t,m=new h({longitude:d,latitude:p,height:i,width:y,bearing:b,zoom:v,pitch:0});return{camera:{position:l,direction:u,up:f},viewport:t,topDownViewport:m,height:i,cullingVolume:ov,frameNumber:e,sseDenominator:1.15}}function R7(t,e,n){if(n===0||t.length<=n)return[t,[]];const r=[],{longitude:i,latitude:s}=e.viewport;for(const[l,u]of t.entries()){const[f,h]=u.header.mbs,d=Math.abs(i-f),p=Math.abs(s-h),y=Math.sqrt(p*p+d*d);r.push([l,y])}const o=r.sort((l,u)=>l[1]-u[1]),a=[];for(let l=0;l<n;l++)a.push(t[o[l][0]]);const c=[];for(let l=n;l<o.length;l++)c.push(t[o[l][0]]);return[a,c]}function I7(t){const e=t.getFrustumPlanes(),n=XT(e.near,t.cameraPosition),r=gh(t,n),i=gh(t,t.cameraPosition,Yp);let s=0;ov.planes[s++].fromPointNormal(r,$T.copy(r).subtract(i));for(const o in e){if(o==="near")continue;const a=e[o],c=XT(a,n,Yp),l=gh(t,c,Yp);ov.planes[s++].fromPointNormal(l,$T.copy(r).subtract(l))}}function XT(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new B;const r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function gh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new B;const r=t.unprojectPosition(e);return ct.WGS84.cartographicToCartesian(r,n)}const L7=6378137,B7=6378137,av=6356752314245179e-9,JT=new B;function O7(t,e){if(t instanceof wu){const{halfAxes:n}=t,r=D7(n);return Math.log2(av/(r+e[2]))}else if(t instanceof Cu){const{radius:n}=t;return Math.log2(av/(n+e[2]))}else if(t.width&&t.height){const{width:n,height:r}=t,i=Math.log2(L7/n),s=Math.log2(B7/r);return(i+s)/2}return 1}function uI(t,e,n){const r=ct.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new B),i=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));return Math.log2(av/(i+e[2]))}function F7(t,e,n){const[r,i,s,o]=t;return uI({xmin:r,xmax:s,ymin:i,ymax:o,zmin:0,zmax:0},e,n)}function D7(t){t.getColumn(0,JT);const e=t.getColumn(1),n=t.getColumn(2);return JT.add(e).add(n).len()}const er={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Zi={ADD:1,REPLACE:2},Ya={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},_r={I3S:"I3S",TILES3D:"TILES3D"},ag={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},N7={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function fI(t){return t!=null}const mn=new B,ph=new B,k7=new B,U7=new B;function qp(t,e,n){if($e(t,"3D Tile: boundingVolume must be defined"),t.box)return z7(t.box,e,n);if(t.region){const[r,i,s,o,a,c]=t.region,l=ct.WGS84.cartographicToCartesian([Ki(r),Ki(o),a],k7),u=ct.WGS84.cartographicToCartesian([Ki(s),Ki(i),c],U7),f=new B().addVectors(l,u).multiplyScalar(.5),h=new B().subVectors(l,u).len()/2;return KT([f[0],f[1],f[2],h],new Ee)}if(t.sphere)return KT(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function G7(t,e){if(t.box)return H7(e);if(t.region){const[n,r,i,s,o,a]=t.region;return[[Ki(n),Ki(r),o],[Ki(i),Ki(s),a]]}if(t.sphere)return j7(e);throw new Error("Unkown boundingVolume type")}function z7(t,e,n){const r=new B(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(t.length===10){const l=t.slice(3,6),u=new Vl;u.fromArray(t,6);const f=new B([1,0,0]),h=new B([0,1,0]),d=new B([0,0,1]);f.transformByQuaternion(u),f.scale(l[0]),h.transformByQuaternion(u),h.scale(l[1]),d.transformByQuaternion(u),d.scale(l[2]),i=[...f.toArray(),...h.toArray(),...d.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const s=e.transformAsVector(i.slice(0,3)),o=e.transformAsVector(i.slice(3,6)),a=e.transformAsVector(i.slice(6,9)),c=new bt([s[0],s[1],s[2],o[0],o[1],o[2],a[0],a[1],a[2]]);return fI(n)?(n.center=r,n.halfAxes=c,n):new wu(r,c)}function KT(t,e,n){const r=new B(t[0],t[1],t[2]);e.transform(r,r);const i=e.getScale(ph),s=Math.max(Math.max(i[0],i[1]),i[2]),o=t[3]*s;return fI(n)?(n.center=r,n.radius=o,n):new Cu(r,o)}function H7(t){const e=hI(),{halfAxes:n}=t,r=new B(n.getColumn(0)),i=new B(n.getColumn(1)),s=new B(n.getColumn(2));for(let o=0;o<2;o++){for(let a=0;a<2;a++){for(let c=0;c<2;c++)mn.copy(t.center),mn.add(r),mn.add(i),mn.add(s),dI(e,mn),s.negate();i.negate()}r.negate()}return e}function j7(t){const e=hI(),{center:n,radius:r}=t,i=ct.WGS84.scaleToGeodeticSurface(n,mn);let s;i?s=ct.WGS84.geodeticSurfaceNormal(i):s=new B(0,0,1);let o=new B(s[2],-s[1],0);o.len()>0?o.normalize():o=new B(0,1,0);const a=o.clone().cross(s);for(const c of[o,a,s]){ph.copy(c).scale(r);for(let l=0;l<2;l++)mn.copy(n),mn.add(ph),dI(e,mn),ph.negate()}return e}function hI(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function dI(t,e){ct.WGS84.cartesianToCartographic(e,mn),t[0][0]=Math.min(t[0][0],mn[0]),t[0][1]=Math.min(t[0][1],mn[1]),t[0][2]=Math.min(t[0][2],mn[2]),t[1][0]=Math.max(t[1][0],mn[0]),t[1][1]=Math.max(t[1][1],mn[1]),t[1][2]=Math.max(t[1][2],mn[2])}new B;new B;new Ee;new B;new B;new B;function V7(t,e){const n=t*e;return 1-Math.exp(-(n*n))}function W7(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return V7(e,n)*r}return 0}function $7(t,e,n){const r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,s=n?i:t.lodMetricValue;if(s===0)return 0;const o=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:c}=e,{viewDistanceScale:l}=r.options;let u=s*a*(l||1)/(o*c);return u-=W7(r,o),u}const Qp=new B,YT=new B,As=new B,qT=new B,X7=new B,Zp=new Ee,QT=new Ee;function J7(t,e){if(t.lodMetricValue===0||isNaN(t.lodMetricValue))return"DIG";const n=2*gI(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}function gI(t,e){const{topDownViewport:n}=e,r=t.header.mbs[1],i=t.header.mbs[0],s=t.header.mbs[2],o=t.header.mbs[3],a=[...t.boundingVolume.center],c=n.unprojectPosition(n.cameraPosition);ct.WGS84.cartographicToCartesian(c,Qp),YT.copy(Qp).subtract(a).normalize(),ct.WGS84.eastNorthUpToFixedFrame(a,Zp),QT.copy(Zp).invert(),As.copy(Qp).transform(QT);const l=Math.sqrt(As[0]*As[0]+As[1]*As[1]),u=l*l/As[2];qT.copy([As[0],As[1],u]);const h=qT.transform(Zp).subtract(a).normalize(),p=YT.cross(h).normalize().scale(o).add(a),y=ct.WGS84.cartesianToCartographic(p),b=n.project([i,r,s]),v=n.project(y);return X7.copy(b).subtract(v).magnitude()}function K7(t){return{assetGltfUpAxis:t.asset&&t.asset.gltfUpAxis||"Y"}}class ZT{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;g(this,"_map",new Map),g(this,"_array",void 0),g(this,"_length",void 0),this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return $e(e<this._array.length),this._array[e]}set(e,n){$e(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=n,this._map.set(n,e)}delete(e){const n=this._map.get(e);n>=0&&(this._array.splice(n,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const n=this.length++;this._array[n]=e,this._map.set(e,n)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){$e(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){$e(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const Y7={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class cg{traversalFinished(e){return!0}constructor(e){g(this,"options",void 0),g(this,"root",null),g(this,"selectedTiles",{}),g(this,"requestedTiles",{}),g(this,"emptyTiles",{}),g(this,"lastUpdate",new Date().getTime()),g(this,"updateDebounceTime",1e3),g(this,"_traversalStack",new ZT),g(this,"_emptyTraversalStack",new ZT),g(this,"_frameNumber",null),this.options={...Y7,...e}}traverse(e,n,r){this.root=e,this.options={...this.options,...r},this.reset(),this.updateTile(e,n),this._frameNumber=n.frameNumber,this.executeTraversal(e,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,n){const r=this._traversalStack;for(e._selectionDepth=1,r.push(e);r.length>0;){const s=r.pop();let o=!1;this.canTraverse(s,n)&&(this.updateChildTiles(s,n),o=this.updateAndPushChildren(s,n,r,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const a=s.parent,c=!!(!a||a._shouldRefine),l=!o;s.hasRenderContent?s.refine===Zi.ADD?(this.loadTile(s,n),this.selectTile(s,n)):s.refine===Zi.REPLACE&&(this.loadTile(s,n),l&&this.selectTile(s,n)):(this.emptyTiles[s.id]=s,this.loadTile(s,n),l&&this.selectTile(s,n)),this.touchTile(s,n),s._shouldRefine=o&&c}const i=new Date().getTime();(this.traversalFinished(n)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(n))}updateChildTiles(e,n){const r=e.children;for(const i of r)this.updateTile(i,n)}updateAndPushChildren(e,n,r,i){const{loadSiblings:s,skipLevelOfDetail:o}=this.options,a=e.children;a.sort(this.compareDistanceToCamera.bind(this));const c=e.refine===Zi.REPLACE&&e.hasRenderContent&&!o;let l=!1,u=!0;for(const f of a)if(f._selectionDepth=i,f.isVisibleAndInRequestVolume?(r.find(f)&&r.delete(f),r.push(f),l=!0):(c||s)&&(this.loadTile(f,n),this.touchTile(f,n)),c){let h;if(f._inRequestVolume?f.hasRenderContent?h=f.contentAvailable:h=this.executeEmptyTraversal(f,n):h=!1,u=u&&h,!u)return!1}return l||(u=!1),u}updateTile(e,n){this.updateTileVisibility(e,n)}selectTile(e,n){this.shouldSelectTile(e)&&(e._selectedFrame=n.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,n){this.shouldLoadTile(e)&&(e._requestedFrame=n.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,n){e.tileset._cache.touch(e),e._touchedFrame=n.frameNumber}canTraverse(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.hasChildren?e.hasTilesetContent?!e.contentExpired:!i&&!e.isVisibleAndInRequestVolume?!1:this.shouldRefine(e,n,r):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=e._screenSpaceError;return r&&(i=e.getScreenSpaceError(n,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(e,n){const r=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===n.viewport.id&&r.push(i);else r.push(n.viewport.id);e.updateVisibility(n,r)}compareDistanceToCamera(e,n){return e._distanceToCamera-n._distanceToCamera}anyChildrenVisible(e,n){let r=!1;for(const i of e.children)i.updateVisibility(n),r=r||i.isVisibleAndInRequestVolume;return r}executeEmptyTraversal(e,n){let r=!0;const i=this._emptyTraversalStack;for(i.push(e);i.length>0&&r;){const s=i.pop();if(this.updateTile(s,n),s.isVisibleAndInRequestVolume||this.loadTile(s,n),this.touchTile(s,n),!s.hasRenderContent&&this.canTraverse(s,n,!1,!0)){const a=s.children;for(const c of a)i.find(c)&&i.delete(c),i.push(c)}else!s.contentAvailable&&!s.hasEmptyContent&&(r=!1)}return r}}const eS=new B;function q7(t){return t!=null}class cv{constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";g(this,"tileset",void 0),g(this,"header",void 0),g(this,"id",void 0),g(this,"url",void 0),g(this,"parent",void 0),g(this,"refine",void 0),g(this,"type",void 0),g(this,"contentUrl",void 0),g(this,"lodMetricType","geometricError"),g(this,"lodMetricValue",0),g(this,"boundingVolume",null),g(this,"content",null),g(this,"contentState",er.UNLOADED),g(this,"gpuMemoryUsageInBytes",0),g(this,"children",[]),g(this,"depth",0),g(this,"viewportIds",[]),g(this,"transform",new Ee),g(this,"extensions",null),g(this,"implicitTiling",null),g(this,"userData",{}),g(this,"computedTransform",void 0),g(this,"hasEmptyContent",!1),g(this,"hasTilesetContent",!1),g(this,"traverser",new cg({})),g(this,"_cacheNode",null),g(this,"_frameNumber",null),g(this,"_expireDate",null),g(this,"_expiredContent",null),g(this,"_boundingBox",void 0),g(this,"_distanceToCamera",0),g(this,"_screenSpaceError",0),g(this,"_visibilityPlaneMask",void 0),g(this,"_visible",void 0),g(this,"_contentBoundingVolume",void 0),g(this,"_viewerRequestVolume",void 0),g(this,"_initialTransform",new Ee),g(this,"_priority",0),g(this,"_selectedFrame",0),g(this,"_requestedFrame",0),g(this,"_selectionDepth",0),g(this,"_touchedFrame",0),g(this,"_centerZDepth",0),g(this,"_shouldRefine",!1),g(this,"_stackLength",0),g(this,"_visitedFrame",0),g(this,"_inRequestVolume",!1),g(this,"_lodJudge",null),this.header=n,this.tileset=e,this.id=i||n.id,this.url=n.url,this.parent=r,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===er.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===er.UNLOADED}get contentExpired(){return this.contentState===er.EXPIRED}get contentFailed(){return this.contentState===er.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=G7(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(e,n){switch(this.tileset.type){case _r.I3S:return gI(this,e);case _r.TILES3D:return $7(this,e,n);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:n}=e.options,r=this.refine===Zi.ADD||n;if(r&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===er.UNLOADED)return-1;const i=this.parent,o=i&&(!r||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,a=e.root?e.root._screenSpaceError:0;return Math.max(a-o,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=er.LOADING;const n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=er.UNLOADED,!1;try{const r=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,s={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await is(r,i,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=er.READY,this._onContentLoaded(),!0}catch(r){throw this.contentState=er.FAILED,r}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=er.UNLOADED,!0}updateVisibility(e,n){if(this._frameNumber===e.frameNumber)return;const r=this.parent,i=r?r._visibilityPlaneMask:wr.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=r?r.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==wr.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=n}visibility(e,n){const{cullingVolume:r}=e,{boundingVolume:i}=this;return r.computeVisibilityWithPlaneMask(i,n)}contentVisibility(){return!0}distanceToTile(e){const n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth(e){let{camera:n}=e;const r=this.boundingVolume;return eS.subVectors(r.center,n.position),n.direction.dot(eS)}insideViewerRequestVolume(e){const n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(q7(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=er.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new Ee(e.transform):new Ee;const n=this.parent,r=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new Ee(i).multiplyRight(this.transform);const s=n&&n._initialTransform?n._initialTransform.clone():new Ee;this._initialTransform=new Ee(s).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=er.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=wr.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||Zi.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(e){this.boundingVolume=qp(e.boundingVolume,this.computedTransform,this.boundingVolume);const n=e.content;n&&(n.boundingVolume&&(this._contentBoundingVolume=qp(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=qp(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Ee).clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return K7(this.tileset.tileset)}}}class Q7 extends cg{compareDistanceToCamera(e,n){return n._distanceToCamera===0&&e._distanceToCamera===0?n._centerZDepth-e._centerZDepth:n._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,n){if(super.updateTileVisibility(e,n),!e.isVisibleAndInRequestVolume)return;const r=e.children.length>0;if(e.hasTilesetContent&&r){const o=e.children[0];this.updateTileVisibility(o,n),e._visible=o._visible;return}if(this.meetsScreenSpaceErrorEarly(e,n)){e._visible=!1;return}const i=e.refine===Zi.REPLACE,s=e._optimChildrenWithinParent===N7.USE_OPTIMIZATION;if(i&&s&&r&&!this.anyChildrenVisible(e,n)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,n){const{parent:r}=e;return!r||r.hasTilesetContent||r.refine!==Zi.ADD?!1:!this.shouldRefine(e,n,!0)}}class Z7{constructor(){g(this,"frameNumberMap",new Map)}register(e,n){const r=this.frameNumberMap.get(e)||new Map,i=r.get(n)||0;r.set(n,i+1),this.frameNumberMap.set(e,r)}deregister(e,n){const r=this.frameNumberMap.get(e);if(!r)return;const i=r.get(n)||1;r.set(n,i-1)}isZero(e,n){var r;return(((r=this.frameNumberMap.get(e))===null||r===void 0?void 0:r.get(n))||0)===0}}const em={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class eX{constructor(){g(this,"_statusMap",void 0),g(this,"pendingTilesRegister",new Z7),this._statusMap={}}add(e,n,r,i){if(!this._statusMap[n]){const{frameNumber:s,viewport:{id:o}}=i;this._statusMap[n]={request:e,callback:r,key:n,frameState:i,status:em.REQUESTED},this.pendingTilesRegister.register(o,s),e().then(a=>{this._statusMap[n].status=em.COMPLETED;const{frameNumber:c,viewport:{id:l}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(l,c),this._statusMap[n].callback(a,i)}).catch(a=>{this._statusMap[n].status=em.ERROR;const{frameNumber:c,viewport:{id:l}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(l,c),r(a)})}}update(e,n){if(this._statusMap[e]){const{frameNumber:r,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,r);const{frameNumber:s,viewport:{id:o}}=n;this.pendingTilesRegister.register(o,s),this._statusMap[e].frameState=n}}find(e){return this._statusMap[e]}hasPendingTiles(e,n){return!this.pendingTilesRegister.isZero(e,n)}}class tX extends cg{constructor(e){super(e),g(this,"_tileManager",void 0),this._tileManager=new eX}traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}shouldRefine(e,n){return e._lodJudge=J7(e,n),e._lodJudge==="DIG"}updateChildTiles(e,n){const r=e.header.children||[],i=e.children,s=e.tileset;for(const o of r){const a="".concat(o.id,"-").concat(n.viewport.id),c=i&&i.find(l=>l.id===a);if(c)c&&this.updateTile(c,n);else{let l=()=>this._loadTile(o.id,s);this._tileManager.find(a)?this._tileManager.update(a,n):(s.tileset.nodePages&&(l=()=>s.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(l,a,f=>this._onTileLoad(f,e,a),n))}}return!1}async _loadTile(e,n){const{loader:r}=n,i=n.getTileUrl("".concat(n.url,"/nodes/").concat(e)),s={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0}};return await is(i,r,s)}_onTileLoad(e,n,r){const i=new cv(n.tileset,e,n,r);n.children.push(i);const s=this._tileManager.find(i.id).frameState;this.updateTile(i,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,s)}}const nX={description:"",ellipsoid:ct.WGS84,modelMatrix:new Ee,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},xf="Tiles In Tileset(s)",tm="Tiles In Memory",tS="Tiles In View",nS="Tiles To Render",rS="Tiles Loaded",nm="Tiles Loading",iS="Tiles Unloaded",sS="Failed Tile Loads",oS="Points/Vertices",rm="Tile Memory Use";class rX{constructor(e,n){g(this,"options",void 0),g(this,"loadOptions",void 0),g(this,"type",void 0),g(this,"tileset",void 0),g(this,"loader",void 0),g(this,"url",void 0),g(this,"basePath",void 0),g(this,"modelMatrix",void 0),g(this,"ellipsoid",void 0),g(this,"lodMetricType",void 0),g(this,"lodMetricValue",void 0),g(this,"refine",void 0),g(this,"root",null),g(this,"roots",{}),g(this,"asset",{}),g(this,"description",""),g(this,"properties",void 0),g(this,"extras",null),g(this,"attributions",{}),g(this,"credits",{}),g(this,"stats",void 0),g(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),g(this,"cartographicCenter",null),g(this,"cartesianCenter",null),g(this,"zoom",1),g(this,"boundingVolume",null),g(this,"dynamicScreenSpaceErrorComputedDensity",0),g(this,"maximumMemoryUsage",32),g(this,"gpuMemoryUsageInBytes",0),g(this,"_frameNumber",0),g(this,"_queryParams",{}),g(this,"_extensionsUsed",[]),g(this,"_tiles",{}),g(this,"_pendingCount",0),g(this,"selectedTiles",[]),g(this,"traverseCounter",0),g(this,"geometricError",0),g(this,"lastUpdatedVieports",null),g(this,"_requestedTiles",[]),g(this,"_emptyTiles",[]),g(this,"frameStateData",{}),g(this,"_traverser",void 0),g(this,"_cache",new x7),g(this,"_requestScheduler",void 0),g(this,"updatePromise",null),g(this,"tilesetInitializationPromise",void 0),this.options={...nX,...n},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||jy(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new E3({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new S7({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(e){this.options={...this.options,...e}}setOptions(e){this.options={...this.options,...e}}getTileUrl(e){return e.startsWith("data:")?e:"".concat(e).concat(e.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(e){return this._extensionsUsed.indexOf(e)>-1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const n=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;const r=[];for(const i of n){const s=i.id;this._needTraverse(s)?r.push(s):this.traverseCounter--}for(const i of n){const s=i.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!r.includes(s))continue;const o=M7(i,this._frameNumber);this._traverser.traverse(this.roots[s],o,this.options)}}_needTraverse(e){let n=e;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[e]),n===e}_onTraversalEnd(e){const n=e.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const r=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),[s,o]=R7(i,e,this.options.maximumTilesSelected);r.selectedTiles=s;for(const a of o)a.unselect();r._requestedTiles=Object.values(this._traverser.requestedTiles),r._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const n=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,n){if(e.length!==n.length)return!0;const r=new Set(e.map(o=>o.id)),i=new Set(n.map(o=>o.id));let s=e.filter(o=>!i.has(o.id)).length>0;return s=s||n.filter(o=>!r.has(o.id)).length>0,s}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,n)=>e._unloadTile(n))}_updateStats(){let e=0,n=0;for(const r of this.selectedTiles)r.contentAvailable&&r.content&&(e++,r.content.pointCount?n+=r.content.pointCount:n+=r.content.vertexCount);this.stats.get(tS).count=this.selectedTiles.length,this.stats.get(nS).count=e,this.stats.get(oS).count=n}async _initializeTileSet(e){this.type===_r.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===_r.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===_r.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const n=this.tileset.fullExtent;if(n){const{xmin:i,xmax:s,ymin:o,ymax:a,zmin:c,zmax:l}=n;this.cartographicCenter=new B(i+(s-i)/2,o+(a-o)/2,c+(l-c)/2),this.cartesianCenter=ct.WGS84.cartographicToCartesian(this.cartographicCenter,new B),this.zoom=uI(n,this.cartographicCenter,this.cartesianCenter);return}const r=(e=this.tileset.store)===null||e===void 0?void 0:e.extent;if(r){const[i,s,o,a]=r;this.cartographicCenter=new B(i+(o-i)/2,s+(a-s)/2,0),this.cartesianCenter=ct.WGS84.cartographicToCartesian(this.cartographicCenter,new B),this.zoom=F7(r,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new B,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root,{center:n}=e.boundingVolume;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new B,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?this.cartographicCenter=ct.WGS84.cartesianToCartographic(n,new B):this.cartographicCenter=new B(0,0,-ct.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=O7(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(xf),this.stats.get(nm),this.stats.get(tm),this.stats.get(tS),this.stats.get(nS),this.stats.get(rS),this.stats.get(iS),this.stats.get(sS),this.stats.get(oS),this.stats.get(rm,"memory")}_initializeTileHeaders(e,n){const r=new cv(this,e.root,n);if(n&&(n.children.push(r),r.depth=n.depth+1),this.type===_r.TILES3D){const s=[];for(s.push(r);s.length>0;){const o=s.pop();this.stats.get(xf).incrementCount();const a=o.header.children||[];for(const c of a){var i;const l=new cv(this,c,o);if((i=l.contentUrl)!==null&&i!==void 0&&i.includes("?session=")){const f=new URL(l.contentUrl).searchParams.get("session");f&&(this._queryParams.session=f)}o.children.push(l),l.depth=o.depth+1,s.push(l)}}}return r}_initializeTraverser(){let e;switch(this.type){case _r.TILES3D:e=Q7;break;case _r.I3S:e=tX;break;default:e=cg}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let n;try{this._onStartTileLoading(),n=await e.loadContent()}catch(r){this._onTileLoadError(e,r instanceof Error?r:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(e,n)}}_onTileLoadError(e,n){this.stats.get(sS).incrementCount();const r=n.message||n.toString(),i=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(r)),this.options.onTileError(e,r,i)}_onTileLoad(e,n){if(n){if(this.type===_r.I3S){var r,i;const s=((r=this.tileset)===null||r===void 0||(i=r.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(xf).reset(),this.stats.get(xf).addCount(s)}e&&e.content&&P7(e,e.content),this.updateContentTypes(e),this._addTileToCache(e),this.options.onTileLoad(e)}}updateContentTypes(e){if(this.type===_r.I3S)switch(e.header.isDracoGeometry&&(this.contentFormats.draco=!0),e.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===_r.TILES3D){var n;const{extensionsRemoved:r=[]}=((n=e.content)===null||n===void 0?void 0:n.gltf)||{};r.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),r.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),r.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(nm).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(nm).decrementCount()}_addTileToCache(e){this._cache.add(this,e,n=>n._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(rS).incrementCount(),this.stats.get(tm).incrementCount(),this.gpuMemoryUsageInBytes+=e.gpuMemoryUsageInBytes||0,this.stats.get(rm).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.gpuMemoryUsageInBytes||0,this.stats.get(tm).decrementCount(),this.stats.get(iS).incrementCount(),this.stats.get(rm).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const n=e.pop();for(const r of n.children)e.push(r);this._destroyTile(n)}this.root=null}_destroySubtree(e){const n=e,r=[];for(r.push(n);r.length>0;){e=r.pop();for(const i of e.children)r.push(i);e!==n&&this._destroyTile(e)}n.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(e.queryString){const n=new URLSearchParams(e.queryString),r=Object.fromEntries(n.entries());this._queryParams={...this._queryParams,...r}}if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed||[],this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const pI="3.4.14",Kc={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function mI(t,e,n){$e(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}function iX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}const sX={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Pt={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},Me={...sX,...Pt},im={[Pt.DOUBLE]:Float64Array,[Pt.FLOAT]:Float32Array,[Pt.UNSIGNED_SHORT]:Uint16Array,[Pt.UNSIGNED_INT]:Uint32Array,[Pt.UNSIGNED_BYTE]:Uint8Array,[Pt.BYTE]:Int8Array,[Pt.SHORT]:Int16Array,[Pt.INT]:Int32Array},oX={DOUBLE:Pt.DOUBLE,FLOAT:Pt.FLOAT,UNSIGNED_SHORT:Pt.UNSIGNED_SHORT,UNSIGNED_INT:Pt.UNSIGNED_INT,UNSIGNED_BYTE:Pt.UNSIGNED_BYTE,BYTE:Pt.BYTE,SHORT:Pt.SHORT,INT:Pt.INT},sm="Failed to convert GL type";class Pi{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const n in im)if(im[n]===e)return n;throw new Error(sm)}static fromName(e){const n=oX[e];if(!n)throw new Error(sm);return n}static getArrayType(e){switch(e){case Pt.UNSIGNED_SHORT_5_6_5:case Pt.UNSIGNED_SHORT_4_4_4_4:case Pt.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=im[e];if(!n)throw new Error(sm);return n}}static getByteSize(e){return Pi.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!Pi.getArrayType(e)}static createTypedArray(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(n.byteLength-r)/Pi.getByteSize(e));const s=Pi.getArrayType(e);return new s(n,r,i)}}function aX(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}function cX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=t>>11&31,r=t>>5&63,i=t&31;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}new d_;new B;new d_;new d_;function aS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return ti(t,0,e)/e*2-1}function cS(t){return t<0?-1:1}function lX(t,e,n,r){if(aX(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=aS(t,n),r.y=aS(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const i=r.x;r.x=(1-Math.abs(r.y))*cS(i),r.y=(1-Math.abs(i))*cS(r.y)}return r.normalize()}function uX(t,e,n){return lX(t,e,255,n)}class J_{constructor(e,n){g(this,"json",void 0),g(this,"buffer",void 0),g(this,"featuresLength",0),g(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Me.UNSIGNED_INT,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,n,r,1,i.byteOffset):i}getPropertyArray(e,n,r){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(n=Pi.fromName(i.componentType)),this._getTypedArrayFromBinary(e,n,r,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,n,i)}getProperty(e,n,r,i,s){const o=this.json[e];if(!o)return o;const a=this.getPropertyArray(e,n,r);if(r===1)return a[i];for(let c=0;c<r;++c)s[c]=a[r*i+c];return s}_getTypedArrayFromBinary(e,n,r,i,s){const o=this._cachedTypedArrays;let a=o[e];return a||(a=Pi.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+s,i*r),o[e]=a),a}_getTypedArrayFromArray(e,n,r){const i=this._cachedTypedArrays;let s=i[e];return s||(s=Pi.createTypedArray(n,r),i[e]=s),s}}const fX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},hX={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},dX={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function gX(t,e,n,r){const{componentType:i}=t;$e(t.componentType);const s=typeof i=="string"?Pi.fromName(i):i,o=fX[t.type],a=hX[t.type],c=dX[t.type];return n+=t.byteOffset,{values:Pi.createTypedArray(s,e,n,o*r),type:s,size:o,unpacker:a,packer:c}}const wi=t=>t!==void 0;function pX(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?mX(r,n):null}function mX(t,e){let n,r,i;const s=t.instancesLength,o=t.classes;let a=t.classIds,c=t.parentCounts,l=t.parentIds,u=s;wi(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,i=getBinaryAccessor(a),a=i.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,s));let f;if(wi(c))for(wi(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,s)),f=new Uint16Array(s),u=0,n=0;n<s;++n)f[n]=u,u+=c[n];wi(l)&&wi(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,u));const h=o.length;for(n=0;n<h;++n){const b=o[n].length,v=o[n].instances,m=getBinaryProperties(b,v,e);o[n].instances=combine(m,v)}const d=new Array(h).fill(0),p=new Uint16Array(s);for(n=0;n<s;++n)r=a[n],p[n]=d[r],++d[r];const y={classes:o,classIds:a,classIndexes:p,parentCounts:c,parentIndexes:f,parentIds:l};return _X(y),y}function Yc(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?vX(t,e,n):yX(t,e,n)}function vX(t,e,n){const r=t.classIds,i=t.parentCounts,s=t.parentIds,o=t.parentIndexes,a=r.length,c=scratchVisited;c.length=Math.max(c.length,a);const l=++marker,u=scratchStack;for(u.length=0,u.push(e);u.length>0;){if(e=u.pop(),c[e]===l)continue;c[e]=l;const f=n(t,e);if(wi(f))return f;const h=i[e],d=o[e];for(let p=0;p<h;++p){const y=s[d+p];y!==e&&u.push(y)}}return null}function yX(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(wi(i))return i;const s=t.parentIds[e];r=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}function _X(t){const n=t.classIds.length;for(let r=0;r<n;++r)vI(t,r,stack)}function vI(t,e,n){const r=t.parentCounts,i=t.parentIds,s=t.parentIndexes,a=t.classIds.length;if(!wi(i))return;assert(e<a,"Parent index ".concat(e," exceeds the total number of instances: ").concat(a)),assert(n.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(e);const c=wi(r)?r[e]:1,l=wi(r)?s[e]:e;for(let u=0;u<c;++u){const f=i[l+u];f!==e&&vI(t,f,n)}n.pop(e)}function Fn(t){return t!=null}const Pf=(t,e)=>t,bX={HIERARCHY:!0,extensions:!0,extras:!0};class yI{constructor(e,n,r){var i;let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};g(this,"json",void 0),g(this,"binary",void 0),g(this,"featureCount",void 0),g(this,"_extensions",void 0),g(this,"_properties",void 0),g(this,"_binaryProperties",void 0),g(this,"_hierarchy",void 0),$e(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=((i=this.json)===null||i===void 0?void 0:i.extensions)||{},this._properties={};for(const o in this.json)bX[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),s["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=pX(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),$e(typeof n=="string",n),this._hierarchy){const r=Yc(this._hierarchy,e,(i,s)=>{const o=i.classIds[s];return i.classes[o].name===n});return Fn(r)}return!1}isExactClass(e,n){return $e(typeof n=="string",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),$e(typeof n=="string",n),Fn(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=Fn(n)?n:[],n.length=0;const r=Object.keys(this._properties);return n.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),$e(typeof n=="string",n),this._binaryProperties){const i=this._binaryProperties[n];if(Fn(i))return this._getBinaryProperty(i,e)}const r=this._properties[n];if(Fn(r))return Pf(r[e]);if(this._hierarchy){const i=this._getHierarchyProperty(e,n);if(Fn(i))return i}}setProperty(e,n,r){const i=this.featureCount;if(this._checkBatchId(e),$e(typeof n=="string",n),this._binaryProperties){const o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,e,r);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,r))return;let s=this._properties[n];Fn(s)||(this._properties[n]=new Array(i),s=this._properties[n]),s[e]=Pf(r)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,r){e.pack(r,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(const n in this._properties){const r=this._properties[n],i=this._initializeBinaryProperty(n,r);i&&(e=e||{},e[n]=i)}return e}_initializeBinaryProperty(e,n){if("byteOffset"in n){const r=n;$e(this.binary,"Property ".concat(e," requires a batch table binary.")),$e(r.type,"Property ".concat(e," requires a type."));const i=gX(r,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;const r=Yc(this._hierarchy,e,(i,s)=>{const o=i.classIds[s],a=i.classes[o].instances;return Fn(a[n])});return Fn(r)}_getPropertyNamesInHierarchy(e,n){Yc(this._hierarchy,e,(r,i)=>{const s=r.classIds[i],o=r.classes[s].instances;for(const a in o)o.hasOwnProperty(a)&&n.indexOf(a)===-1&&n.push(a)})}_getHierarchyProperty(e,n){return Yc(this._hierarchy,e,(r,i)=>{const s=r.classIds[i],o=r.classes[s],a=r.classIndexes[i],c=o.instances[n];return Fn(c)?Fn(c.typedArray)?this._getBinaryProperty(c,a):Pf(c[a]):null})}_setHierarchyProperty(e,n,r,i){const s=Yc(this._hierarchy,n,(o,a)=>{const c=o.classIds[a],l=o.classes[c],u=o.classIndexes[a],f=l.instances[r];return Fn(f)?($e(a===n,'Inherited property "'.concat(r,'" is read-only.')),Fn(f.typedArray)?this._setBinaryProperty(f,u,i):f[u]=Pf(i),!0):!1});return Fn(s)}}const om=4;function lg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=om,t.version=r.getUint32(n,!0),n+=om,t.byteLength=r.getUint32(n,!0),n+=om,t.version!==1)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}const ua=4,lS="b3dm tile in legacy format.";function K_(t,e,n){const r=new DataView(e);let i;t.header=t.header||{};let s=r.getUint32(n,!0);n+=ua;let o=r.getUint32(n,!0);n+=ua;let a=r.getUint32(n,!0);n+=ua;let c=r.getUint32(n,!0);return n+=ua,a>=570425344?(n-=ua*2,i=s,a=o,c=0,s=0,o=0,console.warn(lS)):c>=570425344&&(n-=ua,i=a,a=s,c=o,s=0,o=0,console.warn(lS)),t.header.featureTableJsonByteLength=s,t.header.featureTableBinaryByteLength=o,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=c,t.header.batchLength=i,n}function Y_(t,e,n,r){return n=AX(t,e,n),n=EX(t,e,n),n}function AX(t,e,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s,batchLength:o}=t.header;if(t.featureTableJson={BATCH_LENGTH:o||0},i>0){const a=mI(e,n,i);t.featureTableJson=JSON.parse(a)}return n+=i,t.featureTableBinary=new Uint8Array(e,n,s),n+=s,n}function EX(t,e,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=t.header;if(i>0){const o=mI(e,n,i);t.batchTableJson=JSON.parse(o),n+=i,s>0&&(t.batchTableBinary=new Uint8Array(e,n,s),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=s)}return n}function _I(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;const{batchIds:r,isRGB565:i,pointCount:s}=t;if(r&&n){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const c=r[a],u=n.getProperty(c,"dimensions").map(f=>f*255);o[a*3]=u[0],o[a*3+1]=u[1],o[a*3+2]=u[2]}return{type:Me.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const c=cX(e[a]);o[a*3]=c[0],o[a*3+1]=c[1],o[a*3+2]=c[2]}return{type:Me.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}return e&&e.length===s*3?{type:Me.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:Me.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}const uS=new B;function TX(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(t.pointsLength*3);for(let r=0;r<t.pointsLength;r++)uX(e[r*2],e[r*2+1],uS),uS.toArray(n,r*3);return{type:Me.FLOAT,size:2,value:n}}return{type:Me.FLOAT,size:2,value:e}}function SX(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,CX(t,e)):{type:Me.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function CX(t,e){const n=new B,r=new Float32Array(t.pointCount*3);for(let i=0;i<t.pointCount;i++)n.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,i*3);return r}async function wX(t,e,n,r,i){n=lg(t,e,n),n=K_(t,e,n),n=Y_(t,e,n),xX(t);const{featureTable:s,batchTable:o}=PX(t);return await BX(t,s,o,r,i),MX(t,s,r),RX(t,s,o),IX(t,s),n}function xX(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function PX(t){const e=new J_(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",Me.FLOAT,3);const r=LX(t,e);return{featureTable:e,batchTable:r}}function MX(t,e,n){if(!t.attributes.positions){if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",Me.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",Me.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65536-1,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Me.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Me.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=SX(t,r,n)}}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function RX(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",Me.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",Me.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",Me.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=_I(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",Me.UNSIGNED_BYTE,4))}function IX(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",Me.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",Me.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=TX(t,n)}}function LX(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",Me.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=t;n=new yI(i,s,r)}return n}async function BX(t,e,n,r,i){let s,o,a;const c=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];c&&(a=c.properties);const l=e.getExtension("3DTILES_draco_point_compression");if(l){o=l.properties;const f=l.byteOffset,h=l.byteLength;if(!o||!Number.isFinite(f)||!h)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=t.featureTableBinary.slice(f,f+h),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!s)return!0;const u={buffer:s,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await OX(t,u,r,i)}async function OX(t,e,n,r){const{parse:i}=r,s={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete s["3d-tiles"];const o=await i(e.buffer,rI,s),a=o.attributes.POSITION&&o.attributes.POSITION.value,c=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,l=o.attributes.NORMAL&&o.attributes.NORMAL.value,u=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,f=a&&o.attributes.POSITION.value.quantization,h=l&&o.attributes.NORMAL.value.quantization;if(f){const p=o.POSITION.data.quantization,y=p.range;t.quantizedVolumeScale=new B(y,y,y),t.quantizedVolumeOffset=new B(p.minValues),t.quantizedRange=(1<<p.quantizationBits)-1,t.isQuantizedDraco=!0}h&&(t.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const d={};if(e.batchTableProperties)for(const p of Object.keys(e.batchTableProperties))o.attributes[p]&&o.attributes[p].value&&(d[p.toLowerCase()]=o.attributes[p].value);t.attributes={positions:a,colors:_I(t,c,void 0),normals:l,batchIds:u,...d}}const lv={URI:0,EMBEDDED:1};function bI(t,e,n,r){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-n;if(i===0)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=Hy(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4===0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}async function AI(t,e,n,r){const i=n["3d-tiles"]||{};if(FX(t,e),i.loadGLTF){const{parse:s,fetch:o}=r;t.gltfUrl&&(t.gltfArrayBuffer=await o(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await s(t.gltfArrayBuffer,Ql,n,r),t.gpuMemoryUsageInBytes=tI(t.gltf),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}function FX(t,e,n){switch(e){case lv.URI:const r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),s=new TextDecoder().decode(r);t.gltfUrl=s.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case lv.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function DX(t,e,n,r,i){var s;n=NX(t,e,n,r),await AI(t,lv.EMBEDDED,r,i);const o=t==null||(s=t.gltf)===null||s===void 0?void 0:s.extensions;return o&&o.CESIUM_RTC&&(t.rtcCenter=o.CESIUM_RTC.center),n}function NX(t,e,n,r,i){n=lg(t,e,n),n=K_(t,e,n),n=Y_(t,e,n),n=bI(t,e,n,r);const s=new J_(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=s.getGlobalProperty("RTC_CENTER",Me.FLOAT,3),n}async function kX(t,e,n,r,i){return n=UX(t,e,n,r),await AI(t,t.gltfFormat,r,i),n}function UX(t,e,n,r,i){if(n=lg(t,e,n),t.version!==1)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=K_(t,e,n);const s=new DataView(e);if(t.gltfFormat=s.getUint32(n,!0),n+=4,n=Y_(t,e,n),n=bI(t,e,n,r),t.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new J_(t.featureTableJson,t.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",Me.FLOAT,3);const c=new yI(t.batchTableJson,t.batchTableBinary,a);return GX(t,o,c,a),n}function GX(t,e,n,r){const s={instances:new Array(r),batchTable:t._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,o=new B;new B,new B,new B;const a=new bt,c=new Vl,l=new B,u={},f=new Ee,h=[],d=[],p=new B,y=new B;for(let b=0;b<r;b++){let v;if(e.hasProperty("POSITION"))v=e.getProperty("POSITION",Me.FLOAT,3,b,o);else if(e.hasProperty("POSITION_QUANTIZED")){v=e.getProperty("POSITION_QUANTIZED",Me.UNSIGNED_SHORT,3,b,o);const x=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",Me.FLOAT,3,p);if(!x)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const M=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",Me.FLOAT,3,y);if(!M)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const L=65535;for(let R=0;R<3;R++)v[R]=v[R]/L*M[R]+x[R]}if(!v)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(o.copy(v),u.translation=o,t.normalUp=e.getProperty("NORMAL_UP",Me.FLOAT,3,b,h),t.normalRight=e.getProperty("NORMAL_RIGHT",Me.FLOAT,3,b,d),t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",Me.UNSIGNED_SHORT,2,h),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",Me.UNSIGNED_SHORT,2,d),t.octNormalUp)throw t.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");t.eastNorthUp?(ct.WGS84.eastNorthUpToFixedFrame(o,f),f.getRotationMatrix3(a)):a.identity()}c.fromMatrix3(a),u.rotation=c,l.set(1,1,1);const m=e.getProperty("SCALE",Me.FLOAT,1,b);Number.isFinite(m)&&l.multiplyByScalar(m);const _=e.getProperty("SCALE_NON_UNIFORM",Me.FLOAT,3,b,h);_&&l.scale(_),u.scale=l;let A=e.getProperty("BATCH_ID",Me.UNSIGNED_SHORT,1,b);A===void 0&&(A=b);const S=new Ee().fromQuaternion(u.rotation);f.identity(),f.translate(u.translation),f.multiplyRight(S),f.scale(u.scale);const w=f.clone();s[b]={modelMatrix:w,batchId:A}}t.instances=s}async function zX(t,e,n,r,i,s){n=lg(t,e,n);const o=new DataView(e);for(t.tilesLength=o.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const a={};t.tiles.push(a),n=await s(e,n,r,i,a)}return n}async function HX(t,e,n,r){t.rotateYtoZ=!0,t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=r;t.gltf=await i(e,Ql,n,r),t.gpuMemoryUsageInBytes=tI(t.gltf)}async function EI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};switch(i.byteOffset=e,i.type=iX(t,e),i.type){case Kc.COMPOSITE:return await zX(i,t,e,n,r,EI);case Kc.BATCHED_3D_MODEL:return await DX(i,t,e,n,r);case Kc.GLTF:return await HX(i,t,n,r);case Kc.INSTANCED_3D_MODEL:return await kX(i,t,e,n,r);case Kc.POINT_CLOUD:return await wX(i,t,e,n,r);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const jX=1952609651,VX=1;async function WX(t,e,n){if(new Uint32Array(t.slice(0,4))[0]!==jX)throw new Error("Wrong subtree file magic number");if(new Uint32Array(t.slice(4,8))[0]!==VX)throw new Error("Wrong subtree file verson, must be 1");const s=fS(t.slice(8,16)),o=new Uint8Array(t,24,s),c=new TextDecoder("utf8").decode(o),l=JSON.parse(c),u=fS(t.slice(16,24));let f=new ArrayBuffer(0);return u&&(f=t.slice(24+s)),"bufferView"in l.tileAvailability&&(l.tileAvailability.explicitBitstream=await am(l,"tileAvailability",f,n)),"bufferView"in l.contentAvailability&&(l.contentAvailability.explicitBitstream=await am(l,"contentAvailability",f,n)),"bufferView"in l.childSubtreeAvailability&&(l.childSubtreeAvailability.explicitBitstream=await am(l,"childSubtreeAvailability",f,n)),l}function $X(t,e){if(e.startsWith("http")){const s=new URL(t,e);return decodeURI(s.toString())}const r="http://".concat(e),i=new URL(t,r);return"/".concat(i.host).concat(i.pathname)}async function am(t,e,n,r){const i=t[e].bufferView,s=t.bufferViews[i],o=t.buffers[s.buffer];if(!(r!=null&&r.url)||!r.fetch)throw new Error("Url is not provided");if(!r.fetch)throw new Error("fetch is not provided");if(o.uri){const a=$X(o.uri,r==null?void 0:r.url),l=await(await r.fetch(a)).arrayBuffer();return new Uint8Array(l,s.byteOffset,s.byteLength)}return new Uint8Array(n,s.byteOffset,s.byteLength)}function fS(t){const e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+2**32*r}const TI={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:pI,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:WX,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var xr=null;try{xr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ge(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Ge.prototype.__isLong__;Object.defineProperty(Ge.prototype,"__isLong__",{value:!0});function bn(t){return(t&&t.__isLong__)===!0}function hS(t){var e=Math.clz32(t&-t);return t?31-e:e}Ge.isLong=bn;var dS={},gS={};function Wo(t,e){var n,r,i;return e?(t>>>=0,(i=0<=t&&t<256)&&(r=gS[t],r)?r:(n=Le(t,0,!0),i&&(gS[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(r=dS[t],r)?r:(n=Le(t,t<0?-1:0,!1),i&&(dS[t]=n),n))}Ge.fromInt=Wo;function Pr(t,e){if(isNaN(t))return e?Yi:si;if(e){if(t<0)return Yi;if(t>=SI)return xI}else{if(t<=-mS)return zn;if(t+1>=mS)return wI}return t<0?Pr(-t,e).neg():Le(t%gc|0,t/gc|0,e)}Ge.fromNumber=Pr;function Le(t,e,n){return new Ge(t,e,n)}Ge.fromBits=Le;var dd=Math.pow;function q_(t,e,n){if(t.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e?Yi:si;if(n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return q_(t.substring(1),e,n).neg();for(var i=Pr(dd(n,8)),s=si,o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+a),n);if(a<8){var l=Pr(dd(n,a));s=s.mul(l).add(Pr(c))}else s=s.mul(i),s=s.add(Pr(c))}return s.unsigned=e,s}Ge.fromString=q_;function hi(t,e){return typeof t=="number"?Pr(t,e):typeof t=="string"?q_(t,e):Le(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Ge.fromValue=hi;var pS=65536,XX=1<<24,gc=pS*pS,SI=gc*gc,mS=SI/2,vS=Wo(XX),si=Wo(0);Ge.ZERO=si;var Yi=Wo(0,!0);Ge.UZERO=Yi;var Oa=Wo(1);Ge.ONE=Oa;var CI=Wo(1,!0);Ge.UONE=CI;var uv=Wo(-1);Ge.NEG_ONE=uv;var wI=Le(-1,2147483647,!1);Ge.MAX_VALUE=wI;var xI=Le(-1,-1,!0);Ge.MAX_UNSIGNED_VALUE=xI;var zn=Le(0,-2147483648,!1);Ge.MIN_VALUE=zn;var j=Ge.prototype;j.toInt=function(){return this.unsigned?this.low>>>0:this.low};j.toNumber=function(){return this.unsigned?(this.high>>>0)*gc+(this.low>>>0):this.high*gc+(this.low>>>0)};j.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(zn)){var n=Pr(e),r=this.div(n),i=r.mul(n).sub(this);return r.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Pr(dd(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),l=o.sub(c.mul(s)).toInt()>>>0,u=l.toString(e);if(o=c,o.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};j.getHighBits=function(){return this.high};j.getHighBitsUnsigned=function(){return this.high>>>0};j.getLowBits=function(){return this.low};j.getLowBitsUnsigned=function(){return this.low>>>0};j.getNumBitsAbs=function(){if(this.isNegative())return this.eq(zn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};j.isZero=function(){return this.high===0&&this.low===0};j.eqz=j.isZero;j.isNegative=function(){return!this.unsigned&&this.high<0};j.isPositive=function(){return this.unsigned||this.high>=0};j.isOdd=function(){return(this.low&1)===1};j.isEven=function(){return(this.low&1)===0};j.equals=function(e){return bn(e)||(e=hi(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};j.eq=j.equals;j.notEquals=function(e){return!this.eq(e)};j.neq=j.notEquals;j.ne=j.notEquals;j.lessThan=function(e){return this.comp(e)<0};j.lt=j.lessThan;j.lessThanOrEqual=function(e){return this.comp(e)<=0};j.lte=j.lessThanOrEqual;j.le=j.lessThanOrEqual;j.greaterThan=function(e){return this.comp(e)>0};j.gt=j.greaterThan;j.greaterThanOrEqual=function(e){return this.comp(e)>=0};j.gte=j.greaterThanOrEqual;j.ge=j.greaterThanOrEqual;j.compare=function(e){if(bn(e)||(e=hi(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};j.comp=j.compare;j.negate=function(){return!this.unsigned&&this.eq(zn)?zn:this.not().add(Oa)};j.neg=j.negate;j.add=function(e){bn(e)||(e=hi(e));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,l=e.low&65535,u=0,f=0,h=0,d=0;return d+=s+l,h+=d>>>16,d&=65535,h+=i+c,f+=h>>>16,h&=65535,f+=r+a,u+=f>>>16,f&=65535,u+=n+o,u&=65535,Le(h<<16|d,u<<16|f,this.unsigned)};j.subtract=function(e){return bn(e)||(e=hi(e)),this.add(e.neg())};j.sub=j.subtract;j.multiply=function(e){if(this.isZero())return this;if(bn(e)||(e=hi(e)),xr){var n=xr.mul(this.low,this.high,e.low,e.high);return Le(n,xr.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Yi:si;if(this.eq(zn))return e.isOdd()?zn:si;if(e.eq(zn))return this.isOdd()?zn:si;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(vS)&&e.lt(vS))return Pr(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,l=e.low>>>16,u=e.low&65535,f=0,h=0,d=0,p=0;return p+=o*u,d+=p>>>16,p&=65535,d+=s*u,h+=d>>>16,d&=65535,d+=o*l,h+=d>>>16,d&=65535,h+=i*u,f+=h>>>16,h&=65535,h+=s*l,f+=h>>>16,h&=65535,h+=o*c,f+=h>>>16,h&=65535,f+=r*u+i*l+s*c+o*a,f&=65535,Le(d<<16|p,f<<16|h,this.unsigned)};j.mul=j.multiply;j.divide=function(e){if(bn(e)||(e=hi(e)),e.isZero())throw Error("division by zero");if(xr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?xr.div_u:xr.div_s)(this.low,this.high,e.low,e.high);return Le(n,xr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Yi:si;var r,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Yi;if(e.gt(this.shru(1)))return CI;s=Yi}else{if(this.eq(zn)){if(e.eq(Oa)||e.eq(uv))return zn;if(e.eq(zn))return Oa;var o=this.shr(1);return r=o.div(e).shl(1),r.eq(si)?e.isNegative()?Oa:uv:(i=this.sub(e.mul(r)),s=r.add(i.div(e)),s)}else if(e.eq(zn))return this.unsigned?Yi:si;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=si}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),c=a<=48?1:dd(2,a-48),l=Pr(r),u=l.mul(e);u.isNegative()||u.gt(i);)r-=c,l=Pr(r,this.unsigned),u=l.mul(e);l.isZero()&&(l=Oa),s=s.add(l),i=i.sub(u)}return s};j.div=j.divide;j.modulo=function(e){if(bn(e)||(e=hi(e)),xr){var n=(this.unsigned?xr.rem_u:xr.rem_s)(this.low,this.high,e.low,e.high);return Le(n,xr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};j.mod=j.modulo;j.rem=j.modulo;j.not=function(){return Le(~this.low,~this.high,this.unsigned)};j.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};j.clz=j.countLeadingZeros;j.countTrailingZeros=function(){return this.low?hS(this.low):hS(this.high)+32};j.ctz=j.countTrailingZeros;j.and=function(e){return bn(e)||(e=hi(e)),Le(this.low&e.low,this.high&e.high,this.unsigned)};j.or=function(e){return bn(e)||(e=hi(e)),Le(this.low|e.low,this.high|e.high,this.unsigned)};j.xor=function(e){return bn(e)||(e=hi(e)),Le(this.low^e.low,this.high^e.high,this.unsigned)};j.shiftLeft=function(e){return bn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Le(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Le(0,this.low<<e-32,this.unsigned)};j.shl=j.shiftLeft;j.shiftRight=function(e){return bn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Le(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Le(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};j.shr=j.shiftRight;j.shiftRightUnsigned=function(e){return bn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Le(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?Le(this.high,0,this.unsigned):Le(this.high>>>e-32,0,this.unsigned)};j.shru=j.shiftRightUnsigned;j.shr_u=j.shiftRightUnsigned;j.rotateLeft=function(e){var n;return bn(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Le(this.high,this.low,this.unsigned):e<32?(n=32-e,Le(this.low<<e|this.high>>>n,this.high<<e|this.low>>>n,this.unsigned)):(e-=32,n=32-e,Le(this.high<<e|this.low>>>n,this.low<<e|this.high>>>n,this.unsigned))};j.rotl=j.rotateLeft;j.rotateRight=function(e){var n;return bn(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Le(this.high,this.low,this.unsigned):e<32?(n=32-e,Le(this.high<<n|this.low>>>e,this.low<<n|this.high>>>e,this.unsigned)):(e-=32,n=32-e,Le(this.low<<n|this.high>>>e,this.high<<n|this.low>>>e,this.unsigned))};j.rotr=j.rotateRight;j.toSigned=function(){return this.unsigned?Le(this.low,this.high,!1):this};j.toUnsigned=function(){return this.unsigned?this:Le(this.low,this.high,!0)};j.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};j.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};j.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Ge.fromBytes=function(e,n,r){return r?Ge.fromBytesLE(e,n):Ge.fromBytesBE(e,n)};Ge.fromBytesLE=function(e,n){return new Ge(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Ge.fromBytesBE=function(e,n){return new Ge(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const JX=16;function PI(t){t==="X"&&(t="");const e=t.padEnd(JX,"0");return Ge.fromString(e,!0,16)}function KX(t){if(t.isZero())return"X";let e=t.countTrailingZeros();const n=e%4;e=(e-n)/4;const r=e;e*=4;const s=t.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-r-s.length).join("0")+s}function YX(t,e){const n=qX(t).shiftRightUnsigned(2);return t.add(Ge.fromNumber(2*e+1-4).multiply(n))}function qX(t){return t.and(t.not().add(1))}const QX=3,ZX=30,eJ=2*ZX+1,yS=180/Math.PI;function tJ(t){if(t.length===0)throw new Error("Invalid Hilbert quad key ".concat(t));const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length;let s=0;const o=[0,0];for(let a=i-1;a>=0;a--){s=i-a;const c=r[a];let l=0,u=0;c==="1"?u=1:c==="2"?(l=1,u=1):c==="3"&&(l=1);const f=Math.pow(2,s-1);rJ(f,o,l,u),o[0]+=f*l,o[1]+=f*u}if(n%2===1){const a=o[0];o[0]=o[1],o[1]=a}return{face:n,ij:o,level:s}}function nJ(t){if(t.isZero())return"";let e=t.toString(2);for(;e.length<QX+eJ;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),s=i.length/2,o=Ge.fromString(r,!0,2).toString(10);let a="";if(s!==0)for(a=Ge.fromString(i,!0,2).toString(4);a.length<s;)a="0"+a;return"".concat(o,"/").concat(a)}function MI(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function _S(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function RI(t){return[_S(t[0]),_S(t[1])]}function II(t,e){let[n,r]=e;switch(t){case 0:return[1,n,r];case 1:return[-n,1,r];case 2:return[-n,-r,1];case 3:return[-1,-r,-n];case 4:return[r,-1,-n];case 5:return[r,n,-1];default:throw new Error("Invalid face")}}function LI(t){let[e,n,r]=t;const i=Math.atan2(r,Math.sqrt(e*e+n*n));return[Math.atan2(n,e)*yS,i*yS]}function rJ(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function iJ(t){const e=MI(t.ij,t.level,[.5,.5]),n=RI(e),r=II(t.face,n);return LI(r)}const sJ=100;function bS(t){const{face:e,ij:n,level:r}=t,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],s=Math.max(1,Math.ceil(sJ*Math.pow(2,-r))),o=new Float64Array(4*s*2+2);let a=0,c=0;for(let l=0;l<4;l++){const u=i[l].slice(0),f=i[l+1],h=(f[0]-u[0])/s,d=(f[1]-u[1])/s;for(let p=0;p<s;p++){u[0]+=h,u[1]+=d;const y=MI(n,r,u),b=RI(y),v=II(e,b),m=LI(v);Math.abs(m[1])>89.999&&(m[0]=c);const _=m[0]-c;m[0]+=_>180?-360:_<-180?360:0,o[a++]=m[0],o[a++]=m[1],c=m[0]}}return o[a++]=o[0],o[a++]=o[1],o}function Q_(t){const e=oJ(t);return tJ(e)}function oJ(t){if(t.indexOf("/")>0)return t;const e=PI(t);return nJ(e)}function aJ(t){const e=Q_(t);return iJ(e)}function cJ(t){let e;if(t.face===2||t.face===5){let n=null,r=0;for(let i=0;i<4;i++){const s="".concat(t.face,"/").concat(i),o=Q_(s),a=bS(o);(typeof n>"u"||n===null)&&(n=new Float64Array(4*a.length)),n.set(a,r),r+=a.length}e=AS(n)}else{const n=bS(t);e=AS(n)}return e}function AS(t){if(t.length%2!==0)throw new Error("Invalid corners");const e=[],n=[];for(let r=0;r<t.length;r+=2)e.push(t[r]),n.push(t[r+1]);return e.sort((r,i)=>r-i),n.sort((r,i)=>r-i),{west:e[0],east:e[e.length-1],north:n[n.length-1],south:n[0]}}function lJ(t,e){const n=(e==null?void 0:e.minimumHeight)||0,r=(e==null?void 0:e.maximumHeight)||0,i=Q_(t),s=cJ(i),o=s.west,a=s.south,c=s.east,l=s.north,u=[];return u.push(new B(o,l,n)),u.push(new B(c,l,n)),u.push(new B(c,a,n)),u.push(new B(o,a,n)),u.push(new B(o,l,r)),u.push(new B(c,l,r)),u.push(new B(c,a,r)),u.push(new B(o,a,r)),u}function BI(t){const e=t.token,n={minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight},r=lJ(e,n),i=aJ(e),s=i[0],o=i[1],a=ct.WGS84.cartographicToCartesian([s,o,n.maximumHeight]),c=new B(a[0],a[1],a[2]);r.push(c);const l=F8(r);return[...l.center,...l.halfAxes]}const uJ=4,fJ=8,hJ={QUADTREE:uJ,OCTREE:fJ};function dJ(t,e,n){if(t!=null&&t.box){const r=PI(t.s2VolumeInfo.token),i=YX(r,e),s=KX(i),o={...t.s2VolumeInfo};switch(o.token=s,n){case"OCTREE":const l=t.s2VolumeInfo,u=l.maximumHeight-l.minimumHeight,f=u/2,h=l.minimumHeight+u/2;l.minimumHeight=h-f,l.maximumHeight=h+f;break}return{box:BI(o),s2VolumeInfo:o}}}async function OI(t){const{options:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:s}=t;let{subtree:o,level:a=0}=t;const{subdivisionScheme:c,subtreeLevels:l,maximumLevel:u,contentUrlTemplate:f,subtreesUriTemplate:h,basePath:d}=e,p={children:[],lodMetricValue:0,contentUrl:""},y=hJ[c],b=r&1,v=r>>1&1,m=r>>2&1,_=(y**a-1)/(y-1);let A=so(n.mortonIndex,r),S=_+A,w=so(n.x,b),x=so(n.y,v),M=so(n.z,m),L=!1;a+1>l&&(L=cm(o.childSubtreeAvailability,A));const R=so(i.x,w),I=so(i.y,x),N=so(i.z,M),k=a+i.level;if(L){const F="".concat(d,"/").concat(h),D=fv(F,k,R,I,N);o=await is(D,TI),i.mortonIndex=A,i.x=w,i.y=x,i.z=M,i.level=a,A=0,S=0,w=0,x=0,M=0,a=0}if(!cm(o.tileAvailability,S)||a>u)return p;cm(o.contentAvailability,S)&&(p.contentUrl=fv(f,k,R,I,N));const V=a+1,U={mortonIndex:A,x:w,y:x,z:M};for(let F=0;F<y;F++){const D=dJ(s,F,c),W=await OI({subtree:o,options:e,parentData:U,childIndex:F,level:V,globalData:i,s2VolumeBox:D});if(W.contentUrl||W.children.length){const ee=k+1,pe=gJ(W,ee,{childTileX:w,childTileY:x,childTileZ:M},e,s);p.children.push(pe)}}return p}function cm(t,e){return"constant"in t?!!t.constant:t.explicitBitstream?vJ(e,t.explicitBitstream):!1}function gJ(t,e,n,r,i){const{basePath:s,refine:o,getRefine:a,lodMetricType:c,getTileType:l,rootLodMetricValue:u,rootBoundingVolume:f}=r,h=t.contentUrl&&t.contentUrl.replace("".concat(s,"/"),""),d=u/2**e,p=i!=null&&i.box?{box:i.box}:f,y=pJ(e,p,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:h},id:t.contentUrl,refine:a(o),type:l(t),lodMetricType:c,lodMetricValue:d,geometricError:d,transform:t.transform,boundingVolume:y}}function pJ(t,e,n){if(e.region){const{childTileX:r,childTileY:i,childTileZ:s}=n,[o,a,c,l,u,f]=e.region,h=2**t,d=(c-o)/h,p=(l-a)/h,y=(f-u)/h,[b,v]=[o+d*r,o+d*(r+1)],[m,_]=[a+p*i,a+p*(i+1)],[A,S]=[u+y*s,u+y*(s+1)];return{region:[b,m,v,_,A,S]}}if(e.box)return e;throw new Error("Unsupported bounding volume type ".concat(e))}function so(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function fv(t,e,n,r,i){const s=mJ({level:e,x:n,y:r,z:i});return t.replace(/{level}|{x}|{y}|{z}/gi,o=>s[o])}function mJ(t){const e={};for(const n in t)e["{".concat(n,"}")]=t[n];return e}function vJ(t,e){const n=Math.floor(t/8),r=t%8;return(e[n]>>r&1)===1}function Z_(t){if(!t.contentUrl)return Ya.EMPTY;const n=t.contentUrl.split("?")[0].split(".").pop();switch(n){case"pnts":return Ya.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Ya.SCENEGRAPH;default:return n}}function e1(t){switch(t){case"REPLACE":case"replace":return Zi.REPLACE;case"ADD":case"add":return Zi.ADD;default:return t}}function hv(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const r=new URL(t,"".concat(e,"/"));return decodeURI(r.toString())}else if(t.startsWith("/"))return t;return"".concat(e,"/").concat(t)}function ES(t,e){if(!t)return null;if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=hv(n,e.basePath)}return t.id=t.contentUrl,t.lodMetricType=ag.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=Z_(t),t.refine=e1(t.refine),t}async function yJ(t,e){const n=t.basePath;let r;const i=SS(t==null?void 0:t.root);i&&t.root?r=await TS(t.root,t,i,e):r=ES(t.root,t);const s=[];for(s.push(r);s.length>0;){const a=(s.pop()||{}).children||[];for(let c of a){const l=SS(c);l?c=await TS(c,t,l,e):ES(c,{basePath:n}),s.push(c)}}return r}async function TS(t,e,n,r){var i,s;const o=e.basePath,{subdivisionScheme:a,maximumLevel:c,subtreeLevels:l,subtrees:{uri:u}}=n,f=fv(u,0,0,0,0),h=hv(f,o),d=await is(h,TI,r),p=hv(t.content.uri,o),y=e==null||(i=e.root)===null||i===void 0?void 0:i.refine,b=t.geometricError,v=(s=t.boundingVolume.extensions)===null||s===void 0?void 0:s["3DTILES_bounding_volume_S2"];if(v){const S={box:BI(v),s2VolumeInfo:v};t.boundingVolume=S}const m=t.boundingVolume,_={contentUrlTemplate:p,subtreesUriTemplate:u,subdivisionScheme:a,subtreeLevels:l,maximumLevel:c,refine:y,basePath:o,lodMetricType:ag.GEOMETRIC_ERROR,rootLodMetricValue:b,rootBoundingVolume:m,getTileType:Z_,getRefine:e1};return await _J(t,d,_)}async function _J(t,e,n){if(!t)return null;t.lodMetricType=ag.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform;const{children:r,contentUrl:i}=await OI({subtree:e,options:n,s2VolumeBox:t});return i&&(t.contentUrl=i,t.content={uri:i.replace("".concat(n.basePath,"/"),"")}),t.refine=e1(t.refine),t.type=Z_(t),t.children=r,t.id=t.contentUrl,t}function SS(t){var e;return(t==null||(e=t.extensions)===null||e===void 0?void 0:e["3DTILES_implicit_tiling"])||(t==null?void 0:t.implicitTiling)}const t1={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:pI,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:TJ,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function bJ(t){return jy(t.url)}async function AJ(t,e,n){const r={content:{featureIds:null}};return await EI(t,0,e,n,r.content),r.content}async function EJ(t,e,n){var r;const i=JSON.parse(new TextDecoder().decode(t));return i.loader=e.loader||t1,i.url=n.url,i.queryString=n.queryString,i.basePath=bJ(i),i.root=await yJ(i,e),i.type=_r.TILES3D,i.lodMetricType=ag.GEOMETRIC_ERROR,i.lodMetricValue=((r=i.root)===null||r===void 0?void 0:r.lodMetricValue)||0,i}async function TJ(t,e,n){const r=e["3d-tiles"]||{};let i;return r.isTileset==="auto"?i=n.url&&n.url.indexOf(".json")!==-1:i=r.isTileset,i?t=await EJ(t,e,n):t=await AJ(t,e,n),t}const CS=[0],SJ={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:t1,onTilesetLoad:{type:"function",value:t=>{}},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:(t,e,n)=>{}},_getMeshColor:{type:"function",value:t=>[255,255,255]}};class n1 extends tg{constructor(...e){super(...e),g(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&de.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:e}=this.state;return e!==null&&e.isLoaded()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:n,changeFlags:r}){if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){const{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(r.propsChanged){const{layerMap:i}=this.state;for(const s in i)i[s].needsUpdate=!0}}activateViewport(e){const{activeViewports:n,lastUpdatedViewports:r}=this.state;this.internalState.viewport=e,n[e.id]=e;const i=r==null?void 0:r[e.id];(!i||!e.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:n}){const r=n&&n.props.tile;return e.picked&&(e.object=r),e.sourceTile=r,e}filterSubLayer({layer:e,viewport:n}){const{tile:r}=e.props,{id:i}=n;return r.selected&&r.viewportIds.includes(i)}_updateAutoHighlight(e){const n=e.sourceTile,r=this.state.layerMap[n==null?void 0:n.id];r&&r.layer&&r.layer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:n={}}=this.props;let r=this.props.loader||this.props.loaders;Array.isArray(r)&&(r=r[0]);const i={loadOptions:{...n}};let s=e;if(r.preload){const c=await r.preload(e,n);c.url&&(s=c.url),c.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:c.headers}),Object.assign(i,c)}const o=await is(s,r,i.loadOptions),a=new rX(o,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:a,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(a)}_onTileLoad(e){const{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(e),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:n}=this.state,{timeline:r}=this.context,i=Object.keys(e).length;!r||!i||!n||n.selectTiles(Object.values(e)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(e,n){if(!e.content)return null;switch(e.type){case Ya.POINTCLOUD:return this._makePointCloudLayer(e,n);case Ya.SCENEGRAPH:return this._make3DModelLayer(e);case Ya.MESH:return this._makeSimpleMeshLayer(e,n);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}_makePointCloudLayer(e,n){const{attributes:r,pointCount:i,constantRGBA:s,cartographicOrigin:o,modelMatrix:a}=e.content,{positions:c,normals:l,colors:u}=r;if(!c)return null;const f=n&&n.props.data||{header:{vertexCount:i},attributes:{POSITION:c,NORMAL:l,COLOR_0:u}},{pointSize:h,getPointColor:d}=this.props,p=this.getSubLayerClass("pointcloud",R_);return new p({pointSize:h},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:f,coordinateSystem:Te.METER_OFFSETS,coordinateOrigin:o,modelMatrix:a,getColor:s||d,_offset:0})}_make3DModelLayer(e){const{gltf:n,instances:r,cartographicOrigin:i,modelMatrix:s}=e.content,o=this.getSubLayerClass("scenegraph",$_);return new o({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:r||CS,scenegraph:n,coordinateSystem:Te.METER_OFFSETS,coordinateOrigin:i,modelMatrix:s,getTransformMatrix:a=>a.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,n){const r=e.content,{attributes:i,indices:s,modelMatrix:o,cartographicOrigin:a,coordinateSystem:c=Te.METER_OFFSETS,material:l,featureIds:u}=r,{_getMeshColor:f}=this.props,h=n&&n.props.mesh||new Ii({drawMode:4,attributes:CJ(i),indices:s}),d=this.getSubLayerClass("mesh",X_);return new d(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:h,data:CS,getColor:f(e),pbrMaterial:l,modelMatrix:o,coordinateOrigin:a,coordinateSystem:c,featureIds:u,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:n}=this.state;return e?e.tiles.map(r=>{const i=n[r.id]=n[r.id]||{tile:r};let{layer:s}=i;return r.selected&&(s?i.needsUpdate&&(s=this._getSubLayer(r,s),i.needsUpdate=!1):s=this._getSubLayer(r)),i.layer=s,s}).filter(Boolean):null}}g(n1,"defaultProps",SJ);g(n1,"layerName","Tile3DLayer");function CJ(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}function FI(t,e){const n=[1/0,1/0,-1/0,-1/0];for(const r of t){const i=r.getBounds();if(i){const s=r.projectPosition(i[0],{viewport:e,autoOffset:!1}),o=r.projectPosition(i[1],{viewport:e,autoOffset:!1});n[0]=Math.min(n[0],s[0]),n[1]=Math.min(n[1],s[1]),n[2]=Math.max(n[2],o[0]),n[3]=Math.max(n[3],o[1])}}return Number.isFinite(n[0])?n:null}const wJ=2048;function DI(t){const{bounds:e,viewport:n,border:r=0}=t,{isGeospatial:i}=n;if(e[2]<=e[0]||e[3]<=e[1])return null;const s=n.unprojectPosition([(e[0]+e[2])/2,(e[1]+e[3])/2,0]);let{width:o,height:a,zoom:c}=t;if(c===void 0){o=o-r*2,a=a-r*2;const l=Math.min(o/(e[2]-e[0]),a/(e[3]-e[1]));c=Math.min(Math.log2(l),20)}else if(!o||!a){const l=2**c;o=Math.round(Math.abs(e[2]-e[0])*l),a=Math.round(Math.abs(e[3]-e[1])*l);const u=wJ-r*2;if(o>u||a>u){const f=u/Math.max(o,a);o=Math.round(o*f),a=Math.round(a*f),c+=Math.log2(f)}}return i?new Bo({id:n.id,x:r,y:r,width:o,height:a,longitude:s[0],latitude:s[1],zoom:c,orthographic:!0}):new g9({id:n.id,x:r,y:r,width:o,height:a,target:s,zoom:c,flipY:!1})}function xJ(t,e){let n;if(e&&e.length===2){const[s,o]=e,a=t.getBounds({z:s}),c=t.getBounds({z:o});n=[Math.min(a[0],c[0]),Math.min(a[1],c[1]),Math.max(a[2],c[2]),Math.max(a[3],c[3])]}else n=t.getBounds();const r=t.projectPosition(n.slice(0,2)),i=t.projectPosition(n.slice(2,4));return[r[0],r[1],i[0],i[1]]}function NI(t,e,n){if(!t)return[0,0,1,1];const r=xJ(e,n),i=PJ(r);return t[2]-t[0]<=i[2]-i[0]&&t[3]-t[1]<=i[3]-i[1]?t:[Math.max(t[0],i[0]),Math.max(t[1],i[1]),Math.min(t[2],i[2]),Math.min(t[3],i[3])]}function PJ(t){const e=t[2]-t[0],n=t[3]-t[1],r=(t[0]+t[2])/2,i=(t[1]+t[3])/2;return[r-e,i-n,r+e,i+n]}const Ti={NONE:0,WRITE_HEIGHT_MAP:1,USE_HEIGHT_MAP:2,USE_COVER:3,USE_COVER_ONLY:4,SKIP:5},wS=Object.keys(Ti).map(t=>"const float TERRAIN_MODE_".concat(t," = ").concat(Ti[t],".0;")).join(`
`),kI={name:"terrain",dependencies:[qd],inject:{"vs:#decl":`
uniform float terrain_mode;
uniform sampler2D terrain_map;
uniform vec4 terrain_bounds;
varying vec3 commonPos;
`.concat(wS,`
    `),"vs:#main-start":`
if (terrain_mode == TERRAIN_MODE_SKIP) {
  gl_Position = vec4(0.0);
  return;
}
`,"vs:DECKGL_FILTER_GL_POSITION":`
commonPos = geometry.position.xyz;
if (terrain_mode == TERRAIN_MODE_WRITE_HEIGHT_MAP) {
  vec2 texCoords = (commonPos.xy - terrain_bounds.xy) / terrain_bounds.zw;
  position = vec4(texCoords * 2.0 - 1.0, 0.0, 1.0);
  commonPos.z += project_uCommonOrigin.z;
}
if (terrain_mode == TERRAIN_MODE_USE_HEIGHT_MAP) {
  vec3 anchor = geometry.worldPosition;
  anchor.z = 0.0;
  vec3 anchorCommon = project_position(anchor);
  vec2 texCoords = (anchorCommon.xy - terrain_bounds.xy) / terrain_bounds.zw;
  if (texCoords.x >= 0.0 && texCoords.y >= 0.0 && texCoords.x <= 1.0 && texCoords.y <= 1.0) {
    float terrainZ = texture2D(terrain_map, texCoords).r;
    geometry.position.z += terrainZ;
    position = project_common_position_to_clipspace(geometry.position);
  }
}
    `,"fs:#decl":`
uniform float terrain_mode;
uniform sampler2D terrain_map;
uniform vec4 terrain_bounds;
varying vec3 commonPos;
`.concat(wS,`
    `),"fs:#main-start":`
if (terrain_mode == TERRAIN_MODE_WRITE_HEIGHT_MAP) {
  gl_FragColor = vec4(commonPos.z, 0.0, 0.0, 1.0);
  return;
}
    `,"fs:DECKGL_FILTER_COLOR":`
if ((terrain_mode == TERRAIN_MODE_USE_COVER) || (terrain_mode == TERRAIN_MODE_USE_COVER_ONLY)) {
  vec2 texCoords = (commonPos.xy - terrain_bounds.xy) / terrain_bounds.zw;
  vec4 pixel = texture2D(terrain_map, texCoords);
  if (terrain_mode == TERRAIN_MODE_USE_COVER_ONLY) {
    color = pixel;
  } else {
    // pixel is premultiplied
    color = pixel + color * (1.0 - pixel.a);
  }
  return;
}
    `},getUniforms:(t={},e)=>{if("dummyHeightMap"in t){const{drawToTerrainHeightMap:n,heightMap:r,heightMapBounds:i,dummyHeightMap:s,terrainCover:o,useTerrainHeightMap:a,terrainSkipRender:c}=t,{project_uCommonOrigin:l}=e;let u=c?Ti.SKIP:Ti.NONE,f=s,h=null;if(n)u=Ti.WRITE_HEIGHT_MAP,h=i;else if(a&&r)u=Ti.USE_HEIGHT_MAP,f=r,h=i;else if(o){const d=t.pickingActive;f=d?o.getPickingFramebuffer():o.getRenderFramebuffer(),d&&(u=Ti.SKIP),f?(u=u===Ti.SKIP?Ti.USE_COVER_ONLY:Ti.USE_COVER,h=o.bounds):f=s}return{terrain_mode:u,terrain_map:f,terrain_bounds:h?[h[0]-l[0],h[1]-l[1],h[2]-h[0],h[3]-h[1]]:[0,0,0,0]}}return null}};function dv(t,e){return new Et(t,{id:e.id,attachments:{36064:new on(t,{...e.float&&{format:_e(t)?34836:6408,type:5126},mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}})}})}class MJ{constructor(e){g(this,"isDirty",!0),g(this,"targetLayer",void 0),g(this,"renderViewport",null),g(this,"bounds",null),g(this,"fbo",void 0),g(this,"pickingFbo",void 0),g(this,"layers",[]),g(this,"tile",void 0),g(this,"targetBounds",null),g(this,"targetBoundsCommon",null),this.targetLayer=e,this.tile=UI(e)}get id(){return this.targetLayer.id}get isActive(){return!!this.targetLayer.getCurrentLayer()}shouldUpdate({targetLayer:e,viewport:n,layers:r,layerNeedsRedraw:i}){e&&(this.targetLayer=e);const s=n?this._updateViewport(n):!1;let o=r?this._updateLayers(r):!1;if(i){for(const a of this.layers)if(i[a]){o=!0;break}}return o||s}_updateLayers(e){let n=!1;if(e=this.tile?RJ(this.tile,e):e,e.length!==this.layers.length)n=!0;else for(let r=0;r<e.length;r++)if(e[r].id!==this.layers[r]){n=!0;break}return n&&(this.layers=e.map(r=>r.id)),n}_updateViewport(e){const n=this.targetLayer;let r=!1;if(this.tile&&"boundingBox"in this.tile){if(!this.targetBounds){r=!0,this.targetBounds=this.tile.boundingBox;const o=e.projectPosition(this.targetBounds[0]),a=e.projectPosition(this.targetBounds[1]);this.targetBoundsCommon=[o[0],o[1],a[0],a[1]]}}else this.targetBounds!==n.getBounds()&&(r=!0,this.targetBounds=n.getBounds(),this.targetBoundsCommon=FI([n],e));if(!this.targetBoundsCommon)return!1;const i=Math.ceil(e.zoom+.5);if(this.tile)this.bounds=this.targetBoundsCommon;else{var s;const o=(s=this.renderViewport)===null||s===void 0?void 0:s.zoom;r=r||i!==o;const a=NI(this.targetBoundsCommon,e),c=this.bounds;r=r||!c||a.some((l,u)=>l!==c[u]),this.bounds=a}return r&&(this.renderViewport=DI({bounds:this.bounds,zoom:i,viewport:e})),r}getRenderFramebuffer(){return!this.renderViewport||this.layers.length===0?null:(this.fbo||(this.fbo=dv(this.targetLayer.context.gl,{id:this.id})),this.fbo)}getPickingFramebuffer(){return!this.renderViewport||this.layers.length===0&&!this.targetLayer.props.pickable?null:(this.pickingFbo||(this.pickingFbo=dv(this.targetLayer.context.gl,{id:"".concat(this.id,"-picking")})),this.pickingFbo)}filterLayers(e){return e.filter(({id:n})=>this.layers.includes(n))}delete(){const{fbo:e,pickingFbo:n}=this;e&&(e.texture.delete(),e.delete()),n&&(n.texture.delete(),n.delete())}}function RJ(t,e){return e.filter(n=>{const r=UI(n);return r?IJ(t.boundingBox,r.boundingBox):!0})}function UI(t){for(;t;){const{tile:e}=t.props;if(e)return e;t=t.parent}return null}function IJ(t,e){return t&&e?t[0][0]<e[1][0]&&e[0][0]<t[1][0]&&t[0][1]<e[1][1]&&e[0][1]<t[1][1]:!1}class LJ extends Yd{getRenderableLayers(e,n){const{layers:r}=n,i=[],s=this._getDrawLayerParams(e,n,!0);for(let o=0;o<r.length;o++){const a=r[o];!a.isComposite&&s[o].shouldDrawLayer&&i.push(a)}return i}renderHeightMap(e,n){const r=e.getRenderFramebuffer(),i=e.renderViewport;!r||!i||(r.resize(i),Xn(this.gl,{clearColor:[0,0,0,0],blend:!0,blendFunc:[1,1],blendEquation:32776,depthTest:!1},()=>this.render({...n,target:r,pass:"terrain-height-map",layers:n.layers,viewports:[i],effects:[]})))}renderTerrainCover(e,n){const r=e.getRenderFramebuffer(),i=e.renderViewport;if(!r||!i)return;const s=e.filterLayers(n.layers);r.resize(i),Xn(this.gl,{clearColor:[0,0,0,0],depthTest:!1},()=>this.render({...n,target:r,pass:"terrain-cover-".concat(e.id),layers:s,effects:[],viewports:[i]}))}}class BJ extends E_{constructor(...e){super(...e),g(this,"drawParameters",{})}getRenderableLayers(e,n){const{layers:r}=n,i=[];this.drawParameters={},this._resetColorEncoder(n.pickZ);const s=this._getDrawLayerParams(e,n);for(let o=0;o<r.length;o++){const a=r[o];!a.isComposite&&s[o].shouldDrawLayer&&(i.push(a),this.drawParameters[a.id]=s[o].layerParameters)}return i}renderTerrainCover(e,n){const r=e.getPickingFramebuffer(),i=e.renderViewport;if(!r||!i)return;const s=e.filterLayers(n.layers),o=e.targetLayer;o.props.pickable&&s.unshift(o),r.resize(i),Xn(this.gl,{depthTest:!1},()=>this.render({...n,pickingFBO:r,pass:"terrain-cover-picking-".concat(e.id),layers:s,effects:[],viewports:[i],cullRect:void 0,deviceRect:i,pickZ:!1}))}getLayerParameters(e,n,r){if(this.drawParameters[e.id])return this.drawParameters[e.id];const i=super.getLayerParameters(e,n,r);return i.blend=!0,i}}const xS=2048;class PS{static isSupported(e){return Et.isSupported(e,{colorBufferFloat:!0})}constructor(e){g(this,"renderViewport",null),g(this,"bounds",null),g(this,"fbo",void 0),g(this,"gl",void 0),g(this,"layers",[]),g(this,"layersBounds",[]),g(this,"layersBoundsCommon",null),g(this,"lastViewport",null),this.gl=e}getRenderFramebuffer(){return this.renderViewport?(this.fbo||(this.fbo=dv(this.gl,{id:"height-map",float:!0})),this.fbo):null}shouldUpdate({layers:e,viewport:n}){const r=e.length!==this.layers.length||e.some((s,o)=>s!==this.layers[o]||s.props.transitions||s.getBounds()!==this.layersBounds[o]);r&&(this.layers=e,this.layersBounds=e.map(s=>s.getBounds()),this.layersBoundsCommon=FI(e,n));const i=!this.lastViewport||!n.equals(this.lastViewport);if(!this.layersBoundsCommon)this.renderViewport=null;else if(r||i){const s=NI(this.layersBoundsCommon,n);if(s[2]<=s[0]||s[3]<=s[1])return this.renderViewport=null,!1;this.bounds=s,this.lastViewport=n;const o=n.scale,a=(s[2]-s[0])*o,c=(s[3]-s[1])*o;return this.renderViewport=a>0||c>0?DI({bounds:[n.center[0]-1,n.center[1]-1,n.center[0]+1,n.center[1]+1],zoom:n.zoom,width:Math.min(a,xS),height:Math.min(c,xS),viewport:n}):null,!0}return!1}delete(){this.fbo&&(this.fbo.color.delete(),this.fbo.delete())}}class OJ{constructor(){g(this,"id","terrain-effect"),g(this,"props",null),g(this,"useInPicking",!0),g(this,"isPicking",!1),g(this,"isDrapingEnabled",!1),g(this,"dummyHeightMap",void 0),g(this,"heightMap",void 0),g(this,"terrainPass",void 0),g(this,"terrainPickingPass",void 0),g(this,"terrainCovers",new Map)}initialize(e){this.dummyHeightMap=new on(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])}),this.terrainPass=new LJ(e,{id:"terrain"}),this.terrainPickingPass=new BJ(e,{id:"terrain-picking"}),PS.isSupported(e)?this.heightMap=new PS(e):de.warn("Terrain offset mode is not supported by this browser")(),Sc.getDefaultProgramManager(e).addDefaultModule(kI)}preRender(e,n){if(!this.dummyHeightMap){this.initialize(e);for(const l of n.layers)l.props.operation.includes("terrain")&&l.setChangeFlags({extensionsChanged:!0})}if(n.pickZ){this.isDrapingEnabled=!1;return}const{viewports:r,isPicking:i=!1}=n;this.isPicking=i,this.isDrapingEnabled=!0;const s=r[0],o=(i?this.terrainPickingPass:this.terrainPass).getRenderableLayers(s,n),a=o.filter(l=>l.props.operation.includes("terrain"));if(a.length===0)return;i||o.filter(u=>u.state.terrainDrawMode==="offset").length>0&&this._updateHeightMap(a,s,n);const c=o.filter(l=>l.state.terrainDrawMode==="drape");this._updateTerrainCovers(a,c,s,n)}getModuleParameters(e){var n,r;const{terrainDrawMode:i}=e.state;return{heightMap:(n=this.heightMap)===null||n===void 0?void 0:n.getRenderFramebuffer(),heightMapBounds:(r=this.heightMap)===null||r===void 0?void 0:r.bounds,dummyHeightMap:this.dummyHeightMap,terrainCover:this.isDrapingEnabled?this.terrainCovers.get(e.id):null,useTerrainHeightMap:i==="offset",terrainSkipRender:i==="drape"||!e.props.operation.includes("draw")}}cleanup(){this.dummyHeightMap&&(this.dummyHeightMap.delete(),this.dummyHeightMap=void 0),this.heightMap&&(this.heightMap.delete(),this.heightMap=void 0);for(const e of this.terrainCovers.values())e.delete();this.terrainCovers.clear()}_updateHeightMap(e,n,r){!this.heightMap||!this.heightMap.shouldUpdate({layers:e,viewport:n})||this.terrainPass.renderHeightMap(this.heightMap,{...r,layers:e,moduleParameters:{heightMapBounds:this.heightMap.bounds,dummyHeightMap:this.dummyHeightMap,devicePixelRatio:1,drawToTerrainHeightMap:!0}})}_updateTerrainCovers(e,n,r,i){const s={};for(const o of n)o.state.terrainCoverNeedsRedraw&&(s[o.id]=!0,o.state.terrainCoverNeedsRedraw=!1);for(const o of this.terrainCovers.values())o.isDirty=o.isDirty||o.shouldUpdate({layerNeedsRedraw:s});for(const o of e)this._updateTerrainCover(o,n,r,i);this.isPicking||this._pruneTerrainCovers()}_updateTerrainCover(e,n,r,i){const s=this.isPicking?this.terrainPickingPass:this.terrainPass;let o=this.terrainCovers.get(e.id);o||(o=new MJ(e),this.terrainCovers.set(e.id,o));try{const a=o.shouldUpdate({targetLayer:e,viewport:r,layers:n});(this.isPicking||o.isDirty||a)&&(s.renderTerrainCover(o,{...i,layers:n,moduleParameters:{dummyHeightMap:this.dummyHeightMap,terrainSkipRender:!1,devicePixelRatio:1}}),o.isDirty=!1)}catch(a){e.raiseError(a,"Error rendering terrain cover ".concat(o.id))}}_pruneTerrainCovers(){const e=[];for(const[n,r]of this.terrainCovers)r.isActive||e.push(n);for(const n of e)this.terrainCovers.delete(n)}}const FJ={terrainDrawMode:void 0};class r1 extends M_{getShaders(){return{modules:[kI]}}initializeState(){var e;(e=this.context.deck)===null||e===void 0||e._addDefaultEffect(new OJ)}updateState(e){const{props:n,oldProps:r}=e;if(this.state.terrainDrawMode&&n.terrainDrawMode===r.terrainDrawMode&&n.extruded===r.extruded)return;let{terrainDrawMode:i}=n;if(!i){var s;const o=this.props.extruded,a=(s=this.getAttributeManager())===null||s===void 0?void 0:s.attributes,c=a&&"instancePositions"in a;i=o||c?"offset":"drape"}this.setState({terrainDrawMode:i})}onNeedsRedraw(){const e=this.state;e.terrainDrawMode==="drape"&&(e.terrainCoverNeedsRedraw=!0)}}g(r1,"defaultProps",FJ);g(r1,"extensionName","TerrainExtension");function GI(t,e,n){if(t!==null)for(var r,i,s,o,a,c,l,u=0,f=0,h,d=t.type,p=d==="FeatureCollection",y=d==="Feature",b=p?t.features.length:1,v=0;v<b;v++){l=p?t.features[v].geometry:y?t.geometry:t,h=l?l.type==="GeometryCollection":!1,a=h?l.geometries.length:1;for(var m=0;m<a;m++){var _=0,A=0;if(o=h?l.geometries[m]:l,o!==null){c=o.coordinates;var S=o.type;switch(u=n&&(S==="Polygon"||S==="MultiPolygon")?1:0,S){case null:break;case"Point":if(e(c,f,v,_,A)===!1)return!1;f++,_++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(e(c[r],f,v,_,A)===!1)return!1;f++,S==="MultiPoint"&&_++}S==="LineString"&&_++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(i=0;i<c[r].length-u;i++){if(e(c[r][i],f,v,_,A)===!1)return!1;f++}S==="MultiLineString"&&_++,S==="Polygon"&&A++}S==="Polygon"&&_++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(A=0,i=0;i<c[r].length;i++){for(s=0;s<c[r][i].length-u;s++){if(e(c[r][i][s],f,v,_,A)===!1)return!1;f++}A++}_++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(GI(o.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function gv(t){var e=[1/0,1/0,-1/0,-1/0];return GI(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}gv.default=gv;var Dn=63710088e-1,DJ={centimeters:Dn*100,centimetres:Dn*100,degrees:Dn/111325,feet:Dn*3.28084,inches:Dn*39.37,kilometers:Dn/1e3,kilometres:Dn/1e3,meters:Dn,metres:Dn,miles:Dn/1609.344,millimeters:Dn*1e3,millimetres:Dn*1e3,nauticalmiles:Dn/1852,radians:1,yards:Dn*1.0936};function NJ(t,e){e===void 0&&(e="kilometers");var n=DJ[e];if(!n)throw new Error(e+" units is invalid");return t*n}function Mf(t){var e=t%360;return e*Math.PI/180}function MS(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function RS(t,e,n){n===void 0&&(n={});var r=MS(t),i=MS(e),s=Mf(i[1]-r[1]),o=Mf(i[0]-r[0]),a=Mf(r[1]),c=Mf(i[1]),l=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(a)*Math.cos(c);return NJ(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)),n.units)}function kJ(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function UJ(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!IS(t[0])||!IS(t[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:t};return kJ(r,e,n)}function IS(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function LS(t,e){e===void 0&&(e={});var n=gv(t),r=(n[0]+n[2])/2,i=(n[1]+n[3])/2;return UJ([r,i],e.properties,e)}function mh(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function GJ(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function zI(t){let e,n,r;t.length!==2?(e=mh,n=(a,c)=>mh(t(a),c),r=(a,c)=>t(a)-c):(e=t===mh||t===GJ?t:zJ,n=t,r=t);function i(a,c,l=0,u=a.length){if(l<u){if(e(c,c)!==0)return u;do{const f=l+u>>>1;n(a[f],c)<0?l=f+1:u=f}while(l<u)}return l}function s(a,c,l=0,u=a.length){if(l<u){if(e(c,c)!==0)return u;do{const f=l+u>>>1;n(a[f],c)<=0?l=f+1:u=f}while(l<u)}return l}function o(a,c,l=0,u=a.length){const f=i(a,c,l,u-1);return f>l&&r(a[f-1],c)>-r(a[f],c)?f-1:f}return{left:i,center:o,right:s}}function zJ(){return 0}function HJ(t){return t===null?NaN:+t}const jJ=zI(mh),VJ=jJ.right;zI(HJ).center;const WJ=VJ,$J=Math.sqrt(50),XJ=Math.sqrt(10),JJ=Math.sqrt(2);function gd(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=$J?10:s>=XJ?5:s>=JJ?2:1;let a,c,l;return i<0?(l=Math.pow(10,-i)/o,a=Math.round(t*l),c=Math.round(e*l),a/l<t&&++a,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*o,a=Math.round(t/l),c=Math.round(e/l),a*l<t&&++a,c*l>e&&--c),c<a&&.5<=n&&n<2?gd(t,e,n*2):[a,c,l]}function KJ(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,o]=r?gd(e,t,n):gd(t,e,n);if(!(s>=i))return[];const a=s-i+1,c=new Array(a);if(r)if(o<0)for(let l=0;l<a;++l)c[l]=(s-l)/-o;else for(let l=0;l<a;++l)c[l]=(s-l)*o;else if(o<0)for(let l=0;l<a;++l)c[l]=(i+l)/-o;else for(let l=0;l<a;++l)c[l]=(i+l)*o;return c}function pv(t,e,n){return e=+e,t=+t,n=+n,gd(t,e,n)[2]}function YJ(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?pv(e,t,n):pv(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function qJ(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function i1(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function HI(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function xu(){}var Zl=.7,pd=1/Zl,qa="\\s*([+-]?\\d+)\\s*",eu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Li="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",QJ=/^#([0-9a-f]{3,8})$/,ZJ=new RegExp(`^rgb\\(${qa},${qa},${qa}\\)$`),eK=new RegExp(`^rgb\\(${Li},${Li},${Li}\\)$`),tK=new RegExp(`^rgba\\(${qa},${qa},${qa},${eu}\\)$`),nK=new RegExp(`^rgba\\(${Li},${Li},${Li},${eu}\\)$`),rK=new RegExp(`^hsl\\(${eu},${Li},${Li}\\)$`),iK=new RegExp(`^hsla\\(${eu},${Li},${Li},${eu}\\)$`),BS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};i1(xu,tu,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:OS,formatHex:OS,formatHex8:sK,formatHsl:oK,formatRgb:FS,toString:FS});function OS(){return this.rgb().formatHex()}function sK(){return this.rgb().formatHex8()}function oK(){return jI(this).formatHsl()}function FS(){return this.rgb().formatRgb()}function tu(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=QJ.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?DS(e):n===3?new Hn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Rf(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Rf(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ZJ.exec(t))?new Hn(e[1],e[2],e[3],1):(e=eK.exec(t))?new Hn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=tK.exec(t))?Rf(e[1],e[2],e[3],e[4]):(e=nK.exec(t))?Rf(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=rK.exec(t))?US(e[1],e[2]/100,e[3]/100,1):(e=iK.exec(t))?US(e[1],e[2]/100,e[3]/100,e[4]):BS.hasOwnProperty(t)?DS(BS[t]):t==="transparent"?new Hn(NaN,NaN,NaN,0):null}function DS(t){return new Hn(t>>16&255,t>>8&255,t&255,1)}function Rf(t,e,n,r){return r<=0&&(t=e=n=NaN),new Hn(t,e,n,r)}function aK(t){return t instanceof xu||(t=tu(t)),t?(t=t.rgb(),new Hn(t.r,t.g,t.b,t.opacity)):new Hn}function mv(t,e,n,r){return arguments.length===1?aK(t):new Hn(t,e,n,r??1)}function Hn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}i1(Hn,mv,HI(xu,{brighter(t){return t=t==null?pd:Math.pow(pd,t),new Hn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Zl:Math.pow(Zl,t),new Hn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Hn(To(this.r),To(this.g),To(this.b),md(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:NS,formatHex:NS,formatHex8:cK,formatRgb:kS,toString:kS}));function NS(){return`#${vo(this.r)}${vo(this.g)}${vo(this.b)}`}function cK(){return`#${vo(this.r)}${vo(this.g)}${vo(this.b)}${vo((isNaN(this.opacity)?1:this.opacity)*255)}`}function kS(){const t=md(this.opacity);return`${t===1?"rgb(":"rgba("}${To(this.r)}, ${To(this.g)}, ${To(this.b)}${t===1?")":`, ${t})`}`}function md(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function To(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function vo(t){return t=To(t),(t<16?"0":"")+t.toString(16)}function US(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ei(t,e,n,r)}function jI(t){if(t instanceof ei)return new ei(t.h,t.s,t.l,t.opacity);if(t instanceof xu||(t=tu(t)),!t)return new ei;if(t instanceof ei)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,c=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=c<.5?s+i:2-s-i,o*=60):a=c>0&&c<1?0:o,new ei(o,a,c,t.opacity)}function lK(t,e,n,r){return arguments.length===1?jI(t):new ei(t,e,n,r??1)}function ei(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}i1(ei,lK,HI(xu,{brighter(t){return t=t==null?pd:Math.pow(pd,t),new ei(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Zl:Math.pow(Zl,t),new ei(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Hn(lm(t>=240?t-240:t+120,i,r),lm(t,i,r),lm(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new ei(GS(this.h),If(this.s),If(this.l),md(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=md(this.opacity);return`${t===1?"hsl(":"hsla("}${GS(this.h)}, ${If(this.s)*100}%, ${If(this.l)*100}%${t===1?")":`, ${t})`}`}}));function GS(t){return t=(t||0)%360,t<0?t+360:t}function If(t){return Math.max(0,Math.min(1,t||0))}function lm(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const s1=t=>()=>t;function uK(t,e){return function(n){return t+n*e}}function fK(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function hK(t){return(t=+t)==1?VI:function(e,n){return n-e?fK(e,n,t):s1(isNaN(e)?n:e)}}function VI(t,e){var n=e-t;return n?uK(t,n):s1(isNaN(t)?e:t)}const zS=function t(e){var n=hK(e);function r(i,s){var o=n((i=mv(i)).r,(s=mv(s)).r),a=n(i.g,s.g),c=n(i.b,s.b),l=VI(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=a(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=t,r}(1);function dK(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function gK(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pK(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=o1(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function mK(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function vd(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function vK(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=o1(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var vv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,um=new RegExp(vv.source,"g");function yK(t){return function(){return t}}function _K(t){return function(e){return t(e)+""}}function bK(t,e){var n=vv.lastIndex=um.lastIndex=0,r,i,s,o=-1,a=[],c=[];for(t=t+"",e=e+"";(r=vv.exec(t))&&(i=um.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:vd(r,i)})),n=um.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?_K(c[0].x):yK(e):(e=c.length,function(l){for(var u=0,f;u<e;++u)a[(f=c[u]).i]=f.x(l);return a.join("")})}function o1(t,e){var n=typeof e,r;return e==null||n==="boolean"?s1(e):(n==="number"?vd:n==="string"?(r=tu(e))?(e=r,zS):bK:e instanceof tu?zS:e instanceof Date?mK:gK(e)?dK:Array.isArray(e)?pK:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?vK:vd)(t,e)}function AK(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function EK(t){return function(){return t}}function TK(t){return+t}var HS=[0,1];function Fa(t){return t}function yv(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:EK(isNaN(e)?NaN:.5)}function SK(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function CK(t,e,n){var r=t[0],i=t[1],s=e[0],o=e[1];return i<r?(r=yv(i,r),s=n(o,s)):(r=yv(r,i),s=n(s,o)),function(a){return s(r(a))}}function wK(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=yv(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(a){var c=WJ(t,a,1,r)-1;return s[c](i[c](a))}}function xK(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function PK(){var t=HS,e=HS,n=o1,r,i,s,o=Fa,a,c,l;function u(){var h=Math.min(t.length,e.length);return o!==Fa&&(o=SK(t[0],t[h-1])),a=h>2?wK:CK,c=l=null,f}function f(h){return h==null||isNaN(h=+h)?s:(c||(c=a(t.map(r),e,n)))(r(o(h)))}return f.invert=function(h){return o(i((l||(l=a(e,t.map(r),vd)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,TK),u()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),u()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),n=AK,u()},f.clamp=function(h){return arguments.length?(o=h?!0:Fa,u()):o!==Fa},f.interpolate=function(h){return arguments.length?(n=h,u()):n},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,d){return r=h,i=d,u()}}function MK(){return PK()(Fa,Fa)}function RK(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function yd(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function pc(t){return t=yd(Math.abs(t)),t?t[1]:NaN}function IK(t,e){return function(n,r){for(var i=n.length,s=[],o=0,a=t[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),s.push(n.substring(i-=a,i+a)),!((c+=a+1)>r));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function LK(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var BK=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _d(t){if(!(e=BK.exec(t)))throw new Error("invalid format: "+t);var e;return new a1({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}_d.prototype=a1.prototype;function a1(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}a1.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function OK(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var WI;function FK(t,e){var n=yd(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(WI=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+yd(t,Math.max(0,e+s-1))[0]}function jS(t,e){var n=yd(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const VS={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:RK,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>jS(t*100,e),r:jS,s:FK,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function WS(t){return t}var $S=Array.prototype.map,XS=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function DK(t){var e=t.grouping===void 0||t.thousands===void 0?WS:IK($S.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?WS:LK($S.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(f){f=_d(f);var h=f.fill,d=f.align,p=f.sign,y=f.symbol,b=f.zero,v=f.width,m=f.comma,_=f.precision,A=f.trim,S=f.type;S==="n"?(m=!0,S="g"):VS[S]||(_===void 0&&(_=12),A=!0,S="g"),(b||h==="0"&&d==="=")&&(b=!0,h="0",d="=");var w=y==="$"?n:y==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",x=y==="$"?r:/[%p]/.test(S)?o:"",M=VS[S],L=/[defgprs%]/.test(S);_=_===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function R(I){var N=w,k=x,z,$,V;if(S==="c")k=M(I)+k,I="";else{I=+I;var U=I<0||1/I<0;if(I=isNaN(I)?c:M(Math.abs(I),_),A&&(I=OK(I)),U&&+I==0&&p!=="+"&&(U=!1),N=(U?p==="("?p:a:p==="-"||p==="("?"":p)+N,k=(S==="s"?XS[8+WI/3]:"")+k+(U&&p==="("?")":""),L){for(z=-1,$=I.length;++z<$;)if(V=I.charCodeAt(z),48>V||V>57){k=(V===46?i+I.slice(z+1):I.slice(z))+k,I=I.slice(0,z);break}}}m&&!b&&(I=e(I,1/0));var F=N.length+I.length+k.length,D=F<v?new Array(v-F+1).join(h):"";switch(m&&b&&(I=e(D+I,D.length?v-k.length:1/0),D=""),d){case"<":I=N+I+k+D;break;case"=":I=N+D+I+k;break;case"^":I=D.slice(0,F=D.length>>1)+N+I+k+D.slice(F);break;default:I=D+N+I+k;break}return s(I)}return R.toString=function(){return f+""},R}function u(f,h){var d=l((f=_d(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(pc(h)/3)))*3,y=Math.pow(10,-p),b=XS[8+p/3];return function(v){return d(y*v)+b}}return{format:l,formatPrefix:u}}var Lf,$I,XI;NK({thousands:",",grouping:[3],currency:["$",""]});function NK(t){return Lf=DK(t),$I=Lf.format,XI=Lf.formatPrefix,Lf}function kK(t){return Math.max(0,-pc(Math.abs(t)))}function UK(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(pc(e)/3)))*3-pc(Math.abs(t)))}function GK(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,pc(e)-pc(t))+1}function zK(t,e,n,r){var i=YJ(t,e,n),s;switch(r=_d(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=UK(i,o))&&(r.precision=s),XI(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=GK(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=kK(i))&&(r.precision=s-(r.type==="%")*2);break}}return $I(r)}function HK(t){var e=t.domain;return t.ticks=function(n){var r=e();return KJ(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return zK(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],c,l,u=10;for(a<o&&(l=o,o=a,a=l,l=i,i=s,s=l);u-- >0;){if(l=pv(o,a,n),l===c)return r[i]=o,r[s]=a,e(r);if(l>0)o=Math.floor(o/l)*l,a=Math.ceil(a/l)*l;else if(l<0)o=Math.ceil(o*l)/l,a=Math.floor(a*l)/l;else break;c=l}return t},t}function JI(){var t=MK();return t.copy=function(){return xK(t,JI())},qJ.apply(t,arguments),HK(t)}const jK="modulepreload",VK=function(t){return"/mapengine-survey/step3/deckgl-terrain/"+t},JS={},WK=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=VK(s),s in JS)return;JS[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const f=i[u];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":jK,o||(l.as="script",l.crossOrigin=""),l.href=s,document.head.appendChild(l),o)return new Promise((u,f)=>{l.addEventListener("load",u),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},$K=E.createContext(null);function XK(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function $i(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!$i(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!$i(t[i],e[i]))return!1;return!0}return!1}function JK(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function KS(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();$i(n,r)||e.setProjection(n)}function YS(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function qS(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const KK=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function QS(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of KK)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}const ZS={version:8,sources:{},layers:[]},eC={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},fm={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},tC={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},YK=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],qK=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class mc{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[tC[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[eC[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[fm[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=mc.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=ZS}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||QK()||null,container:e,style:QS(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=u=>{this._inRender=!0,a.call(o,u),this._inRender=!1};const c=o._renderTaskQueue.run;o._renderTaskQueue.run=u=>{c.call(o._renderTaskQueue,u),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const l=o.fire;o.fire=this._fireEvent.bind(this,l),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),KS(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in eC)o.on(u,this._onPointerEvent);for(const u in fm)o.on(u,this._onCameraEvent);for(const u in tC)o.on(u,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),mc.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=JK(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,c=r.isMoving();c&&(i.cameraElevationReference="sea");const l=qS(i,{...YS(r.transform),...e});if(c&&(i.cameraElevationReference="ground"),l&&n){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=s!==i.zoom),u.rotate||(u.rotate=a!==i.bearing),u.pitch||(u.pitch=o!==i.pitch)}return c||qS(r.transform,e),l}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of YK)if(s in e&&!$i(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=ZS,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(QS(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!$i(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!$i(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!$i(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of qK){const c=(r=e[a])!==null&&r!==void 0?r:!0,l=(i=n[a])!==null&&i!==void 0?i:!0;$i(c,l)||(o=!0,c?s[a].enable(c):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),c=a.length>0;!c&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,c&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in fm&&(typeof n=="object"&&(n.viewState=YS(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{KS(this._renderTransform,n),e.transform=n}}}mc.savedMaps=[];function QK(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const ZK=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function eY(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of tY(e))!(r in n)&&!ZK.includes(r)&&(n[r]=e[r].bind(e));return n}function tY(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const nY=typeof document<"u"?E.useLayoutEffect:E.useEffect,rY=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function iY(t,e){for(const r of rY)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const ug=E.createContext(null);function sY(t,e,n){const r=E.useContext($K),[i,s]=E.useState(null),o=E.useRef(),{current:a}=E.useRef({mapLib:null,map:null});E.useEffect(()=>{const u=t.mapLib;let f=!0,h;return Promise.resolve(u||n).then(d=>{if(!f)return;if(!d)throw new Error("Invalid mapLib");const p="Map"in d?d:d.default;if(!p.Map)throw new Error("Invalid mapLib");if(iY(p,t),!p.supported||p.supported(t))t.reuseMaps&&(h=mc.reuse(t,o.current)),h||(h=new mc(p.Map,t,o.current)),a.map=eY(h),a.mapLib=p,s(h),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(d=>{const{onError:p}=t;p?p({type:"error",target:null,originalEvent:null,error:d}):console.error(d)}),()=>{f=!1,h&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?h.recycle():h.destroy())}},[]),nY(()=>{i&&i.setProps(t)}),E.useImperativeHandle(e,()=>a.map,[i]);const c=E.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),l={height:"100%"};return E.createElement("div",{id:t.id,ref:o,style:c},i&&E.createElement(ug.Provider,{value:a},E.createElement("div",{"mapboxgl-children":"",style:l},t.children)))}const oY=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function $o(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!oY.test(r)?n[r]=`${i}px`:n[r]=i}}function aY(t,e){const{map:n,mapLib:r}=E.useContext(ug),i=E.useRef({props:t});i.current.props=t;const s=E.useMemo(()=>{let y=!1;E.Children.forEach(t.children,m=>{m&&(y=!0)});const b={...t,element:y?document.createElement("div"):null},v=new r.Marker(b);return v.setLngLat([t.longitude,t.latitude]),v.getElement().addEventListener("click",m=>{var _,A;(A=(_=i.current.props).onClick)===null||A===void 0||A.call(_,{type:"click",target:v,originalEvent:m})}),v.on("dragstart",m=>{var _,A;const S=m;S.lngLat=s.getLngLat(),(A=(_=i.current.props).onDragStart)===null||A===void 0||A.call(_,S)}),v.on("drag",m=>{var _,A;const S=m;S.lngLat=s.getLngLat(),(A=(_=i.current.props).onDrag)===null||A===void 0||A.call(_,S)}),v.on("dragend",m=>{var _,A;const S=m;S.lngLat=s.getLngLat(),(A=(_=i.current.props).onDragEnd)===null||A===void 0||A.call(_,S)}),v},[]);E.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:c,style:l,draggable:u=!1,popup:f=null,rotation:h=0,rotationAlignment:d="auto",pitchAlignment:p="auto"}=t;return E.useEffect(()=>{$o(s.getElement(),l)},[l]),E.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),c&&!XK(s.getOffset(),c)&&s.setOffset(c),s.isDraggable()!==u&&s.setDraggable(u),s.getRotation()!==h&&s.setRotation(h),s.getRotationAlignment()!==d&&s.setRotationAlignment(d),s.getPitchAlignment()!==p&&s.setPitchAlignment(p),s.getPopup()!==f&&s.setPopup(f),Tc.createPortal(t.children,s.getElement())}E.memo(E.forwardRef(aY));function nC(t){return new Set(t?t.trim().split(/\s+/):[])}function cY(t,e){const{map:n,mapLib:r}=E.useContext(ug),i=E.useMemo(()=>document.createElement("div"),[]),s=E.useRef({props:t});s.current.props=t;const o=E.useMemo(()=>{const a={...t},c=new r.Popup(a);return c.setLngLat([t.longitude,t.latitude]),c.once("open",l=>{var u,f;(f=(u=s.current.props).onOpen)===null||f===void 0||f.call(u,l)}),c},[]);if(E.useEffect(()=>{const a=c=>{var l,u;(u=(l=s.current.props).onClose)===null||u===void 0||u.call(l,c)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),E.useEffect(()=>{$o(o.getElement(),t.style)},[t.style]),E.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!$i(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=nC(o.options.className),c=nC(t.className);for(const l of a)c.has(l)||o.removeClassName(l);for(const l of c)a.has(l)||o.addClassName(l);o.options.className=t.className}return Tc.createPortal(t.children,i)}E.memo(E.forwardRef(cY));function Pu(t,e,n,r){const i=E.useContext(ug),s=E.useMemo(()=>t(i),[]);return E.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,c=typeof n=="function"?n:typeof e=="function"?e:null,{map:l}=i;return l.hasControl(s)||(l.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{c&&c(i),l.hasControl(s)&&l.removeControl(s)}},[]),s}function lY(t){const e=Pu(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return E.useEffect(()=>{$o(e._container,t.style)},[t.style]),null}E.memo(lY);function uY(t){const e=Pu(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return E.useEffect(()=>{$o(e._controlContainer,t.style)},[t.style]),null}E.memo(uY);function fY(t,e){const n=E.useRef({props:t}),r=Pu(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var c,l;(l=(c=n.current.props).onGeolocate)===null||l===void 0||l.call(c,a)}),s.on("error",a=>{var c,l;(l=(c=n.current.props).onError)===null||l===void 0||l.call(c,a)}),s.on("outofmaxbounds",a=>{var c,l;(l=(c=n.current.props).onOutOfMaxBounds)===null||l===void 0||l.call(c,a)}),s.on("trackuserlocationstart",a=>{var c,l;(l=(c=n.current.props).onTrackUserLocationStart)===null||l===void 0||l.call(c,a)}),s.on("trackuserlocationend",a=>{var c,l;(l=(c=n.current.props).onTrackUserLocationEnd)===null||l===void 0||l.call(c,a)}),s},{position:t.position});return n.current.props=t,E.useImperativeHandle(e,()=>r,[]),E.useEffect(()=>{$o(r._container,t.style)},[t.style]),null}E.memo(E.forwardRef(fY));function hY(t){const e=Pu(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return E.useEffect(()=>{$o(e._container,t.style)},[t.style]),null}E.memo(hY);function dY(t){const e=Pu(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=E.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),E.useEffect(()=>{$o(e._container,i)},[i]),null}E.memo(dY);const gY=WK(()=>import("./maplibre-gl-84f94594.js").then(t=>t.m),[]),pY=(()=>E.forwardRef(function(e,n){return sY(e,n,gY)}))();var KI={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var s=arguments[i];if(s){var o=typeof s;if(o==="string"||o==="number")r.push(s);else if(Array.isArray(s)){if(s.length){var a=n.apply(null,s);a&&r.push(a)}}else if(o==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){r.push(s.toString());continue}for(var c in s)e.call(s,c)&&s[c]&&r.push(c)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(KI);var mY=KI.exports;const Lt=cu(mY);function Oi(){return Oi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Oi.apply(this,arguments)}var YI={exports:{}},ze={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1=Symbol.for("react.element"),l1=Symbol.for("react.portal"),fg=Symbol.for("react.fragment"),hg=Symbol.for("react.strict_mode"),dg=Symbol.for("react.profiler"),gg=Symbol.for("react.provider"),pg=Symbol.for("react.context"),vY=Symbol.for("react.server_context"),mg=Symbol.for("react.forward_ref"),vg=Symbol.for("react.suspense"),yg=Symbol.for("react.suspense_list"),_g=Symbol.for("react.memo"),bg=Symbol.for("react.lazy"),yY=Symbol.for("react.offscreen"),qI;qI=Symbol.for("react.module.reference");function Dr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case c1:switch(t=t.type,t){case fg:case dg:case hg:case vg:case yg:return t;default:switch(t=t&&t.$$typeof,t){case vY:case pg:case mg:case bg:case _g:case gg:return t;default:return e}}case l1:return e}}}ze.ContextConsumer=pg;ze.ContextProvider=gg;ze.Element=c1;ze.ForwardRef=mg;ze.Fragment=fg;ze.Lazy=bg;ze.Memo=_g;ze.Portal=l1;ze.Profiler=dg;ze.StrictMode=hg;ze.Suspense=vg;ze.SuspenseList=yg;ze.isAsyncMode=function(){return!1};ze.isConcurrentMode=function(){return!1};ze.isContextConsumer=function(t){return Dr(t)===pg};ze.isContextProvider=function(t){return Dr(t)===gg};ze.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===c1};ze.isForwardRef=function(t){return Dr(t)===mg};ze.isFragment=function(t){return Dr(t)===fg};ze.isLazy=function(t){return Dr(t)===bg};ze.isMemo=function(t){return Dr(t)===_g};ze.isPortal=function(t){return Dr(t)===l1};ze.isProfiler=function(t){return Dr(t)===dg};ze.isStrictMode=function(t){return Dr(t)===hg};ze.isSuspense=function(t){return Dr(t)===vg};ze.isSuspenseList=function(t){return Dr(t)===yg};ze.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===fg||t===dg||t===hg||t===vg||t===yg||t===yY||typeof t=="object"&&t!==null&&(t.$$typeof===bg||t.$$typeof===_g||t.$$typeof===gg||t.$$typeof===pg||t.$$typeof===mg||t.$$typeof===qI||t.getModuleId!==void 0)};ze.typeOf=Dr;YI.exports=ze;var QI=YI.exports;function _v(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];return Nn.Children.forEach(t,function(r){r==null&&!e.keepEmpty||(Array.isArray(r)?n=n.concat(_v(r)):QI.isFragment(r)&&r.props?n=n.concat(_v(r.props.children,e)):n.push(r))}),n}var bv={},_Y=function(e){};function bY(t,e){}function AY(t,e){}function EY(){bv={}}function ZI(t,e,n){!e&&!bv[n]&&(t(!1,n),bv[n]=!0)}function Ag(t,e){ZI(bY,t,e)}function TY(t,e){ZI(AY,t,e)}Ag.preMessage=_Y;Ag.resetWarned=EY;Ag.noteOnce=TY;function rC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rC(Object(n),!0).forEach(function(r){g(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rC(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function bd(t){return t instanceof HTMLElement||t instanceof SVGElement}function vh(t){return bd(t)?t:t instanceof Nn.Component?UO.findDOMNode(t):null}function u1(t,e,n){var r=E.useRef({});return(!("value"in r.current)||n(r.current.condition,e))&&(r.current.value=t(),r.current.condition=e),r.current.value}function f1(t,e){typeof t=="function"?t(e):Bt(t)==="object"&&t&&"current"in t&&(t.current=e)}function h1(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e.filter(function(i){return i});return r.length<=1?r[0]:function(i){e.forEach(function(s){f1(s,i)})}}function d1(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u1(function(){return h1.apply(void 0,e)},e,function(r,i){return r.length!==i.length||r.every(function(s,o){return s!==i[o]})})}function Eg(t){var e,n,r=QI.isMemo(t)?t.type.type:t.type;return!(typeof r=="function"&&!((e=r.prototype)!==null&&e!==void 0&&e.render)||typeof t=="function"&&!((n=t.prototype)!==null&&n!==void 0&&n.render))}var Av=E.createContext(null);function SY(t){var e=t.children,n=t.onBatchResize,r=E.useRef(0),i=E.useRef([]),s=E.useContext(Av),o=E.useCallback(function(a,c,l){r.current+=1;var u=r.current;i.current.push({size:a,element:c,data:l}),Promise.resolve().then(function(){u===r.current&&(n==null||n(i.current),i.current=[])}),s==null||s(a,c,l)},[n,s]);return E.createElement(Av.Provider,{value:o},e)}var e2=function(){if(typeof Map<"u")return Map;function t(e,n){var r=-1;return e.some(function(i,s){return i[0]===n?(r=s,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(n){var r=t(this.__entries__,n),i=this.__entries__[r];return i&&i[1]},e.prototype.set=function(n,r){var i=t(this.__entries__,n);~i?this.__entries__[i][1]=r:this.__entries__.push([n,r])},e.prototype.delete=function(n){var r=this.__entries__,i=t(r,n);~i&&r.splice(i,1)},e.prototype.has=function(n){return!!~t(this.__entries__,n)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var i=0,s=this.__entries__;i<s.length;i++){var o=s[i];n.call(r,o[1],o[0])}},e}()}(),Ev=typeof window<"u"&&typeof document<"u"&&window.document===document,Ad=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),CY=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Ad):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),wY=2;function xY(t,e){var n=!1,r=!1,i=0;function s(){n&&(n=!1,t()),r&&a()}function o(){CY(s)}function a(){var c=Date.now();if(n){if(c-i<wY)return;r=!0}else n=!0,r=!1,setTimeout(o,e);i=c}return a}var PY=20,MY=["top","right","bottom","left","width","height","size","weight"],RY=typeof MutationObserver<"u",IY=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=xY(this.refresh.bind(this),PY)}return t.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},t.prototype.removeObserver=function(e){var n=this.observers_,r=n.indexOf(e);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},t.prototype.updateObservers_=function(){var e=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return e.forEach(function(n){return n.broadcastActive()}),e.length>0},t.prototype.connect_=function(){!Ev||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),RY?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){!Ev||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(e){var n=e.propertyName,r=n===void 0?"":n,i=MY.some(function(s){return!!~r.indexOf(s)});i&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),t2=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},vc=function(t){var e=t&&t.ownerDocument&&t.ownerDocument.defaultView;return e||Ad},n2=Tg(0,0,0,0);function Ed(t){return parseFloat(t)||0}function iC(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce(function(r,i){var s=t["border-"+i+"-width"];return r+Ed(s)},0)}function LY(t){for(var e=["top","right","bottom","left"],n={},r=0,i=e;r<i.length;r++){var s=i[r],o=t["padding-"+s];n[s]=Ed(o)}return n}function BY(t){var e=t.getBBox();return Tg(0,0,e.width,e.height)}function OY(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return n2;var r=vc(t).getComputedStyle(t),i=LY(r),s=i.left+i.right,o=i.top+i.bottom,a=Ed(r.width),c=Ed(r.height);if(r.boxSizing==="border-box"&&(Math.round(a+s)!==e&&(a-=iC(r,"left","right")+s),Math.round(c+o)!==n&&(c-=iC(r,"top","bottom")+o)),!DY(t)){var l=Math.round(a+s)-e,u=Math.round(c+o)-n;Math.abs(l)!==1&&(a-=l),Math.abs(u)!==1&&(c-=u)}return Tg(i.left,i.top,a,c)}var FY=function(){return typeof SVGGraphicsElement<"u"?function(t){return t instanceof vc(t).SVGGraphicsElement}:function(t){return t instanceof vc(t).SVGElement&&typeof t.getBBox=="function"}}();function DY(t){return t===vc(t).document.documentElement}function NY(t){return Ev?FY(t)?BY(t):OY(t):n2}function kY(t){var e=t.x,n=t.y,r=t.width,i=t.height,s=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,o=Object.create(s.prototype);return t2(o,{x:e,y:n,width:r,height:i,top:n,right:e+r,bottom:i+n,left:e}),o}function Tg(t,e,n,r){return{x:t,y:e,width:n,height:r}}var UY=function(){function t(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Tg(0,0,0,0),this.target=e}return t.prototype.isActive=function(){var e=NY(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},t}(),GY=function(){function t(e,n){var r=kY(n);t2(this,{target:e,contentRect:r})}return t}(),zY=function(){function t(e,n,r){if(this.activeObservations_=[],this.observations_=new e2,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=n,this.callbackCtx_=r}return t.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof vc(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)||(n.set(e,new UY(e)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof vc(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(e)&&(n.delete(e),n.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&e.activeObservations_.push(n)})},t.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new GY(r.target,r.broadcastRect())});this.callback_.call(e,n,e),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),r2=typeof WeakMap<"u"?new WeakMap:new e2,i2=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=IY.getInstance(),r=new zY(e,n,this);r2.set(this,r)}return t}();["observe","unobserve","disconnect"].forEach(function(t){i2.prototype[t]=function(){var e;return(e=r2.get(this))[t].apply(e,arguments)}});var HY=function(){return typeof Ad.ResizeObserver<"u"?Ad.ResizeObserver:i2}(),Is=new Map;function jY(t){t.forEach(function(e){var n,r=e.target;(n=Is.get(r))===null||n===void 0||n.forEach(function(i){return i(r)})})}var s2=new HY(jY);function VY(t,e){Is.has(t)||(Is.set(t,new Set),s2.observe(t)),Is.get(t).add(e)}function WY(t,e){Is.has(t)&&(Is.get(t).delete(e),Is.get(t).size||(s2.unobserve(t),Is.delete(t)))}function Xo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sC(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mP(r.key),r)}}function Jo(t,e,n){return e&&sC(t.prototype,e),n&&sC(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tv(t,e){return Tv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Tv(t,e)}function g1(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tv(t,e)}function Td(t){return Td=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Td(t)}function $Y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Sv(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function XY(t,e){if(e&&(Bt(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sv(t)}function p1(t){var e=$Y();return function(){var r=Td(t),i;if(e){var s=Td(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return XY(this,i)}}var JY=function(t){g1(n,t);var e=p1(n);function n(){return Xo(this,n),e.apply(this,arguments)}return Jo(n,[{key:"render",value:function(){return this.props.children}}]),n}(E.Component);function KY(t,e){var n=t.children,r=t.disabled,i=E.useRef(null),s=E.useRef(null),o=E.useContext(Av),a=typeof n=="function",c=a?n(i):n,l=E.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),u=!a&&E.isValidElement(c)&&Eg(c),f=u?c.ref:null,h=d1(f,i),d=function(){var v;return vh(i.current)||(i.current&&Bt(i.current)==="object"?vh((v=i.current)===null||v===void 0?void 0:v.nativeElement):null)||vh(s.current)};E.useImperativeHandle(e,function(){return d()});var p=E.useRef(t);p.current=t;var y=E.useCallback(function(b){var v=p.current,m=v.onResize,_=v.data,A=b.getBoundingClientRect(),S=A.width,w=A.height,x=b.offsetWidth,M=b.offsetHeight,L=Math.floor(S),R=Math.floor(w);if(l.current.width!==L||l.current.height!==R||l.current.offsetWidth!==x||l.current.offsetHeight!==M){var I={width:L,height:R,offsetWidth:x,offsetHeight:M};l.current=I;var N=x===Math.round(S)?S:x,k=M===Math.round(w)?w:M,z=q(q({},I),{},{offsetWidth:N,offsetHeight:k});o==null||o(z,b,_),m&&Promise.resolve().then(function(){m(z,b)})}},[]);return E.useEffect(function(){var b=d();return b&&!r&&VY(b,y),function(){return WY(b,y)}},[i.current,r]),E.createElement(JY,{ref:s},u?E.cloneElement(c,{ref:h}):c)}var YY=E.forwardRef(KY),qY="rc-observer-key";function QY(t,e){var n=t.children,r=typeof n=="function"?[n]:_v(n);return r.map(function(i,s){var o=(i==null?void 0:i.key)||"".concat(qY,"-").concat(s);return E.createElement(YY,Oi({},t,{key:o,ref:s===0?e:void 0}),i)})}var m1=E.forwardRef(QY);m1.Collection=SY;function Cv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ZY(t){if(Array.isArray(t))return Cv(t)}function o2(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function v1(t,e){if(t){if(typeof t=="string")return Cv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cv(t,e)}}function eq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function It(t){return ZY(t)||o2(t)||v1(t)||eq()}var a2=function(e){return+setTimeout(e,16)},c2=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(a2=function(e){return window.requestAnimationFrame(e)},c2=function(e){return window.cancelAnimationFrame(e)});var oC=0,y1=new Map;function l2(t){y1.delete(t)}var No=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;oC+=1;var r=oC;function i(s){if(s===0)l2(r),e();else{var o=a2(function(){i(s-1)});y1.set(r,o)}}return i(n),r};No.cancel=function(t){var e=y1.get(t);return l2(e),c2(e)};function _1(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}function tq(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function ko(t,e){if(t==null)return{};var n=tq(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function u2(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=new Set;function i(s,o){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=r.has(s);if(Ag(!c,"Warning: There may be circular references"),c)return!1;if(s===o)return!0;if(n&&a>1)return!1;r.add(s);var l=a+1;if(Array.isArray(s)){if(!Array.isArray(o)||s.length!==o.length)return!1;for(var u=0;u<s.length;u++)if(!i(s[u],o[u],l))return!1;return!0}if(s&&o&&Bt(s)==="object"&&Bt(o)==="object"){var f=Object.keys(s);return f.length!==Object.keys(o).length?!1:f.every(function(h){return i(s[h],o[h],l)})}return!1}return i(t,e)}var aC="%",nq=function(){function t(e){Xo(this,t),g(this,"instanceId",void 0),g(this,"cache",new Map),this.instanceId=e}return Jo(t,[{key:"get",value:function(n){return this.cache.get(n.join(aC))||null}},{key:"update",value:function(n,r){var i=n.join(aC),s=this.cache.get(i),o=r(s);o===null?this.cache.delete(i):this.cache.set(i,o)}}]),t}(),wv="data-token-hash",So="data-css-hash",Da="__cssinjs_instance__";function rq(){var t=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var e=document.body.querySelectorAll("style[".concat(So,"]"))||[],n=document.head.firstChild;Array.from(e).forEach(function(i){i[Da]=i[Da]||t,i[Da]===t&&document.head.insertBefore(i,n)});var r={};Array.from(document.querySelectorAll("style[".concat(So,"]"))).forEach(function(i){var s=i.getAttribute(So);if(r[s]){if(i[Da]===t){var o;(o=i.parentNode)===null||o===void 0||o.removeChild(i)}}else r[s]=!0})}return new nq(t)}var iq=E.createContext({hashPriority:"low",cache:rq(),defaultCache:!0});const b1=iq;function Jn(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function sq(t,e){if(!t)return!1;if(t.contains)return t.contains(e);for(var n=e;n;){if(n===t)return!0;n=n.parentNode}return!1}var cC="data-rc-order",lC="data-rc-priority",oq="rc-util-key",xv=new Map;function f2(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mark;return e?e.startsWith("data-")?e:"data-".concat(e):oq}function Sg(t){if(t.attachTo)return t.attachTo;var e=document.querySelector("head");return e||document.body}function aq(t){return t==="queue"?"prependQueue":t?"prepend":"append"}function h2(t){return Array.from((xv.get(t)||t).children).filter(function(e){return e.tagName==="STYLE"})}function d2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Jn())return null;var n=e.csp,r=e.prepend,i=e.priority,s=i===void 0?0:i,o=aq(r),a=o==="prependQueue",c=document.createElement("style");c.setAttribute(cC,o),a&&s&&c.setAttribute(lC,"".concat(s)),n!=null&&n.nonce&&(c.nonce=n==null?void 0:n.nonce),c.innerHTML=t;var l=Sg(e),u=l.firstChild;if(r){if(a){var f=h2(l).filter(function(h){if(!["prepend","prependQueue"].includes(h.getAttribute(cC)))return!1;var d=Number(h.getAttribute(lC)||0);return s>=d});if(f.length)return l.insertBefore(c,f[f.length-1].nextSibling),c}l.insertBefore(c,u)}else l.appendChild(c);return c}function g2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Sg(e);return h2(n).find(function(r){return r.getAttribute(f2(e))===t})}function Sd(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=g2(t,e);if(n){var r=Sg(e);r.removeChild(n)}}function cq(t,e){var n=xv.get(t);if(!n||!sq(document,n)){var r=d2("",e),i=r.parentNode;xv.set(t,i),t.removeChild(r)}}function nu(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=Sg(n);cq(r,n);var i=g2(e,n);if(i){var s,o;if((s=n.csp)!==null&&s!==void 0&&s.nonce&&i.nonce!==((o=n.csp)===null||o===void 0?void 0:o.nonce)){var a;i.nonce=(a=n.csp)===null||a===void 0?void 0:a.nonce}return i.innerHTML!==t&&(i.innerHTML=t),i}var c=d2(t,n);return c.setAttribute(f2(n),e),c}function p2(t){if(Array.isArray(t))return t}function lq(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,o,a=[],c=!0,l=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=s.call(n)).done)&&(a.push(r.value),a.length!==e);c=!0);}catch(u){l=!0,i=u}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return a}}function m2(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Z(t,e){return p2(t)||lq(t,e)||v1(t,e)||m2()}function uq(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var A1=function(){function t(){Xo(this,t),g(this,"cache",void 0),g(this,"keys",void 0),g(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Jo(t,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(n){var r,i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o={map:this.cache};return n.forEach(function(a){if(!o)o=void 0;else{var c,l;o=(c=o)===null||c===void 0||(l=c.map)===null||l===void 0?void 0:l.get(a)}}),(r=o)!==null&&r!==void 0&&r.value&&s&&(o.value[1]=this.cacheCallTimes++),(i=o)===null||i===void 0?void 0:i.value}},{key:"get",value:function(n){var r;return(r=this.internalGet(n,!0))===null||r===void 0?void 0:r[0]}},{key:"has",value:function(n){return!!this.internalGet(n)}},{key:"set",value:function(n,r){var i=this;if(!this.has(n)){if(this.size()+1>t.MAX_CACHE_SIZE+t.MAX_CACHE_OFFSET){var s=this.keys.reduce(function(l,u){var f=Z(l,2),h=f[1];return i.internalGet(u)[1]<h?[u,i.internalGet(u)[1]]:l},[this.keys[0],this.cacheCallTimes]),o=Z(s,1),a=o[0];this.delete(a)}this.keys.push(n)}var c=this.cache;n.forEach(function(l,u){if(u===n.length-1)c.set(l,{value:[r,i.cacheCallTimes++]});else{var f=c.get(l);f?f.map||(f.map=new Map):c.set(l,{map:new Map}),c=c.get(l).map}})}},{key:"deleteByPath",value:function(n,r){var i=n.get(r[0]);if(r.length===1){var s;return i.map?n.set(r[0],{map:i.map}):n.delete(r[0]),(s=i.value)===null||s===void 0?void 0:s[0]}var o=this.deleteByPath(i.map,r.slice(1));return(!i.map||i.map.size===0)&&!i.value&&n.delete(r[0]),o}},{key:"delete",value:function(n){if(this.has(n))return this.keys=this.keys.filter(function(r){return!uq(r,n)}),this.deleteByPath(this.cache,n)}}]),t}();g(A1,"MAX_CACHE_SIZE",20);g(A1,"MAX_CACHE_OFFSET",5);var uC=0,v2=function(){function t(e){Xo(this,t),g(this,"derivatives",void 0),g(this,"id",void 0),this.derivatives=Array.isArray(e)?e:[e],this.id=uC,e.length===0&&(e.length>0,void 0),uC+=1}return Jo(t,[{key:"getDerivativeToken",value:function(n){return this.derivatives.reduce(function(r,i){return i(n,r)},void 0)}}]),t}(),hm=new A1;function Pv(t){var e=Array.isArray(t)?t:[t];return hm.has(e)||hm.set(e,new v2(e)),hm.get(e)}var fq=new WeakMap,dm={};function hq(t,e){for(var n=fq,r=0;r<e.length;r+=1){var i=e[r];n.has(i)||n.set(i,new WeakMap),n=n.get(i)}return n.has(dm)||n.set(dm,t()),n.get(dm)}var fC=new WeakMap;function Cd(t){var e=fC.get(t)||"";return e||(Object.keys(t).forEach(function(n){var r=t[n];e+=n,r instanceof v2?e+=r.id:r&&Bt(r)==="object"?e+=Cd(r):e+=r}),fC.set(t,e)),e}function dq(t,e){return _1("".concat(e,"_").concat(Cd(t)))}var Tl="random-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,""),y2="_bAmBoO_";function gq(t,e,n){if(Jn()){var r,i;nu(t,Tl);var s=document.createElement("div");s.style.position="fixed",s.style.left="0",s.style.top="0",e==null||e(s),document.body.appendChild(s);var o=n?n(s):(r=getComputedStyle(s).content)===null||r===void 0?void 0:r.includes(y2);return(i=s.parentNode)===null||i===void 0||i.removeChild(s),Sd(Tl),o}return!1}var gm=void 0;function pq(){return gm===void 0&&(gm=gq("@layer ".concat(Tl," { .").concat(Tl,' { content: "').concat(y2,'"!important; } }'),function(t){t.className=Tl})),gm}var hC=Jn()?E.useLayoutEffect:E.useEffect,xn=function(e,n){var r=E.useRef(!0);hC(function(){return e(r.current)},n),hC(function(){return r.current=!1,function(){r.current=!0}},[])},dC=function(e,n){xn(function(r){if(!r)return e()},n)},mq=q({},Md),gC=mq.useInsertionEffect,vq=function(e,n,r){E.useMemo(e,r),xn(function(){return n(!0)},r)},yq=gC?function(t,e,n){return gC(function(){return t(),e()},n)}:vq;const _q=yq;var bq=q({},Md),Aq=bq.useInsertionEffect,Eq=function(e){var n=[],r=!1;function i(s){r||n.push(s)}return E.useEffect(function(){return r=!1,function(){r=!0,n.length&&n.forEach(function(s){return s()})}},e),i},Tq=function(){return function(e){e()}},Sq=typeof Aq<"u"?Eq:Tq;const Cq=Sq;function _2(t,e,n,r,i){var s=E.useContext(b1),o=s.cache,a=[t].concat(It(e)),c=a.join("_"),l=Cq([c]),u=function(p){o.update(a,function(y){var b=y||[],v=Z(b,2),m=v[0],_=m===void 0?0:m,A=v[1],S=A,w=S||n(),x=[_,w];return p?p(x):x})};E.useMemo(function(){u()},[c]);var f=o.get(a),h=f[1];return _q(function(){i==null||i(h)},function(d){return u(function(p){var y=Z(p,2),b=y[0],v=y[1];return d&&b===0&&(i==null||i(h)),[b+1,v]}),function(){o.update(a,function(p){var y=p||[],b=Z(y,2),v=b[0],m=v===void 0?0:v,_=b[1],A=m-1;return A===0?(l(function(){return r==null?void 0:r(_,!1)}),null):[m-1,_]})}},[c]),h}var wq={},xq="css",uo=new Map;function Pq(t){uo.set(t,(uo.get(t)||0)+1)}function Mq(t,e){if(typeof document<"u"){var n=document.querySelectorAll("style[".concat(wv,'="').concat(t,'"]'));n.forEach(function(r){if(r[Da]===e){var i;(i=r.parentNode)===null||i===void 0||i.removeChild(r)}})}}var Rq=0;function Iq(t,e){uo.set(t,(uo.get(t)||0)-1);var n=Array.from(uo.keys()),r=n.filter(function(i){var s=uo.get(i)||0;return s<=0});n.length-r.length>Rq&&r.forEach(function(i){Mq(i,e),uo.delete(i)})}var Lq=function(e,n,r,i){var s=r.getDerivativeToken(e),o=q(q({},s),n);return i&&(o=i(o)),o};function Bq(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=E.useContext(b1),i=r.cache.instanceId,s=n.salt,o=s===void 0?"":s,a=n.override,c=a===void 0?wq:a,l=n.formatToken,u=n.getComputedToken,f=hq(function(){return Object.assign.apply(Object,[{}].concat(It(e)))},e),h=Cd(f),d=Cd(c),p=_2("token",[o,t.id,h,d],function(){var y=u?u(f,c,t):Lq(f,c,t,l),b=dq(y,o);y._tokenKey=b,Pq(b);var v="".concat(xq,"-").concat(_1(b));return y._hashId=v,[y,v]},function(y){Iq(y[0]._tokenKey,i)});return p}var Oq={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},b2="comm",A2="rule",E2="decl",Fq="@import",Dq="@keyframes",Nq="@layer",kq=Math.abs,E1=String.fromCharCode;function T2(t){return t.trim()}function yh(t,e,n){return t.replace(e,n)}function Uq(t,e){return t.indexOf(e)}function ru(t,e){return t.charCodeAt(e)|0}function iu(t,e,n){return t.slice(e,n)}function ji(t){return t.length}function Gq(t){return t.length}function Bf(t,e){return e.push(t),t}var Cg=1,yc=1,S2=0,Or=0,Mt=0,wc="";function T1(t,e,n,r,i,s,o,a){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:Cg,column:yc,length:o,return:"",siblings:a}}function zq(){return Mt}function Hq(){return Mt=Or>0?ru(wc,--Or):0,yc--,Mt===10&&(yc=1,Cg--),Mt}function li(){return Mt=Or<S2?ru(wc,Or++):0,yc++,Mt===10&&(yc=1,Cg++),Mt}function Co(){return ru(wc,Or)}function _h(){return Or}function wg(t,e){return iu(wc,t,e)}function Mv(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function jq(t){return Cg=yc=1,S2=ji(wc=t),Or=0,[]}function Vq(t){return wc="",t}function pm(t){return T2(wg(Or-1,Rv(t===91?t+2:t===40?t+1:t)))}function Wq(t){for(;(Mt=Co())&&Mt<33;)li();return Mv(t)>2||Mv(Mt)>3?"":" "}function $q(t,e){for(;--e&&li()&&!(Mt<48||Mt>102||Mt>57&&Mt<65||Mt>70&&Mt<97););return wg(t,_h()+(e<6&&Co()==32&&li()==32))}function Rv(t){for(;li();)switch(Mt){case t:return Or;case 34:case 39:t!==34&&t!==39&&Rv(Mt);break;case 40:t===41&&Rv(t);break;case 92:li();break}return Or}function Xq(t,e){for(;li()&&t+Mt!==47+10;)if(t+Mt===42+42&&Co()===47)break;return"/*"+wg(e,Or-1)+"*"+E1(t===47?t:li())}function Jq(t){for(;!Mv(Co());)li();return wg(t,Or)}function Kq(t){return Vq(bh("",null,null,null,[""],t=jq(t),0,[0],t))}function bh(t,e,n,r,i,s,o,a,c){for(var l=0,u=0,f=o,h=0,d=0,p=0,y=1,b=1,v=1,m=0,_="",A=i,S=s,w=r,x=_;b;)switch(p=m,m=li()){case 40:if(p!=108&&ru(x,f-1)==58){Uq(x+=yh(pm(m),"&","&\f"),"&\f")!=-1&&(v=-1);break}case 34:case 39:case 91:x+=pm(m);break;case 9:case 10:case 13:case 32:x+=Wq(p);break;case 92:x+=$q(_h()-1,7);continue;case 47:switch(Co()){case 42:case 47:Bf(Yq(Xq(li(),_h()),e,n,c),c);break;default:x+="/"}break;case 123*y:a[l++]=ji(x)*v;case 125*y:case 59:case 0:switch(m){case 0:case 125:b=0;case 59+u:v==-1&&(x=yh(x,/\f/g,"")),d>0&&ji(x)-f&&Bf(d>32?mC(x+";",r,n,f-1,c):mC(yh(x," ","")+";",r,n,f-2,c),c);break;case 59:x+=";";default:if(Bf(w=pC(x,e,n,l,u,i,a,_,A=[],S=[],f,s),s),m===123)if(u===0)bh(x,e,w,w,A,s,f,a,S);else switch(h===99&&ru(x,3)===110?100:h){case 100:case 108:case 109:case 115:bh(t,w,w,r&&Bf(pC(t,w,w,0,0,i,a,_,i,A=[],f,S),S),i,S,f,a,r?A:S);break;default:bh(x,w,w,w,[""],S,0,a,S)}}l=u=d=0,y=v=1,_=x="",f=o;break;case 58:f=1+ji(x),d=p;default:if(y<1){if(m==123)--y;else if(m==125&&y++==0&&Hq()==125)continue}switch(x+=E1(m),m*y){case 38:v=u>0?1:(x+="\f",-1);break;case 44:a[l++]=(ji(x)-1)*v,v=1;break;case 64:Co()===45&&(x+=pm(li())),h=Co(),u=f=ji(_=x+=Jq(_h())),m++;break;case 45:p===45&&ji(x)==2&&(y=0)}}return s}function pC(t,e,n,r,i,s,o,a,c,l,u,f){for(var h=i-1,d=i===0?s:[""],p=Gq(d),y=0,b=0,v=0;y<r;++y)for(var m=0,_=iu(t,h+1,h=kq(b=o[y])),A=t;m<p;++m)(A=T2(b>0?d[m]+" "+_:yh(_,/&\f/g,d[m])))&&(c[v++]=A);return T1(t,e,n,i===0?A2:a,c,l,u,f)}function Yq(t,e,n,r){return T1(t,e,n,b2,E1(zq()),iu(t,2,-2),0,r)}function mC(t,e,n,r,i){return T1(t,e,n,E2,iu(t,0,r),iu(t,r+1,-1),r,i)}function Iv(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function qq(t,e,n,r){switch(t.type){case Nq:if(t.children.length)break;case Fq:case E2:return t.return=t.return||t.value;case b2:return"";case Dq:return t.return=t.value+"{"+Iv(t.children,r)+"}";case A2:if(!ji(t.value=t.props.join(",")))return""}return ji(n=Iv(t.children,r))?t.return=t.value+"{"+n+"}":""}var vC="data-ant-cssinjs-cache-path",C2="_FILE_STYLE__",wo,w2=!0;function Qq(){if(!wo&&(wo={},Jn())){var t=document.createElement("div");t.className=vC,t.style.position="fixed",t.style.visibility="hidden",t.style.top="-9999px",document.body.appendChild(t);var e=getComputedStyle(t).content||"";e=e.replace(/^"/,"").replace(/"$/,""),e.split(";").forEach(function(i){var s=i.split(":"),o=Z(s,2),a=o[0],c=o[1];wo[a]=c});var n=document.querySelector("style[".concat(vC,"]"));if(n){var r;w2=!1,(r=n.parentNode)===null||r===void 0||r.removeChild(n)}document.body.removeChild(t)}}function Zq(t){return Qq(),!!wo[t]}function eQ(t){var e=wo[t],n=null;if(e&&Jn())if(w2)n=C2;else{var r=document.querySelector("style[".concat(So,'="').concat(wo[t],'"]'));r?n=r.innerHTML:delete wo[t]}return[n,e]}var yC=Jn(),tQ="_skip_check_",x2="_multi_value_";function _C(t){var e=Iv(Kq(t),qq);return e.replace(/\{%%%\:[^;];}/g,";")}function nQ(t){return Bt(t)==="object"&&t&&(tQ in t||x2 in t)}function rQ(t,e,n){if(!e)return t;var r=".".concat(e),i=n==="low"?":where(".concat(r,")"):r,s=t.split(",").map(function(o){var a,c=o.trim().split(/\s+/),l=c[0]||"",u=((a=l.match(/^\w+/))===null||a===void 0?void 0:a[0])||"";return l="".concat(u).concat(i).concat(l.slice(u.length)),[l].concat(It(c.slice(1))).join(" ")});return s.join(",")}var iQ=function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},i=r.root,s=r.injectHash,o=r.parentSelectors,a=n.hashId,c=n.layer;n.path;var l=n.hashPriority,u=n.transformers,f=u===void 0?[]:u;n.linters;var h="",d={};function p(_){var A=_.getName(a);if(!d[A]){var S=t(_.style,n,{root:!1,parentSelectors:o}),w=Z(S,1),x=w[0];d[A]="@keyframes ".concat(_.getName(a)).concat(x)}}function y(_){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return _.forEach(function(S){Array.isArray(S)?y(S,A):S&&A.push(S)}),A}var b=y(Array.isArray(e)?e:[e]);if(b.forEach(function(_){var A=typeof _=="string"&&!i?{}:_;if(typeof A=="string")h+="".concat(A,`
`);else if(A._keyframe)p(A);else{var S=f.reduce(function(w,x){var M;return(x==null||(M=x.visit)===null||M===void 0?void 0:M.call(x,w))||w},A);Object.keys(S).forEach(function(w){var x=S[w];if(Bt(x)==="object"&&x&&(w!=="animationName"||!x._keyframe)&&!nQ(x)){var M=!1,L=w.trim(),R=!1;(i||s)&&a?L.startsWith("@")?M=!0:L=rQ(w,a,l):i&&!a&&(L==="&"||L==="")&&(L="",R=!0);var I=t(x,n,{root:R,injectHash:M,parentSelectors:[].concat(It(o),[L])}),N=Z(I,2),k=N[0],z=N[1];d=q(q({},d),z),h+="".concat(L).concat(k)}else{let U=function(F,D){var W=F.replace(/[A-Z]/g,function(te){return"-".concat(te.toLowerCase())}),ee=D;!Oq[F]&&typeof ee=="number"&&ee!==0&&(ee="".concat(ee,"px")),F==="animationName"&&D!==null&&D!==void 0&&D._keyframe&&(p(D),ee=D.getName(a)),h+="".concat(W,":").concat(ee,";")};var $,V=($=x==null?void 0:x.value)!==null&&$!==void 0?$:x;Bt(x)==="object"&&x!==null&&x!==void 0&&x[x2]&&Array.isArray(V)?V.forEach(function(F){U(w,F)}):U(w,V)}})}}),!i)h="{".concat(h,"}");else if(c&&pq()){var v=c.split(","),m=v[v.length-1].trim();h="@layer ".concat(m," {").concat(h,"}"),v.length>1&&(h="@layer ".concat(c,"{%%%:%}").concat(h))}return[h,d]};function sQ(t,e){return _1("".concat(t.join("%")).concat(e))}function oQ(){return null}function Lv(t,e){var n=t.token,r=t.path,i=t.hashId,s=t.layer,o=t.nonce,a=t.clientOnly,c=t.order,l=c===void 0?0:c,u=E.useContext(b1),f=u.autoClear;u.mock;var h=u.defaultCache,d=u.hashPriority,p=u.container,y=u.ssrInline,b=u.transformers,v=u.linters,m=u.cache,_=n._tokenKey,A=[_].concat(It(r)),S=yC,w=_2("style",A,function(){var I=A.join("|");if(Zq(I)){var N=eQ(I),k=Z(N,2),z=k[0],$=k[1];if(z)return[z,_,$,{},a,l]}var V=e(),U=iQ(V,{hashId:i,hashPriority:d,layer:s,path:r.join("-"),transformers:b,linters:v}),F=Z(U,2),D=F[0],W=F[1],ee=_C(D),te=sQ(A,ee);return[ee,_,te,W,a,l]},function(I,N){var k=Z(I,3),z=k[2];(N||f)&&yC&&Sd(z,{mark:So})},function(I){var N=Z(I,4),k=N[0];N[1];var z=N[2],$=N[3];if(S&&k!==C2){var V={mark:So,prepend:"queue",attachTo:p,priority:l},U=typeof o=="function"?o():o;U&&(V.csp={nonce:U});var F=nu(k,z,V);F[Da]=m.instanceId,F.setAttribute(wv,_),Object.keys($).forEach(function(D){nu(_C($[D]),"_effect-".concat(D),V)})}}),x=Z(w,3),M=x[0],L=x[1],R=x[2];return function(I){var N;if(!y||S||!h)N=E.createElement(oQ,null);else{var k;N=E.createElement("style",Oi({},(k={},g(k,wv,L),g(k,So,R),k),{dangerouslySetInnerHTML:{__html:M}}))}return E.createElement(E.Fragment,null,N,I)}}var Nr=function(){function t(e,n){Xo(this,t),g(this,"name",void 0),g(this,"style",void 0),g(this,"_keyframe",!0),this.name=e,this.style=n}return Jo(t,[{key:"getName",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return n?"".concat(n,"-").concat(this.name):this.name}}]),t}();function fa(t){return t.notSplit=!0,t}fa(["borderTop","borderBottom"]),fa(["borderTop"]),fa(["borderBottom"]),fa(["borderLeft","borderRight"]),fa(["borderLeft"]),fa(["borderRight"]);var aQ=E.createContext({});const cQ=aQ;function lQ(t){return p2(t)||o2(t)||v1(t)||m2()}function Bv(t,e){for(var n=t,r=0;r<e.length;r+=1){if(n==null)return;n=n[e[r]]}return n}function P2(t,e,n,r){if(!e.length)return n;var i=lQ(e),s=i[0],o=i.slice(1),a;return!t&&typeof s=="number"?a=[]:Array.isArray(t)?a=It(t):a=q({},t),r&&n===void 0&&o.length===1?delete a[s][o[0]]:a[s]=P2(a[s],o,n,r),a}function mm(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.length&&r&&n===void 0&&!Bv(t,e.slice(0,-1))?t:P2(t,e,n,r)}function uQ(t){return Bt(t)==="object"&&t!==null&&Object.getPrototypeOf(t)===Object.prototype}function bC(t){return Array.isArray(t)?[]:{}}var fQ=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function hQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=bC(e[0]);return e.forEach(function(i){function s(o,a){var c=new Set(a),l=Bv(i,o),u=Array.isArray(l);if(u||uQ(l)){if(!c.has(l)){c.add(l);var f=Bv(r,o);u?r=mm(r,o,[]):(!f||Bt(f)!=="object")&&(r=mm(r,o,bC(l))),fQ(l).forEach(function(h){s([].concat(It(o),[h]),c)})}}else r=mm(r,o,l)}s([])}),r}function dQ(){}const gQ=E.createContext({}),pQ=()=>{const t=()=>{};return t.deprecated=dQ,t},mQ=E.createContext(void 0),vQ={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"};var yQ={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};const _Q={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},M2=_Q,bQ={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},yQ),timePickerLocale:Object.assign({},M2)},AC=bQ,tr="${label} is not a valid ${type}",AQ={locale:"en",Pagination:vQ,DatePicker:AC,TimePicker:M2,Calendar:AC,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:tr,method:tr,array:tr,object:tr,number:tr,date:tr,boolean:tr,integer:tr,float:tr,regexp:tr,email:tr,url:tr,hex:tr},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh"},ColorPicker:{presetEmpty:"Empty"}},xg=AQ;Object.assign({},xg.Modal);let Ah=[];const EC=()=>Ah.reduce((t,e)=>Object.assign(Object.assign({},t),e),xg.Modal);function EQ(t){if(t){const e=Object.assign({},t);return Ah.push(e),EC(),()=>{Ah=Ah.filter(n=>n!==e),EC()}}Object.assign({},xg.Modal)}const TQ=E.createContext(void 0),R2=TQ,SQ="internalMark",CQ=t=>{const{locale:e={},children:n,_ANT_MARK__:r}=t;E.useEffect(()=>EQ(e&&e.Modal),[e]);const i=E.useMemo(()=>Object.assign(Object.assign({},e),{exist:!0}),[e]);return E.createElement(R2.Provider,{value:i},n)},wQ=CQ;function rn(t,e){xQ(t)&&(t="100%");var n=PQ(t);return t=e===360?t:Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:(e===360?t=(t<0?t%e+e:t%e)/parseFloat(String(e)):t=t%e/parseFloat(String(e)),t)}function Of(t){return Math.min(1,Math.max(0,t))}function xQ(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function PQ(t){return typeof t=="string"&&t.indexOf("%")!==-1}function I2(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Ff(t){return t<=1?"".concat(Number(t)*100,"%"):t}function yo(t){return t.length===1?"0"+t:String(t)}function MQ(t,e,n){return{r:rn(t,255)*255,g:rn(e,255)*255,b:rn(n,255)*255}}function TC(t,e,n){t=rn(t,255),e=rn(e,255),n=rn(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),s=0,o=0,a=(r+i)/2;if(r===i)o=0,s=0;else{var c=r-i;switch(o=a>.5?c/(2-r-i):c/(r+i),r){case t:s=(e-n)/c+(e<n?6:0);break;case e:s=(n-t)/c+2;break;case n:s=(t-e)/c+4;break}s/=6}return{h:s,s:o,l:a}}function vm(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*(6*n):n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function RQ(t,e,n){var r,i,s;if(t=rn(t,360),e=rn(e,100),n=rn(n,100),e===0)i=n,s=n,r=n;else{var o=n<.5?n*(1+e):n+e-n*e,a=2*n-o;r=vm(a,o,t+1/3),i=vm(a,o,t),s=vm(a,o,t-1/3)}return{r:r*255,g:i*255,b:s*255}}function Ov(t,e,n){t=rn(t,255),e=rn(e,255),n=rn(n,255);var r=Math.max(t,e,n),i=Math.min(t,e,n),s=0,o=r,a=r-i,c=r===0?0:a/r;if(r===i)s=0;else{switch(r){case t:s=(e-n)/a+(e<n?6:0);break;case e:s=(n-t)/a+2;break;case n:s=(t-e)/a+4;break}s/=6}return{h:s,s:c,v:o}}function IQ(t,e,n){t=rn(t,360)*6,e=rn(e,100),n=rn(n,100);var r=Math.floor(t),i=t-r,s=n*(1-e),o=n*(1-i*e),a=n*(1-(1-i)*e),c=r%6,l=[n,o,s,s,a,n][c],u=[a,n,n,o,s,s][c],f=[s,s,a,n,n,o][c];return{r:l*255,g:u*255,b:f*255}}function Fv(t,e,n,r){var i=[yo(Math.round(t).toString(16)),yo(Math.round(e).toString(16)),yo(Math.round(n).toString(16))];return r&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function LQ(t,e,n,r,i){var s=[yo(Math.round(t).toString(16)),yo(Math.round(e).toString(16)),yo(Math.round(n).toString(16)),yo(BQ(r))];return i&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function BQ(t){return Math.round(parseFloat(t)*255).toString(16)}function SC(t){return nr(t)/255}function nr(t){return parseInt(t,16)}function OQ(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var Dv={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function va(t){var e={r:0,g:0,b:0},n=1,r=null,i=null,s=null,o=!1,a=!1;return typeof t=="string"&&(t=NQ(t)),typeof t=="object"&&(Ui(t.r)&&Ui(t.g)&&Ui(t.b)?(e=MQ(t.r,t.g,t.b),o=!0,a=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Ui(t.h)&&Ui(t.s)&&Ui(t.v)?(r=Ff(t.s),i=Ff(t.v),e=IQ(t.h,r,i),o=!0,a="hsv"):Ui(t.h)&&Ui(t.s)&&Ui(t.l)&&(r=Ff(t.s),s=Ff(t.l),e=RQ(t.h,r,s),o=!0,a="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(n=t.a)),n=I2(n),{ok:o,format:t.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}var FQ="[-\\+]?\\d+%?",DQ="[-\\+]?\\d*\\.\\d+%?",Ls="(?:".concat(DQ,")|(?:").concat(FQ,")"),ym="[\\s|\\(]+(".concat(Ls,")[,|\\s]+(").concat(Ls,")[,|\\s]+(").concat(Ls,")\\s*\\)?"),_m="[\\s|\\(]+(".concat(Ls,")[,|\\s]+(").concat(Ls,")[,|\\s]+(").concat(Ls,")[,|\\s]+(").concat(Ls,")\\s*\\)?"),Xr={CSS_UNIT:new RegExp(Ls),rgb:new RegExp("rgb"+ym),rgba:new RegExp("rgba"+_m),hsl:new RegExp("hsl"+ym),hsla:new RegExp("hsla"+_m),hsv:new RegExp("hsv"+ym),hsva:new RegExp("hsva"+_m),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function NQ(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var e=!1;if(Dv[t])t=Dv[t],e=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var n=Xr.rgb.exec(t);return n?{r:n[1],g:n[2],b:n[3]}:(n=Xr.rgba.exec(t),n?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=Xr.hsl.exec(t),n?{h:n[1],s:n[2],l:n[3]}:(n=Xr.hsla.exec(t),n?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=Xr.hsv.exec(t),n?{h:n[1],s:n[2],v:n[3]}:(n=Xr.hsva.exec(t),n?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=Xr.hex8.exec(t),n?{r:nr(n[1]),g:nr(n[2]),b:nr(n[3]),a:SC(n[4]),format:e?"name":"hex8"}:(n=Xr.hex6.exec(t),n?{r:nr(n[1]),g:nr(n[2]),b:nr(n[3]),format:e?"name":"hex"}:(n=Xr.hex4.exec(t),n?{r:nr(n[1]+n[1]),g:nr(n[2]+n[2]),b:nr(n[3]+n[3]),a:SC(n[4]+n[4]),format:e?"name":"hex8"}:(n=Xr.hex3.exec(t),n?{r:nr(n[1]+n[1]),g:nr(n[2]+n[2]),b:nr(n[3]+n[3]),format:e?"name":"hex"}:!1)))))))))}function Ui(t){return!!Xr.CSS_UNIT.exec(String(t))}var jn=function(){function t(e,n){e===void 0&&(e=""),n===void 0&&(n={});var r;if(e instanceof t)return e;typeof e=="number"&&(e=OQ(e)),this.originalInput=e;var i=va(e);this.originalInput=e,this.r=i.r,this.g=i.g,this.b=i.b,this.a=i.a,this.roundA=Math.round(100*this.a)/100,this.format=(r=n.format)!==null&&r!==void 0?r:i.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=i.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},t.prototype.getLuminance=function(){var e=this.toRgb(),n,r,i,s=e.r/255,o=e.g/255,a=e.b/255;return s<=.03928?n=s/12.92:n=Math.pow((s+.055)/1.055,2.4),o<=.03928?r=o/12.92:r=Math.pow((o+.055)/1.055,2.4),a<=.03928?i=a/12.92:i=Math.pow((a+.055)/1.055,2.4),.2126*n+.7152*r+.0722*i},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(e){return this.a=I2(e),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},t.prototype.toHsv=function(){var e=Ov(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},t.prototype.toHsvString=function(){var e=Ov(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this.a===1?"hsv(".concat(n,", ").concat(r,"%, ").concat(i,"%)"):"hsva(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var e=TC(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},t.prototype.toHslString=function(){var e=TC(this.r,this.g,this.b),n=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this.a===1?"hsl(".concat(n,", ").concat(r,"%, ").concat(i,"%)"):"hsla(".concat(n,", ").concat(r,"%, ").concat(i,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(e){return e===void 0&&(e=!1),Fv(this.r,this.g,this.b,e)},t.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},t.prototype.toHex8=function(e){return e===void 0&&(e=!1),LQ(this.r,this.g,this.b,this.a,e)},t.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},t.prototype.toHexShortString=function(e){return e===void 0&&(e=!1),this.a===1?this.toHexString(e):this.toHex8String(e)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var e=Math.round(this.r),n=Math.round(this.g),r=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(n,", ").concat(r,")"):"rgba(".concat(e,", ").concat(n,", ").concat(r,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var e=function(n){return"".concat(Math.round(rn(n,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var e=function(n){return Math.round(rn(n,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+Fv(this.r,this.g,this.b,!1),n=0,r=Object.entries(Dv);n<r.length;n++){var i=r[n],s=i[0],o=i[1];if(e===o)return s}return!1},t.prototype.toString=function(e){var n=!!e;e=e??this.format;var r=!1,i=this.a<1&&this.a>=0,s=!n&&i&&(e.startsWith("hex")||e==="name");return s?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l+=e/100,n.l=Of(n.l),new t(n)},t.prototype.brighten=function(e){e===void 0&&(e=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(255*-(e/100)))),n.g=Math.max(0,Math.min(255,n.g-Math.round(255*-(e/100)))),n.b=Math.max(0,Math.min(255,n.b-Math.round(255*-(e/100)))),new t(n)},t.prototype.darken=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.l-=e/100,n.l=Of(n.l),new t(n)},t.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},t.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},t.prototype.desaturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s-=e/100,n.s=Of(n.s),new t(n)},t.prototype.saturate=function(e){e===void 0&&(e=10);var n=this.toHsl();return n.s+=e/100,n.s=Of(n.s),new t(n)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var n=this.toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,new t(n)},t.prototype.mix=function(e,n){n===void 0&&(n=50);var r=this.toRgb(),i=new t(e).toRgb(),s=n/100,o={r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a};return new t(o)},t.prototype.analogous=function(e,n){e===void 0&&(e=6),n===void 0&&(n=30);var r=this.toHsl(),i=360/n,s=[this];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,s.push(new t(r));return s},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var n=this.toHsv(),r=n.h,i=n.s,s=n.v,o=[],a=1/e;e--;)o.push(new t({h:r,s:i,v:s})),s=(s+a)%1;return o},t.prototype.splitcomplement=function(){var e=this.toHsl(),n=e.h;return[this,new t({h:(n+72)%360,s:e.s,l:e.l}),new t({h:(n+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var n=this.toRgb(),r=new t(e).toRgb(),i=n.a+r.a*(1-n.a);return new t({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var n=this.toHsl(),r=n.h,i=[this],s=360/e,o=1;o<e;o++)i.push(new t({h:(r+o*s)%360,s:n.s,l:n.l}));return i},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}(),Df=2,CC=.16,kQ=.05,UQ=.05,GQ=.15,L2=5,B2=4,zQ=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function wC(t){var e=t.r,n=t.g,r=t.b,i=Ov(e,n,r);return{h:i.h*360,s:i.s,v:i.v}}function Nf(t){var e=t.r,n=t.g,r=t.b;return"#".concat(Fv(e,n,r,!1))}function HQ(t,e,n){var r=n/100,i={r:(e.r-t.r)*r+t.r,g:(e.g-t.g)*r+t.g,b:(e.b-t.b)*r+t.b};return i}function xC(t,e,n){var r;return Math.round(t.h)>=60&&Math.round(t.h)<=240?r=n?Math.round(t.h)-Df*e:Math.round(t.h)+Df*e:r=n?Math.round(t.h)+Df*e:Math.round(t.h)-Df*e,r<0?r+=360:r>=360&&(r-=360),r}function PC(t,e,n){if(t.h===0&&t.s===0)return t.s;var r;return n?r=t.s-CC*e:e===B2?r=t.s+CC:r=t.s+kQ*e,r>1&&(r=1),n&&e===L2&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2))}function MC(t,e,n){var r;return n?r=t.v+UQ*e:r=t.v-GQ*e,r>1&&(r=1),Number(r.toFixed(2))}function _c(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],r=va(t),i=L2;i>0;i-=1){var s=wC(r),o=Nf(va({h:xC(s,i,!0),s:PC(s,i,!0),v:MC(s,i,!0)}));n.push(o)}n.push(Nf(r));for(var a=1;a<=B2;a+=1){var c=wC(r),l=Nf(va({h:xC(c,a),s:PC(c,a),v:MC(c,a)}));n.push(l)}return e.theme==="dark"?zQ.map(function(u){var f=u.index,h=u.opacity,d=Nf(HQ(va(e.backgroundColor||"#141414"),va(n[f]),h*100));return d}):n}var bm={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Am={},Em={};Object.keys(bm).forEach(function(t){Am[t]=_c(bm[t]),Am[t].primary=Am[t][5],Em[t]=_c(bm[t],{theme:"dark",backgroundColor:"#141414"}),Em[t].primary=Em[t][5]});const jQ=t=>{const{controlHeight:e}=t;return{controlHeightSM:e*.75,controlHeightXS:e*.5,controlHeightLG:e*1.25}},VQ=jQ;function WQ(t){const{sizeUnit:e,sizeStep:n}=t;return{sizeXXL:e*(n+8),sizeXL:e*(n+4),sizeLG:e*(n+2),sizeMD:e*(n+1),sizeMS:e*n,size:e*n,sizeSM:e*(n-1),sizeXS:e*(n-2),sizeXXS:e*(n-3)}}const O2={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},$Q=Object.assign(Object.assign({},O2),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),su=$Q;function XQ(t,e){let{generateColorPalettes:n,generateNeutralColorPalettes:r}=e;const{colorSuccess:i,colorWarning:s,colorError:o,colorInfo:a,colorPrimary:c,colorBgBase:l,colorTextBase:u}=t,f=n(c),h=n(i),d=n(s),p=n(o),y=n(a),b=r(l,u),v=t.colorLink||t.colorInfo,m=n(v);return Object.assign(Object.assign({},b),{colorPrimaryBg:f[1],colorPrimaryBgHover:f[2],colorPrimaryBorder:f[3],colorPrimaryBorderHover:f[4],colorPrimaryHover:f[5],colorPrimary:f[6],colorPrimaryActive:f[7],colorPrimaryTextHover:f[8],colorPrimaryText:f[9],colorPrimaryTextActive:f[10],colorSuccessBg:h[1],colorSuccessBgHover:h[2],colorSuccessBorder:h[3],colorSuccessBorderHover:h[4],colorSuccessHover:h[4],colorSuccess:h[6],colorSuccessActive:h[7],colorSuccessTextHover:h[8],colorSuccessText:h[9],colorSuccessTextActive:h[10],colorErrorBg:p[1],colorErrorBgHover:p[2],colorErrorBorder:p[3],colorErrorBorderHover:p[4],colorErrorHover:p[5],colorError:p[6],colorErrorActive:p[7],colorErrorTextHover:p[8],colorErrorText:p[9],colorErrorTextActive:p[10],colorWarningBg:d[1],colorWarningBgHover:d[2],colorWarningBorder:d[3],colorWarningBorderHover:d[4],colorWarningHover:d[4],colorWarning:d[6],colorWarningActive:d[7],colorWarningTextHover:d[8],colorWarningText:d[9],colorWarningTextActive:d[10],colorInfoBg:y[1],colorInfoBgHover:y[2],colorInfoBorder:y[3],colorInfoBorderHover:y[4],colorInfoHover:y[4],colorInfo:y[6],colorInfoActive:y[7],colorInfoTextHover:y[8],colorInfoText:y[9],colorInfoTextActive:y[10],colorLinkHover:m[4],colorLink:m[6],colorLinkActive:m[7],colorBgMask:new jn("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const JQ=t=>{let e=t,n=t,r=t,i=t;return t<6&&t>=5?e=t+1:t<16&&t>=6?e=t+2:t>=16&&(e=16),t<7&&t>=5?n=4:t<8&&t>=7?n=5:t<14&&t>=8?n=6:t<16&&t>=14?n=7:t>=16&&(n=8),t<6&&t>=2?r=1:t>=6&&(r=2),t>4&&t<8?i=4:t>=8&&(i=6),{borderRadius:t,borderRadiusXS:r,borderRadiusSM:n,borderRadiusLG:e,borderRadiusOuter:i}},KQ=JQ;function YQ(t){const{motionUnit:e,motionBase:n,borderRadius:r,lineWidth:i}=t;return Object.assign({motionDurationFast:`${(n+e).toFixed(1)}s`,motionDurationMid:`${(n+e*2).toFixed(1)}s`,motionDurationSlow:`${(n+e*3).toFixed(1)}s`,lineWidthBold:i+1},KQ(r))}const Gi=(t,e)=>new jn(t).setAlpha(e).toRgbString(),qc=(t,e)=>new jn(t).darken(e).toHexString(),qQ=t=>{const e=_c(t);return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[4],6:e[5],7:e[6],8:e[4],9:e[5],10:e[6]}},QQ=(t,e)=>{const n=t||"#fff",r=e||"#000";return{colorBgBase:n,colorTextBase:r,colorText:Gi(r,.88),colorTextSecondary:Gi(r,.65),colorTextTertiary:Gi(r,.45),colorTextQuaternary:Gi(r,.25),colorFill:Gi(r,.15),colorFillSecondary:Gi(r,.06),colorFillTertiary:Gi(r,.04),colorFillQuaternary:Gi(r,.02),colorBgLayout:qc(n,4),colorBgContainer:qc(n,0),colorBgElevated:qc(n,0),colorBgSpotlight:Gi(r,.85),colorBgBlur:"transparent",colorBorder:qc(n,15),colorBorderSecondary:qc(n,6)}};function ZQ(t){const e=new Array(10).fill(null).map((n,r)=>{const i=r-1,s=t*Math.pow(2.71828,i/5),o=r>1?Math.floor(s):Math.ceil(s);return Math.floor(o/2)*2});return e[1]=t,e.map(n=>{const r=n+8;return{size:n,lineHeight:r/n}})}const eZ=t=>{const e=ZQ(t),n=e.map(i=>i.size),r=e.map(i=>i.lineHeight);return{fontSizeSM:n[0],fontSize:n[1],fontSizeLG:n[2],fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:r[1],lineHeightLG:r[2],lineHeightSM:r[0],lineHeightHeading1:r[6],lineHeightHeading2:r[5],lineHeightHeading3:r[4],lineHeightHeading4:r[3],lineHeightHeading5:r[2]}},tZ=eZ;function nZ(t){const e=Object.keys(O2).map(n=>{const r=_c(t[n]);return new Array(10).fill(1).reduce((i,s,o)=>(i[`${n}-${o+1}`]=r[o],i[`${n}${o+1}`]=r[o],i),{})}).reduce((n,r)=>(n=Object.assign(Object.assign({},n),r),n),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t),e),XQ(t,{generateColorPalettes:qQ,generateNeutralColorPalettes:QQ})),tZ(t.fontSize)),WQ(t)),VQ(t)),YQ(t))}const F2=Pv(nZ),D2={token:su,override:{override:su},hashed:!0},N2=Nn.createContext(D2),k2="anticon",rZ=(t,e)=>e||(t?`ant-${t}`:"ant"),Ko=E.createContext({getPrefixCls:rZ,iconPrefixCls:k2}),iZ=`-ant-${Date.now()}-${Math.random()}`;function sZ(t,e){const n={},r=(o,a)=>{let c=o.clone();return c=(a==null?void 0:a(c))||c,c.toRgbString()},i=(o,a)=>{const c=new jn(o),l=_c(c.toRgbString());n[`${a}-color`]=r(c),n[`${a}-color-disabled`]=l[1],n[`${a}-color-hover`]=l[4],n[`${a}-color-active`]=l[6],n[`${a}-color-outline`]=c.clone().setAlpha(.2).toRgbString(),n[`${a}-color-deprecated-bg`]=l[0],n[`${a}-color-deprecated-border`]=l[2]};if(e.primaryColor){i(e.primaryColor,"primary");const o=new jn(e.primaryColor),a=_c(o.toRgbString());a.forEach((l,u)=>{n[`primary-${u+1}`]=l}),n["primary-color-deprecated-l-35"]=r(o,l=>l.lighten(35)),n["primary-color-deprecated-l-20"]=r(o,l=>l.lighten(20)),n["primary-color-deprecated-t-20"]=r(o,l=>l.tint(20)),n["primary-color-deprecated-t-50"]=r(o,l=>l.tint(50)),n["primary-color-deprecated-f-12"]=r(o,l=>l.setAlpha(l.getAlpha()*.12));const c=new jn(a[0]);n["primary-color-active-deprecated-f-30"]=r(c,l=>l.setAlpha(l.getAlpha()*.3)),n["primary-color-active-deprecated-d-02"]=r(c,l=>l.darken(2))}return e.successColor&&i(e.successColor,"success"),e.warningColor&&i(e.warningColor,"warning"),e.errorColor&&i(e.errorColor,"error"),e.infoColor&&i(e.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(o=>`--${t}-${o}: ${n[o]};`).join(`
`)}
  }
  `.trim()}function oZ(t,e){const n=sZ(t,e);Jn()&&nu(n,`${iZ}-dynamic-theme`)}const Nv=E.createContext(!1),aZ=t=>{let{children:e,disabled:n}=t;const r=E.useContext(Nv);return E.createElement(Nv.Provider,{value:n??r},e)},U2=Nv,kv=E.createContext(void 0),cZ=t=>{let{children:e,size:n}=t;const r=E.useContext(kv);return E.createElement(kv.Provider,{value:n||r},e)},S1=kv;function lZ(){const t=E.useContext(U2),e=E.useContext(S1);return{componentDisabled:t,componentSize:e}}const wd=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],uZ="5.10.2";function Tm(t){return t>=0&&t<=255}function kf(t,e){const{r:n,g:r,b:i,a:s}=new jn(t).toRgb();if(s<1)return t;const{r:o,g:a,b:c}=new jn(e).toRgb();for(let l=.01;l<=1;l+=.01){const u=Math.round((n-o*(1-l))/l),f=Math.round((r-a*(1-l))/l),h=Math.round((i-c*(1-l))/l);if(Tm(u)&&Tm(f)&&Tm(h))return new jn({r:u,g:f,b:h,a:Math.round(l*100)/100}).toRgbString()}return new jn({r:n,g:r,b:i,a:1}).toRgbString()}var fZ=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function G2(t){const{override:e}=t,n=fZ(t,["override"]),r=Object.assign({},e);Object.keys(su).forEach(h=>{delete r[h]});const i=Object.assign(Object.assign({},n),r),s=480,o=576,a=768,c=992,l=1200,u=1600;if(i.motion===!1){const h="0s";i.motionDurationFast=h,i.motionDurationMid=h,i.motionDurationSlow=h}return Object.assign(Object.assign(Object.assign({},i),{colorFillContent:i.colorFillSecondary,colorFillContentHover:i.colorFill,colorFillAlter:i.colorFillQuaternary,colorBgContainerDisabled:i.colorFillTertiary,colorBorderBg:i.colorBgContainer,colorSplit:kf(i.colorBorderSecondary,i.colorBgContainer),colorTextPlaceholder:i.colorTextQuaternary,colorTextDisabled:i.colorTextQuaternary,colorTextHeading:i.colorText,colorTextLabel:i.colorTextSecondary,colorTextDescription:i.colorTextTertiary,colorTextLightSolid:i.colorWhite,colorHighlight:i.colorError,colorBgTextHover:i.colorFillSecondary,colorBgTextActive:i.colorFill,colorIcon:i.colorTextTertiary,colorIconHover:i.colorText,colorErrorOutline:kf(i.colorErrorBg,i.colorBgContainer),colorWarningOutline:kf(i.colorWarningBg,i.colorBgContainer),fontSizeIcon:i.fontSizeSM,lineWidthFocus:i.lineWidth*4,lineWidth:i.lineWidth,controlOutlineWidth:i.lineWidth*2,controlInteractiveSize:i.controlHeight/2,controlItemBgHover:i.colorFillTertiary,controlItemBgActive:i.colorPrimaryBg,controlItemBgActiveHover:i.colorPrimaryBgHover,controlItemBgActiveDisabled:i.colorFill,controlTmpOutline:i.colorFillQuaternary,controlOutline:kf(i.colorPrimaryBg,i.colorBgContainer),lineType:i.lineType,borderRadius:i.borderRadius,borderRadiusXS:i.borderRadiusXS,borderRadiusSM:i.borderRadiusSM,borderRadiusLG:i.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:i.sizeXXS,paddingXS:i.sizeXS,paddingSM:i.sizeSM,padding:i.size,paddingMD:i.sizeMD,paddingLG:i.sizeLG,paddingXL:i.sizeXL,paddingContentHorizontalLG:i.sizeLG,paddingContentVerticalLG:i.sizeMS,paddingContentHorizontal:i.sizeMS,paddingContentVertical:i.sizeSM,paddingContentHorizontalSM:i.size,paddingContentVerticalSM:i.sizeXS,marginXXS:i.sizeXXS,marginXS:i.sizeXS,marginSM:i.sizeSM,margin:i.size,marginMD:i.sizeMD,marginLG:i.sizeLG,marginXL:i.sizeXL,marginXXL:i.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:s,screenXSMin:s,screenXSMax:o-1,screenSM:o,screenSMMin:o,screenSMMax:a-1,screenMD:a,screenMDMin:a,screenMDMax:c-1,screenLG:c,screenLGMin:c,screenLGMax:l-1,screenXL:l,screenXLMin:l,screenXLMax:u-1,screenXXL:u,screenXXLMin:u,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new jn("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new jn("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new jn("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),r)}var RC=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const z2=(t,e,n)=>{const r=n.getDerivativeToken(t),{override:i}=e,s=RC(e,["override"]);let o=Object.assign(Object.assign({},r),{override:i});return o=G2(o),s&&Object.entries(s).forEach(a=>{let[c,l]=a;const{theme:u}=l,f=RC(l,["theme"]);let h=f;u&&(h=z2(Object.assign(Object.assign({},o),f),{override:f},u)),o[c]=h}),o};function Pg(){const{token:t,hashed:e,theme:n,override:r}=Nn.useContext(N2),i=`${uZ}-${e||""}`,s=n||F2,[o,a]=Bq(s,[su,t],{salt:i,override:r,getComputedToken:z2,formatToken:G2});return[s,o,e?a:""]}function Vi(t){var e=E.useRef();e.current=t;var n=E.useCallback(function(){for(var r,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return(r=e.current)===null||r===void 0?void 0:r.call.apply(r,[e].concat(s))},[]);return n}function Qa(t){var e=E.useRef(!1),n=E.useState(t),r=Z(n,2),i=r[0],s=r[1];E.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function o(a,c){c&&e.current||s(a)}return[i,o]}function Sm(t){return t!==void 0}function H2(t,e){var n=e||{},r=n.defaultValue,i=n.value,s=n.onChange,o=n.postState,a=Qa(function(){return Sm(i)?i:Sm(r)?typeof r=="function"?r():r:typeof t=="function"?t():t}),c=Z(a,2),l=c[0],u=c[1],f=i!==void 0?i:l,h=o?o(f):f,d=Vi(s),p=Qa([f]),y=Z(p,2),b=y[0],v=y[1];dC(function(){var _=b[0];l!==_&&d(l,_)},[b]),dC(function(){Sm(i)||u(i)},[i]);var m=Vi(function(_,A){u(_,A),v([f],A)});return[h,m]}const hZ=(t,e,n,r,i)=>{const s=t/2,o=0,a=s,c=n*1/Math.sqrt(2),l=s-n*(1-1/Math.sqrt(2)),u=s-e*(1/Math.sqrt(2)),f=n*(Math.sqrt(2)-1)+e*(1/Math.sqrt(2)),h=2*s-u,d=f,p=2*s-c,y=l,b=2*s-o,v=a,m=s*Math.sqrt(2)+n*(Math.sqrt(2)-2),_=n*(Math.sqrt(2)-1);return{pointerEvents:"none",width:t,height:t,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:t,height:t/2,background:r,clipPath:{_multi_value_:!0,value:[`polygon(${_}px 100%, 50% ${_}px, ${2*s-_}px 100%, ${_}px 100%)`,`path('M ${o} ${a} A ${n} ${n} 0 0 0 ${c} ${l} L ${u} ${f} A ${e} ${e} 0 0 1 ${h} ${d} L ${p} ${y} A ${n} ${n} 0 0 0 ${b} ${v} Z')`]},content:'""'},"&::after":{content:'""',position:"absolute",width:m,height:m,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${e}px 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:i,zIndex:0,background:"transparent"}}},j2=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:t.colorText,fontSize:t.fontSize,lineHeight:t.lineHeight,listStyle:"none",fontFamily:e?"inherit":t.fontFamily}},dZ=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),gZ=t=>({a:{color:t.colorLink,textDecoration:t.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${t.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:t.colorLinkHover},"&:active":{color:t.colorLinkActive},"&:active,\n  &:hover":{textDecoration:t.linkHoverDecoration,outline:0},"&:focus":{textDecoration:t.linkFocusDecoration,outline:0},"&[disabled]":{color:t.colorTextDisabled,cursor:"not-allowed"}}}),pZ=(t,e)=>{const{fontFamily:n,fontSize:r}=t,i=`[class^="${e}"], [class*=" ${e}"]`;return{[i]:{fontFamily:n,fontSize:r,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[i]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},V2=typeof CSSINJS_STATISTIC<"u";let Uv=!0;function ou(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!V2)return Object.assign.apply(Object,[{}].concat(e));Uv=!1;const r={};return e.forEach(i=>{Object.keys(i).forEach(o=>{Object.defineProperty(r,o,{configurable:!0,enumerable:!0,get:()=>i[o]})})}),Uv=!0,r}const IC={};function mZ(){}function vZ(t){let e,n=t,r=mZ;return V2&&(e=new Set,n=new Proxy(t,{get(i,s){return Uv&&e.add(s),i[s]}}),r=(i,s)=>{var o;IC[i]={global:Array.from(e),component:Object.assign(Object.assign({},(o=IC[i])===null||o===void 0?void 0:o.component),s)}}),{token:n,keys:e,flush:r}}const yZ=(t,e)=>{const[n,r]=Pg();return Lv({theme:n,token:r,hashId:"",path:["ant-design-icons",t],nonce:()=>e==null?void 0:e.nonce},()=>[{[`.${t}`]:Object.assign(Object.assign({},dZ()),{[`.${t} .${t}-icon`]:{display:"block"}})}])},W2=yZ;function $2(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=Array.isArray(t)?t:[t,t],[s]=i,o=i.join("-");return a=>{const[c,l,u]=Pg(),{getPrefixCls:f,iconPrefixCls:h,csp:d}=E.useContext(Ko),p=f(),y={theme:c,token:l,hashId:u,nonce:()=>d==null?void 0:d.nonce,clientOnly:r.clientOnly,order:r.order||-999};return Lv(Object.assign(Object.assign({},y),{clientOnly:!1,path:["Shared",p]}),()=>[{"&":gZ(l)}]),W2(h,d),[Lv(Object.assign(Object.assign({},y),{path:[o,a,h]}),()=>{const{token:b,flush:v}=vZ(l),m=Object.assign({},l[s]);if(r.deprecatedTokens){const{deprecatedTokens:M}=r;M.forEach(L=>{let[R,I]=L;var N;(m!=null&&m[R]||m!=null&&m[I])&&((N=m[I])!==null&&N!==void 0||(m[I]=m==null?void 0:m[R]))})}const _=typeof n=="function"?n(ou(b,m??{})):n,A=Object.assign(Object.assign({},_),m),S=`.${a}`,w=ou(b,{componentCls:S,prefixCls:a,iconCls:`.${h}`,antCls:`.${p}`},A),x=e(w,{hashId:u,prefixCls:a,rootPrefixCls:p,iconPrefixCls:h,overrideComponentToken:m});return v(s,A),[r.resetStyle===!1?null:pZ(l,a),x]}),u]}}function _Z(t,e){return wd.reduce((n,r)=>{const i=t[`${r}1`],s=t[`${r}3`],o=t[`${r}6`],a=t[`${r}7`];return Object.assign(Object.assign({},n),e(r,{lightColor:i,lightBorderColor:s,darkColor:o,textColor:a}))},{})}function bZ(t,e){const n=t||{},r=n.inherit===!1||!e?D2:e;return u1(()=>{if(!t)return e;const i=Object.assign({},r.components);return Object.keys(t.components||{}).forEach(s=>{i[s]=Object.assign(Object.assign({},i[s]),t.components[s])}),Object.assign(Object.assign(Object.assign({},r),n),{token:Object.assign(Object.assign({},r.token),n.token),components:i})},[n,r],(i,s)=>i.some((o,a)=>{const c=s[a];return!u2(o,c,!0)}))}var AZ=["children"],X2=E.createContext({});function EZ(t){var e=t.children,n=ko(t,AZ);return E.createElement(X2.Provider,{value:n},e)}var TZ=function(t){g1(n,t);var e=p1(n);function n(){return Xo(this,n),e.apply(this,arguments)}return Jo(n,[{key:"render",value:function(){return this.props.children}}]),n}(E.Component),lo="none",Uf="appear",Gf="enter",zf="leave",LC="none",Yr="prepare",Na="start",ka="active",C1="end",J2="prepared";function BC(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function SZ(t,e){var n={animationend:BC("Animation","AnimationEnd"),transitionend:BC("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var CZ=SZ(Jn(),typeof window<"u"?window:{}),K2={};if(Jn()){var wZ=document.createElement("div");K2=wZ.style}var Hf={};function Y2(t){if(Hf[t])return Hf[t];var e=CZ[t];if(e)for(var n=Object.keys(e),r=n.length,i=0;i<r;i+=1){var s=n[i];if(Object.prototype.hasOwnProperty.call(e,s)&&s in K2)return Hf[t]=e[s],Hf[t]}return""}var q2=Y2("animationend"),Q2=Y2("transitionend"),Z2=!!(q2&&Q2),OC=q2||"animationend",FC=Q2||"transitionend";function DC(t,e){if(!t)return null;if(Bt(t)==="object"){var n=e.replace(/-\w/g,function(r){return r[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const xZ=function(t){var e=E.useRef(),n=E.useRef(t);n.current=t;var r=E.useCallback(function(o){n.current(o)},[]);function i(o){o&&(o.removeEventListener(FC,r),o.removeEventListener(OC,r))}function s(o){e.current&&e.current!==o&&i(e.current),o&&o!==e.current&&(o.addEventListener(FC,r),o.addEventListener(OC,r),e.current=o)}return E.useEffect(function(){return function(){i(e.current)}},[]),[s,i]};var eL=Jn()?E.useLayoutEffect:E.useEffect;const PZ=function(){var t=E.useRef(null);function e(){No.cancel(t.current)}function n(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var s=No(function(){i<=1?r({isCanceled:function(){return s!==t.current}}):n(r,i-1)});t.current=s}return E.useEffect(function(){return function(){e()}},[]),[n,e]};var MZ=[Yr,Na,ka,C1],RZ=[Yr,J2],tL=!1,IZ=!0;function nL(t){return t===ka||t===C1}const LZ=function(t,e,n){var r=Qa(LC),i=Z(r,2),s=i[0],o=i[1],a=PZ(),c=Z(a,2),l=c[0],u=c[1];function f(){o(Yr,!0)}var h=e?RZ:MZ;return eL(function(){if(s!==LC&&s!==C1){var d=h.indexOf(s),p=h[d+1],y=n(s);y===tL?o(p,!0):p&&l(function(b){function v(){b.isCanceled()||o(p,!0)}y===!0?v():Promise.resolve(y).then(v)})}},[t,s]),E.useEffect(function(){return function(){u()}},[]),[f,s]};function BZ(t,e,n,r){var i=r.motionEnter,s=i===void 0?!0:i,o=r.motionAppear,a=o===void 0?!0:o,c=r.motionLeave,l=c===void 0?!0:c,u=r.motionDeadline,f=r.motionLeaveImmediately,h=r.onAppearPrepare,d=r.onEnterPrepare,p=r.onLeavePrepare,y=r.onAppearStart,b=r.onEnterStart,v=r.onLeaveStart,m=r.onAppearActive,_=r.onEnterActive,A=r.onLeaveActive,S=r.onAppearEnd,w=r.onEnterEnd,x=r.onLeaveEnd,M=r.onVisibleChanged,L=Qa(),R=Z(L,2),I=R[0],N=R[1],k=Qa(lo),z=Z(k,2),$=z[0],V=z[1],U=Qa(null),F=Z(U,2),D=F[0],W=F[1],ee=E.useRef(!1),te=E.useRef(null);function pe(){return n()}var Ae=E.useRef(!1);function we(){V(lo,!0),W(null,!0)}function be(ae){var ce=pe();if(!(ae&&!ae.deadline&&ae.target!==ce)){var ne=Ae.current,nt;$===Uf&&ne?nt=S==null?void 0:S(ce,ae):$===Gf&&ne?nt=w==null?void 0:w(ce,ae):$===zf&&ne&&(nt=x==null?void 0:x(ce,ae)),$!==lo&&ne&&nt!==!1&&we()}}var ie=xZ(be),he=Z(ie,1),se=he[0],me=function(ce){var ne,nt,ft;switch(ce){case Uf:return ne={},g(ne,Yr,h),g(ne,Na,y),g(ne,ka,m),ne;case Gf:return nt={},g(nt,Yr,d),g(nt,Na,b),g(nt,ka,_),nt;case zf:return ft={},g(ft,Yr,p),g(ft,Na,v),g(ft,ka,A),ft;default:return{}}},Ie=E.useMemo(function(){return me($)},[$]),Xe=LZ($,!t,function(ae){if(ae===Yr){var ce=Ie[Yr];return ce?ce(pe()):tL}if(xe in Ie){var ne;W(((ne=Ie[xe])===null||ne===void 0?void 0:ne.call(Ie,pe(),null))||null)}return xe===ka&&(se(pe()),u>0&&(clearTimeout(te.current),te.current=setTimeout(function(){be({deadline:!0})},u))),xe===J2&&we(),IZ}),De=Z(Xe,2),Be=De[0],xe=De[1],Pe=nL(xe);Ae.current=Pe,eL(function(){N(e);var ae=ee.current;ee.current=!0;var ce;!ae&&e&&a&&(ce=Uf),ae&&e&&s&&(ce=Gf),(ae&&!e&&l||!ae&&f&&!e&&l)&&(ce=zf);var ne=me(ce);ce&&(t||ne[Yr])?(V(ce),Be()):V(lo)},[e]),E.useEffect(function(){($===Uf&&!a||$===Gf&&!s||$===zf&&!l)&&V(lo)},[a,s,l]),E.useEffect(function(){return function(){ee.current=!1,clearTimeout(te.current)}},[]);var Ne=E.useRef(!1);E.useEffect(function(){I&&(Ne.current=!0),I!==void 0&&$===lo&&((Ne.current||I)&&(M==null||M(I)),Ne.current=!0)},[I,$]);var ue=D;return Ie[Yr]&&xe===Na&&(ue=q({transition:"none"},ue)),[$,xe,ue,I??e]}function OZ(t){var e=t;Bt(t)==="object"&&(e=t.transitionSupport);function n(i,s){return!!(i.motionName&&e&&s!==!1)}var r=E.forwardRef(function(i,s){var o=i.visible,a=o===void 0?!0:o,c=i.removeOnLeave,l=c===void 0?!0:c,u=i.forceRender,f=i.children,h=i.motionName,d=i.leavedClassName,p=i.eventProps,y=E.useContext(X2),b=y.motion,v=n(i,b),m=E.useRef(),_=E.useRef();function A(){try{return m.current instanceof HTMLElement?m.current:vh(_.current)}catch{return null}}var S=BZ(v,a,A,i),w=Z(S,4),x=w[0],M=w[1],L=w[2],R=w[3],I=E.useRef(R);R&&(I.current=!0);var N=E.useCallback(function(W){m.current=W,f1(s,W)},[s]),k,z=q(q({},p),{},{visible:a});if(!f)k=null;else if(x===lo)R?k=f(q({},z),N):!l&&I.current&&d?k=f(q(q({},z),{},{className:d}),N):u||!l&&!d?k=f(q(q({},z),{},{style:{display:"none"}}),N):k=null;else{var $,V;M===Yr?V="prepare":nL(M)?V="active":M===Na&&(V="start");var U=DC(h,"".concat(x,"-").concat(V));k=f(q(q({},z),{},{className:Lt(DC(h,x),($={},g($,U,U&&V),g($,h,typeof h=="string"),$)),style:L}),N)}if(E.isValidElement(k)&&Eg(k)){var F=k,D=F.ref;D||(k=E.cloneElement(k,{ref:N}))}return E.createElement(TZ,{ref:_},k)});return r.displayName="CSSMotion",r}const w1=OZ(Z2);var Gv="add",zv="keep",Hv="remove",Cm="removed";function FZ(t){var e;return t&&Bt(t)==="object"&&"key"in t?e=t:e={key:t},q(q({},e),{},{key:String(e.key)})}function jv(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(FZ)}function DZ(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],r=0,i=e.length,s=jv(t),o=jv(e);s.forEach(function(l){for(var u=!1,f=r;f<i;f+=1){var h=o[f];if(h.key===l.key){r<f&&(n=n.concat(o.slice(r,f).map(function(d){return q(q({},d),{},{status:Gv})})),r=f),n.push(q(q({},h),{},{status:zv})),r+=1,u=!0;break}}u||n.push(q(q({},l),{},{status:Hv}))}),r<i&&(n=n.concat(o.slice(r).map(function(l){return q(q({},l),{},{status:Gv})})));var a={};n.forEach(function(l){var u=l.key;a[u]=(a[u]||0)+1});var c=Object.keys(a).filter(function(l){return a[l]>1});return c.forEach(function(l){n=n.filter(function(u){var f=u.key,h=u.status;return f!==l||h!==Hv}),n.forEach(function(u){u.key===l&&(u.status=zv)})}),n}var NZ=["component","children","onVisibleChanged","onAllRemoved"],kZ=["status"],UZ=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function GZ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w1,n=function(r){g1(s,r);var i=p1(s);function s(){var o;Xo(this,s);for(var a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return o=i.call.apply(i,[this].concat(c)),g(Sv(o),"state",{keyEntities:[]}),g(Sv(o),"removeKey",function(u){var f=o.state.keyEntities,h=f.map(function(d){return d.key!==u?d:q(q({},d),{},{status:Cm})});return o.setState({keyEntities:h}),h.filter(function(d){var p=d.status;return p!==Cm}).length}),o}return Jo(s,[{key:"render",value:function(){var a=this,c=this.state.keyEntities,l=this.props,u=l.component,f=l.children,h=l.onVisibleChanged,d=l.onAllRemoved,p=ko(l,NZ),y=u||E.Fragment,b={};return UZ.forEach(function(v){b[v]=p[v],delete p[v]}),delete p.keys,E.createElement(y,p,c.map(function(v,m){var _=v.status,A=ko(v,kZ),S=_===Gv||_===zv;return E.createElement(e,Oi({},b,{key:A.key,visible:S,eventProps:A,onVisibleChanged:function(x){if(h==null||h(x,{key:A.key}),!x){var M=a.removeKey(A.key);M===0&&d&&d()}}}),function(w,x){return f(q(q({},w),{},{index:m}),x)})}))}}],[{key:"getDerivedStateFromProps",value:function(a,c){var l=a.keys,u=c.keyEntities,f=jv(l),h=DZ(u,f);return{keyEntities:h.filter(function(d){var p=u.find(function(y){var b=y.key;return d.key===b});return!(p&&p.status===Cm&&d.status===Hv)})}}}]),s}(E.Component);return g(n,"defaultProps",{component:"div"}),n}GZ(Z2);function zZ(t){const{children:e}=t,[,n]=Pg(),{motion:r}=n,i=E.useRef(!1);return i.current=i.current||r===!1,i.current?E.createElement(EZ,{motion:r},e):e}const HZ=()=>null;var jZ=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const VZ=["getTargetContainer","getPopupContainer","renderEmpty","pageHeader","input","pagination","form","select","button"],WZ="ant";let rL;function $Z(){return rL||WZ}function XZ(t){return Object.keys(t).some(e=>e.endsWith("Color"))}const JZ=t=>{let{prefixCls:e,iconPrefixCls:n,theme:r}=t;e!==void 0&&(rL=e),r&&XZ(r)&&oZ($Z(),r)},KZ=t=>{const{children:e,csp:n,autoInsertSpaceInButton:r,alert:i,anchor:s,form:o,locale:a,componentSize:c,direction:l,space:u,virtual:f,dropdownMatchSelectWidth:h,popupMatchSelectWidth:d,popupOverflow:p,legacyLocale:y,parentContext:b,iconPrefixCls:v,theme:m,componentDisabled:_,segmented:A,statistic:S,spin:w,calendar:x,carousel:M,cascader:L,collapse:R,typography:I,checkbox:N,descriptions:k,divider:z,drawer:$,skeleton:V,steps:U,image:F,layout:D,list:W,mentions:ee,modal:te,progress:pe,result:Ae,slider:we,breadcrumb:be,menu:ie,pagination:he,input:se,empty:me,badge:Ie,radio:Xe,rate:De,switch:Be,transfer:xe,avatar:Pe,message:Ne,tag:ue,table:ae,card:ce,tabs:ne,timeline:nt,timePicker:ft,upload:Fi,notification:kr,tree:Tt,colorPicker:gr,datePicker:jt,flex:Ot,wave:Vt,warning:St}=t,Ct=E.useCallback((fe,oe)=>{const{prefixCls:qe}=t;if(oe)return oe;const je=qe||b.getPrefixCls("");return fe?`${je}-${fe}`:je},[b.getPrefixCls,t.prefixCls]),an=v||b.iconPrefixCls||k2,ht=n||b.csp;W2(an,ht);const it=bZ(m,b.theme),qt={csp:ht,autoInsertSpaceInButton:r,alert:i,anchor:s,locale:a||y,direction:l,space:u,virtual:f,popupMatchSelectWidth:d??h,popupOverflow:p,getPrefixCls:Ct,iconPrefixCls:an,theme:it,segmented:A,statistic:S,spin:w,calendar:x,carousel:M,cascader:L,collapse:R,typography:I,checkbox:N,descriptions:k,divider:z,drawer:$,skeleton:V,steps:U,image:F,input:se,layout:D,list:W,mentions:ee,modal:te,progress:pe,result:Ae,slider:we,breadcrumb:be,menu:ie,pagination:he,empty:me,badge:Ie,radio:Xe,rate:De,switch:Be,transfer:xe,avatar:Pe,message:Ne,tag:ue,table:ae,card:ce,tabs:ne,timeline:nt,timePicker:ft,upload:Fi,notification:kr,tree:Tt,colorPicker:gr,datePicker:jt,flex:Ot,wave:Vt,warning:St},pr=Object.assign({},b);Object.keys(qt).forEach(fe=>{qt[fe]!==void 0&&(pr[fe]=qt[fe])}),VZ.forEach(fe=>{const oe=t[fe];oe&&(pr[fe]=oe)});const st=u1(()=>pr,pr,(fe,oe)=>{const qe=Object.keys(fe),je=Object.keys(oe);return qe.length!==je.length||qe.some(cn=>fe[cn]!==oe[cn])}),wt=E.useMemo(()=>({prefixCls:an,csp:ht}),[an,ht]);let He=E.createElement(E.Fragment,null,E.createElement(HZ,{dropdownMatchSelectWidth:h}),e);const In=E.useMemo(()=>{var fe,oe,qe,je;return hQ(((fe=xg.Form)===null||fe===void 0?void 0:fe.defaultValidateMessages)||{},((qe=(oe=st.locale)===null||oe===void 0?void 0:oe.Form)===null||qe===void 0?void 0:qe.defaultValidateMessages)||{},((je=st.form)===null||je===void 0?void 0:je.validateMessages)||{},(o==null?void 0:o.validateMessages)||{})},[st,o==null?void 0:o.validateMessages]);Object.keys(In).length>0&&(He=E.createElement(mQ.Provider,{value:In},He)),a&&(He=E.createElement(wQ,{locale:a,_ANT_MARK__:SQ},He)),(an||ht)&&(He=E.createElement(cQ.Provider,{value:wt},He)),c&&(He=E.createElement(cZ,{size:c},He)),He=E.createElement(zZ,null,He);const An=E.useMemo(()=>{const fe=it||{},{algorithm:oe,token:qe,components:je}=fe,cn=jZ(fe,["algorithm","token","components"]),mr=oe&&(!Array.isArray(oe)||oe.length>0)?Pv(oe):F2,En={};Object.entries(je||{}).forEach(ln=>{let[Ur,un]=ln;const xt=Object.assign({},un);"algorithm"in xt&&(xt.algorithm===!0?xt.theme=mr:(Array.isArray(xt.algorithm)||typeof xt.algorithm=="function")&&(xt.theme=Pv(xt.algorithm)),delete xt.algorithm),En[Ur]=xt});const Ft=Object.assign(Object.assign({},su),qe);return Object.assign(Object.assign({},cn),{theme:mr,token:Ft,components:En,override:Object.assign({override:Ft},En)})},[it]);return m&&(He=E.createElement(N2.Provider,{value:An},He)),st.warning&&(He=E.createElement(gQ.Provider,{value:st.warning},He)),_!==void 0&&(He=E.createElement(aZ,{disabled:_},He)),E.createElement(Ko.Provider,{value:st},He)},Mu=t=>{const e=E.useContext(Ko),n=E.useContext(R2);return E.createElement(KZ,Object.assign({parentContext:e,legacyLocale:n},t))};Mu.ConfigContext=Ko;Mu.SizeContext=S1;Mu.config=JZ;Mu.useConfig=lZ;Object.defineProperty(Mu,"SizeContext",{get:()=>S1});function iL(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}function YZ(t){return iL(t)instanceof ShadowRoot}function Vv(t){return YZ(t)?iL(t):null}const{isValidElement:x1}=Md;function qZ(t){return t&&x1(t)&&t.type===E.Fragment}function QZ(t,e,n){return x1(t)?E.cloneElement(t,typeof n=="function"?n(t.props||{}):n):e}function ZZ(t,e){return QZ(t,t,e)}var re={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(e){var n=e.keyCode;if(e.altKey&&!e.ctrlKey||e.metaKey||n>=re.F1&&n<=re.F12)return!1;switch(n){case re.ALT:case re.CAPS_LOCK:case re.CONTEXT_MENU:case re.CTRL:case re.DOWN:case re.END:case re.ESC:case re.HOME:case re.INSERT:case re.LEFT:case re.MAC_FF_META:case re.META:case re.NUMLOCK:case re.NUM_CENTER:case re.PAGE_DOWN:case re.PAGE_UP:case re.PAUSE:case re.PRINT_SCREEN:case re.RIGHT:case re.SHIFT:case re.UP:case re.WIN_KEY:case re.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(e){if(e>=re.ZERO&&e<=re.NINE||e>=re.NUM_ZERO&&e<=re.NUM_MULTIPLY||e>=re.A&&e<=re.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&e===0)return!0;switch(e){case re.SPACE:case re.QUESTION_MARK:case re.NUM_PLUS:case re.NUM_MINUS:case re.NUM_PERIOD:case re.NUM_DIVISION:case re.SEMICOLON:case re.DASH:case re.EQUALS:case re.COMMA:case re.PERIOD:case re.SLASH:case re.APOSTROPHE:case re.SINGLE_QUOTE:case re.OPEN_SQUARE_BRACKET:case re.BACKSLASH:case re.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}};const eee=(t,e,n)=>n!==void 0?n:`${t}-${e}`,tee=function(t){if(!t)return!1;if(t instanceof Element){if(t.offsetParent)return!0;if(t.getBBox){var e=t.getBBox(),n=e.width,r=e.height;if(n||r)return!0}if(t.getBoundingClientRect){var i=t.getBoundingClientRect(),s=i.width,o=i.height;if(s||o)return!0}}return!1};globalThis&&globalThis.__rest;const nee=E.createContext(null),ree=t=>{let{children:e}=t;return E.createElement(nee.Provider,{value:null},e)};var sL=E.createContext(null),NC=[];function iee(t,e){var n=E.useState(function(){if(!Jn())return null;var p=document.createElement("div");return p}),r=Z(n,1),i=r[0],s=E.useRef(!1),o=E.useContext(sL),a=E.useState(NC),c=Z(a,2),l=c[0],u=c[1],f=o||(s.current?void 0:function(p){u(function(y){var b=[p].concat(It(y));return b})});function h(){i.parentElement||document.body.appendChild(i),s.current=!0}function d(){var p;(p=i.parentElement)===null||p===void 0||p.removeChild(i),s.current=!1}return xn(function(){return t?o?o(h):h():d(),d},[t]),xn(function(){l.length&&(l.forEach(function(p){return p()}),u(NC))},[l]),[i,f]}var wm;function see(t){if(typeof document>"u")return 0;if(t||wm===void 0){var e=document.createElement("div");e.style.width="100%",e.style.height="200px";var n=document.createElement("div"),r=n.style;r.position="absolute",r.top="0",r.left="0",r.pointerEvents="none",r.visibility="hidden",r.width="200px",r.height="150px",r.overflow="hidden",n.appendChild(e),document.body.appendChild(n);var i=e.offsetWidth;n.style.overflow="scroll";var s=e.offsetWidth;i===s&&(s=n.clientWidth),document.body.removeChild(n),wm=i-s}return wm}function kC(t){var e=t.match(/^(.*)px$/),n=Number(e==null?void 0:e[1]);return Number.isNaN(n)?see():n}function oee(t){if(typeof document>"u"||!t||!(t instanceof Element))return{width:0,height:0};var e=getComputedStyle(t,"::-webkit-scrollbar"),n=e.width,r=e.height;return{width:kC(n),height:kC(r)}}function aee(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var cee="rc-util-locker-".concat(Date.now()),UC=0;function lee(t){var e=!!t,n=E.useState(function(){return UC+=1,"".concat(cee,"_").concat(UC)}),r=Z(n,1),i=r[0];xn(function(){if(e){var s=oee(document.body).width,o=aee();nu(`
html body {
  overflow-y: hidden;
  `.concat(o?"width: calc(100% - ".concat(s,"px);"):"",`
}`),i)}else Sd(i);return function(){Sd(i)}},[e,i])}var GC=!1;function uee(t){return typeof t=="boolean"&&(GC=t),GC}var zC=function(e){return e===!1?!1:!Jn()||!e?null:typeof e=="string"?document.querySelector(e):typeof e=="function"?e():e},oL=E.forwardRef(function(t,e){var n=t.open,r=t.autoLock,i=t.getContainer;t.debug;var s=t.autoDestroy,o=s===void 0?!0:s,a=t.children,c=E.useState(n),l=Z(c,2),u=l[0],f=l[1],h=u||n;E.useEffect(function(){(o||n)&&f(n)},[n,o]);var d=E.useState(function(){return zC(i)}),p=Z(d,2),y=p[0],b=p[1];E.useEffect(function(){var I=zC(i);b(I??null)});var v=iee(h&&!y),m=Z(v,2),_=m[0],A=m[1],S=y??_;lee(r&&n&&Jn()&&(S===_||S===document.body));var w=null;if(a&&Eg(a)&&e){var x=a;w=x.ref}var M=d1(w,e);if(!h||!Jn()||y===void 0)return null;var L=S===!1||uee(),R=a;return e&&(R=E.cloneElement(a,{ref:M})),E.createElement(sL.Provider,{value:A},L?R:Tc.createPortal(R,S))});function fee(){var t=q({},Md);return t.useId}var HC=0,jC=fee();const hee=jC?function(e){var n=jC();return e||n}:function(e){var n=E.useState("ssr-id"),r=Z(n,2),i=r[0],s=r[1];return E.useEffect(function(){var o=HC;HC+=1,s("rc_unique_".concat(o))},[]),e||i},dee=t=>({animationDuration:t,animationFillMode:"both"}),gee=t=>({animationDuration:t,animationFillMode:"both"}),pee=function(t,e,n,r){const s=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${s}${t}-enter,
      ${s}${t}-appear
    `]:Object.assign(Object.assign({},dee(r)),{animationPlayState:"paused"}),[`${s}${t}-leave`]:Object.assign(Object.assign({},gee(r)),{animationPlayState:"paused"}),[`
      ${s}${t}-enter${t}-enter-active,
      ${s}${t}-appear${t}-appear-active
    `]:{animationName:e,animationPlayState:"running"},[`${s}${t}-leave${t}-leave-active`]:{animationName:n,animationPlayState:"running",pointerEvents:"none"}}},mee=new Nr("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),vee=new Nr("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),VC=new Nr("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),WC=new Nr("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),yee=new Nr("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),_ee=new Nr("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),bee=new Nr("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),Aee=new Nr("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),Eee=new Nr("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),Tee=new Nr("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),See=new Nr("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),Cee=new Nr("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),wee={zoom:{inKeyframes:mee,outKeyframes:vee},"zoom-big":{inKeyframes:VC,outKeyframes:WC},"zoom-big-fast":{inKeyframes:VC,outKeyframes:WC},"zoom-left":{inKeyframes:bee,outKeyframes:Aee},"zoom-right":{inKeyframes:Eee,outKeyframes:Tee},"zoom-up":{inKeyframes:yee,outKeyframes:_ee},"zoom-down":{inKeyframes:See,outKeyframes:Cee}},xee=(t,e)=>{const{antCls:n}=t,r=`${n}-${e}`,{inKeyframes:i,outKeyframes:s}=wee[e];return[pee(r,i,s,e==="zoom-big-fast"?t.motionDurationFast:t.motionDurationMid),{[`
        ${r}-enter,
        ${r}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:t.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${r}-leave`]:{animationTimingFunction:t.motionEaseInOutCirc}}]},Pee=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t==null?void 0:t.substr(0,4))};var $C=E.createContext(null);function XC(t){return t?Array.isArray(t)?t:[t]:[]}function Mee(t,e,n,r){return E.useMemo(function(){var i=XC(n??e),s=XC(r??e),o=new Set(i),a=new Set(s);return t&&(o.has("hover")&&(o.delete("hover"),o.add("click")),a.has("hover")&&(a.delete("hover"),a.add("click"))),[o,a]},[t,e,n,r])}function Ree(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return n?t[0]===e[0]:t[0]===e[0]&&t[1]===e[1]}function Iee(t,e,n,r){for(var i=n.points,s=Object.keys(t),o=0;o<s.length;o+=1){var a,c=s[o];if(Ree((a=t[c])===null||a===void 0?void 0:a.points,i,r))return"".concat(e,"-placement-").concat(c)}return""}function JC(t,e,n,r){return e||(n?{motionName:"".concat(t,"-").concat(n)}:r?{motionName:r}:null)}function Ru(t){return t.ownerDocument.defaultView}function Wv(t){for(var e=[],n=t==null?void 0:t.parentElement,r=["hidden","scroll","clip","auto"];n;){var i=Ru(n).getComputedStyle(n),s=i.overflowX,o=i.overflowY,a=i.overflow;[s,o,a].some(function(c){return r.includes(c)})&&e.push(n),n=n.parentElement}return e}function au(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(t)?e:t}function Qc(t){return au(parseFloat(t),0)}function KC(t,e){var n=q({},t);return(e||[]).forEach(function(r){if(!(r instanceof HTMLBodyElement||r instanceof HTMLHtmlElement)){var i=Ru(r).getComputedStyle(r),s=i.overflow,o=i.overflowClipMargin,a=i.borderTopWidth,c=i.borderBottomWidth,l=i.borderLeftWidth,u=i.borderRightWidth,f=r.getBoundingClientRect(),h=r.offsetHeight,d=r.clientHeight,p=r.offsetWidth,y=r.clientWidth,b=Qc(a),v=Qc(c),m=Qc(l),_=Qc(u),A=au(Math.round(f.width/p*1e3)/1e3),S=au(Math.round(f.height/h*1e3)/1e3),w=(p-y-m-_)*A,x=(h-d-b-v)*S,M=b*S,L=v*S,R=m*A,I=_*A,N=0,k=0;if(s==="clip"){var z=Qc(o);N=z*A,k=z*S}var $=f.x+R-N,V=f.y+M-k,U=$+f.width+2*N-R-I-w,F=V+f.height+2*k-M-L-x;n.left=Math.max(n.left,$),n.top=Math.max(n.top,V),n.right=Math.min(n.right,U),n.bottom=Math.min(n.bottom,F)}}),n}function YC(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n="".concat(e),r=n.match(/^(.*)\%$/);return r?t*(parseFloat(r[1])/100):parseFloat(n)}function qC(t,e){var n=e||[],r=Z(n,2),i=r[0],s=r[1];return[YC(t.width,i),YC(t.height,s)]}function QC(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[t[0],t[1]]}function ha(t,e){var n=e[0],r=e[1],i,s;return n==="t"?s=t.y:n==="b"?s=t.y+t.height:s=t.y+t.height/2,r==="l"?i=t.x:r==="r"?i=t.x+t.width:i=t.x+t.width/2,{x:i,y:s}}function Es(t,e){var n={t:"b",b:"t",l:"r",r:"l"};return t.map(function(r,i){return i===e?n[r]||"c":r}).join("")}function Lee(t,e,n,r,i,s,o){var a=E.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:i[r]||{}}),c=Z(a,2),l=c[0],u=c[1],f=E.useRef(0),h=E.useMemo(function(){return e?Wv(e):[]},[e]),d=E.useRef({}),p=function(){d.current={}};t||p();var y=Vi(function(){if(e&&n&&t){let C=function(O,G){var X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ae,ge=D.x+O,Qe=D.y+G,gt=ge+he,Nt=Qe+ie,On=Math.max(ge,X.left),Mg=Math.max(Qe,X.top),Rg=Math.min(gt,X.right),Q=Math.min(Nt,X.bottom);return Math.max(0,(Rg-On)*(Q-Mg))},P=function(){Tn=D.y+oe,zr=Tn+ie,Oe=D.x+fe,ve=Oe+he};var m,_,A=e,S=A.ownerDocument,w=Ru(A),x=w.getComputedStyle(A),M=x.width,L=x.height,R=x.position,I=A.style.left,N=A.style.top,k=A.style.right,z=A.style.bottom,$=q(q({},i[r]),s),V=S.createElement("div");(m=A.parentElement)===null||m===void 0||m.appendChild(V),V.style.left="".concat(A.offsetLeft,"px"),V.style.top="".concat(A.offsetTop,"px"),V.style.position=R,V.style.height="".concat(A.offsetHeight,"px"),V.style.width="".concat(A.offsetWidth,"px"),A.style.left="0",A.style.top="0",A.style.right="auto",A.style.bottom="auto";var U;if(Array.isArray(n))U={x:n[0],y:n[1],width:0,height:0};else{var F=n.getBoundingClientRect();U={x:F.x,y:F.y,width:F.width,height:F.height}}var D=A.getBoundingClientRect(),W=S.documentElement,ee=W.clientWidth,te=W.clientHeight,pe=W.scrollWidth,Ae=W.scrollHeight,we=W.scrollTop,be=W.scrollLeft,ie=D.height,he=D.width,se=U.height,me=U.width,Ie={left:0,top:0,right:ee,bottom:te},Xe={left:-be,top:-we,right:pe-be,bottom:Ae-we},De=$.htmlRegion,Be="visible",xe="visibleFirst";De!=="scroll"&&De!==xe&&(De=Be);var Pe=De===xe,Ne=KC(Xe,h),ue=KC(Ie,h),ae=De===Be?ue:Ne,ce=Pe?ue:ae;A.style.left="auto",A.style.top="auto",A.style.right="0",A.style.bottom="0";var ne=A.getBoundingClientRect();A.style.left=I,A.style.top=N,A.style.right=k,A.style.bottom=z,(_=A.parentElement)===null||_===void 0||_.removeChild(V);var nt=au(Math.round(he/parseFloat(M)*1e3)/1e3),ft=au(Math.round(ie/parseFloat(L)*1e3)/1e3);if(nt===0||ft===0||bd(n)&&!tee(n))return;var Fi=$.offset,kr=$.targetOffset,Tt=qC(D,Fi),gr=Z(Tt,2),jt=gr[0],Ot=gr[1],Vt=qC(U,kr),St=Z(Vt,2),Ct=St[0],an=St[1];U.x-=Ct,U.y-=an;var ht=$.points||[],it=Z(ht,2),qt=it[0],pr=it[1],st=QC(pr),wt=QC(qt),He=ha(U,st),In=ha(D,wt),An=q({},$),fe=He.x-In.x+jt,oe=He.y-In.y+Ot,qe=C(fe,oe),je=C(fe,oe,ue),cn=ha(U,["t","l"]),mr=ha(D,["t","l"]),En=ha(U,["b","r"]),Ft=ha(D,["b","r"]),ln=$.overflow||{},Ur=ln.adjustX,un=ln.adjustY,xt=ln.shiftX,Gr=ln.shiftY,di=function(G){return typeof G=="boolean"?G:G>=0},Tn,zr,Oe,ve;P();var le=di(un),Je=wt[0]===st[0];if(le&&wt[0]==="t"&&(zr>ce.bottom||d.current.bt)){var Se=oe;Je?Se-=ie-se:Se=cn.y-Ft.y-Ot;var Dt=C(fe,Se),Ve=C(fe,Se,ue);Dt>qe||Dt===qe&&(!Pe||Ve>=je)?(d.current.bt=!0,oe=Se,Ot=-Ot,An.points=[Es(wt,0),Es(st,0)]):d.current.bt=!1}if(le&&wt[0]==="b"&&(Tn<ce.top||d.current.tb)){var dt=oe;Je?dt+=ie-se:dt=En.y-mr.y-Ot;var Sn=C(fe,dt),gi=C(fe,dt,ue);Sn>qe||Sn===qe&&(!Pe||gi>=je)?(d.current.tb=!0,oe=dt,Ot=-Ot,An.points=[Es(wt,0),Es(st,0)]):d.current.tb=!1}var Di=di(Ur),vr=wt[1]===st[1];if(Di&&wt[1]==="l"&&(ve>ce.right||d.current.rl)){var Ln=fe;vr?Ln-=he-me:Ln=cn.x-Ft.x-jt;var Qt=C(Ln,oe),pi=C(Ln,oe,ue);Qt>qe||Qt===qe&&(!Pe||pi>=je)?(d.current.rl=!0,fe=Ln,jt=-jt,An.points=[Es(wt,1),Es(st,1)]):d.current.rl=!1}if(Di&&wt[1]==="r"&&(Oe<ce.left||d.current.lr)){var fn=fe;vr?fn+=he-me:fn=En.x-mr.x-jt;var Zt=C(fn,oe),Hr=C(fn,oe,ue);Zt>qe||Zt===qe&&(!Pe||Hr>=je)?(d.current.lr=!0,fe=fn,jt=-jt,An.points=[Es(wt,1),Es(st,1)]):d.current.lr=!1}P();var Wt=xt===!0?0:xt;typeof Wt=="number"&&(Oe<ue.left&&(fe-=Oe-ue.left-jt,U.x+me<ue.left+Wt&&(fe+=U.x-ue.left+me-Wt)),ve>ue.right&&(fe-=ve-ue.right-jt,U.x>ue.right-Wt&&(fe+=U.x-ue.right+Wt)));var $t=Gr===!0?0:Gr;typeof $t=="number"&&(Tn<ue.top&&(oe-=Tn-ue.top-Ot,U.y+se<ue.top+$t&&(oe+=U.y-ue.top+se-$t)),zr>ue.bottom&&(oe-=zr-ue.bottom-Ot,U.y>ue.bottom-$t&&(oe+=U.y-ue.bottom+$t)));var jr=D.x+fe,mi=jr+he,Vr=D.y+oe,Xt=Vr+ie,Bn=U.x,Qs=Bn+me,fs=U.y,Zs=fs+se,hs=Math.max(jr,Bn),ds=Math.min(mi,Qs),Yn=(hs+ds)/2,xc=Yn-jr,eo=Math.max(Vr,fs),to=Math.min(Xt,Zs),qo=(eo+to)/2,Qo=qo-Vr;o==null||o(e,An);var Pc=ne.right-D.x-(fe+D.width),T=ne.bottom-D.y-(oe+D.height);u({ready:!0,offsetX:fe/nt,offsetY:oe/ft,offsetR:Pc/nt,offsetB:T/ft,arrowX:xc/nt,arrowY:Qo/ft,scaleX:nt,scaleY:ft,align:An})}}),b=function(){f.current+=1;var _=f.current;Promise.resolve().then(function(){f.current===_&&y()})},v=function(){u(function(_){return q(q({},_),{},{ready:!1})})};return xn(v,[r]),xn(function(){t||v()},[t]),[l.ready,l.offsetX,l.offsetY,l.offsetR,l.offsetB,l.arrowX,l.arrowY,l.scaleX,l.scaleY,l.align,b]}function Bee(t,e,n,r,i){xn(function(){if(t&&e&&n){let f=function(){r(),i()};var s=e,o=n,a=Wv(s),c=Wv(o),l=Ru(o),u=new Set([l].concat(It(a),It(c)));return u.forEach(function(h){h.addEventListener("scroll",f,{passive:!0})}),l.addEventListener("resize",f,{passive:!0}),r(),function(){u.forEach(function(h){h.removeEventListener("scroll",f),l.removeEventListener("resize",f)})}}},[t,e,n])}function Oee(t,e,n,r,i,s,o,a){var c=E.useRef(t),l=E.useRef(!1);c.current!==t&&(l.current=!0,c.current=t),E.useEffect(function(){var u=No(function(){l.current=!1});return function(){No.cancel(u)}},[t]),E.useEffect(function(){if(e&&r&&(!i||s)){var u=function(){var w=!1,x=function(R){var I=R.target;w=o(I)},M=function(R){var I=R.target;!l.current&&c.current&&!w&&!o(I)&&a(!1)};return[x,M]},f=u(),h=Z(f,2),d=h[0],p=h[1],y=u(),b=Z(y,2),v=b[0],m=b[1],_=Ru(r);_.addEventListener("mousedown",d,!0),_.addEventListener("click",p,!0),_.addEventListener("contextmenu",p,!0);var A=Vv(n);return A&&(A.addEventListener("mousedown",v,!0),A.addEventListener("click",m,!0),A.addEventListener("contextmenu",m,!0)),function(){_.removeEventListener("mousedown",d,!0),_.removeEventListener("click",p,!0),_.removeEventListener("contextmenu",p,!0),A&&(A.removeEventListener("mousedown",v,!0),A.removeEventListener("click",m,!0),A.removeEventListener("contextmenu",m,!0))}}},[e,n,r,i,s])}function Fee(t){var e=t.prefixCls,n=t.align,r=t.arrow,i=t.arrowPos,s=r||{},o=s.className,a=s.content,c=i.x,l=c===void 0?0:c,u=i.y,f=u===void 0?0:u,h=E.useRef();if(!n||!n.points)return null;var d={position:"absolute"};if(n.autoArrow!==!1){var p=n.points[0],y=n.points[1],b=p[0],v=p[1],m=y[0],_=y[1];b===m||!["t","b"].includes(b)?d.top=f:b==="t"?d.top=0:d.bottom=0,v===_||!["l","r"].includes(v)?d.left=l:v==="l"?d.left=0:d.right=0}return E.createElement("div",{ref:h,className:Lt("".concat(e,"-arrow"),o),style:d},a)}function Dee(t){var e=t.prefixCls,n=t.open,r=t.zIndex,i=t.mask,s=t.motion;return i?E.createElement(w1,Oi({},s,{motionAppear:!0,visible:n,removeOnLeave:!0}),function(o){var a=o.className;return E.createElement("div",{style:{zIndex:r},className:Lt("".concat(e,"-mask"),a)})}):null}var Nee=E.memo(function(t){var e=t.children;return e},function(t,e){return e.cache}),kee=E.forwardRef(function(t,e){var n=t.popup,r=t.className,i=t.prefixCls,s=t.style,o=t.target,a=t.onVisibleChanged,c=t.open,l=t.keepDom,u=t.fresh,f=t.onClick,h=t.mask,d=t.arrow,p=t.arrowPos,y=t.align,b=t.motion,v=t.maskMotion,m=t.forceRender,_=t.getPopupContainer,A=t.autoDestroy,S=t.portal,w=t.zIndex,x=t.onMouseEnter,M=t.onMouseLeave,L=t.onPointerEnter,R=t.ready,I=t.offsetX,N=t.offsetY,k=t.offsetR,z=t.offsetB,$=t.onAlign,V=t.onPrepare,U=t.stretch,F=t.targetWidth,D=t.targetHeight,W=typeof n=="function"?n():n,ee=c||l,te=(_==null?void 0:_.length)>0,pe=E.useState(!_||!te),Ae=Z(pe,2),we=Ae[0],be=Ae[1];if(xn(function(){!we&&te&&o&&be(!0)},[we,te,o]),!we)return null;var ie="auto",he={left:"-1000vw",top:"-1000vh",right:ie,bottom:ie};if(R||!c){var se,me=y.points,Ie=y.dynamicInset||((se=y._experimental)===null||se===void 0?void 0:se.dynamicInset),Xe=Ie&&me[0][1]==="r",De=Ie&&me[0][0]==="b";Xe?(he.right=k,he.left=ie):(he.left=I,he.right=ie),De?(he.bottom=z,he.top=ie):(he.top=N,he.bottom=ie)}var Be={};return U&&(U.includes("height")&&D?Be.height=D:U.includes("minHeight")&&D&&(Be.minHeight=D),U.includes("width")&&F?Be.width=F:U.includes("minWidth")&&F&&(Be.minWidth=F)),c||(Be.pointerEvents="none"),E.createElement(S,{open:m||ee,getContainer:_&&function(){return _(o)},autoDestroy:A},E.createElement(Dee,{prefixCls:i,open:c,zIndex:w,mask:h,motion:v}),E.createElement(m1,{onResize:$,disabled:!c},function(xe){return E.createElement(w1,Oi({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:m,leavedClassName:"".concat(i,"-hidden")},b,{onAppearPrepare:V,onEnterPrepare:V,visible:c,onVisibleChanged:function(Ne){var ue;b==null||(ue=b.onVisibleChanged)===null||ue===void 0||ue.call(b,Ne),a(Ne)}}),function(Pe,Ne){var ue=Pe.className,ae=Pe.style,ce=Lt(i,ue,r);return E.createElement("div",{ref:h1(xe,e,Ne),className:ce,style:q(q(q(q({"--arrow-x":"".concat(p.x||0,"px"),"--arrow-y":"".concat(p.y||0,"px")},he),Be),ae),{},{boxSizing:"border-box",zIndex:w},s),onMouseEnter:x,onMouseLeave:M,onPointerEnter:L,onClick:f},d&&E.createElement(Fee,{prefixCls:i,arrow:d,arrowPos:p,align:y}),E.createElement(Nee,{cache:!c&&!u},W))})}))}),Uee=E.forwardRef(function(t,e){var n=t.children,r=t.getTriggerDOMNode,i=Eg(n),s=E.useCallback(function(a){f1(e,r?r(a):a)},[r]),o=d1(s,n.ref);return i?E.cloneElement(n,{ref:o}):n}),Gee=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function zee(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oL,e=E.forwardRef(function(n,r){var i=n.prefixCls,s=i===void 0?"rc-trigger-popup":i,o=n.children,a=n.action,c=a===void 0?"hover":a,l=n.showAction,u=n.hideAction,f=n.popupVisible,h=n.defaultPopupVisible,d=n.onPopupVisibleChange,p=n.afterPopupVisibleChange,y=n.mouseEnterDelay,b=n.mouseLeaveDelay,v=b===void 0?.1:b,m=n.focusDelay,_=n.blurDelay,A=n.mask,S=n.maskClosable,w=S===void 0?!0:S,x=n.getPopupContainer,M=n.forceRender,L=n.autoDestroy,R=n.destroyPopupOnHide,I=n.popup,N=n.popupClassName,k=n.popupStyle,z=n.popupPlacement,$=n.builtinPlacements,V=$===void 0?{}:$,U=n.popupAlign,F=n.zIndex,D=n.stretch,W=n.getPopupClassNameFromAlign,ee=n.fresh,te=n.alignPoint,pe=n.onPopupClick,Ae=n.onPopupAlign,we=n.arrow,be=n.popupMotion,ie=n.maskMotion,he=n.popupTransitionName,se=n.popupAnimation,me=n.maskTransitionName,Ie=n.maskAnimation,Xe=n.className,De=n.getTriggerDOMNode,Be=ko(n,Gee),xe=L||R||!1,Pe=E.useState(!1),Ne=Z(Pe,2),ue=Ne[0],ae=Ne[1];xn(function(){ae(Pee())},[]);var ce=E.useRef({}),ne=E.useContext($C),nt=E.useMemo(function(){return{registerSubPopup:function(ye,pt){ce.current[ye]=pt,ne==null||ne.registerSubPopup(ye,pt)}}},[ne]),ft=hee(),Fi=E.useState(null),kr=Z(Fi,2),Tt=kr[0],gr=kr[1],jt=Vi(function(Q){bd(Q)&&Tt!==Q&&gr(Q),ne==null||ne.registerSubPopup(ft,Q)}),Ot=E.useState(null),Vt=Z(Ot,2),St=Vt[0],Ct=Vt[1],an=Vi(function(Q){bd(Q)&&St!==Q&&Ct(Q)}),ht=E.Children.only(o),it=(ht==null?void 0:ht.props)||{},qt={},pr=Vi(function(Q){var ye,pt,kt=St;return(kt==null?void 0:kt.contains(Q))||((ye=Vv(kt))===null||ye===void 0?void 0:ye.host)===Q||Q===kt||(Tt==null?void 0:Tt.contains(Q))||((pt=Vv(Tt))===null||pt===void 0?void 0:pt.host)===Q||Q===Tt||Object.values(ce.current).some(function(mt){return(mt==null?void 0:mt.contains(Q))||Q===mt})}),st=JC(s,be,se,he),wt=JC(s,ie,Ie,me),He=E.useState(h||!1),In=Z(He,2),An=In[0],fe=In[1],oe=f??An,qe=Vi(function(Q){f===void 0&&fe(Q)});xn(function(){fe(f||!1)},[f]);var je=E.useRef(oe);je.current=oe;var cn=Vi(function(Q){Tc.flushSync(function(){oe!==Q&&(qe(Q),d==null||d(Q))})}),mr=E.useRef(),En=function(){clearTimeout(mr.current)},Ft=function(ye){var pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;En(),pt===0?cn(ye):mr.current=setTimeout(function(){cn(ye)},pt*1e3)};E.useEffect(function(){return En},[]);var ln=E.useState(!1),Ur=Z(ln,2),un=Ur[0],xt=Ur[1];xn(function(Q){(!Q||oe)&&xt(!0)},[oe]);var Gr=E.useState(null),di=Z(Gr,2),Tn=di[0],zr=di[1],Oe=E.useState([0,0]),ve=Z(Oe,2),le=ve[0],Je=ve[1],Se=function(ye){Je([ye.clientX,ye.clientY])},Dt=Lee(oe,Tt,te?le:St,z,V,U,Ae),Ve=Z(Dt,11),dt=Ve[0],Sn=Ve[1],gi=Ve[2],Di=Ve[3],vr=Ve[4],Ln=Ve[5],Qt=Ve[6],pi=Ve[7],fn=Ve[8],Zt=Ve[9],Hr=Ve[10],Wt=Mee(ue,c,l,u),$t=Z(Wt,2),jr=$t[0],mi=$t[1],Vr=jr.has("click"),Xt=mi.has("click")||mi.has("contextMenu"),Bn=Vi(function(){un||Hr()}),Qs=function(){je.current&&te&&Xt&&Ft(!1)};Bee(oe,St,Tt,Bn,Qs),xn(function(){Bn()},[le,z]),xn(function(){oe&&!(V!=null&&V[z])&&Bn()},[JSON.stringify(U)]);var fs=E.useMemo(function(){var Q=Iee(V,s,Zt,te);return Lt(Q,W==null?void 0:W(Zt))},[Zt,W,V,s,te]);E.useImperativeHandle(r,function(){return{forceAlign:Bn}});var Zs=E.useState(0),hs=Z(Zs,2),ds=hs[0],Yn=hs[1],xc=E.useState(0),eo=Z(xc,2),to=eo[0],qo=eo[1],Qo=function(){if(D&&St){var ye=St.getBoundingClientRect();Yn(ye.width),qo(ye.height)}},Pc=function(){Qo(),Bn()},T=function(ye){xt(!1),Hr(),p==null||p(ye)},C=function(){return new Promise(function(ye){Qo(),zr(function(){return ye})})};xn(function(){Tn&&(Hr(),Tn(),zr(null))},[Tn]);function P(Q,ye,pt,kt){qt[Q]=function(mt){var Iu;kt==null||kt(mt),Ft(ye,pt);for(var Ig=arguments.length,M1=new Array(Ig>1?Ig-1:0),Lu=1;Lu<Ig;Lu++)M1[Lu-1]=arguments[Lu];(Iu=it[Q])===null||Iu===void 0||Iu.call.apply(Iu,[it,mt].concat(M1))}}(Vr||Xt)&&(qt.onClick=function(Q){var ye;je.current&&Xt?Ft(!1):!je.current&&Vr&&(Se(Q),Ft(!0));for(var pt=arguments.length,kt=new Array(pt>1?pt-1:0),mt=1;mt<pt;mt++)kt[mt-1]=arguments[mt];(ye=it.onClick)===null||ye===void 0||ye.call.apply(ye,[it,Q].concat(kt))}),Oee(oe,Xt,St,Tt,A,w,pr,Ft);var O=jr.has("hover"),G=mi.has("hover"),X,ge;O&&(P("onMouseEnter",!0,y,function(Q){Se(Q)}),P("onPointerEnter",!0,y,function(Q){Se(Q)}),X=function(){(oe||un)&&Ft(!0,y)},te&&(qt.onMouseMove=function(Q){var ye;(ye=it.onMouseMove)===null||ye===void 0||ye.call(it,Q)})),G&&(P("onMouseLeave",!1,v),P("onPointerLeave",!1,v),ge=function(){Ft(!1,v)}),jr.has("focus")&&P("onFocus",!0,m),mi.has("focus")&&P("onBlur",!1,_),jr.has("contextMenu")&&(qt.onContextMenu=function(Q){var ye;je.current&&mi.has("contextMenu")?Ft(!1):(Se(Q),Ft(!0)),Q.preventDefault();for(var pt=arguments.length,kt=new Array(pt>1?pt-1:0),mt=1;mt<pt;mt++)kt[mt-1]=arguments[mt];(ye=it.onContextMenu)===null||ye===void 0||ye.call.apply(ye,[it,Q].concat(kt))}),Xe&&(qt.className=Lt(it.className,Xe));var Qe=q(q({},it),qt),gt={},Nt=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];Nt.forEach(function(Q){Be[Q]&&(gt[Q]=function(){for(var ye,pt=arguments.length,kt=new Array(pt),mt=0;mt<pt;mt++)kt[mt]=arguments[mt];(ye=Qe[Q])===null||ye===void 0||ye.call.apply(ye,[Qe].concat(kt)),Be[Q].apply(Be,kt)})});var On=E.cloneElement(ht,q(q({},Qe),gt)),Mg={x:Ln,y:Qt},Rg=we?q({},we!==!0?we:{}):null;return E.createElement(E.Fragment,null,E.createElement(m1,{disabled:!oe,ref:an,onResize:Pc},E.createElement(Uee,{getTriggerDOMNode:De},On)),E.createElement($C.Provider,{value:nt},E.createElement(kee,{portal:t,ref:jt,prefixCls:s,popup:I,className:Lt(N,fs),style:k,target:St,onMouseEnter:X,onMouseLeave:ge,onPointerEnter:X,zIndex:F,open:oe,keepDom:un,fresh:ee,onClick:pe,mask:A,motion:st,maskMotion:wt,onVisibleChanged:T,onPrepare:C,forceRender:M,autoDestroy:xe,getPopupContainer:x,align:Zt,arrow:Rg,arrowPos:Mg,ready:dt,offsetX:Sn,offsetY:gi,offsetR:Di,offsetB:vr,onAlign:Bn,stretch:D,targetWidth:ds/pi,targetHeight:to/fn})))});return e}const Hee=zee(oL);function aL(t){var e=t.children,n=t.prefixCls,r=t.id,i=t.overlayInnerStyle,s=t.className,o=t.style;return E.createElement("div",{className:Lt("".concat(n,"-content"),s),style:o},E.createElement("div",{className:"".concat(n,"-inner"),id:r,role:"tooltip",style:i},typeof e=="function"?e():e))}var da={shiftX:64,adjustY:1},ga={adjustX:1,shiftY:!0},yr=[0,0],jee={left:{points:["cr","cl"],overflow:ga,offset:[-4,0],targetOffset:yr},right:{points:["cl","cr"],overflow:ga,offset:[4,0],targetOffset:yr},top:{points:["bc","tc"],overflow:da,offset:[0,-4],targetOffset:yr},bottom:{points:["tc","bc"],overflow:da,offset:[0,4],targetOffset:yr},topLeft:{points:["bl","tl"],overflow:da,offset:[0,-4],targetOffset:yr},leftTop:{points:["tr","tl"],overflow:ga,offset:[-4,0],targetOffset:yr},topRight:{points:["br","tr"],overflow:da,offset:[0,-4],targetOffset:yr},rightTop:{points:["tl","tr"],overflow:ga,offset:[4,0],targetOffset:yr},bottomRight:{points:["tr","br"],overflow:da,offset:[0,4],targetOffset:yr},rightBottom:{points:["bl","br"],overflow:ga,offset:[4,0],targetOffset:yr},bottomLeft:{points:["tl","bl"],overflow:da,offset:[0,4],targetOffset:yr},leftBottom:{points:["br","bl"],overflow:ga,offset:[-4,0],targetOffset:yr}},Vee=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],Wee=function(e,n){var r=e.overlayClassName,i=e.trigger,s=i===void 0?["hover"]:i,o=e.mouseEnterDelay,a=o===void 0?0:o,c=e.mouseLeaveDelay,l=c===void 0?.1:c,u=e.overlayStyle,f=e.prefixCls,h=f===void 0?"rc-tooltip":f,d=e.children,p=e.onVisibleChange,y=e.afterVisibleChange,b=e.transitionName,v=e.animation,m=e.motion,_=e.placement,A=_===void 0?"right":_,S=e.align,w=S===void 0?{}:S,x=e.destroyTooltipOnHide,M=x===void 0?!1:x,L=e.defaultVisible,R=e.getTooltipContainer,I=e.overlayInnerStyle;e.arrowContent;var N=e.overlay,k=e.id,z=e.showArrow,$=z===void 0?!0:z,V=ko(e,Vee),U=E.useRef(null);E.useImperativeHandle(n,function(){return U.current});var F=q({},V);"visible"in e&&(F.popupVisible=e.visible);var D=function(){return E.createElement(aL,{key:"content",prefixCls:h,id:k,overlayInnerStyle:I},N)};return E.createElement(Hee,Oi({popupClassName:r,prefixCls:h,popup:D,action:s,builtinPlacements:jee,popupPlacement:A,ref:U,popupAlign:w,getPopupContainer:R,onPopupVisibleChange:p,afterPopupVisibleChange:y,popupTransitionName:b,popupAnimation:v,popupMotion:m,defaultPopupVisible:L,autoDestroy:M,mouseLeaveDelay:l,popupStyle:u,mouseEnterDelay:a,arrow:$},F),d)};const $ee=E.forwardRef(Wee),cL=8;function lL(t){const e=cL,{contentRadius:n,limitVerticalRadius:r}=t,i=n>12?n+2:12;return{dropdownArrowOffset:i,dropdownArrowOffsetVertical:r?e:i}}function jf(t,e){return t?e:{}}function Xee(t,e){const{componentCls:n,sizePopupArrow:r,borderRadiusXS:i,borderRadiusOuter:s,boxShadowPopoverArrow:o}=t,{colorBg:a,contentRadius:c=t.borderRadiusLG,limitVerticalRadius:l,arrowDistance:u=0,arrowPlacement:f={left:!0,right:!0,top:!0,bottom:!0}}=e,{dropdownArrowOffsetVertical:h,dropdownArrowOffset:d}=lL({contentRadius:c,limitVerticalRadius:l});return{[n]:Object.assign(Object.assign(Object.assign(Object.assign({[`${n}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},hZ(r,i,s,a,o)),{"&:before":{background:a}})]},jf(!!f.top,{[[`&-placement-top ${n}-arrow`,`&-placement-topLeft ${n}-arrow`,`&-placement-topRight ${n}-arrow`].join(",")]:{bottom:u,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top ${n}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft ${n}-arrow`]:{left:{_skip_check_:!0,value:d}},[`&-placement-topRight ${n}-arrow`]:{right:{_skip_check_:!0,value:d}}})),jf(!!f.bottom,{[[`&-placement-bottom ${n}-arrow`,`&-placement-bottomLeft ${n}-arrow`,`&-placement-bottomRight ${n}-arrow`].join(",")]:{top:u,transform:"translateY(-100%)"},[`&-placement-bottom ${n}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft ${n}-arrow`]:{left:{_skip_check_:!0,value:d}},[`&-placement-bottomRight ${n}-arrow`]:{right:{_skip_check_:!0,value:d}}})),jf(!!f.left,{[[`&-placement-left ${n}-arrow`,`&-placement-leftTop ${n}-arrow`,`&-placement-leftBottom ${n}-arrow`].join(",")]:{right:{_skip_check_:!0,value:u},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left ${n}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop ${n}-arrow`]:{top:h},[`&-placement-leftBottom ${n}-arrow`]:{bottom:h}})),jf(!!f.right,{[[`&-placement-right ${n}-arrow`,`&-placement-rightTop ${n}-arrow`,`&-placement-rightBottom ${n}-arrow`].join(",")]:{left:{_skip_check_:!0,value:u},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right ${n}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop ${n}-arrow`]:{top:h},[`&-placement-rightBottom ${n}-arrow`]:{bottom:h}}))}}function Jee(t,e,n,r){if(r===!1)return{adjustX:!1,adjustY:!1};const i=r&&typeof r=="object"?r:{},s={};switch(t){case"top":case"bottom":s.shiftX=e.dropdownArrowOffset*2+n,s.shiftY=!0,s.adjustY=!0;break;case"left":case"right":s.shiftY=e.dropdownArrowOffsetVertical*2+n,s.shiftX=!0,s.adjustX=!0;break}const o=Object.assign(Object.assign({},s),i);return o.shiftX||(o.adjustX=!0),o.shiftY||(o.adjustY=!0),o}const ZC={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},Kee={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},Yee=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function qee(t){const{arrowWidth:e,autoAdjustOverflow:n,arrowPointAtCenter:r,offset:i,borderRadius:s,visibleFirst:o}=t,a=e/2,c={};return Object.keys(ZC).forEach(l=>{const u=r&&Kee[l]||ZC[l],f=Object.assign(Object.assign({},u),{offset:[0,0],dynamicInset:!0});switch(c[l]=f,Yee.has(l)&&(f.autoArrow=!1),l){case"top":case"topLeft":case"topRight":f.offset[1]=-a-i;break;case"bottom":case"bottomLeft":case"bottomRight":f.offset[1]=a+i;break;case"left":case"leftTop":case"leftBottom":f.offset[0]=-a-i;break;case"right":case"rightTop":case"rightBottom":f.offset[0]=a+i;break}const h=lL({contentRadius:s,limitVerticalRadius:!0});if(r)switch(l){case"topLeft":case"bottomLeft":f.offset[0]=-h.dropdownArrowOffset-a;break;case"topRight":case"bottomRight":f.offset[0]=h.dropdownArrowOffset+a;break;case"leftTop":case"rightTop":f.offset[1]=-h.dropdownArrowOffset-a;break;case"leftBottom":case"rightBottom":f.offset[1]=h.dropdownArrowOffset+a;break}f.overflow=Jee(l,h,e,n),o&&(f.htmlRegion="visibleFirst")}),c}const Qee=t=>{const{componentCls:e,tooltipMaxWidth:n,tooltipColor:r,tooltipBg:i,tooltipBorderRadius:s,zIndexPopup:o,controlHeight:a,boxShadowSecondary:c,paddingSM:l,paddingXS:u,tooltipRadiusOuter:f}=t;return[{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},j2(t)),{position:"absolute",zIndex:o,display:"block",width:"max-content",maxWidth:n,visibility:"visible",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","&-hidden":{display:"none"},"--antd-arrow-background-color":i,[`${e}-inner`]:{minWidth:a,minHeight:a,padding:`${l/2}px ${u}px`,color:r,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:i,borderRadius:s,boxShadow:c,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${e}-inner`]:{borderRadius:Math.min(s,cL)}},[`${e}-content`]:{position:"relative"}}),_Z(t,(h,d)=>{let{darkColor:p}=d;return{[`&${e}-${h}`]:{[`${e}-inner`]:{backgroundColor:p},[`${e}-arrow`]:{"--antd-arrow-background-color":p}}}})),{"&-rtl":{direction:"rtl"}})},Xee(ou(t,{borderRadiusOuter:f}),{colorBg:"var(--antd-arrow-background-color)",contentRadius:s,limitVerticalRadius:!0}),{[`${e}-pure`]:{position:"relative",maxWidth:"none",margin:t.sizePopupArrow}}]},uL=(t,e)=>$2("Tooltip",r=>{if(e===!1)return[];const{borderRadius:i,colorTextLightSolid:s,colorBgDefault:o,borderRadiusOuter:a}=r,c=ou(r,{tooltipMaxWidth:250,tooltipColor:s,tooltipBorderRadius:i,tooltipBg:o,tooltipRadiusOuter:a>4?4:a});return[Qee(c),xee(r,"zoom-big-fast")]},r=>{let{zIndexPopupBase:i,colorBgSpotlight:s}=r;return{zIndexPopup:i+70,colorBgDefault:s}},{resetStyle:!1})(t),Zee=wd.map(t=>`${t}-inverse`);function ete(t){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(It(Zee),It(wd)).includes(t):wd.includes(t)}function fL(t,e){const n=ete(e),r=Lt({[`${t}-${e}`]:e&&n}),i={},s={};return e&&!n&&(i.background=e,s["--antd-arrow-background-color"]=e),{className:r,overlayStyle:i,arrowStyle:s}}const tte=t=>{const{prefixCls:e,className:n,placement:r="top",title:i,color:s,overlayInnerStyle:o}=t,{getPrefixCls:a}=E.useContext(Ko),c=a("tooltip",e),[l,u]=uL(c,!0),f=fL(c,s),h=f.arrowStyle,d=Object.assign(Object.assign({},o),f.overlayStyle),p=Lt(u,c,`${c}-pure`,`${c}-placement-${r}`,n,f.className);return l(E.createElement("div",{className:p,style:h},E.createElement("div",{className:`${c}-arrow`}),E.createElement(aL,Object.assign({},t,{className:u,prefixCls:c,overlayInnerStyle:d}),i)))},nte=tte;var rte=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const hL=E.forwardRef((t,e)=>{var n,r;const{prefixCls:i,openClassName:s,getTooltipContainer:o,overlayClassName:a,color:c,overlayInnerStyle:l,children:u,afterOpenChange:f,afterVisibleChange:h,destroyTooltipOnHide:d,arrow:p=!0,title:y,overlay:b,builtinPlacements:v,arrowPointAtCenter:m=!1,autoAdjustOverflow:_=!0}=t,A=!!p,[,S]=Pg(),{getPopupContainer:w,getPrefixCls:x,direction:M}=E.useContext(Ko),L=pQ(),R=E.useRef(null),I=()=>{var ae;(ae=R.current)===null||ae===void 0||ae.forceAlign()};E.useImperativeHandle(e,()=>({forceAlign:I,forcePopupAlign:()=>{L.deprecated(!1,"forcePopupAlign","forceAlign"),I()}}));const[N,k]=H2(!1,{value:(n=t.open)!==null&&n!==void 0?n:t.visible,defaultValue:(r=t.defaultOpen)!==null&&r!==void 0?r:t.defaultVisible}),z=!y&&!b&&y!==0,$=ae=>{var ce,ne;k(z?!1:ae),z||((ce=t.onOpenChange)===null||ce===void 0||ce.call(t,ae),(ne=t.onVisibleChange)===null||ne===void 0||ne.call(t,ae))},V=E.useMemo(()=>{var ae,ce;let ne=m;return typeof p=="object"&&(ne=(ce=(ae=p.pointAtCenter)!==null&&ae!==void 0?ae:p.arrowPointAtCenter)!==null&&ce!==void 0?ce:m),v||qee({arrowPointAtCenter:ne,autoAdjustOverflow:_,arrowWidth:A?S.sizePopupArrow:0,borderRadius:S.borderRadius,offset:S.marginXXS,visibleFirst:!0})},[m,p,v,S]),U=E.useMemo(()=>y===0?y:b||y||"",[b,y]),F=E.createElement(ree,null,typeof U=="function"?U():U),{getPopupContainer:D,placement:W="top",mouseEnterDelay:ee=.1,mouseLeaveDelay:te=.1,overlayStyle:pe,rootClassName:Ae}=t,we=rte(t,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),be=x("tooltip",i),ie=x(),he=t["data-popover-inject"];let se=N;!("open"in t)&&!("visible"in t)&&z&&(se=!1);const me=x1(u)&&!qZ(u)?u:E.createElement("span",null,u),Ie=me.props,Xe=!Ie.className||typeof Ie.className=="string"?Lt(Ie.className,s||`${be}-open`):Ie.className,[De,Be]=uL(be,!he),xe=fL(be,c),Pe=xe.arrowStyle,Ne=Object.assign(Object.assign({},l),xe.overlayStyle),ue=Lt(a,{[`${be}-rtl`]:M==="rtl"},xe.className,Ae,Be);return De(E.createElement($ee,Object.assign({},we,{showArrow:A,placement:W,mouseEnterDelay:ee,mouseLeaveDelay:te,prefixCls:be,overlayClassName:ue,overlayStyle:Object.assign(Object.assign({},Pe),pe),getTooltipContainer:D||o||w,ref:R,builtinPlacements:V,overlay:F,visible:se,onVisibleChange:$,afterVisibleChange:f??h,overlayInnerStyle:Ne,arrowContent:E.createElement("span",{className:`${be}-arrow-content`}),motion:{motionName:eee(ie,"zoom-big-fast",t.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!d}),se?ZZ(me,{className:Xe}):me))});hL._InternalPanelDoNotUseOrYouWillBeFired=nte;const ite=hL;var Yo=E.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}});function $v(t,e,n){return(t-e)/(n-e)}function P1(t,e,n,r){var i=$v(e,n,r),s={};switch(t){case"rtl":s.right="".concat(i*100,"%"),s.transform="translateX(50%)";break;case"btt":s.bottom="".concat(i*100,"%"),s.transform="translateY(50%)";break;case"ttb":s.top="".concat(i*100,"%"),s.transform="translateY(-50%)";break;default:s.left="".concat(i*100,"%"),s.transform="translateX(-50%)";break}return s}function Ua(t,e){return Array.isArray(t)?t[e]:t}var ste=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange"],ote=E.forwardRef(function(t,e){var n,r,i=t.prefixCls,s=t.value,o=t.valueIndex,a=t.onStartMove,c=t.style,l=t.render,u=t.dragging,f=t.onOffsetChange,h=ko(t,ste),d=E.useContext(Yo),p=d.min,y=d.max,b=d.direction,v=d.disabled,m=d.keyboard,_=d.range,A=d.tabIndex,S=d.ariaLabelForHandle,w=d.ariaLabelledByForHandle,x=d.ariaValueTextFormatterForHandle,M=d.styles,L=d.classNames,R="".concat(i,"-handle"),I=function(V){v||a(V,o)},N=function(V){if(!v&&m){var U=null;switch(V.which||V.keyCode){case re.LEFT:U=b==="ltr"||b==="btt"?-1:1;break;case re.RIGHT:U=b==="ltr"||b==="btt"?1:-1;break;case re.UP:U=b!=="ttb"?1:-1;break;case re.DOWN:U=b!=="ttb"?-1:1;break;case re.HOME:U="min";break;case re.END:U="max";break;case re.PAGE_UP:U=2;break;case re.PAGE_DOWN:U=-2;break}U!==null&&(V.preventDefault(),f(U,o))}},k=P1(b,s,p,y),z=E.createElement("div",Oi({ref:e,className:Lt(R,(n={},g(n,"".concat(R,"-").concat(o+1),_),g(n,"".concat(R,"-dragging"),u),n),L.handle),style:q(q(q({},k),c),M.handle),onMouseDown:I,onTouchStart:I,onKeyDown:N,tabIndex:v?null:Ua(A,o),role:"slider","aria-valuemin":p,"aria-valuemax":y,"aria-valuenow":s,"aria-disabled":v,"aria-label":Ua(S,o),"aria-labelledby":Ua(w,o),"aria-valuetext":(r=Ua(x,o))===null||r===void 0?void 0:r(s),"aria-orientation":b==="ltr"||b==="rtl"?"horizontal":"vertical"},h));return l&&(z=l(z,{index:o,prefixCls:i,value:s,dragging:u})),z}),ate=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","draggingIndex"],cte=E.forwardRef(function(t,e){var n=t.prefixCls,r=t.style,i=t.onStartMove,s=t.onOffsetChange,o=t.values,a=t.handleRender,c=t.draggingIndex,l=ko(t,ate),u=E.useRef({});return E.useImperativeHandle(e,function(){return{focus:function(h){var d;(d=u.current[h])===null||d===void 0||d.focus()}}}),E.createElement(E.Fragment,null,o.map(function(f,h){return E.createElement(ote,Oi({ref:function(p){p?u.current[h]=p:delete u.current[h]},dragging:c===h,prefixCls:n,style:Ua(r,h),key:h,value:f,valueIndex:h,onStartMove:i,onOffsetChange:s,render:a},l))}))});function ew(t){var e="touches"in t?t.touches[0]:t;return{pageX:e.pageX,pageY:e.pageY}}function lte(t,e,n,r,i,s,o,a,c){var l=E.useState(null),u=Z(l,2),f=u[0],h=u[1],d=E.useState(-1),p=Z(d,2),y=p[0],b=p[1],v=E.useState(n),m=Z(v,2),_=m[0],A=m[1],S=E.useState(n),w=Z(S,2),x=w[0],M=w[1],L=E.useRef(null),R=E.useRef(null);E.useEffect(function(){y===-1&&A(n)},[n,y]),E.useEffect(function(){return function(){document.removeEventListener("mousemove",L.current),document.removeEventListener("mouseup",R.current),document.removeEventListener("touchmove",L.current),document.removeEventListener("touchend",R.current)}},[]);var I=function(U,F){_.some(function(D,W){return D!==U[W]})&&(F!==void 0&&h(F),A(U),o(U))},N=function(U,F){if(U===-1){var D=x[0],W=x[x.length-1],ee=r-D,te=i-W,pe=F*(i-r);pe=Math.max(pe,ee),pe=Math.min(pe,te);var Ae=s(D+pe);pe=Ae-D;var we=x.map(function(se){return se+pe});I(we)}else{var be=(i-r)*F,ie=It(_);ie[U]=x[U];var he=c(ie,be,U,"dist");I(he.values,he.value)}},k=E.useRef(N);k.current=N;var z=function(U,F){U.stopPropagation();var D=n[F];b(F),h(D),M(n);var W=ew(U),ee=W.pageX,te=W.pageY,pe=function(be){be.preventDefault();var ie=ew(be),he=ie.pageX,se=ie.pageY,me=he-ee,Ie=se-te,Xe=t.current.getBoundingClientRect(),De=Xe.width,Be=Xe.height,xe;switch(e){case"btt":xe=-Ie/Be;break;case"ttb":xe=Ie/Be;break;case"rtl":xe=-me/De;break;default:xe=me/De}k.current(F,xe)},Ae=function we(be){be.preventDefault(),document.removeEventListener("mouseup",we),document.removeEventListener("mousemove",pe),document.removeEventListener("touchend",we),document.removeEventListener("touchmove",pe),L.current=null,R.current=null,b(-1),a()};document.addEventListener("mouseup",Ae),document.addEventListener("mousemove",pe),document.addEventListener("touchend",Ae),document.addEventListener("touchmove",pe),L.current=pe,R.current=Ae},$=E.useMemo(function(){var V=It(n).sort(function(F,D){return F-D}),U=It(_).sort(function(F,D){return F-D});return V.every(function(F,D){return F===U[D]})?_:n},[n,_]);return[y,f,$,z]}function ute(t,e,n,r,i,s){var o=E.useCallback(function(d){var p=isFinite(d)?d:t;return p=Math.min(e,d),p=Math.max(t,p),p},[t,e]),a=E.useCallback(function(d){if(n!==null){var p=t+Math.round((o(d)-t)/n)*n,y=function(_){return(String(_).split(".")[1]||"").length},b=Math.max(y(n),y(e),y(t)),v=Number(p.toFixed(b));return t<=v&&v<=e?v:null}return null},[n,t,e,o]),c=E.useCallback(function(d){var p=o(d),y=r.map(function(m){return m.value});n!==null&&y.push(a(d)),y.push(t,e);var b=y[0],v=e-t;return y.forEach(function(m){var _=Math.abs(p-m);_<=v&&(b=m,v=_)}),b},[t,e,r,n,o,a]),l=function d(p,y,b){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof y=="number"){var m,_=p[b],A=_+y,S=[];r.forEach(function(R){S.push(R.value)}),S.push(t,e),S.push(a(_));var w=y>0?1:-1;v==="unit"?S.push(a(_+w*n)):S.push(a(A)),S=S.filter(function(R){return R!==null}).filter(function(R){return y<0?R<=_:R>=_}),v==="unit"&&(S=S.filter(function(R){return R!==_}));var x=v==="unit"?_:A;m=S[0];var M=Math.abs(m-x);if(S.forEach(function(R){var I=Math.abs(R-x);I<M&&(m=R,M=I)}),m===void 0)return y<0?t:e;if(v==="dist")return m;if(Math.abs(y)>1){var L=It(p);return L[b]=m,d(L,y-w,b,v)}return m}else{if(y==="min")return t;if(y==="max")return e}},u=function(p,y,b){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",m=p[b],_=l(p,y,b,v);return{value:_,changed:_!==m}},f=function(p){return s===null&&p===0||typeof s=="number"&&p<s},h=function(p,y,b){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",m=p.map(c),_=m[b],A=l(m,y,b,v);if(m[b]=A,i===!1){var S=s||0;b>0&&m[b-1]!==_&&(m[b]=Math.max(m[b],m[b-1]+S)),b<m.length-1&&m[b+1]!==_&&(m[b]=Math.min(m[b],m[b+1]-S))}else if(typeof s=="number"||s===null){for(var w=b+1;w<m.length;w+=1)for(var x=!0;f(m[w]-m[w-1])&&x;){var M=u(m,1,w);m[w]=M.value,x=M.changed}for(var L=b;L>0;L-=1)for(var R=!0;f(m[L]-m[L-1])&&R;){var I=u(m,-1,L-1);m[L-1]=I.value,R=I.changed}for(var N=m.length-1;N>0;N-=1)for(var k=!0;f(m[N]-m[N-1])&&k;){var z=u(m,-1,N-1);m[N-1]=z.value,k=z.changed}for(var $=0;$<m.length-1;$+=1)for(var V=!0;f(m[$+1]-m[$])&&V;){var U=u(m,1,$+1);m[$+1]=U.value,V=U.changed}}return{value:m[b],values:m}};return[c,h]}function fte(t){var e=t.prefixCls,n=t.style,r=t.children,i=t.value,s=t.onClick,o=E.useContext(Yo),a=o.min,c=o.max,l=o.direction,u=o.includedStart,f=o.includedEnd,h=o.included,d="".concat(e,"-text"),p=P1(l,i,a,c);return E.createElement("span",{className:Lt(d,g({},"".concat(d,"-active"),h&&u<=i&&i<=f)),style:q(q({},p),n),onMouseDown:function(b){b.stopPropagation()},onClick:function(){s(i)}},r)}function hte(t){var e=t.prefixCls,n=t.marks,r=t.onClick,i="".concat(e,"-mark");return n.length?E.createElement("div",{className:i},n.map(function(s){var o=s.value,a=s.style,c=s.label;return E.createElement(fte,{key:o,prefixCls:i,style:a,value:o,onClick:r},c)})):null}function dte(t){var e=t.prefixCls,n=t.value,r=t.style,i=t.activeStyle,s=E.useContext(Yo),o=s.min,a=s.max,c=s.direction,l=s.included,u=s.includedStart,f=s.includedEnd,h="".concat(e,"-dot"),d=l&&u<=n&&n<=f,p=q(q({},P1(c,n,o,a)),typeof r=="function"?r(n):r);return d&&(p=q(q({},p),typeof i=="function"?i(n):i)),E.createElement("span",{className:Lt(h,g({},"".concat(h,"-active"),d)),style:p})}function gte(t){var e=t.prefixCls,n=t.marks,r=t.dots,i=t.style,s=t.activeStyle,o=E.useContext(Yo),a=o.min,c=o.max,l=o.step,u=E.useMemo(function(){var f=new Set;if(n.forEach(function(d){f.add(d.value)}),r&&l!==null)for(var h=a;h<=c;)f.add(h),h+=l;return Array.from(f)},[a,c,l,r,n]);return E.createElement("div",{className:"".concat(e,"-step")},u.map(function(f){return E.createElement(dte,{prefixCls:e,key:f,value:f,style:i,activeStyle:s})}))}function tw(t){var e,n=t.prefixCls,r=t.style,i=t.start,s=t.end,o=t.index,a=t.onStartMove,c=t.replaceCls,l=E.useContext(Yo),u=l.direction,f=l.min,h=l.max,d=l.disabled,p=l.range,y=l.classNames,b="".concat(n,"-track"),v=$v(i,f,h),m=$v(s,f,h),_=function(x){!d&&a&&a(x,-1)},A={};switch(u){case"rtl":A.right="".concat(v*100,"%"),A.width="".concat(m*100-v*100,"%");break;case"btt":A.bottom="".concat(v*100,"%"),A.height="".concat(m*100-v*100,"%");break;case"ttb":A.top="".concat(v*100,"%"),A.height="".concat(m*100-v*100,"%");break;default:A.left="".concat(v*100,"%"),A.width="".concat(m*100-v*100,"%")}var S=c||Lt(b,(e={},g(e,"".concat(b,"-").concat(o+1),o!==null&&p),g(e,"".concat(n,"-track-draggable"),a),e),y.track);return E.createElement("div",{className:S,style:q(q({},A),r),onMouseDown:_,onTouchStart:_})}function pte(t){var e=t.prefixCls,n=t.style,r=t.values,i=t.startPoint,s=t.onStartMove,o=E.useContext(Yo),a=o.included,c=o.range,l=o.min,u=o.styles,f=o.classNames,h=E.useMemo(function(){if(!c){if(r.length===0)return[];var p=i??l,y=r[0];return[{start:Math.min(p,y),end:Math.max(p,y)}]}for(var b=[],v=0;v<r.length-1;v+=1)b.push({start:r[v],end:r[v+1]});return b},[r,c,i,l]),d=null;return(f.tracks||u.tracks)&&(d=E.createElement(tw,{index:null,prefixCls:e,start:h[0].start,end:h[h.length-1].end,replaceCls:Lt(f.tracks,"".concat(e,"-tracks")),style:u.tracks})),a?E.createElement(E.Fragment,null,d,h.map(function(p,y){var b=p.start,v=p.end;return E.createElement(tw,{index:y,prefixCls:e,style:q(q({},Ua(n,y)),u.track),start:b,end:v,key:y,onStartMove:s})})):null}var mte=E.forwardRef(function(t,e){var n,r=t.prefixCls,i=r===void 0?"rc-slider":r,s=t.className,o=t.style,a=t.classNames,c=t.styles,l=t.disabled,u=l===void 0?!1:l,f=t.keyboard,h=f===void 0?!0:f,d=t.autoFocus,p=t.onFocus,y=t.onBlur,b=t.min,v=b===void 0?0:b,m=t.max,_=m===void 0?100:m,A=t.step,S=A===void 0?1:A,w=t.value,x=t.defaultValue,M=t.range,L=t.count,R=t.onChange,I=t.onBeforeChange,N=t.onAfterChange,k=t.allowCross,z=k===void 0?!0:k,$=t.pushable,V=$===void 0?!1:$,U=t.draggableTrack,F=t.reverse,D=t.vertical,W=t.included,ee=W===void 0?!0:W,te=t.startPoint,pe=t.trackStyle,Ae=t.handleStyle,we=t.railStyle,be=t.dotStyle,ie=t.activeDotStyle,he=t.marks,se=t.dots,me=t.handleRender,Ie=t.tabIndex,Xe=Ie===void 0?0:Ie,De=t.ariaLabelForHandle,Be=t.ariaLabelledByForHandle,xe=t.ariaValueTextFormatterForHandle,Pe=E.useRef(),Ne=E.useRef(),ue=E.useMemo(function(){return D?F?"ttb":"btt":F?"rtl":"ltr"},[F,D]),ae=E.useMemo(function(){return isFinite(v)?v:0},[v]),ce=E.useMemo(function(){return isFinite(_)?_:100},[_]),ne=E.useMemo(function(){return S!==null&&S<=0?1:S},[S]),nt=E.useMemo(function(){return typeof V=="boolean"?V?ne:!1:V>=0?V:!1},[V,ne]),ft=E.useMemo(function(){var Oe=Object.keys(he||{});return Oe.map(function(ve){var le=he[ve],Je={value:Number(ve)};return le&&Bt(le)==="object"&&!E.isValidElement(le)&&("label"in le||"style"in le)?(Je.style=le.style,Je.label=le.label):Je.label=le,Je}).filter(function(ve){var le=ve.label;return le||typeof le=="number"}).sort(function(ve,le){return ve.value-le.value})},[he]),Fi=ute(ae,ce,ne,ft,z,nt),kr=Z(Fi,2),Tt=kr[0],gr=kr[1],jt=H2(x,{value:w}),Ot=Z(jt,2),Vt=Ot[0],St=Ot[1],Ct=E.useMemo(function(){var Oe=Vt==null?[]:Array.isArray(Vt)?Vt:[Vt],ve=Z(Oe,1),le=ve[0],Je=le===void 0?ae:le,Se=Vt===null?[]:[Je];if(M){if(Se=It(Oe),L||Vt===void 0){var Dt=L>=0?L+1:2;for(Se=Se.slice(0,Dt);Se.length<Dt;){var Ve;Se.push((Ve=Se[Se.length-1])!==null&&Ve!==void 0?Ve:ae)}}Se.sort(function(dt,Sn){return dt-Sn})}return Se.forEach(function(dt,Sn){Se[Sn]=Tt(dt)}),Se},[Vt,M,ae,L,Tt]),an=E.useRef(Ct);an.current=Ct;var ht=function(ve){return M?ve:ve[0]},it=function(ve){var le=It(ve).sort(function(Je,Se){return Je-Se});R&&!u2(le,an.current,!0)&&R(ht(le)),St(le)},qt=function(ve){if(!u){var le=0,Je=ce-ae;Ct.forEach(function(Dt,Ve){var dt=Math.abs(ve-Dt);dt<=Je&&(Je=dt,le=Ve)});var Se=It(Ct);Se[le]=ve,M&&!Ct.length&&L===void 0&&Se.push(ve),I==null||I(ht(Se)),it(Se),N==null||N(ht(Se))}},pr=function(ve){ve.preventDefault();var le=Ne.current.getBoundingClientRect(),Je=le.width,Se=le.height,Dt=le.left,Ve=le.top,dt=le.bottom,Sn=le.right,gi=ve.clientX,Di=ve.clientY,vr;switch(ue){case"btt":vr=(dt-Di)/Se;break;case"ttb":vr=(Di-Ve)/Se;break;case"rtl":vr=(Sn-gi)/Je;break;default:vr=(gi-Dt)/Je}var Ln=ae+vr*(ce-ae);qt(Tt(Ln))},st=E.useState(null),wt=Z(st,2),He=wt[0],In=wt[1],An=function(ve,le){if(!u){var Je=gr(Ct,ve,le);I==null||I(ht(Ct)),it(Je.values),N==null||N(ht(Je.values)),In(Je.value)}};E.useEffect(function(){if(He!==null){var Oe=Ct.indexOf(He);Oe>=0&&Pe.current.focus(Oe)}In(null)},[He]);var fe=E.useMemo(function(){return U&&ne===null?!1:U},[U,ne]),oe=function(){N==null||N(ht(an.current))},qe=lte(Ne,ue,Ct,ae,ce,Tt,it,oe,gr),je=Z(qe,4),cn=je[0],mr=je[1],En=je[2],Ft=je[3],ln=function(ve,le){Ft(ve,le),I==null||I(ht(an.current))},Ur=cn!==-1;E.useEffect(function(){if(!Ur){var Oe=Ct.lastIndexOf(mr);Pe.current.focus(Oe)}},[Ur]);var un=E.useMemo(function(){return It(En).sort(function(Oe,ve){return Oe-ve})},[En]),xt=E.useMemo(function(){return M?[un[0],un[un.length-1]]:[ae,un[0]]},[un,M,ae]),Gr=Z(xt,2),di=Gr[0],Tn=Gr[1];E.useImperativeHandle(e,function(){return{focus:function(){Pe.current.focus(0)},blur:function(){var ve=document,le=ve.activeElement;Ne.current.contains(le)&&(le==null||le.blur())}}}),E.useEffect(function(){d&&Pe.current.focus(0)},[]);var zr=E.useMemo(function(){return{min:ae,max:ce,direction:ue,disabled:u,keyboard:h,step:ne,included:ee,includedStart:di,includedEnd:Tn,range:M,tabIndex:Xe,ariaLabelForHandle:De,ariaLabelledByForHandle:Be,ariaValueTextFormatterForHandle:xe,styles:c||{},classNames:a||{}}},[ae,ce,ue,u,h,ne,ee,di,Tn,M,Xe,De,Be,xe,c,a]);return E.createElement(Yo.Provider,{value:zr},E.createElement("div",{ref:Ne,className:Lt(i,s,(n={},g(n,"".concat(i,"-disabled"),u),g(n,"".concat(i,"-vertical"),D),g(n,"".concat(i,"-horizontal"),!D),g(n,"".concat(i,"-with-marks"),ft.length),n)),style:o,onMouseDown:pr},E.createElement("div",{className:Lt("".concat(i,"-rail"),a==null?void 0:a.rail),style:q(q({},we),c==null?void 0:c.rail)}),E.createElement(pte,{prefixCls:i,style:pe,values:un,startPoint:te,onStartMove:fe?ln:null}),E.createElement(gte,{prefixCls:i,marks:ft,dots:se,style:be,activeStyle:ie}),E.createElement(cte,{ref:Pe,prefixCls:i,style:Ae,values:En,draggingIndex:cn,onStartMove:ln,onOffsetChange:An,onFocus:p,onBlur:y,handleRender:me}),E.createElement(hte,{prefixCls:i,marks:ft,onClick:qt})))});const vte=E.forwardRef((t,e)=>{const{open:n}=t,r=E.useRef(null),i=E.useRef(null);function s(){No.cancel(i.current),i.current=null}function o(){i.current=No(()=>{var a;(a=r.current)===null||a===void 0||a.forceAlign(),i.current=null})}return E.useEffect(()=>(n?o():s(),s),[n,t.title]),E.createElement(ite,Object.assign({ref:h1(r,e)},t))}),yte=vte,_te=t=>{const{componentCls:e,antCls:n,controlSize:r,dotSize:i,marginFull:s,marginPart:o,colorFillContentHover:a}=t;return{[e]:Object.assign(Object.assign({},j2(t)),{position:"relative",height:r,margin:`${o}px ${s}px`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${s}px ${o}px`},[`${e}-rail`]:{position:"absolute",backgroundColor:t.railBg,borderRadius:t.borderRadiusXS,transition:`background-color ${t.motionDurationMid}`},[`${e}-track,${e}-tracks`]:{position:"absolute",transition:`background-color ${t.motionDurationMid}`},[`${e}-track`]:{backgroundColor:t.trackBg,borderRadius:t.borderRadiusXS},[`${e}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${e}-rail`]:{backgroundColor:t.railHoverBg},[`${e}-track`]:{backgroundColor:t.trackHoverBg},[`${e}-dot`]:{borderColor:a},[`${e}-handle::after`]:{boxShadow:`0 0 0 ${t.handleLineWidth}px ${t.colorPrimaryBorderHover}`},[`${e}-dot-active`]:{borderColor:t.dotActiveBorderColor}},[`${e}-handle`]:{position:"absolute",width:t.handleSize,height:t.handleSize,outline:"none",[`${e}-dragging`]:{zIndex:1},"&::before":{content:'""',position:"absolute",insetInlineStart:-t.handleLineWidth,insetBlockStart:-t.handleLineWidth,width:t.handleSize+t.handleLineWidth*2,height:t.handleSize+t.handleLineWidth*2,backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:t.handleSize,height:t.handleSize,backgroundColor:t.colorBgElevated,boxShadow:`0 0 0 ${t.handleLineWidth}px ${t.handleColor}`,borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${t.motionDurationMid},
            inset-block-start ${t.motionDurationMid},
            width ${t.motionDurationMid},
            height ${t.motionDurationMid},
            box-shadow ${t.motionDurationMid}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:-((t.handleSizeHover-t.handleSize)/2+t.handleLineWidthHover),insetBlockStart:-((t.handleSizeHover-t.handleSize)/2+t.handleLineWidthHover),width:t.handleSizeHover+t.handleLineWidthHover*2,height:t.handleSizeHover+t.handleLineWidthHover*2},"&::after":{boxShadow:`0 0 0 ${t.handleLineWidthHover}px ${t.handleActiveColor}`,width:t.handleSizeHover,height:t.handleSizeHover,insetInlineStart:(t.handleSize-t.handleSizeHover)/2,insetBlockStart:(t.handleSize-t.handleSizeHover)/2}}},[`${e}-mark`]:{position:"absolute",fontSize:t.fontSize},[`${e}-mark-text`]:{position:"absolute",display:"inline-block",color:t.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:t.colorText}},[`${e}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${e}-dot`]:{position:"absolute",width:i,height:i,backgroundColor:t.colorBgElevated,border:`${t.handleLineWidth}px solid ${t.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${t.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:t.dotActiveBorderColor}},[`&${e}-disabled`]:{cursor:"not-allowed",[`${e}-rail`]:{backgroundColor:`${t.railBg} !important`},[`${e}-track`]:{backgroundColor:`${t.trackBgDisabled} !important`},[`
          ${e}-dot
        `]:{backgroundColor:t.colorBgElevated,borderColor:t.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${e}-handle::after`]:{backgroundColor:t.colorBgElevated,cursor:"not-allowed",width:t.handleSize,height:t.handleSize,boxShadow:`0 0 0 ${t.handleLineWidth}px ${new jn(t.colorTextDisabled).onBackground(t.colorBgContainer).toHexShortString()}`,insetInlineStart:0,insetBlockStart:0},[`
          ${e}-mark-text,
          ${e}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${n}-tooltip-inner`]:{minWidth:"unset"}})}},dL=(t,e)=>{const{componentCls:n,railSize:r,handleSize:i,dotSize:s}=t,o=e?"paddingBlock":"paddingInline",a=e?"width":"height",c=e?"height":"width",l=e?"insetBlockStart":"insetInlineStart",u=e?"top":"insetInlineStart",f=(r*3-i)/2,h=(i-r)/2,d=e?{borderWidth:`${h}px 0`,transform:`translateY(-${h}px)`}:{borderWidth:`0 ${h}px`,transform:`translateX(-${h}px)`};return{[o]:r,[c]:r*3,[`${n}-rail`]:{[a]:"100%",[c]:r},[`${n}-track,${n}-tracks`]:{[c]:r},[`${n}-track-draggable`]:Object.assign({},d),[`${n}-handle`]:{[l]:f},[`${n}-mark`]:{insetInlineStart:0,top:0,[u]:r*3+(e?0:t.marginFull),[a]:"100%"},[`${n}-step`]:{insetInlineStart:0,top:0,[u]:r,[a]:"100%",[c]:r},[`${n}-dot`]:{position:"absolute",[l]:(r-s)/2}}},bte=t=>{const{componentCls:e,marginPartWithMark:n}=t;return{[`${e}-horizontal`]:Object.assign(Object.assign({},dL(t,!0)),{[`&${e}-with-marks`]:{marginBottom:n}})}},Ate=t=>{const{componentCls:e}=t;return{[`${e}-vertical`]:Object.assign(Object.assign({},dL(t,!1)),{height:"100%"})}},Ete=$2("Slider",t=>{const e=ou(t,{marginPart:(t.controlHeight-t.controlSize)/2,marginFull:t.controlSize/2,marginPartWithMark:t.controlHeightLG-t.controlSize});return[_te(e),bte(e),Ate(e)]},t=>{const n=t.controlHeightLG/4,r=t.controlHeightSM/2,i=t.lineWidth+1,s=t.lineWidth+1*3;return{controlSize:n,railSize:4,handleSize:n,handleSizeHover:r,dotSize:8,handleLineWidth:i,handleLineWidthHover:s,railBg:t.colorFillTertiary,railHoverBg:t.colorFillSecondary,trackBg:t.colorPrimaryBorder,trackHoverBg:t.colorPrimaryBorderHover,handleColor:t.colorPrimaryBorder,handleActiveColor:t.colorPrimary,dotBorderColor:t.colorBorderSecondary,dotActiveBorderColor:t.colorPrimaryBorder,trackBgDisabled:t.colorBgContainerDisabled}});var Tte=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Ste=t=>typeof t=="number"?t.toString():"",Cte=Nn.forwardRef((t,e)=>{const{prefixCls:n,range:r,className:i,rootClassName:s,style:o,disabled:a,tooltipPrefixCls:c,tipFormatter:l,tooltipVisible:u,getTooltipPopupContainer:f,tooltipPlacement:h}=t,d=Tte(t,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement"]),{direction:p,slider:y,getPrefixCls:b,getPopupContainer:v}=Nn.useContext(Ko),m=Nn.useContext(U2),_=a??m,[A,S]=Nn.useState({}),w=(V,U)=>{S(F=>Object.assign(Object.assign({},F),{[V]:U}))},x=(V,U)=>V||(U?p==="rtl"?"left":"right":"top"),M=b("slider",n),[L,R]=Ete(M),I=Lt(i,y==null?void 0:y.className,s,{[`${M}-rtl`]:p==="rtl"},R);p==="rtl"&&!d.vertical&&(d.reverse=!d.reverse);const[N,k]=Nn.useMemo(()=>r?typeof r=="object"?[!0,r.draggableTrack]:[!0,!1]:[!1],[r]),z=(V,U)=>{var F;const{index:D,dragging:W}=U,{tooltip:ee={},vertical:te}=t,pe=Object.assign({},ee),{open:Ae,placement:we,getPopupContainer:be,prefixCls:ie,formatter:he}=pe;let se;he||he===null?se=he:l||l===null?se=l:se=Ste;const me=se?A[D]||W:!1,Ie=(F=Ae??u)!==null&&F!==void 0?F:Ae===void 0&&me,Xe=Object.assign(Object.assign({},V.props),{onMouseEnter:()=>w(D,!0),onMouseLeave:()=>w(D,!1)}),De=b("tooltip",ie??c);return Nn.createElement(yte,Object.assign({},pe,{prefixCls:De,title:se?se(U.value):"",open:Ie,placement:x(we??h,te),key:D,overlayClassName:`${M}-tooltip`,getPopupContainer:be||f||v}),Nn.cloneElement(V,Xe))},$=Object.assign(Object.assign({},y==null?void 0:y.style),o);return L(Nn.createElement(mte,Object.assign({},d,{step:d.step,range:N,draggableTrack:k,className:I,style:$,disabled:_,ref:e,prefixCls:M,handleRender:z})))}),wte=Cte,xte=-80,xd=[139.69175,35.6895],Pte={longitude:xd[0],latitude:xd[1],zoom:16,pitch:60,bearing:0};function Mte(){const[t,e]=E.useState(null),[n,r]=E.useState(1),i=E.useMemo(()=>s(n),[n]);function s(u){const f=u/4;return[0,f,f*2,f*3,u]}const o=[[254,235,226],[251,180,185],[247,104,161],[197,27,138],[122,1,119]],a=E.useMemo(()=>JI().clamp(!0).domain(i).range(o),[i,o]);function c(){const u=f=>{r(f)};return rr.jsx("div",{children:rr.jsx(wte,{value:n,min:.25,max:3,step:.25,onChange:u})})}E.useEffect(()=>{const u=["./geojson/53394525footprint_small.geojson","./geojson/53394526footprint_small.geojson","./geojson/53394527footprint_small.geojson"],f=h=>fetch(h).then(d=>d.json());Promise.all(u.map(f)).then(h=>{const d=[].concat(...h.map(p=>p.features));e({type:"FeatureCollection",features:d})})},[]);const l=[new n1({id:"3d-tiles",pointSize:1,data:"https://assets.cms.plateau.reearth.io/assets/4a/878097-66f2-4a39-b9fc-85ffee93dbdc/13100_tokyo23-ku_2022_3dtiles_1_1_op_bldg_13104_shinjuku-ku_lod2_no_texture/tileset.json",loader:t1,operation:"terrain",onTileLoad:u=>{u.content.cartographicOrigin=new B(u.content.cartographicOrigin.x,u.content.cartographicOrigin.y,u.content.cartographicOrigin.z+xte)}}),new k_({id:"geojson-layer",data:t,filled:!0,pointRadiusMinPixels:2,pointRadiusMaxPixels:5,getFillColor:u=>{const f=LS(u.geometry),h=RS(f,xd);return a(h)},getLineColor:u=>{const f=LS(u.geometry),h=RS(f,xd);return a(h)},lineWidthMinPixels:5,opacity:.5,extensions:[new r1],updateTriggers:{getFillColor:[a.domain()]}})];return rr.jsxs(rr.Fragment,{children:[rr.jsxs("div",{className:"absolute left-5 top-5 z-10 bg-neutral-900/80 text-white p-3 flex flex-col gap-2",children:[rr.jsx("h1",{className:"font-bold text-lg",children:"deck.gl - TerrainExtension"}),rr.jsx("label",{className:"text-xs",children:"都庁からの距離"}),rr.jsx("div",{className:"!text-xs gap-3",children:rr.jsx(c,{})})]}),rr.jsx(x9,{initialViewState:Pte,controller:!0,layers:l,children:rr.jsx(pY,{style:{width:"100vw",height:"100vh"},mapStyle:"https://tile.openstreetmap.jp/styles/openmaptiles/style.json"})})]})}xm.createRoot(document.getElementById("root")).render(rr.jsx(Nn.StrictMode,{children:rr.jsx(Mte,{})}));export{Rte as c,cu as g};
